<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="A first-principles materials simulation code using Density Functional Theory.">
    
    <meta name="author" content="SIESTA Group" >
    <link rel="icon" href="../favicon.png">

    <title>dhscf_init &ndash; SIESTA</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">SIESTA <small>trunk-700--vdikan-edens-710-ford-681</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>Program Overview</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>dhscf_init
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 2.5% of total for procedures.">210 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/dhscf.F"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/dhscf.f.html'>dhscf.F</a></li>
    
     <li><a href='../module/m_dhscf.html'>m_dhscf</a></li>
    
  
     <li class="active">dhscf_init</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/dhscf_init.html#src">dhscf_init</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine dhscf_init(nspin, norb, iaorb, iphorb, nuo, nuotot, nua, na, isa, xa, indxua, ucell, mscell, g2max, ntm, maxnd, numd, listdptr, listd, datm, Fal, stressl)
    
    
   
</h2>
    
  
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
      
      <li class="list-group-item">
  <ul class="list-inline">
    
    <li><a href='../module/precision.html'>precision</a></li>
    
    <li><a href='../module/parallel.html'>parallel</a></li>
    
    <li><a href='../module/atmfuncs.html'>atmfuncs</a></li>
    
    <li>fdf</li>
    
    <li><a href='../module/sys.html'>sys</a></li>
    
    <li><a href='../module/mesh.html'>mesh</a></li>
    
    <li>parsing</li>
    
    <li>siestaXC</li>
    
    <li>bsc_xcmod</li>
    
    <li>alloc</li>
    
    <li><a href='../module/siesta_options.html'>siesta_options</a></li>
    
    <li>meshsubs</li>
    
    <li>meshsubs</li>
    
    <li>meshsubs</li>
    
    <li>meshsubs</li>
    
    <li>meshsubs</li>
    
    <li>meshsubs</li>
    
    <li>meshsubs</li>
    
    <li><a href='../module/moremeshsubs.html'>moreMeshSubs</a></li>
    
    <li><a href='../module/moremeshsubs.html'>moreMeshSubs</a></li>
    
    <li><a href='../module/moremeshsubs.html'>moreMeshSubs</a></li>
    
    <li>meshdscf</li>
    
    <li>iogrid_netcdf</li>
    
    <li>m_ncdf_io</li>
    
    <li>cellxc_mod</li>
    
    <li>m_efield</li>
    
    <li>m_efield</li>
    
    <li>m_efield</li>
    
    <li>m_efield</li>
    
    <li>m_doping_uniform</li>
    
    <li>m_doping_uniform</li>
    
    <li><a href='../module/m_rhog.html'>m_rhog</a></li>
    
    <li><a href='../module/m_rhog.html'>m_rhog</a></li>
    
    <li><a href='../module/siesta_options.html'>siesta_options</a></li>
    
    <li>mpi_siesta</li>
    
    <li>m_mesh_node</li>
    
    <li>m_charge_add</li>
    
    <li>m_hartree_add</li>
    
    <li>m_ts_global_vars</li>
    
    <li>m_ts_options</li>
    
    <li>m_ts_voltage</li>
    
    <li>m_ts_hartree</li>
    
  </ul>
      </li>
      
      
      
      <li class="list-group-item">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~dhscf_init~~UsesGraph Pages: 1 -->
<svg id="procdhscf_initUsesGraph" width="584pt" height="1112pt"
 viewBox="0.00 0.00 584.00 1112.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~dhscf_init~~UsesGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 1108)">
<title>proc~~dhscf_init~~UsesGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1108 580,-1108 580,4 -4,4"/>
<!-- proc~dhscf_init -->
<g id="proc~~dhscf_init~~UsesGraph_node1" class="node"><title>proc~dhscf_init</title>
<polygon fill="none" stroke="black" points="576,-528 518,-528 518,-504 576,-504 576,-528"/>
<text text-anchor="middle" x="547" y="-513.6" font-family="Helvetica,sans-Serif" font-size="10.50">dhscf_init</text>
</g>
<!-- m_charge_add -->
<g id="proc~~dhscf_init~~UsesGraph_node2" class="node"><title>m_charge_add</title>
<polygon fill="#337ab7" stroke="#337ab7" points="473.5,-1104 388.5,-1104 388.5,-1080 473.5,-1080 473.5,-1104"/>
<text text-anchor="middle" x="431" y="-1089.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_charge_add</text>
</g>
<!-- proc~dhscf_init&#45;&gt;m_charge_add -->
<g id="proc~~dhscf_init~~UsesGraph_edge1" class="edge"><title>proc~dhscf_init&#45;&gt;m_charge_add</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M546.212,-528.282C547.247,-601.608 549.26,-981.412 482,-1071 481.431,-1071.76 480.83,-1072.49 480.199,-1073.19"/>
<polygon fill="#000000" stroke="#000000" points="477.816,-1070.63 472.488,-1079.78 482.364,-1075.95 477.816,-1070.63"/>
</g>
<!-- m_ncdf_io -->
<g id="proc~~dhscf_init~~UsesGraph_node3" class="node"><title>m_ncdf_io</title>
<polygon fill="#337ab7" stroke="#337ab7" points="462,-1062 400,-1062 400,-1038 462,-1038 462,-1062"/>
<text text-anchor="middle" x="431" y="-1047.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ncdf_io</text>
</g>
<!-- proc~dhscf_init&#45;&gt;m_ncdf_io -->
<g id="proc~~dhscf_init~~UsesGraph_edge2" class="edge"><title>proc~dhscf_init&#45;&gt;m_ncdf_io</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M545.961,-528.06C545.527,-596.908 540.419,-940.112 482,-1024 479.036,-1028.26 475.155,-1031.87 470.864,-1034.91"/>
<polygon fill="#000000" stroke="#000000" points="469.005,-1031.95 462.241,-1040.1 472.614,-1037.94 469.005,-1031.95"/>
</g>
<!-- module~sys -->
<g id="proc~~dhscf_init~~UsesGraph_node4" class="node"><title>module~sys</title>
<g id="a_proc~~dhscf_init~~UsesGraph_node4"><a xlink:href=".././module/sys.html" xlink:title="sys">
<polygon fill="#337ab7" stroke="#337ab7" points="297.5,-942 243.5,-942 243.5,-918 297.5,-918 297.5,-942"/>
<text text-anchor="middle" x="270.5" y="-927.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sys</text>
</a>
</g>
</g>
<!-- proc~dhscf_init&#45;&gt;module~sys -->
<g id="proc~~dhscf_init~~UsesGraph_edge3" class="edge"><title>proc~dhscf_init&#45;&gt;module~sys</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M430,-890C395.489,-918.893 342.907,-927.338 307.889,-929.583"/>
<polygon fill="#000000" stroke="#000000" points="307.438,-926.101 297.625,-930.096 307.787,-933.092 307.438,-926.101"/>
</g>
<!-- m_ts_options -->
<g id="proc~~dhscf_init~~UsesGraph_node5" class="node"><title>m_ts_options</title>
<polygon fill="#337ab7" stroke="#337ab7" points="469,-738 393,-738 393,-714 469,-714 469,-738"/>
<text text-anchor="middle" x="431" y="-723.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_options</text>
</g>
<!-- proc~dhscf_init&#45;&gt;m_ts_options -->
<g id="proc~~dhscf_init~~UsesGraph_edge16" class="edge"><title>proc~dhscf_init&#45;&gt;m_ts_options</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M545.235,-528.354C542.554,-561.338 530.872,-652.522 482,-705 480.628,-706.473 479.137,-707.846 477.556,-709.126"/>
<polygon fill="#000000" stroke="#000000" points="475.434,-706.333 469.037,-714.779 479.305,-712.166 475.434,-706.333"/>
</g>
<!-- parsing -->
<g id="proc~~dhscf_init~~UsesGraph_node6" class="node"><title>parsing</title>
<polygon fill="#337ab7" stroke="#337ab7" points="458,-696 404,-696 404,-672 458,-672 458,-696"/>
<text text-anchor="middle" x="431" y="-681.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parsing</text>
</g>
<!-- proc~dhscf_init&#45;&gt;parsing -->
<g id="proc~~dhscf_init~~UsesGraph_edge5" class="edge"><title>proc~dhscf_init&#45;&gt;parsing</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M543.84,-528.411C538.396,-556.169 521.619,-623.892 482,-663 477.896,-667.051 472.893,-670.366 467.657,-673.065"/>
<polygon fill="#000000" stroke="#000000" points="465.852,-670.036 458.124,-677.283 468.685,-676.437 465.852,-670.036"/>
</g>
<!-- module~parallel -->
<g id="proc~~dhscf_init~~UsesGraph_node7" class="node"><title>module~parallel</title>
<g id="a_proc~~dhscf_init~~UsesGraph_node7"><a xlink:href=".././module/parallel.html" xlink:title="parallel">
<polygon fill="#337ab7" stroke="#337ab7" points="297.5,-1064 243.5,-1064 243.5,-1040 297.5,-1040 297.5,-1064"/>
<text text-anchor="middle" x="270.5" y="-1049.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel</text>
</a>
</g>
</g>
<!-- proc~dhscf_init&#45;&gt;module~parallel -->
<g id="proc~~dhscf_init~~UsesGraph_edge6" class="edge"><title>proc~dhscf_init&#45;&gt;module~parallel</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M430,-1010C420.861,-1018.26 351.598,-1034.56 307.708,-1044.24"/>
<polygon fill="#000000" stroke="#000000" points="306.705,-1040.88 297.685,-1046.44 308.202,-1047.72 306.705,-1040.88"/>
</g>
<!-- meshdscf -->
<g id="proc~~dhscf_init~~UsesGraph_node8" class="node"><title>meshdscf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="460,-654 402,-654 402,-630 460,-630 460,-654"/>
<text text-anchor="middle" x="431" y="-639.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">meshdscf</text>
</g>
<!-- proc~dhscf_init&#45;&gt;meshdscf -->
<g id="proc~~dhscf_init~~UsesGraph_edge7" class="edge"><title>proc~dhscf_init&#45;&gt;meshdscf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M541.563,-528.063C533.108,-549.52 512.747,-594.544 482,-621 478.271,-624.209 473.981,-626.982 469.515,-629.365"/>
<polygon fill="#000000" stroke="#000000" points="467.792,-626.307 460.223,-633.72 470.763,-632.645 467.792,-626.307"/>
</g>
<!-- m_ts_voltage -->
<g id="proc~~dhscf_init~~UsesGraph_node9" class="node"><title>m_ts_voltage</title>
<polygon fill="#337ab7" stroke="#337ab7" points="469,-612 393,-612 393,-588 469,-588 469,-612"/>
<text text-anchor="middle" x="431" y="-597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_voltage</text>
</g>
<!-- proc~dhscf_init&#45;&gt;m_ts_voltage -->
<g id="proc~~dhscf_init~~UsesGraph_edge8" class="edge"><title>proc~dhscf_init&#45;&gt;m_ts_voltage</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M536.24,-528.068C524.55,-541.886 503.8,-564.48 482,-579 479.728,-580.514 477.328,-581.954 474.86,-583.318"/>
<polygon fill="#000000" stroke="#000000" points="473.082,-580.294 465.725,-587.918 476.23,-586.546 473.082,-580.294"/>
</g>
<!-- siestaXC -->
<g id="proc~~dhscf_init~~UsesGraph_node10" class="node"><title>siestaXC</title>
<polygon fill="#337ab7" stroke="#337ab7" points="458.5,-570 403.5,-570 403.5,-546 458.5,-546 458.5,-570"/>
<text text-anchor="middle" x="431" y="-555.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siestaXC</text>
</g>
<!-- proc~dhscf_init&#45;&gt;siestaXC -->
<g id="proc~~dhscf_init~~UsesGraph_edge9" class="edge"><title>proc~dhscf_init&#45;&gt;siestaXC</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M517.82,-526.382C502.859,-531.894 484.303,-538.73 468.277,-544.635"/>
<polygon fill="#000000" stroke="#000000" points="466.854,-541.429 458.681,-548.17 469.274,-547.997 466.854,-541.429"/>
</g>
<!-- bsc_xcmod -->
<g id="proc~~dhscf_init~~UsesGraph_node11" class="node"><title>bsc_xcmod</title>
<polygon fill="#337ab7" stroke="#337ab7" points="464.5,-528 397.5,-528 397.5,-504 464.5,-504 464.5,-528"/>
<text text-anchor="middle" x="431" y="-513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bsc_xcmod</text>
</g>
<!-- proc~dhscf_init&#45;&gt;bsc_xcmod -->
<g id="proc~~dhscf_init~~UsesGraph_edge10" class="edge"><title>proc~dhscf_init&#45;&gt;bsc_xcmod</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M517.82,-516C504.874,-516 489.237,-516 474.876,-516"/>
<polygon fill="#000000" stroke="#000000" points="474.701,-512.5 464.701,-516 474.701,-519.5 474.701,-512.5"/>
</g>
<!-- module~mesh -->
<g id="proc~~dhscf_init~~UsesGraph_node12" class="node"><title>module~mesh</title>
<g id="a_proc~~dhscf_init~~UsesGraph_node12"><a xlink:href=".././module/mesh.html" xlink:title="mesh">
<polygon fill="#337ab7" stroke="#337ab7" points="161,-862 107,-862 107,-838 161,-838 161,-862"/>
<text text-anchor="middle" x="134" y="-847.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mesh</text>
</a>
</g>
</g>
<!-- proc~dhscf_init&#45;&gt;module~mesh -->
<g id="proc~~dhscf_init~~UsesGraph_edge11" class="edge"><title>proc~dhscf_init&#45;&gt;module~mesh</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M546.591,-528.198C548.427,-581.156 548.067,-792.83 432,-890"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M430,-890C375.986,-935.22 341.758,-895.12 271.5,-890"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M269.5,-890C235.029,-887.488 197.455,-875.475 170.806,-865.263"/>
<polygon fill="#000000" stroke="#000000" points="171.743,-861.871 161.156,-861.461 169.177,-868.383 171.743,-861.871"/>
</g>
<!-- cellxc_mod -->
<g id="proc~~dhscf_init~~UsesGraph_node13" class="node"><title>cellxc_mod</title>
<polygon fill="#337ab7" stroke="#337ab7" points="464,-486 398,-486 398,-462 464,-462 464,-486"/>
<text text-anchor="middle" x="431" y="-471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cellxc_mod</text>
</g>
<!-- proc~dhscf_init&#45;&gt;cellxc_mod -->
<g id="proc~~dhscf_init~~UsesGraph_edge12" class="edge"><title>proc~dhscf_init&#45;&gt;cellxc_mod</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M517.82,-505.618C504.515,-500.716 488.366,-494.766 473.682,-489.357"/>
<polygon fill="#000000" stroke="#000000" points="474.883,-486.069 464.289,-485.896 472.463,-492.637 474.883,-486.069"/>
</g>
<!-- m_efield -->
<g id="proc~~dhscf_init~~UsesGraph_node14" class="node"><title>m_efield</title>
<polygon fill="#337ab7" stroke="#337ab7" points="458,-444 404,-444 404,-420 458,-420 458,-444"/>
<text text-anchor="middle" x="431" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_efield</text>
</g>
<!-- proc~dhscf_init&#45;&gt;m_efield -->
<g id="proc~~dhscf_init~~UsesGraph_edge13" class="edge"><title>proc~dhscf_init&#45;&gt;m_efield</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M536.24,-503.932C524.55,-490.114 503.8,-467.52 482,-453 477.559,-450.042 472.634,-447.365 467.657,-444.989"/>
<polygon fill="#000000" stroke="#000000" points="468.698,-441.623 458.135,-440.796 465.877,-448.029 468.698,-441.623"/>
</g>
<!-- m_doping_uniform -->
<g id="proc~~dhscf_init~~UsesGraph_node15" class="node"><title>m_doping_uniform</title>
<polygon fill="#337ab7" stroke="#337ab7" points="482,-402 380,-402 380,-378 482,-378 482,-402"/>
<text text-anchor="middle" x="431" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_doping_uniform</text>
</g>
<!-- proc~dhscf_init&#45;&gt;m_doping_uniform -->
<g id="proc~~dhscf_init~~UsesGraph_edge14" class="edge"><title>proc~dhscf_init&#45;&gt;m_doping_uniform</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M541.563,-503.937C533.108,-482.48 512.747,-437.456 482,-411 480.501,-409.71 478.912,-408.491 477.257,-407.339"/>
<polygon fill="#000000" stroke="#000000" points="478.929,-404.261 468.551,-402.128 475.334,-410.267 478.929,-404.261"/>
</g>
<!-- module~siesta_options -->
<g id="proc~~dhscf_init~~UsesGraph_node16" class="node"><title>module~siesta_options</title>
<g id="a_proc~~dhscf_init~~UsesGraph_node16"><a xlink:href=".././module/siesta_options.html" xlink:title="siesta_options">
<polygon fill="#337ab7" stroke="#337ab7" points="471.5,-360 390.5,-360 390.5,-336 471.5,-336 471.5,-360"/>
<text text-anchor="middle" x="431" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_options</text>
</a>
</g>
</g>
<!-- proc~dhscf_init&#45;&gt;module~siesta_options -->
<g id="proc~~dhscf_init~~UsesGraph_edge15" class="edge"><title>proc~dhscf_init&#45;&gt;module~siesta_options</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M543.84,-503.589C538.396,-475.831 521.619,-408.108 482,-369 480.779,-367.795 479.479,-366.655 478.117,-365.577"/>
<polygon fill="#000000" stroke="#000000" points="480.033,-362.648 469.759,-360.06 476.176,-368.49 480.033,-362.648"/>
</g>
<!-- m_ts_global_vars -->
<g id="proc~~dhscf_init~~UsesGraph_node17" class="node"><title>m_ts_global_vars</title>
<polygon fill="#337ab7" stroke="#337ab7" points="479.5,-318 382.5,-318 382.5,-294 479.5,-294 479.5,-318"/>
<text text-anchor="middle" x="431" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_global_vars</text>
</g>
<!-- proc~dhscf_init&#45;&gt;m_ts_global_vars -->
<g id="proc~~dhscf_init~~UsesGraph_edge4" class="edge"><title>proc~dhscf_init&#45;&gt;m_ts_global_vars</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M545.235,-503.646C542.554,-470.662 530.872,-379.478 482,-327 481.098,-326.031 480.144,-325.105 479.146,-324.221"/>
<polygon fill="#000000" stroke="#000000" points="480.954,-321.21 470.791,-318.218 476.87,-326.895 480.954,-321.21"/>
</g>
<!-- module~moremeshsubs -->
<g id="proc~~dhscf_init~~UsesGraph_node18" class="node"><title>module~moremeshsubs</title>
<g id="a_proc~~dhscf_init~~UsesGraph_node18"><a xlink:href=".././module/moremeshsubs.html" xlink:title="moreMeshSubs">
<polygon fill="#337ab7" stroke="#337ab7" points="475,-982 387,-982 387,-958 475,-958 475,-982"/>
<text text-anchor="middle" x="431" y="-967.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">moreMeshSubs</text>
</a>
</g>
</g>
<!-- proc~dhscf_init&#45;&gt;module~moremeshsubs -->
<g id="proc~~dhscf_init~~UsesGraph_edge17" class="edge"><title>proc~dhscf_init&#45;&gt;module~moremeshsubs</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M546.079,-528.001C545.986,-576.937 541.575,-765.38 482,-904 474.643,-921.118 461.92,-937.82 451.149,-950.14"/>
<polygon fill="#000000" stroke="#000000" points="448.545,-947.801 444.429,-957.563 453.735,-952.498 448.545,-947.801"/>
</g>
<!-- module~precision -->
<g id="proc~~dhscf_init~~UsesGraph_node19" class="node"><title>module~precision</title>
<g id="a_proc~~dhscf_init~~UsesGraph_node19"><a xlink:href=".././module/precision.html" xlink:title="precision">
<polygon fill="#337ab7" stroke="#337ab7" points="63,-823 8,-823 8,-799 63,-799 63,-823"/>
<text text-anchor="middle" x="35.5" y="-808.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">precision</text>
</a>
</g>
</g>
<!-- proc~dhscf_init&#45;&gt;module~precision -->
<g id="proc~~dhscf_init~~UsesGraph_edge24" class="edge"><title>proc~dhscf_init&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M269.5,-890C209.88,-885.655 188.333,-917 135,-890"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M133,-890C102.575,-874.598 73.0608,-848.245 54.8526,-830.246"/>
<polygon fill="#000000" stroke="#000000" points="57.2964,-827.74 47.7716,-823.1 52.324,-832.667 57.2964,-827.74"/>
</g>
<!-- meshsubs -->
<g id="proc~~dhscf_init~~UsesGraph_node20" class="node"><title>meshsubs</title>
<polygon fill="#337ab7" stroke="#337ab7" points="461.5,-276 400.5,-276 400.5,-252 461.5,-252 461.5,-276"/>
<text text-anchor="middle" x="431" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">meshsubs</text>
</g>
<!-- proc~dhscf_init&#45;&gt;meshsubs -->
<g id="proc~~dhscf_init~~UsesGraph_edge19" class="edge"><title>proc~dhscf_init&#45;&gt;meshsubs</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M546.144,-503.743C545.927,-466.183 540.287,-351.227 482,-285 478.787,-281.349 474.835,-278.317 470.572,-275.801"/>
<polygon fill="#000000" stroke="#000000" points="472.042,-272.624 461.526,-271.333 468.942,-278.9 472.042,-272.624"/>
</g>
<!-- mpi_siesta -->
<g id="proc~~dhscf_init~~UsesGraph_node21" class="node"><title>mpi_siesta</title>
<polygon fill="#337ab7" stroke="#337ab7" points="463,-234 399,-234 399,-210 463,-210 463,-234"/>
<text text-anchor="middle" x="431" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_siesta</text>
</g>
<!-- proc~dhscf_init&#45;&gt;mpi_siesta -->
<g id="proc~~dhscf_init~~UsesGraph_edge20" class="edge"><title>proc~dhscf_init&#45;&gt;mpi_siesta</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M544.61,-503.749C538.988,-456.12 516.568,-283.897 482,-243 479.231,-239.724 475.864,-236.949 472.199,-234.6"/>
<polygon fill="#000000" stroke="#000000" points="473.724,-231.447 463.249,-229.858 470.447,-237.633 473.724,-231.447"/>
</g>
<!-- m_mesh_node -->
<g id="proc~~dhscf_init~~UsesGraph_node22" class="node"><title>m_mesh_node</title>
<polygon fill="#337ab7" stroke="#337ab7" points="473,-192 389,-192 389,-168 473,-168 473,-192"/>
<text text-anchor="middle" x="431" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_mesh_node</text>
</g>
<!-- proc~dhscf_init&#45;&gt;m_mesh_node -->
<g id="proc~~dhscf_init~~UsesGraph_edge21" class="edge"><title>proc~dhscf_init&#45;&gt;m_mesh_node</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M545.021,-503.696C540.649,-451.517 521.365,-249.007 482,-201 481.284,-200.126 480.525,-199.288 479.728,-198.485"/>
<polygon fill="#000000" stroke="#000000" points="481.725,-195.601 471.711,-192.141 477.381,-201.091 481.725,-195.601"/>
</g>
<!-- m_ts_hartree -->
<g id="proc~~dhscf_init~~UsesGraph_node23" class="node"><title>m_ts_hartree</title>
<polygon fill="#337ab7" stroke="#337ab7" points="469,-150 393,-150 393,-126 469,-126 469,-150"/>
<text text-anchor="middle" x="431" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_hartree</text>
</g>
<!-- proc~dhscf_init&#45;&gt;m_ts_hartree -->
<g id="proc~~dhscf_init~~UsesGraph_edge22" class="edge"><title>proc~dhscf_init&#45;&gt;m_ts_hartree</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M545.36,-503.995C542.163,-448.165 526.282,-214.292 482,-159 480.72,-157.402 479.296,-155.923 477.763,-154.556"/>
<polygon fill="#000000" stroke="#000000" points="479.525,-151.515 469.337,-148.605 475.486,-157.233 479.525,-151.515"/>
</g>
<!-- iogrid_netcdf -->
<g id="proc~~dhscf_init~~UsesGraph_node24" class="node"><title>iogrid_netcdf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="468,-108 394,-108 394,-84 468,-84 468,-108"/>
<text text-anchor="middle" x="431" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iogrid_netcdf</text>
</g>
<!-- proc~dhscf_init&#45;&gt;iogrid_netcdf -->
<g id="proc~~dhscf_init~~UsesGraph_edge23" class="edge"><title>proc~dhscf_init&#45;&gt;iogrid_netcdf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M545.602,-503.815C543.415,-443.738 531.096,-179.468 482,-117 480.396,-114.96 478.559,-113.115 476.555,-111.448"/>
<polygon fill="#000000" stroke="#000000" points="478.42,-108.485 468.156,-105.859 474.542,-114.313 478.42,-108.485"/>
</g>
<!-- alloc -->
<g id="proc~~dhscf_init~~UsesGraph_node25" class="node"><title>alloc</title>
<polygon fill="#337ab7" stroke="#337ab7" points="297.5,-1022 243.5,-1022 243.5,-998 297.5,-998 297.5,-1022"/>
<text text-anchor="middle" x="270.5" y="-1007.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">alloc</text>
</g>
<!-- proc~dhscf_init&#45;&gt;alloc -->
<g id="proc~~dhscf_init~~UsesGraph_edge18" class="edge"><title>proc~dhscf_init&#45;&gt;alloc</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M545.991,-528.246C545.704,-595.169 541.224,-916.367 482,-991 467.223,-1009.62 449.633,-994.056 432,-1010"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M430,-1010C412.689,-1025.65 348.731,-1020.56 307.543,-1015.35"/>
<polygon fill="#000000" stroke="#000000" points="307.977,-1011.87 297.604,-1014.03 307.058,-1018.81 307.977,-1011.87"/>
</g>
<!-- module~atmfuncs -->
<g id="proc~~dhscf_init~~UsesGraph_node26" class="node"><title>module~atmfuncs</title>
<g id="a_proc~~dhscf_init~~UsesGraph_node26"><a xlink:href=".././module/atmfuncs.html" xlink:title="atmfuncs">
<polygon fill="#337ab7" stroke="#337ab7" points="459,-822 403,-822 403,-798 459,-798 459,-822"/>
<text text-anchor="middle" x="431" y="-807.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">atmfuncs</text>
</a>
</g>
</g>
<!-- proc~dhscf_init&#45;&gt;module~atmfuncs -->
<g id="proc~~dhscf_init~~UsesGraph_edge25" class="edge"><title>proc~dhscf_init&#45;&gt;module~atmfuncs</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M544.61,-528.251C538.988,-575.88 516.568,-748.103 482,-789 478.315,-793.359 473.572,-796.832 468.477,-799.593"/>
<polygon fill="#000000" stroke="#000000" points="466.757,-796.529 459.082,-803.832 469.636,-802.909 466.757,-796.529"/>
</g>
<!-- fdf -->
<g id="proc~~dhscf_init~~UsesGraph_node27" class="node"><title>fdf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="458,-66 404,-66 404,-42 458,-42 458,-66"/>
<text text-anchor="middle" x="431" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fdf</text>
</g>
<!-- proc~dhscf_init&#45;&gt;fdf -->
<g id="proc~~dhscf_init~~UsesGraph_edge26" class="edge"><title>proc~dhscf_init&#45;&gt;fdf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M545.808,-503.83C544.574,-440.064 535.98,-144.747 482,-75 478.235,-70.1347 473.134,-66.385 467.625,-63.4982"/>
<polygon fill="#000000" stroke="#000000" points="468.7,-60.1507 458.131,-59.4103 465.932,-66.58 468.7,-60.1507"/>
</g>
<!-- module~m_rhog -->
<g id="proc~~dhscf_init~~UsesGraph_node28" class="node"><title>module~m_rhog</title>
<g id="a_proc~~dhscf_init~~UsesGraph_node28"><a xlink:href=".././module/m_rhog.html" xlink:title="m_rhog">
<polygon fill="#337ab7" stroke="#337ab7" points="458,-780 404,-780 404,-756 458,-756 458,-780"/>
<text text-anchor="middle" x="431" y="-765.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_rhog</text>
</a>
</g>
</g>
<!-- proc~dhscf_init&#45;&gt;module~m_rhog -->
<g id="proc~~dhscf_init~~UsesGraph_edge27" class="edge"><title>proc~dhscf_init&#45;&gt;module~m_rhog</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M546.144,-528.257C545.927,-565.817 540.287,-680.773 482,-747 478.015,-751.528 472.893,-755.104 467.454,-757.923"/>
<polygon fill="#000000" stroke="#000000" points="465.91,-754.777 458.143,-761.983 468.708,-761.194 465.91,-754.777"/>
</g>
<!-- m_hartree_add -->
<g id="proc~~dhscf_init~~UsesGraph_node29" class="node"><title>m_hartree_add</title>
<polygon fill="#337ab7" stroke="#337ab7" points="474,-24 388,-24 388,-0 474,-0 474,-24"/>
<text text-anchor="middle" x="431" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_hartree_add</text>
</g>
<!-- proc~dhscf_init&#45;&gt;m_hartree_add -->
<g id="proc~~dhscf_init~~UsesGraph_edge28" class="edge"><title>proc~dhscf_init&#45;&gt;m_hartree_add</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M545.977,-503.583C545.616,-435.723 540.803,-109.958 482,-33 481.425,-32.2472 480.818,-31.5211 480.182,-30.8209"/>
<polygon fill="#000000" stroke="#000000" points="482.324,-28.0487 472.429,-24.2624 477.803,-33.393 482.324,-28.0487"/>
</g>
<!-- module~mesh&#45;&gt;module~precision -->
<g id="proc~~dhscf_init~~UsesGraph_edge29" class="edge"><title>module~mesh&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M106.886,-839.446C96.3326,-835.181 83.9758,-830.187 72.5863,-825.584"/>
<polygon fill="#000000" stroke="#000000" points="73.8905,-822.336 63.3075,-821.834 71.2675,-828.826 73.8905,-822.336"/>
</g>
<!-- module~moremeshsubs&#45;&gt;module~sys -->
<g id="proc~~dhscf_init~~UsesGraph_edge33" class="edge"><title>module~moremeshsubs&#45;&gt;module~sys</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M386.689,-959.07C361.938,-952.823 331.253,-945.08 307.778,-939.155"/>
<polygon fill="#000000" stroke="#000000" points="308.426,-935.709 297.873,-936.656 306.713,-942.496 308.426,-935.709"/>
</g>
<!-- module~moremeshsubs&#45;&gt;module~parallel -->
<g id="proc~~dhscf_init~~UsesGraph_edge30" class="edge"><title>module~moremeshsubs&#45;&gt;module~parallel</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M403.199,-982.116C395.438,-986.101 387.139,-990.845 380,-996 361.909,-1009.06 363.292,-1019.78 344,-1031 332.848,-1037.48 319.553,-1042.09 307.412,-1045.3"/>
<polygon fill="#000000" stroke="#000000" points="306.456,-1041.93 297.557,-1047.67 308.099,-1048.73 306.456,-1041.93"/>
</g>
<!-- module~moremeshsubs&#45;&gt;module~precision -->
<g id="proc~~dhscf_init~~UsesGraph_edge31" class="edge"><title>module~moremeshsubs&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M386.569,-975.004C338.042,-978.707 258.258,-979.044 197,-951 161.852,-934.909 169.279,-907.869 135,-890"/>
</g>
<!-- module~moremeshsubs&#45;&gt;alloc -->
<g id="proc~~dhscf_init~~UsesGraph_edge32" class="edge"><title>module~moremeshsubs&#45;&gt;alloc</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M386.689,-980.93C361.938,-987.177 331.253,-994.92 307.778,-1000.84"/>
<polygon fill="#000000" stroke="#000000" points="306.713,-997.504 297.873,-1003.34 308.426,-1004.29 306.713,-997.504"/>
</g>
<!-- module~atmfuncs&#45;&gt;module~sys -->
<g id="proc~~dhscf_init~~UsesGraph_edge38" class="edge"><title>module~atmfuncs&#45;&gt;module~sys</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M421.909,-822.129C408.131,-841.915 378.253,-881.211 344,-904 333.041,-911.291 319.79,-916.819 307.631,-920.862"/>
<polygon fill="#000000" stroke="#000000" points="306.269,-917.62 297.748,-923.915 308.335,-924.308 306.269,-917.62"/>
</g>
<!-- module~atmfuncs&#45;&gt;module~precision -->
<g id="proc~~dhscf_init~~UsesGraph_edge35" class="edge"><title>module~atmfuncs&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M402.695,-808.585C350.564,-806.198 233.291,-802.336 135,-810"/>
</g>
<!-- spher_harm -->
<g id="proc~~dhscf_init~~UsesGraph_node30" class="node"><title>spher_harm</title>
<polygon fill="#337ab7" stroke="#337ab7" points="305.5,-862 235.5,-862 235.5,-838 305.5,-838 305.5,-862"/>
<text text-anchor="middle" x="270.5" y="-847.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">spher_harm</text>
</g>
<!-- module~atmfuncs&#45;&gt;spher_harm -->
<g id="proc~~dhscf_init~~UsesGraph_edge36" class="edge"><title>module~atmfuncs&#45;&gt;spher_harm</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M402.753,-816.876C378.789,-822.924 343.466,-831.838 315.499,-838.896"/>
<polygon fill="#000000" stroke="#000000" points="314.403,-835.563 305.563,-841.404 316.116,-842.35 314.403,-835.563"/>
</g>
<!-- module~atm_types -->
<g id="proc~~dhscf_init~~UsesGraph_node35" class="node"><title>module~atm_types</title>
<g id="a_proc~~dhscf_init~~UsesGraph_node35"><a xlink:href=".././module/atm_types.html" xlink:title="atm_types">
<polygon fill="#337ab7" stroke="#337ab7" points="301.5,-782 239.5,-782 239.5,-758 301.5,-758 301.5,-782"/>
<text text-anchor="middle" x="270.5" y="-767.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">atm_types</text>
</a>
</g>
</g>
<!-- module~atmfuncs&#45;&gt;module~atm_types -->
<g id="proc~~dhscf_init~~UsesGraph_edge34" class="edge"><title>module~atmfuncs&#45;&gt;module~atm_types</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M402.753,-803.124C377.685,-796.797 340.189,-787.335 311.684,-780.141"/>
<polygon fill="#000000" stroke="#000000" points="312.181,-776.657 301.629,-777.603 310.468,-783.444 312.181,-776.657"/>
</g>
<!-- module~radial -->
<g id="proc~~dhscf_init~~UsesGraph_node36" class="node"><title>module~radial</title>
<g id="a_proc~~dhscf_init~~UsesGraph_node36"><a xlink:href=".././module/radial.html" xlink:title="radial">
<polygon fill="#337ab7" stroke="#337ab7" points="161,-781 107,-781 107,-757 161,-757 161,-781"/>
<text text-anchor="middle" x="134" y="-766.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">radial</text>
</a>
</g>
</g>
<!-- module~atmfuncs&#45;&gt;module~radial -->
<g id="proc~~dhscf_init~~UsesGraph_edge37" class="edge"><title>module~atmfuncs&#45;&gt;module~radial</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M402.907,-801.153C395.138,-797.961 386.907,-793.908 380,-789 360.504,-775.146 365.849,-758.731 344,-749 287.315,-723.754 213.596,-740.93 170.566,-755.271"/>
<polygon fill="#000000" stroke="#000000" points="169.398,-751.971 161.092,-758.549 171.687,-758.586 169.398,-751.971"/>
</g>
<!-- module~m_rhog&#45;&gt;module~precision -->
<g id="proc~~dhscf_init~~UsesGraph_edge39" class="edge"><title>module~m_rhog&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M403.892,-757.036C378.734,-746.476 344.402,-732.081 344,-732 279.946,-719.134 262.081,-726.26 197,-732 156.53,-735.569 142.276,-727.846 107,-748 85.6527,-760.196 89.7329,-774.078 71,-790 69.8313,-790.993 68.6104,-791.97 67.3548,-792.926"/>
<polygon fill="#000000" stroke="#000000" points="64.9777,-790.315 58.7493,-798.886 68.9631,-796.07 64.9777,-790.315"/>
</g>
<!-- class_Pair_dData1D -->
<g id="proc~~dhscf_init~~UsesGraph_node31" class="node"><title>class_Pair_dData1D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="325,-622 216,-622 216,-598 325,-598 325,-622"/>
<text text-anchor="middle" x="270.5" y="-607.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_Pair_dData1D</text>
</g>
<!-- module~m_rhog&#45;&gt;class_Pair_dData1D -->
<g id="proc~~dhscf_init~~UsesGraph_edge40" class="edge"><title>module~m_rhog&#45;&gt;class_Pair_dData1D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M403.977,-761.876C395.342,-758.701 386.328,-753.971 380,-747 343.719,-707.029 382.531,-668.807 344,-631 341.084,-628.139 337.804,-625.664 334.29,-623.522"/>
<polygon fill="#000000" stroke="#000000" points="335.651,-620.287 325.153,-618.857 332.468,-626.521 335.651,-620.287"/>
</g>
<!-- class_dData1D -->
<g id="proc~~dhscf_init~~UsesGraph_node32" class="node"><title>class_dData1D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="313,-580 228,-580 228,-556 313,-556 313,-580"/>
<text text-anchor="middle" x="270.5" y="-565.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_dData1D</text>
</g>
<!-- module~m_rhog&#45;&gt;class_dData1D -->
<g id="proc~~dhscf_init~~UsesGraph_edge43" class="edge"><title>module~m_rhog&#45;&gt;class_dData1D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M403.933,-762.235C395.189,-759.086 386.116,-754.282 380,-747 333.68,-691.849 393.431,-641.38 344,-589 338.245,-582.902 330.838,-578.54 322.964,-575.428"/>
<polygon fill="#000000" stroke="#000000" points="323.801,-572.019 313.208,-572.219 321.613,-578.668 323.801,-572.019"/>
</g>
<!-- class_Fstack_Pair_dData1D -->
<g id="proc~~dhscf_init~~UsesGraph_node33" class="node"><title>class_Fstack_Pair_dData1D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="344,-538 197,-538 197,-514 344,-514 344,-538"/>
<text text-anchor="middle" x="270.5" y="-523.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_Fstack_Pair_dData1D</text>
</g>
<!-- module~m_rhog&#45;&gt;class_Fstack_Pair_dData1D -->
<g id="proc~~dhscf_init~~UsesGraph_edge42" class="edge"><title>module~m_rhog&#45;&gt;class_Fstack_Pair_dData1D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M403.748,-762.388C394.984,-759.254 385.947,-754.42 380,-747 323.516,-676.524 404.463,-614.093 344,-547 343.112,-546.014 342.18,-545.074 341.211,-544.176"/>
<polygon fill="#000000" stroke="#000000" points="343.207,-541.299 333.105,-538.107 339.012,-546.902 343.207,-541.299"/>
</g>
<!-- m_spin -->
<g id="proc~~dhscf_init~~UsesGraph_node34" class="node"><title>m_spin</title>
<polygon fill="#337ab7" stroke="#337ab7" points="297.5,-664 243.5,-664 243.5,-640 297.5,-640 297.5,-664"/>
<text text-anchor="middle" x="270.5" y="-649.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_spin</text>
</g>
<!-- module~m_rhog&#45;&gt;m_spin -->
<g id="proc~~dhscf_init~~UsesGraph_edge41" class="edge"><title>module~m_rhog&#45;&gt;m_spin</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M403.873,-760.916C395.527,-757.696 386.721,-753.183 380,-747 354.545,-723.581 370.07,-700.733 344,-678 333.741,-669.055 320.179,-663.112 307.561,-659.199"/>
<polygon fill="#000000" stroke="#000000" points="308.298,-655.772 297.726,-656.477 306.43,-662.518 308.298,-655.772"/>
</g>
<!-- module~atm_types&#45;&gt;module~precision -->
<g id="proc~~dhscf_init~~UsesGraph_edge44" class="edge"><title>module~atm_types&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M239.388,-780.569C206.338,-791.878 155.28,-808.419 135,-810"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M133,-810C113.312,-811.535 91.2967,-811.869 73.2709,-811.782"/>
<polygon fill="#000000" stroke="#000000" points="73.1985,-808.281 63.1664,-811.688 73.1334,-815.281 73.1985,-808.281"/>
</g>
<!-- module~atm_types&#45;&gt;module~radial -->
<g id="proc~~dhscf_init~~UsesGraph_edge45" class="edge"><title>module~atm_types&#45;&gt;module~radial</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M239.316,-769.776C219.173,-769.626 192.58,-769.428 171.285,-769.27"/>
<polygon fill="#000000" stroke="#000000" points="171.028,-765.768 161.003,-769.193 170.976,-772.768 171.028,-765.768"/>
</g>
<!-- module~radial&#45;&gt;module~precision -->
<g id="proc~~dhscf_init~~UsesGraph_edge47" class="edge"><title>module~radial&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M106.886,-780.366C96.3326,-784.959 83.9758,-790.337 72.5863,-795.294"/>
<polygon fill="#000000" stroke="#000000" points="71.0799,-792.132 63.3075,-799.332 73.8735,-798.551 71.0799,-792.132"/>
</g>
<!-- xml -->
<g id="proc~~dhscf_init~~UsesGraph_node37" class="node"><title>xml</title>
<polygon fill="#337ab7" stroke="#337ab7" points="62.5,-781 8.5,-781 8.5,-757 62.5,-757 62.5,-781"/>
<text text-anchor="middle" x="35.5" y="-766.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xml</text>
</g>
<!-- module~radial&#45;&gt;xml -->
<g id="proc~~dhscf_init~~UsesGraph_edge46" class="edge"><title>module~radial&#45;&gt;xml</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M106.886,-769C96.3727,-769 84.0697,-769 72.7163,-769"/>
<polygon fill="#000000" stroke="#000000" points="72.6352,-765.5 62.6352,-769 72.6351,-772.5 72.6352,-765.5"/>
</g>
<!-- interpolation -->
<g id="proc~~dhscf_init~~UsesGraph_node38" class="node"><title>interpolation</title>
<polygon fill="#337ab7" stroke="#337ab7" points="71,-739 0,-739 0,-715 71,-715 71,-739"/>
<text text-anchor="middle" x="35.5" y="-724.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpolation</text>
</g>
<!-- module~radial&#45;&gt;interpolation -->
<g id="proc~~dhscf_init~~UsesGraph_edge48" class="edge"><title>module~radial&#45;&gt;interpolation</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M106.886,-757.634C96.6972,-753.2 84.8274,-748.034 73.77,-743.221"/>
<polygon fill="#000000" stroke="#000000" points="74.8908,-739.892 64.3248,-739.11 72.0972,-746.31 74.8908,-739.892"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="490pt" height="32pt"
 viewBox="0.00 0.00 489.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 485.5,-28 485.5,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node"><title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node"><title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="139.5,-24 72.5,-24 72.5,-0 139.5,-0 139.5,-24"/>
<text text-anchor="middle" x="106" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="222,-24 158,-24 158,-0 222,-0 222,-24"/>
<text text-anchor="middle" x="190" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="294,-24 240,-24 240,-0 294,-0 294,-24"/>
<text text-anchor="middle" x="267" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="366,-24 312,-24 312,-0 366,-0 366,-24"/>
<text text-anchor="middle" x="339" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="481.5,-24 384.5,-24 384.5,-0 481.5,-0 481.5,-24"/>
<text text-anchor="middle" x="433" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses.
    </p>
    </div></div></div></div>
      </li>
      
      </ul>
    </div>
    


    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nspin%7E7"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nspin</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-norb"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>norb</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iaorb%7E2"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>iaorb</strong>(norb)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iphorb%7E2"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>iphorb</strong>(norb)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nuo%7E2"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nuo</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nuotot%7E2"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nuotot</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nua"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nua</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-na%7E2"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>na</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-isa%7E2"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>isa</strong>(na)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-xa"></span>real(kind=dp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>xa</strong>(3,na)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-indxua"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>indxua</strong>(na)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ucell"></span>real(kind=dp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ucell</strong>(3,3)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-mscell"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>mscell</strong>(3,3)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-g2max%7E2"></span>real(kind=dp),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>g2max</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ntm"></span>integer,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ntm</strong>(3)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-maxnd%7E2"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>maxnd</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-numd%7E2"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>numd</strong>(nuo)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-listdptr%7E2"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>listdptr</strong>(nuo)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-listd%7E2"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>listd</strong>(maxnd)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-datm"></span>real(kind=dp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>datm</strong>(norb)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-fal"></span>real(kind=dp),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>Fal</strong>(3,nua)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-stressl"></span>real(kind=dp),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>stressl</strong>(3,3)</td><td></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~dhscf_init~~CallsGraph Pages: 1 -->
<svg id="procdhscf_initCallsGraph" width="635pt" height="1604pt"
 viewBox="0.00 0.00 635.00 1604.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~dhscf_init~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 1600)">
<title>proc~~dhscf_init~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1600 631,-1600 631,4 -4,4"/>
<!-- proc~dhscf_init -->
<g id="proc~~dhscf_init~~CallsGraph_node1" class="node"><title>proc~dhscf_init</title>
<polygon fill="none" stroke="black" points="58,-806 3.55271e-15,-806 3.55271e-15,-782 58,-782 58,-806"/>
<text text-anchor="middle" x="29" y="-791.6" font-family="Helvetica,sans-Serif" font-size="10.50">dhscf_init</text>
</g>
<!-- volcel -->
<g id="proc~~dhscf_init~~CallsGraph_node2" class="node"><title>volcel</title>
<polygon fill="#777777" stroke="#777777" points="207,-1596 153,-1596 153,-1572 207,-1572 207,-1596"/>
<text text-anchor="middle" x="180" y="-1581.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">volcel</text>
</g>
<!-- proc~dhscf_init&#45;&gt;volcel -->
<g id="proc~~dhscf_init~~CallsGraph_edge1" class="edge"><title>proc~dhscf_init&#45;&gt;volcel</title>
<path fill="none" stroke="#000000" d="M30.1721,-806.246C31.5984,-900.063 42.7297,-1502.84 94,-1563 105.84,-1576.89 125.273,-1582.37 142.572,-1584.27"/>
<polygon fill="#000000" stroke="#000000" points="142.751,-1587.8 152.981,-1585.04 143.264,-1580.82 142.751,-1587.8"/>
</g>
<!-- ts_init_voltage -->
<g id="proc~~dhscf_init~~CallsGraph_node3" class="node"><title>ts_init_voltage</title>
<polygon fill="#777777" stroke="#777777" points="220.5,-1554 139.5,-1554 139.5,-1530 220.5,-1530 220.5,-1554"/>
<text text-anchor="middle" x="180" y="-1539.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ts_init_voltage</text>
</g>
<!-- proc~dhscf_init&#45;&gt;ts_init_voltage -->
<g id="proc~~dhscf_init~~CallsGraph_edge2" class="edge"><title>proc~dhscf_init&#45;&gt;ts_init_voltage</title>
<path fill="none" stroke="#000000" d="M30.268,-806.041C32.3677,-895.785 47.3462,-1458.45 94,-1516 102.836,-1526.9 116.119,-1533.34 129.575,-1537.11"/>
<polygon fill="#000000" stroke="#000000" points="128.807,-1540.52 139.343,-1539.41 130.41,-1533.71 128.807,-1540.52"/>
</g>
<!-- re_alloc -->
<g id="proc~~dhscf_init~~CallsGraph_node4" class="node"><title>re_alloc</title>
<polygon fill="#777777" stroke="#777777" points="620.5,-633 566.5,-633 566.5,-609 620.5,-609 620.5,-633"/>
<text text-anchor="middle" x="593.5" y="-618.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">re_alloc</text>
</g>
<!-- proc~dhscf_init&#45;&gt;re_alloc -->
<g id="proc~~dhscf_init~~CallsGraph_edge3" class="edge"><title>proc~dhscf_init&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M30.2221,-781.7C31.5356,-724.561 40.2154,-485.91 94,-441 145.81,-397.739 501.831,-451.905 524,-470 564.178,-502.794 535.228,-535.435 560,-581 563.82,-588.026 568.934,-595.021 573.972,-601.151"/>
<polygon fill="#000000" stroke="#000000" points="571.48,-603.62 580.669,-608.896 576.775,-599.042 571.48,-603.62"/>
</g>
<!-- de_alloc -->
<g id="proc~~dhscf_init~~CallsGraph_node5" class="node"><title>de_alloc</title>
<polygon fill="#777777" stroke="#777777" points="620.5,-833 566.5,-833 566.5,-809 620.5,-809 620.5,-833"/>
<text text-anchor="middle" x="593.5" y="-818.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">de_alloc</text>
</g>
<!-- proc~dhscf_init&#45;&gt;de_alloc -->
<g id="proc~~dhscf_init~~CallsGraph_edge5" class="edge"><title>proc~dhscf_init&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M33.1931,-806.282C39.9421,-829.391 58.0749,-878.825 94,-899 151.732,-931.422 511.338,-876.942 524,-872 542.354,-864.836 560.112,-851.367 572.946,-840.069"/>
<polygon fill="#000000" stroke="#000000" points="575.608,-842.378 580.626,-833.046 570.884,-837.212 575.608,-842.378"/>
</g>
<!-- fdf_get -->
<g id="proc~~dhscf_init~~CallsGraph_node6" class="node"><title>fdf_get</title>
<polygon fill="#777777" stroke="#777777" points="207,-1432 153,-1432 153,-1408 207,-1408 207,-1432"/>
<text text-anchor="middle" x="180" y="-1417.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fdf_get</text>
</g>
<!-- proc~dhscf_init&#45;&gt;fdf_get -->
<g id="proc~~dhscf_init~~CallsGraph_edge31" class="edge"><title>proc~dhscf_init&#45;&gt;fdf_get</title>
<path fill="none" stroke="#000000" d="M30.4573,-806.122C33.6338,-887.505 53.4846,-1352.52 94,-1399 105.911,-1412.66 125.17,-1418.15 142.346,-1420.12"/>
<polygon fill="#000000" stroke="#000000" points="142.443,-1423.64 152.687,-1420.93 142.991,-1416.66 142.443,-1423.64"/>
</g>
<!-- setupextmesh -->
<g id="proc~~dhscf_init~~CallsGraph_node7" class="node"><title>setupextmesh</title>
<polygon fill="#777777" stroke="#777777" points="219.5,-1390 140.5,-1390 140.5,-1366 219.5,-1366 219.5,-1390"/>
<text text-anchor="middle" x="180" y="-1375.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setupextmesh</text>
</g>
<!-- proc~dhscf_init&#45;&gt;setupextmesh -->
<g id="proc~~dhscf_init~~CallsGraph_edge7" class="edge"><title>proc~dhscf_init&#45;&gt;setupextmesh</title>
<path fill="none" stroke="#000000" d="M30.5529,-806.024C34.2344,-883.809 56.2182,-1314 94,-1357 103.115,-1367.37 116.464,-1373.03 129.895,-1376.01"/>
<polygon fill="#000000" stroke="#000000" points="129.659,-1379.52 140.113,-1377.8 130.867,-1372.63 129.659,-1379.52"/>
</g>
<!-- distriphionmesh -->
<g id="proc~~dhscf_init~~CallsGraph_node8" class="node"><title>distriphionmesh</title>
<polygon fill="#777777" stroke="#777777" points="224,-1348 136,-1348 136,-1324 224,-1324 224,-1348"/>
<text text-anchor="middle" x="180" y="-1333.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">distriphionmesh</text>
</g>
<!-- proc~dhscf_init&#45;&gt;distriphionmesh -->
<g id="proc~~dhscf_init~~CallsGraph_edge9" class="edge"><title>proc~dhscf_init&#45;&gt;distriphionmesh</title>
<path fill="none" stroke="#000000" d="M29.7044,-806.139C28.2333,-876.968 24.3196,-1236.41 94,-1315 102.194,-1324.24 113.749,-1329.73 125.706,-1332.92"/>
<polygon fill="#000000" stroke="#000000" points="125.267,-1336.41 135.779,-1335.09 126.741,-1329.56 125.267,-1336.41"/>
</g>
<!-- proc~rcore -->
<g id="proc~~dhscf_init~~CallsGraph_node9" class="node"><title>proc~rcore</title>
<g id="a_proc~~dhscf_init~~CallsGraph_node9"><a xlink:href=".././proc/rcore.html" xlink:title="RCORE">
<polygon fill="#d94e8f" stroke="#d94e8f" points="207,-1306 153,-1306 153,-1282 207,-1282 207,-1306"/>
<text text-anchor="middle" x="180" y="-1291.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">RCORE</text>
</a>
</g>
</g>
<!-- proc~dhscf_init&#45;&gt;proc~rcore -->
<g id="proc~~dhscf_init~~CallsGraph_edge10" class="edge"><title>proc~dhscf_init&#45;&gt;proc~rcore</title>
<path fill="none" stroke="#000000" d="M29.8499,-806.031C29.2619,-873.192 29.7473,-1201.3 94,-1273 106.098,-1286.5 125.369,-1291.98 142.505,-1293.98"/>
<polygon fill="#000000" stroke="#000000" points="142.565,-1297.5 152.816,-1294.82 143.132,-1290.52 142.565,-1297.5"/>
</g>
<!-- initmesh -->
<g id="proc~~dhscf_init~~CallsGraph_node10" class="node"><title>initmesh</title>
<polygon fill="#777777" stroke="#777777" points="207,-1264 153,-1264 153,-1240 207,-1240 207,-1264"/>
<text text-anchor="middle" x="180" y="-1249.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">initmesh</text>
</g>
<!-- proc~dhscf_init&#45;&gt;initmesh -->
<g id="proc~~dhscf_init~~CallsGraph_edge11" class="edge"><title>proc~dhscf_init&#45;&gt;initmesh</title>
<path fill="none" stroke="#000000" d="M30.021,-806.217C30.3834,-870.207 35.2527,-1166.27 94,-1231 106.182,-1244.42 125.459,-1249.9 142.578,-1251.92"/>
<polygon fill="#000000" stroke="#000000" points="142.62,-1255.43 152.875,-1252.77 143.197,-1248.45 142.62,-1255.43"/>
</g>
<!-- leqi -->
<g id="proc~~dhscf_init~~CallsGraph_node11" class="node"><title>leqi</title>
<polygon fill="#777777" stroke="#777777" points="207,-1222 153,-1222 153,-1198 207,-1198 207,-1222"/>
<text text-anchor="middle" x="180" y="-1207.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">leqi</text>
</g>
<!-- proc~dhscf_init&#45;&gt;leqi -->
<g id="proc~~dhscf_init~~CallsGraph_edge12" class="edge"><title>proc~dhscf_init&#45;&gt;leqi</title>
<path fill="none" stroke="#000000" d="M30.2297,-806.222C31.6122,-866.456 40.6828,-1131.15 94,-1189 106.284,-1202.33 125.568,-1207.8 142.665,-1209.84"/>
<polygon fill="#000000" stroke="#000000" points="142.687,-1213.35 152.945,-1210.7 143.274,-1206.37 142.687,-1213.35"/>
</g>
<!-- proc~setmeshdistr -->
<g id="proc~~dhscf_init~~CallsGraph_node12" class="node"><title>proc~setmeshdistr</title>
<g id="a_proc~~dhscf_init~~CallsGraph_node12"><a xlink:href=".././proc/setmeshdistr.html" xlink:title="setMeshDistr">
<polygon fill="#d9534f" stroke="#d9534f" points="217.5,-1180 142.5,-1180 142.5,-1156 217.5,-1156 217.5,-1180"/>
<text text-anchor="middle" x="180" y="-1165.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setMeshDistr</text>
</a>
</g>
</g>
<!-- proc~dhscf_init&#45;&gt;proc~setmeshdistr -->
<g id="proc~~dhscf_init~~CallsGraph_edge13" class="edge"><title>proc~dhscf_init&#45;&gt;proc~setmeshdistr</title>
<path fill="none" stroke="#000000" d="M30.4781,-806.028C32.945,-861.945 46.0348,-1095.92 94,-1147 103.88,-1157.52 118.125,-1163.13 132.137,-1166.02"/>
<polygon fill="#000000" stroke="#000000" points="131.799,-1169.51 142.234,-1167.67 132.931,-1162.6 131.799,-1169.51"/>
</g>
<!-- initatommesh -->
<g id="proc~~dhscf_init~~CallsGraph_node13" class="node"><title>initatommesh</title>
<polygon fill="#777777" stroke="#777777" points="218,-1138 142,-1138 142,-1114 218,-1114 218,-1138"/>
<text text-anchor="middle" x="180" y="-1123.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">initatommesh</text>
</g>
<!-- proc~dhscf_init&#45;&gt;initatommesh -->
<g id="proc~~dhscf_init~~CallsGraph_edge14" class="edge"><title>proc~dhscf_init&#45;&gt;initatommesh</title>
<path fill="none" stroke="#000000" d="M30.8174,-806.312C34.5298,-858.499 51.4954,-1060.79 94,-1105 103.919,-1115.32 118.039,-1120.88 131.928,-1123.8"/>
<polygon fill="#000000" stroke="#000000" points="131.495,-1127.28 141.937,-1125.49 132.657,-1120.38 131.495,-1127.28"/>
</g>
<!-- fdf_integer -->
<g id="proc~~dhscf_init~~CallsGraph_node14" class="node"><title>fdf_integer</title>
<polygon fill="#777777" stroke="#777777" points="212,-1096 148,-1096 148,-1072 212,-1072 212,-1096"/>
<text text-anchor="middle" x="180" y="-1081.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fdf_integer</text>
</g>
<!-- proc~dhscf_init&#45;&gt;fdf_integer -->
<g id="proc~~dhscf_init~~CallsGraph_edge21" class="edge"><title>proc~dhscf_init&#45;&gt;fdf_integer</title>
<path fill="none" stroke="#000000" d="M31.2353,-806.238C36.2782,-853.79 56.8224,-1025.5 94,-1063 105.413,-1074.51 122.067,-1080.08 137.615,-1082.65"/>
<polygon fill="#000000" stroke="#000000" points="137.24,-1086.13 147.607,-1083.94 138.139,-1079.19 137.24,-1086.13"/>
</g>
<!-- init_hartree_add -->
<g id="proc~~dhscf_init~~CallsGraph_node15" class="node"><title>init_hartree_add</title>
<polygon fill="#777777" stroke="#777777" points="225.5,-1054 134.5,-1054 134.5,-1030 225.5,-1030 225.5,-1054"/>
<text text-anchor="middle" x="180" y="-1039.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_hartree_add</text>
</g>
<!-- proc~dhscf_init&#45;&gt;init_hartree_add -->
<g id="proc~~dhscf_init~~CallsGraph_edge16" class="edge"><title>proc~dhscf_init&#45;&gt;init_hartree_add</title>
<path fill="none" stroke="#000000" d="M29.5002,-806.194C28.655,-844.025 31.4798,-960.485 94,-1021 102.279,-1029.01 113.107,-1034.12 124.248,-1037.34"/>
<polygon fill="#000000" stroke="#000000" points="123.522,-1040.77 134.064,-1039.72 125.166,-1033.97 123.522,-1040.77"/>
</g>
<!-- ts_init_hartree_fix -->
<g id="proc~~dhscf_init~~CallsGraph_node16" class="node"><title>ts_init_hartree_fix</title>
<polygon fill="#777777" stroke="#777777" points="228.5,-1012 131.5,-1012 131.5,-988 228.5,-988 228.5,-1012"/>
<text text-anchor="middle" x="180" y="-997.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ts_init_hartree_fix</text>
</g>
<!-- proc~dhscf_init&#45;&gt;ts_init_hartree_fix -->
<g id="proc~~dhscf_init~~CallsGraph_edge8" class="edge"><title>proc~dhscf_init&#45;&gt;ts_init_hartree_fix</title>
<path fill="none" stroke="#000000" d="M30.4004,-806.046C32.1736,-838.997 41.7962,-931.336 94,-979 101.741,-986.068 111.48,-990.852 121.578,-994.069"/>
<polygon fill="#000000" stroke="#000000" points="120.75,-997.471 131.316,-996.698 122.574,-990.713 120.75,-997.471"/>
</g>
<!-- partialcoreonmesh -->
<g id="proc~~dhscf_init~~CallsGraph_node17" class="node"><title>partialcoreonmesh</title>
<polygon fill="#777777" stroke="#777777" points="230.5,-970 129.5,-970 129.5,-946 230.5,-946 230.5,-970"/>
<text text-anchor="middle" x="180" y="-955.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">partialcoreonmesh</text>
</g>
<!-- proc~dhscf_init&#45;&gt;partialcoreonmesh -->
<g id="proc~~dhscf_init~~CallsGraph_edge18" class="edge"><title>proc~dhscf_init&#45;&gt;partialcoreonmesh</title>
<path fill="none" stroke="#000000" d="M32.2123,-806.343C37.6816,-833.238 54.3748,-897.477 94,-932 101.34,-938.395 110.225,-943.217 119.446,-946.853"/>
<polygon fill="#000000" stroke="#000000" points="118.533,-950.242 129.128,-950.229 120.838,-943.632 118.533,-950.242"/>
</g>
<!-- proc~die -->
<g id="proc~~dhscf_init~~CallsGraph_node18" class="node"><title>proc~die</title>
<g id="a_proc~~dhscf_init~~CallsGraph_node18"><a xlink:href=".././proc/die.html" xlink:title="die">
<polygon fill="#d9534f" stroke="#d9534f" points="508,-1138 454,-1138 454,-1114 508,-1114 508,-1138"/>
<text text-anchor="middle" x="481" y="-1123.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">die</text>
</a>
</g>
</g>
<!-- proc~dhscf_init&#45;&gt;proc~die -->
<g id="proc~~dhscf_init~~CallsGraph_edge19" class="edge"><title>proc~dhscf_init&#45;&gt;proc~die</title>
<path fill="none" stroke="#000000" d="M30.1683,-806.189C31.5113,-894.603 41.8368,-1435.46 94,-1483 150.499,-1534.49 197.005,-1515.92 266,-1483 404.388,-1416.98 460.387,-1215.14 475.502,-1147.99"/>
<polygon fill="#000000" stroke="#000000" points="478.953,-1148.59 477.653,-1138.07 472.112,-1147.1 478.953,-1148.59"/>
</g>
<!-- digcel -->
<g id="proc~~dhscf_init~~CallsGraph_node19" class="node"><title>digcel</title>
<polygon fill="#777777" stroke="#777777" points="207,-890 153,-890 153,-866 207,-866 207,-890"/>
<text text-anchor="middle" x="180" y="-875.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">digcel</text>
</g>
<!-- proc~dhscf_init&#45;&gt;digcel -->
<g id="proc~~dhscf_init~~CallsGraph_edge34" class="edge"><title>proc~dhscf_init&#45;&gt;digcel</title>
<path fill="none" stroke="#000000" d="M38.983,-806.173C50.2343,-820.527 70.8661,-844.064 94,-857 108.91,-865.337 127.11,-870.402 142.838,-873.46"/>
<polygon fill="#000000" stroke="#000000" points="142.304,-876.92 152.758,-875.194 143.51,-870.024 142.304,-876.92"/>
</g>
<!-- proc~reord -->
<g id="proc~~dhscf_init~~CallsGraph_node20" class="node"><title>proc~reord</title>
<g id="a_proc~~dhscf_init~~CallsGraph_node20"><a xlink:href=".././proc/reord.html" xlink:title="reord">
<polygon fill="#d9534f" stroke="#d9534f" points="508,-612 454,-612 454,-588 508,-588 508,-612"/>
<text text-anchor="middle" x="481" y="-597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reord</text>
</a>
</g>
</g>
<!-- proc~dhscf_init&#45;&gt;proc~reord -->
<g id="proc~~dhscf_init~~CallsGraph_edge15" class="edge"><title>proc~dhscf_init&#45;&gt;proc~reord</title>
<path fill="none" stroke="#000000" d="M33.8662,-781.715C41.5266,-759.487 60.8235,-712.706 94,-689 157.698,-643.485 189.698,-668.52 266,-651 328.588,-636.629 401.275,-619.136 443.796,-608.821"/>
<polygon fill="#000000" stroke="#000000" points="444.785,-612.182 453.677,-606.421 443.133,-605.38 444.785,-612.182"/>
</g>
<!-- init_mesh_node -->
<g id="proc~~dhscf_init~~CallsGraph_node21" class="node"><title>init_mesh_node</title>
<polygon fill="#777777" stroke="#777777" points="224,-806 136,-806 136,-782 224,-782 224,-806"/>
<text text-anchor="middle" x="180" y="-791.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_mesh_node</text>
</g>
<!-- proc~dhscf_init&#45;&gt;init_mesh_node -->
<g id="proc~~dhscf_init~~CallsGraph_edge22" class="edge"><title>proc~dhscf_init&#45;&gt;init_mesh_node</title>
<path fill="none" stroke="#000000" d="M58.0258,-794C77.0328,-794 102.76,-794 125.602,-794"/>
<polygon fill="#000000" stroke="#000000" points="125.859,-797.5 135.859,-794 125.859,-790.5 125.859,-797.5"/>
</g>
<!-- setgga -->
<g id="proc~~dhscf_init~~CallsGraph_node22" class="node"><title>setgga</title>
<polygon fill="#777777" stroke="#777777" points="207,-764 153,-764 153,-740 207,-740 207,-764"/>
<text text-anchor="middle" x="180" y="-749.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setgga</text>
</g>
<!-- proc~dhscf_init&#45;&gt;setgga -->
<g id="proc~~dhscf_init~~CallsGraph_edge23" class="edge"><title>proc~dhscf_init&#45;&gt;setgga</title>
<path fill="none" stroke="#000000" d="M58.2142,-784.238C69.311,-780.531 82.1983,-776.389 94,-773 109.907,-768.432 127.658,-763.951 142.807,-760.31"/>
<polygon fill="#000000" stroke="#000000" points="143.904,-763.647 152.825,-757.932 142.287,-756.836 143.904,-763.647"/>
</g>
<!-- phionmesh -->
<g id="proc~~dhscf_init~~CallsGraph_node23" class="node"><title>phionmesh</title>
<polygon fill="#777777" stroke="#777777" points="212.5,-722 147.5,-722 147.5,-698 212.5,-698 212.5,-722"/>
<text text-anchor="middle" x="180" y="-707.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">phionmesh</text>
</g>
<!-- proc~dhscf_init&#45;&gt;phionmesh -->
<g id="proc~~dhscf_init~~CallsGraph_edge24" class="edge"><title>proc~dhscf_init&#45;&gt;phionmesh</title>
<path fill="none" stroke="#000000" d="M38.983,-781.827C50.2343,-767.473 70.8661,-743.936 94,-731 107.131,-723.657 122.815,-718.853 137.114,-715.722"/>
<polygon fill="#000000" stroke="#000000" points="138.092,-719.097 147.225,-713.726 136.736,-712.229 138.092,-719.097"/>
</g>
<!-- proc~rcut -->
<g id="proc~~dhscf_init~~CallsGraph_node24" class="node"><title>proc~rcut</title>
<g id="a_proc~~dhscf_init~~CallsGraph_node24"><a xlink:href=".././proc/rcut.html" xlink:title="rcut">
<polygon fill="#d94e8f" stroke="#d94e8f" points="207,-1474 153,-1474 153,-1450 207,-1450 207,-1474"/>
<text text-anchor="middle" x="180" y="-1459.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rcut</text>
</a>
</g>
</g>
<!-- proc~dhscf_init&#45;&gt;proc~rcut -->
<g id="proc~~dhscf_init~~CallsGraph_edge36" class="edge"><title>proc~dhscf_init&#45;&gt;proc~rcut</title>
<path fill="none" stroke="#000000" d="M30.3705,-806.135C33.0609,-890.777 50.7326,-1391.03 94,-1441 105.865,-1454.7 125.12,-1460.2 142.306,-1462.16"/>
<polygon fill="#000000" stroke="#000000" points="142.413,-1465.68 152.654,-1462.96 142.956,-1458.7 142.413,-1465.68"/>
</g>
<!-- initialize_efield -->
<g id="proc~~dhscf_init~~CallsGraph_node25" class="node"><title>initialize_efield</title>
<polygon fill="#777777" stroke="#777777" points="221,-642 139,-642 139,-618 221,-618 221,-642"/>
<text text-anchor="middle" x="180" y="-627.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">initialize_efield</text>
</g>
<!-- proc~dhscf_init&#45;&gt;initialize_efield -->
<g id="proc~~dhscf_init~~CallsGraph_edge4" class="edge"><title>proc~dhscf_init&#45;&gt;initialize_efield</title>
<path fill="none" stroke="#000000" d="M32.2123,-781.657C37.6816,-754.762 54.3748,-690.523 94,-656 103.824,-647.441 116.413,-641.7 128.875,-637.848"/>
<polygon fill="#000000" stroke="#000000" points="130.059,-641.153 138.787,-635.147 128.219,-634.4 130.059,-641.153"/>
</g>
<!-- getxc -->
<g id="proc~~dhscf_init~~CallsGraph_node26" class="node"><title>getxc</title>
<polygon fill="#777777" stroke="#777777" points="207,-600 153,-600 153,-576 207,-576 207,-600"/>
<text text-anchor="middle" x="180" y="-585.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">getxc</text>
</g>
<!-- proc~dhscf_init&#45;&gt;getxc -->
<g id="proc~~dhscf_init~~CallsGraph_edge37" class="edge"><title>proc~dhscf_init&#45;&gt;getxc</title>
<path fill="none" stroke="#000000" d="M30.4004,-781.954C32.1736,-749.003 41.7962,-656.664 94,-609 107.2,-596.947 126.209,-591.537 142.904,-589.209"/>
<polygon fill="#000000" stroke="#000000" points="143.362,-592.68 152.928,-588.126 142.61,-585.72 143.362,-592.68"/>
</g>
<!-- createlocaldscfpointers -->
<g id="proc~~dhscf_init~~CallsGraph_node27" class="node"><title>createlocaldscfpointers</title>
<polygon fill="#777777" stroke="#777777" points="241,-558 119,-558 119,-534 241,-534 241,-558"/>
<text text-anchor="middle" x="180" y="-543.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">createlocaldscfpointers</text>
</g>
<!-- proc~dhscf_init&#45;&gt;createlocaldscfpointers -->
<g id="proc~~dhscf_init~~CallsGraph_edge26" class="edge"><title>proc~dhscf_init&#45;&gt;createlocaldscfpointers</title>
<path fill="none" stroke="#000000" d="M29.5002,-781.806C28.655,-743.975 31.4798,-627.515 94,-567 98.4081,-562.733 103.539,-559.29 109.055,-556.516"/>
<polygon fill="#000000" stroke="#000000" points="110.801,-559.578 118.643,-552.454 108.07,-553.133 110.801,-559.578"/>
</g>
<!-- init_charge_add -->
<g id="proc~~dhscf_init~~CallsGraph_node28" class="node"><title>init_charge_add</title>
<polygon fill="#777777" stroke="#777777" points="224.5,-516 135.5,-516 135.5,-492 224.5,-492 224.5,-516"/>
<text text-anchor="middle" x="180" y="-501.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_charge_add</text>
</g>
<!-- proc~dhscf_init&#45;&gt;init_charge_add -->
<g id="proc~~dhscf_init~~CallsGraph_edge27" class="edge"><title>proc~dhscf_init&#45;&gt;init_charge_add</title>
<path fill="none" stroke="#000000" d="M31.2353,-781.762C36.2782,-734.21 56.8224,-562.5 94,-525 102.445,-516.482 113.759,-511.22 125.371,-508.016"/>
<polygon fill="#000000" stroke="#000000" points="126.172,-511.424 135.14,-505.782 124.611,-504.6 126.172,-511.424"/>
</g>
<!-- neutralatomonmesh -->
<g id="proc~~dhscf_init~~CallsGraph_node29" class="node"><title>neutralatomonmesh</title>
<polygon fill="#777777" stroke="#777777" points="234,-474 126,-474 126,-450 234,-450 234,-474"/>
<text text-anchor="middle" x="180" y="-459.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">neutralatomonmesh</text>
</g>
<!-- proc~dhscf_init&#45;&gt;neutralatomonmesh -->
<g id="proc~~dhscf_init~~CallsGraph_edge28" class="edge"><title>proc~dhscf_init&#45;&gt;neutralatomonmesh</title>
<path fill="none" stroke="#000000" d="M30.8174,-781.688C34.5298,-729.501 51.4954,-527.207 94,-483 100.124,-476.631 107.849,-472.072 116.132,-468.828"/>
<polygon fill="#000000" stroke="#000000" points="117.255,-472.143 125.666,-465.7 115.073,-465.492 117.255,-472.143"/>
</g>
<!-- interface~distmeshdata -->
<g id="proc~~dhscf_init~~CallsGraph_node30" class="node"><title>interface~distmeshdata</title>
<g id="a_proc~~dhscf_init~~CallsGraph_node30"><a xlink:href=".././interface/distmeshdata.html" xlink:title="distMeshData">
<polygon fill="#a7506f" stroke="#a7506f" points="219,-848 141,-848 141,-824 219,-824 219,-848"/>
<text text-anchor="middle" x="180" y="-833.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">distMeshData</text>
</a>
</g>
</g>
<!-- proc~dhscf_init&#45;&gt;interface~distmeshdata -->
<g id="proc~~dhscf_init~~CallsGraph_edge29" class="edge"><title>proc~dhscf_init&#45;&gt;interface~distmeshdata</title>
<path fill="none" stroke="#000000" d="M58.2142,-803.762C69.311,-807.469 82.1983,-811.611 94,-815 105.871,-818.409 118.769,-821.769 130.846,-824.768"/>
<polygon fill="#000000" stroke="#000000" points="130.211,-828.216 140.757,-827.196 131.877,-821.417 130.211,-828.216"/>
</g>
<!-- elecs -->
<g id="proc~~dhscf_init~~CallsGraph_node31" class="node"><title>elecs</title>
<polygon fill="#777777" stroke="#777777" points="207,-394 153,-394 153,-370 207,-370 207,-394"/>
<text text-anchor="middle" x="180" y="-379.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elecs</text>
</g>
<!-- proc~dhscf_init&#45;&gt;elecs -->
<g id="proc~~dhscf_init~~CallsGraph_edge30" class="edge"><title>proc~dhscf_init&#45;&gt;elecs</title>
<path fill="none" stroke="#000000" d="M30.3476,-781.719C32.2702,-722.368 43.4362,-465.752 94,-408 106.122,-394.154 125.395,-387.566 142.526,-384.478"/>
<polygon fill="#000000" stroke="#000000" points="143.443,-387.882 152.833,-382.975 142.432,-380.955 143.443,-387.882"/>
</g>
<!-- timer -->
<g id="proc~~dhscf_init~~CallsGraph_node32" class="node"><title>timer</title>
<polygon fill="#777777" stroke="#777777" points="620.5,-572 566.5,-572 566.5,-548 620.5,-548 620.5,-572"/>
<text text-anchor="middle" x="593.5" y="-557.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">timer</text>
</g>
<!-- proc~dhscf_init&#45;&gt;timer -->
<g id="proc~~dhscf_init~~CallsGraph_edge6" class="edge"><title>proc~dhscf_init&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M30.455,-781.777C33.484,-703.669 51.914,-276.512 94,-239 151.067,-188.136 193.853,-213.73 266,-239 404.485,-287.504 427.565,-334.405 524,-445 549.638,-474.403 571.108,-514.695 582.851,-538.951"/>
<polygon fill="#000000" stroke="#000000" points="579.691,-540.456 587.136,-547.993 586.016,-537.458 579.691,-540.456"/>
</g>
<!-- shaper -->
<g id="proc~~dhscf_init~~CallsGraph_node33" class="node"><title>shaper</title>
<polygon fill="#777777" stroke="#777777" points="207,-314 153,-314 153,-290 207,-290 207,-314"/>
<text text-anchor="middle" x="180" y="-299.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">shaper</text>
</g>
<!-- proc~dhscf_init&#45;&gt;shaper -->
<g id="proc~~dhscf_init~~CallsGraph_edge32" class="edge"><title>proc~dhscf_init&#45;&gt;shaper</title>
<path fill="none" stroke="#000000" d="M29.963,-781.919C30.0034,-715.905 33.3912,-399.2 94,-328 105.929,-313.987 125.188,-307.387 142.36,-304.335"/>
<polygon fill="#000000" stroke="#000000" points="143.294,-307.737 152.698,-302.859 142.304,-300.808 143.294,-307.737"/>
</g>
<!-- user_specified_field -->
<g id="proc~~dhscf_init~~CallsGraph_node34" class="node"><title>user_specified_field</title>
<polygon fill="#777777" stroke="#777777" points="233.5,-272 126.5,-272 126.5,-248 233.5,-248 233.5,-272"/>
<text text-anchor="middle" x="180" y="-257.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">user_specified_field</text>
</g>
<!-- proc~dhscf_init&#45;&gt;user_specified_field -->
<g id="proc~~dhscf_init~~CallsGraph_edge33" class="edge"><title>proc~dhscf_init&#45;&gt;user_specified_field</title>
<path fill="none" stroke="#000000" d="M29.7251,-781.588C28.4155,-710.762 25.4496,-358.164 94,-281 100.153,-274.073 108.195,-269.255 116.878,-265.933"/>
<polygon fill="#000000" stroke="#000000" points="118.015,-269.244 126.491,-262.887 115.901,-262.571 118.015,-269.244"/>
</g>
<!-- write_debug -->
<g id="proc~~dhscf_init~~CallsGraph_node35" class="node"><title>write_debug</title>
<polygon fill="#777777" stroke="#777777" points="516.5,-503 445.5,-503 445.5,-479 516.5,-479 516.5,-503"/>
<text text-anchor="middle" x="481" y="-488.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_debug</text>
</g>
<!-- proc~dhscf_init&#45;&gt;write_debug -->
<g id="proc~~dhscf_init~~CallsGraph_edge20" class="edge"><title>proc~dhscf_init&#45;&gt;write_debug</title>
<path fill="none" stroke="#000000" d="M29.7758,-781.625C28.8884,-716.843 28.4185,-417.601 94,-361 207.479,-263.061 397.695,-416.458 459.753,-472.105"/>
<polygon fill="#000000" stroke="#000000" points="457.563,-474.844 467.319,-478.977 462.27,-469.663 457.563,-474.844"/>
</g>
<!-- cdf_init_mesh -->
<g id="proc~~dhscf_init~~CallsGraph_node36" class="node"><title>cdf_init_mesh</title>
<polygon fill="#777777" stroke="#777777" points="219.5,-192 140.5,-192 140.5,-168 219.5,-168 219.5,-192"/>
<text text-anchor="middle" x="180" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cdf_init_mesh</text>
</g>
<!-- proc~dhscf_init&#45;&gt;cdf_init_mesh -->
<g id="proc~~dhscf_init~~CallsGraph_edge35" class="edge"><title>proc~dhscf_init&#45;&gt;cdf_init_mesh</title>
<path fill="none" stroke="#000000" d="M30.5221,-781.987C34.0855,-702.336 55.8302,-252.136 94,-206 103.103,-194.997 116.732,-188.551 130.425,-184.806"/>
<polygon fill="#000000" stroke="#000000" points="131.379,-188.178 140.343,-182.53 129.813,-181.355 131.379,-188.178"/>
</g>
<!-- set_box_limits -->
<g id="proc~~dhscf_init~~CallsGraph_node37" class="node"><title>set_box_limits</title>
<polygon fill="#777777" stroke="#777777" points="220,-150 140,-150 140,-126 220,-126 220,-150"/>
<text text-anchor="middle" x="180" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_box_limits</text>
</g>
<!-- proc~dhscf_init&#45;&gt;set_box_limits -->
<g id="proc~~dhscf_init~~CallsGraph_edge17" class="edge"><title>proc~dhscf_init&#45;&gt;set_box_limits</title>
<path fill="none" stroke="#000000" d="M30.3957,-781.822C33.2273,-697.965 51.5272,-207.965 94,-159 102.969,-148.66 116.145,-142.996 129.459,-139.998"/>
<polygon fill="#000000" stroke="#000000" points="130.368,-143.391 139.599,-138.191 129.14,-136.499 130.368,-143.391"/>
</g>
<!-- rhooda -->
<g id="proc~~dhscf_init~~CallsGraph_node38" class="node"><title>rhooda</title>
<polygon fill="#777777" stroke="#777777" points="207,-108 153,-108 153,-84 207,-84 207,-108"/>
<text text-anchor="middle" x="180" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rhooda</text>
</g>
<!-- proc~dhscf_init&#45;&gt;rhooda -->
<g id="proc~~dhscf_init~~CallsGraph_edge25" class="edge"><title>proc~dhscf_init&#45;&gt;rhooda</title>
<path fill="none" stroke="#000000" d="M30.3146,-781.865C32.6739,-694.985 48.7626,-169.479 94,-117 105.835,-103.27 125.088,-97.7748 142.28,-95.8216"/>
<polygon fill="#000000" stroke="#000000" points="142.933,-99.2817 152.634,-95.0213 142.394,-92.3025 142.933,-99.2817"/>
</g>
<!-- compute_doping_structs_uniform -->
<g id="proc~~dhscf_init~~CallsGraph_node39" class="node"><title>compute_doping_structs_uniform</title>
<polygon fill="#777777" stroke="#777777" points="266,-66 94,-66 94,-42 266,-42 266,-66"/>
<text text-anchor="middle" x="180" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_doping_structs_uniform</text>
</g>
<!-- proc~dhscf_init&#45;&gt;compute_doping_structs_uniform -->
<g id="proc~~dhscf_init~~CallsGraph_edge38" class="edge"><title>proc~dhscf_init&#45;&gt;compute_doping_structs_uniform</title>
<path fill="none" stroke="#000000" d="M30.2417,-781.984C32.1489,-692.43 45.9801,-131.017 94,-75 94.742,-74.1345 95.5134,-73.3016 96.312,-72.5003"/>
<polygon fill="#000000" stroke="#000000" points="98.6204,-75.1342 104.168,-66.1076 94.2021,-69.7048 98.6204,-75.1342"/>
</g>
<!-- ddot -->
<g id="proc~~dhscf_init~~CallsGraph_node40" class="node"><title>ddot</title>
<polygon fill="#777777" stroke="#777777" points="207,-24 153,-24 153,-0 207,-0 207,-24"/>
<text text-anchor="middle" x="180" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ddot</text>
</g>
<!-- proc~dhscf_init&#45;&gt;ddot -->
<g id="proc~~dhscf_init~~CallsGraph_edge39" class="edge"><title>proc~dhscf_init&#45;&gt;ddot</title>
<path fill="none" stroke="#000000" d="M30.1813,-781.881C31.6771,-689.038 43.2335,-92.5138 94,-33 105.846,-19.1133 125.28,-13.6336 142.578,-11.7294"/>
<polygon fill="#000000" stroke="#000000" points="143.269,-15.1881 152.985,-10.9627 142.755,-8.207 143.269,-15.1881"/>
</g>
<!-- proc~chk -->
<g id="proc~~dhscf_init~~CallsGraph_node41" class="node"><title>proc~chk</title>
<g id="a_proc~~dhscf_init~~CallsGraph_node41"><a xlink:href=".././proc/chk.html" xlink:title="chk">
<polygon fill="#d9534f" stroke="#d9534f" points="379,-1306 325,-1306 325,-1282 379,-1282 379,-1306"/>
<text text-anchor="middle" x="352" y="-1291.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">chk</text>
</a>
</g>
</g>
<!-- proc~rcore&#45;&gt;proc~chk -->
<g id="proc~~dhscf_init~~CallsGraph_edge40" class="edge"><title>proc~rcore&#45;&gt;proc~chk</title>
<path fill="none" stroke="#000000" d="M207.19,-1294C235.892,-1294 282.14,-1294 314.416,-1294"/>
<polygon fill="#000000" stroke="#000000" points="314.78,-1297.5 324.78,-1294 314.78,-1290.5 314.78,-1297.5"/>
</g>
<!-- io_close -->
<g id="proc~~dhscf_init~~CallsGraph_node42" class="node"><title>io_close</title>
<polygon fill="#777777" stroke="#777777" points="620.5,-1117 566.5,-1117 566.5,-1093 620.5,-1093 620.5,-1117"/>
<text text-anchor="middle" x="593.5" y="-1102.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">io_close</text>
</g>
<!-- proc~die&#45;&gt;io_close -->
<g id="proc~~dhscf_init~~CallsGraph_edge41" class="edge"><title>proc~die&#45;&gt;io_close</title>
<path fill="none" stroke="#000000" d="M508.187,-1121.02C522.532,-1118.3 540.53,-1114.88 556.211,-1111.9"/>
<polygon fill="#000000" stroke="#000000" points="556.947,-1115.32 566.118,-1110.01 555.64,-1108.44 556.947,-1115.32"/>
</g>
<!-- cmlfinishfile -->
<g id="proc~~dhscf_init~~CallsGraph_node43" class="node"><title>cmlfinishfile</title>
<polygon fill="#777777" stroke="#777777" points="627,-1075 560,-1075 560,-1051 627,-1051 627,-1075"/>
<text text-anchor="middle" x="593.5" y="-1060.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cmlfinishfile</text>
</g>
<!-- proc~die&#45;&gt;cmlfinishfile -->
<g id="proc~~dhscf_init~~CallsGraph_edge42" class="edge"><title>proc~die&#45;&gt;cmlfinishfile</title>
<path fill="none" stroke="#000000" d="M503.306,-1113.85C520.121,-1104.27 543.785,-1090.77 562.514,-1080.1"/>
<polygon fill="#000000" stroke="#000000" points="564.306,-1083.1 571.26,-1075.11 560.839,-1077.02 564.306,-1083.1"/>
</g>
<!-- io_assign -->
<g id="proc~~dhscf_init~~CallsGraph_node44" class="node"><title>io_assign</title>
<polygon fill="#777777" stroke="#777777" points="622.5,-1033 564.5,-1033 564.5,-1009 622.5,-1009 622.5,-1033"/>
<text text-anchor="middle" x="593.5" y="-1018.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">io_assign</text>
</g>
<!-- proc~die&#45;&gt;io_assign -->
<g id="proc~~dhscf_init~~CallsGraph_edge43" class="edge"><title>proc~die&#45;&gt;io_assign</title>
<path fill="none" stroke="#000000" d="M491.518,-1113.99C505.448,-1096.84 532.709,-1064.9 560,-1042 561.158,-1041.03 562.363,-1040.07 563.599,-1039.12"/>
<polygon fill="#000000" stroke="#000000" points="565.89,-1041.78 572.009,-1033.13 561.832,-1036.08 565.89,-1041.78"/>
</g>
<!-- pxfabort -->
<g id="proc~~dhscf_init~~CallsGraph_node45" class="node"><title>pxfabort</title>
<polygon fill="#777777" stroke="#777777" points="620.5,-1243 566.5,-1243 566.5,-1219 620.5,-1219 620.5,-1243"/>
<text text-anchor="middle" x="593.5" y="-1228.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pxfabort</text>
</g>
<!-- proc~die&#45;&gt;pxfabort -->
<g id="proc~~dhscf_init~~CallsGraph_edge44" class="edge"><title>proc~die&#45;&gt;pxfabort</title>
<path fill="none" stroke="#000000" d="M491.518,-1138.01C505.448,-1155.16 532.709,-1187.1 560,-1210 561.158,-1210.97 562.363,-1211.93 563.599,-1212.88"/>
<polygon fill="#000000" stroke="#000000" points="561.832,-1215.92 572.009,-1218.87 565.89,-1210.22 561.832,-1215.92"/>
</g>
<!-- mpi_abort -->
<g id="proc~~dhscf_init~~CallsGraph_node46" class="node"><title>mpi_abort</title>
<polygon fill="#777777" stroke="#777777" points="624,-1201 563,-1201 563,-1177 624,-1177 624,-1201"/>
<text text-anchor="middle" x="593.5" y="-1186.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_abort</text>
</g>
<!-- proc~die&#45;&gt;mpi_abort -->
<g id="proc~~dhscf_init~~CallsGraph_edge45" class="edge"><title>proc~die&#45;&gt;mpi_abort</title>
<path fill="none" stroke="#000000" d="M503.306,-1138.15C520.121,-1147.73 543.785,-1161.23 562.514,-1171.9"/>
<polygon fill="#000000" stroke="#000000" points="560.839,-1174.98 571.26,-1176.89 564.306,-1168.9 560.839,-1174.98"/>
</g>
<!-- pxfflush -->
<g id="proc~~dhscf_init~~CallsGraph_node47" class="node"><title>pxfflush</title>
<polygon fill="#777777" stroke="#777777" points="620.5,-1159 566.5,-1159 566.5,-1135 620.5,-1135 620.5,-1159"/>
<text text-anchor="middle" x="593.5" y="-1144.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pxfflush</text>
</g>
<!-- proc~die&#45;&gt;pxfflush -->
<g id="proc~~dhscf_init~~CallsGraph_edge46" class="edge"><title>proc~die&#45;&gt;pxfflush</title>
<path fill="none" stroke="#000000" d="M508.187,-1130.98C522.532,-1133.7 540.53,-1137.12 556.211,-1140.1"/>
<polygon fill="#000000" stroke="#000000" points="555.64,-1143.56 566.118,-1141.99 556.947,-1136.68 555.64,-1143.56"/>
</g>
<!-- proc~reord&#45;&gt;re_alloc -->
<g id="proc~~dhscf_init~~CallsGraph_edge47" class="edge"><title>proc~reord&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M508.187,-604.977C522.532,-607.703 540.53,-611.123 556.211,-614.103"/>
<polygon fill="#000000" stroke="#000000" points="555.64,-617.558 566.118,-615.986 556.947,-610.681 555.64,-617.558"/>
</g>
<!-- proc~reord&#45;&gt;de_alloc -->
<g id="proc~~dhscf_init~~CallsGraph_edge48" class="edge"><title>proc~reord&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M491.841,-612.136C500.932,-623.712 514.436,-641.875 524,-659 550.754,-706.904 573.699,-767.373 585,-799.167"/>
<polygon fill="#000000" stroke="#000000" points="581.763,-800.512 588.375,-808.79 588.369,-798.195 581.763,-800.512"/>
</g>
<!-- proc~reord&#45;&gt;timer -->
<g id="proc~~dhscf_init~~CallsGraph_edge49" class="edge"><title>proc~reord&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M508.187,-590.521C522.668,-585.278 540.874,-578.688 556.658,-572.975"/>
<polygon fill="#000000" stroke="#000000" points="557.907,-576.245 566.118,-569.55 555.524,-569.663 557.907,-576.245"/>
</g>
<!-- proc~rcut&#45;&gt;proc~chk -->
<g id="proc~~dhscf_init~~CallsGraph_edge50" class="edge"><title>proc~rcut&#45;&gt;proc~chk</title>
<path fill="none" stroke="#000000" d="M207.061,-1460.85C225.16,-1458.87 248.986,-1453.78 266,-1441 308.774,-1408.86 333.619,-1348.41 344.459,-1315.94"/>
<polygon fill="#000000" stroke="#000000" points="347.899,-1316.68 347.604,-1306.09 341.23,-1314.55 347.899,-1316.68"/>
</g>
<!-- proc~distmeshdata_int -->
<g id="proc~~dhscf_init~~CallsGraph_node48" class="node"><title>proc~distmeshdata_int</title>
<g id="a_proc~~dhscf_init~~CallsGraph_node48"><a xlink:href=".././proc/distmeshdata_int.html" xlink:title="distMeshData_int">
<polygon fill="#d9534f" stroke="#d9534f" points="399.5,-854 304.5,-854 304.5,-830 399.5,-830 399.5,-854"/>
<text text-anchor="middle" x="352" y="-839.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">distMeshData_int</text>
</a>
</g>
</g>
<!-- interface~distmeshdata&#45;&gt;proc~distmeshdata_int -->
<g id="proc~~dhscf_init~~CallsGraph_edge52" class="edge"><title>interface~distmeshdata&#45;&gt;proc~distmeshdata_int</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M219.151,-837.347C241.35,-838.13 269.747,-839.132 294.499,-840.006"/>
<polygon fill="#000000" stroke="#000000" points="294.379,-843.504 304.496,-840.359 294.626,-836.508 294.379,-843.504"/>
</g>
<!-- proc~distmeshdata_rea -->
<g id="proc~~dhscf_init~~CallsGraph_node49" class="node"><title>proc~distmeshdata_rea</title>
<g id="a_proc~~dhscf_init~~CallsGraph_node49"><a xlink:href=".././proc/distmeshdata_rea.html" xlink:title="distMeshData_rea">
<polygon fill="#d9534f" stroke="#d9534f" points="402,-728 302,-728 302,-704 402,-704 402,-728"/>
<text text-anchor="middle" x="352" y="-713.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">distMeshData_rea</text>
</a>
</g>
</g>
<!-- interface~distmeshdata&#45;&gt;proc~distmeshdata_rea -->
<g id="proc~~dhscf_init~~CallsGraph_edge51" class="edge"><title>interface~distmeshdata&#45;&gt;proc~distmeshdata_rea</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M219.362,-831.688C234.707,-828.688 252.02,-823.606 266,-815 298.046,-795.274 324.293,-759.464 338.774,-736.749"/>
<polygon fill="#000000" stroke="#000000" points="341.789,-738.528 344.073,-728.182 335.836,-734.845 341.789,-738.528"/>
</g>
<!-- proc~chk&#45;&gt;proc~die -->
<g id="proc~~dhscf_init~~CallsGraph_edge53" class="edge"><title>proc~chk&#45;&gt;proc~die</title>
<path fill="none" stroke="#000000" d="M362.134,-1281.92C383.63,-1253.48 437.622,-1182.06 464.417,-1146.61"/>
<polygon fill="#000000" stroke="#000000" points="467.368,-1148.51 470.607,-1138.43 461.784,-1144.29 467.368,-1148.51"/>
</g>
<!-- proc~distmeshdata_int&#45;&gt;re_alloc -->
<g id="proc~~dhscf_init~~CallsGraph_edge54" class="edge"><title>proc~distmeshdata_int&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M399.849,-849.467C437.429,-852.738 489.433,-850.797 524,-823 579.763,-778.159 590.372,-685.923 592.222,-643.389"/>
<polygon fill="#000000" stroke="#000000" points="595.725,-643.349 592.534,-633.246 588.728,-643.133 595.725,-643.349"/>
</g>
<!-- proc~distmeshdata_int&#45;&gt;de_alloc -->
<g id="proc~~dhscf_init~~CallsGraph_edge56" class="edge"><title>proc~distmeshdata_int&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M399.698,-853.673C434.423,-860.469 482.732,-865.932 524,-856 538.692,-852.464 553.78,-845.216 566.042,-838.228"/>
<polygon fill="#000000" stroke="#000000" points="568.016,-841.126 574.815,-833 564.433,-835.112 568.016,-841.126"/>
</g>
<!-- proc~distmeshdata_int&#45;&gt;proc~die -->
<g id="proc~~dhscf_init~~CallsGraph_edge57" class="edge"><title>proc~distmeshdata_int&#45;&gt;proc~die</title>
<path fill="none" stroke="#000000" d="M358.457,-854.203C378.078,-898.081 445.214,-1048.21 470.375,-1104.48"/>
<polygon fill="#000000" stroke="#000000" points="467.286,-1106.14 474.563,-1113.84 473.676,-1103.28 467.286,-1106.14"/>
</g>
<!-- proc~boxintersection -->
<g id="proc~~dhscf_init~~CallsGraph_node51" class="node"><title>proc~boxintersection</title>
<g id="a_proc~~dhscf_init~~CallsGraph_node51"><a xlink:href=".././proc/boxintersection.html" xlink:title="boxIntersection">
<polygon fill="#d9534f" stroke="#d9534f" points="523.5,-814 438.5,-814 438.5,-790 523.5,-790 523.5,-814"/>
<text text-anchor="middle" x="481" y="-799.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">boxIntersection</text>
</a>
</g>
</g>
<!-- proc~distmeshdata_int&#45;&gt;proc~boxintersection -->
<g id="proc~~dhscf_init~~CallsGraph_edge55" class="edge"><title>proc~distmeshdata_int&#45;&gt;proc~boxintersection</title>
<path fill="none" stroke="#000000" d="M391.104,-829.999C403.921,-825.962 418.391,-821.404 431.876,-817.157"/>
<polygon fill="#000000" stroke="#000000" points="432.997,-820.474 441.484,-814.131 430.894,-813.797 432.997,-820.474"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;re_alloc -->
<g id="proc~~dhscf_init~~CallsGraph_edge61" class="edge"><title>proc~distmeshdata_rea&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M371.697,-703.968C380.869,-698.02 392.056,-690.698 402,-684 418.157,-673.118 420.246,-667.015 438,-659 476.452,-641.64 524.016,-631.468 556.133,-626.087"/>
<polygon fill="#000000" stroke="#000000" points="557.077,-629.481 566.397,-624.442 555.969,-622.569 557.077,-629.481"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;de_alloc -->
<g id="proc~~dhscf_init~~CallsGraph_edge64" class="edge"><title>proc~distmeshdata_rea&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M390.093,-728.11C425.234,-740.045 479.155,-759.565 524,-781 537.862,-787.626 552.651,-796.073 564.927,-803.496"/>
<polygon fill="#000000" stroke="#000000" points="563.414,-806.675 573.767,-808.926 567.078,-800.71 563.414,-806.675"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;proc~die -->
<g id="proc~~dhscf_init~~CallsGraph_edge66" class="edge"><title>proc~distmeshdata_rea&#45;&gt;proc~die</title>
<path fill="none" stroke="#000000" d="M359.656,-728.289C369.89,-747.576 389.602,-786.337 402,-821 438.956,-924.321 465.92,-1053.17 475.835,-1103.96"/>
<polygon fill="#000000" stroke="#000000" points="472.41,-1104.68 477.739,-1113.84 479.283,-1103.36 472.41,-1104.68"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;proc~reord -->
<g id="proc~~dhscf_init~~CallsGraph_edge60" class="edge"><title>proc~distmeshdata_rea&#45;&gt;proc~reord</title>
<path fill="none" stroke="#000000" d="M376.001,-703.849C384.778,-698.513 394.473,-691.703 402,-684 423.205,-662.301 416.534,-647.441 438,-626 441.003,-623 444.416,-620.188 447.966,-617.604"/>
<polygon fill="#000000" stroke="#000000" points="449.991,-620.461 456.375,-612.005 446.112,-614.634 449.991,-620.461"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;timer -->
<g id="proc~~dhscf_init~~CallsGraph_edge62" class="edge"><title>proc~distmeshdata_rea&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M356.521,-703.943C365.233,-676.48 390.601,-609.309 438,-579 473.439,-556.338 522.9,-554.21 556.23,-556.024"/>
<polygon fill="#000000" stroke="#000000" points="556.229,-559.532 566.447,-556.73 556.712,-552.548 556.229,-559.532"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;write_debug -->
<g id="proc~~dhscf_init~~CallsGraph_edge65" class="edge"><title>proc~distmeshdata_rea&#45;&gt;write_debug</title>
<path fill="none" stroke="#000000" d="M358.222,-703.623C370.512,-674.978 402.887,-602.268 438,-546 445.553,-533.896 455.136,-521.187 463.241,-511.039"/>
<polygon fill="#000000" stroke="#000000" points="466.032,-513.153 469.624,-503.186 460.6,-508.738 466.032,-513.153"/>
</g>
<!-- mpitrace_event -->
<g id="proc~~dhscf_init~~CallsGraph_node50" class="node"><title>mpitrace_event</title>
<polygon fill="#777777" stroke="#777777" points="524,-734 438,-734 438,-710 524,-710 524,-734"/>
<text text-anchor="middle" x="481" y="-719.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpitrace_event</text>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;mpitrace_event -->
<g id="proc~~dhscf_init~~CallsGraph_edge58" class="edge"><title>proc~distmeshdata_rea&#45;&gt;mpitrace_event</title>
<path fill="none" stroke="#000000" d="M402.102,-718.32C410.438,-718.714 419.125,-719.124 427.544,-719.522"/>
<polygon fill="#000000" stroke="#000000" points="427.485,-723.023 437.639,-719.999 427.815,-716.031 427.485,-723.023"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;proc~boxintersection -->
<g id="proc~~dhscf_init~~CallsGraph_edge59" class="edge"><title>proc~distmeshdata_rea&#45;&gt;proc~boxintersection</title>
<path fill="none" stroke="#000000" d="M369.409,-728.026C386.38,-740.359 413.746,-759.954 438,-776 442.162,-778.753 446.601,-781.598 450.978,-784.351"/>
<polygon fill="#000000" stroke="#000000" points="449.422,-787.505 459.762,-789.813 453.118,-781.56 449.422,-787.505"/>
</g>
<!-- mpi_barrier -->
<g id="proc~~dhscf_init~~CallsGraph_node52" class="node"><title>mpi_barrier</title>
<polygon fill="#777777" stroke="#777777" points="514.5,-692 447.5,-692 447.5,-668 514.5,-668 514.5,-692"/>
<text text-anchor="middle" x="481" y="-677.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_barrier</text>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;mpi_barrier -->
<g id="proc~~dhscf_init~~CallsGraph_edge63" class="edge"><title>proc~distmeshdata_rea&#45;&gt;mpi_barrier</title>
<path fill="none" stroke="#000000" d="M395.642,-703.912C409.079,-700.103 423.918,-695.897 437.355,-692.088"/>
<polygon fill="#000000" stroke="#000000" points="438.645,-695.361 447.311,-689.266 436.736,-688.626 438.645,-695.361"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,-0 209.5,-0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.5,-24 454.5,-24 454.5,-0 551.5,-0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~dhscf_init~~CalledByGraph Pages: 1 -->
<svg id="procdhscf_initCalledByGraph" width="160pt" height="32pt"
 viewBox="0.00 0.00 160.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~dhscf_init~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~dhscf_init~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 156,-28 156,4 -4,4"/>
<!-- proc~dhscf_init -->
<g id="proc~~dhscf_init~~CalledByGraph_node1" class="node"><title>proc~dhscf_init</title>
<polygon fill="none" stroke="black" points="152,-24 94,-24 94,-0 152,-0 152,-24"/>
<text text-anchor="middle" x="123" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">dhscf_init</text>
</g>
<!-- proc~setup_h0 -->
<g id="proc~~dhscf_init~~CalledByGraph_node2" class="node"><title>proc~setup_h0</title>
<g id="a_proc~~dhscf_init~~CalledByGraph_node2"><a xlink:href=".././proc/setup_h0.html" xlink:title="setup_H0">
<polygon fill="#d9534f" stroke="#d9534f" points="58,-24 3.55271e-15,-24 3.55271e-15,-0 58,-0 58,-24"/>
<text text-anchor="middle" x="29" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_H0</text>
</a>
</g>
</g>
<!-- proc~setup_h0&#45;&gt;proc~dhscf_init -->
<g id="proc~~dhscf_init~~CalledByGraph_edge1" class="edge"><title>proc~setup_h0&#45;&gt;proc~dhscf_init</title>
<path fill="none" stroke="#000000" d="M58.1029,-12C66.1425,-12 75.0461,-12 83.5904,-12"/>
<polygon fill="#000000" stroke="#000000" points="83.7522,-15.5001 93.7521,-12 83.7521,-8.5001 83.7522,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,-0 209.5,-0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.5,-24 454.5,-24 454.5,-0 551.5,-0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/dhscf_init.html#src">dhscf_init</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>      <span class="k">subroutine </span><span class="n">dhscf_init</span><span class="p">(</span><span class="n">nspin</span><span class="p">,</span> <span class="n">norb</span><span class="p">,</span> <span class="n">iaorb</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span>
     <span class="p">&amp;</span>                      <span class="n">nuo</span><span class="p">,</span> <span class="n">nuotot</span><span class="p">,</span> <span class="n">nua</span><span class="p">,</span> <span class="n">na</span><span class="p">,</span>
     <span class="p">&amp;</span>                      <span class="n">isa</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">indxua</span><span class="p">,</span> <span class="n">ucell</span><span class="p">,</span>
     <span class="p">&amp;</span>                      <span class="n">mscell</span><span class="p">,</span> <span class="n">G2max</span><span class="p">,</span> <span class="n">ntm</span><span class="p">,</span>
     <span class="p">&amp;</span>                      <span class="n">maxnd</span><span class="p">,</span> <span class="n">numd</span><span class="p">,</span> <span class="n">listdptr</span><span class="p">,</span> <span class="n">listd</span><span class="p">,</span> <span class="n">datm</span><span class="p">,</span>
     <span class="p">&amp;</span>                      <span class="n">Fal</span><span class="p">,</span> <span class="n">stressl</span><span class="p">)</span>

      <span class="k">use </span><span class="nb">precision</span><span class="p">,</span>      <span class="n">only</span> <span class="p">:</span> <span class="n">dp</span><span class="p">,</span> <span class="n">grid_p</span>
      <span class="k">use </span><span class="n">parallel</span><span class="p">,</span>       <span class="n">only</span> <span class="p">:</span> <span class="n">Node</span><span class="p">,</span> <span class="n">Nodes</span>
      <span class="k">use </span><span class="n">atmfuncs</span><span class="p">,</span>       <span class="n">only</span> <span class="p">:</span> <span class="n">rcut</span><span class="p">,</span> <span class="n">rcore</span>
      <span class="k">use </span><span class="n">fdf</span>
      <span class="k">use </span><span class="n">sys</span><span class="p">,</span>            <span class="n">only</span> <span class="p">:</span> <span class="n">die</span>
      <span class="k">use </span><span class="n">mesh</span><span class="p">,</span>           <span class="n">only</span> <span class="p">:</span> <span class="n">xdsp</span><span class="p">,</span> <span class="n">nsm</span><span class="p">,</span> <span class="n">nsp</span><span class="p">,</span> <span class="n">meshLim</span>
      <span class="k">use </span><span class="n">parsing</span>
<span class="cp">#ifndef BSC_CELLXC</span>
      <span class="k">use </span><span class="n">siestaXC</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">getXC</span>        <span class="c">! Returns the XC functional used</span>
<span class="cp">#else /* BSC_CELLXC */</span>
      <span class="k">use </span><span class="n">bsc_xcmod</span><span class="p">,</span>          <span class="n">only</span> <span class="p">:</span> <span class="n">nXCfunc</span><span class="p">,</span> <span class="n">XCauth</span>
<span class="cp">#endif /* BSC_CELLXC */</span>
      <span class="k">use </span><span class="n">alloc</span><span class="p">,</span>          <span class="n">only</span> <span class="p">:</span> <span class="n">re_alloc</span><span class="p">,</span> <span class="n">de_alloc</span>
      <span class="k">use </span><span class="n">siesta_options</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">harrisfun</span>
      <span class="k">use </span><span class="n">meshsubs</span><span class="p">,</span>       <span class="n">only</span> <span class="p">:</span> <span class="n">PartialCoreOnMesh</span>
      <span class="k">use </span><span class="n">meshsubs</span><span class="p">,</span>       <span class="n">only</span> <span class="p">:</span> <span class="n">NeutralAtomOnMesh</span>
      <span class="k">use </span><span class="n">meshsubs</span><span class="p">,</span>       <span class="n">only</span> <span class="p">:</span> <span class="n">PhiOnMesh</span>
      <span class="k">use </span><span class="n">meshsubs</span><span class="p">,</span>       <span class="n">only</span> <span class="p">:</span> <span class="n">InitMesh</span>
      <span class="k">use </span><span class="n">meshsubs</span><span class="p">,</span>       <span class="n">only</span> <span class="p">:</span> <span class="n">InitAtomMesh</span>
      <span class="k">use </span><span class="n">meshsubs</span><span class="p">,</span>       <span class="n">only</span> <span class="p">:</span> <span class="n">setupExtMesh</span>
      <span class="k">use </span><span class="n">meshsubs</span><span class="p">,</span>       <span class="n">only</span> <span class="p">:</span> <span class="n">distriPhiOnMesh</span>

      <span class="k">use </span><span class="n">moreMeshSubs</span><span class="p">,</span>   <span class="n">only</span> <span class="p">:</span> <span class="n">setMeshDistr</span><span class="p">,</span> <span class="n">distMeshData</span>
      <span class="k">use </span><span class="n">moreMeshSubs</span><span class="p">,</span>   <span class="n">only</span> <span class="p">:</span> <span class="n">UNIFORM</span><span class="p">,</span> <span class="n">QUADRATIC</span><span class="p">,</span> <span class="n">LINEAR</span>
      <span class="k">use </span><span class="n">moreMeshSubs</span><span class="p">,</span>   <span class="n">only</span> <span class="p">:</span> <span class="n">TO_SEQUENTIAL</span><span class="p">,</span> <span class="n">TO_CLUSTER</span><span class="p">,</span> <span class="n">KEEP</span>

      <span class="k">use </span><span class="n">meshdscf</span><span class="p">,</span>       <span class="n">only</span> <span class="p">:</span> <span class="n">createLocalDscfPointers</span>

      <span class="k">use </span><span class="n">iogrid_netcdf</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">set_box_limits</span>
<span class="cp">#ifdef NCDF_4</span>
      <span class="k">use </span><span class="n">m_ncdf_io</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">cdf_init_mesh</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef BSC_CELLXC</span>
      <span class="k">use </span><span class="n">cellxc_mod</span><span class="p">,</span>     <span class="n">only</span> <span class="p">:</span> <span class="n">setGGA</span>
<span class="cp">#endif /* BSC_CELLXC */</span>
      <span class="k">use </span><span class="n">m_efield</span><span class="p">,</span>       <span class="n">only</span> <span class="p">:</span> <span class="n">initialize_efield</span><span class="p">,</span> <span class="n">acting_efield</span>
      <span class="k">use </span><span class="n">m_efield</span><span class="p">,</span>       <span class="n">only</span> <span class="p">:</span> <span class="n">get_field_from_dipole</span>
      <span class="k">use </span><span class="n">m_efield</span><span class="p">,</span>       <span class="n">only</span> <span class="p">:</span> <span class="n">dipole_correction</span>
      <span class="k">use </span><span class="n">m_efield</span><span class="p">,</span>       <span class="n">only</span> <span class="p">:</span> <span class="n">user_specified_field</span>

      <span class="k">use </span><span class="n">m_doping_uniform</span><span class="p">,</span>       <span class="n">only</span><span class="p">:</span> <span class="n">initialize_doping_uniform</span>
      <span class="k">use </span><span class="n">m_doping_uniform</span><span class="p">,</span>       <span class="n">only</span><span class="p">:</span> <span class="n">compute_doping_structs_uniform</span><span class="p">,</span>
     <span class="err">$</span>                                  <span class="n">doping_active</span>
      <span class="k">use </span><span class="n">m_rhog</span><span class="p">,</span>                 <span class="n">only</span><span class="p">:</span> <span class="n">rhog</span><span class="p">,</span> <span class="n">rhog_in</span>
      <span class="k">use </span><span class="n">m_rhog</span><span class="p">,</span>                 <span class="n">only</span><span class="p">:</span> <span class="n">order_rhog</span>
      <span class="k">use </span><span class="n">siesta_options</span><span class="p">,</span>         <span class="n">only</span><span class="p">:</span> <span class="n">mix_charge</span>
<span class="cp">#ifdef MPI</span>
      <span class="k">use </span><span class="n">mpi_siesta</span>
<span class="cp">#endif</span>

      <span class="k">use </span><span class="n">m_mesh_node</span><span class="p">,</span>   <span class="n">only</span><span class="p">:</span> <span class="n">init_mesh_node</span>
      <span class="k">use </span><span class="n">m_charge_add</span><span class="p">,</span>  <span class="n">only</span><span class="p">:</span> <span class="n">init_charge_add</span>
      <span class="k">use </span><span class="n">m_hartree_add</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">init_hartree_add</span>

      <span class="k">use </span><span class="n">m_ts_global_vars</span><span class="p">,</span><span class="n">only</span><span class="p">:</span> <span class="n">TSmode</span>
      <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span>   <span class="n">only</span> <span class="p">:</span> <span class="n">IsVolt</span><span class="p">,</span> <span class="n">N_Elec</span><span class="p">,</span> <span class="n">Elecs</span>
      <span class="k">use </span><span class="n">m_ts_voltage</span><span class="p">,</span>   <span class="n">only</span> <span class="p">:</span> <span class="n">ts_init_voltage</span>
      <span class="k">use </span><span class="n">m_ts_hartree</span><span class="p">,</span>   <span class="n">only</span> <span class="p">:</span> <span class="n">ts_init_hartree_fix</span>

      <span class="k">implicit none</span>
<span class="k">      </span><span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">nspin</span><span class="p">,</span> <span class="n">norb</span><span class="p">,</span> <span class="n">iaorb</span><span class="p">(</span><span class="n">norb</span><span class="p">),</span> <span class="n">iphorb</span><span class="p">(</span><span class="n">norb</span><span class="p">),</span>
     <span class="p">&amp;</span>                           <span class="n">nuo</span><span class="p">,</span> <span class="n">nuotot</span><span class="p">,</span> <span class="n">nua</span><span class="p">,</span> <span class="n">na</span><span class="p">,</span> <span class="n">isa</span><span class="p">(</span><span class="n">na</span><span class="p">),</span>
     <span class="p">&amp;</span>                           <span class="n">indxua</span><span class="p">(</span><span class="n">na</span><span class="p">),</span> <span class="n">mscell</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">maxnd</span><span class="p">,</span>
     <span class="p">&amp;</span>                           <span class="n">numd</span><span class="p">(</span><span class="n">nuo</span><span class="p">),</span> <span class="n">listdptr</span><span class="p">(</span><span class="n">nuo</span><span class="p">),</span> <span class="n">listd</span><span class="p">(</span><span class="n">maxnd</span><span class="p">)</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">xa</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">na</span><span class="p">),</span> <span class="n">ucell</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">datm</span><span class="p">(</span><span class="n">norb</span><span class="p">)</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">g2max</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ntm</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Fal</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">nua</span><span class="p">),</span> <span class="n">stressl</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>

      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">parameter</span>     <span class="kd">::</span> <span class="nb">tiny</span>  <span class="o">=</span> <span class="mf">1.e-12_dp</span>
      <span class="kt">integer</span>                 <span class="kd">::</span> <span class="n">io</span><span class="p">,</span> <span class="n">ia</span><span class="p">,</span> <span class="n">iphi</span><span class="p">,</span> <span class="k">is</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span>
      <span class="kt">integer</span>                 <span class="kd">::</span> <span class="n">nsc</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">nbcell</span><span class="p">,</span> <span class="n">nsd</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">DStres</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">volume</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">external</span>      <span class="kd">::</span> <span class="n">volcel</span><span class="p">,</span> <span class="n">ddot</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">grid_p</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">dummy_Drho</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">dummy_Vaux</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
     <span class="p">&amp;</span>                           <span class="n">dummy_Vscf</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
      <span class="kt">logical</span><span class="p">,</span> <span class="k">save</span>           <span class="kd">::</span> <span class="n">frstme</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>   <span class="c">! Keeps state</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">grid_p</span><span class="p">),</span>   <span class="k">pointer</span> <span class="kd">::</span> <span class="n">Vscf</span><span class="p">(:,:),</span> <span class="n">rhoatm_par</span><span class="p">(:)</span>
      <span class="kt">integer</span><span class="p">,</span>        <span class="k">pointer</span> <span class="kd">::</span> <span class="n">numphi</span><span class="p">(:),</span> <span class="n">numphi_par</span><span class="p">(:)</span>

      <span class="kt">integer</span>                 <span class="kd">::</span> <span class="n">nm</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>   <span class="c">! For call to initMesh</span>
<span class="cp">#ifndef BSC_CELLXC</span>
      <span class="kt">integer</span>                 <span class="kd">::</span> <span class="n">nXCfunc</span>
      <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">XCauth</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">XCfunc</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="cp">#endif /* ! BSC_CELLXC */</span>
      <span class="c">! Transport direction (unit-cell aligned)</span>
      <span class="kt">integer</span>                 <span class="kd">::</span> <span class="n">iE</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">ortho</span><span class="p">,</span> <span class="n">field</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">field2</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="c">!--------------------------------------------------------------------- BEGIN</span>
<span class="cp">#ifdef DEBUG</span>
      <span class="k">call </span><span class="n">write_debug</span><span class="p">(</span> <span class="s1">&#39;    PRE dhscf_init&#39;</span> <span class="p">)</span>
<span class="cp">#endif</span>
<span class="c">! ----------------------------------------------------------------------</span>
<span class="c">!     General initialisation</span>
<span class="c">! ----------------------------------------------------------------------</span>
<span class="c">!     Start time counter</span>
      <span class="k">call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;DHSCF_Init&#39;</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span>

      <span class="n">nsd</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">nspin</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
      <span class="k">nullify</span><span class="p">(</span><span class="n">Vscf</span><span class="p">,</span><span class="n">rhoatm_par</span><span class="p">)</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">frstme</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        </span><span class="n">debug_dhscf</span> <span class="o">=</span> <span class="n">fdf_get</span><span class="p">(</span><span class="s1">&#39;Debug.DHSCF&#39;</span><span class="p">,</span> <span class="p">.</span><span class="n">false</span><span class="p">.)</span>

        <span class="k">nullify</span><span class="p">(</span> <span class="n">xdsp</span><span class="p">,</span> <span class="n">rhopcc</span><span class="p">,</span> <span class="n">Vna</span><span class="p">,</span> <span class="n">rhoatm</span> <span class="p">)</span>
<span class="c">!       nsm lives in module m_dhscf now    !! AG**</span>
        <span class="n">nsm</span> <span class="o">=</span> <span class="n">fdf_integer</span><span class="p">(</span> <span class="s1">&#39;MeshSubDivisions&#39;</span><span class="p">,</span> <span class="mi">2</span> <span class="p">)</span>
        <span class="n">nsm</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span> <span class="n">nsm</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span>

<span class="c">!       Set mesh sub-division variables &amp; perform one off allocation</span>
        <span class="n">nsp</span> <span class="o">=</span> <span class="n">nsm</span><span class="o">*</span><span class="n">nsm</span><span class="o">*</span><span class="n">nsm</span>
        <span class="k">call </span><span class="n">re_alloc</span><span class="p">(</span> <span class="n">xdsp</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nsp</span><span class="p">,</span> <span class="s1">&#39;xdsp&#39;</span><span class="p">,</span> <span class="s1">&#39;dhscf_init&#39;</span> <span class="p">)</span>

<span class="c">!       Check spin-spiral wavevector (if defined)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">spiral</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">nspin</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mi">4</span><span class="p">)</span>
     <span class="p">&amp;</span>    <span class="k">call </span><span class="n">die</span><span class="p">(</span><span class="s1">&#39;dhscf: ERROR: spiral defined but nspin &lt; 4&#39;</span><span class="p">)</span>
      <span class="n">endif</span>   <span class="c">! First time</span>

<span class="cp">#ifndef BSC_CELLXC</span>
<span class="c">! Get functional(s) being used</span>
      <span class="k">call </span><span class="n">getXC</span><span class="p">(</span> <span class="n">nXCfunc</span><span class="p">,</span> <span class="n">XCfunc</span><span class="p">,</span> <span class="n">XCauth</span> <span class="p">)</span>
<span class="cp">#endif /* ! BSC_CELLXC */</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">harrisfun</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        do </span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nXCfunc</span>
          <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.(</span><span class="n">leqi</span><span class="p">(</span><span class="n">XCauth</span><span class="p">(</span><span class="n">n</span><span class="p">),</span><span class="s1">&#39;PZ&#39;</span><span class="p">).</span><span class="nb">or</span><span class="p">.</span><span class="n">leqi</span><span class="p">(</span><span class="n">XCauth</span><span class="p">(</span><span class="n">n</span><span class="p">),</span><span class="s1">&#39;CA&#39;</span><span class="p">)))</span> <span class="k">then</span>
<span class="k">            call </span><span class="n">die</span><span class="p">(</span><span class="s2">&quot;** Harris forces not implemented for non-LDA XC&quot;</span><span class="p">)</span>
          <span class="n">endif</span>
        <span class="n">enddo</span>
      <span class="n">endif</span>

<span class="c">! ----------------------------------------------------------------------</span>
<span class="c">!     Orbital initialisation : part 1</span>
<span class="c">! ----------------------------------------------------------------------</span>

<span class="c">!     Find the maximum orbital radius</span>
      <span class="n">rmax</span> <span class="o">=</span> <span class="mf">0.0_dp</span>
      <span class="k">do </span><span class="n">io</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">norb</span>
        <span class="n">ia</span>   <span class="o">=</span> <span class="n">iaorb</span><span class="p">(</span><span class="n">io</span><span class="p">)</span>    <span class="c">! Atomic index of each orbital</span>
        <span class="n">iphi</span> <span class="o">=</span> <span class="n">iphorb</span><span class="p">(</span><span class="n">io</span><span class="p">)</span>   <span class="c">! Orbital index of each  orbital in its atom</span>
        <span class="k">is</span>   <span class="o">=</span> <span class="n">isa</span><span class="p">(</span><span class="n">ia</span><span class="p">)</span>      <span class="c">! Species index of each atom</span>
        <span class="n">rmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span> <span class="n">rmax</span><span class="p">,</span> <span class="n">rcut</span><span class="p">(</span><span class="k">is</span><span class="p">,</span><span class="n">iphi</span><span class="p">)</span> <span class="p">)</span>
      <span class="n">enddo</span>

<span class="c">!     Start time counter for mesh initialization</span>
      <span class="k">call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;DHSCF1&#39;</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span>

<span class="c">! ----------------------------------------------------------------------</span>
<span class="c">!     Unit cell handling</span>
<span class="c">! ----------------------------------------------------------------------</span>
<span class="c">!     Find diagonal unit cell and supercell</span>
      <span class="k">call </span><span class="n">digcel</span><span class="p">(</span> <span class="n">ucell</span><span class="p">,</span> <span class="n">mscell</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">scell</span><span class="p">,</span> <span class="n">nsc</span><span class="p">,</span> <span class="n">IsDiag</span> <span class="p">)</span>
      <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">IsDiag</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        if</span> <span class="p">(</span><span class="n">Node</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,a,3(/,a,3f12.6,a,i6))&#39;</span><span class="p">)</span>
     <span class="p">&amp;</span>      <span class="s1">&#39;DHSCF: WARNING: New shape of unit cell and supercell:&#39;</span><span class="p">,</span>
     <span class="p">&amp;</span>      <span class="p">(</span><span class="s1">&#39;DHSCF:&#39;</span><span class="p">,(</span><span class="n">cell</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">),</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;   x&#39;</span><span class="p">,</span><span class="n">nsc</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">endif</span>
      <span class="n">endif</span>

<span class="c">!     Find the system shape</span>
      <span class="k">call </span><span class="n">shaper</span><span class="p">(</span> <span class="n">cell</span><span class="p">,</span> <span class="n">nua</span><span class="p">,</span> <span class="n">isa</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="nb">shape</span><span class="p">,</span> <span class="n">nbcell</span><span class="p">,</span> <span class="n">bcell</span> <span class="p">)</span>

<span class="c">!     Find system volume</span>
      <span class="n">volume</span> <span class="o">=</span> <span class="n">volcel</span><span class="p">(</span> <span class="n">cell</span> <span class="p">)</span>

<span class="c">! ----------------------------------------------------------------------</span>
<span class="c">!     Mesh initialization </span>
<span class="c">! ----------------------------------------------------------------------</span>
      <span class="k">call </span><span class="n">InitMesh</span><span class="p">(</span> <span class="n">na</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">norb</span><span class="p">,</span> <span class="n">iaorb</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span> <span class="n">isa</span><span class="p">,</span> <span class="n">rmax</span><span class="p">,</span> 
     <span class="p">&amp;</span>               <span class="n">G2max</span><span class="p">,</span> <span class="n">G2mesh</span><span class="p">,</span> <span class="n">nsc</span><span class="p">,</span> <span class="n">nmpl</span><span class="p">,</span> <span class="n">nm</span><span class="p">,</span>
     <span class="p">&amp;</span>               <span class="n">nml</span><span class="p">,</span> <span class="n">ntm</span><span class="p">,</span> <span class="n">ntml</span><span class="p">,</span> <span class="n">ntpl</span><span class="p">,</span> <span class="n">dvol</span> <span class="p">)</span>

<span class="c">!     Setup box descriptors for each processor,</span>
<span class="c">!     held in module iogrid_netcdf</span>
      <span class="k">call </span><span class="n">set_box_limits</span><span class="p">(</span> <span class="n">ntm</span><span class="p">,</span> <span class="n">nsm</span> <span class="p">)</span>

      <span class="c">! Initialize information on local mesh for each node</span>
      <span class="k">call </span><span class="n">init_mesh_node</span><span class="p">(</span> <span class="n">cell</span><span class="p">,</span> <span class="n">ntm</span> <span class="p">,</span> <span class="n">meshLim</span> <span class="p">,</span> <span class="n">nsm</span> <span class="p">)</span>

      <span class="c">! Setup charge additions in the mesh</span>
      <span class="k">call </span><span class="n">init_charge_add</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">ntm</span><span class="p">)</span>

      <span class="c">! Setup Hartree additions in the mesh</span>
      <span class="k">call </span><span class="n">init_hartree_add</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">ntm</span><span class="p">)</span>

<span class="cp">#ifdef NCDF_4</span>
      <span class="c">! Initialize the box for each node...</span>
      <span class="k">call </span><span class="n">cdf_init_mesh</span><span class="p">(</span> <span class="n">ntm</span><span class="p">,</span> <span class="n">nsm</span> <span class="p">)</span>
<span class="cp">#endif</span>

<span class="c">!     Stop time counter for mesh initialization</span>
      <span class="k">call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;DHSCF1&#39;</span><span class="p">,</span> <span class="mi">2</span> <span class="p">)</span>
<span class="c">! ----------------------------------------------------------------------</span>
<span class="c">!     End of mesh initialization </span>
<span class="c">! ----------------------------------------------------------------------</span>

<span class="c">! ----------------------------------------------------------------------</span>
<span class="c">!     Initialize atomic orbitals, density and potential</span>
<span class="c">! ----------------------------------------------------------------------</span>
<span class="c">!     Start time counter for atomic initializations</span>
      <span class="k">call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;DHSCF2&#39;</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">nodes</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">setMeshDistr</span><span class="p">(</span> <span class="n">UNIFORM</span><span class="p">,</span> <span class="n">nsm</span><span class="p">,</span> <span class="n">nsp</span><span class="p">,</span>
     <span class="p">&amp;</span>                     <span class="n">nml</span><span class="p">,</span> <span class="n">nmpl</span><span class="p">,</span> <span class="n">ntml</span><span class="p">,</span> <span class="n">ntpl</span> <span class="p">)</span>
      <span class="n">endif</span>

<span class="c">!     Initialise quantities relating to the atom-mesh positioning</span>
      <span class="k">call </span><span class="n">InitAtomMesh</span><span class="p">(</span> <span class="n">UNIFORM</span><span class="p">,</span> <span class="n">na</span><span class="p">,</span> <span class="n">xa</span> <span class="p">)</span>

<span class="cp">#ifdef BSC_CELLXC</span>
<span class="c">!     Check if we need extencils in cellxc</span>
      <span class="k">call </span><span class="n">setGGA</span><span class="p">(</span> <span class="p">)</span>

<span class="cp">#endif /* BSC_CELLXC */</span>
<span class="c">!     Compute the number of orbitals on the mesh and recompute the</span>
<span class="c">!     partions for every processor in order to have a similar load</span>
<span class="c">!     in each of them.</span>
      <span class="k">nullify</span><span class="p">(</span> <span class="n">numphi</span> <span class="p">)</span>
      <span class="k">call </span><span class="n">re_alloc</span><span class="p">(</span> <span class="n">numphi</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nmpl</span><span class="p">,</span> <span class="s1">&#39;numphi&#39;</span><span class="p">,</span> <span class="s1">&#39;dhscf_init&#39;</span> <span class="p">)</span>
<span class="c">!$OMP parallel do default(shared), private(i)</span>
      <span class="k">do </span><span class="n">i</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nmpl</span>
        <span class="n">numphi</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="n">enddo</span>
<span class="c">!$OMP end parallel do</span>

      <span class="k">call </span><span class="n">distriPhiOnMesh</span><span class="p">(</span> <span class="n">nm</span><span class="p">,</span> <span class="n">nmpl</span><span class="p">,</span> <span class="n">norb</span><span class="p">,</span> <span class="n">iaorb</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span>
     <span class="p">&amp;</span>                      <span class="n">isa</span><span class="p">,</span> <span class="n">numphi</span> <span class="p">)</span>

<span class="c">!     Find if there are partial-core-corrections for any atom</span>
      <span class="n">npcc</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="k">do </span><span class="n">ia</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">na</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">rcore</span><span class="p">(</span><span class="n">isa</span><span class="p">(</span><span class="n">ia</span><span class="p">))</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="nb">tiny</span><span class="p">)</span> <span class="n">npcc</span> <span class="o">=</span> <span class="mi">1</span>
      <span class="n">enddo</span>

<span class="c">!     Find partial-core-correction energy density</span>
<span class="c">!     Vscf and Vaux are not used here</span>
      <span class="k">call </span><span class="n">re_alloc</span><span class="p">(</span> <span class="n">rhopcc</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ntpl</span><span class="o">*</span><span class="n">npcc</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;rhopcc&#39;</span><span class="p">,</span> <span class="s1">&#39;dhscf_init&#39;</span> <span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">npcc</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">PartialCoreOnMesh</span><span class="p">(</span> <span class="n">na</span><span class="p">,</span> <span class="n">isa</span><span class="p">,</span> <span class="n">ntpl</span><span class="p">,</span> <span class="n">rhopcc</span><span class="p">,</span> <span class="n">indxua</span><span class="p">,</span>
     <span class="p">&amp;</span>    <span class="n">nsd</span><span class="p">,</span> <span class="n">dvol</span><span class="p">,</span> <span class="n">volume</span><span class="p">,</span> <span class="n">dummy_Vscf</span><span class="p">,</span> <span class="n">dummy_Vaux</span><span class="p">,</span> <span class="n">Fal</span><span class="p">,</span> <span class="n">stressl</span><span class="p">,</span>
     <span class="p">&amp;</span>    <span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="p">)</span>
        <span class="k">call </span><span class="n">reord</span><span class="p">(</span> <span class="n">rhopcc</span><span class="p">,</span> <span class="n">rhopcc</span><span class="p">,</span> <span class="n">nml</span><span class="p">,</span> <span class="n">nsm</span><span class="p">,</span> <span class="n">TO_SEQUENTIAL</span> <span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">debug_dhscf</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">           write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="n">debug_fmt</span><span class="p">)</span> <span class="n">Node</span><span class="p">,</span><span class="s1">&#39;rhopcc&#39;</span><span class="p">,</span><span class="nb">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">rhopcc</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
        <span class="k">end if</span>
<span class="k">      </span><span class="n">endif</span>

<span class="c">!     Find neutral-atom potential</span>
<span class="c">!     Drho is not used here</span>
      <span class="k">call </span><span class="n">re_alloc</span><span class="p">(</span> <span class="n">Vna</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ntpl</span><span class="p">,</span> <span class="s1">&#39;Vna&#39;</span><span class="p">,</span> <span class="s1">&#39;dhscf_init&#39;</span> <span class="p">)</span>
      <span class="k">call </span><span class="n">NeutralAtomOnMesh</span><span class="p">(</span> <span class="n">na</span><span class="p">,</span> <span class="n">isa</span><span class="p">,</span> <span class="n">ntpl</span><span class="p">,</span> <span class="n">Vna</span><span class="p">,</span> <span class="n">indxua</span><span class="p">,</span> <span class="n">dvol</span><span class="p">,</span> 
     <span class="p">&amp;</span>                        <span class="n">volume</span><span class="p">,</span> <span class="n">dummy_DRho</span><span class="p">,</span> <span class="n">Fal</span><span class="p">,</span> <span class="n">stressl</span><span class="p">,</span> 
     <span class="p">&amp;</span>                        <span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="p">)</span>
      <span class="k">call </span><span class="n">reord</span><span class="p">(</span> <span class="n">Vna</span><span class="p">,</span> <span class="n">Vna</span><span class="p">,</span> <span class="n">nml</span><span class="p">,</span> <span class="n">nsm</span><span class="p">,</span> <span class="n">TO_SEQUENTIAL</span> <span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">debug_dhscf</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">         write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="n">debug_fmt</span><span class="p">)</span> <span class="n">Node</span><span class="p">,</span><span class="s1">&#39;Vna&#39;</span><span class="p">,</span><span class="nb">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">Vna</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
      <span class="k">end if</span>

<span class="k">      if</span> <span class="p">(</span><span class="n">nodes</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        if</span> <span class="p">(</span><span class="n">node</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">           write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s2">&quot;(a)&quot;</span><span class="p">)</span> <span class="s2">&quot;Setting up quadratic distribution...&quot;</span>
        <span class="n">endif</span>
        <span class="k">call </span><span class="n">setMeshDistr</span><span class="p">(</span> <span class="n">QUADRATIC</span><span class="p">,</span> <span class="n">nsm</span><span class="p">,</span> <span class="n">nsp</span><span class="p">,</span>
     <span class="p">&amp;</span>                     <span class="n">nml</span><span class="p">,</span> <span class="n">nmpl</span><span class="p">,</span> <span class="n">ntml</span><span class="p">,</span> <span class="n">ntpl</span> <span class="p">)</span>

<span class="c">!       Create extended mesh arrays for the second data distribution</span>
        <span class="k">call </span><span class="n">setupExtMesh</span><span class="p">(</span> <span class="n">QUADRATIC</span><span class="p">,</span> <span class="n">rmax</span> <span class="p">)</span>

<span class="c">!       Compute atom positions for the second data distribution </span>
        <span class="k">call </span><span class="n">InitAtomMesh</span><span class="p">(</span> <span class="n">QUADRATIC</span><span class="p">,</span> <span class="n">na</span><span class="p">,</span> <span class="n">xa</span> <span class="p">)</span>
      <span class="n">endif</span>

<span class="c">!     Calculate orbital values on mesh</span>
<span class="c">!     numphi has already been computed in distriPhiOnMesh</span>
<span class="c">!     in the UNIFORM distribution </span>
      <span class="k">if</span> <span class="p">(</span><span class="n">nodes</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        </span><span class="n">numphi_par</span> <span class="o">=&gt;</span> <span class="n">numphi</span>
      <span class="k">else</span>
<span class="k">        nullify</span><span class="p">(</span><span class="n">numphi_par</span><span class="p">)</span>
        <span class="k">call </span><span class="n">re_alloc</span><span class="p">(</span> <span class="n">numphi_par</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nmpl</span><span class="p">,</span> <span class="s1">&#39;numphi_par&#39;</span><span class="p">,</span>
     <span class="p">&amp;</span>                 <span class="s1">&#39;dhscf_init&#39;</span> <span class="p">)</span>
        <span class="k">call </span><span class="n">distMeshData</span><span class="p">(</span> <span class="n">UNIFORM</span><span class="p">,</span> <span class="n">numphi</span><span class="p">,</span> <span class="n">QUADRATIC</span><span class="p">,</span>
     <span class="p">&amp;</span>                     <span class="n">numphi_par</span><span class="p">,</span> <span class="n">KEEP</span> <span class="p">)</span>
      <span class="n">endif</span>

      <span class="k">call </span><span class="n">PhiOnMesh</span><span class="p">(</span> <span class="n">nmpl</span><span class="p">,</span> <span class="n">norb</span><span class="p">,</span> <span class="n">iaorb</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span> <span class="n">isa</span><span class="p">,</span> <span class="n">numphi_par</span> <span class="p">)</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">nodes</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">de_alloc</span><span class="p">(</span> <span class="n">numphi_par</span><span class="p">,</span> <span class="s1">&#39;numphi_par&#39;</span><span class="p">,</span> <span class="s1">&#39;dhscf_init&#39;</span> <span class="p">)</span>
      <span class="n">endif</span>
      <span class="k">call </span><span class="n">de_alloc</span><span class="p">(</span> <span class="n">numphi</span><span class="p">,</span> <span class="s1">&#39;numphi&#39;</span><span class="p">,</span> <span class="s1">&#39;dhscf_init&#39;</span> <span class="p">)</span>

<span class="c">! ----------------------------------------------------------------------</span>
<span class="c">!       Create sparse indexing for Dscf as needed for local mesh</span>
<span class="c">!       Note that this is done in the QUADRATIC distribution</span>
<span class="c">!       since &#39;endpht&#39; (computed finally in PhiOnMesh and stored in</span>
<span class="c">!       meshphi module) is in that distribution.</span>
<span class="c">! ----------------------------------------------------------------------</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">Nodes</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">CreateLocalDscfPointers</span><span class="p">(</span> <span class="n">nmpl</span><span class="p">,</span> <span class="n">nuotot</span><span class="p">,</span> <span class="n">numd</span><span class="p">,</span> <span class="n">listdptr</span><span class="p">,</span> 
     <span class="p">&amp;</span>                                <span class="n">listd</span> <span class="p">)</span>
      <span class="n">endif</span>

<span class="c">! ----------------------------------------------------------------------</span>
<span class="c">!     Calculate terms relating to the neutral atoms on the mesh</span>
<span class="c">! ----------------------------------------------------------------------</span>
<span class="c">!     Find Harris (sum of atomic) electron density</span>
      <span class="k">call </span><span class="n">re_alloc</span><span class="p">(</span> <span class="n">rhoatm_par</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ntpl</span><span class="p">,</span> <span class="s1">&#39;rhoatm_par&#39;</span><span class="p">,</span> <span class="s1">&#39;dhscf_init&#39;</span> <span class="p">)</span>
      <span class="k">call </span><span class="n">rhooda</span><span class="p">(</span> <span class="n">norb</span><span class="p">,</span> <span class="n">nmpl</span><span class="p">,</span> <span class="n">datm</span><span class="p">,</span> <span class="n">rhoatm_par</span><span class="p">,</span> <span class="n">iaorb</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span> <span class="n">isa</span> <span class="p">)</span>
<span class="c">!     rhoatm_par comes out of here in clustered form in QUADRATIC dist</span>

<span class="c">!     Routine Poison should use the uniform data distribution</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">nodes</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">setMeshDistr</span><span class="p">(</span> <span class="n">UNIFORM</span><span class="p">,</span> <span class="n">nsm</span><span class="p">,</span> <span class="n">nsp</span><span class="p">,</span>
     <span class="p">&amp;</span>                      <span class="n">nml</span><span class="p">,</span> <span class="n">nmpl</span><span class="p">,</span> <span class="n">ntml</span><span class="p">,</span> <span class="n">ntpl</span> <span class="p">)</span>
      <span class="n">endif</span>

<span class="c">!     Create Rhoatm using UNIFORM distr, in sequential form</span>
      <span class="k">call </span><span class="n">re_alloc</span><span class="p">(</span> <span class="n">rhoatm</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ntpl</span><span class="p">,</span> <span class="s1">&#39;rhoatm&#39;</span><span class="p">,</span> <span class="s1">&#39;dhscf_init&#39;</span> <span class="p">)</span>
      <span class="k">call </span><span class="n">distMeshData</span><span class="p">(</span> <span class="n">QUADRATIC</span><span class="p">,</span> <span class="n">rhoatm_par</span><span class="p">,</span>
     <span class="p">&amp;</span>     <span class="n">UNIFORM</span><span class="p">,</span> <span class="n">rhoatm</span><span class="p">,</span> <span class="n">TO_SEQUENTIAL</span> <span class="p">)</span>

      <span class="k">if</span> <span class="p">(</span> <span class="n">debug_dhscf</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">         write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="n">debug_fmt</span><span class="p">)</span> <span class="n">Node</span><span class="p">,</span><span class="s1">&#39;rhoatm&#39;</span><span class="p">,</span> <span class="nb">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">rhoatm</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
      <span class="k">end if</span>

<span class="c">!</span>
<span class="c">!  AG: The initialization of doping structs could be done here now,</span>
<span class="c">!      in the uniform distribution, and with a simple loop over</span>
<span class="c">!      rhoatm.</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">frstme</span><span class="p">)</span> <span class="k">call </span><span class="n">initialize_doping_uniform</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">doping_active</span><span class="p">)</span> <span class="k">then  </span>
<span class="k">           call </span><span class="n">compute_doping_structs_uniform</span><span class="p">(</span><span class="n">ntpl</span><span class="p">,</span><span class="n">rhoatm</span><span class="p">,</span><span class="n">nsd</span><span class="p">)</span>
           <span class="c">! Will get the global number of hit points</span>
           <span class="c">! Then, the doping density to be added can be simply computed</span>
        <span class="n">endif</span>

<span class="c">!     Allocate Temporal array</span>
      <span class="k">call </span><span class="n">re_alloc</span><span class="p">(</span> <span class="n">Vscf</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ntpl</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nspin</span><span class="p">,</span> <span class="s1">&#39;Vscf&#39;</span><span class="p">,</span> <span class="s1">&#39;dhscf_init&#39;</span> <span class="p">)</span>

<span class="c">!     Vscf is filled here but not used later</span>
<span class="c">!     Uharrs is computed (and saved)</span>
<span class="c">!     DStres is computed but not used later</span>
      <span class="k">call </span><span class="n">poison</span><span class="p">(</span> <span class="n">cell</span><span class="p">,</span> <span class="n">ntml</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">ntml</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">ntml</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">ntm</span><span class="p">,</span> <span class="n">rhoatm</span><span class="p">,</span>
     <span class="p">&amp;</span>             <span class="n">Uharrs</span><span class="p">,</span> <span class="n">Vscf</span><span class="p">,</span> <span class="n">DStres</span><span class="p">,</span> <span class="n">nsm</span> <span class="p">)</span>
      <span class="k">call </span><span class="n">de_alloc</span><span class="p">(</span> <span class="n">Vscf</span><span class="p">,</span> <span class="s1">&#39;Vscf&#39;</span><span class="p">,</span> <span class="s1">&#39;dhscf_init&#39;</span> <span class="p">)</span>

<span class="c">!     Always deallocate rhoatm_par, as it was used even if nodes=1</span>
      <span class="k">call </span><span class="n">de_alloc</span><span class="p">(</span> <span class="n">rhoatm_par</span><span class="p">,</span> <span class="s1">&#39;rhoatm_par&#39;</span><span class="p">,</span> <span class="s1">&#39;dhscf_init&#39;</span> <span class="p">)</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">mix_charge</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">re_alloc</span><span class="p">(</span> <span class="n">rhog</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ntpl</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nspin</span><span class="p">,</span>
     <span class="err">$</span>                 <span class="s1">&#39;Rhog&#39;</span><span class="p">,</span> <span class="s1">&#39;dhscf_init&#39;</span> <span class="p">)</span>
         <span class="k">call </span><span class="n">re_alloc</span><span class="p">(</span> <span class="n">rhog_in</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ntpl</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nspin</span><span class="p">,</span>
     <span class="err">$</span>                 <span class="s1">&#39;Rhog_in&#39;</span><span class="p">,</span> <span class="s1">&#39;dhscf_init&#39;</span> <span class="p">)</span>
         <span class="k">call </span><span class="n">order_rhog</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">ntml</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">ntml</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">ntml</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">ntm</span><span class="p">,</span> <span class="n">nsm</span><span class="p">)</span>
      <span class="n">endif</span>

<span class="c">!     Stop time counter for atomic initializations</span>
      <span class="k">call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;DHSCF2&#39;</span><span class="p">,</span> <span class="mi">2</span> <span class="p">)</span>

<span class="c">! ----------------------------------------------------------------------</span>
<span class="c">!     At the end of initializations:</span>
<span class="c">!     We are in the UNIFORM distribution</span>
<span class="c">!     Rhoatm, Rhopcc and Vna are in UNIFORM dist, sequential form</span>
<span class="c">!     The index array endpht is in the QUADRATIC distribution</span>
<span class="c">! ----------------------------------------------------------------------</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">frstme</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">initialize_efield</span><span class="p">()</span>
      <span class="k">end if</span>

      <span class="c">! Check if we need to add the potential </span>
      <span class="c">! corresponding to the voltage-drop.</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">TSmode</span> <span class="p">)</span> <span class="k">then</span>
        <span class="c">! These routines are important if there are cell-changes</span>
        <span class="k">call </span><span class="n">ts_init_hartree_fix</span><span class="p">(</span> <span class="n">cell</span><span class="p">,</span> <span class="n">nua</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">ntm</span><span class="p">,</span> <span class="n">ntml</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">IsVolt</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">           call </span><span class="n">ts_init_voltage</span><span class="p">(</span> <span class="n">cell</span><span class="p">,</span> <span class="n">nua</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">ntm</span><span class="p">)</span>
        <span class="k">end if</span>

<span class="k">        if</span> <span class="p">(</span> <span class="n">acting_efield</span> <span class="p">)</span> <span class="k">then</span>
         <span class="c">! We do not allow the electric field for </span>
         <span class="c">! transiesta runs with V = 0, either.</span>
         <span class="c">! It does not make sense, only for fields perpendicular</span>
         <span class="c">! to the applied bias.</span>
           
         <span class="c">! We need to check that the e-field is perpendicular</span>
         <span class="c">! to the transport direction, and that the system is</span>
         <span class="c">! either a chain, or a slab.</span>
         <span class="c">! However, due to the allowance of a dipole correction</span>
         <span class="c">! along the transport direction for buffer calculations</span>
         <span class="c">! we have to allow all shapes. (atom is not transiesta</span>
         <span class="c">! compatible anyway)</span>
            
         <span class="c">! check that we do not violate the periodicity</span>
         <span class="k">if</span> <span class="p">(</span> <span class="n">Node</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(/,2(2a,/))&#39;</span><span class="p">)</span> <span class="s1">&#39;ts-WARNING: &#39;</span><span class="p">,</span>
     <span class="p">&amp;</span>           <span class="s1">&#39;E-field/dipole-correction! &#39;</span><span class="p">,</span>
     <span class="p">&amp;</span>           <span class="s1">&#39;ts-WARNING: &#39;</span><span class="p">,</span>
     <span class="p">&amp;</span>           <span class="s1">&#39;I hope you know what you are doing!&#39;</span>
         <span class="k">end if</span>

         <span class="c">! This is either dipole or user, or both</span>
         <span class="n">field</span><span class="p">(:)</span> <span class="o">=</span> <span class="n">user_specified_field</span><span class="p">(:)</span>
         <span class="k">do </span><span class="n">iE</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">N_Elec</span>
            <span class="n">field2</span> <span class="o">=</span> <span class="n">Elecs</span><span class="p">(</span><span class="n">iE</span><span class="p">)%</span><span class="n">cell</span><span class="p">(:,</span><span class="n">Elecs</span><span class="p">(</span><span class="n">iE</span><span class="p">)%</span><span class="n">t_dir</span><span class="p">)</span>
            <span class="n">ortho</span> <span class="o">=</span> <span class="n">ddot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">field2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">field</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ortho</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.e-9_dp</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">               call </span><span class="n">die</span><span class="p">(</span><span class="s1">&#39;User defined E-field must be</span>
<span class="s1">     &amp;perpendicular to semi-infinite directions&#39;</span><span class="p">)</span>
            <span class="k">end if</span>
<span class="k">         end do</span>
<span class="k">        end if</span> <span class="c">! acting_efield</span>
         
        <span class="c">! We know that we currently allow people to do more than</span>
        <span class="c">! they probably should be allowed. However, there are many</span>
        <span class="c">! corner cases that may require dipole corrections, or </span>
        <span class="c">! electric fields to &quot;correct&quot; an intrinsic dipole.</span>
        <span class="c">! For instance, what should we do with a dipole in a transiesta</span>
        <span class="c">! calculation?</span>
        <span class="c">! Should we apply a field to counter act it in a device</span>
        <span class="c">! calculation?</span>
         
      <span class="k">end if</span>

<span class="k">      </span><span class="n">frstme</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>

      <span class="k">call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;DHSCF_Init&#39;</span><span class="p">,</span> <span class="mi">2</span> <span class="p">)</span>
<span class="cp">#ifdef DEBUG</span>
      <span class="k">call </span><span class="n">write_debug</span><span class="p">(</span> <span class="s1">&#39;    POS dhscf_init&#39;</span> <span class="p">)</span>
<span class="cp">#endif</span>
<span class="c">!------------------------------------------------------------------------- END</span>
      <span class="k">end subroutine </span><span class="n">dhscf_init</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2018 <a rel="license" href="http://www.gnu.org/licenses/old-licenses/fdl-1.2.en.html">GNU Free Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> SIESTA was developed by SIESTA Group</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>