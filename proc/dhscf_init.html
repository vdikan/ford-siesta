<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="A first-principles materials simulation code using Density Functional Theory.">
    
    <meta name="author" content="SIESTA Group" >
    <link rel="icon" href="../favicon.png">

    <title>dhscf_init &ndash; SIESTA</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">SIESTA <small>trunk-700--vdikan-edens-708-ford-681</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>Program Overview</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>dhscf_init
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 3.3% of total for procedures.">210 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/dhscf.F"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/dhscf.f.html'>dhscf.F</a></li>
    
     <li><a href='../module/m_dhscf.html'>m_dhscf</a></li>
    
  
     <li class="active">dhscf_init</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/dhscf_init.html#src">dhscf_init</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine dhscf_init(nspin, norb, iaorb, iphorb, nuo, nuotot, nua, na, isa, xa, indxua, ucell, mscell, g2max, ntm, maxnd, numd, listdptr, listd, datm, Fal, stressl)
    
    
   
</h2>
    
  
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
      
      <li class="list-group-item">
  <ul class="list-inline">
    
    <li>precision</li>
    
    <li>parallel</li>
    
    <li>atmfuncs</li>
    
    <li>fdf</li>
    
    <li>sys</li>
    
    <li>mesh</li>
    
    <li>parsing</li>
    
    <li>siestaXC</li>
    
    <li>bsc_xcmod</li>
    
    <li>alloc</li>
    
    <li>siesta_options</li>
    
    <li>meshsubs</li>
    
    <li>meshsubs</li>
    
    <li>meshsubs</li>
    
    <li>meshsubs</li>
    
    <li>meshsubs</li>
    
    <li>meshsubs</li>
    
    <li>meshsubs</li>
    
    <li><a href='../module/moremeshsubs.html'>moreMeshSubs</a></li>
    
    <li><a href='../module/moremeshsubs.html'>moreMeshSubs</a></li>
    
    <li><a href='../module/moremeshsubs.html'>moreMeshSubs</a></li>
    
    <li>meshdscf</li>
    
    <li>iogrid_netcdf</li>
    
    <li>m_ncdf_io</li>
    
    <li>cellxc_mod</li>
    
    <li>m_efield</li>
    
    <li>m_efield</li>
    
    <li>m_efield</li>
    
    <li>m_efield</li>
    
    <li>m_doping_uniform</li>
    
    <li>m_doping_uniform</li>
    
    <li>m_rhog</li>
    
    <li>m_rhog</li>
    
    <li>siesta_options</li>
    
    <li>mpi_siesta</li>
    
    <li>m_mesh_node</li>
    
    <li>m_charge_add</li>
    
    <li>m_hartree_add</li>
    
    <li>m_ts_global_vars</li>
    
    <li>m_ts_options</li>
    
    <li>m_ts_voltage</li>
    
    <li>m_ts_hartree</li>
    
  </ul>
      </li>
      
      
      
      <li class="list-group-item">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~dhscf_init~~UsesGraph Pages: 1 -->
<svg id="procdhscf_initUsesGraph" width="295pt" height="1074pt"
 viewBox="0.00 0.00 295.00 1074.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~dhscf_init~~UsesGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 1070)">
<title>proc~~dhscf_init~~UsesGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1070 291,-1070 291,4 -4,4"/>
<!-- proc~dhscf_init -->
<g id="proc~~dhscf_init~~UsesGraph_node1" class="node"><title>proc~dhscf_init</title>
<polygon fill="none" stroke="black" points="287,-542 229,-542 229,-518 287,-518 287,-542"/>
<text text-anchor="middle" x="258" y="-527.6" font-family="Helvetica,sans-Serif" font-size="10.50">dhscf_init</text>
</g>
<!-- m_charge_add -->
<g id="proc~~dhscf_init~~UsesGraph_node2" class="node"><title>m_charge_add</title>
<polygon fill="#337ab7" stroke="#337ab7" points="184.5,-1066 99.5,-1066 99.5,-1042 184.5,-1042 184.5,-1066"/>
<text text-anchor="middle" x="142" y="-1051.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_charge_add</text>
</g>
<!-- proc~dhscf_init&#45;&gt;m_charge_add -->
<g id="proc~~dhscf_init~~UsesGraph_edge1" class="edge"><title>proc~dhscf_init&#45;&gt;m_charge_add</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M257.049,-542.017C257.103,-610.612 254.255,-952.4 193,-1033 192.427,-1033.75 191.821,-1034.48 191.187,-1035.18"/>
<polygon fill="#000000" stroke="#000000" points="188.807,-1032.61 183.447,-1041.75 193.336,-1037.95 188.807,-1032.61"/>
</g>
<!-- m_ncdf_io -->
<g id="proc~~dhscf_init~~UsesGraph_node3" class="node"><title>m_ncdf_io</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173,-1024 111,-1024 111,-1000 173,-1000 173,-1024"/>
<text text-anchor="middle" x="142" y="-1009.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ncdf_io</text>
</g>
<!-- proc~dhscf_init&#45;&gt;m_ncdf_io -->
<g id="proc~~dhscf_init~~UsesGraph_edge2" class="edge"><title>proc~dhscf_init&#45;&gt;m_ncdf_io</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M256.891,-542.283C256.079,-608.001 249.276,-917.82 193,-991 190.035,-994.855 186.231,-998.01 182.047,-1000.59"/>
<polygon fill="#000000" stroke="#000000" points="180.424,-997.488 173.073,-1005.12 183.577,-1003.74 180.424,-997.488"/>
</g>
<!-- m_ts_options -->
<g id="proc~~dhscf_init~~UsesGraph_node4" class="node"><title>m_ts_options</title>
<polygon fill="#337ab7" stroke="#337ab7" points="180,-982 104,-982 104,-958 180,-958 180,-982"/>
<text text-anchor="middle" x="142" y="-967.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_options</text>
</g>
<!-- proc~dhscf_init&#45;&gt;m_ts_options -->
<g id="proc~~dhscf_init~~UsesGraph_edge13" class="edge"><title>proc~dhscf_init&#45;&gt;m_ts_options</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M256.7,-542.377C254.959,-604.632 244.364,-883.141 193,-949 191.741,-950.615 190.334,-952.107 188.815,-953.485"/>
<polygon fill="#000000" stroke="#000000" points="186.537,-950.811 180.437,-959.473 190.607,-956.506 186.537,-950.811"/>
</g>
<!-- parsing -->
<g id="proc~~dhscf_init~~UsesGraph_node5" class="node"><title>parsing</title>
<polygon fill="#337ab7" stroke="#337ab7" points="169,-940 115,-940 115,-916 169,-916 169,-940"/>
<text text-anchor="middle" x="142" y="-925.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parsing</text>
</g>
<!-- proc~dhscf_init&#45;&gt;parsing -->
<g id="proc~~dhscf_init~~UsesGraph_edge4" class="edge"><title>proc~dhscf_init&#45;&gt;parsing</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M256.472,-542.282C253.744,-600.508 239.521,-848.36 193,-907 189.176,-911.82 184.047,-915.547 178.528,-918.426"/>
<polygon fill="#000000" stroke="#000000" points="176.835,-915.344 169.033,-922.512 179.602,-921.774 176.835,-915.344"/>
</g>
<!-- meshdscf -->
<g id="proc~~dhscf_init~~UsesGraph_node6" class="node"><title>meshdscf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="171,-898 113,-898 113,-874 171,-874 171,-898"/>
<text text-anchor="middle" x="142" y="-883.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">meshdscf</text>
</g>
<!-- proc~dhscf_init&#45;&gt;meshdscf -->
<g id="proc~~dhscf_init~~UsesGraph_edge5" class="edge"><title>proc~dhscf_init&#45;&gt;meshdscf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M256.182,-542.341C252.358,-596.606 234.656,-813.589 193,-865 189.518,-869.298 185,-872.729 180.107,-875.465"/>
<polygon fill="#000000" stroke="#000000" points="178.631,-872.291 171.033,-879.676 181.577,-878.641 178.631,-872.291"/>
</g>
<!-- m_ts_voltage -->
<g id="proc~~dhscf_init~~UsesGraph_node7" class="node"><title>m_ts_voltage</title>
<polygon fill="#337ab7" stroke="#337ab7" points="180,-856 104,-856 104,-832 180,-832 180,-856"/>
<text text-anchor="middle" x="142" y="-841.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_voltage</text>
</g>
<!-- proc~dhscf_init&#45;&gt;m_ts_voltage -->
<g id="proc~~dhscf_init~~UsesGraph_edge6" class="edge"><title>proc~dhscf_init&#45;&gt;m_ts_voltage</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M255.836,-542.115C250.855,-591.705 229.888,-778.678 193,-823 191.69,-824.574 190.242,-826.032 188.688,-827.383"/>
<polygon fill="#000000" stroke="#000000" points="186.414,-824.701 180.194,-833.278 190.405,-830.451 186.414,-824.701"/>
</g>
<!-- siestaXC -->
<g id="proc~~dhscf_init~~UsesGraph_node8" class="node"><title>siestaXC</title>
<polygon fill="#337ab7" stroke="#337ab7" points="169.5,-814 114.5,-814 114.5,-790 169.5,-790 169.5,-814"/>
<text text-anchor="middle" x="142" y="-799.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siestaXC</text>
</g>
<!-- proc~dhscf_init&#45;&gt;siestaXC -->
<g id="proc~~dhscf_init~~UsesGraph_edge7" class="edge"><title>proc~dhscf_init&#45;&gt;siestaXC</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M257.471,-542.165C258.34,-581.685 255.834,-708.106 193,-781 189.235,-785.368 184.409,-788.848 179.246,-791.615"/>
<polygon fill="#000000" stroke="#000000" points="177.445,-788.586 169.744,-795.863 180.302,-794.977 177.445,-788.586"/>
</g>
<!-- m_mesh_node -->
<g id="proc~~dhscf_init~~UsesGraph_node9" class="node"><title>m_mesh_node</title>
<polygon fill="#337ab7" stroke="#337ab7" points="184,-772 100,-772 100,-748 184,-748 184,-772"/>
<text text-anchor="middle" x="142" y="-757.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_mesh_node</text>
</g>
<!-- proc~dhscf_init&#45;&gt;m_mesh_node -->
<g id="proc~~dhscf_init~~UsesGraph_edge8" class="edge"><title>proc~dhscf_init&#45;&gt;m_mesh_node</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M256.721,-542.094C255.275,-577.119 246.449,-679.892 193,-739 192.112,-739.982 191.171,-740.92 190.185,-741.814"/>
<polygon fill="#000000" stroke="#000000" points="187.9,-739.149 181.89,-747.873 192.029,-744.801 187.9,-739.149"/>
</g>
<!-- cellxc_mod -->
<g id="proc~~dhscf_init~~UsesGraph_node10" class="node"><title>cellxc_mod</title>
<polygon fill="#337ab7" stroke="#337ab7" points="175,-730 109,-730 109,-706 175,-706 175,-730"/>
<text text-anchor="middle" x="142" y="-715.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cellxc_mod</text>
</g>
<!-- proc~dhscf_init&#45;&gt;cellxc_mod -->
<g id="proc~~dhscf_init~~UsesGraph_edge9" class="edge"><title>proc~dhscf_init&#45;&gt;cellxc_mod</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M255.606,-542.241C251.546,-572.472 237.074,-651.508 193,-697 190.355,-699.73 187.3,-702.122 184.032,-704.213"/>
<polygon fill="#000000" stroke="#000000" points="182.153,-701.249 175.012,-709.076 185.475,-707.411 182.153,-701.249"/>
</g>
<!-- m_efield -->
<g id="proc~~dhscf_init~~UsesGraph_node11" class="node"><title>m_efield</title>
<polygon fill="#337ab7" stroke="#337ab7" points="169,-688 115,-688 115,-664 169,-664 169,-688"/>
<text text-anchor="middle" x="142" y="-673.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_efield</text>
</g>
<!-- proc~dhscf_init&#45;&gt;m_efield -->
<g id="proc~~dhscf_init~~UsesGraph_edge10" class="edge"><title>proc~dhscf_init&#45;&gt;m_efield</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M253.876,-542.027C246.942,-566.498 228.042,-622.511 193,-655 188.814,-658.881 183.807,-662.101 178.602,-664.756"/>
<polygon fill="#000000" stroke="#000000" points="176.877,-661.693 169.154,-668.946 179.714,-668.092 176.877,-661.693"/>
</g>
<!-- m_doping_uniform -->
<g id="proc~~dhscf_init~~UsesGraph_node12" class="node"><title>m_doping_uniform</title>
<polygon fill="#337ab7" stroke="#337ab7" points="193,-646 91,-646 91,-622 193,-622 193,-646"/>
<text text-anchor="middle" x="142" y="-631.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_doping_uniform</text>
</g>
<!-- proc~dhscf_init&#45;&gt;m_doping_uniform -->
<g id="proc~~dhscf_init~~UsesGraph_edge11" class="edge"><title>proc~dhscf_init&#45;&gt;m_doping_uniform</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M250.461,-542.026C240.288,-559.741 219.103,-592.917 193,-613 191.181,-614.399 189.255,-615.723 187.259,-616.972"/>
<polygon fill="#000000" stroke="#000000" points="185.244,-614.086 178.174,-621.978 188.622,-620.217 185.244,-614.086"/>
</g>
<!-- siesta_options -->
<g id="proc~~dhscf_init~~UsesGraph_node13" class="node"><title>siesta_options</title>
<polygon fill="#337ab7" stroke="#337ab7" points="182.5,-604 101.5,-604 101.5,-580 182.5,-580 182.5,-604"/>
<text text-anchor="middle" x="142" y="-589.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_options</text>
</g>
<!-- proc~dhscf_init&#45;&gt;siesta_options -->
<g id="proc~~dhscf_init~~UsesGraph_edge12" class="edge"><title>proc~dhscf_init&#45;&gt;siesta_options</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M239.83,-542.149C227.214,-550.788 209.471,-562.347 193,-571 189.906,-572.626 186.657,-574.221 183.364,-575.762"/>
<polygon fill="#000000" stroke="#000000" points="181.751,-572.649 174.059,-579.935 184.615,-579.036 181.751,-572.649"/>
</g>
<!-- m_ts_global_vars -->
<g id="proc~~dhscf_init~~UsesGraph_node14" class="node"><title>m_ts_global_vars</title>
<polygon fill="#337ab7" stroke="#337ab7" points="190.5,-562 93.5,-562 93.5,-538 190.5,-538 190.5,-562"/>
<text text-anchor="middle" x="142" y="-547.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_global_vars</text>
</g>
<!-- proc~dhscf_init&#45;&gt;m_ts_global_vars -->
<g id="proc~~dhscf_init~~UsesGraph_edge3" class="edge"><title>proc~dhscf_init&#45;&gt;m_ts_global_vars</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M228.82,-534.944C220.305,-536.438 210.626,-538.136 200.911,-539.84"/>
<polygon fill="#000000" stroke="#000000" points="200.067,-536.435 190.822,-541.61 201.277,-543.329 200.067,-536.435"/>
</g>
<!-- module~moremeshsubs -->
<g id="proc~~dhscf_init~~UsesGraph_node15" class="node"><title>module~moremeshsubs</title>
<g id="a_proc~~dhscf_init~~UsesGraph_node15"><a xlink:href=".././module/moremeshsubs.html" xlink:title="moreMeshSubs">
<polygon fill="#337ab7" stroke="#337ab7" points="186,-482 98,-482 98,-458 186,-458 186,-482"/>
<text text-anchor="middle" x="142" y="-467.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">moreMeshSubs</text>
</a>
</g>
</g>
<!-- proc~dhscf_init&#45;&gt;module~moremeshsubs -->
<g id="proc~~dhscf_init~~UsesGraph_edge14" class="edge"><title>proc~dhscf_init&#45;&gt;module~moremeshsubs</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M234.515,-517.993C222.257,-511.463 206.81,-503.259 193,-496 187.316,-493.013 181.261,-489.848 175.398,-486.794"/>
<polygon fill="#000000" stroke="#000000" points="176.911,-483.636 166.424,-482.126 173.681,-489.846 176.911,-483.636"/>
</g>
<!-- precision -->
<g id="proc~~dhscf_init~~UsesGraph_node16" class="node"><title>precision</title>
<polygon fill="#337ab7" stroke="#337ab7" points="55,-526 0,-526 0,-502 55,-502 55,-526"/>
<text text-anchor="middle" x="27.5" y="-511.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">precision</text>
</g>
<!-- proc~dhscf_init&#45;&gt;precision -->
<g id="proc~~dhscf_init~~UsesGraph_edge15" class="edge"><title>proc~dhscf_init&#45;&gt;precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M141,-510C115.845,-505.965 87.1387,-507.076 65.0196,-509.139"/>
<polygon fill="#000000" stroke="#000000" points="64.6316,-505.66 55.0464,-510.174 65.3543,-512.623 64.6316,-505.66"/>
</g>
<!-- meshsubs -->
<g id="proc~~dhscf_init~~UsesGraph_node17" class="node"><title>meshsubs</title>
<polygon fill="#337ab7" stroke="#337ab7" points="172.5,-402 111.5,-402 111.5,-378 172.5,-378 172.5,-402"/>
<text text-anchor="middle" x="142" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">meshsubs</text>
</g>
<!-- proc~dhscf_init&#45;&gt;meshsubs -->
<g id="proc~~dhscf_init~~UsesGraph_edge16" class="edge"><title>proc~dhscf_init&#45;&gt;meshsubs</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M252.87,-517.872C244.652,-495.284 224.304,-446.317 193,-416 189.536,-412.646 185.553,-409.619 181.379,-406.919"/>
<polygon fill="#000000" stroke="#000000" points="183.051,-403.842 172.648,-401.833 179.528,-409.891 183.051,-403.842"/>
</g>
<!-- sys -->
<g id="proc~~dhscf_init~~UsesGraph_node18" class="node"><title>sys</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54.5,-484 0.5,-484 0.5,-460 54.5,-460 54.5,-484"/>
<text text-anchor="middle" x="27.5" y="-469.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sys</text>
</g>
<!-- proc~dhscf_init&#45;&gt;sys -->
<g id="proc~~dhscf_init~~UsesGraph_edge17" class="edge"><title>proc~dhscf_init&#45;&gt;sys</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M228.929,-524.84C205.878,-520.659 172.364,-514.711 143,-510"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M141,-510C114.522,-505.752 85.9067,-496.01 64.1617,-487.454"/>
<polygon fill="#000000" stroke="#000000" points="65.2698,-484.127 54.6866,-483.631 62.6501,-490.619 65.2698,-484.127"/>
</g>
<!-- mesh -->
<g id="proc~~dhscf_init~~UsesGraph_node19" class="node"><title>mesh</title>
<polygon fill="#337ab7" stroke="#337ab7" points="169,-360 115,-360 115,-336 169,-336 169,-360"/>
<text text-anchor="middle" x="142" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mesh</text>
</g>
<!-- proc~dhscf_init&#45;&gt;mesh -->
<g id="proc~~dhscf_init~~UsesGraph_edge18" class="edge"><title>proc~dhscf_init&#45;&gt;mesh</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M255.404,-517.76C250.948,-488.286 235.758,-412.59 193,-369 188.962,-364.883 183.994,-361.534 178.772,-358.821"/>
<polygon fill="#000000" stroke="#000000" points="179.805,-355.451 169.245,-354.597 176.967,-361.85 179.805,-355.451"/>
</g>
<!-- mpi_siesta -->
<g id="proc~~dhscf_init~~UsesGraph_node20" class="node"><title>mpi_siesta</title>
<polygon fill="#337ab7" stroke="#337ab7" points="174,-318 110,-318 110,-294 174,-294 174,-318"/>
<text text-anchor="middle" x="142" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_siesta</text>
</g>
<!-- proc~dhscf_init&#45;&gt;mpi_siesta -->
<g id="proc~~dhscf_init~~UsesGraph_edge19" class="edge"><title>proc~dhscf_init&#45;&gt;mpi_siesta</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M256.582,-517.756C254.764,-483.259 245.036,-384.07 193,-327 190.145,-323.869 186.749,-321.19 183.091,-318.901"/>
<polygon fill="#000000" stroke="#000000" points="184.688,-315.787 174.207,-314.237 181.434,-321.985 184.688,-315.787"/>
</g>
<!-- m_rhog -->
<g id="proc~~dhscf_init~~UsesGraph_node21" class="node"><title>m_rhog</title>
<polygon fill="#337ab7" stroke="#337ab7" points="169,-276 115,-276 115,-252 169,-252 169,-276"/>
<text text-anchor="middle" x="142" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_rhog</text>
</g>
<!-- proc~dhscf_init&#45;&gt;m_rhog -->
<g id="proc~~dhscf_init~~UsesGraph_edge20" class="edge"><title>proc~dhscf_init&#45;&gt;m_rhog</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M257.378,-517.848C257.93,-478.95 254.489,-355.913 193,-285 189.049,-280.443 183.944,-276.852 178.51,-274.028"/>
<polygon fill="#000000" stroke="#000000" points="179.766,-270.758 169.201,-269.966 176.967,-277.173 179.766,-270.758"/>
</g>
<!-- bsc_xcmod -->
<g id="proc~~dhscf_init~~UsesGraph_node22" class="node"><title>bsc_xcmod</title>
<polygon fill="#337ab7" stroke="#337ab7" points="175.5,-234 108.5,-234 108.5,-210 175.5,-210 175.5,-234"/>
<text text-anchor="middle" x="142" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bsc_xcmod</text>
</g>
<!-- proc~dhscf_init&#45;&gt;bsc_xcmod -->
<g id="proc~~dhscf_init~~UsesGraph_edge21" class="edge"><title>proc~dhscf_init&#45;&gt;bsc_xcmod</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M255.767,-517.8C250.589,-468.722 229.18,-286.28 193,-243 190.562,-240.083 187.649,-237.565 184.472,-235.39"/>
<polygon fill="#000000" stroke="#000000" points="186.023,-232.247 175.59,-230.404 182.596,-238.351 186.023,-232.247"/>
</g>
<!-- m_ts_hartree -->
<g id="proc~~dhscf_init~~UsesGraph_node23" class="node"><title>m_ts_hartree</title>
<polygon fill="#337ab7" stroke="#337ab7" points="180,-192 104,-192 104,-168 180,-168 180,-192"/>
<text text-anchor="middle" x="142" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_hartree</text>
</g>
<!-- proc~dhscf_init&#45;&gt;m_ts_hartree -->
<g id="proc~~dhscf_init~~UsesGraph_edge22" class="edge"><title>proc~dhscf_init&#45;&gt;m_ts_hartree</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M256.151,-517.878C252.197,-464.578 234.022,-251.454 193,-201 191.686,-199.384 190.225,-197.89 188.654,-196.51"/>
<polygon fill="#000000" stroke="#000000" points="190.239,-193.349 180.031,-190.511 186.241,-199.095 190.239,-193.349"/>
</g>
<!-- iogrid_netcdf -->
<g id="proc~~dhscf_init~~UsesGraph_node24" class="node"><title>iogrid_netcdf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="179,-150 105,-150 105,-126 179,-126 179,-150"/>
<text text-anchor="middle" x="142" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iogrid_netcdf</text>
</g>
<!-- proc~dhscf_init&#45;&gt;iogrid_netcdf -->
<g id="proc~~dhscf_init~~UsesGraph_edge23" class="edge"><title>proc~dhscf_init&#45;&gt;iogrid_netcdf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M256.445,-517.912C253.59,-460.606 238.879,-216.672 193,-159 191.384,-156.969 189.537,-155.132 187.527,-153.471"/>
<polygon fill="#000000" stroke="#000000" points="189.379,-150.5 179.11,-147.896 185.514,-156.336 189.379,-150.5"/>
</g>
<!-- alloc -->
<g id="proc~~dhscf_init~~UsesGraph_node25" class="node"><title>alloc</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54.5,-442 0.5,-442 0.5,-418 54.5,-418 54.5,-442"/>
<text text-anchor="middle" x="27.5" y="-427.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">alloc</text>
</g>
<!-- proc~dhscf_init&#45;&gt;alloc -->
<g id="proc~~dhscf_init~~UsesGraph_edge24" class="edge"><title>proc~dhscf_init&#45;&gt;alloc</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M141,-430C117.473,-418.739 87.877,-419.227 64.9468,-422.27"/>
<polygon fill="#000000" stroke="#000000" points="64.2758,-418.832 54.926,-423.815 65.3426,-425.75 64.2758,-418.832"/>
</g>
<!-- atmfuncs -->
<g id="proc~~dhscf_init~~UsesGraph_node26" class="node"><title>atmfuncs</title>
<polygon fill="#337ab7" stroke="#337ab7" points="170,-108 114,-108 114,-84 170,-84 170,-108"/>
<text text-anchor="middle" x="142" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">atmfuncs</text>
</g>
<!-- proc~dhscf_init&#45;&gt;atmfuncs -->
<g id="proc~~dhscf_init~~UsesGraph_edge25" class="edge"><title>proc~dhscf_init&#45;&gt;atmfuncs</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M256.675,-517.799C254.812,-456.43 243.716,-181.883 193,-117 189.449,-112.457 184.734,-108.885 179.617,-106.081"/>
<polygon fill="#000000" stroke="#000000" points="180.69,-102.726 170.135,-101.816 177.82,-109.11 180.69,-102.726"/>
</g>
<!-- fdf -->
<g id="proc~~dhscf_init~~UsesGraph_node27" class="node"><title>fdf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="169,-66 115,-66 115,-42 169,-42 169,-66"/>
<text text-anchor="middle" x="142" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fdf</text>
</g>
<!-- proc~dhscf_init&#45;&gt;fdf -->
<g id="proc~~dhscf_init~~UsesGraph_edge26" class="edge"><title>proc~dhscf_init&#45;&gt;fdf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M256.869,-517.876C255.939,-453.007 248.623,-147.196 193,-75 189.245,-70.1265 184.15,-66.3727 178.642,-63.4845"/>
<polygon fill="#000000" stroke="#000000" points="179.718,-60.1372 169.149,-59.3963 176.95,-66.5663 179.718,-60.1372"/>
</g>
<!-- parallel -->
<g id="proc~~dhscf_init~~UsesGraph_node28" class="node"><title>parallel</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54.5,-400 0.5,-400 0.5,-376 54.5,-376 54.5,-400"/>
<text text-anchor="middle" x="27.5" y="-385.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel</text>
</g>
<!-- proc~dhscf_init&#45;&gt;parallel -->
<g id="proc~~dhscf_init~~UsesGraph_edge27" class="edge"><title>proc~dhscf_init&#45;&gt;parallel</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M250.306,-517.865C240.088,-500.371 219.017,-468.074 193,-449 173.828,-434.944 164.443,-440.264 143,-430"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M141,-430C137.304,-428.231 95.7089,-412.791 64.164,-401.141"/>
<polygon fill="#000000" stroke="#000000" points="65.3433,-397.845 54.7499,-397.666 62.9194,-404.412 65.3433,-397.845"/>
</g>
<!-- m_hartree_add -->
<g id="proc~~dhscf_init~~UsesGraph_node29" class="node"><title>m_hartree_add</title>
<polygon fill="#337ab7" stroke="#337ab7" points="185,-24 99,-24 99,-0 185,-0 185,-24"/>
<text text-anchor="middle" x="142" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_hartree_add</text>
</g>
<!-- proc~dhscf_init&#45;&gt;m_hartree_add -->
<g id="proc~~dhscf_init~~UsesGraph_edge28" class="edge"><title>proc~dhscf_init&#45;&gt;m_hartree_add</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M257.028,-517.679C256.954,-448.877 253.464,-112.435 193,-33 192.426,-32.2461 191.82,-31.5191 191.186,-30.818"/>
<polygon fill="#000000" stroke="#000000" points="193.333,-28.0497 183.442,-24.2526 188.806,-33.3891 193.333,-28.0497"/>
</g>
<!-- module~moremeshsubs&#45;&gt;precision -->
<g id="proc~~dhscf_init~~UsesGraph_edge31" class="edge"><title>module~moremeshsubs&#45;&gt;precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M110.259,-482.023C96.0632,-487.575 79.1177,-494.203 64.3444,-499.981"/>
<polygon fill="#000000" stroke="#000000" points="63.0389,-496.733 55.0007,-503.635 65.5886,-503.252 63.0389,-496.733"/>
</g>
<!-- module~moremeshsubs&#45;&gt;sys -->
<g id="proc~~dhscf_init~~UsesGraph_edge29" class="edge"><title>module~moremeshsubs&#45;&gt;sys</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M97.8263,-470.768C86.9516,-470.961 75.3866,-471.166 64.8823,-471.353"/>
<polygon fill="#000000" stroke="#000000" points="64.7325,-467.855 54.7964,-471.533 64.857,-474.854 64.7325,-467.855"/>
</g>
<!-- module~moremeshsubs&#45;&gt;alloc -->
<g id="proc~~dhscf_init~~UsesGraph_edge30" class="edge"><title>module~moremeshsubs&#45;&gt;alloc</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M107.246,-457.999C93.7053,-453.184 78.0818,-447.629 64.3389,-442.743"/>
<polygon fill="#000000" stroke="#000000" points="65.3157,-439.375 54.721,-439.323 62.9706,-445.971 65.3157,-439.375"/>
</g>
<!-- module~moremeshsubs&#45;&gt;parallel -->
<g id="proc~~dhscf_init~~UsesGraph_edge32" class="edge"><title>module~moremeshsubs&#45;&gt;parallel</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M114.199,-457.884C106.438,-453.899 98.1389,-449.155 91,-444 72.9085,-430.936 71.7662,-423.726 55,-409 54.162,-408.264 53.3025,-407.522 52.4291,-406.778"/>
<polygon fill="#000000" stroke="#000000" points="54.3549,-403.83 44.4086,-400.18 49.9079,-409.236 54.3549,-403.83"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="490pt" height="32pt"
 viewBox="0.00 0.00 489.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 485.5,-28 485.5,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node"><title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node"><title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="139.5,-24 72.5,-24 72.5,-0 139.5,-0 139.5,-24"/>
<text text-anchor="middle" x="106" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="222,-24 158,-24 158,-0 222,-0 222,-24"/>
<text text-anchor="middle" x="190" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="294,-24 240,-24 240,-0 294,-0 294,-24"/>
<text text-anchor="middle" x="267" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="366,-24 312,-24 312,-0 366,-0 366,-24"/>
<text text-anchor="middle" x="339" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="481.5,-24 384.5,-24 384.5,-0 481.5,-0 481.5,-24"/>
<text text-anchor="middle" x="433" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses.
    </p>
    </div></div></div></div>
      </li>
      
      </ul>
    </div>
    


    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nspin%7E3"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nspin</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-norb"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>norb</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iaorb"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>iaorb</strong>(norb)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iphorb"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>iphorb</strong>(norb)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nuo"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nuo</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nuotot"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nuotot</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nua"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nua</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-na%7E2"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>na</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-isa"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>isa</strong>(na)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-xa"></span>real(kind=dp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>xa</strong>(3,na)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-indxua"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>indxua</strong>(na)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ucell"></span>real(kind=dp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ucell</strong>(3,3)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-mscell"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>mscell</strong>(3,3)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-g2max%7E2"></span>real(kind=dp),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>g2max</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ntm"></span>integer,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ntm</strong>(3)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-maxnd"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>maxnd</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-numd"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>numd</strong>(nuo)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-listdptr"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>listdptr</strong>(nuo)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-listd"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>listd</strong>(maxnd)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-datm"></span>real(kind=dp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>datm</strong>(norb)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-fal"></span>real(kind=dp),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>Fal</strong>(3,nua)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-stressl"></span>real(kind=dp),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>stressl</strong>(3,3)</td><td></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~dhscf_init~~CallsGraph Pages: 1 -->
<svg id="procdhscf_initCallsGraph" width="622pt" height="1604pt"
 viewBox="0.00 0.00 622.00 1604.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~dhscf_init~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 1600)">
<title>proc~~dhscf_init~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1600 618,-1600 618,4 -4,4"/>
<!-- proc~dhscf_init -->
<g id="proc~~dhscf_init~~CallsGraph_node1" class="node"><title>proc~dhscf_init</title>
<polygon fill="none" stroke="black" points="58,-806 3.55271e-15,-806 3.55271e-15,-782 58,-782 58,-806"/>
<text text-anchor="middle" x="29" y="-791.6" font-family="Helvetica,sans-Serif" font-size="10.50">dhscf_init</text>
</g>
<!-- volcel -->
<g id="proc~~dhscf_init~~CallsGraph_node2" class="node"><title>volcel</title>
<polygon fill="#777777" stroke="#777777" points="207,-1596 153,-1596 153,-1572 207,-1572 207,-1596"/>
<text text-anchor="middle" x="180" y="-1581.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">volcel</text>
</g>
<!-- proc~dhscf_init&#45;&gt;volcel -->
<g id="proc~~dhscf_init~~CallsGraph_edge1" class="edge"><title>proc~dhscf_init&#45;&gt;volcel</title>
<path fill="none" stroke="#000000" d="M30.1721,-806.246C31.5984,-900.063 42.7297,-1502.84 94,-1563 105.84,-1576.89 125.273,-1582.37 142.572,-1584.27"/>
<polygon fill="#000000" stroke="#000000" points="142.751,-1587.8 152.981,-1585.04 143.264,-1580.82 142.751,-1587.8"/>
</g>
<!-- ts_init_voltage -->
<g id="proc~~dhscf_init~~CallsGraph_node3" class="node"><title>ts_init_voltage</title>
<polygon fill="#777777" stroke="#777777" points="220.5,-1554 139.5,-1554 139.5,-1530 220.5,-1530 220.5,-1554"/>
<text text-anchor="middle" x="180" y="-1539.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ts_init_voltage</text>
</g>
<!-- proc~dhscf_init&#45;&gt;ts_init_voltage -->
<g id="proc~~dhscf_init~~CallsGraph_edge2" class="edge"><title>proc~dhscf_init&#45;&gt;ts_init_voltage</title>
<path fill="none" stroke="#000000" d="M30.268,-806.041C32.3677,-895.785 47.3462,-1458.45 94,-1516 102.836,-1526.9 116.119,-1533.34 129.575,-1537.11"/>
<polygon fill="#000000" stroke="#000000" points="128.807,-1540.52 139.343,-1539.41 130.41,-1533.71 128.807,-1540.52"/>
</g>
<!-- re_alloc -->
<g id="proc~~dhscf_init~~CallsGraph_node4" class="node"><title>re_alloc</title>
<polygon fill="#777777" stroke="#777777" points="614,-758 560,-758 560,-734 614,-734 614,-758"/>
<text text-anchor="middle" x="587" y="-743.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">re_alloc</text>
</g>
<!-- proc~dhscf_init&#45;&gt;re_alloc -->
<g id="proc~~dhscf_init~~CallsGraph_edge3" class="edge"><title>proc~dhscf_init&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M30.1683,-806.189C31.5113,-894.603 41.8368,-1435.46 94,-1483 145.054,-1529.53 354.159,-1490.83 402,-1441 499.682,-1339.26 568.297,-875.492 583.036,-768.202"/>
<polygon fill="#000000" stroke="#000000" points="586.519,-768.562 584.398,-758.182 579.583,-767.62 586.519,-768.562"/>
</g>
<!-- rcut -->
<g id="proc~~dhscf_init~~CallsGraph_node5" class="node"><title>rcut</title>
<polygon fill="#777777" stroke="#777777" points="207,-1474 153,-1474 153,-1450 207,-1450 207,-1474"/>
<text text-anchor="middle" x="180" y="-1459.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rcut</text>
</g>
<!-- proc~dhscf_init&#45;&gt;rcut -->
<g id="proc~~dhscf_init~~CallsGraph_edge4" class="edge"><title>proc~dhscf_init&#45;&gt;rcut</title>
<path fill="none" stroke="#000000" d="M30.3705,-806.135C33.0609,-890.777 50.7326,-1391.03 94,-1441 105.865,-1454.7 125.12,-1460.2 142.306,-1462.16"/>
<polygon fill="#000000" stroke="#000000" points="142.413,-1465.68 152.654,-1462.96 142.956,-1458.7 142.413,-1465.68"/>
</g>
<!-- de_alloc -->
<g id="proc~~dhscf_init~~CallsGraph_node6" class="node"><title>de_alloc</title>
<polygon fill="#777777" stroke="#777777" points="614,-494 560,-494 560,-470 614,-470 614,-494"/>
<text text-anchor="middle" x="587" y="-479.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">de_alloc</text>
</g>
<!-- proc~dhscf_init&#45;&gt;de_alloc -->
<g id="proc~~dhscf_init~~CallsGraph_edge5" class="edge"><title>proc~dhscf_init&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M30.2575,-781.852C31.7303,-725.413 41.0195,-489.673 94,-445 167.056,-383.4 432.489,-413.479 524,-441 538.968,-445.502 553.652,-454.922 564.969,-463.599"/>
<polygon fill="#000000" stroke="#000000" points="562.932,-466.452 572.917,-469.995 567.321,-460.998 562.932,-466.452"/>
</g>
<!-- fdf_get -->
<g id="proc~~dhscf_init~~CallsGraph_node7" class="node"><title>fdf_get</title>
<polygon fill="#777777" stroke="#777777" points="207,-1390 153,-1390 153,-1366 207,-1366 207,-1390"/>
<text text-anchor="middle" x="180" y="-1375.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fdf_get</text>
</g>
<!-- proc~dhscf_init&#45;&gt;fdf_get -->
<g id="proc~~dhscf_init~~CallsGraph_edge32" class="edge"><title>proc~dhscf_init&#45;&gt;fdf_get</title>
<path fill="none" stroke="#000000" d="M30.5529,-806.024C34.2344,-883.809 56.2182,-1314 94,-1357 105.965,-1370.62 125.227,-1376.1 142.391,-1378.08"/>
<polygon fill="#000000" stroke="#000000" points="142.478,-1381.6 152.723,-1378.9 143.031,-1374.62 142.478,-1381.6"/>
</g>
<!-- setupextmesh -->
<g id="proc~~dhscf_init~~CallsGraph_node8" class="node"><title>setupextmesh</title>
<polygon fill="#777777" stroke="#777777" points="219.5,-1348 140.5,-1348 140.5,-1324 219.5,-1324 219.5,-1348"/>
<text text-anchor="middle" x="180" y="-1333.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setupextmesh</text>
</g>
<!-- proc~dhscf_init&#45;&gt;setupextmesh -->
<g id="proc~~dhscf_init~~CallsGraph_edge7" class="edge"><title>proc~dhscf_init&#45;&gt;setupextmesh</title>
<path fill="none" stroke="#000000" d="M29.7044,-806.139C28.2333,-876.968 24.3196,-1236.41 94,-1315 103.161,-1325.33 116.524,-1330.98 129.953,-1333.96"/>
<polygon fill="#000000" stroke="#000000" points="129.712,-1337.47 140.167,-1335.75 130.924,-1330.57 129.712,-1337.47"/>
</g>
<!-- distriphionmesh -->
<g id="proc~~dhscf_init~~CallsGraph_node9" class="node"><title>distriphionmesh</title>
<polygon fill="#777777" stroke="#777777" points="224,-1306 136,-1306 136,-1282 224,-1282 224,-1306"/>
<text text-anchor="middle" x="180" y="-1291.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">distriphionmesh</text>
</g>
<!-- proc~dhscf_init&#45;&gt;distriphionmesh -->
<g id="proc~~dhscf_init~~CallsGraph_edge9" class="edge"><title>proc~dhscf_init&#45;&gt;distriphionmesh</title>
<path fill="none" stroke="#000000" d="M29.8499,-806.031C29.2619,-873.192 29.7473,-1201.3 94,-1273 102.243,-1282.2 113.815,-1287.67 125.774,-1290.86"/>
<polygon fill="#000000" stroke="#000000" points="125.332,-1294.35 135.845,-1293.03 126.808,-1287.5 125.332,-1294.35"/>
</g>
<!-- initmesh -->
<g id="proc~~dhscf_init~~CallsGraph_node10" class="node"><title>initmesh</title>
<polygon fill="#777777" stroke="#777777" points="207,-1264 153,-1264 153,-1240 207,-1240 207,-1264"/>
<text text-anchor="middle" x="180" y="-1249.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">initmesh</text>
</g>
<!-- proc~dhscf_init&#45;&gt;initmesh -->
<g id="proc~~dhscf_init~~CallsGraph_edge10" class="edge"><title>proc~dhscf_init&#45;&gt;initmesh</title>
<path fill="none" stroke="#000000" d="M30.021,-806.217C30.3834,-870.207 35.2527,-1166.27 94,-1231 106.182,-1244.42 125.459,-1249.9 142.578,-1251.92"/>
<polygon fill="#000000" stroke="#000000" points="142.62,-1255.43 152.875,-1252.77 143.197,-1248.45 142.62,-1255.43"/>
</g>
<!-- leqi -->
<g id="proc~~dhscf_init~~CallsGraph_node11" class="node"><title>leqi</title>
<polygon fill="#777777" stroke="#777777" points="207,-1222 153,-1222 153,-1198 207,-1198 207,-1222"/>
<text text-anchor="middle" x="180" y="-1207.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">leqi</text>
</g>
<!-- proc~dhscf_init&#45;&gt;leqi -->
<g id="proc~~dhscf_init~~CallsGraph_edge11" class="edge"><title>proc~dhscf_init&#45;&gt;leqi</title>
<path fill="none" stroke="#000000" d="M30.3165,-806.012C32.1143,-865.22 42.8616,-1125.49 94,-1184 106.111,-1197.86 125.383,-1204.44 142.516,-1207.53"/>
<polygon fill="#000000" stroke="#000000" points="142.425,-1211.05 152.825,-1209.03 143.434,-1204.13 142.425,-1211.05"/>
</g>
<!-- proc~setmeshdistr -->
<g id="proc~~dhscf_init~~CallsGraph_node12" class="node"><title>proc~setmeshdistr</title>
<g id="a_proc~~dhscf_init~~CallsGraph_node12"><a xlink:href=".././proc/setmeshdistr.html" xlink:title="setMeshDistr">
<polygon fill="#d9534f" stroke="#d9534f" points="217.5,-1432 142.5,-1432 142.5,-1408 217.5,-1408 217.5,-1432"/>
<text text-anchor="middle" x="180" y="-1417.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setMeshDistr</text>
</a>
</g>
</g>
<!-- proc~dhscf_init&#45;&gt;proc~setmeshdistr -->
<g id="proc~~dhscf_init~~CallsGraph_edge12" class="edge"><title>proc~dhscf_init&#45;&gt;proc~setmeshdistr</title>
<path fill="none" stroke="#000000" d="M30.4573,-806.122C33.6338,-887.505 53.4846,-1352.52 94,-1399 103.565,-1409.97 117.867,-1415.67 132.024,-1418.51"/>
<polygon fill="#000000" stroke="#000000" points="131.817,-1422.02 142.238,-1420.11 132.898,-1415.11 131.817,-1422.02"/>
</g>
<!-- initatommesh -->
<g id="proc~~dhscf_init~~CallsGraph_node13" class="node"><title>initatommesh</title>
<polygon fill="#777777" stroke="#777777" points="218,-1142 142,-1142 142,-1118 218,-1118 218,-1142"/>
<text text-anchor="middle" x="180" y="-1127.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">initatommesh</text>
</g>
<!-- proc~dhscf_init&#45;&gt;initatommesh -->
<g id="proc~~dhscf_init~~CallsGraph_edge13" class="edge"><title>proc~dhscf_init&#45;&gt;initatommesh</title>
<path fill="none" stroke="#000000" d="M30.7692,-806.115C34.3326,-858.399 50.9304,-1064.09 94,-1109 103.906,-1119.33 118.022,-1124.9 131.912,-1127.82"/>
<polygon fill="#000000" stroke="#000000" points="131.481,-1131.29 141.923,-1129.5 132.642,-1124.39 131.481,-1131.29"/>
</g>
<!-- proc~reord -->
<g id="proc~~dhscf_init~~CallsGraph_node14" class="node"><title>proc~reord</title>
<g id="a_proc~~dhscf_init~~CallsGraph_node14"><a xlink:href=".././proc/reord.html" xlink:title="reord">
<polygon fill="#d9534f" stroke="#d9534f" points="508,-474 454,-474 454,-450 508,-450 508,-474"/>
<text text-anchor="middle" x="481" y="-459.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reord</text>
</a>
</g>
</g>
<!-- proc~dhscf_init&#45;&gt;proc~reord -->
<g id="proc~~dhscf_init~~CallsGraph_edge14" class="edge"><title>proc~dhscf_init&#45;&gt;proc~reord</title>
<path fill="none" stroke="#000000" d="M30.5583,-781.662C33.2417,-728.446 46.6988,-519.426 94,-479 145.766,-434.759 358.214,-449.999 443.912,-458.2"/>
<polygon fill="#000000" stroke="#000000" points="443.659,-461.692 453.953,-459.185 444.342,-454.725 443.659,-461.692"/>
</g>
<!-- init_hartree_add -->
<g id="proc~~dhscf_init~~CallsGraph_node15" class="node"><title>init_hartree_add</title>
<polygon fill="#777777" stroke="#777777" points="225.5,-1058 134.5,-1058 134.5,-1034 225.5,-1034 225.5,-1058"/>
<text text-anchor="middle" x="180" y="-1043.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_hartree_add</text>
</g>
<!-- proc~dhscf_init&#45;&gt;init_hartree_add -->
<g id="proc~~dhscf_init~~CallsGraph_edge15" class="edge"><title>proc~dhscf_init&#45;&gt;init_hartree_add</title>
<path fill="none" stroke="#000000" d="M29.4314,-806.132C28.3451,-844.326 30.4488,-963.208 94,-1025 102.345,-1033.11 113.302,-1038.25 124.562,-1041.47"/>
<polygon fill="#000000" stroke="#000000" points="123.939,-1044.92 134.478,-1043.83 125.56,-1038.11 123.939,-1044.92"/>
</g>
<!-- ts_init_hartree_fix -->
<g id="proc~~dhscf_init~~CallsGraph_node16" class="node"><title>ts_init_hartree_fix</title>
<polygon fill="#777777" stroke="#777777" points="228.5,-1016 131.5,-1016 131.5,-992 228.5,-992 228.5,-1016"/>
<text text-anchor="middle" x="180" y="-1001.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ts_init_hartree_fix</text>
</g>
<!-- proc~dhscf_init&#45;&gt;ts_init_hartree_fix -->
<g id="proc~~dhscf_init~~CallsGraph_edge8" class="edge"><title>proc~dhscf_init&#45;&gt;ts_init_hartree_fix</title>
<path fill="none" stroke="#000000" d="M30.3108,-806.299C31.8549,-839.946 40.9465,-934.24 94,-983 101.718,-990.093 111.446,-994.889 121.541,-998.11"/>
<polygon fill="#000000" stroke="#000000" points="120.711,-1001.51 131.278,-1000.74 122.536,-994.753 120.711,-1001.51"/>
</g>
<!-- partialcoreonmesh -->
<g id="proc~~dhscf_init~~CallsGraph_node17" class="node"><title>partialcoreonmesh</title>
<polygon fill="#777777" stroke="#777777" points="230.5,-974 129.5,-974 129.5,-950 230.5,-950 230.5,-974"/>
<text text-anchor="middle" x="180" y="-959.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">partialcoreonmesh</text>
</g>
<!-- proc~dhscf_init&#45;&gt;partialcoreonmesh -->
<g id="proc~~dhscf_init~~CallsGraph_edge17" class="edge"><title>proc~dhscf_init&#45;&gt;partialcoreonmesh</title>
<path fill="none" stroke="#000000" d="M31.607,-806.021C36.0282,-834.172 51.0391,-904.727 94,-941 101.327,-947.186 110.205,-951.599 119.424,-954.737"/>
<polygon fill="#000000" stroke="#000000" points="118.524,-958.12 129.104,-957.565 120.487,-951.401 118.524,-958.12"/>
</g>
<!-- digcel -->
<g id="proc~~dhscf_init~~CallsGraph_node18" class="node"><title>digcel</title>
<polygon fill="#777777" stroke="#777777" points="207,-932 153,-932 153,-908 207,-908 207,-932"/>
<text text-anchor="middle" x="180" y="-917.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">digcel</text>
</g>
<!-- proc~dhscf_init&#45;&gt;digcel -->
<g id="proc~~dhscf_init~~CallsGraph_edge35" class="edge"><title>proc~dhscf_init&#45;&gt;digcel</title>
<path fill="none" stroke="#000000" d="M33.9235,-806.206C41.677,-828.305 61.1197,-874.885 94,-899 107.976,-909.25 126.365,-914.536 142.463,-917.245"/>
<polygon fill="#000000" stroke="#000000" points="142.251,-920.75 152.641,-918.68 143.228,-913.819 142.251,-920.75"/>
</g>
<!-- rcore -->
<g id="proc~~dhscf_init~~CallsGraph_node19" class="node"><title>rcore</title>
<polygon fill="#777777" stroke="#777777" points="207,-890 153,-890 153,-866 207,-866 207,-890"/>
<text text-anchor="middle" x="180" y="-875.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rcore</text>
</g>
<!-- proc~dhscf_init&#45;&gt;rcore -->
<g id="proc~~dhscf_init~~CallsGraph_edge19" class="edge"><title>proc~dhscf_init&#45;&gt;rcore</title>
<path fill="none" stroke="#000000" d="M38.983,-806.173C50.2343,-820.527 70.8661,-844.064 94,-857 108.91,-865.337 127.11,-870.402 142.838,-873.46"/>
<polygon fill="#000000" stroke="#000000" points="142.304,-876.92 152.758,-875.194 143.51,-870.024 142.304,-876.92"/>
</g>
<!-- fdf_integer -->
<g id="proc~~dhscf_init~~CallsGraph_node20" class="node"><title>fdf_integer</title>
<polygon fill="#777777" stroke="#777777" points="212,-848 148,-848 148,-824 212,-824 212,-848"/>
<text text-anchor="middle" x="180" y="-833.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fdf_integer</text>
</g>
<!-- proc~dhscf_init&#45;&gt;fdf_integer -->
<g id="proc~~dhscf_init~~CallsGraph_edge20" class="edge"><title>proc~dhscf_init&#45;&gt;fdf_integer</title>
<path fill="none" stroke="#000000" d="M58.2142,-803.762C69.311,-807.469 82.1983,-811.611 94,-815 108.226,-819.085 123.926,-823.1 137.922,-826.508"/>
<polygon fill="#000000" stroke="#000000" points="137.225,-829.94 147.766,-828.875 138.861,-823.134 137.225,-829.94"/>
</g>
<!-- init_mesh_node -->
<g id="proc~~dhscf_init~~CallsGraph_node21" class="node"><title>init_mesh_node</title>
<polygon fill="#777777" stroke="#777777" points="224,-806 136,-806 136,-782 224,-782 224,-806"/>
<text text-anchor="middle" x="180" y="-791.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_mesh_node</text>
</g>
<!-- proc~dhscf_init&#45;&gt;init_mesh_node -->
<g id="proc~~dhscf_init~~CallsGraph_edge21" class="edge"><title>proc~dhscf_init&#45;&gt;init_mesh_node</title>
<path fill="none" stroke="#000000" d="M58.0258,-794C77.0328,-794 102.76,-794 125.602,-794"/>
<polygon fill="#000000" stroke="#000000" points="125.859,-797.5 135.859,-794 125.859,-790.5 125.859,-797.5"/>
</g>
<!-- setgga -->
<g id="proc~~dhscf_init~~CallsGraph_node22" class="node"><title>setgga</title>
<polygon fill="#777777" stroke="#777777" points="207,-764 153,-764 153,-740 207,-740 207,-764"/>
<text text-anchor="middle" x="180" y="-749.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setgga</text>
</g>
<!-- proc~dhscf_init&#45;&gt;setgga -->
<g id="proc~~dhscf_init~~CallsGraph_edge22" class="edge"><title>proc~dhscf_init&#45;&gt;setgga</title>
<path fill="none" stroke="#000000" d="M58.2142,-784.238C69.311,-780.531 82.1983,-776.389 94,-773 109.907,-768.432 127.658,-763.951 142.807,-760.31"/>
<polygon fill="#000000" stroke="#000000" points="143.904,-763.647 152.825,-757.932 142.287,-756.836 143.904,-763.647"/>
</g>
<!-- phionmesh -->
<g id="proc~~dhscf_init~~CallsGraph_node23" class="node"><title>phionmesh</title>
<polygon fill="#777777" stroke="#777777" points="212.5,-722 147.5,-722 147.5,-698 212.5,-698 212.5,-722"/>
<text text-anchor="middle" x="180" y="-707.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">phionmesh</text>
</g>
<!-- proc~dhscf_init&#45;&gt;phionmesh -->
<g id="proc~~dhscf_init~~CallsGraph_edge23" class="edge"><title>proc~dhscf_init&#45;&gt;phionmesh</title>
<path fill="none" stroke="#000000" d="M38.983,-781.827C50.2343,-767.473 70.8661,-743.936 94,-731 107.131,-723.657 122.815,-718.853 137.114,-715.722"/>
<polygon fill="#000000" stroke="#000000" points="138.092,-719.097 147.225,-713.726 136.736,-712.229 138.092,-719.097"/>
</g>
<!-- initialize_efield -->
<g id="proc~~dhscf_init~~CallsGraph_node24" class="node"><title>initialize_efield</title>
<polygon fill="#777777" stroke="#777777" points="221,-680 139,-680 139,-656 221,-656 221,-680"/>
<text text-anchor="middle" x="180" y="-665.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">initialize_efield</text>
</g>
<!-- proc~dhscf_init&#45;&gt;initialize_efield -->
<g id="proc~~dhscf_init~~CallsGraph_edge24" class="edge"><title>proc~dhscf_init&#45;&gt;initialize_efield</title>
<path fill="none" stroke="#000000" d="M33.9235,-781.794C41.677,-759.695 61.1197,-713.115 94,-689 104.055,-681.626 116.394,-676.821 128.52,-673.696"/>
<polygon fill="#000000" stroke="#000000" points="129.603,-677.041 138.601,-671.447 128.079,-670.209 129.603,-677.041"/>
</g>
<!-- getxc -->
<g id="proc~~dhscf_init~~CallsGraph_node25" class="node"><title>getxc</title>
<polygon fill="#777777" stroke="#777777" points="207,-638 153,-638 153,-614 207,-614 207,-638"/>
<text text-anchor="middle" x="180" y="-623.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">getxc</text>
</g>
<!-- proc~dhscf_init&#45;&gt;getxc -->
<g id="proc~~dhscf_init~~CallsGraph_edge37" class="edge"><title>proc~dhscf_init&#45;&gt;getxc</title>
<path fill="none" stroke="#000000" d="M31.607,-781.979C36.0282,-753.828 51.0391,-683.273 94,-647 107.434,-635.658 126.08,-630.278 142.486,-627.788"/>
<polygon fill="#000000" stroke="#000000" points="143.358,-631.208 152.866,-626.535 142.519,-624.258 143.358,-631.208"/>
</g>
<!-- createlocaldscfpointers -->
<g id="proc~~dhscf_init~~CallsGraph_node26" class="node"><title>createlocaldscfpointers</title>
<polygon fill="#777777" stroke="#777777" points="241,-596 119,-596 119,-572 241,-572 241,-596"/>
<text text-anchor="middle" x="180" y="-581.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">createlocaldscfpointers</text>
</g>
<!-- proc~dhscf_init&#45;&gt;createlocaldscfpointers -->
<g id="proc~~dhscf_init~~CallsGraph_edge26" class="edge"><title>proc~dhscf_init&#45;&gt;createlocaldscfpointers</title>
<path fill="none" stroke="#000000" d="M30.3108,-781.701C31.8549,-748.054 40.9465,-653.76 94,-605 98.517,-600.849 103.722,-597.484 109.287,-594.762"/>
<polygon fill="#000000" stroke="#000000" points="111.036,-597.825 118.932,-590.761 108.354,-591.36 111.036,-597.825"/>
</g>
<!-- init_charge_add -->
<g id="proc~~dhscf_init~~CallsGraph_node27" class="node"><title>init_charge_add</title>
<polygon fill="#777777" stroke="#777777" points="224.5,-554 135.5,-554 135.5,-530 224.5,-530 224.5,-554"/>
<text text-anchor="middle" x="180" y="-539.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_charge_add</text>
</g>
<!-- proc~dhscf_init&#45;&gt;init_charge_add -->
<g id="proc~~dhscf_init~~CallsGraph_edge27" class="edge"><title>proc~dhscf_init&#45;&gt;init_charge_add</title>
<path fill="none" stroke="#000000" d="M29.4314,-781.868C28.3451,-743.674 30.4488,-624.792 94,-563 102.599,-554.639 113.973,-549.437 125.594,-546.241"/>
<polygon fill="#000000" stroke="#000000" points="126.392,-549.648 135.358,-544.003 124.828,-542.825 126.392,-549.648"/>
</g>
<!-- neutralatomonmesh -->
<g id="proc~~dhscf_init~~CallsGraph_node28" class="node"><title>neutralatomonmesh</title>
<polygon fill="#777777" stroke="#777777" points="234,-512 126,-512 126,-488 234,-488 234,-512"/>
<text text-anchor="middle" x="180" y="-497.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">neutralatomonmesh</text>
</g>
<!-- proc~dhscf_init&#45;&gt;neutralatomonmesh -->
<g id="proc~~dhscf_init~~CallsGraph_edge28" class="edge"><title>proc~dhscf_init&#45;&gt;neutralatomonmesh</title>
<path fill="none" stroke="#000000" d="M31.1745,-781.909C36.0569,-734.123 56.2763,-559.177 94,-521 100.21,-514.715 107.982,-510.202 116.287,-506.979"/>
<polygon fill="#000000" stroke="#000000" points="117.413,-510.294 125.834,-503.864 115.242,-503.639 117.413,-510.294"/>
</g>
<!-- interface~distmeshdata -->
<g id="proc~~dhscf_init~~CallsGraph_node29" class="node"><title>interface~distmeshdata</title>
<g id="a_proc~~dhscf_init~~CallsGraph_node29"><a xlink:href=".././interface/distmeshdata.html" xlink:title="distMeshData">
<polygon fill="#a7506f" stroke="#a7506f" points="219,-1100 141,-1100 141,-1076 219,-1076 219,-1100"/>
<text text-anchor="middle" x="180" y="-1085.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">distMeshData</text>
</a>
</g>
</g>
<!-- proc~dhscf_init&#45;&gt;interface~distmeshdata -->
<g id="proc~~dhscf_init~~CallsGraph_edge29" class="edge"><title>proc~dhscf_init&#45;&gt;interface~distmeshdata</title>
<path fill="none" stroke="#000000" d="M31.1745,-806.091C36.0569,-853.877 56.2763,-1028.82 94,-1067 103.706,-1076.82 117.227,-1082.32 130.633,-1085.32"/>
<polygon fill="#000000" stroke="#000000" points="130.334,-1088.82 140.798,-1087.16 131.581,-1081.94 130.334,-1088.82"/>
</g>
<!-- die -->
<g id="proc~~dhscf_init~~CallsGraph_node30" class="node"><title>die</title>
<polygon fill="#777777" stroke="#777777" points="508,-760 454,-760 454,-736 508,-736 508,-760"/>
<text text-anchor="middle" x="481" y="-745.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">die</text>
</g>
<!-- proc~dhscf_init&#45;&gt;die -->
<g id="proc~~dhscf_init~~CallsGraph_edge30" class="edge"><title>proc~dhscf_init&#45;&gt;die</title>
<path fill="none" stroke="#000000" d="M30.1902,-806.055C31.3669,-863.143 39.5492,-1105.44 94,-1151 152.63,-1200.05 200.485,-1190.39 266,-1151 411,-1063.82 463.007,-841.611 476.263,-770.354"/>
<polygon fill="#000000" stroke="#000000" points="479.753,-770.717 478.066,-760.257 472.862,-769.486 479.753,-770.717"/>
</g>
<!-- elecs -->
<g id="proc~~dhscf_init~~CallsGraph_node31" class="node"><title>elecs</title>
<polygon fill="#777777" stroke="#777777" points="207,-394 153,-394 153,-370 207,-370 207,-394"/>
<text text-anchor="middle" x="180" y="-379.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elecs</text>
</g>
<!-- proc~dhscf_init&#45;&gt;elecs -->
<g id="proc~~dhscf_init~~CallsGraph_edge31" class="edge"><title>proc~dhscf_init&#45;&gt;elecs</title>
<path fill="none" stroke="#000000" d="M30.3476,-781.719C32.2702,-722.368 43.4362,-465.752 94,-408 106.122,-394.154 125.395,-387.566 142.526,-384.478"/>
<polygon fill="#000000" stroke="#000000" points="143.443,-387.882 152.833,-382.975 142.432,-380.955 143.443,-387.882"/>
</g>
<!-- timer -->
<g id="proc~~dhscf_init~~CallsGraph_node32" class="node"><title>timer</title>
<polygon fill="#777777" stroke="#777777" points="614,-396 560,-396 560,-372 614,-372 614,-396"/>
<text text-anchor="middle" x="587" y="-381.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">timer</text>
</g>
<!-- proc~dhscf_init&#45;&gt;timer -->
<g id="proc~~dhscf_init~~CallsGraph_edge6" class="edge"><title>proc~dhscf_init&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M30.455,-781.777C33.484,-703.669 51.914,-276.512 94,-239 166.65,-174.246 440.948,-271.272 524,-322 542.073,-333.039 558.814,-350.391 570.333,-363.934"/>
<polygon fill="#000000" stroke="#000000" points="567.737,-366.288 576.795,-371.784 573.141,-361.839 567.737,-366.288"/>
</g>
<!-- shaper -->
<g id="proc~~dhscf_init~~CallsGraph_node33" class="node"><title>shaper</title>
<polygon fill="#777777" stroke="#777777" points="207,-314 153,-314 153,-290 207,-290 207,-314"/>
<text text-anchor="middle" x="180" y="-299.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">shaper</text>
</g>
<!-- proc~dhscf_init&#45;&gt;shaper -->
<g id="proc~~dhscf_init~~CallsGraph_edge33" class="edge"><title>proc~dhscf_init&#45;&gt;shaper</title>
<path fill="none" stroke="#000000" d="M29.963,-781.919C30.0034,-715.905 33.3912,-399.2 94,-328 105.929,-313.987 125.188,-307.387 142.36,-304.335"/>
<polygon fill="#000000" stroke="#000000" points="143.294,-307.737 152.698,-302.859 142.304,-300.808 143.294,-307.737"/>
</g>
<!-- user_specified_field -->
<g id="proc~~dhscf_init~~CallsGraph_node34" class="node"><title>user_specified_field</title>
<polygon fill="#777777" stroke="#777777" points="233.5,-272 126.5,-272 126.5,-248 233.5,-248 233.5,-272"/>
<text text-anchor="middle" x="180" y="-257.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">user_specified_field</text>
</g>
<!-- proc~dhscf_init&#45;&gt;user_specified_field -->
<g id="proc~~dhscf_init~~CallsGraph_edge34" class="edge"><title>proc~dhscf_init&#45;&gt;user_specified_field</title>
<path fill="none" stroke="#000000" d="M29.7251,-781.588C28.4155,-710.762 25.4496,-358.164 94,-281 100.153,-274.073 108.195,-269.255 116.878,-265.933"/>
<polygon fill="#000000" stroke="#000000" points="118.015,-269.244 126.491,-262.887 115.901,-262.571 118.015,-269.244"/>
</g>
<!-- write_debug -->
<g id="proc~~dhscf_init~~CallsGraph_node35" class="node"><title>write_debug</title>
<polygon fill="#777777" stroke="#777777" points="516.5,-355 445.5,-355 445.5,-331 516.5,-331 516.5,-355"/>
<text text-anchor="middle" x="481" y="-340.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_debug</text>
</g>
<!-- proc~dhscf_init&#45;&gt;write_debug -->
<g id="proc~~dhscf_init~~CallsGraph_edge18" class="edge"><title>proc~dhscf_init&#45;&gt;write_debug</title>
<path fill="none" stroke="#000000" d="M29.8237,-781.679C29.1808,-717.173 29.7549,-419.113 94,-361 142.924,-316.746 344.494,-329.864 435.296,-338.321"/>
<polygon fill="#000000" stroke="#000000" points="434.998,-341.809 445.286,-339.275 435.663,-334.841 434.998,-341.809"/>
</g>
<!-- cdf_init_mesh -->
<g id="proc~~dhscf_init~~CallsGraph_node36" class="node"><title>cdf_init_mesh</title>
<polygon fill="#777777" stroke="#777777" points="219.5,-192 140.5,-192 140.5,-168 219.5,-168 219.5,-192"/>
<text text-anchor="middle" x="180" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cdf_init_mesh</text>
</g>
<!-- proc~dhscf_init&#45;&gt;cdf_init_mesh -->
<g id="proc~~dhscf_init~~CallsGraph_edge36" class="edge"><title>proc~dhscf_init&#45;&gt;cdf_init_mesh</title>
<path fill="none" stroke="#000000" d="M30.5221,-781.987C34.0855,-702.336 55.8302,-252.136 94,-206 103.103,-194.997 116.732,-188.551 130.425,-184.806"/>
<polygon fill="#000000" stroke="#000000" points="131.379,-188.178 140.343,-182.53 129.813,-181.355 131.379,-188.178"/>
</g>
<!-- set_box_limits -->
<g id="proc~~dhscf_init~~CallsGraph_node37" class="node"><title>set_box_limits</title>
<polygon fill="#777777" stroke="#777777" points="220,-150 140,-150 140,-126 220,-126 220,-150"/>
<text text-anchor="middle" x="180" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_box_limits</text>
</g>
<!-- proc~dhscf_init&#45;&gt;set_box_limits -->
<g id="proc~~dhscf_init~~CallsGraph_edge16" class="edge"><title>proc~dhscf_init&#45;&gt;set_box_limits</title>
<path fill="none" stroke="#000000" d="M30.3957,-781.822C33.2273,-697.965 51.5272,-207.965 94,-159 102.969,-148.66 116.145,-142.996 129.459,-139.998"/>
<polygon fill="#000000" stroke="#000000" points="130.368,-143.391 139.599,-138.191 129.14,-136.499 130.368,-143.391"/>
</g>
<!-- rhooda -->
<g id="proc~~dhscf_init~~CallsGraph_node38" class="node"><title>rhooda</title>
<polygon fill="#777777" stroke="#777777" points="207,-108 153,-108 153,-84 207,-84 207,-108"/>
<text text-anchor="middle" x="180" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rhooda</text>
</g>
<!-- proc~dhscf_init&#45;&gt;rhooda -->
<g id="proc~~dhscf_init~~CallsGraph_edge25" class="edge"><title>proc~dhscf_init&#45;&gt;rhooda</title>
<path fill="none" stroke="#000000" d="M30.3146,-781.865C32.6739,-694.985 48.7626,-169.479 94,-117 105.835,-103.27 125.088,-97.7748 142.28,-95.8216"/>
<polygon fill="#000000" stroke="#000000" points="142.933,-99.2817 152.634,-95.0213 142.394,-92.3025 142.933,-99.2817"/>
</g>
<!-- compute_doping_structs_uniform -->
<g id="proc~~dhscf_init~~CallsGraph_node39" class="node"><title>compute_doping_structs_uniform</title>
<polygon fill="#777777" stroke="#777777" points="266,-66 94,-66 94,-42 266,-42 266,-66"/>
<text text-anchor="middle" x="180" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_doping_structs_uniform</text>
</g>
<!-- proc~dhscf_init&#45;&gt;compute_doping_structs_uniform -->
<g id="proc~~dhscf_init~~CallsGraph_edge38" class="edge"><title>proc~dhscf_init&#45;&gt;compute_doping_structs_uniform</title>
<path fill="none" stroke="#000000" d="M30.2417,-781.984C32.1489,-692.43 45.9801,-131.017 94,-75 94.742,-74.1345 95.5134,-73.3016 96.312,-72.5003"/>
<polygon fill="#000000" stroke="#000000" points="98.6204,-75.1342 104.168,-66.1076 94.2021,-69.7048 98.6204,-75.1342"/>
</g>
<!-- ddot -->
<g id="proc~~dhscf_init~~CallsGraph_node40" class="node"><title>ddot</title>
<polygon fill="#777777" stroke="#777777" points="207,-24 153,-24 153,-0 207,-0 207,-24"/>
<text text-anchor="middle" x="180" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ddot</text>
</g>
<!-- proc~dhscf_init&#45;&gt;ddot -->
<g id="proc~~dhscf_init~~CallsGraph_edge39" class="edge"><title>proc~dhscf_init&#45;&gt;ddot</title>
<path fill="none" stroke="#000000" d="M30.1813,-781.881C31.6771,-689.038 43.2335,-92.5138 94,-33 105.846,-19.1133 125.28,-13.6336 142.578,-11.7294"/>
<polygon fill="#000000" stroke="#000000" points="143.269,-15.1881 152.985,-10.9627 142.755,-8.207 143.269,-15.1881"/>
</g>
<!-- meshlim -->
<g id="proc~~dhscf_init~~CallsGraph_node41" class="node"><title>meshlim</title>
<polygon fill="#777777" stroke="#777777" points="379,-1432 325,-1432 325,-1408 379,-1408 379,-1432"/>
<text text-anchor="middle" x="352" y="-1417.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">meshlim</text>
</g>
<!-- proc~setmeshdistr&#45;&gt;meshlim -->
<g id="proc~~dhscf_init~~CallsGraph_edge40" class="edge"><title>proc~setmeshdistr&#45;&gt;meshlim</title>
<path fill="none" stroke="#000000" d="M217.887,-1420C246.549,-1420 286.093,-1420 314.624,-1420"/>
<polygon fill="#000000" stroke="#000000" points="314.974,-1423.5 324.974,-1420 314.974,-1416.5 314.974,-1423.5"/>
</g>
<!-- proc~reord&#45;&gt;re_alloc -->
<g id="proc~~dhscf_init~~CallsGraph_edge41" class="edge"><title>proc~reord&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M492.73,-474.307C502.176,-485.714 515.687,-503.513 524,-521 557.305,-591.058 575.471,-682.166 582.514,-723.659"/>
<polygon fill="#000000" stroke="#000000" points="579.1,-724.466 584.174,-733.767 586.007,-723.331 579.1,-724.466"/>
</g>
<!-- proc~reord&#45;&gt;de_alloc -->
<g id="proc~~dhscf_init~~CallsGraph_edge42" class="edge"><title>proc~reord&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M508.244,-467.047C520.807,-469.463 536.054,-472.395 549.706,-475.02"/>
<polygon fill="#000000" stroke="#000000" points="549.284,-478.503 559.765,-476.955 550.606,-471.629 549.284,-478.503"/>
</g>
<!-- proc~reord&#45;&gt;timer -->
<g id="proc~~dhscf_init~~CallsGraph_edge43" class="edge"><title>proc~reord&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M498.25,-449.812C515.27,-437.048 542.192,-416.856 561.731,-402.202"/>
<polygon fill="#000000" stroke="#000000" points="563.964,-404.902 569.864,-396.102 559.764,-399.302 563.964,-404.902"/>
</g>
<!-- proc~distmeshdata_rea -->
<g id="proc~~dhscf_init~~CallsGraph_node42" class="node"><title>proc~distmeshdata_rea</title>
<g id="a_proc~~dhscf_init~~CallsGraph_node42"><a xlink:href=".././proc/distmeshdata_rea.html" xlink:title="distMeshData_rea">
<polygon fill="#d9534f" stroke="#d9534f" points="402,-596 302,-596 302,-572 402,-572 402,-596"/>
<text text-anchor="middle" x="352" y="-581.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">distMeshData_rea</text>
</a>
</g>
</g>
<!-- interface~distmeshdata&#45;&gt;proc~distmeshdata_rea -->
<g id="proc~~dhscf_init~~CallsGraph_edge44" class="edge"><title>interface~distmeshdata&#45;&gt;proc~distmeshdata_rea</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M219.414,-1087.82C236.092,-1085.66 254.421,-1080.1 266,-1067 310.476,-1016.7 289.284,-832.93 302,-767 313.353,-708.135 333.38,-640.322 343.973,-606.145"/>
<polygon fill="#000000" stroke="#000000" points="347.413,-606.873 347.059,-596.285 340.732,-604.783 347.413,-606.873"/>
</g>
<!-- proc~distmeshdata_int -->
<g id="proc~~dhscf_init~~CallsGraph_node43" class="node"><title>proc~distmeshdata_int</title>
<g id="a_proc~~dhscf_init~~CallsGraph_node43"><a xlink:href=".././proc/distmeshdata_int.html" xlink:title="distMeshData_int">
<polygon fill="#d9534f" stroke="#d9534f" points="399.5,-800 304.5,-800 304.5,-776 399.5,-776 399.5,-800"/>
<text text-anchor="middle" x="352" y="-785.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">distMeshData_int</text>
</a>
</g>
</g>
<!-- interface~distmeshdata&#45;&gt;proc~distmeshdata_int -->
<g id="proc~~dhscf_init~~CallsGraph_edge45" class="edge"><title>interface~distmeshdata&#45;&gt;proc~distmeshdata_int</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M219.267,-1086.72C235.511,-1084.29 253.534,-1078.82 266,-1067 340.296,-996.578 350.257,-863.385 351.161,-810.482"/>
<polygon fill="#000000" stroke="#000000" points="354.663,-810.215 351.235,-800.19 347.663,-810.164 354.663,-810.215"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;re_alloc -->
<g id="proc~~dhscf_init~~CallsGraph_edge49" class="edge"><title>proc~distmeshdata_rea&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M367.358,-596.199C383.729,-609.729 411.645,-631.666 438,-647 474.119,-668.015 489.433,-661.52 524,-685 541.171,-696.664 557.779,-713.391 569.477,-726.38"/>
<polygon fill="#000000" stroke="#000000" points="566.858,-728.702 576.087,-733.905 572.118,-724.082 566.858,-728.702"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;de_alloc -->
<g id="proc~~dhscf_init~~CallsGraph_edge53" class="edge"><title>proc~distmeshdata_rea&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M366.083,-571.774C381.937,-557.59 410.017,-534.439 438,-521 474.153,-503.637 519.123,-493.191 549.946,-487.541"/>
<polygon fill="#000000" stroke="#000000" points="550.579,-490.983 559.823,-485.806 549.368,-484.089 550.579,-490.983"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;proc~reord -->
<g id="proc~~dhscf_init~~CallsGraph_edge48" class="edge"><title>proc~distmeshdata_rea&#45;&gt;proc~reord</title>
<path fill="none" stroke="#000000" d="M361.956,-571.754C376.47,-552.44 406.677,-514.393 438,-488 441.488,-485.061 445.34,-482.221 449.253,-479.565"/>
<polygon fill="#000000" stroke="#000000" points="451.276,-482.426 457.802,-474.08 447.496,-476.534 451.276,-482.426"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;die -->
<g id="proc~~dhscf_init~~CallsGraph_edge55" class="edge"><title>proc~distmeshdata_rea&#45;&gt;die</title>
<path fill="none" stroke="#000000" d="M357.506,-596.29C367.895,-623.162 395.911,-687.863 438,-727 440.127,-728.978 442.475,-730.812 444.942,-732.504"/>
<polygon fill="#000000" stroke="#000000" points="443.259,-735.575 453.637,-737.711 446.856,-729.57 443.259,-735.575"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;timer -->
<g id="proc~~dhscf_init~~CallsGraph_edge51" class="edge"><title>proc~distmeshdata_rea&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M357.086,-571.814C366.809,-544.581 393.861,-478.258 438,-441 470.466,-413.596 517.562,-398.519 549.858,-390.865"/>
<polygon fill="#000000" stroke="#000000" points="550.796,-394.241 559.786,-388.634 549.262,-387.412 550.796,-394.241"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;write_debug -->
<g id="proc~~dhscf_init~~CallsGraph_edge54" class="edge"><title>proc~distmeshdata_rea&#45;&gt;write_debug</title>
<path fill="none" stroke="#000000" d="M355.126,-571.783C361.737,-536.807 384.769,-434.657 438,-370 440.727,-366.687 443.97,-363.646 447.427,-360.896"/>
<polygon fill="#000000" stroke="#000000" points="449.599,-363.646 455.741,-355.013 445.556,-357.932 449.599,-363.646"/>
</g>
<!-- mpitrace_event -->
<g id="proc~~dhscf_init~~CallsGraph_node44" class="node"><title>mpitrace_event</title>
<polygon fill="#777777" stroke="#777777" points="524,-596 438,-596 438,-572 524,-572 524,-596"/>
<text text-anchor="middle" x="481" y="-581.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpitrace_event</text>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;mpitrace_event -->
<g id="proc~~dhscf_init~~CallsGraph_edge46" class="edge"><title>proc~distmeshdata_rea&#45;&gt;mpitrace_event</title>
<path fill="none" stroke="#000000" d="M402.102,-584C410.438,-584 419.125,-584 427.544,-584"/>
<polygon fill="#000000" stroke="#000000" points="427.639,-587.5 437.639,-584 427.639,-580.5 427.639,-587.5"/>
</g>
<!-- nmeshg -->
<g id="proc~~dhscf_init~~CallsGraph_node45" class="node"><title>nmeshg</title>
<polygon fill="#777777" stroke="#777777" points="508,-554 454,-554 454,-530 508,-530 508,-554"/>
<text text-anchor="middle" x="481" y="-539.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nmeshg</text>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;nmeshg -->
<g id="proc~~dhscf_init~~CallsGraph_edge47" class="edge"><title>proc~distmeshdata_rea&#45;&gt;nmeshg</title>
<path fill="none" stroke="#000000" d="M389.393,-571.964C406.549,-566.291 426.955,-559.542 444.054,-553.888"/>
<polygon fill="#000000" stroke="#000000" points="445.295,-557.164 453.69,-550.701 443.097,-550.518 445.295,-557.164"/>
</g>
<!-- proc~boxintersection -->
<g id="proc~~dhscf_init~~CallsGraph_node46" class="node"><title>proc~boxintersection</title>
<g id="a_proc~~dhscf_init~~CallsGraph_node46"><a xlink:href=".././proc/boxintersection.html" xlink:title="boxIntersection">
<polygon fill="#d9534f" stroke="#d9534f" points="523.5,-718 438.5,-718 438.5,-694 523.5,-694 523.5,-718"/>
<text text-anchor="middle" x="481" y="-703.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">boxIntersection</text>
</a>
</g>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;proc~boxintersection -->
<g id="proc~~dhscf_init~~CallsGraph_edge50" class="edge"><title>proc~distmeshdata_rea&#45;&gt;proc~boxintersection</title>
<path fill="none" stroke="#000000" d="M361.956,-596.246C376.47,-615.56 406.677,-653.607 438,-680 441.488,-682.939 445.34,-685.779 449.253,-688.435"/>
<polygon fill="#000000" stroke="#000000" points="447.496,-691.466 457.802,-693.92 451.276,-685.574 447.496,-691.466"/>
</g>
<!-- mpi_barrier -->
<g id="proc~~dhscf_init~~CallsGraph_node47" class="node"><title>mpi_barrier</title>
<polygon fill="#777777" stroke="#777777" points="514.5,-638 447.5,-638 447.5,-614 514.5,-614 514.5,-638"/>
<text text-anchor="middle" x="481" y="-623.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_barrier</text>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;mpi_barrier -->
<g id="proc~~dhscf_init~~CallsGraph_edge52" class="edge"><title>proc~distmeshdata_rea&#45;&gt;mpi_barrier</title>
<path fill="none" stroke="#000000" d="M389.393,-596.036C404.425,-601.007 421.951,-606.803 437.562,-611.966"/>
<polygon fill="#000000" stroke="#000000" points="436.906,-615.435 447.499,-615.252 439.104,-608.789 436.906,-615.435"/>
</g>
<!-- proc~distmeshdata_int&#45;&gt;re_alloc -->
<g id="proc~~dhscf_init~~CallsGraph_edge59" class="edge"><title>proc~distmeshdata_int&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M389.681,-800.014C425.233,-809.606 480.076,-818.9 524,-802 542.656,-794.822 559.193,-779.144 570.487,-766.197"/>
<polygon fill="#000000" stroke="#000000" points="573.429,-768.131 577.12,-758.2 568.042,-763.662 573.429,-768.131"/>
</g>
<!-- proc~distmeshdata_int&#45;&gt;de_alloc -->
<g id="proc~~dhscf_init~~CallsGraph_edge58" class="edge"><title>proc~distmeshdata_int&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M399.568,-796.368C437.75,-800.387 490.742,-799.024 524,-769 563.45,-733.386 579.768,-565.374 584.464,-504.279"/>
<polygon fill="#000000" stroke="#000000" points="587.964,-504.401 585.209,-494.171 580.983,-503.887 587.964,-504.401"/>
</g>
<!-- proc~distmeshdata_int&#45;&gt;die -->
<g id="proc~~dhscf_init~~CallsGraph_edge56" class="edge"><title>proc~distmeshdata_int&#45;&gt;die</title>
<path fill="none" stroke="#000000" d="M391.104,-775.999C407.925,-770.701 427.592,-764.506 444.145,-759.293"/>
<polygon fill="#000000" stroke="#000000" points="445.509,-762.533 453.996,-756.19 443.406,-755.856 445.509,-762.533"/>
</g>
<!-- proc~distmeshdata_int&#45;&gt;proc~boxintersection -->
<g id="proc~~dhscf_init~~CallsGraph_edge57" class="edge"><title>proc~distmeshdata_int&#45;&gt;proc~boxintersection</title>
<path fill="none" stroke="#000000" d="M368.162,-775.992C384.786,-763.098 412.497,-742.393 438,-727 440.34,-725.587 442.788,-724.185 445.275,-722.813"/>
<polygon fill="#000000" stroke="#000000" points="447.128,-725.793 454.331,-718.023 443.855,-719.605 447.128,-725.793"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,-0 209.5,-0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.5,-24 454.5,-24 454.5,-0 551.5,-0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~dhscf_init~~CalledByGraph Pages: 1 -->
<svg id="procdhscf_initCalledByGraph" width="160pt" height="32pt"
 viewBox="0.00 0.00 160.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~dhscf_init~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~dhscf_init~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 156,-28 156,4 -4,4"/>
<!-- proc~dhscf_init -->
<g id="proc~~dhscf_init~~CalledByGraph_node1" class="node"><title>proc~dhscf_init</title>
<polygon fill="none" stroke="black" points="152,-24 94,-24 94,-0 152,-0 152,-24"/>
<text text-anchor="middle" x="123" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">dhscf_init</text>
</g>
<!-- proc~setup_h0 -->
<g id="proc~~dhscf_init~~CalledByGraph_node2" class="node"><title>proc~setup_h0</title>
<g id="a_proc~~dhscf_init~~CalledByGraph_node2"><a xlink:href=".././proc/setup_h0.html" xlink:title="setup_H0">
<polygon fill="#d9534f" stroke="#d9534f" points="58,-24 3.55271e-15,-24 3.55271e-15,-0 58,-0 58,-24"/>
<text text-anchor="middle" x="29" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_H0</text>
</a>
</g>
</g>
<!-- proc~setup_h0&#45;&gt;proc~dhscf_init -->
<g id="proc~~dhscf_init~~CalledByGraph_edge1" class="edge"><title>proc~setup_h0&#45;&gt;proc~dhscf_init</title>
<path fill="none" stroke="#000000" d="M58.1029,-12C66.1425,-12 75.0461,-12 83.5904,-12"/>
<polygon fill="#000000" stroke="#000000" points="83.7522,-15.5001 93.7521,-12 83.7521,-8.5001 83.7522,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,-0 209.5,-0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.5,-24 454.5,-24 454.5,-0 551.5,-0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/dhscf_init.html#src">dhscf_init</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>      <span class="k">subroutine </span><span class="n">dhscf_init</span><span class="p">(</span><span class="n">nspin</span><span class="p">,</span> <span class="n">norb</span><span class="p">,</span> <span class="n">iaorb</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span>
     <span class="p">&amp;</span>                      <span class="n">nuo</span><span class="p">,</span> <span class="n">nuotot</span><span class="p">,</span> <span class="n">nua</span><span class="p">,</span> <span class="n">na</span><span class="p">,</span>
     <span class="p">&amp;</span>                      <span class="n">isa</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">indxua</span><span class="p">,</span> <span class="n">ucell</span><span class="p">,</span>
     <span class="p">&amp;</span>                      <span class="n">mscell</span><span class="p">,</span> <span class="n">G2max</span><span class="p">,</span> <span class="n">ntm</span><span class="p">,</span>
     <span class="p">&amp;</span>                      <span class="n">maxnd</span><span class="p">,</span> <span class="n">numd</span><span class="p">,</span> <span class="n">listdptr</span><span class="p">,</span> <span class="n">listd</span><span class="p">,</span> <span class="n">datm</span><span class="p">,</span>
     <span class="p">&amp;</span>                      <span class="n">Fal</span><span class="p">,</span> <span class="n">stressl</span><span class="p">)</span>

      <span class="k">use </span><span class="nb">precision</span><span class="p">,</span>      <span class="n">only</span> <span class="p">:</span> <span class="n">dp</span><span class="p">,</span> <span class="n">grid_p</span>
      <span class="k">use </span><span class="n">parallel</span><span class="p">,</span>       <span class="n">only</span> <span class="p">:</span> <span class="n">Node</span><span class="p">,</span> <span class="n">Nodes</span>
      <span class="k">use </span><span class="n">atmfuncs</span><span class="p">,</span>       <span class="n">only</span> <span class="p">:</span> <span class="n">rcut</span><span class="p">,</span> <span class="n">rcore</span>
      <span class="k">use </span><span class="n">fdf</span>
      <span class="k">use </span><span class="n">sys</span><span class="p">,</span>            <span class="n">only</span> <span class="p">:</span> <span class="n">die</span>
      <span class="k">use </span><span class="n">mesh</span><span class="p">,</span>           <span class="n">only</span> <span class="p">:</span> <span class="n">xdsp</span><span class="p">,</span> <span class="n">nsm</span><span class="p">,</span> <span class="n">nsp</span><span class="p">,</span> <span class="n">meshLim</span>
      <span class="k">use </span><span class="n">parsing</span>
<span class="cp">#ifndef BSC_CELLXC</span>
      <span class="k">use </span><span class="n">siestaXC</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">getXC</span>        <span class="c">! Returns the XC functional used</span>
<span class="cp">#else /* BSC_CELLXC */</span>
      <span class="k">use </span><span class="n">bsc_xcmod</span><span class="p">,</span>          <span class="n">only</span> <span class="p">:</span> <span class="n">nXCfunc</span><span class="p">,</span> <span class="n">XCauth</span>
<span class="cp">#endif /* BSC_CELLXC */</span>
      <span class="k">use </span><span class="n">alloc</span><span class="p">,</span>          <span class="n">only</span> <span class="p">:</span> <span class="n">re_alloc</span><span class="p">,</span> <span class="n">de_alloc</span>
      <span class="k">use </span><span class="n">siesta_options</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">harrisfun</span>
      <span class="k">use </span><span class="n">meshsubs</span><span class="p">,</span>       <span class="n">only</span> <span class="p">:</span> <span class="n">PartialCoreOnMesh</span>
      <span class="k">use </span><span class="n">meshsubs</span><span class="p">,</span>       <span class="n">only</span> <span class="p">:</span> <span class="n">NeutralAtomOnMesh</span>
      <span class="k">use </span><span class="n">meshsubs</span><span class="p">,</span>       <span class="n">only</span> <span class="p">:</span> <span class="n">PhiOnMesh</span>
      <span class="k">use </span><span class="n">meshsubs</span><span class="p">,</span>       <span class="n">only</span> <span class="p">:</span> <span class="n">InitMesh</span>
      <span class="k">use </span><span class="n">meshsubs</span><span class="p">,</span>       <span class="n">only</span> <span class="p">:</span> <span class="n">InitAtomMesh</span>
      <span class="k">use </span><span class="n">meshsubs</span><span class="p">,</span>       <span class="n">only</span> <span class="p">:</span> <span class="n">setupExtMesh</span>
      <span class="k">use </span><span class="n">meshsubs</span><span class="p">,</span>       <span class="n">only</span> <span class="p">:</span> <span class="n">distriPhiOnMesh</span>

      <span class="k">use </span><span class="n">moreMeshSubs</span><span class="p">,</span>   <span class="n">only</span> <span class="p">:</span> <span class="n">setMeshDistr</span><span class="p">,</span> <span class="n">distMeshData</span>
      <span class="k">use </span><span class="n">moreMeshSubs</span><span class="p">,</span>   <span class="n">only</span> <span class="p">:</span> <span class="n">UNIFORM</span><span class="p">,</span> <span class="n">QUADRATIC</span><span class="p">,</span> <span class="n">LINEAR</span>
      <span class="k">use </span><span class="n">moreMeshSubs</span><span class="p">,</span>   <span class="n">only</span> <span class="p">:</span> <span class="n">TO_SEQUENTIAL</span><span class="p">,</span> <span class="n">TO_CLUSTER</span><span class="p">,</span> <span class="n">KEEP</span>

      <span class="k">use </span><span class="n">meshdscf</span><span class="p">,</span>       <span class="n">only</span> <span class="p">:</span> <span class="n">createLocalDscfPointers</span>

      <span class="k">use </span><span class="n">iogrid_netcdf</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">set_box_limits</span>
<span class="cp">#ifdef NCDF_4</span>
      <span class="k">use </span><span class="n">m_ncdf_io</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">cdf_init_mesh</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef BSC_CELLXC</span>
      <span class="k">use </span><span class="n">cellxc_mod</span><span class="p">,</span>     <span class="n">only</span> <span class="p">:</span> <span class="n">setGGA</span>
<span class="cp">#endif /* BSC_CELLXC */</span>
      <span class="k">use </span><span class="n">m_efield</span><span class="p">,</span>       <span class="n">only</span> <span class="p">:</span> <span class="n">initialize_efield</span><span class="p">,</span> <span class="n">acting_efield</span>
      <span class="k">use </span><span class="n">m_efield</span><span class="p">,</span>       <span class="n">only</span> <span class="p">:</span> <span class="n">get_field_from_dipole</span>
      <span class="k">use </span><span class="n">m_efield</span><span class="p">,</span>       <span class="n">only</span> <span class="p">:</span> <span class="n">dipole_correction</span>
      <span class="k">use </span><span class="n">m_efield</span><span class="p">,</span>       <span class="n">only</span> <span class="p">:</span> <span class="n">user_specified_field</span>

      <span class="k">use </span><span class="n">m_doping_uniform</span><span class="p">,</span>       <span class="n">only</span><span class="p">:</span> <span class="n">initialize_doping_uniform</span>
      <span class="k">use </span><span class="n">m_doping_uniform</span><span class="p">,</span>       <span class="n">only</span><span class="p">:</span> <span class="n">compute_doping_structs_uniform</span><span class="p">,</span>
     <span class="err">$</span>                                  <span class="n">doping_active</span>
      <span class="k">use </span><span class="n">m_rhog</span><span class="p">,</span>                 <span class="n">only</span><span class="p">:</span> <span class="n">rhog</span><span class="p">,</span> <span class="n">rhog_in</span>
      <span class="k">use </span><span class="n">m_rhog</span><span class="p">,</span>                 <span class="n">only</span><span class="p">:</span> <span class="n">order_rhog</span>
      <span class="k">use </span><span class="n">siesta_options</span><span class="p">,</span>         <span class="n">only</span><span class="p">:</span> <span class="n">mix_charge</span>
<span class="cp">#ifdef MPI</span>
      <span class="k">use </span><span class="n">mpi_siesta</span>
<span class="cp">#endif</span>

      <span class="k">use </span><span class="n">m_mesh_node</span><span class="p">,</span>   <span class="n">only</span><span class="p">:</span> <span class="n">init_mesh_node</span>
      <span class="k">use </span><span class="n">m_charge_add</span><span class="p">,</span>  <span class="n">only</span><span class="p">:</span> <span class="n">init_charge_add</span>
      <span class="k">use </span><span class="n">m_hartree_add</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">init_hartree_add</span>

      <span class="k">use </span><span class="n">m_ts_global_vars</span><span class="p">,</span><span class="n">only</span><span class="p">:</span> <span class="n">TSmode</span>
      <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span>   <span class="n">only</span> <span class="p">:</span> <span class="n">IsVolt</span><span class="p">,</span> <span class="n">N_Elec</span><span class="p">,</span> <span class="n">Elecs</span>
      <span class="k">use </span><span class="n">m_ts_voltage</span><span class="p">,</span>   <span class="n">only</span> <span class="p">:</span> <span class="n">ts_init_voltage</span>
      <span class="k">use </span><span class="n">m_ts_hartree</span><span class="p">,</span>   <span class="n">only</span> <span class="p">:</span> <span class="n">ts_init_hartree_fix</span>

      <span class="k">implicit none</span>
<span class="k">      </span><span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">nspin</span><span class="p">,</span> <span class="n">norb</span><span class="p">,</span> <span class="n">iaorb</span><span class="p">(</span><span class="n">norb</span><span class="p">),</span> <span class="n">iphorb</span><span class="p">(</span><span class="n">norb</span><span class="p">),</span>
     <span class="p">&amp;</span>                           <span class="n">nuo</span><span class="p">,</span> <span class="n">nuotot</span><span class="p">,</span> <span class="n">nua</span><span class="p">,</span> <span class="n">na</span><span class="p">,</span> <span class="n">isa</span><span class="p">(</span><span class="n">na</span><span class="p">),</span>
     <span class="p">&amp;</span>                           <span class="n">indxua</span><span class="p">(</span><span class="n">na</span><span class="p">),</span> <span class="n">mscell</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">maxnd</span><span class="p">,</span>
     <span class="p">&amp;</span>                           <span class="n">numd</span><span class="p">(</span><span class="n">nuo</span><span class="p">),</span> <span class="n">listdptr</span><span class="p">(</span><span class="n">nuo</span><span class="p">),</span> <span class="n">listd</span><span class="p">(</span><span class="n">maxnd</span><span class="p">)</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">xa</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">na</span><span class="p">),</span> <span class="n">ucell</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">datm</span><span class="p">(</span><span class="n">norb</span><span class="p">)</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">g2max</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ntm</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Fal</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">nua</span><span class="p">),</span> <span class="n">stressl</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>

      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">parameter</span>     <span class="kd">::</span> <span class="nb">tiny</span>  <span class="o">=</span> <span class="mf">1.e-12_dp</span>
      <span class="kt">integer</span>                 <span class="kd">::</span> <span class="n">io</span><span class="p">,</span> <span class="n">ia</span><span class="p">,</span> <span class="n">iphi</span><span class="p">,</span> <span class="k">is</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span>
      <span class="kt">integer</span>                 <span class="kd">::</span> <span class="n">nsc</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">nbcell</span><span class="p">,</span> <span class="n">nsd</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">DStres</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">volume</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">external</span>      <span class="kd">::</span> <span class="n">volcel</span><span class="p">,</span> <span class="n">ddot</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">grid_p</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">dummy_Drho</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">dummy_Vaux</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
     <span class="p">&amp;</span>                           <span class="n">dummy_Vscf</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
      <span class="kt">logical</span><span class="p">,</span> <span class="k">save</span>           <span class="kd">::</span> <span class="n">frstme</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>   <span class="c">! Keeps state</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">grid_p</span><span class="p">),</span>   <span class="k">pointer</span> <span class="kd">::</span> <span class="n">Vscf</span><span class="p">(:,:),</span> <span class="n">rhoatm_par</span><span class="p">(:)</span>
      <span class="kt">integer</span><span class="p">,</span>        <span class="k">pointer</span> <span class="kd">::</span> <span class="n">numphi</span><span class="p">(:),</span> <span class="n">numphi_par</span><span class="p">(:)</span>

      <span class="kt">integer</span>                 <span class="kd">::</span> <span class="n">nm</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>   <span class="c">! For call to initMesh</span>
<span class="cp">#ifndef BSC_CELLXC</span>
      <span class="kt">integer</span>                 <span class="kd">::</span> <span class="n">nXCfunc</span>
      <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">XCauth</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">XCfunc</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="cp">#endif /* ! BSC_CELLXC */</span>
      <span class="c">! Transport direction (unit-cell aligned)</span>
      <span class="kt">integer</span>                 <span class="kd">::</span> <span class="n">iE</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">ortho</span><span class="p">,</span> <span class="n">field</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">field2</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="c">!--------------------------------------------------------------------- BEGIN</span>
<span class="cp">#ifdef DEBUG</span>
      <span class="k">call </span><span class="n">write_debug</span><span class="p">(</span> <span class="s1">&#39;    PRE dhscf_init&#39;</span> <span class="p">)</span>
<span class="cp">#endif</span>
<span class="c">! ----------------------------------------------------------------------</span>
<span class="c">!     General initialisation</span>
<span class="c">! ----------------------------------------------------------------------</span>
<span class="c">!     Start time counter</span>
      <span class="k">call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;DHSCF_Init&#39;</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span>

      <span class="n">nsd</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">nspin</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
      <span class="k">nullify</span><span class="p">(</span><span class="n">Vscf</span><span class="p">,</span><span class="n">rhoatm_par</span><span class="p">)</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">frstme</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        </span><span class="n">debug_dhscf</span> <span class="o">=</span> <span class="n">fdf_get</span><span class="p">(</span><span class="s1">&#39;Debug.DHSCF&#39;</span><span class="p">,</span> <span class="p">.</span><span class="n">false</span><span class="p">.)</span>

        <span class="k">nullify</span><span class="p">(</span> <span class="n">xdsp</span><span class="p">,</span> <span class="n">rhopcc</span><span class="p">,</span> <span class="n">Vna</span><span class="p">,</span> <span class="n">rhoatm</span> <span class="p">)</span>
<span class="c">!       nsm lives in module m_dhscf now    !! AG**</span>
        <span class="n">nsm</span> <span class="o">=</span> <span class="n">fdf_integer</span><span class="p">(</span> <span class="s1">&#39;MeshSubDivisions&#39;</span><span class="p">,</span> <span class="mi">2</span> <span class="p">)</span>
        <span class="n">nsm</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span> <span class="n">nsm</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span>

<span class="c">!       Set mesh sub-division variables &amp; perform one off allocation</span>
        <span class="n">nsp</span> <span class="o">=</span> <span class="n">nsm</span><span class="o">*</span><span class="n">nsm</span><span class="o">*</span><span class="n">nsm</span>
        <span class="k">call </span><span class="n">re_alloc</span><span class="p">(</span> <span class="n">xdsp</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nsp</span><span class="p">,</span> <span class="s1">&#39;xdsp&#39;</span><span class="p">,</span> <span class="s1">&#39;dhscf_init&#39;</span> <span class="p">)</span>

<span class="c">!       Check spin-spiral wavevector (if defined)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">spiral</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">nspin</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mi">4</span><span class="p">)</span>
     <span class="p">&amp;</span>    <span class="k">call </span><span class="n">die</span><span class="p">(</span><span class="s1">&#39;dhscf: ERROR: spiral defined but nspin &lt; 4&#39;</span><span class="p">)</span>
      <span class="n">endif</span>   <span class="c">! First time</span>

<span class="cp">#ifndef BSC_CELLXC</span>
<span class="c">! Get functional(s) being used</span>
      <span class="k">call </span><span class="n">getXC</span><span class="p">(</span> <span class="n">nXCfunc</span><span class="p">,</span> <span class="n">XCfunc</span><span class="p">,</span> <span class="n">XCauth</span> <span class="p">)</span>
<span class="cp">#endif /* ! BSC_CELLXC */</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">harrisfun</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        do </span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nXCfunc</span>
          <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.(</span><span class="n">leqi</span><span class="p">(</span><span class="n">XCauth</span><span class="p">(</span><span class="n">n</span><span class="p">),</span><span class="s1">&#39;PZ&#39;</span><span class="p">).</span><span class="nb">or</span><span class="p">.</span><span class="n">leqi</span><span class="p">(</span><span class="n">XCauth</span><span class="p">(</span><span class="n">n</span><span class="p">),</span><span class="s1">&#39;CA&#39;</span><span class="p">)))</span> <span class="k">then</span>
<span class="k">            call </span><span class="n">die</span><span class="p">(</span><span class="s2">&quot;** Harris forces not implemented for non-LDA XC&quot;</span><span class="p">)</span>
          <span class="n">endif</span>
        <span class="n">enddo</span>
      <span class="n">endif</span>

<span class="c">! ----------------------------------------------------------------------</span>
<span class="c">!     Orbital initialisation : part 1</span>
<span class="c">! ----------------------------------------------------------------------</span>

<span class="c">!     Find the maximum orbital radius</span>
      <span class="n">rmax</span> <span class="o">=</span> <span class="mf">0.0_dp</span>
      <span class="k">do </span><span class="n">io</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">norb</span>
        <span class="n">ia</span>   <span class="o">=</span> <span class="n">iaorb</span><span class="p">(</span><span class="n">io</span><span class="p">)</span>    <span class="c">! Atomic index of each orbital</span>
        <span class="n">iphi</span> <span class="o">=</span> <span class="n">iphorb</span><span class="p">(</span><span class="n">io</span><span class="p">)</span>   <span class="c">! Orbital index of each  orbital in its atom</span>
        <span class="k">is</span>   <span class="o">=</span> <span class="n">isa</span><span class="p">(</span><span class="n">ia</span><span class="p">)</span>      <span class="c">! Species index of each atom</span>
        <span class="n">rmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span> <span class="n">rmax</span><span class="p">,</span> <span class="n">rcut</span><span class="p">(</span><span class="k">is</span><span class="p">,</span><span class="n">iphi</span><span class="p">)</span> <span class="p">)</span>
      <span class="n">enddo</span>

<span class="c">!     Start time counter for mesh initialization</span>
      <span class="k">call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;DHSCF1&#39;</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span>

<span class="c">! ----------------------------------------------------------------------</span>
<span class="c">!     Unit cell handling</span>
<span class="c">! ----------------------------------------------------------------------</span>
<span class="c">!     Find diagonal unit cell and supercell</span>
      <span class="k">call </span><span class="n">digcel</span><span class="p">(</span> <span class="n">ucell</span><span class="p">,</span> <span class="n">mscell</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">scell</span><span class="p">,</span> <span class="n">nsc</span><span class="p">,</span> <span class="n">IsDiag</span> <span class="p">)</span>
      <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">IsDiag</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        if</span> <span class="p">(</span><span class="n">Node</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,a,3(/,a,3f12.6,a,i6))&#39;</span><span class="p">)</span>
     <span class="p">&amp;</span>      <span class="s1">&#39;DHSCF: WARNING: New shape of unit cell and supercell:&#39;</span><span class="p">,</span>
     <span class="p">&amp;</span>      <span class="p">(</span><span class="s1">&#39;DHSCF:&#39;</span><span class="p">,(</span><span class="n">cell</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">),</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;   x&#39;</span><span class="p">,</span><span class="n">nsc</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">endif</span>
      <span class="n">endif</span>

<span class="c">!     Find the system shape</span>
      <span class="k">call </span><span class="n">shaper</span><span class="p">(</span> <span class="n">cell</span><span class="p">,</span> <span class="n">nua</span><span class="p">,</span> <span class="n">isa</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="nb">shape</span><span class="p">,</span> <span class="n">nbcell</span><span class="p">,</span> <span class="n">bcell</span> <span class="p">)</span>

<span class="c">!     Find system volume</span>
      <span class="n">volume</span> <span class="o">=</span> <span class="n">volcel</span><span class="p">(</span> <span class="n">cell</span> <span class="p">)</span>

<span class="c">! ----------------------------------------------------------------------</span>
<span class="c">!     Mesh initialization </span>
<span class="c">! ----------------------------------------------------------------------</span>
      <span class="k">call </span><span class="n">InitMesh</span><span class="p">(</span> <span class="n">na</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">norb</span><span class="p">,</span> <span class="n">iaorb</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span> <span class="n">isa</span><span class="p">,</span> <span class="n">rmax</span><span class="p">,</span> 
     <span class="p">&amp;</span>               <span class="n">G2max</span><span class="p">,</span> <span class="n">G2mesh</span><span class="p">,</span> <span class="n">nsc</span><span class="p">,</span> <span class="n">nmpl</span><span class="p">,</span> <span class="n">nm</span><span class="p">,</span>
     <span class="p">&amp;</span>               <span class="n">nml</span><span class="p">,</span> <span class="n">ntm</span><span class="p">,</span> <span class="n">ntml</span><span class="p">,</span> <span class="n">ntpl</span><span class="p">,</span> <span class="n">dvol</span> <span class="p">)</span>

<span class="c">!     Setup box descriptors for each processor,</span>
<span class="c">!     held in module iogrid_netcdf</span>
      <span class="k">call </span><span class="n">set_box_limits</span><span class="p">(</span> <span class="n">ntm</span><span class="p">,</span> <span class="n">nsm</span> <span class="p">)</span>

      <span class="c">! Initialize information on local mesh for each node</span>
      <span class="k">call </span><span class="n">init_mesh_node</span><span class="p">(</span> <span class="n">cell</span><span class="p">,</span> <span class="n">ntm</span> <span class="p">,</span> <span class="n">meshLim</span> <span class="p">,</span> <span class="n">nsm</span> <span class="p">)</span>

      <span class="c">! Setup charge additions in the mesh</span>
      <span class="k">call </span><span class="n">init_charge_add</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">ntm</span><span class="p">)</span>

      <span class="c">! Setup Hartree additions in the mesh</span>
      <span class="k">call </span><span class="n">init_hartree_add</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">ntm</span><span class="p">)</span>

<span class="cp">#ifdef NCDF_4</span>
      <span class="c">! Initialize the box for each node...</span>
      <span class="k">call </span><span class="n">cdf_init_mesh</span><span class="p">(</span> <span class="n">ntm</span><span class="p">,</span> <span class="n">nsm</span> <span class="p">)</span>
<span class="cp">#endif</span>

<span class="c">!     Stop time counter for mesh initialization</span>
      <span class="k">call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;DHSCF1&#39;</span><span class="p">,</span> <span class="mi">2</span> <span class="p">)</span>
<span class="c">! ----------------------------------------------------------------------</span>
<span class="c">!     End of mesh initialization </span>
<span class="c">! ----------------------------------------------------------------------</span>

<span class="c">! ----------------------------------------------------------------------</span>
<span class="c">!     Initialize atomic orbitals, density and potential</span>
<span class="c">! ----------------------------------------------------------------------</span>
<span class="c">!     Start time counter for atomic initializations</span>
      <span class="k">call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;DHSCF2&#39;</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">nodes</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">setMeshDistr</span><span class="p">(</span> <span class="n">UNIFORM</span><span class="p">,</span> <span class="n">nsm</span><span class="p">,</span> <span class="n">nsp</span><span class="p">,</span>
     <span class="p">&amp;</span>                     <span class="n">nml</span><span class="p">,</span> <span class="n">nmpl</span><span class="p">,</span> <span class="n">ntml</span><span class="p">,</span> <span class="n">ntpl</span> <span class="p">)</span>
      <span class="n">endif</span>

<span class="c">!     Initialise quantities relating to the atom-mesh positioning</span>
      <span class="k">call </span><span class="n">InitAtomMesh</span><span class="p">(</span> <span class="n">UNIFORM</span><span class="p">,</span> <span class="n">na</span><span class="p">,</span> <span class="n">xa</span> <span class="p">)</span>

<span class="cp">#ifdef BSC_CELLXC</span>
<span class="c">!     Check if we need extencils in cellxc</span>
      <span class="k">call </span><span class="n">setGGA</span><span class="p">(</span> <span class="p">)</span>

<span class="cp">#endif /* BSC_CELLXC */</span>
<span class="c">!     Compute the number of orbitals on the mesh and recompute the</span>
<span class="c">!     partions for every processor in order to have a similar load</span>
<span class="c">!     in each of them.</span>
      <span class="k">nullify</span><span class="p">(</span> <span class="n">numphi</span> <span class="p">)</span>
      <span class="k">call </span><span class="n">re_alloc</span><span class="p">(</span> <span class="n">numphi</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nmpl</span><span class="p">,</span> <span class="s1">&#39;numphi&#39;</span><span class="p">,</span> <span class="s1">&#39;dhscf_init&#39;</span> <span class="p">)</span>
<span class="c">!$OMP parallel do default(shared), private(i)</span>
      <span class="k">do </span><span class="n">i</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nmpl</span>
        <span class="n">numphi</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="n">enddo</span>
<span class="c">!$OMP end parallel do</span>

      <span class="k">call </span><span class="n">distriPhiOnMesh</span><span class="p">(</span> <span class="n">nm</span><span class="p">,</span> <span class="n">nmpl</span><span class="p">,</span> <span class="n">norb</span><span class="p">,</span> <span class="n">iaorb</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span>
     <span class="p">&amp;</span>                      <span class="n">isa</span><span class="p">,</span> <span class="n">numphi</span> <span class="p">)</span>

<span class="c">!     Find if there are partial-core-corrections for any atom</span>
      <span class="n">npcc</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="k">do </span><span class="n">ia</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">na</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">rcore</span><span class="p">(</span><span class="n">isa</span><span class="p">(</span><span class="n">ia</span><span class="p">))</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="nb">tiny</span><span class="p">)</span> <span class="n">npcc</span> <span class="o">=</span> <span class="mi">1</span>
      <span class="n">enddo</span>

<span class="c">!     Find partial-core-correction energy density</span>
<span class="c">!     Vscf and Vaux are not used here</span>
      <span class="k">call </span><span class="n">re_alloc</span><span class="p">(</span> <span class="n">rhopcc</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ntpl</span><span class="o">*</span><span class="n">npcc</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;rhopcc&#39;</span><span class="p">,</span> <span class="s1">&#39;dhscf_init&#39;</span> <span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">npcc</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">PartialCoreOnMesh</span><span class="p">(</span> <span class="n">na</span><span class="p">,</span> <span class="n">isa</span><span class="p">,</span> <span class="n">ntpl</span><span class="p">,</span> <span class="n">rhopcc</span><span class="p">,</span> <span class="n">indxua</span><span class="p">,</span>
     <span class="p">&amp;</span>    <span class="n">nsd</span><span class="p">,</span> <span class="n">dvol</span><span class="p">,</span> <span class="n">volume</span><span class="p">,</span> <span class="n">dummy_Vscf</span><span class="p">,</span> <span class="n">dummy_Vaux</span><span class="p">,</span> <span class="n">Fal</span><span class="p">,</span> <span class="n">stressl</span><span class="p">,</span>
     <span class="p">&amp;</span>    <span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="p">)</span>
        <span class="k">call </span><span class="n">reord</span><span class="p">(</span> <span class="n">rhopcc</span><span class="p">,</span> <span class="n">rhopcc</span><span class="p">,</span> <span class="n">nml</span><span class="p">,</span> <span class="n">nsm</span><span class="p">,</span> <span class="n">TO_SEQUENTIAL</span> <span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">debug_dhscf</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">           write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="n">debug_fmt</span><span class="p">)</span> <span class="n">Node</span><span class="p">,</span><span class="s1">&#39;rhopcc&#39;</span><span class="p">,</span><span class="nb">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">rhopcc</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
        <span class="k">end if</span>
<span class="k">      </span><span class="n">endif</span>

<span class="c">!     Find neutral-atom potential</span>
<span class="c">!     Drho is not used here</span>
      <span class="k">call </span><span class="n">re_alloc</span><span class="p">(</span> <span class="n">Vna</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ntpl</span><span class="p">,</span> <span class="s1">&#39;Vna&#39;</span><span class="p">,</span> <span class="s1">&#39;dhscf_init&#39;</span> <span class="p">)</span>
      <span class="k">call </span><span class="n">NeutralAtomOnMesh</span><span class="p">(</span> <span class="n">na</span><span class="p">,</span> <span class="n">isa</span><span class="p">,</span> <span class="n">ntpl</span><span class="p">,</span> <span class="n">Vna</span><span class="p">,</span> <span class="n">indxua</span><span class="p">,</span> <span class="n">dvol</span><span class="p">,</span> 
     <span class="p">&amp;</span>                        <span class="n">volume</span><span class="p">,</span> <span class="n">dummy_DRho</span><span class="p">,</span> <span class="n">Fal</span><span class="p">,</span> <span class="n">stressl</span><span class="p">,</span> 
     <span class="p">&amp;</span>                        <span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="p">)</span>
      <span class="k">call </span><span class="n">reord</span><span class="p">(</span> <span class="n">Vna</span><span class="p">,</span> <span class="n">Vna</span><span class="p">,</span> <span class="n">nml</span><span class="p">,</span> <span class="n">nsm</span><span class="p">,</span> <span class="n">TO_SEQUENTIAL</span> <span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">debug_dhscf</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">         write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="n">debug_fmt</span><span class="p">)</span> <span class="n">Node</span><span class="p">,</span><span class="s1">&#39;Vna&#39;</span><span class="p">,</span><span class="nb">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">Vna</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
      <span class="k">end if</span>

<span class="k">      if</span> <span class="p">(</span><span class="n">nodes</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        if</span> <span class="p">(</span><span class="n">node</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">           write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s2">&quot;(a)&quot;</span><span class="p">)</span> <span class="s2">&quot;Setting up quadratic distribution...&quot;</span>
        <span class="n">endif</span>
        <span class="k">call </span><span class="n">setMeshDistr</span><span class="p">(</span> <span class="n">QUADRATIC</span><span class="p">,</span> <span class="n">nsm</span><span class="p">,</span> <span class="n">nsp</span><span class="p">,</span>
     <span class="p">&amp;</span>                     <span class="n">nml</span><span class="p">,</span> <span class="n">nmpl</span><span class="p">,</span> <span class="n">ntml</span><span class="p">,</span> <span class="n">ntpl</span> <span class="p">)</span>

<span class="c">!       Create extended mesh arrays for the second data distribution</span>
        <span class="k">call </span><span class="n">setupExtMesh</span><span class="p">(</span> <span class="n">QUADRATIC</span><span class="p">,</span> <span class="n">rmax</span> <span class="p">)</span>

<span class="c">!       Compute atom positions for the second data distribution </span>
        <span class="k">call </span><span class="n">InitAtomMesh</span><span class="p">(</span> <span class="n">QUADRATIC</span><span class="p">,</span> <span class="n">na</span><span class="p">,</span> <span class="n">xa</span> <span class="p">)</span>
      <span class="n">endif</span>

<span class="c">!     Calculate orbital values on mesh</span>
<span class="c">!     numphi has already been computed in distriPhiOnMesh</span>
<span class="c">!     in the UNIFORM distribution </span>
      <span class="k">if</span> <span class="p">(</span><span class="n">nodes</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        </span><span class="n">numphi_par</span> <span class="o">=&gt;</span> <span class="n">numphi</span>
      <span class="k">else</span>
<span class="k">        nullify</span><span class="p">(</span><span class="n">numphi_par</span><span class="p">)</span>
        <span class="k">call </span><span class="n">re_alloc</span><span class="p">(</span> <span class="n">numphi_par</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nmpl</span><span class="p">,</span> <span class="s1">&#39;numphi_par&#39;</span><span class="p">,</span>
     <span class="p">&amp;</span>                 <span class="s1">&#39;dhscf_init&#39;</span> <span class="p">)</span>
        <span class="k">call </span><span class="n">distMeshData</span><span class="p">(</span> <span class="n">UNIFORM</span><span class="p">,</span> <span class="n">numphi</span><span class="p">,</span> <span class="n">QUADRATIC</span><span class="p">,</span>
     <span class="p">&amp;</span>                     <span class="n">numphi_par</span><span class="p">,</span> <span class="n">KEEP</span> <span class="p">)</span>
      <span class="n">endif</span>

      <span class="k">call </span><span class="n">PhiOnMesh</span><span class="p">(</span> <span class="n">nmpl</span><span class="p">,</span> <span class="n">norb</span><span class="p">,</span> <span class="n">iaorb</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span> <span class="n">isa</span><span class="p">,</span> <span class="n">numphi_par</span> <span class="p">)</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">nodes</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">de_alloc</span><span class="p">(</span> <span class="n">numphi_par</span><span class="p">,</span> <span class="s1">&#39;numphi_par&#39;</span><span class="p">,</span> <span class="s1">&#39;dhscf_init&#39;</span> <span class="p">)</span>
      <span class="n">endif</span>
      <span class="k">call </span><span class="n">de_alloc</span><span class="p">(</span> <span class="n">numphi</span><span class="p">,</span> <span class="s1">&#39;numphi&#39;</span><span class="p">,</span> <span class="s1">&#39;dhscf_init&#39;</span> <span class="p">)</span>

<span class="c">! ----------------------------------------------------------------------</span>
<span class="c">!       Create sparse indexing for Dscf as needed for local mesh</span>
<span class="c">!       Note that this is done in the QUADRATIC distribution</span>
<span class="c">!       since &#39;endpht&#39; (computed finally in PhiOnMesh and stored in</span>
<span class="c">!       meshphi module) is in that distribution.</span>
<span class="c">! ----------------------------------------------------------------------</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">Nodes</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">CreateLocalDscfPointers</span><span class="p">(</span> <span class="n">nmpl</span><span class="p">,</span> <span class="n">nuotot</span><span class="p">,</span> <span class="n">numd</span><span class="p">,</span> <span class="n">listdptr</span><span class="p">,</span> 
     <span class="p">&amp;</span>                                <span class="n">listd</span> <span class="p">)</span>
      <span class="n">endif</span>

<span class="c">! ----------------------------------------------------------------------</span>
<span class="c">!     Calculate terms relating to the neutral atoms on the mesh</span>
<span class="c">! ----------------------------------------------------------------------</span>
<span class="c">!     Find Harris (sum of atomic) electron density</span>
      <span class="k">call </span><span class="n">re_alloc</span><span class="p">(</span> <span class="n">rhoatm_par</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ntpl</span><span class="p">,</span> <span class="s1">&#39;rhoatm_par&#39;</span><span class="p">,</span> <span class="s1">&#39;dhscf_init&#39;</span> <span class="p">)</span>
      <span class="k">call </span><span class="n">rhooda</span><span class="p">(</span> <span class="n">norb</span><span class="p">,</span> <span class="n">nmpl</span><span class="p">,</span> <span class="n">datm</span><span class="p">,</span> <span class="n">rhoatm_par</span><span class="p">,</span> <span class="n">iaorb</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span> <span class="n">isa</span> <span class="p">)</span>
<span class="c">!     rhoatm_par comes out of here in clustered form in QUADRATIC dist</span>

<span class="c">!     Routine Poison should use the uniform data distribution</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">nodes</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">setMeshDistr</span><span class="p">(</span> <span class="n">UNIFORM</span><span class="p">,</span> <span class="n">nsm</span><span class="p">,</span> <span class="n">nsp</span><span class="p">,</span>
     <span class="p">&amp;</span>                      <span class="n">nml</span><span class="p">,</span> <span class="n">nmpl</span><span class="p">,</span> <span class="n">ntml</span><span class="p">,</span> <span class="n">ntpl</span> <span class="p">)</span>
      <span class="n">endif</span>

<span class="c">!     Create Rhoatm using UNIFORM distr, in sequential form</span>
      <span class="k">call </span><span class="n">re_alloc</span><span class="p">(</span> <span class="n">rhoatm</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ntpl</span><span class="p">,</span> <span class="s1">&#39;rhoatm&#39;</span><span class="p">,</span> <span class="s1">&#39;dhscf_init&#39;</span> <span class="p">)</span>
      <span class="k">call </span><span class="n">distMeshData</span><span class="p">(</span> <span class="n">QUADRATIC</span><span class="p">,</span> <span class="n">rhoatm_par</span><span class="p">,</span>
     <span class="p">&amp;</span>     <span class="n">UNIFORM</span><span class="p">,</span> <span class="n">rhoatm</span><span class="p">,</span> <span class="n">TO_SEQUENTIAL</span> <span class="p">)</span>

      <span class="k">if</span> <span class="p">(</span> <span class="n">debug_dhscf</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">         write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="n">debug_fmt</span><span class="p">)</span> <span class="n">Node</span><span class="p">,</span><span class="s1">&#39;rhoatm&#39;</span><span class="p">,</span> <span class="nb">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">rhoatm</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
      <span class="k">end if</span>

<span class="c">!</span>
<span class="c">!  AG: The initialization of doping structs could be done here now,</span>
<span class="c">!      in the uniform distribution, and with a simple loop over</span>
<span class="c">!      rhoatm.</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">frstme</span><span class="p">)</span> <span class="k">call </span><span class="n">initialize_doping_uniform</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">doping_active</span><span class="p">)</span> <span class="k">then  </span>
<span class="k">           call </span><span class="n">compute_doping_structs_uniform</span><span class="p">(</span><span class="n">ntpl</span><span class="p">,</span><span class="n">rhoatm</span><span class="p">,</span><span class="n">nsd</span><span class="p">)</span>
           <span class="c">! Will get the global number of hit points</span>
           <span class="c">! Then, the doping density to be added can be simply computed</span>
        <span class="n">endif</span>

<span class="c">!     Allocate Temporal array</span>
      <span class="k">call </span><span class="n">re_alloc</span><span class="p">(</span> <span class="n">Vscf</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ntpl</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nspin</span><span class="p">,</span> <span class="s1">&#39;Vscf&#39;</span><span class="p">,</span> <span class="s1">&#39;dhscf_init&#39;</span> <span class="p">)</span>

<span class="c">!     Vscf is filled here but not used later</span>
<span class="c">!     Uharrs is computed (and saved)</span>
<span class="c">!     DStres is computed but not used later</span>
      <span class="k">call </span><span class="n">poison</span><span class="p">(</span> <span class="n">cell</span><span class="p">,</span> <span class="n">ntml</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">ntml</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">ntml</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">ntm</span><span class="p">,</span> <span class="n">rhoatm</span><span class="p">,</span>
     <span class="p">&amp;</span>             <span class="n">Uharrs</span><span class="p">,</span> <span class="n">Vscf</span><span class="p">,</span> <span class="n">DStres</span><span class="p">,</span> <span class="n">nsm</span> <span class="p">)</span>
      <span class="k">call </span><span class="n">de_alloc</span><span class="p">(</span> <span class="n">Vscf</span><span class="p">,</span> <span class="s1">&#39;Vscf&#39;</span><span class="p">,</span> <span class="s1">&#39;dhscf_init&#39;</span> <span class="p">)</span>

<span class="c">!     Always deallocate rhoatm_par, as it was used even if nodes=1</span>
      <span class="k">call </span><span class="n">de_alloc</span><span class="p">(</span> <span class="n">rhoatm_par</span><span class="p">,</span> <span class="s1">&#39;rhoatm_par&#39;</span><span class="p">,</span> <span class="s1">&#39;dhscf_init&#39;</span> <span class="p">)</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">mix_charge</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">re_alloc</span><span class="p">(</span> <span class="n">rhog</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ntpl</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nspin</span><span class="p">,</span>
     <span class="err">$</span>                 <span class="s1">&#39;Rhog&#39;</span><span class="p">,</span> <span class="s1">&#39;dhscf_init&#39;</span> <span class="p">)</span>
         <span class="k">call </span><span class="n">re_alloc</span><span class="p">(</span> <span class="n">rhog_in</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ntpl</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nspin</span><span class="p">,</span>
     <span class="err">$</span>                 <span class="s1">&#39;Rhog_in&#39;</span><span class="p">,</span> <span class="s1">&#39;dhscf_init&#39;</span> <span class="p">)</span>
         <span class="k">call </span><span class="n">order_rhog</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">ntml</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">ntml</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">ntml</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">ntm</span><span class="p">,</span> <span class="n">nsm</span><span class="p">)</span>
      <span class="n">endif</span>

<span class="c">!     Stop time counter for atomic initializations</span>
      <span class="k">call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;DHSCF2&#39;</span><span class="p">,</span> <span class="mi">2</span> <span class="p">)</span>

<span class="c">! ----------------------------------------------------------------------</span>
<span class="c">!     At the end of initializations:</span>
<span class="c">!     We are in the UNIFORM distribution</span>
<span class="c">!     Rhoatm, Rhopcc and Vna are in UNIFORM dist, sequential form</span>
<span class="c">!     The index array endpht is in the QUADRATIC distribution</span>
<span class="c">! ----------------------------------------------------------------------</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">frstme</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">initialize_efield</span><span class="p">()</span>
      <span class="k">end if</span>

      <span class="c">! Check if we need to add the potential </span>
      <span class="c">! corresponding to the voltage-drop.</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">TSmode</span> <span class="p">)</span> <span class="k">then</span>
        <span class="c">! These routines are important if there are cell-changes</span>
        <span class="k">call </span><span class="n">ts_init_hartree_fix</span><span class="p">(</span> <span class="n">cell</span><span class="p">,</span> <span class="n">nua</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">ntm</span><span class="p">,</span> <span class="n">ntml</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">IsVolt</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">           call </span><span class="n">ts_init_voltage</span><span class="p">(</span> <span class="n">cell</span><span class="p">,</span> <span class="n">nua</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">ntm</span><span class="p">)</span>
        <span class="k">end if</span>

<span class="k">        if</span> <span class="p">(</span> <span class="n">acting_efield</span> <span class="p">)</span> <span class="k">then</span>
         <span class="c">! We do not allow the electric field for </span>
         <span class="c">! transiesta runs with V = 0, either.</span>
         <span class="c">! It does not make sense, only for fields perpendicular</span>
         <span class="c">! to the applied bias.</span>
           
         <span class="c">! We need to check that the e-field is perpendicular</span>
         <span class="c">! to the transport direction, and that the system is</span>
         <span class="c">! either a chain, or a slab.</span>
         <span class="c">! However, due to the allowance of a dipole correction</span>
         <span class="c">! along the transport direction for buffer calculations</span>
         <span class="c">! we have to allow all shapes. (atom is not transiesta</span>
         <span class="c">! compatible anyway)</span>
            
         <span class="c">! check that we do not violate the periodicity</span>
         <span class="k">if</span> <span class="p">(</span> <span class="n">Node</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(/,2(2a,/))&#39;</span><span class="p">)</span> <span class="s1">&#39;ts-WARNING: &#39;</span><span class="p">,</span>
     <span class="p">&amp;</span>           <span class="s1">&#39;E-field/dipole-correction! &#39;</span><span class="p">,</span>
     <span class="p">&amp;</span>           <span class="s1">&#39;ts-WARNING: &#39;</span><span class="p">,</span>
     <span class="p">&amp;</span>           <span class="s1">&#39;I hope you know what you are doing!&#39;</span>
         <span class="k">end if</span>

         <span class="c">! This is either dipole or user, or both</span>
         <span class="n">field</span><span class="p">(:)</span> <span class="o">=</span> <span class="n">user_specified_field</span><span class="p">(:)</span>
         <span class="k">do </span><span class="n">iE</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">N_Elec</span>
            <span class="n">field2</span> <span class="o">=</span> <span class="n">Elecs</span><span class="p">(</span><span class="n">iE</span><span class="p">)%</span><span class="n">cell</span><span class="p">(:,</span><span class="n">Elecs</span><span class="p">(</span><span class="n">iE</span><span class="p">)%</span><span class="n">t_dir</span><span class="p">)</span>
            <span class="n">ortho</span> <span class="o">=</span> <span class="n">ddot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">field2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">field</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ortho</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.e-9_dp</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">               call </span><span class="n">die</span><span class="p">(</span><span class="s1">&#39;User defined E-field must be</span>
<span class="s1">     &amp;perpendicular to semi-infinite directions&#39;</span><span class="p">)</span>
            <span class="k">end if</span>
<span class="k">         end do</span>
<span class="k">        end if</span> <span class="c">! acting_efield</span>
         
        <span class="c">! We know that we currently allow people to do more than</span>
        <span class="c">! they probably should be allowed. However, there are many</span>
        <span class="c">! corner cases that may require dipole corrections, or </span>
        <span class="c">! electric fields to &quot;correct&quot; an intrinsic dipole.</span>
        <span class="c">! For instance, what should we do with a dipole in a transiesta</span>
        <span class="c">! calculation?</span>
        <span class="c">! Should we apply a field to counter act it in a device</span>
        <span class="c">! calculation?</span>
         
      <span class="k">end if</span>

<span class="k">      </span><span class="n">frstme</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>

      <span class="k">call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;DHSCF_Init&#39;</span><span class="p">,</span> <span class="mi">2</span> <span class="p">)</span>
<span class="cp">#ifdef DEBUG</span>
      <span class="k">call </span><span class="n">write_debug</span><span class="p">(</span> <span class="s1">&#39;    POS dhscf_init&#39;</span> <span class="p">)</span>
<span class="cp">#endif</span>
<span class="c">!------------------------------------------------------------------------- END</span>
      <span class="k">end subroutine </span><span class="n">dhscf_init</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2018 <a rel="license" href="http://www.gnu.org/licenses/old-licenses/fdl-1.2.en.html">GNU Free Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> SIESTA was developed by SIESTA Group</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>