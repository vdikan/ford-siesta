<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="A first-principles materials simulation code using Density Functional Theory.">
    
    <meta name="author" content="SIESTA Group" >
    <link rel="icon" href="../favicon.png">

    <title>setup_H0 &ndash; SIESTA</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">SIESTA <small>trunk-700--vdikan-edens-708-ford-681</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>Program Overview</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>setup_H0
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 1.4% of total for procedures.">87 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/setup_H0.F"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/setup_h0.f.html'>setup_H0.F</a></li>
    
     <li><a href='../module/m_setup_h0.html'>m_setup_H0</a></li>
    
  
     <li class="active">setup_H0</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/setup_h0.html#src">setup_H0</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine setup_H0(g2max)
    
    
   
</h2>
    
  
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
      
      <li class="list-group-item">
  <ul class="list-inline">
    
    <li>siesta_options</li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>m_nlefsm</li>
    
    <li>m_spin</li>
    
    <li>sparse_matrices</li>
    
    <li>siesta_geom</li>
    
    <li>atmfuncs</li>
    
    <li>atomlist</li>
    
    <li>metaforce</li>
    
    <li>molecularmechanics</li>
    
    <li>m_nlefsm</li>
    
    <li>m_kinefsm</li>
    
    <li>m_naefs</li>
    
    <li>m_dnaefs</li>
    
    <li><a href='../module/m_dhscf.html'>m_dhscf</a></li>
    
    <li>m_energies</li>
    
    <li>m_ntm</li>
    
    <li>m_spin</li>
    
    <li>spinorbit</li>
    
    <li>alloc</li>
    
    <li>class_dSpData1D</li>
    
    <li>class_dSpData2D</li>
    
    <li>class_zSpData2D</li>
    
    <li>m_mpi_utils</li>
    
  </ul>
      </li>
      
      
      
      <li class="list-group-item">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~setup_h0~~UsesGraph Pages: 1 -->
<svg id="procsetup_h0UsesGraph" width="303pt" height="872pt"
 viewBox="0.00 0.00 303.00 872.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~setup_h0~~UsesGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 868)">
<title>proc~~setup_h0~~UsesGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-868 299,-868 299,4 -4,4"/>
<!-- proc~setup_h0 -->
<g id="proc~~setup_h0~~UsesGraph_node1" class="node"><title>proc~setup_h0</title>
<polygon fill="none" stroke="black" points="295,-444 237,-444 237,-420 295,-420 295,-444"/>
<text text-anchor="middle" x="266" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50">setup_H0</text>
</g>
<!-- siesta_options -->
<g id="proc~~setup_h0~~UsesGraph_node2" class="node"><title>siesta_options</title>
<polygon fill="#337ab7" stroke="#337ab7" points="186.5,-864 105.5,-864 105.5,-840 186.5,-840 186.5,-864"/>
<text text-anchor="middle" x="146" y="-849.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_options</text>
</g>
<!-- proc~setup_h0&#45;&gt;siesta_options -->
<g id="proc~~setup_h0~~UsesGraph_edge1" class="edge"><title>proc~setup_h0&#45;&gt;siesta_options</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M264.635,-444.212C262.606,-504.414 250.926,-769.194 201,-831 199.313,-833.088 197.391,-834.969 195.301,-836.664"/>
<polygon fill="#000000" stroke="#000000" points="193.051,-833.95 186.552,-842.317 196.85,-839.83 193.051,-833.95"/>
</g>
<!-- class_dSpData1D -->
<g id="proc~~setup_h0~~UsesGraph_node3" class="node"><title>class_dSpData1D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="194.5,-822 97.5,-822 97.5,-798 194.5,-798 194.5,-822"/>
<text text-anchor="middle" x="146" y="-807.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_dSpData1D</text>
</g>
<!-- proc~setup_h0&#45;&gt;class_dSpData1D -->
<g id="proc~~setup_h0~~UsesGraph_edge2" class="edge"><title>proc~setup_h0&#45;&gt;class_dSpData1D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M264.392,-444.031C261.341,-499.98 246.017,-734.305 201,-789 200.281,-789.874 199.521,-790.711 198.724,-791.514"/>
<polygon fill="#000000" stroke="#000000" points="196.394,-788.895 190.718,-797.841 200.734,-794.387 196.394,-788.895"/>
</g>
<!-- m_naefs -->
<g id="proc~~setup_h0~~UsesGraph_node4" class="node"><title>m_naefs</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173,-780 119,-780 119,-756 173,-756 173,-780"/>
<text text-anchor="middle" x="146" y="-765.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_naefs</text>
</g>
<!-- proc~setup_h0&#45;&gt;m_naefs -->
<g id="proc~~setup_h0~~UsesGraph_edge3" class="edge"><title>proc~setup_h0&#45;&gt;m_naefs</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M264.054,-444.332C259.816,-496.622 241.003,-699.523 201,-747 196.187,-752.712 189.624,-756.877 182.73,-759.912"/>
<polygon fill="#000000" stroke="#000000" points="181.439,-756.657 173.258,-763.389 183.851,-763.228 181.439,-756.657"/>
</g>
<!-- m_nlefsm -->
<g id="proc~~setup_h0~~UsesGraph_node5" class="node"><title>m_nlefsm</title>
<polygon fill="#337ab7" stroke="#337ab7" points="175.5,-738 116.5,-738 116.5,-714 175.5,-714 175.5,-738"/>
<text text-anchor="middle" x="146" y="-723.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_nlefsm</text>
</g>
<!-- proc~setup_h0&#45;&gt;m_nlefsm -->
<g id="proc~~setup_h0~~UsesGraph_edge4" class="edge"><title>proc~setup_h0&#45;&gt;m_nlefsm</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M263.642,-444.279C258.141,-492.011 236.111,-664.569 201,-705 196.715,-709.934 191.127,-713.717 185.173,-716.614"/>
<polygon fill="#000000" stroke="#000000" points="183.602,-713.474 175.651,-720.477 186.233,-719.961 183.602,-713.474"/>
</g>
<!-- atmfuncs -->
<g id="proc~~setup_h0~~UsesGraph_node6" class="node"><title>atmfuncs</title>
<polygon fill="#337ab7" stroke="#337ab7" points="174,-696 118,-696 118,-672 174,-672 174,-696"/>
<text text-anchor="middle" x="146" y="-681.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">atmfuncs</text>
</g>
<!-- proc~setup_h0&#45;&gt;atmfuncs -->
<g id="proc~~setup_h0~~UsesGraph_edge5" class="edge"><title>proc~setup_h0&#45;&gt;atmfuncs</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M265.221,-444.061C265.253,-481.542 260.307,-597.404 201,-663 196.286,-668.214 190.123,-672.146 183.652,-675.107"/>
<polygon fill="#000000" stroke="#000000" points="182.161,-671.931 174.085,-678.788 184.674,-678.464 182.161,-671.931"/>
</g>
<!-- siesta_geom -->
<g id="proc~~setup_h0~~UsesGraph_node7" class="node"><title>siesta_geom</title>
<polygon fill="#337ab7" stroke="#337ab7" points="182.5,-654 109.5,-654 109.5,-630 182.5,-630 182.5,-654"/>
<text text-anchor="middle" x="146" y="-639.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_geom</text>
</g>
<!-- proc~setup_h0&#45;&gt;siesta_geom -->
<g id="proc~~setup_h0~~UsesGraph_edge6" class="edge"><title>proc~setup_h0&#45;&gt;siesta_geom</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M264.312,-444.427C261.82,-477.59 250.569,-569.18 201,-621 198.224,-623.902 195.001,-626.409 191.537,-628.575"/>
<polygon fill="#000000" stroke="#000000" points="189.784,-625.542 182.55,-633.283 193.032,-631.743 189.784,-625.542"/>
</g>
<!-- sparse_matrices -->
<g id="proc~~setup_h0~~UsesGraph_node8" class="node"><title>sparse_matrices</title>
<polygon fill="#337ab7" stroke="#337ab7" points="191.5,-612 100.5,-612 100.5,-588 191.5,-588 191.5,-612"/>
<text text-anchor="middle" x="146" y="-597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sparse_matrices</text>
</g>
<!-- proc~setup_h0&#45;&gt;sparse_matrices -->
<g id="proc~~setup_h0~~UsesGraph_edge8" class="edge"><title>proc~setup_h0&#45;&gt;sparse_matrices</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M262.993,-444.072C257.787,-471.721 241.339,-540.233 201,-579 199.753,-580.198 198.431,-581.33 197.048,-582.399"/>
<polygon fill="#000000" stroke="#000000" points="195.087,-579.499 188.58,-587.86 198.881,-585.381 195.087,-579.499"/>
</g>
<!-- m_kinefsm -->
<g id="proc~~setup_h0~~UsesGraph_node9" class="node"><title>m_kinefsm</title>
<polygon fill="#337ab7" stroke="#337ab7" points="178,-570 114,-570 114,-546 178,-546 178,-570"/>
<text text-anchor="middle" x="146" y="-555.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_kinefsm</text>
</g>
<!-- proc~setup_h0&#45;&gt;m_kinefsm -->
<g id="proc~~setup_h0~~UsesGraph_edge13" class="edge"><title>proc~setup_h0&#45;&gt;m_kinefsm</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M260.633,-444.146C252.289,-465.734 232.098,-510.958 201,-537 196.958,-540.384 192.309,-543.263 187.469,-545.702"/>
<polygon fill="#000000" stroke="#000000" points="185.773,-542.625 178.038,-549.865 188.6,-549.028 185.773,-542.625"/>
</g>
<!-- atomlist -->
<g id="proc~~setup_h0~~UsesGraph_node10" class="node"><title>atomlist</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173,-528 119,-528 119,-504 173,-504 173,-528"/>
<text text-anchor="middle" x="146" y="-513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">atomlist</text>
</g>
<!-- proc~setup_h0&#45;&gt;atomlist -->
<g id="proc~~setup_h0~~UsesGraph_edge10" class="edge"><title>proc~setup_h0&#45;&gt;atomlist</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M255.308,-444.172C243.682,-458.087 222.992,-480.773 201,-495 195.402,-498.621 189.083,-501.775 182.791,-504.461"/>
<polygon fill="#000000" stroke="#000000" points="181.061,-501.38 173.035,-508.296 183.622,-507.895 181.061,-501.38"/>
</g>
<!-- module~m_dhscf -->
<g id="proc~~setup_h0~~UsesGraph_node11" class="node"><title>module~m_dhscf</title>
<g id="a_proc~~setup_h0~~UsesGraph_node11"><a xlink:href=".././module/m_dhscf.html" xlink:title="m_dhscf">
<polygon fill="#337ab7" stroke="#337ab7" points="173,-486 119,-486 119,-462 173,-462 173,-486"/>
<text text-anchor="middle" x="146" y="-471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_dhscf</text>
</a>
</g>
</g>
<!-- proc~setup_h0&#45;&gt;module~m_dhscf -->
<g id="proc~~setup_h0~~UsesGraph_edge11" class="edge"><title>proc~setup_h0&#45;&gt;module~m_dhscf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M236.736,-442.06C220.549,-447.821 200.08,-455.107 182.78,-461.265"/>
<polygon fill="#000000" stroke="#000000" points="181.264,-458.089 173.017,-464.74 183.611,-464.684 181.264,-458.089"/>
</g>
<!-- m_dnaefs -->
<g id="proc~~setup_h0~~UsesGraph_node12" class="node"><title>m_dnaefs</title>
<polygon fill="#337ab7" stroke="#337ab7" points="176,-444 116,-444 116,-420 176,-420 176,-444"/>
<text text-anchor="middle" x="146" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_dnaefs</text>
</g>
<!-- proc~setup_h0&#45;&gt;m_dnaefs -->
<g id="proc~~setup_h0~~UsesGraph_edge12" class="edge"><title>proc~setup_h0&#45;&gt;m_dnaefs</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M236.736,-432C221.747,-432 203.085,-432 186.668,-432"/>
<polygon fill="#000000" stroke="#000000" points="186.266,-428.5 176.266,-432 186.266,-435.5 186.266,-428.5"/>
</g>
<!-- m_energies -->
<g id="proc~~setup_h0~~UsesGraph_node13" class="node"><title>m_energies</title>
<polygon fill="#337ab7" stroke="#337ab7" points="180.5,-402 111.5,-402 111.5,-378 180.5,-378 180.5,-402"/>
<text text-anchor="middle" x="146" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_energies</text>
</g>
<!-- proc~setup_h0&#45;&gt;m_energies -->
<g id="proc~~setup_h0~~UsesGraph_edge9" class="edge"><title>proc~setup_h0&#45;&gt;m_energies</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M236.736,-421.94C222.977,-417.043 206.124,-411.044 190.753,-405.573"/>
<polygon fill="#000000" stroke="#000000" points="191.509,-402.127 180.914,-402.071 189.161,-408.722 191.509,-402.127"/>
</g>
<!-- molecularmechanics -->
<g id="proc~~setup_h0~~UsesGraph_node14" class="node"><title>molecularmechanics</title>
<polygon fill="#337ab7" stroke="#337ab7" points="201,-360 91,-360 91,-336 201,-336 201,-360"/>
<text text-anchor="middle" x="146" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">molecularmechanics</text>
</g>
<!-- proc~setup_h0&#45;&gt;molecularmechanics -->
<g id="proc~~setup_h0~~UsesGraph_edge14" class="edge"><title>proc~setup_h0&#45;&gt;molecularmechanics</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M255.308,-419.828C243.682,-405.913 222.992,-383.227 201,-369 198.545,-367.412 195.952,-365.914 193.284,-364.506"/>
<polygon fill="#000000" stroke="#000000" points="194.542,-361.228 184.011,-360.065 191.518,-367.541 194.542,-361.228"/>
</g>
<!-- m_spin -->
<g id="proc~~setup_h0~~UsesGraph_node15" class="node"><title>m_spin</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173,-318 119,-318 119,-294 173,-294 173,-318"/>
<text text-anchor="middle" x="146" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_spin</text>
</g>
<!-- proc~setup_h0&#45;&gt;m_spin -->
<g id="proc~~setup_h0~~UsesGraph_edge15" class="edge"><title>proc~setup_h0&#45;&gt;m_spin</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M260.633,-419.854C252.289,-398.266 232.098,-353.042 201,-327 195.611,-322.487 189.141,-318.874 182.581,-316.004"/>
<polygon fill="#000000" stroke="#000000" points="183.612,-312.65 173.022,-312.315 181.091,-319.181 183.612,-312.65"/>
</g>
<!-- spinorbit -->
<g id="proc~~setup_h0~~UsesGraph_node16" class="node"><title>spinorbit</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173,-276 119,-276 119,-252 173,-252 173,-276"/>
<text text-anchor="middle" x="146" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">spinorbit</text>
</g>
<!-- proc~setup_h0&#45;&gt;spinorbit -->
<g id="proc~~setup_h0~~UsesGraph_edge16" class="edge"><title>proc~setup_h0&#45;&gt;spinorbit</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M262.993,-419.928C257.787,-392.279 241.339,-323.767 201,-285 195.883,-280.083 189.486,-276.281 182.902,-273.353"/>
<polygon fill="#000000" stroke="#000000" points="183.841,-269.965 173.251,-269.661 181.34,-276.503 183.841,-269.965"/>
</g>
<!-- m_ntm -->
<g id="proc~~setup_h0~~UsesGraph_node17" class="node"><title>m_ntm</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173,-234 119,-234 119,-210 173,-210 173,-234"/>
<text text-anchor="middle" x="146" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ntm</text>
</g>
<!-- proc~setup_h0&#45;&gt;m_ntm -->
<g id="proc~~setup_h0~~UsesGraph_edge17" class="edge"><title>proc~setup_h0&#45;&gt;m_ntm</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M264.312,-419.573C261.82,-386.41 250.569,-294.82 201,-243 196.001,-237.774 189.552,-233.828 182.86,-230.854"/>
<polygon fill="#000000" stroke="#000000" points="183.616,-227.399 173.024,-227.157 181.153,-233.951 183.616,-227.399"/>
</g>
<!-- class_zSpData2D -->
<g id="proc~~setup_h0~~UsesGraph_node18" class="node"><title>class_zSpData2D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="194.5,-192 97.5,-192 97.5,-168 194.5,-168 194.5,-192"/>
<text text-anchor="middle" x="146" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_zSpData2D</text>
</g>
<!-- proc~setup_h0&#45;&gt;class_zSpData2D -->
<g id="proc~~setup_h0~~UsesGraph_edge18" class="edge"><title>proc~setup_h0&#45;&gt;class_zSpData2D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M265.221,-419.939C265.253,-382.458 260.307,-266.596 201,-201 200.108,-200.014 199.165,-199.073 198.177,-198.177"/>
<polygon fill="#000000" stroke="#000000" points="200.012,-195.183 189.868,-192.124 195.89,-200.841 200.012,-195.183"/>
</g>
<!-- alloc -->
<g id="proc~~setup_h0~~UsesGraph_node19" class="node"><title>alloc</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173,-150 119,-150 119,-126 173,-126 173,-150"/>
<text text-anchor="middle" x="146" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">alloc</text>
</g>
<!-- proc~setup_h0&#45;&gt;alloc -->
<g id="proc~~setup_h0~~UsesGraph_edge19" class="edge"><title>proc~setup_h0&#45;&gt;alloc</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M263.642,-419.721C258.141,-371.989 236.111,-199.431 201,-159 196.103,-153.361 189.504,-149.226 182.602,-146.198"/>
<polygon fill="#000000" stroke="#000000" points="183.728,-142.883 173.134,-142.716 181.312,-149.453 183.728,-142.883"/>
</g>
<!-- m_mpi_utils -->
<g id="proc~~setup_h0~~UsesGraph_node20" class="node"><title>m_mpi_utils</title>
<polygon fill="#337ab7" stroke="#337ab7" points="181,-108 111,-108 111,-84 181,-84 181,-108"/>
<text text-anchor="middle" x="146" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_mpi_utils</text>
</g>
<!-- proc~setup_h0&#45;&gt;m_mpi_utils -->
<g id="proc~~setup_h0~~UsesGraph_edge20" class="edge"><title>proc~setup_h0&#45;&gt;m_mpi_utils</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M264.054,-419.668C259.816,-367.378 241.003,-164.477 201,-117 198.002,-113.442 194.325,-110.485 190.312,-108.026"/>
<polygon fill="#000000" stroke="#000000" points="191.629,-104.771 181.123,-103.403 188.483,-111.024 191.629,-104.771"/>
</g>
<!-- metaforce -->
<g id="proc~~setup_h0~~UsesGraph_node21" class="node"><title>metaforce</title>
<polygon fill="#337ab7" stroke="#337ab7" points="176.5,-66 115.5,-66 115.5,-42 176.5,-42 176.5,-66"/>
<text text-anchor="middle" x="146" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">metaforce</text>
</g>
<!-- proc~setup_h0&#45;&gt;metaforce -->
<g id="proc~~setup_h0~~UsesGraph_edge21" class="edge"><title>proc~setup_h0&#45;&gt;metaforce</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M264.392,-419.969C261.341,-364.02 246.017,-129.695 201,-75 197.069,-70.2235 191.91,-66.5301 186.34,-63.6749"/>
<polygon fill="#000000" stroke="#000000" points="187.297,-60.2799 176.723,-59.618 184.576,-66.7296 187.297,-60.2799"/>
</g>
<!-- class_dSpData2D -->
<g id="proc~~setup_h0~~UsesGraph_node22" class="node"><title>class_dSpData2D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="194.5,-24 97.5,-24 97.5,-0 194.5,-0 194.5,-24"/>
<text text-anchor="middle" x="146" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_dSpData2D</text>
</g>
<!-- proc~setup_h0&#45;&gt;class_dSpData2D -->
<g id="proc~~setup_h0~~UsesGraph_edge7" class="edge"><title>proc~setup_h0&#45;&gt;class_dSpData2D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M264.635,-419.788C262.606,-359.586 250.926,-94.8059 201,-33 200.289,-32.1197 199.536,-31.2762 198.746,-30.468"/>
<polygon fill="#000000" stroke="#000000" points="200.781,-27.6137 190.784,-24.1052 196.411,-33.0822 200.781,-27.6137"/>
</g>
<!-- precision -->
<g id="proc~~setup_h0~~UsesGraph_node23" class="node"><title>precision</title>
<polygon fill="#337ab7" stroke="#337ab7" points="55,-507 0,-507 0,-483 55,-483 55,-507"/>
<text text-anchor="middle" x="27.5" y="-492.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">precision</text>
</g>
<!-- module~m_dhscf&#45;&gt;precision -->
<g id="proc~~setup_h0~~UsesGraph_edge22" class="edge"><title>module~m_dhscf&#45;&gt;precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M118.855,-478.713C103.041,-481.563 82.6347,-485.242 65.2178,-488.381"/>
<polygon fill="#000000" stroke="#000000" points="64.5862,-484.939 55.3657,-490.157 65.828,-491.828 64.5862,-484.939"/>
</g>
<!-- m_dfscf -->
<g id="proc~~setup_h0~~UsesGraph_node24" class="node"><title>m_dfscf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54.5,-465 0.5,-465 0.5,-441 54.5,-441 54.5,-465"/>
<text text-anchor="middle" x="27.5" y="-450.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_dfscf</text>
</g>
<!-- module~m_dhscf&#45;&gt;m_dfscf -->
<g id="proc~~setup_h0~~UsesGraph_edge23" class="edge"><title>module~m_dhscf&#45;&gt;m_dfscf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M118.855,-469.287C102.816,-466.396 82.0549,-462.654 64.4785,-459.485"/>
<polygon fill="#000000" stroke="#000000" points="65.0199,-456.027 54.5576,-457.697 63.7781,-462.916 65.0199,-456.027"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="490pt" height="32pt"
 viewBox="0.00 0.00 489.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 485.5,-28 485.5,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node"><title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node"><title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="139.5,-24 72.5,-24 72.5,-0 139.5,-0 139.5,-24"/>
<text text-anchor="middle" x="106" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="222,-24 158,-24 158,-0 222,-0 222,-24"/>
<text text-anchor="middle" x="190" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="294,-24 240,-24 240,-0 294,-0 294,-24"/>
<text text-anchor="middle" x="267" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="366,-24 312,-24 312,-0 366,-0 366,-24"/>
<text text-anchor="middle" x="339" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="481.5,-24 384.5,-24 384.5,-0 481.5,-0 481.5,-24"/>
<text text-anchor="middle" x="433" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses.
    </p>
    </div></div></div></div>
      </li>
      
      </ul>
    </div>
    


    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-g2max"></span>real(kind=dp),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>g2max</strong></td><td></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~setup_h0~~CallsGraph Pages: 1 -->
<svg id="procsetup_h0CallsGraph" width="641pt" height="1449pt"
 viewBox="0.00 0.00 641.00 1448.54" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~setup_h0~~CallsGraph" class="graph" transform="scale(0.867388 0.867388) rotate(0) translate(4 1666)">
<title>proc~~setup_h0~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1666 735,-1666 735,4 -4,4"/>
<!-- proc~setup_h0 -->
<g id="proc~~setup_h0~~CallsGraph_node1" class="node"><title>proc~setup_h0</title>
<polygon fill="none" stroke="black" points="58,-633 3.55271e-15,-633 3.55271e-15,-609 58,-609 58,-633"/>
<text text-anchor="middle" x="29" y="-618.6" font-family="Helvetica,sans-Serif" font-size="10.50">setup_H0</text>
</g>
<!-- proc~dhscf_init -->
<g id="proc~~setup_h0~~CallsGraph_node2" class="node"><title>proc~dhscf_init</title>
<g id="a_proc~~setup_h0~~CallsGraph_node2"><a xlink:href=".././proc/dhscf_init.html" xlink:title="dhscf_init">
<polygon fill="#d9534f" stroke="#d9534f" points="163.5,-864 105.5,-864 105.5,-840 163.5,-840 163.5,-864"/>
<text text-anchor="middle" x="134.5" y="-849.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dhscf_init</text>
</a>
</g>
</g>
<!-- proc~setup_h0&#45;&gt;proc~dhscf_init -->
<g id="proc~~setup_h0~~CallsGraph_edge1" class="edge"><title>proc~setup_h0&#45;&gt;proc~dhscf_init</title>
<path fill="none" stroke="#000000" d="M30.5586,-633.419C32.7473,-668.454 43.357,-769.513 94,-831 94.9567,-832.162 95.9948,-833.268 97.0965,-834.32"/>
<polygon fill="#000000" stroke="#000000" points="95.0485,-837.16 105.103,-840.502 99.327,-831.62 95.0485,-837.16"/>
</g>
<!-- globalize_sum -->
<g id="proc~~setup_h0~~CallsGraph_node3" class="node"><title>globalize_sum</title>
<polygon fill="#777777" stroke="#777777" points="175,-822 94,-822 94,-798 175,-798 175,-822"/>
<text text-anchor="middle" x="134.5" y="-807.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">globalize_sum</text>
</g>
<!-- proc~setup_h0&#45;&gt;globalize_sum -->
<g id="proc~~setup_h0~~CallsGraph_edge2" class="edge"><title>proc~setup_h0&#45;&gt;globalize_sum</title>
<path fill="none" stroke="#000000" d="M31.6342,-633.07C36.2439,-662.924 51.8696,-741.261 94,-789 94.7452,-789.844 95.5326,-790.66 96.3552,-791.449"/>
<polygon fill="#000000" stroke="#000000" points="94.474,-794.42 104.513,-797.807 98.7771,-788.899 94.474,-794.42"/>
</g>
<!-- nlefsm -->
<g id="proc~~setup_h0~~CallsGraph_node4" class="node"><title>nlefsm</title>
<polygon fill="#777777" stroke="#777777" points="161.5,-780 107.5,-780 107.5,-756 161.5,-756 161.5,-780"/>
<text text-anchor="middle" x="134.5" y="-765.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nlefsm</text>
</g>
<!-- proc~setup_h0&#45;&gt;nlefsm -->
<g id="proc~~setup_h0~~CallsGraph_edge3" class="edge"><title>proc~setup_h0&#45;&gt;nlefsm</title>
<path fill="none" stroke="#000000" d="M33.4612,-633.237C40.895,-657.621 60.4867,-712.855 94,-747 95.4281,-748.455 96.9786,-749.832 98.6114,-751.133"/>
<polygon fill="#000000" stroke="#000000" points="97.0324,-754.29 107.276,-756.996 100.956,-748.493 97.0324,-754.29"/>
</g>
<!-- val -->
<g id="proc~~setup_h0~~CallsGraph_node5" class="node"><title>val</title>
<polygon fill="#777777" stroke="#777777" points="161.5,-738 107.5,-738 107.5,-714 161.5,-714 161.5,-738"/>
<text text-anchor="middle" x="134.5" y="-723.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">val</text>
</g>
<!-- proc~setup_h0&#45;&gt;val -->
<g id="proc~~setup_h0~~CallsGraph_edge4" class="edge"><title>proc~setup_h0&#45;&gt;val</title>
<path fill="none" stroke="#000000" d="M36.9226,-633.165C47.4257,-650.786 68.8486,-683.635 94,-705 95.5094,-706.282 97.11,-707.517 98.7687,-708.702"/>
<polygon fill="#000000" stroke="#000000" points="97.0769,-711.774 107.393,-714.19 100.835,-705.868 97.0769,-711.774"/>
</g>
<!-- naefs -->
<g id="proc~~setup_h0~~CallsGraph_node6" class="node"><title>naefs</title>
<polygon fill="#777777" stroke="#777777" points="161.5,-696 107.5,-696 107.5,-672 161.5,-672 161.5,-696"/>
<text text-anchor="middle" x="134.5" y="-681.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">naefs</text>
</g>
<!-- proc~setup_h0&#45;&gt;naefs -->
<g id="proc~~setup_h0~~CallsGraph_edge5" class="edge"><title>proc~setup_h0&#45;&gt;naefs</title>
<path fill="none" stroke="#000000" d="M47.3808,-633.031C60.0991,-641.68 77.8766,-653.451 94,-663 96.3013,-664.363 98.6982,-665.739 101.123,-667.101"/>
<polygon fill="#000000" stroke="#000000" points="99.4578,-670.179 109.909,-671.915 102.821,-664.04 99.4578,-670.179"/>
</g>
<!-- uion -->
<g id="proc~~setup_h0~~CallsGraph_node7" class="node"><title>uion</title>
<polygon fill="#777777" stroke="#777777" points="161.5,-654 107.5,-654 107.5,-630 161.5,-630 161.5,-654"/>
<text text-anchor="middle" x="134.5" y="-639.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uion</text>
</g>
<!-- proc~setup_h0&#45;&gt;uion -->
<g id="proc~~setup_h0~~CallsGraph_edge6" class="edge"><title>proc~setup_h0&#45;&gt;uion</title>
<path fill="none" stroke="#000000" d="M58.0086,-626.683C70.1017,-629.137 84.4033,-632.038 97.2882,-634.653"/>
<polygon fill="#000000" stroke="#000000" points="96.7525,-638.115 107.249,-636.674 98.1445,-631.255 96.7525,-638.115"/>
</g>
<!-- timer -->
<g id="proc~~setup_h0~~CallsGraph_node8" class="node"><title>timer</title>
<polygon fill="#777777" stroke="#777777" points="731,-1497 677,-1497 677,-1473 731,-1473 731,-1497"/>
<text text-anchor="middle" x="704" y="-1482.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">timer</text>
</g>
<!-- proc~setup_h0&#45;&gt;timer -->
<g id="proc~~setup_h0~~CallsGraph_edge7" class="edge"><title>proc~setup_h0&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M30.1882,-633.105C31.6879,-722.358 43.0058,-1279.39 94,-1439 134.699,-1566.38 162.272,-1662 296,-1662 296,-1662 296,-1662 470,-1662 549.834,-1662 580.244,-1658.79 641,-1607 672.126,-1580.47 689.427,-1534.45 697.421,-1507.15"/>
<polygon fill="#000000" stroke="#000000" points="700.836,-1507.93 700.123,-1497.36 694.089,-1506.07 700.836,-1507.93"/>
</g>
<!-- nlefsm_so_off -->
<g id="proc~~setup_h0~~CallsGraph_node9" class="node"><title>nlefsm_so_off</title>
<polygon fill="#777777" stroke="#777777" points="174,-612 95,-612 95,-588 174,-588 174,-612"/>
<text text-anchor="middle" x="134.5" y="-597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nlefsm_so_off</text>
</g>
<!-- proc~setup_h0&#45;&gt;nlefsm_so_off -->
<g id="proc~~setup_h0~~CallsGraph_edge8" class="edge"><title>proc~setup_h0&#45;&gt;nlefsm_so_off</title>
<path fill="none" stroke="#000000" d="M58.0086,-615.317C66.3619,-613.622 75.7689,-611.714 85.0349,-609.833"/>
<polygon fill="#000000" stroke="#000000" points="85.8733,-613.235 94.9777,-607.816 84.4814,-606.375 85.8733,-613.235"/>
</g>
<!-- spinorb -->
<g id="proc~~setup_h0~~CallsGraph_node10" class="node"><title>spinorb</title>
<polygon fill="#777777" stroke="#777777" points="161.5,-570 107.5,-570 107.5,-546 161.5,-546 161.5,-570"/>
<text text-anchor="middle" x="134.5" y="-555.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">spinorb</text>
</g>
<!-- proc~setup_h0&#45;&gt;spinorb -->
<g id="proc~~setup_h0~~CallsGraph_edge9" class="edge"><title>proc~setup_h0&#45;&gt;spinorb</title>
<path fill="none" stroke="#000000" d="M47.3808,-608.969C60.0991,-600.32 77.8766,-588.549 94,-579 96.3013,-577.637 98.6982,-576.261 101.123,-574.899"/>
<polygon fill="#000000" stroke="#000000" points="102.821,-577.96 109.909,-570.085 99.4578,-571.821 102.821,-577.96"/>
</g>
<!-- meta -->
<g id="proc~~setup_h0~~CallsGraph_node11" class="node"><title>meta</title>
<polygon fill="#777777" stroke="#777777" points="161.5,-528 107.5,-528 107.5,-504 161.5,-504 161.5,-528"/>
<text text-anchor="middle" x="134.5" y="-513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">meta</text>
</g>
<!-- proc~setup_h0&#45;&gt;meta -->
<g id="proc~~setup_h0~~CallsGraph_edge10" class="edge"><title>proc~setup_h0&#45;&gt;meta</title>
<path fill="none" stroke="#000000" d="M36.9226,-608.835C47.4257,-591.214 68.8486,-558.365 94,-537 95.5094,-535.718 97.11,-534.483 98.7687,-533.298"/>
<polygon fill="#000000" stroke="#000000" points="100.835,-536.132 107.393,-527.81 97.0769,-530.226 100.835,-536.132"/>
</g>
<!-- kinefsm -->
<g id="proc~~setup_h0~~CallsGraph_node12" class="node"><title>kinefsm</title>
<polygon fill="#777777" stroke="#777777" points="161.5,-486 107.5,-486 107.5,-462 161.5,-462 161.5,-486"/>
<text text-anchor="middle" x="134.5" y="-471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">kinefsm</text>
</g>
<!-- proc~setup_h0&#45;&gt;kinefsm -->
<g id="proc~~setup_h0~~CallsGraph_edge11" class="edge"><title>proc~setup_h0&#45;&gt;kinefsm</title>
<path fill="none" stroke="#000000" d="M33.4612,-608.763C40.895,-584.379 60.4867,-529.145 94,-495 95.4281,-493.545 96.9786,-492.168 98.6114,-490.867"/>
<polygon fill="#000000" stroke="#000000" points="100.956,-493.507 107.276,-485.004 97.0324,-487.71 100.956,-493.507"/>
</g>
<!-- write_debug -->
<g id="proc~~setup_h0~~CallsGraph_node13" class="node"><title>write_debug</title>
<polygon fill="#777777" stroke="#777777" points="633.5,-1598 562.5,-1598 562.5,-1574 633.5,-1574 633.5,-1598"/>
<text text-anchor="middle" x="598" y="-1583.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_debug</text>
</g>
<!-- proc~setup_h0&#45;&gt;write_debug -->
<g id="proc~~setup_h0~~CallsGraph_edge12" class="edge"><title>proc~setup_h0&#45;&gt;write_debug</title>
<path fill="none" stroke="#000000" d="M30.2904,-633.102C33.0225,-735.828 57.6509,-1461.16 211,-1597 309.336,-1684.11 483.287,-1631.42 559.482,-1601.91"/>
<polygon fill="#000000" stroke="#000000" points="561.126,-1605.02 569.138,-1598.09 558.551,-1598.51 561.126,-1605.02"/>
</g>
<!-- dnaefs -->
<g id="proc~~setup_h0~~CallsGraph_node14" class="node"><title>dnaefs</title>
<polygon fill="#777777" stroke="#777777" points="161.5,-444 107.5,-444 107.5,-420 161.5,-420 161.5,-444"/>
<text text-anchor="middle" x="134.5" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dnaefs</text>
</g>
<!-- proc~setup_h0&#45;&gt;dnaefs -->
<g id="proc~~setup_h0~~CallsGraph_edge13" class="edge"><title>proc~setup_h0&#45;&gt;dnaefs</title>
<path fill="none" stroke="#000000" d="M31.6342,-608.93C36.2439,-579.076 51.8696,-500.739 94,-453 95.5032,-451.297 97.1785,-449.709 98.967,-448.231"/>
<polygon fill="#000000" stroke="#000000" points="101.103,-451.01 107.35,-442.453 97.1304,-445.246 101.103,-451.01"/>
</g>
<!-- dscf -->
<g id="proc~~setup_h0~~CallsGraph_node15" class="node"><title>dscf</title>
<polygon fill="#777777" stroke="#777777" points="161.5,-402 107.5,-402 107.5,-378 161.5,-378 161.5,-402"/>
<text text-anchor="middle" x="134.5" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dscf</text>
</g>
<!-- proc~setup_h0&#45;&gt;dscf -->
<g id="proc~~setup_h0~~CallsGraph_edge14" class="edge"><title>proc~setup_h0&#45;&gt;dscf</title>
<path fill="none" stroke="#000000" d="M30.5586,-608.581C32.7473,-573.546 43.357,-472.487 94,-411 95.4443,-409.246 97.0741,-407.62 98.8284,-406.113"/>
<polygon fill="#000000" stroke="#000000" points="100.971,-408.885 107.126,-400.261 96.9363,-403.165 100.971,-408.885"/>
</g>
<!-- isa -->
<g id="proc~~setup_h0~~CallsGraph_node16" class="node"><title>isa</title>
<polygon fill="#777777" stroke="#777777" points="161.5,-360 107.5,-360 107.5,-336 161.5,-336 161.5,-360"/>
<text text-anchor="middle" x="134.5" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">isa</text>
</g>
<!-- proc~setup_h0&#45;&gt;isa -->
<g id="proc~~setup_h0~~CallsGraph_edge15" class="edge"><title>proc~setup_h0&#45;&gt;isa</title>
<path fill="none" stroke="#000000" d="M29.7864,-608.738C29.7303,-569.445 34.5003,-444.811 94,-369 95.4415,-367.163 97.0892,-365.468 98.8747,-363.907"/>
<polygon fill="#000000" stroke="#000000" points="101.231,-366.528 107.374,-357.895 97.1886,-360.813 101.231,-366.528"/>
</g>
<!-- twobody -->
<g id="proc~~setup_h0~~CallsGraph_node17" class="node"><title>twobody</title>
<polygon fill="#777777" stroke="#777777" points="161.5,-318 107.5,-318 107.5,-294 161.5,-294 161.5,-318"/>
<text text-anchor="middle" x="134.5" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">twobody</text>
</g>
<!-- proc~setup_h0&#45;&gt;twobody -->
<g id="proc~~setup_h0~~CallsGraph_edge16" class="edge"><title>proc~setup_h0&#45;&gt;twobody</title>
<path fill="none" stroke="#000000" d="M31.2706,-608.933C36.6727,-559.527 59.0692,-373.117 94,-327 95.4097,-325.139 97.0331,-323.425 98.8005,-321.85"/>
<polygon fill="#000000" stroke="#000000" points="101.157,-324.468 107.255,-315.804 97.0852,-318.774 101.157,-324.468"/>
</g>
<!-- proc~dhscf_init&#45;&gt;timer -->
<g id="proc~~setup_h0~~CallsGraph_edge22" class="edge"><title>proc~dhscf_init&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M135.32,-864.351C134.511,-938.056 134.123,-1319.31 211,-1399 227.002,-1415.59 555.872,-1463.95 666.816,-1479.86"/>
<polygon fill="#000000" stroke="#000000" points="666.46,-1483.35 676.855,-1481.3 667.451,-1476.42 666.46,-1483.35"/>
</g>
<!-- proc~dhscf_init&#45;&gt;write_debug -->
<g id="proc~~setup_h0~~CallsGraph_edge34" class="edge"><title>proc~dhscf_init&#45;&gt;write_debug</title>
<path fill="none" stroke="#000000" d="M135.848,-864.049C138.555,-953.841 157.6,-1516.51 211,-1567 259.001,-1612.38 461.533,-1599.19 552.471,-1590.68"/>
<polygon fill="#000000" stroke="#000000" points="552.853,-1594.16 562.473,-1589.73 552.185,-1587.2 552.853,-1594.16"/>
</g>
<!-- volcel -->
<g id="proc~~setup_h0~~CallsGraph_node18" class="node"><title>volcel</title>
<polygon fill="#777777" stroke="#777777" points="324,-1158 270,-1158 270,-1134 324,-1134 324,-1158"/>
<text text-anchor="middle" x="297" y="-1143.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">volcel</text>
</g>
<!-- proc~dhscf_init&#45;&gt;volcel -->
<g id="proc~~setup_h0~~CallsGraph_edge17" class="edge"><title>proc~dhscf_init&#45;&gt;volcel</title>
<path fill="none" stroke="#000000" d="M134.887,-864.191C133.452,-906.838 134.687,-1050.76 211,-1125 223.813,-1137.46 242.79,-1142.91 259.564,-1145.15"/>
<polygon fill="#000000" stroke="#000000" points="259.348,-1148.65 269.649,-1146.17 260.051,-1141.68 259.348,-1148.65"/>
</g>
<!-- ts_init_voltage -->
<g id="proc~~setup_h0~~CallsGraph_node19" class="node"><title>ts_init_voltage</title>
<polygon fill="#777777" stroke="#777777" points="337.5,-1116 256.5,-1116 256.5,-1092 337.5,-1092 337.5,-1116"/>
<text text-anchor="middle" x="297" y="-1101.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ts_init_voltage</text>
</g>
<!-- proc~dhscf_init&#45;&gt;ts_init_voltage -->
<g id="proc~~setup_h0~~CallsGraph_edge18" class="edge"><title>proc~dhscf_init&#45;&gt;ts_init_voltage</title>
<path fill="none" stroke="#000000" d="M135.602,-864.186C136.614,-902.537 145.156,-1021.84 211,-1083 220.579,-1091.9 233.316,-1097.19 246.007,-1100.29"/>
<polygon fill="#000000" stroke="#000000" points="245.619,-1103.78 256.115,-1102.33 247.008,-1096.92 245.619,-1103.78"/>
</g>
<!-- re_alloc -->
<g id="proc~~setup_h0~~CallsGraph_node20" class="node"><title>re_alloc</title>
<polygon fill="#777777" stroke="#777777" points="731,-1399 677,-1399 677,-1375 731,-1375 731,-1399"/>
<text text-anchor="middle" x="704" y="-1384.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">re_alloc</text>
</g>
<!-- proc~dhscf_init&#45;&gt;re_alloc -->
<g id="proc~~setup_h0~~CallsGraph_edge19" class="edge"><title>proc~dhscf_init&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M135.453,-864.034C135.435,-934.24 138.933,-1290.36 211,-1365 237.992,-1392.95 516.301,-1424.49 555,-1428 593.066,-1431.46 604.397,-1439.01 641,-1428 655.968,-1423.5 670.652,-1414.08 681.969,-1405.4"/>
<polygon fill="#000000" stroke="#000000" points="684.321,-1408 689.917,-1399 679.932,-1402.55 684.321,-1408"/>
</g>
<!-- rcut -->
<g id="proc~~setup_h0~~CallsGraph_node21" class="node"><title>rcut</title>
<polygon fill="#777777" stroke="#777777" points="324,-1074 270,-1074 270,-1050 324,-1050 324,-1074"/>
<text text-anchor="middle" x="297" y="-1059.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rcut</text>
</g>
<!-- proc~dhscf_init&#45;&gt;rcut -->
<g id="proc~~setup_h0~~CallsGraph_edge20" class="edge"><title>proc~dhscf_init&#45;&gt;rcut</title>
<path fill="none" stroke="#000000" d="M136.622,-864.351C140.374,-898.131 155.576,-992.734 211,-1041 224.385,-1052.66 243.243,-1058.05 259.797,-1060.47"/>
<polygon fill="#000000" stroke="#000000" points="259.401,-1063.94 269.737,-1061.62 260.206,-1056.99 259.401,-1063.94"/>
</g>
<!-- de_alloc -->
<g id="proc~~setup_h0~~CallsGraph_node22" class="node"><title>de_alloc</title>
<polygon fill="#777777" stroke="#777777" points="731,-1156 677,-1156 677,-1132 731,-1132 731,-1156"/>
<text text-anchor="middle" x="704" y="-1141.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">de_alloc</text>
</g>
<!-- proc~dhscf_init&#45;&gt;de_alloc -->
<g id="proc~~setup_h0~~CallsGraph_edge21" class="edge"><title>proc~dhscf_init&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M136.456,-864.06C140.924,-917.023 161.655,-1128.08 211,-1167 271.024,-1214.34 317.972,-1207.19 383,-1167 413.434,-1148.19 393.924,-1120.52 419,-1095 466.791,-1046.37 488.778,-1040.25 555,-1024 592.122,-1014.89 608.354,-1004.12 641,-1024 675.987,-1045.3 692.095,-1093.41 698.797,-1121.82"/>
<polygon fill="#000000" stroke="#000000" points="695.388,-1122.61 700.926,-1131.64 702.23,-1121.13 695.388,-1122.61"/>
</g>
<!-- ddot -->
<g id="proc~~setup_h0~~CallsGraph_node23" class="node"><title>ddot</title>
<polygon fill="#777777" stroke="#777777" points="324,-1032 270,-1032 270,-1008 324,-1008 324,-1032"/>
<text text-anchor="middle" x="297" y="-1017.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ddot</text>
</g>
<!-- proc~dhscf_init&#45;&gt;ddot -->
<g id="proc~~setup_h0~~CallsGraph_edge55" class="edge"><title>proc~dhscf_init&#45;&gt;ddot</title>
<path fill="none" stroke="#000000" d="M138.094,-864.063C144.817,-892.306 165.548,-963.045 211,-999 224.691,-1009.83 243.205,-1015.17 259.458,-1017.77"/>
<polygon fill="#000000" stroke="#000000" points="259.371,-1021.28 269.74,-1019.1 260.276,-1014.34 259.371,-1021.28"/>
</g>
<!-- setupextmesh -->
<g id="proc~~setup_h0~~CallsGraph_node24" class="node"><title>setupextmesh</title>
<polygon fill="#777777" stroke="#777777" points="336.5,-990 257.5,-990 257.5,-966 336.5,-966 336.5,-990"/>
<text text-anchor="middle" x="297" y="-975.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setupextmesh</text>
</g>
<!-- proc~dhscf_init&#45;&gt;setupextmesh -->
<g id="proc~~setup_h0~~CallsGraph_edge23" class="edge"><title>proc~dhscf_init&#45;&gt;setupextmesh</title>
<path fill="none" stroke="#000000" d="M140.761,-864.223C150.935,-886.348 175.481,-932.97 211,-957 221.729,-964.259 234.734,-969.012 247.311,-972.123"/>
<polygon fill="#000000" stroke="#000000" points="246.739,-975.58 257.254,-974.283 248.225,-968.74 246.739,-975.58"/>
</g>
<!-- distriphionmesh -->
<g id="proc~~setup_h0~~CallsGraph_node25" class="node"><title>distriphionmesh</title>
<polygon fill="#777777" stroke="#777777" points="341,-948 253,-948 253,-924 341,-924 341,-948"/>
<text text-anchor="middle" x="297" y="-933.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">distriphionmesh</text>
</g>
<!-- proc~dhscf_init&#45;&gt;distriphionmesh -->
<g id="proc~~setup_h0~~CallsGraph_edge25" class="edge"><title>proc~dhscf_init&#45;&gt;distriphionmesh</title>
<path fill="none" stroke="#000000" d="M146.571,-864.113C160.311,-878.408 185.109,-901.888 211,-915 220.863,-919.995 231.983,-923.847 242.85,-926.802"/>
<polygon fill="#000000" stroke="#000000" points="242.164,-930.239 252.715,-929.271 243.864,-923.448 242.164,-930.239"/>
</g>
<!-- initmesh -->
<g id="proc~~setup_h0~~CallsGraph_node26" class="node"><title>initmesh</title>
<polygon fill="#777777" stroke="#777777" points="324,-906 270,-906 270,-882 324,-882 324,-906"/>
<text text-anchor="middle" x="297" y="-891.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">initmesh</text>
</g>
<!-- proc~dhscf_init&#45;&gt;initmesh -->
<g id="proc~~setup_h0~~CallsGraph_edge26" class="edge"><title>proc~dhscf_init&#45;&gt;initmesh</title>
<path fill="none" stroke="#000000" d="M163.771,-860.073C177.925,-864.062 195.34,-868.889 211,-873 227.007,-877.203 244.773,-881.629 259.907,-885.328"/>
<polygon fill="#000000" stroke="#000000" points="259.365,-888.799 269.909,-887.762 261.02,-881.997 259.365,-888.799"/>
</g>
<!-- leqi -->
<g id="proc~~setup_h0~~CallsGraph_node27" class="node"><title>leqi</title>
<polygon fill="#777777" stroke="#777777" points="324,-864 270,-864 270,-840 324,-840 324,-864"/>
<text text-anchor="middle" x="297" y="-849.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">leqi</text>
</g>
<!-- proc~dhscf_init&#45;&gt;leqi -->
<g id="proc~~setup_h0~~CallsGraph_edge27" class="edge"><title>proc~dhscf_init&#45;&gt;leqi</title>
<path fill="none" stroke="#000000" d="M163.825,-852C190.515,-852 230.634,-852 259.668,-852"/>
<polygon fill="#000000" stroke="#000000" points="259.819,-855.5 269.819,-852 259.819,-848.5 259.819,-855.5"/>
</g>
<!-- proc~setmeshdistr -->
<g id="proc~~setup_h0~~CallsGraph_node28" class="node"><title>proc~setmeshdistr</title>
<g id="a_proc~~setup_h0~~CallsGraph_node28"><a xlink:href=".././proc/setmeshdistr.html" xlink:title="setMeshDistr">
<polygon fill="#d9534f" stroke="#d9534f" points="334.5,-822 259.5,-822 259.5,-798 334.5,-798 334.5,-822"/>
<text text-anchor="middle" x="297" y="-807.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setMeshDistr</text>
</a>
</g>
</g>
<!-- proc~dhscf_init&#45;&gt;proc~setmeshdistr -->
<g id="proc~~setup_h0~~CallsGraph_edge28" class="edge"><title>proc~dhscf_init&#45;&gt;proc~setmeshdistr</title>
<path fill="none" stroke="#000000" d="M163.771,-843.927C177.925,-839.938 195.34,-835.111 211,-831 223.413,-827.741 236.884,-824.347 249.365,-821.263"/>
<polygon fill="#000000" stroke="#000000" points="250.248,-824.65 259.123,-818.863 248.576,-817.852 250.248,-824.65"/>
</g>
<!-- initatommesh -->
<g id="proc~~setup_h0~~CallsGraph_node29" class="node"><title>initatommesh</title>
<polygon fill="#777777" stroke="#777777" points="335,-780 259,-780 259,-756 335,-756 335,-780"/>
<text text-anchor="middle" x="297" y="-765.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">initatommesh</text>
</g>
<!-- proc~dhscf_init&#45;&gt;initatommesh -->
<g id="proc~~setup_h0~~CallsGraph_edge29" class="edge"><title>proc~dhscf_init&#45;&gt;initatommesh</title>
<path fill="none" stroke="#000000" d="M161.866,-839.764C166.436,-837.153 170.999,-834.205 175,-831 194.188,-815.629 190.068,-801.896 211,-789 222.335,-782.016 235.863,-777.353 248.758,-774.24"/>
<polygon fill="#000000" stroke="#000000" points="249.866,-777.582 258.909,-772.061 248.397,-770.738 249.866,-777.582"/>
</g>
<!-- fdf_integer -->
<g id="proc~~setup_h0~~CallsGraph_node30" class="node"><title>fdf_integer</title>
<polygon fill="#777777" stroke="#777777" points="329,-738 265,-738 265,-714 329,-714 329,-738"/>
<text text-anchor="middle" x="297" y="-723.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fdf_integer</text>
</g>
<!-- proc~dhscf_init&#45;&gt;fdf_integer -->
<g id="proc~~setup_h0~~CallsGraph_edge36" class="edge"><title>proc~dhscf_init&#45;&gt;fdf_integer</title>
<path fill="none" stroke="#000000" d="M163.556,-840.205C167.743,-837.604 171.741,-834.544 175,-831 202.493,-801.102 180.04,-773.292 211,-747 223.05,-736.767 239.337,-731.382 254.431,-728.596"/>
<polygon fill="#000000" stroke="#000000" points="255.259,-732.01 264.623,-727.054 254.212,-725.089 255.259,-732.01"/>
</g>
<!-- init_hartree_add -->
<g id="proc~~setup_h0~~CallsGraph_node31" class="node"><title>init_hartree_add</title>
<polygon fill="#777777" stroke="#777777" points="342.5,-696 251.5,-696 251.5,-672 342.5,-672 342.5,-696"/>
<text text-anchor="middle" x="297" y="-681.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_hartree_add</text>
</g>
<!-- proc~dhscf_init&#45;&gt;init_hartree_add -->
<g id="proc~~setup_h0~~CallsGraph_edge31" class="edge"><title>proc~dhscf_init&#45;&gt;init_hartree_add</title>
<path fill="none" stroke="#000000" d="M163.552,-840.802C167.842,-838.109 171.874,-834.864 175,-831 211.632,-785.722 169.081,-745.433 211,-705 219.293,-697.001 230.126,-691.898 241.269,-688.677"/>
<polygon fill="#000000" stroke="#000000" points="242.186,-692.056 251.085,-686.306 240.542,-685.252 242.186,-692.056"/>
</g>
<!-- ts_init_hartree_fix -->
<g id="proc~~setup_h0~~CallsGraph_node32" class="node"><title>ts_init_hartree_fix</title>
<polygon fill="#777777" stroke="#777777" points="345.5,-654 248.5,-654 248.5,-630 345.5,-630 345.5,-654"/>
<text text-anchor="middle" x="297" y="-639.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ts_init_hartree_fix</text>
</g>
<!-- proc~dhscf_init&#45;&gt;ts_init_hartree_fix -->
<g id="proc~~setup_h0~~CallsGraph_edge24" class="edge"><title>proc~dhscf_init&#45;&gt;ts_init_hartree_fix</title>
<path fill="none" stroke="#000000" d="M163.774,-840.976C168.039,-838.263 172.005,-834.967 175,-831 221.008,-770.054 157.851,-717.829 211,-663 218.456,-655.308 228.249,-650.259 238.527,-646.982"/>
<polygon fill="#000000" stroke="#000000" points="239.696,-650.293 248.47,-644.354 237.907,-643.526 239.696,-650.293"/>
</g>
<!-- partialcoreonmesh -->
<g id="proc~~setup_h0~~CallsGraph_node33" class="node"><title>partialcoreonmesh</title>
<polygon fill="#777777" stroke="#777777" points="347.5,-612 246.5,-612 246.5,-588 347.5,-588 347.5,-612"/>
<text text-anchor="middle" x="297" y="-597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">partialcoreonmesh</text>
</g>
<!-- proc~dhscf_init&#45;&gt;partialcoreonmesh -->
<g id="proc~~setup_h0~~CallsGraph_edge33" class="edge"><title>proc~dhscf_init&#45;&gt;partialcoreonmesh</title>
<path fill="none" stroke="#000000" d="M163.515,-841.332C167.917,-838.562 171.997,-835.154 175,-831 230.48,-754.26 146.509,-690.34 211,-621 217.91,-613.57 226.996,-608.587 236.652,-605.28"/>
<polygon fill="#000000" stroke="#000000" points="237.775,-608.6 246.44,-602.503 235.864,-601.866 237.775,-608.6"/>
</g>
<!-- rcore -->
<g id="proc~~setup_h0~~CallsGraph_node34" class="node"><title>rcore</title>
<polygon fill="#777777" stroke="#777777" points="324,-570 270,-570 270,-546 324,-546 324,-570"/>
<text text-anchor="middle" x="297" y="-555.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rcore</text>
</g>
<!-- proc~dhscf_init&#45;&gt;rcore -->
<g id="proc~~setup_h0~~CallsGraph_edge35" class="edge"><title>proc~dhscf_init&#45;&gt;rcore</title>
<path fill="none" stroke="#000000" d="M163.611,-841.401C168.003,-838.624 172.055,-835.195 175,-831 240,-738.399 135.111,-662.91 211,-579 223.159,-565.556 242.434,-560.08 259.557,-558.066"/>
<polygon fill="#000000" stroke="#000000" points="260.179,-561.527 269.858,-557.219 259.605,-554.551 260.179,-561.527"/>
</g>
<!-- proc~reord -->
<g id="proc~~setup_h0~~CallsGraph_node35" class="node"><title>proc~reord</title>
<g id="a_proc~~setup_h0~~CallsGraph_node35"><a xlink:href=".././proc/reord.html" xlink:title="reord">
<polygon fill="#d9534f" stroke="#d9534f" points="625,-1419 571,-1419 571,-1395 625,-1395 625,-1419"/>
<text text-anchor="middle" x="598" y="-1404.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reord</text>
</a>
</g>
</g>
<!-- proc~dhscf_init&#45;&gt;proc~reord -->
<g id="proc~~setup_h0~~CallsGraph_edge30" class="edge"><title>proc~dhscf_init&#45;&gt;proc~reord</title>
<path fill="none" stroke="#000000" d="M135.854,-864.15C137.962,-927.785 150.882,-1222.13 211,-1285 265.104,-1341.58 308.111,-1300.18 383,-1323 447.288,-1342.59 519.589,-1372.75 561.549,-1391.1"/>
<polygon fill="#000000" stroke="#000000" points="560.221,-1394.34 570.784,-1395.16 563.04,-1387.93 560.221,-1394.34"/>
</g>
<!-- init_mesh_node -->
<g id="proc~~setup_h0~~CallsGraph_node36" class="node"><title>init_mesh_node</title>
<polygon fill="#777777" stroke="#777777" points="341,-528 253,-528 253,-504 341,-504 341,-528"/>
<text text-anchor="middle" x="297" y="-513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_mesh_node</text>
</g>
<!-- proc~dhscf_init&#45;&gt;init_mesh_node -->
<g id="proc~~setup_h0~~CallsGraph_edge37" class="edge"><title>proc~dhscf_init&#45;&gt;init_mesh_node</title>
<path fill="none" stroke="#000000" d="M163.68,-841.449C168.066,-838.667 172.097,-835.225 175,-831 249.548,-722.499 123.682,-635.516 211,-537 219.192,-527.757 230.746,-522.266 242.703,-519.076"/>
<polygon fill="#000000" stroke="#000000" points="243.738,-522.434 252.777,-516.906 242.264,-515.591 243.738,-522.434"/>
</g>
<!-- setgga -->
<g id="proc~~setup_h0~~CallsGraph_node37" class="node"><title>setgga</title>
<polygon fill="#777777" stroke="#777777" points="324,-486 270,-486 270,-462 324,-462 324,-486"/>
<text text-anchor="middle" x="297" y="-471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setgga</text>
</g>
<!-- proc~dhscf_init&#45;&gt;setgga -->
<g id="proc~~setup_h0~~CallsGraph_edge38" class="edge"><title>proc~dhscf_init&#45;&gt;setgga</title>
<path fill="none" stroke="#000000" d="M163.733,-841.485C168.113,-838.699 172.129,-835.247 175,-831 259.113,-706.575 112.233,-608.143 211,-495 222.921,-481.344 242.18,-475.854 259.353,-473.885"/>
<polygon fill="#000000" stroke="#000000" points="259.998,-477.345 269.693,-473.073 259.449,-470.367 259.998,-477.345"/>
</g>
<!-- phionmesh -->
<g id="proc~~setup_h0~~CallsGraph_node38" class="node"><title>phionmesh</title>
<polygon fill="#777777" stroke="#777777" points="329.5,-444 264.5,-444 264.5,-420 329.5,-420 329.5,-444"/>
<text text-anchor="middle" x="297" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">phionmesh</text>
</g>
<!-- proc~dhscf_init&#45;&gt;phionmesh -->
<g id="proc~~setup_h0~~CallsGraph_edge39" class="edge"><title>proc~dhscf_init&#45;&gt;phionmesh</title>
<path fill="none" stroke="#000000" d="M163.775,-841.513C168.15,-838.724 172.154,-835.263 175,-831 221.844,-760.817 155.885,-516.893 211,-453 221.669,-440.631 238.359,-434.946 254.135,-432.513"/>
<polygon fill="#000000" stroke="#000000" points="254.761,-435.964 264.297,-431.346 253.963,-429.01 254.761,-435.964"/>
</g>
<!-- initialize_efield -->
<g id="proc~~setup_h0~~CallsGraph_node39" class="node"><title>initialize_efield</title>
<polygon fill="#777777" stroke="#777777" points="338,-402 256,-402 256,-378 338,-378 338,-402"/>
<text text-anchor="middle" x="297" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">initialize_efield</text>
</g>
<!-- proc~dhscf_init&#45;&gt;initialize_efield -->
<g id="proc~~setup_h0~~CallsGraph_edge40" class="edge"><title>proc~dhscf_init&#45;&gt;initialize_efield</title>
<path fill="none" stroke="#000000" d="M163.808,-841.535C168.18,-838.744 172.174,-835.277 175,-831 226.636,-752.841 150.149,-482.22 211,-411 219.734,-400.778 232.58,-395.112 245.654,-392.075"/>
<polygon fill="#000000" stroke="#000000" points="246.433,-395.491 255.632,-390.233 245.162,-388.607 246.433,-395.491"/>
</g>
<!-- getxc -->
<g id="proc~~setup_h0~~CallsGraph_node40" class="node"><title>getxc</title>
<polygon fill="#777777" stroke="#777777" points="324,-360 270,-360 270,-336 324,-336 324,-360"/>
<text text-anchor="middle" x="297" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">getxc</text>
</g>
<!-- proc~dhscf_init&#45;&gt;getxc -->
<g id="proc~~setup_h0~~CallsGraph_edge53" class="edge"><title>proc~dhscf_init&#45;&gt;getxc</title>
<path fill="none" stroke="#000000" d="M163.836,-841.553C168.205,-838.76 172.191,-835.288 175,-831 231.431,-744.861 144.41,-447.551 211,-369 222.803,-355.077 242.235,-349.595 259.541,-347.699"/>
<polygon fill="#000000" stroke="#000000" points="260.237,-351.157 269.956,-346.938 259.727,-344.176 260.237,-351.157"/>
</g>
<!-- createlocaldscfpointers -->
<g id="proc~~setup_h0~~CallsGraph_node41" class="node"><title>createlocaldscfpointers</title>
<polygon fill="#777777" stroke="#777777" points="358,-318 236,-318 236,-294 358,-294 358,-318"/>
<text text-anchor="middle" x="297" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">createlocaldscfpointers</text>
</g>
<!-- proc~dhscf_init&#45;&gt;createlocaldscfpointers -->
<g id="proc~~setup_h0~~CallsGraph_edge42" class="edge"><title>proc~dhscf_init&#45;&gt;createlocaldscfpointers</title>
<path fill="none" stroke="#000000" d="M163.858,-841.568C168.226,-838.774 172.205,-835.297 175,-831 236.228,-736.877 138.668,-412.884 211,-327 215.241,-321.964 220.48,-318.031 226.258,-314.972"/>
<polygon fill="#000000" stroke="#000000" points="227.946,-318.055 235.716,-310.852 225.15,-311.637 227.946,-318.055"/>
</g>
<!-- init_charge_add -->
<g id="proc~~setup_h0~~CallsGraph_node42" class="node"><title>init_charge_add</title>
<polygon fill="#777777" stroke="#777777" points="341.5,-276 252.5,-276 252.5,-252 341.5,-252 341.5,-276"/>
<text text-anchor="middle" x="297" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_charge_add</text>
</g>
<!-- proc~dhscf_init&#45;&gt;init_charge_add -->
<g id="proc~~setup_h0~~CallsGraph_edge43" class="edge"><title>proc~dhscf_init&#45;&gt;init_charge_add</title>
<path fill="none" stroke="#000000" d="M163.878,-841.581C168.243,-838.785 172.217,-835.304 175,-831 241.026,-728.891 132.925,-378.22 211,-285 218.93,-275.532 230.389,-269.958 242.337,-266.761"/>
<polygon fill="#000000" stroke="#000000" points="243.377,-270.118 252.422,-264.601 241.911,-263.273 243.377,-270.118"/>
</g>
<!-- neutralatomonmesh -->
<g id="proc~~setup_h0~~CallsGraph_node43" class="node"><title>neutralatomonmesh</title>
<polygon fill="#777777" stroke="#777777" points="351,-234 243,-234 243,-210 351,-210 351,-234"/>
<text text-anchor="middle" x="297" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">neutralatomonmesh</text>
</g>
<!-- proc~dhscf_init&#45;&gt;neutralatomonmesh -->
<g id="proc~~setup_h0~~CallsGraph_edge44" class="edge"><title>proc~dhscf_init&#45;&gt;neutralatomonmesh</title>
<path fill="none" stroke="#000000" d="M163.895,-841.592C168.258,-838.795 172.227,-835.311 175,-831 245.826,-720.902 127.18,-343.558 211,-243 216.799,-236.044 224.502,-231.188 232.909,-227.831"/>
<polygon fill="#000000" stroke="#000000" points="234.222,-231.084 242.637,-224.647 232.044,-224.432 234.222,-231.084"/>
</g>
<!-- interface~distmeshdata -->
<g id="proc~~setup_h0~~CallsGraph_node44" class="node"><title>interface~distmeshdata</title>
<g id="a_proc~~setup_h0~~CallsGraph_node44"><a xlink:href=".././interface/distmeshdata.html" xlink:title="distMeshData">
<polygon fill="#a7506f" stroke="#a7506f" points="336,-1276 258,-1276 258,-1252 336,-1252 336,-1276"/>
<text text-anchor="middle" x="297" y="-1261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">distMeshData</text>
</a>
</g>
</g>
<!-- proc~dhscf_init&#45;&gt;interface~distmeshdata -->
<g id="proc~~setup_h0~~CallsGraph_edge45" class="edge"><title>proc~dhscf_init&#45;&gt;interface~distmeshdata</title>
<path fill="none" stroke="#000000" d="M136.239,-864.299C140.051,-923.735 159.34,-1180.69 211,-1238 220.561,-1248.61 234.317,-1254.94 247.985,-1258.71"/>
<polygon fill="#000000" stroke="#000000" points="247.326,-1262.15 257.861,-1261.02 248.922,-1255.34 247.326,-1262.15"/>
</g>
<!-- die -->
<g id="proc~~setup_h0~~CallsGraph_node45" class="node"><title>die</title>
<polygon fill="#777777" stroke="#777777" points="625,-1057 571,-1057 571,-1033 625,-1033 625,-1057"/>
<text text-anchor="middle" x="598" y="-1042.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">die</text>
</g>
<!-- proc~dhscf_init&#45;&gt;die -->
<g id="proc~~setup_h0~~CallsGraph_edge46" class="edge"><title>proc~dhscf_init&#45;&gt;die</title>
<path fill="none" stroke="#000000" d="M136.171,-864.153C139.565,-920.605 156.858,-1156.34 211,-1200 270.509,-1247.98 310.908,-1225.43 383,-1200 402.376,-1193.17 402.607,-1183.39 419,-1171 471.912,-1131.02 535.747,-1086.77 570.788,-1062.8"/>
<polygon fill="#000000" stroke="#000000" points="572.765,-1065.69 579.052,-1057.16 568.819,-1059.91 572.765,-1065.69"/>
</g>
<!-- elecs -->
<g id="proc~~setup_h0~~CallsGraph_node46" class="node"><title>elecs</title>
<polygon fill="#777777" stroke="#777777" points="324,-192 270,-192 270,-168 324,-168 324,-192"/>
<text text-anchor="middle" x="297" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elecs</text>
</g>
<!-- proc~dhscf_init&#45;&gt;elecs -->
<g id="proc~~setup_h0~~CallsGraph_edge47" class="edge"><title>proc~dhscf_init&#45;&gt;elecs</title>
<path fill="none" stroke="#000000" d="M163.511,-841.853C168.03,-839.014 172.152,-835.447 175,-831 250.627,-712.913 121.433,-308.897 211,-201 222.658,-186.956 242.081,-181.466 259.419,-179.596"/>
<polygon fill="#000000" stroke="#000000" points="260.13,-183.055 269.857,-178.855 259.634,-176.072 260.13,-183.055"/>
</g>
<!-- fdf_get -->
<g id="proc~~setup_h0~~CallsGraph_node47" class="node"><title>fdf_get</title>
<polygon fill="#777777" stroke="#777777" points="324,-150 270,-150 270,-126 324,-126 324,-150"/>
<text text-anchor="middle" x="297" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fdf_get</text>
</g>
<!-- proc~dhscf_init&#45;&gt;fdf_get -->
<g id="proc~~setup_h0~~CallsGraph_edge48" class="edge"><title>proc~dhscf_init&#45;&gt;fdf_get</title>
<path fill="none" stroke="#000000" d="M163.524,-841.862C168.041,-839.021 172.16,-835.452 175,-831 255.428,-704.922 115.686,-274.237 211,-159 222.633,-144.935 242.054,-139.444 259.398,-137.579"/>
<polygon fill="#000000" stroke="#000000" points="260.112,-141.037 269.84,-136.841 259.618,-134.054 260.112,-141.037"/>
</g>
<!-- shaper -->
<g id="proc~~setup_h0~~CallsGraph_node48" class="node"><title>shaper</title>
<polygon fill="#777777" stroke="#777777" points="324,-108 270,-108 270,-84 324,-84 324,-108"/>
<text text-anchor="middle" x="297" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">shaper</text>
</g>
<!-- proc~dhscf_init&#45;&gt;shaper -->
<g id="proc~~setup_h0~~CallsGraph_edge49" class="edge"><title>proc~dhscf_init&#45;&gt;shaper</title>
<path fill="none" stroke="#000000" d="M163.536,-841.869C168.052,-839.028 172.167,-835.457 175,-831 217.615,-763.965 160.469,-178.289 211,-117 222.611,-102.917 242.031,-97.4248 259.379,-95.5632"/>
<polygon fill="#000000" stroke="#000000" points="260.095,-99.0216 269.825,-94.8288 259.604,-92.0388 260.095,-99.0216"/>
</g>
<!-- user_specified_field -->
<g id="proc~~setup_h0~~CallsGraph_node49" class="node"><title>user_specified_field</title>
<polygon fill="#777777" stroke="#777777" points="350.5,-66 243.5,-66 243.5,-42 350.5,-42 350.5,-66"/>
<text text-anchor="middle" x="297" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">user_specified_field</text>
</g>
<!-- proc~dhscf_init&#45;&gt;user_specified_field -->
<g id="proc~~setup_h0~~CallsGraph_edge50" class="edge"><title>proc~dhscf_init&#45;&gt;user_specified_field</title>
<path fill="none" stroke="#000000" d="M163.546,-841.875C168.061,-839.034 172.173,-835.461 175,-831 220.017,-759.968 157.595,-139.96 211,-75 216.955,-67.7567 224.975,-62.7848 233.72,-59.4103"/>
<polygon fill="#000000" stroke="#000000" points="234.949,-62.6928 243.43,-56.3436 232.841,-56.0178 234.949,-62.6928"/>
</g>
<!-- digcel -->
<g id="proc~~setup_h0~~CallsGraph_node50" class="node"><title>digcel</title>
<polygon fill="#777777" stroke="#777777" points="324,-24 270,-24 270,-0 324,-0 324,-24"/>
<text text-anchor="middle" x="297" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">digcel</text>
</g>
<!-- proc~dhscf_init&#45;&gt;digcel -->
<g id="proc~~setup_h0~~CallsGraph_edge51" class="edge"><title>proc~dhscf_init&#45;&gt;digcel</title>
<path fill="none" stroke="#000000" d="M163.555,-841.881C168.069,-839.039 172.178,-835.464 175,-831 222.418,-755.971 154.72,-101.632 211,-33 222.574,-18.886 241.991,-13.3922 259.348,-11.5372"/>
<polygon fill="#000000" stroke="#000000" points="260.068,-14.9956 269.8,-10.8079 259.58,-8.01257 260.068,-14.9956"/>
</g>
<!-- cdf_init_mesh -->
<g id="proc~~setup_h0~~CallsGraph_node51" class="node"><title>cdf_init_mesh</title>
<polygon fill="#777777" stroke="#777777" points="336.5,-1558 257.5,-1558 257.5,-1534 336.5,-1534 336.5,-1558"/>
<text text-anchor="middle" x="297" y="-1543.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cdf_init_mesh</text>
</g>
<!-- proc~dhscf_init&#45;&gt;cdf_init_mesh -->
<g id="proc~~setup_h0~~CallsGraph_edge52" class="edge"><title>proc~dhscf_init&#45;&gt;cdf_init_mesh</title>
<path fill="none" stroke="#000000" d="M136.034,-864.07C139.959,-950.48 165.494,-1473.13 211,-1525 220.107,-1535.38 233.454,-1541.04 246.885,-1544.02"/>
<polygon fill="#000000" stroke="#000000" points="246.65,-1547.53 257.104,-1545.81 247.858,-1540.63 246.65,-1547.53"/>
</g>
<!-- set_box_limits -->
<g id="proc~~setup_h0~~CallsGraph_node52" class="node"><title>set_box_limits</title>
<polygon fill="#777777" stroke="#777777" points="337,-1516 257,-1516 257,-1492 337,-1492 337,-1516"/>
<text text-anchor="middle" x="297" y="-1501.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_box_limits</text>
</g>
<!-- proc~dhscf_init&#45;&gt;set_box_limits -->
<g id="proc~~setup_h0~~CallsGraph_edge32" class="edge"><title>proc~dhscf_init&#45;&gt;set_box_limits</title>
<path fill="none" stroke="#000000" d="M136.13,-864.108C140.572,-947.481 168.255,-1434.64 211,-1483 220.065,-1493.26 233.269,-1498.89 246.58,-1501.9"/>
<polygon fill="#000000" stroke="#000000" points="246.252,-1505.39 256.712,-1503.71 247.485,-1498.5 246.252,-1505.39"/>
</g>
<!-- rhooda -->
<g id="proc~~setup_h0~~CallsGraph_node53" class="node"><title>rhooda</title>
<polygon fill="#777777" stroke="#777777" points="324,-1474 270,-1474 270,-1450 324,-1450 324,-1474"/>
<text text-anchor="middle" x="297" y="-1459.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rhooda</text>
</g>
<!-- proc~dhscf_init&#45;&gt;rhooda -->
<g id="proc~~setup_h0~~CallsGraph_edge41" class="edge"><title>proc~dhscf_init&#45;&gt;rhooda</title>
<path fill="none" stroke="#000000" d="M135.349,-864.047C134.647,-939.379 134.488,-1345.39 211,-1436 222.873,-1450.06 242.129,-1456.66 259.313,-1459.71"/>
<polygon fill="#000000" stroke="#000000" points="259.267,-1463.23 269.66,-1461.17 260.251,-1456.3 259.267,-1463.23"/>
</g>
<!-- compute_doping_structs_uniform -->
<g id="proc~~setup_h0~~CallsGraph_node54" class="node"><title>compute_doping_structs_uniform</title>
<polygon fill="#777777" stroke="#777777" points="383,-1356 211,-1356 211,-1332 383,-1332 383,-1356"/>
<text text-anchor="middle" x="297" y="-1341.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_doping_structs_uniform</text>
</g>
<!-- proc~dhscf_init&#45;&gt;compute_doping_structs_uniform -->
<g id="proc~~setup_h0~~CallsGraph_edge54" class="edge"><title>proc~dhscf_init&#45;&gt;compute_doping_structs_uniform</title>
<path fill="none" stroke="#000000" d="M135.784,-864.098C137.574,-930.196 149.314,-1247.28 211,-1318 213.853,-1321.27 217.105,-1324.14 220.634,-1326.65"/>
<polygon fill="#000000" stroke="#000000" points="218.943,-1329.71 229.314,-1331.88 222.559,-1323.72 218.943,-1329.71"/>
</g>
<!-- meshlim -->
<g id="proc~~setup_h0~~CallsGraph_node55" class="node"><title>meshlim</title>
<polygon fill="#777777" stroke="#777777" points="496,-822 442,-822 442,-798 496,-798 496,-822"/>
<text text-anchor="middle" x="469" y="-807.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">meshlim</text>
</g>
<!-- proc~setmeshdistr&#45;&gt;meshlim -->
<g id="proc~~setup_h0~~CallsGraph_edge56" class="edge"><title>proc~setmeshdistr&#45;&gt;meshlim</title>
<path fill="none" stroke="#000000" d="M334.887,-810C363.549,-810 403.093,-810 431.624,-810"/>
<polygon fill="#000000" stroke="#000000" points="431.974,-813.5 441.974,-810 431.974,-806.5 431.974,-813.5"/>
</g>
<!-- proc~reord&#45;&gt;timer -->
<g id="proc~~setup_h0~~CallsGraph_edge59" class="edge"><title>proc~reord&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M619.893,-1419.12C626.755,-1423.31 634.329,-1428.18 641,-1433 655.244,-1443.3 670.375,-1455.95 682.124,-1466.2"/>
<polygon fill="#000000" stroke="#000000" points="679.85,-1468.86 689.665,-1472.85 684.48,-1463.61 679.85,-1468.86"/>
</g>
<!-- proc~reord&#45;&gt;re_alloc -->
<g id="proc~~setup_h0~~CallsGraph_edge57" class="edge"><title>proc~reord&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M625.244,-1401.95C637.807,-1399.54 653.054,-1396.61 666.706,-1393.98"/>
<polygon fill="#000000" stroke="#000000" points="667.606,-1397.37 676.765,-1392.05 666.284,-1390.5 667.606,-1397.37"/>
</g>
<!-- proc~reord&#45;&gt;de_alloc -->
<g id="proc~~setup_h0~~CallsGraph_edge58" class="edge"><title>proc~reord&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M609.622,-1394.64C618.995,-1383.2 632.459,-1365.38 641,-1348 671.764,-1285.41 690.827,-1204.46 698.749,-1166.07"/>
<polygon fill="#000000" stroke="#000000" points="702.233,-1166.5 700.77,-1156 695.37,-1165.12 702.233,-1166.5"/>
</g>
<!-- proc~distmeshdata_rea -->
<g id="proc~~setup_h0~~CallsGraph_node56" class="node"><title>proc~distmeshdata_rea</title>
<g id="a_proc~~setup_h0~~CallsGraph_node56"><a xlink:href=".././proc/distmeshdata_rea.html" xlink:title="distMeshData_rea">
<polygon fill="#d9534f" stroke="#d9534f" points="519,-1276 419,-1276 419,-1252 519,-1252 519,-1276"/>
<text text-anchor="middle" x="469" y="-1261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">distMeshData_rea</text>
</a>
</g>
</g>
<!-- interface~distmeshdata&#45;&gt;proc~distmeshdata_rea -->
<g id="proc~~setup_h0~~CallsGraph_edge60" class="edge"><title>interface~distmeshdata&#45;&gt;proc~distmeshdata_rea</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M336.151,-1264C357.566,-1264 384.749,-1264 408.863,-1264"/>
<polygon fill="#000000" stroke="#000000" points="408.984,-1267.5 418.984,-1264 408.984,-1260.5 408.984,-1267.5"/>
</g>
<!-- proc~distmeshdata_int -->
<g id="proc~~setup_h0~~CallsGraph_node57" class="node"><title>proc~distmeshdata_int</title>
<g id="a_proc~~setup_h0~~CallsGraph_node57"><a xlink:href=".././proc/distmeshdata_int.html" xlink:title="distMeshData_int">
<polygon fill="#d9534f" stroke="#d9534f" points="516.5,-1204 421.5,-1204 421.5,-1180 516.5,-1180 516.5,-1204"/>
<text text-anchor="middle" x="469" y="-1189.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">distMeshData_int</text>
</a>
</g>
</g>
<!-- interface~distmeshdata&#45;&gt;proc~distmeshdata_int -->
<g id="proc~~setup_h0~~CallsGraph_edge61" class="edge"><title>interface~distmeshdata&#45;&gt;proc~distmeshdata_int</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M336.231,-1254.06C351.068,-1249.76 368.053,-1244.26 383,-1238 402.408,-1229.88 423.196,-1218.67 439.356,-1209.36"/>
<polygon fill="#000000" stroke="#000000" points="441.428,-1212.2 448.291,-1204.13 437.892,-1206.16 441.428,-1212.2"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;timer -->
<g id="proc~~setup_h0~~CallsGraph_edge67" class="edge"><title>proc~distmeshdata_rea&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M473.063,-1276.15C481.222,-1306.13 506.255,-1384.37 555,-1428 586.748,-1456.42 634.195,-1471.31 666.759,-1478.64"/>
<polygon fill="#000000" stroke="#000000" points="666.262,-1482.11 676.77,-1480.76 667.714,-1475.27 666.262,-1482.11"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;write_debug -->
<g id="proc~~setup_h0~~CallsGraph_edge70" class="edge"><title>proc~distmeshdata_rea&#45;&gt;write_debug</title>
<path fill="none" stroke="#000000" d="M474.823,-1276.23C493.84,-1324.45 563.783,-1501.78 588.377,-1564.14"/>
<polygon fill="#000000" stroke="#000000" points="585.247,-1565.74 592.172,-1573.76 591.759,-1563.17 585.247,-1565.74"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;re_alloc -->
<g id="proc~~setup_h0~~CallsGraph_edge65" class="edge"><title>proc~distmeshdata_rea&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M498.887,-1276.1C505.956,-1279.89 513.16,-1284.54 519,-1290 541.167,-1310.72 530.601,-1329.97 555,-1348 587.829,-1372.26 634.558,-1381.45 666.679,-1384.92"/>
<polygon fill="#000000" stroke="#000000" points="666.687,-1388.43 676.971,-1385.89 667.344,-1381.47 666.687,-1388.43"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;de_alloc -->
<g id="proc~~setup_h0~~CallsGraph_edge69" class="edge"><title>proc~distmeshdata_rea&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M493.683,-1251.96C510.662,-1243.41 534.126,-1231.76 555,-1222 592.851,-1204.3 604.219,-1203.83 641,-1184 653.366,-1177.33 666.517,-1169.04 677.51,-1161.73"/>
<polygon fill="#000000" stroke="#000000" points="679.474,-1164.63 685.807,-1156.13 675.559,-1158.82 679.474,-1164.63"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;proc~reord -->
<g id="proc~~setup_h0~~CallsGraph_edge64" class="edge"><title>proc~distmeshdata_rea&#45;&gt;proc~reord</title>
<path fill="none" stroke="#000000" d="M500.861,-1276.11C507.486,-1279.8 513.992,-1284.4 519,-1290 548,-1322.42 527.093,-1347.64 555,-1381 557.397,-1383.87 560.194,-1386.51 563.186,-1388.92"/>
<polygon fill="#000000" stroke="#000000" points="561.24,-1391.83 571.42,-1394.77 565.293,-1386.13 561.24,-1391.83"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;die -->
<g id="proc~~setup_h0~~CallsGraph_edge71" class="edge"><title>proc~distmeshdata_rea&#45;&gt;die</title>
<path fill="none" stroke="#000000" d="M484.197,-1251.64C494.76,-1241.91 509.016,-1227.59 519,-1213 527.889,-1200.01 568.81,-1108.61 587.564,-1066.34"/>
<polygon fill="#000000" stroke="#000000" points="590.768,-1067.75 591.619,-1057.19 584.368,-1064.92 590.768,-1067.75"/>
</g>
<!-- mpitrace_event -->
<g id="proc~~setup_h0~~CallsGraph_node58" class="node"><title>mpitrace_event</title>
<polygon fill="#777777" stroke="#777777" points="641,-1297 555,-1297 555,-1273 641,-1273 641,-1297"/>
<text text-anchor="middle" x="598" y="-1282.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpitrace_event</text>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;mpitrace_event -->
<g id="proc~~setup_h0~~CallsGraph_edge62" class="edge"><title>proc~distmeshdata_rea&#45;&gt;mpitrace_event</title>
<path fill="none" stroke="#000000" d="M519.102,-1272.12C527.438,-1273.5 536.125,-1274.93 544.544,-1276.33"/>
<polygon fill="#000000" stroke="#000000" points="544.202,-1279.82 554.639,-1278 545.344,-1272.91 544.202,-1279.82"/>
</g>
<!-- nmeshg -->
<g id="proc~~setup_h0~~CallsGraph_node59" class="node"><title>nmeshg</title>
<polygon fill="#777777" stroke="#777777" points="625,-1255 571,-1255 571,-1231 625,-1231 625,-1255"/>
<text text-anchor="middle" x="598" y="-1240.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nmeshg</text>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;nmeshg -->
<g id="proc~~setup_h0~~CallsGraph_edge63" class="edge"><title>proc~distmeshdata_rea&#45;&gt;nmeshg</title>
<path fill="none" stroke="#000000" d="M519.102,-1255.88C532.981,-1253.59 547.829,-1251.13 560.8,-1248.99"/>
<polygon fill="#000000" stroke="#000000" points="561.451,-1252.43 570.746,-1247.34 560.309,-1245.52 561.451,-1252.43"/>
</g>
<!-- proc~boxintersection -->
<g id="proc~~setup_h0~~CallsGraph_node60" class="node"><title>proc~boxintersection</title>
<g id="a_proc~~setup_h0~~CallsGraph_node60"><a xlink:href=".././proc/boxintersection.html" xlink:title="boxIntersection">
<polygon fill="#d9534f" stroke="#d9534f" points="640.5,-1175 555.5,-1175 555.5,-1151 640.5,-1151 640.5,-1175"/>
<text text-anchor="middle" x="598" y="-1160.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">boxIntersection</text>
</a>
</g>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;proc~boxintersection -->
<g id="proc~~setup_h0~~CallsGraph_edge66" class="edge"><title>proc~distmeshdata_rea&#45;&gt;proc~boxintersection</title>
<path fill="none" stroke="#000000" d="M482.391,-1251.86C498.456,-1236.41 527.664,-1209.3 555,-1189 558.925,-1186.09 563.184,-1183.18 567.434,-1180.42"/>
<polygon fill="#000000" stroke="#000000" points="569.429,-1183.31 576.035,-1175.02 565.705,-1177.38 569.429,-1183.31"/>
</g>
<!-- mpi_barrier -->
<g id="proc~~setup_h0~~CallsGraph_node61" class="node"><title>mpi_barrier</title>
<polygon fill="#777777" stroke="#777777" points="631.5,-1339 564.5,-1339 564.5,-1315 631.5,-1315 631.5,-1339"/>
<text text-anchor="middle" x="598" y="-1324.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_barrier</text>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;mpi_barrier -->
<g id="proc~~setup_h0~~CallsGraph_edge68" class="edge"><title>proc~distmeshdata_rea&#45;&gt;mpi_barrier</title>
<path fill="none" stroke="#000000" d="M494.487,-1276.15C514.077,-1285.86 541.755,-1299.59 563.414,-1310.34"/>
<polygon fill="#000000" stroke="#000000" points="562.075,-1313.58 572.588,-1314.89 565.185,-1307.31 562.075,-1313.58"/>
</g>
<!-- proc~distmeshdata_int&#45;&gt;re_alloc -->
<g id="proc~~setup_h0~~CallsGraph_edge75" class="edge"><title>proc~distmeshdata_int&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M494.192,-1179.78C502.185,-1175.58 511.061,-1170.74 519,-1166 535.514,-1156.15 536.595,-1147.57 555,-1142 591.582,-1130.92 610.839,-1118.52 641,-1142 676.467,-1169.61 694.876,-1309.96 700.814,-1364.9"/>
<polygon fill="#000000" stroke="#000000" points="697.346,-1365.39 701.865,-1374.98 704.308,-1364.67 697.346,-1365.39"/>
</g>
<!-- proc~distmeshdata_int&#45;&gt;de_alloc -->
<g id="proc~~setup_h0~~CallsGraph_edge74" class="edge"><title>proc~distmeshdata_int&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M498.857,-1179.87C505.927,-1176.08 513.139,-1171.43 519,-1166 540.971,-1145.63 528.759,-1123.46 555,-1109 588.474,-1090.55 604.033,-1099.29 641,-1109 654.169,-1112.46 667.484,-1119.42 678.382,-1126.23"/>
<polygon fill="#000000" stroke="#000000" points="676.632,-1129.27 686.911,-1131.84 680.476,-1123.42 676.632,-1129.27"/>
</g>
<!-- proc~distmeshdata_int&#45;&gt;die -->
<g id="proc~~setup_h0~~CallsGraph_edge72" class="edge"><title>proc~distmeshdata_int&#45;&gt;die</title>
<path fill="none" stroke="#000000" d="M500.92,-1179.94C507.543,-1176.25 514.032,-1171.63 519,-1166 548.861,-1132.13 526.281,-1105.84 555,-1071 557.376,-1068.12 560.16,-1065.46 563.143,-1063.04"/>
<polygon fill="#000000" stroke="#000000" points="565.251,-1065.84 571.366,-1057.19 561.19,-1060.14 565.251,-1065.84"/>
</g>
<!-- proc~distmeshdata_int&#45;&gt;proc~boxintersection -->
<g id="proc~~setup_h0~~CallsGraph_edge73" class="edge"><title>proc~distmeshdata_int&#45;&gt;proc~boxintersection</title>
<path fill="none" stroke="#000000" d="M516.569,-1181.37C526.026,-1179.21 536.024,-1176.92 545.637,-1174.73"/>
<polygon fill="#000000" stroke="#000000" points="546.506,-1178.12 555.476,-1172.48 544.948,-1171.3 546.506,-1178.12"/>
</g>
</g>
</svg>
</div><script>var panprocsetup_h0CallsGraph = svgPanZoom('#procsetup_h0CallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,-0 209.5,-0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.5,-24 454.5,-24 454.5,-0 551.5,-0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/setup_h0.html#src">setup_H0</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>      <span class="k">subroutine </span><span class="n">setup_H0</span><span class="p">(</span><span class="n">G2max</span><span class="p">)</span>
      
<span class="n">C</span>     <span class="n">Computes</span> <span class="n">non</span><span class="o">-</span><span class="n">self</span><span class="o">-</span><span class="n">consistent</span> <span class="n">part</span> <span class="n">of</span> <span class="n">the</span> <span class="n">Hamiltonian</span>
<span class="n">C</span>     <span class="nb">and </span><span class="n">initializes</span> <span class="k">data </span><span class="n">structures</span> <span class="n">on</span> <span class="n">the</span> <span class="n">grid</span><span class="p">.</span>
      
      <span class="k">USE </span><span class="n">siesta_options</span><span class="p">,</span>  <span class="n">only</span><span class="p">:</span> <span class="n">g2cut</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">H_kin_1D</span><span class="p">,</span> <span class="n">H_vkb_1D</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">H_so_on_2D</span><span class="p">,</span> <span class="n">H_so_off_2D</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">Dscf</span>

      <span class="k">use </span><span class="n">m_nlefsm</span><span class="p">,</span>        <span class="n">only</span><span class="p">:</span> <span class="n">nlefsm_SO_off</span>
      <span class="k">use </span><span class="n">m_spin</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">spin</span>

      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">listh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">maxnh</span>
      <span class="k">use </span><span class="n">siesta_geom</span>
      <span class="k">use </span><span class="n">atmfuncs</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">uion</span>
      <span class="k">use </span><span class="n">atomlist</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">iaorb</span><span class="p">,</span> <span class="n">iphkb</span><span class="p">,</span> <span class="n">indxuo</span><span class="p">,</span> <span class="n">datm</span><span class="p">,</span> 
     <span class="p">&amp;</span>                    <span class="n">lastkb</span><span class="p">,</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">rmaxv</span><span class="p">,</span> <span class="n">indxua</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span>
     <span class="p">&amp;</span>                    <span class="n">rmaxo</span><span class="p">,</span> <span class="n">no_l</span>
      <span class="k">use </span><span class="n">metaforce</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">lMetaForce</span><span class="p">,</span> <span class="n">meta</span>
      <span class="k">use </span><span class="n">molecularmechanics</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">twobody</span>
      <span class="k">use </span><span class="n">m_nlefsm</span><span class="p">,</span>     <span class="n">only</span><span class="p">:</span> <span class="n">nlefsm</span>
      <span class="k">use </span><span class="n">m_kinefsm</span><span class="p">,</span>    <span class="n">only</span><span class="p">:</span> <span class="n">kinefsm</span>
      <span class="k">use </span><span class="n">m_naefs</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">naefs</span>
      <span class="k">use </span><span class="n">m_dnaefs</span><span class="p">,</span>     <span class="n">only</span><span class="p">:</span> <span class="n">dnaefs</span>
      <span class="k">use </span><span class="n">m_dhscf</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">dhscf_init</span>
      <span class="k">use </span><span class="n">m_energies</span><span class="p">,</span>   <span class="n">only</span><span class="p">:</span> <span class="n">Eions</span><span class="p">,</span> <span class="n">Ena</span><span class="p">,</span> <span class="n">DEna</span><span class="p">,</span> <span class="n">Emm</span><span class="p">,</span> <span class="n">Emeta</span><span class="p">,</span> <span class="n">Eso</span>
      <span class="k">use </span><span class="n">m_ntm</span>
      <span class="k">use </span><span class="n">m_spin</span><span class="p">,</span>       <span class="n">only</span><span class="p">:</span> <span class="n">spin</span>
      <span class="k">use </span><span class="n">spinorbit</span><span class="p">,</span>    <span class="n">only</span><span class="p">:</span> <span class="n">spinorb</span>
      <span class="k">use </span><span class="n">alloc</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">re_alloc</span><span class="p">,</span> <span class="n">de_alloc</span>
      <span class="k">use </span><span class="n">class_dSpData1D</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">val</span>
      <span class="k">use </span><span class="n">class_dSpData2D</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">val</span>
      <span class="k">use </span><span class="n">class_zSpData2D</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">val</span>

<span class="cp">#ifdef MPI</span>
      <span class="k">use </span><span class="n">m_mpi_utils</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">globalize_sum</span>
<span class="cp">#endif</span>

      <span class="k">implicit none</span>
<span class="k">      </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">g2max</span>
      
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dummy_stress</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">dummy_fa</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">dummy_dm</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dummy_E</span>
      <span class="kt">integer</span>  <span class="kd">::</span> <span class="n">ia</span><span class="p">,</span> <span class="k">is</span>

<span class="k">      </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">dummy_Eso</span>
      <span class="kt">integer</span>     <span class="kd">::</span> <span class="n">ispin</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> 
      <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Dc</span>
<span class="cp">#ifdef MPI</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">buffer1</span>
<span class="cp">#endif</span>

      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">H_val</span><span class="p">(:),</span> <span class="n">H_so_on</span><span class="p">(:,:)</span>
      <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">H_so_off</span><span class="p">(:,:)</span>


<span class="cp">#ifdef DEBUG</span>
      <span class="k">call </span><span class="n">write_debug</span><span class="p">(</span> <span class="s1">&#39;    PRE setup_H0&#39;</span> <span class="p">)</span>
<span class="cp">#endif</span>

<span class="c">!----------------------------------------------------------------------BEGIN</span>
      <span class="k">call </span><span class="n">timer</span><span class="p">(</span><span class="s1">&#39;Setup_H0&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">C</span>     <span class="n">Self</span><span class="o">-</span><span class="n">energy</span> <span class="n">of</span> <span class="n">isolated</span> <span class="n">ions</span>
      <span class="n">Eions</span> <span class="o">=</span> <span class="mf">0.0_dp</span>
      <span class="k">do </span><span class="n">ia</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">na_u</span>
        <span class="k">is</span> <span class="o">=</span> <span class="n">isa</span><span class="p">(</span><span class="n">ia</span><span class="p">)</span>
        <span class="n">Eions</span> <span class="o">=</span> <span class="n">Eions</span> <span class="o">+</span> <span class="n">uion</span><span class="p">(</span><span class="k">is</span><span class="p">)</span>
      <span class="n">enddo</span>

<span class="c">!     In these routines, add a flag to tell them NOT to compute</span>
<span class="c">!     forces and stresses in this first pass, only energies.</span>

<span class="c">!     Neutral-atom: energy</span>

      <span class="k">call </span><span class="n">naefs</span><span class="p">(</span><span class="n">na_u</span><span class="p">,</span> <span class="n">na_s</span><span class="p">,</span> <span class="n">scell</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">indxua</span><span class="p">,</span> <span class="n">rmaxv</span><span class="p">,</span>
     <span class="p">&amp;</span>           <span class="n">isa</span><span class="p">,</span> <span class="n">Ena</span><span class="p">,</span> <span class="n">dummy_fa</span><span class="p">,</span> <span class="n">dummy_stress</span><span class="p">,</span>
     <span class="p">&amp;</span>           <span class="n">forces_and_stress</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.)</span>
      <span class="k">call </span><span class="n">dnaefs</span><span class="p">(</span><span class="n">na_u</span><span class="p">,</span> <span class="n">na_s</span><span class="p">,</span> <span class="n">scell</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">indxua</span><span class="p">,</span> <span class="n">rmaxv</span><span class="p">,</span>
     <span class="p">&amp;</span>            <span class="n">isa</span><span class="p">,</span> <span class="n">DEna</span><span class="p">,</span> <span class="n">dummy_fa</span><span class="p">,</span> <span class="n">dummy_stress</span><span class="p">,</span>
     <span class="p">&amp;</span>            <span class="n">forces_and_stress</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.)</span> 
      <span class="n">Ena</span> <span class="o">=</span> <span class="n">Ena</span> <span class="o">+</span> <span class="n">DEna</span>
 
<span class="n">C</span>     <span class="n">Metadynamics</span> <span class="n">energy</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">lMetaForce</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">meta</span><span class="p">(</span><span class="n">xa</span><span class="p">,</span><span class="n">na_u</span><span class="p">,</span><span class="n">ucell</span><span class="p">,</span><span class="n">Emeta</span><span class="p">,</span><span class="n">dummy_fa</span><span class="p">,</span><span class="n">dummy_stress</span><span class="p">,</span>
     <span class="err">$</span>           <span class="p">.</span><span class="n">false</span><span class="p">.,.</span><span class="n">false</span><span class="p">.)</span>
      <span class="n">endif</span>

<span class="n">C</span>     <span class="n">Add</span> <span class="n">on</span> <span class="n">force</span> <span class="n">field</span> <span class="n">contribution</span> <span class="n">to</span> <span class="n">energy</span>
      <span class="k">call </span><span class="n">twobody</span><span class="p">(</span> <span class="n">na_u</span><span class="p">,</span><span class="n">xa</span><span class="p">,</span><span class="n">isa</span><span class="p">,</span><span class="n">ucell</span><span class="p">,</span><span class="n">Emm</span><span class="p">,</span>
     <span class="p">&amp;</span>              <span class="n">ifa</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">fa</span><span class="o">=</span><span class="n">dummy_fa</span><span class="p">,</span><span class="n">istr</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">stress</span><span class="o">=</span><span class="n">dummy_stress</span><span class="p">)</span>

<span class="c">!</span>
<span class="c">!     Now we compute matrix elements of the Kinetic and Non-local</span>
<span class="c">!     parts of H</span>

<span class="c">!     Kinetic: matrix elements only</span>
      <span class="n">H_val</span> <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">H_kin_1D</span><span class="p">)</span>
<span class="c">!$OMP parallel workshare default(shared)</span>
      <span class="n">H_val</span><span class="p">(:)</span> <span class="o">=</span> <span class="mf">0.0_dp</span>
<span class="c">!$OMP end parallel workshare</span>
      <span class="k">call </span><span class="n">kinefsm</span><span class="p">(</span><span class="n">na_u</span><span class="p">,</span> <span class="n">na_s</span><span class="p">,</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">scell</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">indxua</span><span class="p">,</span> <span class="n">rmaxo</span><span class="p">,</span>
     <span class="p">&amp;</span>             <span class="n">maxnh</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span> <span class="n">isa</span><span class="p">,</span> 
     <span class="p">&amp;</span>             <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> 
     <span class="p">&amp;</span>             <span class="mi">1</span><span class="p">,</span>
     <span class="p">&amp;</span>             <span class="n">dummy_dm</span><span class="p">,</span> <span class="n">dummy_E</span><span class="p">,</span> <span class="n">dummy_fa</span><span class="p">,</span> <span class="n">dummy_stress</span><span class="p">,</span>
     <span class="p">&amp;</span>             <span class="n">H_val</span><span class="p">,</span>
     <span class="p">&amp;</span>             <span class="n">matrix_elements_only</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span> 

<span class="c">!     Non-local-pseudop:  matrix elements only</span>
      <span class="n">H_val</span> <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">H_vkb_1D</span><span class="p">)</span>
<span class="c">!$OMP parallel workshare default(shared)</span>
      <span class="n">H_val</span><span class="p">(:)</span> <span class="o">=</span> <span class="mf">0.0_dp</span>
<span class="c">!$OMP end parallel workshare</span>

      <span class="n">Eso</span> <span class="o">=</span> <span class="mf">0.0d0</span>

      <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="n">spin</span><span class="p">%</span><span class="n">SO_offsite</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">       call </span><span class="n">nlefsm</span><span class="p">(</span><span class="n">scell</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">na_s</span><span class="p">,</span> <span class="n">isa</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">indxua</span><span class="p">,</span> 
     <span class="p">&amp;</span>             <span class="n">maxnh</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span> <span class="n">lastkb</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span> <span class="n">iphKB</span><span class="p">,</span> 
     <span class="p">&amp;</span>             <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> 
     <span class="p">&amp;</span>             <span class="mi">1</span><span class="p">,</span>
     <span class="p">&amp;</span>             <span class="n">dummy_dm</span><span class="p">,</span> <span class="n">dummy_E</span><span class="p">,</span> <span class="n">dummy_fa</span><span class="p">,</span> <span class="n">dummy_stress</span><span class="p">,</span>
     <span class="p">&amp;</span>             <span class="n">H_val</span><span class="p">,</span>
     <span class="p">&amp;</span>             <span class="n">matrix_elements_only</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span> 
      <span class="k">else</span>
<span class="k">        </span><span class="n">H_so_off</span> <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">H_so_off_2D</span><span class="p">)</span>
        <span class="n">H_so_off</span> <span class="o">=</span> <span class="n">dcmplx</span><span class="p">(</span><span class="mf">0._dp</span><span class="p">,</span> <span class="mf">0._dp</span><span class="p">)</span>
        <span class="k">call </span><span class="n">nlefsm_SO_off</span><span class="p">(</span><span class="n">scell</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">na_s</span><span class="p">,</span> <span class="n">isa</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">indxua</span><span class="p">,</span>
     <span class="p">&amp;</span>                 <span class="n">maxnh</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span> <span class="n">lastkb</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span> <span class="n">iphKB</span><span class="p">,</span>
     <span class="p">&amp;</span>                 <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span>
     <span class="p">&amp;</span>                 <span class="n">spin</span><span class="p">%</span><span class="n">Grid</span><span class="p">,</span>
     <span class="p">&amp;</span>                 <span class="n">dummy_E</span><span class="p">,</span> <span class="n">dummy_Eso</span><span class="p">,</span> <span class="n">dummy_fa</span><span class="p">,</span>
     <span class="p">&amp;</span>                 <span class="n">dummy_stress</span><span class="p">,</span> <span class="n">H_val</span><span class="p">,</span> <span class="n">H_so_off</span><span class="p">,</span>
     <span class="p">&amp;</span>                 <span class="n">matrix_elements_only</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>


<span class="c">!</span>
<span class="c">!  Dc IS NOT the dense matrix, it is just a complex number </span>
<span class="c">! (per each io index) used as an artifact to multiply the </span>
<span class="c">! elements of the H_SO times the corresponding elements of </span>
<span class="c">! DM in a such way that the result gives Re{Tr[H_SO*DM]}.</span>
<span class="c">!</span>

        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">maxnh</span>

<span class="c">!-------- Eso(u,u)</span>
          <span class="n">Dc</span> <span class="o">=</span> <span class="nb">cmplx</span><span class="p">(</span><span class="n">Dscf</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">Dscf</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">dp</span><span class="p">)</span>
          <span class="n">Eso</span> <span class="o">=</span> <span class="n">Eso</span> <span class="o">+</span> <span class="kt">real</span><span class="p">(</span> <span class="n">H_so_off</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Dc</span><span class="p">,</span> <span class="n">dp</span><span class="p">)</span>
<span class="c">!-------- Eso(d,d)</span>
          <span class="n">Dc</span> <span class="o">=</span> <span class="nb">cmplx</span><span class="p">(</span><span class="n">Dscf</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">Dscf</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="n">dp</span><span class="p">)</span>
          <span class="n">Eso</span> <span class="o">=</span> <span class="n">Eso</span> <span class="o">+</span> <span class="kt">real</span><span class="p">(</span> <span class="n">H_so_off</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">Dc</span><span class="p">,</span> <span class="n">dp</span><span class="p">)</span>
<span class="c">!-------- Eso(u,d)</span>
          <span class="n">Dc</span> <span class="o">=</span> <span class="nb">cmplx</span><span class="p">(</span><span class="n">Dscf</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">Dscf</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">dp</span><span class="p">)</span>
          <span class="n">Eso</span> <span class="o">=</span> <span class="n">Eso</span> <span class="o">+</span> <span class="kt">real</span><span class="p">(</span> <span class="n">H_so_off</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">Dc</span><span class="p">,</span> <span class="n">dp</span><span class="p">)</span>
<span class="c">!-------- Eso(d,u)</span>
          <span class="n">Dc</span> <span class="o">=</span> <span class="nb">cmplx</span><span class="p">(</span><span class="n">Dscf</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span><span class="o">-</span><span class="n">Dscf</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="n">dp</span><span class="p">)</span>
          <span class="n">Eso</span> <span class="o">=</span> <span class="n">Eso</span> <span class="o">+</span> <span class="kt">real</span><span class="p">(</span> <span class="n">H_so_off</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">Dc</span><span class="p">,</span> <span class="n">dp</span><span class="p">)</span>

        <span class="n">enddo</span>

<span class="cp">#ifdef MPI</span>
<span class="c">! Global reduction of Eso </span>
      <span class="k">call </span><span class="n">globalize_sum</span><span class="p">(</span><span class="n">Eso</span><span class="p">,</span><span class="n">buffer1</span><span class="p">)</span>
      <span class="n">Eso</span> <span class="o">=</span> <span class="n">buffer1</span>
<span class="cp">#endif</span>
      <span class="n">endif</span>
<span class="c">! ..................</span>

<span class="c">! If in the future the spin-orbit routine is able to compute</span>
<span class="c">! forces and stresses, then &quot;last&quot; will be needed. If we are not</span>
<span class="c">! computing forces and stresses, calling it in the first iteration</span>
<span class="c">! should be enough</span>
<span class="c">!</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">spin</span><span class="p">%</span><span class="n">SO_onsite</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">         </span><span class="n">H_so_on</span> <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">H_so_on_2D</span><span class="p">)</span>
<span class="c">!$OMP parallel workshare default(shared)</span>
         <span class="n">H_so_on</span><span class="p">(:,:)</span> <span class="o">=</span> <span class="mf">0._dp</span>
<span class="c">!$OMP end parallel workshare</span>
         <span class="k">call </span><span class="n">spinorb</span><span class="p">(</span><span class="n">no_u</span><span class="p">,</span><span class="n">no_l</span><span class="p">,</span><span class="n">iaorb</span><span class="p">,</span><span class="n">iphorb</span><span class="p">,</span><span class="n">isa</span><span class="p">,</span><span class="n">indxuo</span><span class="p">,</span>
     <span class="p">&amp;</span>        <span class="n">maxnh</span><span class="p">,</span><span class="n">numh</span><span class="p">,</span><span class="n">listhptr</span><span class="p">,</span><span class="n">listh</span><span class="p">,</span><span class="n">Dscf</span><span class="p">,</span><span class="n">H_so_on</span><span class="p">,</span><span class="n">Eso</span><span class="p">)</span>
      <span class="k">end if</span>

<span class="n">C</span>     <span class="n">This</span> <span class="n">will</span> <span class="n">take</span> <span class="n">care</span> <span class="n">of</span> <span class="n">possible</span> <span class="n">changes</span> <span class="n">to</span> <span class="n">the</span> <span class="n">mesh</span> <span class="nb">and </span><span class="n">atomic</span><span class="o">-</span><span class="n">related</span>
<span class="n">C</span>     <span class="n">mesh</span> <span class="n">structures</span> <span class="n">for</span> <span class="n">geometry</span> <span class="n">changes</span>
      <span class="n">g2max</span> <span class="o">=</span> <span class="n">g2cut</span>
      <span class="k">call </span><span class="n">dhscf_init</span><span class="p">(</span> <span class="n">spin</span><span class="p">%</span><span class="n">Grid</span><span class="p">,</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">iaorb</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span>
     <span class="p">&amp;</span>                 <span class="n">no_l</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">na_s</span><span class="p">,</span>
     <span class="p">&amp;</span>                 <span class="n">isa</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">indxua</span><span class="p">,</span> <span class="n">ucell</span><span class="p">,</span>
     <span class="p">&amp;</span>                 <span class="n">mscell</span><span class="p">,</span> <span class="n">G2max</span><span class="p">,</span> <span class="n">ntm</span><span class="p">,</span>
     <span class="p">&amp;</span>                 <span class="n">maxnh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">datm</span><span class="p">,</span>
     <span class="p">&amp;</span>                 <span class="n">dummy_fa</span><span class="p">,</span> <span class="n">dummy_stress</span><span class="p">)</span>

      <span class="k">call </span><span class="n">timer</span><span class="p">(</span><span class="s1">&#39;Setup_H0&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

<span class="cp">#ifdef DEBUG</span>
      <span class="k">call </span><span class="n">write_debug</span><span class="p">(</span> <span class="s1">&#39;    POS setup_H0&#39;</span> <span class="p">)</span>
<span class="cp">#endif</span>

<span class="c">!---------------------------------------------------------------------- END</span>
      <span class="k">END subroutine </span><span class="n">setup_H0</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2018 <a rel="license" href="http://www.gnu.org/licenses/old-licenses/fdl-1.2.en.html">GNU Free Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> SIESTA was developed by SIESTA Group</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>