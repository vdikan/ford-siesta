<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="A first-principles materials simulation code using Density Functional Theory.">
    
    <meta name="author" content="SIESTA Group" >
    <link rel="icon" href="../favicon.png">

    <title>setup_H0 &ndash; SIESTA</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">SIESTA <small>trunk-674--vdikan-ford-681</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>Program Overview</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>setup_H0
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 1.2% of total for procedures.">62 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/setup_H0.F"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/setup_h0.f.html'>setup_H0.F</a></li>
    
     <li><a href='../module/m_setup_h0.html'>m_setup_H0</a></li>
    
  
     <li class="active">setup_H0</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/setup_h0.html#src">setup_H0</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine setup_H0(g2max)
    
    
   
</h2>
    
  
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
      
      <li class="list-group-item">
  <ul class="list-inline">
    
    <li>siesta_options</li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>siesta_geom</li>
    
    <li>atmfuncs</li>
    
    <li>atomlist</li>
    
    <li>metaforce</li>
    
    <li>molecularmechanics</li>
    
    <li>m_nlefsm</li>
    
    <li>m_kinefsm</li>
    
    <li>m_naefs</li>
    
    <li>m_dnaefs</li>
    
    <li>m_dhscf</li>
    
    <li>m_energies</li>
    
    <li>m_ntm</li>
    
    <li>m_spin</li>
    
    <li>spinorbit</li>
    
    <li>alloc</li>
    
    <li>class_dSpData1D</li>
    
    <li>class_dSpData2D</li>
    
    <li>m_mpi_utils</li>
    
  </ul>
      </li>
      
      
      
      <li class="list-group-item">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: proc~~setup_h0~~UsesGraph Pages: 1 -->
<svg id="procsetup_h0UsesGraph" width="212pt" height="830pt"
 viewBox="0.00 0.00 212.00 830.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~setup_h0~~UsesGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 826)">
<title>proc~~setup_h0~~UsesGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-826 208,-826 208,4 -4,4"/>
<!-- proc~setup_h0 -->
<g id="proc~~setup_h0~~UsesGraph_node1" class="node">
<title>proc~setup_h0</title>
<polygon fill="none" stroke="#000000" points="204,-423 146,-423 146,-399 204,-399 204,-423"/>
<text text-anchor="middle" x="175" y="-408.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">setup_H0</text>
</g>
<!-- m_naefs -->
<g id="proc~~setup_h0~~UsesGraph_node2" class="node">
<title>m_naefs</title>
<polygon fill="#337ab7" stroke="#337ab7" points="82,-822 28,-822 28,-798 82,-798 82,-822"/>
<text text-anchor="middle" x="55" y="-807.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_naefs</text>
</g>
<!-- proc~setup_h0&#45;&gt;m_naefs -->
<g id="proc~~setup_h0~~UsesGraph_edge1" class="edge">
<title>proc~setup_h0&#45;&gt;m_naefs</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M174.4825,-423.3486C171.7967,-481.8867 157.6844,-731.0092 110,-789 105.2246,-794.8076 98.6522,-799.0115 91.7098,-802.0539"/>
<polygon fill="#000000" stroke="#000000" points="90.3538,-798.8225 82.1477,-805.5241 92.7419,-805.4026 90.3538,-798.8225"/>
</g>
<!-- atomlist -->
<g id="proc~~setup_h0~~UsesGraph_node3" class="node">
<title>atomlist</title>
<polygon fill="#337ab7" stroke="#337ab7" points="82,-780 28,-780 28,-756 82,-756 82,-780"/>
<text text-anchor="middle" x="55" y="-765.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">atomlist</text>
</g>
<!-- proc~setup_h0&#45;&gt;atomlist -->
<g id="proc~~setup_h0~~UsesGraph_edge2" class="edge">
<title>proc~setup_h0&#45;&gt;atomlist</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M174.2131,-423.0489C170.4648,-477.0107 152.7967,-696.0429 110,-747 105.1644,-752.7576 98.5665,-756.9403 91.6182,-759.9777"/>
<polygon fill="#000000" stroke="#000000" points="90.2629,-756.7462 82.0588,-763.4502 92.6529,-763.3256 90.2629,-756.7462"/>
</g>
<!-- m_dhscf -->
<g id="proc~~setup_h0~~UsesGraph_node4" class="node">
<title>m_dhscf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="82,-738 28,-738 28,-714 82,-714 82,-738"/>
<text text-anchor="middle" x="55" y="-723.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_dhscf</text>
</g>
<!-- proc~setup_h0&#45;&gt;m_dhscf -->
<g id="proc~~setup_h0~~UsesGraph_edge3" class="edge">
<title>proc~setup_h0&#45;&gt;m_dhscf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M173.8371,-423.1911C168.8539,-473.0876 147.8171,-661.1645 110,-705 105.1345,-710.6398 98.5821,-714.7704 91.6976,-717.7941"/>
<polygon fill="#000000" stroke="#000000" points="90.4124,-714.5374 82.2308,-721.2688 92.8245,-721.1087 90.4124,-714.5374"/>
</g>
<!-- sparse_matrices -->
<g id="proc~~setup_h0~~UsesGraph_node5" class="node">
<title>sparse_matrices</title>
<polygon fill="#337ab7" stroke="#337ab7" points="100.5,-696 9.5,-696 9.5,-672 100.5,-672 100.5,-696"/>
<text text-anchor="middle" x="55" y="-681.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">sparse_matrices</text>
</g>
<!-- proc~setup_h0&#45;&gt;sparse_matrices -->
<g id="proc~~setup_h0~~UsesGraph_edge4" class="edge">
<title>proc~setup_h0&#45;&gt;sparse_matrices</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M173.3416,-423.2684C166.9875,-468.6373 142.8899,-626.1925 110,-663 109.1189,-663.986 108.1864,-664.926 107.2099,-665.8222"/>
<polygon fill="#000000" stroke="#000000" points="104.9703,-663.1246 98.9865,-671.8679 109.1167,-668.7645 104.9703,-663.1246"/>
</g>
<!-- siesta_geom -->
<g id="proc~~setup_h0~~UsesGraph_node6" class="node">
<title>siesta_geom</title>
<polygon fill="#337ab7" stroke="#337ab7" points="91.5,-654 18.5,-654 18.5,-630 91.5,-630 91.5,-654"/>
<text text-anchor="middle" x="55" y="-639.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">siesta_geom</text>
</g>
<!-- proc~setup_h0&#45;&gt;siesta_geom -->
<g id="proc~~setup_h0~~UsesGraph_edge5" class="edge">
<title>proc~setup_h0&#45;&gt;siesta_geom</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M172.6914,-423.1309C164.8346,-463.2916 138.0591,-591.0681 110,-621 107.2476,-623.9361 104.0407,-626.4658 100.5843,-628.6447"/>
<polygon fill="#000000" stroke="#000000" points="98.8184,-625.6188 91.5953,-633.3698 102.0754,-631.815 98.8184,-625.6188"/>
</g>
<!-- m_nlefsm -->
<g id="proc~~setup_h0~~UsesGraph_node7" class="node">
<title>m_nlefsm</title>
<polygon fill="#337ab7" stroke="#337ab7" points="84.5,-612 25.5,-612 25.5,-588 84.5,-588 84.5,-612"/>
<text text-anchor="middle" x="55" y="-597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_nlefsm</text>
</g>
<!-- proc~setup_h0&#45;&gt;m_nlefsm -->
<g id="proc~~setup_h0~~UsesGraph_edge6" class="edge">
<title>proc~setup_h0&#45;&gt;m_nlefsm</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M173.6402,-423.4074C169.643,-454.0322 155.212,-533.9879 110,-579 105.4842,-583.4958 99.9061,-587.0473 94.0507,-589.8478"/>
<polygon fill="#000000" stroke="#000000" points="92.665,-586.6331 84.7342,-593.6583 95.3149,-593.1121 92.665,-586.6331"/>
</g>
<!-- m_kinefsm -->
<g id="proc~~setup_h0~~UsesGraph_node8" class="node">
<title>m_kinefsm</title>
<polygon fill="#337ab7" stroke="#337ab7" points="87,-570 23,-570 23,-546 87,-546 87,-570"/>
<text text-anchor="middle" x="55" y="-555.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_kinefsm</text>
</g>
<!-- proc~setup_h0&#45;&gt;m_kinefsm -->
<g id="proc~~setup_h0~~UsesGraph_edge7" class="edge">
<title>proc~setup_h0&#45;&gt;m_kinefsm</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M171.8884,-423.2201C164.959,-448.0665 145.9619,-504.8408 110,-537 106.0536,-540.5291 101.4526,-543.4897 96.6235,-545.9676"/>
<polygon fill="#000000" stroke="#000000" points="94.8908,-542.9071 87.1676,-550.1599 97.728,-549.3064 94.8908,-542.9071"/>
</g>
<!-- m_dnaefs -->
<g id="proc~~setup_h0~~UsesGraph_node9" class="node">
<title>m_dnaefs</title>
<polygon fill="#337ab7" stroke="#337ab7" points="85,-528 25,-528 25,-504 85,-504 85,-528"/>
<text text-anchor="middle" x="55" y="-513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_dnaefs</text>
</g>
<!-- proc~setup_h0&#45;&gt;m_dnaefs -->
<g id="proc~~setup_h0~~UsesGraph_edge8" class="edge">
<title>proc~setup_h0&#45;&gt;m_dnaefs</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M168.4329,-423.283C158.1966,-441.354 136.8007,-475.1089 110,-495 105.2679,-498.5121 99.8775,-501.5074 94.3654,-504.0406"/>
<polygon fill="#000000" stroke="#000000" points="92.9773,-500.827 85.0686,-507.8771 95.6476,-507.2977 92.9773,-500.827"/>
</g>
<!-- spinorbit -->
<g id="proc~~setup_h0~~UsesGraph_node10" class="node">
<title>spinorbit</title>
<polygon fill="#337ab7" stroke="#337ab7" points="82,-486 28,-486 28,-462 82,-462 82,-486"/>
<text text-anchor="middle" x="55" y="-471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">spinorbit</text>
</g>
<!-- proc~setup_h0&#45;&gt;spinorbit -->
<g id="proc~~setup_h0~~UsesGraph_edge9" class="edge">
<title>proc~setup_h0&#45;&gt;spinorbit</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M158.4709,-423.0596C145.6657,-432.0562 127.2563,-444.2517 110,-453 104.1969,-455.942 97.879,-458.7193 91.6613,-461.2319"/>
<polygon fill="#000000" stroke="#000000" points="90.1234,-458.0741 82.0613,-464.9482 92.6505,-464.6021 90.1234,-458.0741"/>
</g>
<!-- class_dSpData1D -->
<g id="proc~~setup_h0~~UsesGraph_node11" class="node">
<title>class_dSpData1D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="103.5,-444 6.5,-444 6.5,-420 103.5,-420 103.5,-444"/>
<text text-anchor="middle" x="55" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">class_dSpData1D</text>
</g>
<!-- proc~setup_h0&#45;&gt;class_dSpData1D -->
<g id="proc~~setup_h0~~UsesGraph_edge10" class="edge">
<title>proc~setup_h0&#45;&gt;class_dSpData1D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M145.9513,-416.0835C136.2859,-417.775 125.1448,-419.7247 114.0472,-421.6667"/>
<polygon fill="#000000" stroke="#000000" points="113.1583,-418.269 103.9113,-423.4405 114.365,-425.1642 113.1583,-418.269"/>
</g>
<!-- m_mpi_utils -->
<g id="proc~~setup_h0~~UsesGraph_node12" class="node">
<title>m_mpi_utils</title>
<polygon fill="#337ab7" stroke="#337ab7" points="90,-402 20,-402 20,-378 90,-378 90,-402"/>
<text text-anchor="middle" x="55" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_mpi_utils</text>
</g>
<!-- proc~setup_h0&#45;&gt;m_mpi_utils -->
<g id="proc~~setup_h0~~UsesGraph_edge11" class="edge">
<title>proc~setup_h0&#45;&gt;m_mpi_utils</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M145.9513,-405.9165C132.1815,-403.5068 115.4167,-400.5729 100.0494,-397.8836"/>
<polygon fill="#000000" stroke="#000000" points="100.6519,-394.436 90.1982,-396.1597 99.4451,-401.3312 100.6519,-394.436"/>
</g>
<!-- m_spin -->
<g id="proc~~setup_h0~~UsesGraph_node13" class="node">
<title>m_spin</title>
<polygon fill="#337ab7" stroke="#337ab7" points="82,-360 28,-360 28,-336 82,-336 82,-360"/>
<text text-anchor="middle" x="55" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_spin</text>
</g>
<!-- proc~setup_h0&#45;&gt;m_spin -->
<g id="proc~~setup_h0~~UsesGraph_edge12" class="edge">
<title>proc~setup_h0&#45;&gt;m_spin</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M158.4709,-398.9404C145.6657,-389.9438 127.2563,-377.7483 110,-369 104.1969,-366.058 97.879,-363.2807 91.6613,-360.7681"/>
<polygon fill="#000000" stroke="#000000" points="92.6505,-357.3979 82.0613,-357.0518 90.1234,-363.9259 92.6505,-357.3979"/>
</g>
<!-- siesta_options -->
<g id="proc~~setup_h0~~UsesGraph_node14" class="node">
<title>siesta_options</title>
<polygon fill="#337ab7" stroke="#337ab7" points="95.5,-318 14.5,-318 14.5,-294 95.5,-294 95.5,-318"/>
<text text-anchor="middle" x="55" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">siesta_options</text>
</g>
<!-- proc~setup_h0&#45;&gt;siesta_options -->
<g id="proc~~setup_h0~~UsesGraph_edge13" class="edge">
<title>proc~setup_h0&#45;&gt;siesta_options</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M168.4329,-398.717C158.1966,-380.646 136.8007,-346.8911 110,-327 107.9533,-325.4809 105.7834,-324.0586 103.5338,-322.7284"/>
<polygon fill="#000000" stroke="#000000" points="105.0388,-319.566 94.5535,-318.0461 101.8024,-325.773 105.0388,-319.566"/>
</g>
<!-- molecularmechanics -->
<g id="proc~~setup_h0~~UsesGraph_node15" class="node">
<title>molecularmechanics</title>
<polygon fill="#337ab7" stroke="#337ab7" points="110,-276 0,-276 0,-252 110,-252 110,-276"/>
<text text-anchor="middle" x="55" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">molecularmechanics</text>
</g>
<!-- proc~setup_h0&#45;&gt;molecularmechanics -->
<g id="proc~~setup_h0~~UsesGraph_edge14" class="edge">
<title>proc~setup_h0&#45;&gt;molecularmechanics</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M171.8884,-398.7799C164.959,-373.9335 145.9619,-317.1592 110,-285 108.5143,-283.6714 106.9358,-282.4234 105.2873,-281.2514"/>
<polygon fill="#000000" stroke="#000000" points="106.9395,-278.1607 96.5666,-276.0033 103.3301,-284.1585 106.9395,-278.1607"/>
</g>
<!-- class_dSpData2D -->
<g id="proc~~setup_h0~~UsesGraph_node16" class="node">
<title>class_dSpData2D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="103.5,-234 6.5,-234 6.5,-210 103.5,-210 103.5,-234"/>
<text text-anchor="middle" x="55" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">class_dSpData2D</text>
</g>
<!-- proc~setup_h0&#45;&gt;class_dSpData2D -->
<g id="proc~~setup_h0~~UsesGraph_edge15" class="edge">
<title>proc~setup_h0&#45;&gt;class_dSpData2D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M173.6402,-398.5926C169.643,-367.9678 155.212,-288.0121 110,-243 108.78,-241.7854 107.4824,-240.6396 106.1227,-239.559"/>
<polygon fill="#000000" stroke="#000000" points="108.0415,-236.6319 97.7647,-234.0555 104.1918,-242.4783 108.0415,-236.6319"/>
</g>
<!-- alloc -->
<g id="proc~~setup_h0~~UsesGraph_node17" class="node">
<title>alloc</title>
<polygon fill="#337ab7" stroke="#337ab7" points="82,-192 28,-192 28,-168 82,-168 82,-192"/>
<text text-anchor="middle" x="55" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">alloc</text>
</g>
<!-- proc~setup_h0&#45;&gt;alloc -->
<g id="proc~~setup_h0~~UsesGraph_edge16" class="edge">
<title>proc~setup_h0&#45;&gt;alloc</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M172.6914,-398.8691C164.8346,-358.7084 138.0591,-230.9319 110,-201 105.0686,-195.7394 98.6783,-191.7835 92.0078,-188.8126"/>
<polygon fill="#000000" stroke="#000000" points="92.7638,-185.3583 82.1715,-185.1274 90.3079,-191.9133 92.7638,-185.3583"/>
</g>
<!-- metaforce -->
<g id="proc~~setup_h0~~UsesGraph_node18" class="node">
<title>metaforce</title>
<polygon fill="#337ab7" stroke="#337ab7" points="85.5,-150 24.5,-150 24.5,-126 85.5,-126 85.5,-150"/>
<text text-anchor="middle" x="55" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">metaforce</text>
</g>
<!-- proc~setup_h0&#45;&gt;metaforce -->
<g id="proc~~setup_h0~~UsesGraph_edge17" class="edge">
<title>proc~setup_h0&#45;&gt;metaforce</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M173.3416,-398.7316C166.9875,-353.3627 142.8899,-195.8075 110,-159 105.8989,-154.4104 100.6839,-150.818 95.106,-148.0077"/>
<polygon fill="#000000" stroke="#000000" points="96.0839,-144.6224 85.5086,-143.9784 93.3741,-151.0766 96.0839,-144.6224"/>
</g>
<!-- m_energies -->
<g id="proc~~setup_h0~~UsesGraph_node19" class="node">
<title>m_energies</title>
<polygon fill="#337ab7" stroke="#337ab7" points="89.5,-108 20.5,-108 20.5,-84 89.5,-84 89.5,-108"/>
<text text-anchor="middle" x="55" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_energies</text>
</g>
<!-- proc~setup_h0&#45;&gt;m_energies -->
<g id="proc~~setup_h0~~UsesGraph_edge18" class="edge">
<title>proc~setup_h0&#45;&gt;m_energies</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M173.8371,-398.8089C168.8539,-348.9124 147.8171,-160.8355 110,-117 106.8287,-113.324 102.9407,-110.2891 98.7111,-107.784"/>
<polygon fill="#000000" stroke="#000000" points="100.1896,-104.6109 89.67,-103.3504 97.1075,-110.8959 100.1896,-104.6109"/>
</g>
<!-- atmfuncs -->
<g id="proc~~setup_h0~~UsesGraph_node20" class="node">
<title>atmfuncs</title>
<polygon fill="#337ab7" stroke="#337ab7" points="83,-66 27,-66 27,-42 83,-42 83,-66"/>
<text text-anchor="middle" x="55" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">atmfuncs</text>
</g>
<!-- proc~setup_h0&#45;&gt;atmfuncs -->
<g id="proc~~setup_h0~~UsesGraph_edge19" class="edge">
<title>proc~setup_h0&#45;&gt;atmfuncs</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M174.2131,-398.9511C170.4648,-344.9893 152.7967,-125.9571 110,-75 105.451,-69.5836 99.3423,-65.561 92.8495,-62.5745"/>
<polygon fill="#000000" stroke="#000000" points="93.7899,-59.1874 83.199,-58.8984 91.2981,-65.7289 93.7899,-59.1874"/>
</g>
<!-- m_ntm -->
<g id="proc~~setup_h0~~UsesGraph_node21" class="node">
<title>m_ntm</title>
<polygon fill="#337ab7" stroke="#337ab7" points="82,-24 28,-24 28,0 82,0 82,-24"/>
<text text-anchor="middle" x="55" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ntm</text>
</g>
<!-- proc~setup_h0&#45;&gt;m_ntm -->
<g id="proc~~setup_h0~~UsesGraph_edge20" class="edge">
<title>proc~setup_h0&#45;&gt;m_ntm</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M174.4825,-398.6514C171.7967,-340.1133 157.6844,-90.9908 110,-33 105.2246,-27.1924 98.6522,-22.9885 91.7098,-19.9461"/>
<polygon fill="#000000" stroke="#000000" points="92.7419,-16.5974 82.1477,-16.4759 90.3538,-23.1775 92.7419,-16.5974"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="490pt" height="32pt"
 viewBox="0.00 0.00 489.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 485.5,-28 485.5,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node">
<title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node">
<title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="139.5,-24 72.5,-24 72.5,0 139.5,0 139.5,-24"/>
<text text-anchor="middle" x="106" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="222,-24 158,-24 158,0 222,0 222,-24"/>
<text text-anchor="middle" x="190" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="294,-24 240,-24 240,0 294,0 294,-24"/>
<text text-anchor="middle" x="267" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="366,-24 312,-24 312,0 366,0 366,-24"/>
<text text-anchor="middle" x="339" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="481.5,-24 384.5,-24 384.5,0 481.5,0 481.5,-24"/>
<text text-anchor="middle" x="433" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses.
    </p>
    </div></div></div></div>
      </li>
      
      </ul>
    </div>
    


    
    <p>Computes non-self-consistent part of the Hamiltonian
 and initializes data structures on the grid.</p>
<p>Self-energy of isolated ions
@code
@endcode</p>
<p>Neutral-atom: energy
</p><div class="alert alert-info" role="alert"><h4>Note</h4><p>In these routines, flag is defined
  to tell them NOT to compute
  forces and stresses in this first pass, only energies.
</p></div>
<p>@code
@endcode</p>
<p>Metadynamics energy:
 Add on force field contribution to energy:
 Now we compute matrix elements of the Kinetic and Non-local
  parts of H</p>
<p>Kinetic: matrix elements only
@code
@endcode</p>
<p>Non-local-pseudop:  matrix elements only
@code
@endcode</p>
<p></p><div class="alert alert-info" role="alert"><h4>Note</h4><p>If in the future the spin-orbit routine is able to compute
  forces and stresses, then "last" will be needed. If we are not
  computing forces and stresses, calling it in the first iteratio      !n
  should be enough.
</p></div>
<p>
<p>@code
@endcode</p>
<p>This will take care of possible changes to the mesh and atomic-r      !elated
mesh structures for geometry changes:
@code
@endcode</p>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-g2max"></span>real(kind=dp),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>g2max</strong></td><td></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: proc~~setup_h0~~CallsGraph Pages: 1 -->
<svg id="procsetup_h0CallsGraph" width="173pt" height="536pt"
 viewBox="0.00 0.00 173.00 536.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~setup_h0~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 532)">
<title>proc~~setup_h0~~CallsGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-532 169,-532 169,4 -4,4"/>
<!-- proc~setup_h0 -->
<g id="proc~~setup_h0~~CallsGraph_node1" class="node">
<title>proc~setup_h0</title>
<polygon fill="none" stroke="#000000" points="58,-276 0,-276 0,-252 58,-252 58,-276"/>
<text text-anchor="middle" x="29" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">setup_H0</text>
</g>
<!-- write_debug -->
<g id="proc~~setup_h0~~CallsGraph_node2" class="node">
<title>write_debug</title>
<polygon fill="#777777" stroke="#777777" points="165,-528 94,-528 94,-504 165,-504 165,-528"/>
<text text-anchor="middle" x="129.5" y="-513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">write_debug</text>
</g>
<!-- proc~setup_h0&#45;&gt;write_debug -->
<g id="proc~~setup_h0~~CallsGraph_edge1" class="edge">
<title>proc~setup_h0&#45;&gt;write_debug</title>
<path fill="none" stroke="#000000" d="M31.2016,-276.2479C39.0283,-318.7525 66.5115,-459.247 94,-495 94.5729,-495.7451 95.1803,-496.469 95.8172,-497.1719"/>
<polygon fill="#000000" stroke="#000000" points="93.7048,-499.9737 103.5414,-503.9098 98.3064,-494.6986 93.7048,-499.9737"/>
</g>
<!-- uion -->
<g id="proc~~setup_h0~~CallsGraph_node3" class="node">
<title>uion</title>
<polygon fill="#777777" stroke="#777777" points="156.5,-486 102.5,-486 102.5,-462 156.5,-462 156.5,-486"/>
<text text-anchor="middle" x="129.5" y="-471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">uion</text>
</g>
<!-- proc~setup_h0&#45;&gt;uion -->
<g id="proc~~setup_h0~~CallsGraph_edge2" class="edge">
<title>proc~setup_h0&#45;&gt;uion</title>
<path fill="none" stroke="#000000" d="M30.2445,-276.0032C34.1282,-308.1152 48.6169,-397.3276 94,-453 94.5938,-453.7285 95.2201,-454.4375 95.8739,-455.127"/>
<polygon fill="#000000" stroke="#000000" points="93.8206,-457.975 103.71,-461.7762 98.3496,-452.6375 93.8206,-457.975"/>
</g>
<!-- kinefsm -->
<g id="proc~~setup_h0~~CallsGraph_node4" class="node">
<title>kinefsm</title>
<polygon fill="#777777" stroke="#777777" points="156.5,-444 102.5,-444 102.5,-420 156.5,-420 156.5,-444"/>
<text text-anchor="middle" x="129.5" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">kinefsm</text>
</g>
<!-- proc~setup_h0&#45;&gt;kinefsm -->
<g id="proc~~setup_h0~~CallsGraph_edge3" class="edge">
<title>proc~setup_h0&#45;&gt;kinefsm</title>
<path fill="none" stroke="#000000" d="M31.6487,-276.0362C38.1089,-303.0265 56.9297,-369.2816 94,-411 94.7373,-411.8297 95.5154,-412.6359 96.3267,-413.4184"/>
<polygon fill="#000000" stroke="#000000" points="94.3248,-416.2992 104.3188,-419.8163 98.6994,-410.8345 94.3248,-416.2992"/>
</g>
<!-- dhscf_init -->
<g id="proc~~setup_h0~~CallsGraph_node5" class="node">
<title>dhscf_init</title>
<polygon fill="#777777" stroke="#777777" points="158.5,-402 100.5,-402 100.5,-378 158.5,-378 158.5,-402"/>
<text text-anchor="middle" x="129.5" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">dhscf_init</text>
</g>
<!-- proc~setup_h0&#45;&gt;dhscf_init -->
<g id="proc~~setup_h0~~CallsGraph_edge5" class="edge">
<title>proc~setup_h0&#45;&gt;dhscf_init</title>
<path fill="none" stroke="#000000" d="M34.229,-276.3179C43.6525,-297.3849 65.214,-340.7875 94,-369 95.0548,-370.0338 96.1701,-371.0373 97.3292,-372.0087"/>
<polygon fill="#000000" stroke="#000000" points="95.3006,-374.8612 105.4399,-377.9344 99.4301,-369.209 95.3006,-374.8612"/>
</g>
<!-- meta -->
<g id="proc~~setup_h0~~CallsGraph_node6" class="node">
<title>meta</title>
<polygon fill="#777777" stroke="#777777" points="156.5,-360 102.5,-360 102.5,-336 156.5,-336 156.5,-360"/>
<text text-anchor="middle" x="129.5" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">meta</text>
</g>
<!-- proc~setup_h0&#45;&gt;meta -->
<g id="proc~~setup_h0~~CallsGraph_edge12" class="edge">
<title>proc~setup_h0&#45;&gt;meta</title>
<path fill="none" stroke="#000000" d="M39.7636,-276.0156C52.0889,-289.3806 73.2634,-311.1711 94,-327 95.5368,-328.1731 97.1444,-329.3324 98.7907,-330.4677"/>
<polygon fill="#000000" stroke="#000000" points="96.8972,-333.4113 107.1962,-335.8973 100.6954,-327.5313 96.8972,-333.4113"/>
</g>
<!-- isa -->
<g id="proc~~setup_h0~~CallsGraph_node7" class="node">
<title>isa</title>
<polygon fill="#777777" stroke="#777777" points="156.5,-318 102.5,-318 102.5,-294 156.5,-294 156.5,-318"/>
<text text-anchor="middle" x="129.5" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">isa</text>
</g>
<!-- proc~setup_h0&#45;&gt;isa -->
<g id="proc~~setup_h0~~CallsGraph_edge6" class="edge">
<title>proc~setup_h0&#45;&gt;isa</title>
<path fill="none" stroke="#000000" d="M57.7993,-276.0355C68.7655,-280.6184 81.4096,-285.9025 92.9972,-290.7451"/>
<polygon fill="#000000" stroke="#000000" points="91.8459,-294.0573 102.4222,-294.6839 94.5451,-287.5986 91.8459,-294.0573"/>
</g>
<!-- twobody -->
<g id="proc~~setup_h0~~CallsGraph_node8" class="node">
<title>twobody</title>
<polygon fill="#777777" stroke="#777777" points="156.5,-276 102.5,-276 102.5,-252 156.5,-252 156.5,-276"/>
<text text-anchor="middle" x="129.5" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">twobody</text>
</g>
<!-- proc~setup_h0&#45;&gt;twobody -->
<g id="proc~~setup_h0~~CallsGraph_edge7" class="edge">
<title>proc~setup_h0&#45;&gt;twobody</title>
<path fill="none" stroke="#000000" d="M58.0688,-264C68.7211,-264 80.9277,-264 92.2011,-264"/>
<polygon fill="#000000" stroke="#000000" points="92.2205,-267.5001 102.2204,-264 92.2204,-260.5001 92.2205,-267.5001"/>
</g>
<!-- naefs -->
<g id="proc~~setup_h0~~CallsGraph_node9" class="node">
<title>naefs</title>
<polygon fill="#777777" stroke="#777777" points="156.5,-234 102.5,-234 102.5,-210 156.5,-210 156.5,-234"/>
<text text-anchor="middle" x="129.5" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">naefs</text>
</g>
<!-- proc~setup_h0&#45;&gt;naefs -->
<g id="proc~~setup_h0~~CallsGraph_edge8" class="edge">
<title>proc~setup_h0&#45;&gt;naefs</title>
<path fill="none" stroke="#000000" d="M57.7993,-251.9645C68.7655,-247.3816 81.4096,-242.0975 92.9972,-237.2549"/>
<polygon fill="#000000" stroke="#000000" points="94.5451,-240.4014 102.4222,-233.3161 91.8459,-233.9427 94.5451,-240.4014"/>
</g>
<!-- timer -->
<g id="proc~~setup_h0~~CallsGraph_node10" class="node">
<title>timer</title>
<polygon fill="#777777" stroke="#777777" points="156.5,-192 102.5,-192 102.5,-168 156.5,-168 156.5,-192"/>
<text text-anchor="middle" x="129.5" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">timer</text>
</g>
<!-- proc~setup_h0&#45;&gt;timer -->
<g id="proc~~setup_h0~~CallsGraph_edge9" class="edge">
<title>proc~setup_h0&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M39.7636,-251.9844C52.0889,-238.6194 73.2634,-216.8289 94,-201 95.5368,-199.8269 97.1444,-198.6676 98.7907,-197.5323"/>
<polygon fill="#000000" stroke="#000000" points="100.6954,-200.4687 107.1962,-192.1027 96.8972,-194.5887 100.6954,-200.4687"/>
</g>
<!-- dnaefs -->
<g id="proc~~setup_h0~~CallsGraph_node11" class="node">
<title>dnaefs</title>
<polygon fill="#777777" stroke="#777777" points="156.5,-150 102.5,-150 102.5,-126 156.5,-126 156.5,-150"/>
<text text-anchor="middle" x="129.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">dnaefs</text>
</g>
<!-- proc~setup_h0&#45;&gt;dnaefs -->
<g id="proc~~setup_h0~~CallsGraph_edge10" class="edge">
<title>proc~setup_h0&#45;&gt;dnaefs</title>
<path fill="none" stroke="#000000" d="M34.229,-251.6821C43.6525,-230.6151 65.214,-187.2125 94,-159 95.0548,-157.9662 96.1701,-156.9627 97.3292,-155.9913"/>
<polygon fill="#000000" stroke="#000000" points="99.4301,-158.791 105.4399,-150.0656 95.3006,-153.1388 99.4301,-158.791"/>
</g>
<!-- spinorb -->
<g id="proc~~setup_h0~~CallsGraph_node12" class="node">
<title>spinorb</title>
<polygon fill="#777777" stroke="#777777" points="156.5,-108 102.5,-108 102.5,-84 156.5,-84 156.5,-108"/>
<text text-anchor="middle" x="129.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">spinorb</text>
</g>
<!-- proc~setup_h0&#45;&gt;spinorb -->
<g id="proc~~setup_h0~~CallsGraph_edge11" class="edge">
<title>proc~setup_h0&#45;&gt;spinorb</title>
<path fill="none" stroke="#000000" d="M31.6487,-251.9638C38.1089,-224.9735 56.9297,-158.7184 94,-117 94.7373,-116.1703 95.5154,-115.3641 96.3267,-114.5816"/>
<polygon fill="#000000" stroke="#000000" points="98.6994,-117.1655 104.3188,-108.1837 94.3248,-111.7008 98.6994,-117.1655"/>
</g>
<!-- nlefsm -->
<g id="proc~~setup_h0~~CallsGraph_node13" class="node">
<title>nlefsm</title>
<polygon fill="#777777" stroke="#777777" points="156.5,-66 102.5,-66 102.5,-42 156.5,-42 156.5,-66"/>
<text text-anchor="middle" x="129.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">nlefsm</text>
</g>
<!-- proc~setup_h0&#45;&gt;nlefsm -->
<g id="proc~~setup_h0~~CallsGraph_edge4" class="edge">
<title>proc~setup_h0&#45;&gt;nlefsm</title>
<path fill="none" stroke="#000000" d="M30.2445,-251.9968C34.1282,-219.8848 48.6169,-130.6724 94,-75 94.5938,-74.2715 95.2201,-73.5625 95.8739,-72.873"/>
<polygon fill="#000000" stroke="#000000" points="98.3496,-75.3625 103.71,-66.2238 93.8206,-70.025 98.3496,-75.3625"/>
</g>
<!-- val -->
<g id="proc~~setup_h0~~CallsGraph_node14" class="node">
<title>val</title>
<polygon fill="#777777" stroke="#777777" points="156.5,-24 102.5,-24 102.5,0 156.5,0 156.5,-24"/>
<text text-anchor="middle" x="129.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">val</text>
</g>
<!-- proc~setup_h0&#45;&gt;val -->
<g id="proc~~setup_h0~~CallsGraph_edge13" class="edge">
<title>proc~setup_h0&#45;&gt;val</title>
<path fill="none" stroke="#000000" d="M31.2016,-251.7521C39.0283,-209.2475 66.5115,-68.753 94,-33 94.5729,-32.2549 95.1803,-31.531 95.8172,-30.8281"/>
<polygon fill="#000000" stroke="#000000" points="98.3064,-33.3014 103.5414,-24.0902 93.7048,-28.0263 98.3064,-33.3014"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,0 64,0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,0 136,0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,0 209.5,0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,0 364,0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,0 436,0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="551.5,-24 454.5,-24 454.5,0 551.5,0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/setup_h0.html#src">setup_H0</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>      <span class="k">subroutine </span><span class="n">setup_H0</span><span class="p">(</span><span class="n">G2max</span><span class="p">)</span>
      <span class="c">!! Computes non-self-consistent part of the Hamiltonian</span>
      <span class="c">!! and initializes data structures on the grid.</span>

      <span class="k">USE </span><span class="n">siesta_options</span><span class="p">,</span>  <span class="n">only</span><span class="p">:</span> <span class="n">g2cut</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">H_kin_1D</span><span class="p">,</span> <span class="n">H_vkb_1D</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">H_so_2D</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">Dscf</span>

      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">listh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">maxnh</span>
      <span class="k">use </span><span class="n">siesta_geom</span>
      <span class="k">use </span><span class="n">atmfuncs</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">uion</span>
      <span class="k">use </span><span class="n">atomlist</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">iaorb</span><span class="p">,</span> <span class="n">iphkb</span><span class="p">,</span> <span class="n">indxuo</span><span class="p">,</span> <span class="n">datm</span><span class="p">,</span>
     <span class="p">&amp;</span>                    <span class="n">lastkb</span><span class="p">,</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">rmaxv</span><span class="p">,</span> <span class="n">indxua</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span>
     <span class="p">&amp;</span>                    <span class="n">rmaxo</span><span class="p">,</span> <span class="n">no_l</span>
      <span class="k">use </span><span class="n">metaforce</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">lMetaForce</span><span class="p">,</span> <span class="n">meta</span>
      <span class="k">use </span><span class="n">molecularmechanics</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">twobody</span>
      <span class="k">use </span><span class="n">m_nlefsm</span><span class="p">,</span>     <span class="n">only</span><span class="p">:</span> <span class="n">nlefsm</span>
      <span class="k">use </span><span class="n">m_kinefsm</span><span class="p">,</span>    <span class="n">only</span><span class="p">:</span> <span class="n">kinefsm</span>
      <span class="k">use </span><span class="n">m_naefs</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">naefs</span>
      <span class="k">use </span><span class="n">m_dnaefs</span><span class="p">,</span>     <span class="n">only</span><span class="p">:</span> <span class="n">dnaefs</span>
      <span class="k">use </span><span class="n">m_dhscf</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">dhscf_init</span>
      <span class="k">use </span><span class="n">m_energies</span><span class="p">,</span>   <span class="n">only</span><span class="p">:</span> <span class="n">Eions</span><span class="p">,</span> <span class="n">Ena</span><span class="p">,</span> <span class="n">DEna</span><span class="p">,</span> <span class="n">Emm</span><span class="p">,</span> <span class="n">Emeta</span><span class="p">,</span> <span class="n">Eso</span>
      <span class="k">use </span><span class="n">m_ntm</span>
      <span class="k">use </span><span class="n">m_spin</span><span class="p">,</span>       <span class="n">only</span><span class="p">:</span> <span class="n">spin</span>
      <span class="k">use </span><span class="n">spinorbit</span><span class="p">,</span>    <span class="n">only</span><span class="p">:</span> <span class="n">spinorb</span>
      <span class="k">use </span><span class="n">alloc</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">re_alloc</span><span class="p">,</span> <span class="n">de_alloc</span>
      <span class="k">use </span><span class="n">class_dSpData1D</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">val</span>
      <span class="k">use </span><span class="n">class_dSpData2D</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">val</span>

<span class="cp">#ifdef MPI</span>
      <span class="k">use </span><span class="n">m_mpi_utils</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">globalize_sum</span>
<span class="cp">#endif</span>

      <span class="k">implicit none</span>
<span class="k">      </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">g2max</span>

      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dummy_stress</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">dummy_fa</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">dummy_dm</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dummy_E</span>
      <span class="kt">integer</span>  <span class="kd">::</span> <span class="n">ia</span><span class="p">,</span> <span class="k">is</span>

<span class="k">      </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">H_val</span><span class="p">(:),</span> <span class="n">H_so</span><span class="p">(:,:)</span>

<span class="cp">#ifdef DEBUG</span>
      <span class="k">call </span><span class="n">write_debug</span><span class="p">(</span> <span class="s1">&#39;    PRE setup_H0&#39;</span> <span class="p">)</span>
<span class="cp">#endif</span>

<span class="c">!----------------------------------------------------------------------BEGIN</span>
      <span class="k">call </span><span class="n">timer</span><span class="p">(</span><span class="s1">&#39;Setup_H0&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

      <span class="c">!!Self-energy of isolated ions</span>
      <span class="c">!!@code</span>
      <span class="n">Eions</span> <span class="o">=</span> <span class="mf">0.0_dp</span>
      <span class="k">do </span><span class="n">ia</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">na_u</span>
        <span class="k">is</span> <span class="o">=</span> <span class="n">isa</span><span class="p">(</span><span class="n">ia</span><span class="p">)</span>
        <span class="n">Eions</span> <span class="o">=</span> <span class="n">Eions</span> <span class="o">+</span> <span class="n">uion</span><span class="p">(</span><span class="k">is</span><span class="p">)</span>
      <span class="n">enddo</span>
      <span class="c">!!@endcode</span>


      <span class="c">!! Neutral-atom: energy</span>
      <span class="c">!!@note</span>
      <span class="c">!* In these routines, flag is defined</span>
      <span class="c">!  to tell them NOT to compute</span>
      <span class="c">!  forces and stresses in this first pass, only energies.</span>
      <span class="c">!!@endnote</span>
      <span class="c">!!@code</span>
      <span class="k">call </span><span class="n">naefs</span><span class="p">(</span><span class="n">na_u</span><span class="p">,</span> <span class="n">na_s</span><span class="p">,</span> <span class="n">scell</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">indxua</span><span class="p">,</span> <span class="n">rmaxv</span><span class="p">,</span>
     <span class="p">&amp;</span>           <span class="n">isa</span><span class="p">,</span> <span class="n">Ena</span><span class="p">,</span> <span class="n">dummy_fa</span><span class="p">,</span> <span class="n">dummy_stress</span><span class="p">,</span>
     <span class="p">&amp;</span>           <span class="n">forces_and_stress</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.)</span>
      <span class="k">call </span><span class="n">dnaefs</span><span class="p">(</span><span class="n">na_u</span><span class="p">,</span> <span class="n">na_s</span><span class="p">,</span> <span class="n">scell</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">indxua</span><span class="p">,</span> <span class="n">rmaxv</span><span class="p">,</span>
     <span class="p">&amp;</span>            <span class="n">isa</span><span class="p">,</span> <span class="n">DEna</span><span class="p">,</span> <span class="n">dummy_fa</span><span class="p">,</span> <span class="n">dummy_stress</span><span class="p">,</span>
     <span class="p">&amp;</span>            <span class="n">forces_and_stress</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.)</span>
      <span class="n">Ena</span> <span class="o">=</span> <span class="n">Ena</span> <span class="o">+</span> <span class="n">DEna</span>
      <span class="c">!!@endcode</span>

      <span class="c">!! Metadynamics energy:</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">lMetaForce</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">meta</span><span class="p">(</span><span class="n">xa</span><span class="p">,</span><span class="n">na_u</span><span class="p">,</span><span class="n">ucell</span><span class="p">,</span><span class="n">Emeta</span><span class="p">,</span><span class="n">dummy_fa</span><span class="p">,</span><span class="n">dummy_stress</span><span class="p">,</span>
     <span class="err">$</span>           <span class="p">.</span><span class="n">false</span><span class="p">.,.</span><span class="n">false</span><span class="p">.)</span>
      <span class="n">endif</span>

      <span class="c">!! Add on force field contribution to energy:</span>
      <span class="k">call </span><span class="n">twobody</span><span class="p">(</span> <span class="n">na_u</span><span class="p">,</span><span class="n">xa</span><span class="p">,</span><span class="n">isa</span><span class="p">,</span><span class="n">ucell</span><span class="p">,</span><span class="n">Emm</span><span class="p">,</span>
     <span class="p">&amp;</span>              <span class="n">ifa</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">fa</span><span class="o">=</span><span class="n">dummy_fa</span><span class="p">,</span><span class="n">istr</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">stress</span><span class="o">=</span><span class="n">dummy_stress</span><span class="p">)</span>


      <span class="c">!* Now we compute matrix elements of the Kinetic and Non-local</span>
      <span class="c">!  parts of H</span>

      <span class="c">!! Kinetic: matrix elements only</span>
      <span class="c">!!@code</span>
      <span class="n">H_val</span> <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">H_kin_1D</span><span class="p">)</span>
<span class="c">!$OMP parallel workshare default(shared)</span>
      <span class="n">H_val</span><span class="p">(:)</span> <span class="o">=</span> <span class="mf">0.0_dp</span>
<span class="c">!$OMP end parallel workshare</span>
      <span class="k">call </span><span class="n">kinefsm</span><span class="p">(</span><span class="n">na_u</span><span class="p">,</span> <span class="n">na_s</span><span class="p">,</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">scell</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">indxua</span><span class="p">,</span> <span class="n">rmaxo</span><span class="p">,</span>
     <span class="p">&amp;</span>             <span class="n">maxnh</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span> <span class="n">isa</span><span class="p">,</span>
     <span class="p">&amp;</span>             <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span>
     <span class="p">&amp;</span>             <span class="mi">1</span><span class="p">,</span>
     <span class="p">&amp;</span>             <span class="n">dummy_dm</span><span class="p">,</span> <span class="n">dummy_E</span><span class="p">,</span> <span class="n">dummy_fa</span><span class="p">,</span> <span class="n">dummy_stress</span><span class="p">,</span>
     <span class="p">&amp;</span>             <span class="n">H_val</span><span class="p">,</span>
     <span class="p">&amp;</span>             <span class="n">matrix_elements_only</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
      <span class="c">!!@endcode</span>

      <span class="c">!! Non-local-pseudop:  matrix elements only</span>
      <span class="c">!!@code</span>
      <span class="n">H_val</span> <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">H_vkb_1D</span><span class="p">)</span>
<span class="c">!$OMP parallel workshare default(shared)</span>
      <span class="n">H_val</span><span class="p">(:)</span> <span class="o">=</span> <span class="mf">0.0_dp</span>
<span class="c">!$OMP end parallel workshare</span>
      <span class="k">call </span><span class="n">nlefsm</span><span class="p">(</span><span class="n">scell</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">na_s</span><span class="p">,</span> <span class="n">isa</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">indxua</span><span class="p">,</span>
     <span class="p">&amp;</span>            <span class="n">maxnh</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span> <span class="n">lastkb</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span> <span class="n">iphKB</span><span class="p">,</span>
     <span class="p">&amp;</span>            <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span>
     <span class="p">&amp;</span>            <span class="mi">1</span><span class="p">,</span>
     <span class="p">&amp;</span>            <span class="n">dummy_dm</span><span class="p">,</span> <span class="n">dummy_E</span><span class="p">,</span> <span class="n">dummy_fa</span><span class="p">,</span> <span class="n">dummy_stress</span><span class="p">,</span>
     <span class="p">&amp;</span>            <span class="n">H_val</span><span class="p">,</span>
     <span class="p">&amp;</span>            <span class="n">matrix_elements_only</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
      <span class="c">!!@endcode</span>


      <span class="c">!!@note</span>
      <span class="c">!* If in the future the spin-orbit routine is able to compute</span>
      <span class="c">!  forces and stresses, then &quot;last&quot; will be needed. If we are not</span>
      <span class="c">!  computing forces and stresses, calling it in the first iteration</span>
      <span class="c">!  should be enough.</span>
      <span class="c">!!@endnote</span>

      <span class="c">!!@code</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">spin</span><span class="p">%</span><span class="n">SO</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">         </span><span class="n">H_so</span> <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">H_so_2D</span><span class="p">)</span>
<span class="c">!$OMP parallel workshare default(shared)</span>
         <span class="n">H_so</span> <span class="o">=</span> <span class="mf">0._dp</span>
<span class="c">!$OMP end parallel workshare</span>
         <span class="k">call </span><span class="n">spinorb</span><span class="p">(</span><span class="n">no_u</span><span class="p">,</span><span class="n">no_l</span><span class="p">,</span><span class="n">iaorb</span><span class="p">,</span><span class="n">iphorb</span><span class="p">,</span><span class="n">isa</span><span class="p">,</span><span class="n">indxuo</span><span class="p">,</span>
     <span class="p">&amp;</span>        <span class="n">maxnh</span><span class="p">,</span><span class="n">numh</span><span class="p">,</span><span class="n">listhptr</span><span class="p">,</span><span class="n">listh</span><span class="p">,</span><span class="n">Dscf</span><span class="p">,</span><span class="n">H_so</span><span class="p">,</span><span class="n">Eso</span><span class="p">)</span>
      <span class="k">else</span>
<span class="k">         </span><span class="n">Eso</span> <span class="o">=</span> <span class="mf">0._dp</span>
      <span class="k">end if</span>
      <span class="c">!!@endcode</span>


      <span class="c">!!This will take care of possible changes to the mesh and atomic-related</span>
      <span class="c">!!mesh structures for geometry changes:</span>
      <span class="c">!!@code</span>
      <span class="n">g2max</span> <span class="o">=</span> <span class="n">g2cut</span>
      <span class="k">call </span><span class="n">dhscf_init</span><span class="p">(</span> <span class="n">spin</span><span class="p">%</span><span class="n">Grid</span><span class="p">,</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">iaorb</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span>
     <span class="p">&amp;</span>                 <span class="n">no_l</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">na_s</span><span class="p">,</span>
     <span class="p">&amp;</span>                 <span class="n">isa</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">indxua</span><span class="p">,</span> <span class="n">ucell</span><span class="p">,</span>
     <span class="p">&amp;</span>                 <span class="n">mscell</span><span class="p">,</span> <span class="n">G2max</span><span class="p">,</span> <span class="n">ntm</span><span class="p">,</span>
     <span class="p">&amp;</span>                 <span class="n">maxnh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">datm</span><span class="p">,</span>
     <span class="p">&amp;</span>                 <span class="n">dummy_fa</span><span class="p">,</span> <span class="n">dummy_stress</span><span class="p">)</span>
      <span class="c">!!@endcode</span>

      <span class="k">call </span><span class="n">timer</span><span class="p">(</span><span class="s1">&#39;Setup_H0&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

<span class="cp">#ifdef DEBUG</span>
      <span class="k">call </span><span class="n">write_debug</span><span class="p">(</span> <span class="s1">&#39;    POS setup_H0&#39;</span> <span class="p">)</span>
<span class="cp">#endif</span>

<span class="c">!---------------------------------------------------------------------- END</span>
      <span class="k">END subroutine </span><span class="n">setup_H0</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2018 <a rel="license" href="http://www.gnu.org/licenses/old-licenses/fdl-1.2.en.html">GNU Free Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> SIESTA was developed by SIESTA Group</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>