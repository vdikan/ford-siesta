<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="A first-principles materials simulation code using Density Functional Theory.">
    
    <meta name="author" content="SIESTA Group" >
    <link rel="icon" href="../favicon.png">

    <title>mixers_scf_init &ndash; SIESTA</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">SIESTA <small>trunk-674--vdikan-ford-681</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>Program Overview</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>mixers_scf_init
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 2.1% of total for procedures.">110 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/m_mixing_scf.F90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/m_mixing_scf.f90.html'>m_mixing_scf.F90</a></li>
    
     <li><a href='../module/m_mixing_scf.html'>m_mixing_scf</a></li>
    
  
     <li class="active">mixers_scf_init</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/mixers_scf_init.html#src">mixers_scf_init</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine mixers_scf_init(nspin, Comm)
    
    
   
</h2>
    
  
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
      
      <li class="list-group-item">
  <ul class="list-inline">
    
    <li>fdf</li>
    
    <li>precision</li>
    
    <li><a href='../module/m_mixing.html'>m_mixing</a></li>
    
    <li><a href='../module/m_mixing.html'>m_mixing</a></li>
    
    <li><a href='../module/m_mixing.html'>m_mixing</a></li>
    
    <li><a href='../module/m_mixing.html'>m_mixing</a></li>
    
  </ul>
      </li>
      
      
      
      <li class="list-group-item">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: proc~~mixers_scf_init~~UsesGraph Pages: 1 -->
<svg id="procmixers_scf_initUsesGraph" width="343pt" height="126pt"
 viewBox="0.00 0.00 343.00 126.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~mixers_scf_init~~UsesGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 122)">
<title>proc~~mixers_scf_init~~UsesGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-122 339,-122 339,4 -4,4"/>
<!-- proc~mixers_scf_init -->
<g id="proc~~mixers_scf_init~~UsesGraph_node1" class="node">
<title>proc~mixers_scf_init</title>
<polygon fill="none" stroke="#000000" points="335,-98 252,-98 252,-74 335,-74 335,-98"/>
<text text-anchor="middle" x="293.5" y="-83.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">mixers_scf_init</text>
</g>
<!-- precision -->
<g id="proc~~mixers_scf_init~~UsesGraph_node2" class="node">
<title>precision</title>
<polygon fill="#337ab7" stroke="#337ab7" points="88.5,-118 33.5,-118 33.5,-94 88.5,-94 88.5,-118"/>
<text text-anchor="middle" x="61" y="-103.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">precision</text>
</g>
<!-- proc~mixers_scf_init&#45;&gt;precision -->
<g id="proc~~mixers_scf_init~~UsesGraph_edge1" class="edge">
<title>proc~mixers_scf_init&#45;&gt;precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M256.8515,-98.0643C244.073,-101.6979 229.5419,-105.1978 216,-107 176.2166,-112.2945 130.1803,-111.0807 98.6791,-109.1448"/>
<polygon fill="#000000" stroke="#000000" points="98.7949,-105.6448 88.5834,-108.469 98.3273,-112.6292 98.7949,-105.6448"/>
</g>
<!-- fdf -->
<g id="proc~~mixers_scf_init~~UsesGraph_node3" class="node">
<title>fdf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="214,-98 160,-98 160,-74 214,-74 214,-98"/>
<text text-anchor="middle" x="187" y="-83.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">fdf</text>
</g>
<!-- proc~mixers_scf_init&#45;&gt;fdf -->
<g id="proc~~mixers_scf_init~~UsesGraph_edge2" class="edge">
<title>proc~mixers_scf_init&#45;&gt;fdf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M251.714,-86C242.6669,-86 233.1563,-86 224.2951,-86"/>
<polygon fill="#000000" stroke="#000000" points="224.2579,-82.5001 214.2579,-86 224.2578,-89.5001 224.2579,-82.5001"/>
</g>
<!-- module~m_mixing -->
<g id="proc~~mixers_scf_init~~UsesGraph_node4" class="node">
<title>module~m_mixing</title>
<g id="a_proc~~mixers_scf_init~~UsesGraph_node4"><a xlink:href=".././module/m_mixing.html" xlink:title="m_mixing">
<polygon fill="#337ab7" stroke="#337ab7" points="216,-56 158,-56 158,-32 216,-32 216,-56"/>
<text text-anchor="middle" x="187" y="-41.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_mixing</text>
</a>
</g>
</g>
<!-- proc~mixers_scf_init&#45;&gt;module~m_mixing -->
<g id="proc~~mixers_scf_init~~UsesGraph_edge3" class="edge">
<title>proc~mixers_scf_init&#45;&gt;module~m_mixing</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M262.9814,-73.9645C251.3413,-69.374 237.9172,-64.08 225.6212,-59.2309"/>
<polygon fill="#000000" stroke="#000000" points="226.6444,-55.8721 216.0576,-55.4593 224.0763,-62.384 226.6444,-55.8721"/>
</g>
<!-- module~m_mixing&#45;&gt;precision -->
<g id="proc~~mixers_scf_init~~UsesGraph_edge4" class="edge">
<title>module~m_mixing&#45;&gt;precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M162.4068,-56.1014C143.0672,-65.6177 115.9193,-78.9762 94.5793,-89.4769"/>
<polygon fill="#000000" stroke="#000000" points="92.9584,-86.3736 85.5312,-93.9291 96.049,-92.6544 92.9584,-86.3736"/>
</g>
<!-- class_Fstack_dData1D -->
<g id="proc~~mixers_scf_init~~UsesGraph_node5" class="node">
<title>class_Fstack_dData1D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="122,-66 0,-66 0,-42 122,-42 122,-66"/>
<text text-anchor="middle" x="61" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">class_Fstack_dData1D</text>
</g>
<!-- module~m_mixing&#45;&gt;class_Fstack_dData1D -->
<g id="proc~~mixers_scf_init~~UsesGraph_edge6" class="edge">
<title>module~m_mixing&#45;&gt;class_Fstack_dData1D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M157.7764,-46.3193C150.0118,-46.9356 141.2754,-47.6289 132.3106,-48.3404"/>
<polygon fill="#000000" stroke="#000000" points="131.8232,-44.868 122.1315,-49.1483 132.3771,-51.8461 131.8232,-44.868"/>
</g>
<!-- class_dData1D -->
<g id="proc~~mixers_scf_init~~UsesGraph_node6" class="node">
<title>class_dData1D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="103.5,-24 18.5,-24 18.5,0 103.5,0 103.5,-24"/>
<text text-anchor="middle" x="61" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">class_dData1D</text>
</g>
<!-- module~m_mixing&#45;&gt;class_dData1D -->
<g id="proc~~mixers_scf_init~~UsesGraph_edge5" class="edge">
<title>module~m_mixing&#45;&gt;class_dData1D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M157.7764,-36.5781C144.6565,-33.2461 128.762,-29.2094 113.6789,-25.3788"/>
<polygon fill="#000000" stroke="#000000" points="114.4755,-21.97 103.9216,-22.9007 112.7524,-28.7547 114.4755,-21.97"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="490pt" height="32pt"
 viewBox="0.00 0.00 489.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 485.5,-28 485.5,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node">
<title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node">
<title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="139.5,-24 72.5,-24 72.5,0 139.5,0 139.5,-24"/>
<text text-anchor="middle" x="106" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="222,-24 158,-24 158,0 222,0 222,-24"/>
<text text-anchor="middle" x="190" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="294,-24 240,-24 240,0 294,0 294,-24"/>
<text text-anchor="middle" x="267" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="366,-24 312,-24 312,0 366,0 366,-24"/>
<text text-anchor="middle" x="339" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="481.5,-24 384.5,-24 384.5,0 481.5,0 481.5,-24"/>
<text text-anchor="middle" x="433" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses.
    </p>
    </div></div></div></div>
      </li>
      
      </ul>
    </div>
    


    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nspin"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nspin</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-comm"></span>integer,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>Comm</strong></td><td></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: proc~~mixers_scf_init~~CallsGraph Pages: 1 -->
<svg id="procmixers_scf_initCallsGraph" width="470pt" height="410pt"
 viewBox="0.00 0.00 470.00 410.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~mixers_scf_init~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 406)">
<title>proc~~mixers_scf_init~~CallsGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-406 466,-406 466,4 -4,4"/>
<!-- proc~mixers_scf_init -->
<g id="proc~~mixers_scf_init~~CallsGraph_node1" class="node">
<title>proc~mixers_scf_init</title>
<polygon fill="none" stroke="#000000" points="83,-189 0,-189 0,-165 83,-165 83,-189"/>
<text text-anchor="middle" x="41.5" y="-174.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">mixers_scf_init</text>
</g>
<!-- proc~mixers_reset -->
<g id="proc~~mixers_scf_init~~CallsGraph_node2" class="node">
<title>proc~mixers_reset</title>
<g id="a_proc~~mixers_scf_init~~CallsGraph_node2"><a xlink:href=".././proc/mixers_reset.html" xlink:title="mixers_reset">
<polygon fill="#d9534f" stroke="#d9534f" points="351.5,-402 277.5,-402 277.5,-378 351.5,-378 351.5,-402"/>
<text text-anchor="middle" x="314.5" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mixers_reset</text>
</a>
</g>
</g>
<!-- proc~mixers_scf_init&#45;&gt;proc~mixers_reset -->
<g id="proc~~mixers_scf_init~~CallsGraph_edge2" class="edge">
<title>proc~mixers_scf_init&#45;&gt;proc~mixers_reset</title>
<path fill="none" stroke="#000000" d="M46.2519,-189.2896C56.2618,-213.7498 81.7089,-269.0069 119,-302 162.2278,-340.2455 224.8184,-364.4463 267.4533,-377.5842"/>
<polygon fill="#000000" stroke="#000000" points="266.7186,-381.0177 277.3023,-380.5322 268.7259,-374.3116 266.7186,-381.0177"/>
</g>
<!-- leqi -->
<g id="proc~~mixers_scf_init~~CallsGraph_node3" class="node">
<title>leqi</title>
<polygon fill="#777777" stroke="#777777" points="341.5,-24 287.5,-24 287.5,0 341.5,0 341.5,-24"/>
<text text-anchor="middle" x="314.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">leqi</text>
</g>
<!-- proc~mixers_scf_init&#45;&gt;leqi -->
<g id="proc~~mixers_scf_init~~CallsGraph_edge3" class="edge">
<title>proc~mixers_scf_init&#45;&gt;leqi</title>
<path fill="none" stroke="#000000" d="M47.0797,-164.8368C57.8158,-142.786 83.4685,-96.1677 119,-71 132.1138,-61.7112 224.7207,-35.9839 277.6388,-21.7631"/>
<polygon fill="#000000" stroke="#000000" points="278.5895,-25.1319 287.3439,-19.1644 276.7789,-18.3701 278.5895,-25.1319"/>
</g>
<!-- proc~mix_method -->
<g id="proc~~mixers_scf_init~~CallsGraph_node4" class="node">
<title>proc~mix_method</title>
<g id="a_proc~~mixers_scf_init~~CallsGraph_node4"><a xlink:href=".././proc/mix_method.html" xlink:title="mix_method">
<polygon fill="#d94e8f" stroke="#d94e8f" points="209,-104 138,-104 138,-80 209,-80 209,-104"/>
<text text-anchor="middle" x="173.5" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mix_method</text>
</a>
</g>
</g>
<!-- proc~mixers_scf_init&#45;&gt;proc~mix_method -->
<g id="proc~~mixers_scf_init~~CallsGraph_edge4" class="edge">
<title>proc~mixers_scf_init&#45;&gt;proc~mix_method</title>
<path fill="none" stroke="#000000" d="M60.4124,-164.8216C82.859,-150.3673 120.4679,-126.1494 146.1002,-109.6438"/>
<polygon fill="#000000" stroke="#000000" points="148.11,-112.5126 154.6227,-104.1558 144.3201,-106.6272 148.11,-112.5126"/>
</g>
<!-- fdf_get -->
<g id="proc~~mixers_scf_init~~CallsGraph_node5" class="node">
<title>fdf_get</title>
<polygon fill="#777777" stroke="#777777" points="341.5,-318 287.5,-318 287.5,-294 341.5,-294 341.5,-318"/>
<text text-anchor="middle" x="314.5" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">fdf_get</text>
</g>
<!-- proc~mixers_scf_init&#45;&gt;fdf_get -->
<g id="proc~~mixers_scf_init~~CallsGraph_edge5" class="edge">
<title>proc~mixers_scf_init&#45;&gt;fdf_get</title>
<path fill="none" stroke="#000000" d="M60.9008,-189.1098C76.3703,-198.558 98.7268,-211.7536 119,-222 181.71,-253.6946 199.3365,-257.5096 264,-285 268.5139,-286.919 273.2623,-288.9186 277.9668,-290.8881"/>
<polygon fill="#000000" stroke="#000000" points="276.8958,-294.2336 287.4725,-294.8532 279.5907,-287.7731 276.8958,-294.2336"/>
</g>
<!-- proc~mixers_history_init -->
<g id="proc~~mixers_scf_init~~CallsGraph_node6" class="node">
<title>proc~mixers_history_init</title>
<g id="a_proc~~mixers_scf_init~~CallsGraph_node6"><a xlink:href=".././proc/mixers_history_init.html" xlink:title="mixers_history_init">
<polygon fill="#d9534f" stroke="#d9534f" points="365,-360 264,-360 264,-336 365,-336 365,-360"/>
<text text-anchor="middle" x="314.5" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mixers_history_init</text>
</a>
</g>
</g>
<!-- proc~mixers_scf_init&#45;&gt;proc~mixers_history_init -->
<g id="proc~~mixers_scf_init~~CallsGraph_edge1" class="edge">
<title>proc~mixers_scf_init&#45;&gt;proc~mixers_history_init</title>
<path fill="none" stroke="#000000" d="M50.3335,-189.1028C63.6134,-206.6166 90.2476,-239.2009 119,-260 164.7877,-293.1222 225.0296,-317.9095 266.4753,-332.5981"/>
<polygon fill="#000000" stroke="#000000" points="265.4689,-335.9536 276.0637,-335.9351 267.7698,-329.3426 265.4689,-335.9536"/>
</g>
<!-- proc~mixers_init -->
<g id="proc~~mixers_scf_init~~CallsGraph_node7" class="node">
<title>proc~mixers_init</title>
<g id="a_proc~~mixers_scf_init~~CallsGraph_node7"><a xlink:href=".././proc/mixers_init.html" xlink:title="mixers_init">
<polygon fill="#d9534f" stroke="#d9534f" points="205.5,-213 141.5,-213 141.5,-189 205.5,-189 205.5,-213"/>
<text text-anchor="middle" x="173.5" y="-198.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mixers_init</text>
</a>
</g>
</g>
<!-- proc~mixers_scf_init&#45;&gt;proc~mixers_init -->
<g id="proc~~mixers_scf_init~~CallsGraph_edge7" class="edge">
<title>proc~mixers_scf_init&#45;&gt;proc~mixers_init</title>
<path fill="none" stroke="#000000" d="M83.2656,-184.5938C98.4851,-187.3609 115.7012,-190.4911 130.985,-193.27"/>
<polygon fill="#000000" stroke="#000000" points="130.7443,-196.7836 141.2092,-195.1289 131.9966,-189.8965 130.7443,-196.7836"/>
</g>
<!-- proc~mix_method_variant -->
<g id="proc~~mixers_scf_init~~CallsGraph_node8" class="node">
<title>proc~mix_method_variant</title>
<g id="a_proc~~mixers_scf_init~~CallsGraph_node8"><a xlink:href=".././proc/mix_method_variant.html" xlink:title="mix_method_variant">
<polygon fill="#d94e8f" stroke="#d94e8f" points="228,-24 119,-24 119,0 228,0 228,-24"/>
<text text-anchor="middle" x="173.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mix_method_variant</text>
</a>
</g>
</g>
<!-- proc~mixers_scf_init&#45;&gt;proc~mix_method_variant -->
<g id="proc~~mixers_scf_init~~CallsGraph_edge8" class="edge">
<title>proc~mixers_scf_init&#45;&gt;proc~mix_method_variant</title>
<path fill="none" stroke="#000000" d="M45.3525,-164.9914C54.3157,-138.7474 78.907,-75.6249 119,-38 122.5403,-34.6776 126.5834,-31.7064 130.8314,-29.068"/>
<polygon fill="#000000" stroke="#000000" points="132.7035,-32.0318 139.7434,-24.114 129.3025,-25.9135 132.7035,-32.0318"/>
</g>
<!-- die -->
<g id="proc~~mixers_scf_init~~CallsGraph_node9" class="node">
<title>die</title>
<polygon fill="#777777" stroke="#777777" points="341.5,-66 287.5,-66 287.5,-42 341.5,-42 341.5,-66"/>
<text text-anchor="middle" x="314.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">die</text>
</g>
<!-- proc~mixers_scf_init&#45;&gt;die -->
<g id="proc~~mixers_scf_init~~CallsGraph_edge6" class="edge">
<title>proc~mixers_scf_init&#45;&gt;die</title>
<path fill="none" stroke="#000000" d="M83.3209,-168.7311C122.8925,-159.5548 182.7962,-142.0696 228,-113 247.5676,-100.4165 244.8419,-88.1985 264,-75 268.336,-72.0128 273.1631,-69.3344 278.065,-66.9712"/>
<polygon fill="#000000" stroke="#000000" points="279.7401,-70.0576 287.4745,-62.8167 276.9128,-63.654 279.7401,-70.0576"/>
</g>
<!-- delete -->
<g id="proc~~mixers_scf_init~~CallsGraph_node12" class="node">
<title>delete</title>
<polygon fill="#777777" stroke="#777777" points="458.5,-402 404.5,-402 404.5,-378 458.5,-378 458.5,-402"/>
<text text-anchor="middle" x="431.5" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">delete</text>
</g>
<!-- proc~mixers_reset&#45;&gt;delete -->
<g id="proc~~mixers_scf_init~~CallsGraph_edge9" class="edge">
<title>proc~mixers_reset&#45;&gt;delete</title>
<path fill="none" stroke="#000000" d="M351.5195,-390C365.1769,-390 380.6482,-390 394.3197,-390"/>
<polygon fill="#000000" stroke="#000000" points="394.3638,-393.5001 404.3638,-390 394.3637,-386.5001 394.3638,-393.5001"/>
</g>
<!-- proc~mix_method&#45;&gt;leqi -->
<g id="proc~~mixers_scf_init~~CallsGraph_edge11" class="edge">
<title>proc~mix_method&#45;&gt;leqi</title>
<path fill="none" stroke="#000000" d="M202.9445,-79.9045C211.3219,-75.9508 220.2656,-71.2184 228,-66 245.9928,-53.8604 245.7033,-44.6765 264,-33 268.3898,-30.1986 273.2164,-27.6336 278.0913,-25.3324"/>
<polygon fill="#000000" stroke="#000000" points="279.6711,-28.4614 287.4231,-21.2394 276.8594,-22.0509 279.6711,-28.4614"/>
</g>
<!-- proc~mix_method&#45;&gt;die -->
<g id="proc~~mixers_scf_init~~CallsGraph_edge10" class="edge">
<title>proc~mix_method&#45;&gt;die</title>
<path fill="none" stroke="#000000" d="M209.0803,-82.411C229.9729,-76.7803 256.3395,-69.6745 277.4771,-63.9778"/>
<polygon fill="#000000" stroke="#000000" points="278.6421,-67.2888 287.3868,-61.3071 276.8205,-60.5299 278.6421,-67.2888"/>
</g>
<!-- proc~mixers_history_init&#45;&gt;delete -->
<g id="proc~~mixers_scf_init~~CallsGraph_edge14" class="edge">
<title>proc~mixers_history_init&#45;&gt;delete</title>
<path fill="none" stroke="#000000" d="M348.0275,-360.0355C362.6511,-365.285 379.8377,-371.4546 394.8029,-376.8267"/>
<polygon fill="#000000" stroke="#000000" points="393.6726,-380.1395 404.2671,-380.2241 396.0377,-373.5512 393.6726,-380.1395"/>
</g>
<!-- proc~current_itt -->
<g id="proc~~mixers_scf_init~~CallsGraph_node13" class="node">
<title>proc~current_itt</title>
<g id="a_proc~~mixers_scf_init~~CallsGraph_node13"><a xlink:href=".././proc/current_itt.html" xlink:title="current_itt">
<polygon fill="#d94e8f" stroke="#d94e8f" points="462,-318 401,-318 401,-294 462,-294 462,-318"/>
<text text-anchor="middle" x="431.5" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">current_itt</text>
</a>
</g>
</g>
<!-- proc~mixers_history_init&#45;&gt;proc~current_itt -->
<g id="proc~~mixers_scf_init~~CallsGraph_edge12" class="edge">
<title>proc~mixers_history_init&#45;&gt;proc~current_itt</title>
<path fill="none" stroke="#000000" d="M348.0275,-335.9645C361.5242,-331.1195 377.2042,-325.4908 391.306,-320.4286"/>
<polygon fill="#000000" stroke="#000000" points="392.541,-323.704 400.7704,-317.0311 390.1759,-317.1157 392.541,-323.704"/>
</g>
<!-- new -->
<g id="proc~~mixers_scf_init~~CallsGraph_node14" class="node">
<title>new</title>
<polygon fill="#777777" stroke="#777777" points="458.5,-360 404.5,-360 404.5,-336 458.5,-336 458.5,-360"/>
<text text-anchor="middle" x="431.5" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">new</text>
</g>
<!-- proc~mixers_history_init&#45;&gt;new -->
<g id="proc~~mixers_scf_init~~CallsGraph_edge13" class="edge">
<title>proc~mixers_history_init&#45;&gt;new</title>
<path fill="none" stroke="#000000" d="M365.1374,-348C374.9195,-348 385.0002,-348 394.2587,-348"/>
<polygon fill="#000000" stroke="#000000" points="394.3028,-351.5001 404.3028,-348 394.3027,-344.5001 394.3028,-351.5001"/>
</g>
<!-- proc~mixers_init&#45;&gt;proc~mixers_reset -->
<g id="proc~~mixers_scf_init~~CallsGraph_edge17" class="edge">
<title>proc~mixers_init&#45;&gt;proc~mixers_reset</title>
<path fill="none" stroke="#000000" d="M176.9815,-213.3668C186.171,-243.8989 213.8815,-323.6599 264,-369 265.4787,-370.3377 267.0546,-371.5973 268.7018,-372.7825"/>
<polygon fill="#000000" stroke="#000000" points="267.0548,-375.8777 277.4125,-378.1068 270.7055,-369.9051 267.0548,-375.8777"/>
</g>
<!-- proc~mixers_init&#45;&gt;fdf_get -->
<g id="proc~~mixers_scf_init~~CallsGraph_edge19" class="edge">
<title>proc~mixers_init&#45;&gt;fdf_get</title>
<path fill="none" stroke="#000000" d="M183.8465,-213.004C199.6332,-230.719 231.3574,-264.0252 264,-285 268.381,-287.8151 273.2027,-290.3878 278.0751,-292.6928"/>
<polygon fill="#000000" stroke="#000000" points="276.8416,-295.9737 287.405,-296.7888 279.6555,-289.5642 276.8416,-295.9737"/>
</g>
<!-- proc~mixers_init&#45;&gt;proc~mixers_history_init -->
<g id="proc~~mixers_scf_init~~CallsGraph_edge16" class="edge">
<title>proc~mixers_init&#45;&gt;proc~mixers_history_init</title>
<path fill="none" stroke="#000000" d="M179.2704,-213.1108C191.5707,-237.7556 222.6564,-294.1776 264,-327 265.7522,-328.3911 267.6098,-329.704 269.5383,-330.9414"/>
<polygon fill="#000000" stroke="#000000" points="267.9104,-334.0413 278.3426,-335.8906 271.3406,-327.9393 267.9104,-334.0413"/>
</g>
<!-- proc~mixers_init&#45;&gt;die -->
<g id="proc~~mixers_scf_init~~CallsGraph_edge22" class="edge">
<title>proc~mixers_init&#45;&gt;die</title>
<path fill="none" stroke="#000000" d="M204.2225,-188.9409C212.8245,-184.3725 221.5697,-178.4331 228,-171 257.8127,-136.5378 232.3525,-107.7854 264,-75 267.9567,-70.901 272.8328,-67.5699 277.9799,-64.8718"/>
<polygon fill="#000000" stroke="#000000" points="279.6913,-67.9409 287.3973,-60.6699 276.839,-61.5483 279.6913,-67.9409"/>
</g>
<!-- fdf_bnames -->
<g id="proc~~mixers_scf_init~~CallsGraph_node10" class="node">
<title>fdf_bnames</title>
<polygon fill="#777777" stroke="#777777" points="349,-276 280,-276 280,-252 349,-252 349,-276"/>
<text text-anchor="middle" x="314.5" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">fdf_bnames</text>
</g>
<!-- proc~mixers_init&#45;&gt;fdf_bnames -->
<g id="proc~~mixers_scf_init~~CallsGraph_edge15" class="edge">
<title>proc~mixers_init&#45;&gt;fdf_bnames</title>
<path fill="none" stroke="#000000" d="M198.7319,-213.0426C216.8167,-221.5924 241.8017,-233.2383 264,-243 267.8136,-244.677 271.8033,-246.396 275.7968,-248.0934"/>
<polygon fill="#000000" stroke="#000000" points="274.466,-251.3306 285.0407,-251.9847 277.182,-244.879 274.466,-251.3306"/>
</g>
<!-- fdf_bline -->
<g id="proc~~mixers_scf_init~~CallsGraph_node11" class="node">
<title>fdf_bline</title>
<polygon fill="#777777" stroke="#777777" points="341.5,-234 287.5,-234 287.5,-210 341.5,-210 341.5,-234"/>
<text text-anchor="middle" x="314.5" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">fdf_bline</text>
</g>
<!-- proc~mixers_init&#45;&gt;fdf_bline -->
<g id="proc~~mixers_scf_init~~CallsGraph_edge18" class="edge">
<title>proc~mixers_init&#45;&gt;fdf_bline</title>
<path fill="none" stroke="#000000" d="M205.8482,-205.8178C227.0453,-208.9748 254.8271,-213.1125 276.9916,-216.4136"/>
<polygon fill="#000000" stroke="#000000" points="276.6446,-219.9005 287.0511,-217.9119 277.6758,-212.9769 276.6446,-219.9005"/>
</g>
<!-- fdf_block -->
<g id="proc~~mixers_scf_init~~CallsGraph_node15" class="node">
<title>fdf_block</title>
<polygon fill="#777777" stroke="#777777" points="342,-192 287,-192 287,-168 342,-168 342,-192"/>
<text text-anchor="middle" x="314.5" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">fdf_block</text>
</g>
<!-- proc~mixers_init&#45;&gt;fdf_block -->
<g id="proc~~mixers_scf_init~~CallsGraph_edge20" class="edge">
<title>proc~mixers_init&#45;&gt;fdf_block</title>
<path fill="none" stroke="#000000" d="M205.8482,-196.1822C226.9049,-193.0461 254.4594,-188.9422 276.5505,-185.6521"/>
<polygon fill="#000000" stroke="#000000" points="277.2124,-189.0922 286.5877,-184.1572 276.1811,-182.1685 277.2124,-189.0922"/>
</g>
<!-- fdf_brewind -->
<g id="proc~~mixers_scf_init~~CallsGraph_node16" class="node">
<title>fdf_brewind</title>
<polygon fill="#777777" stroke="#777777" points="348.5,-150 280.5,-150 280.5,-126 348.5,-126 348.5,-150"/>
<text text-anchor="middle" x="314.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">fdf_brewind</text>
</g>
<!-- proc~mixers_init&#45;&gt;fdf_brewind -->
<g id="proc~~mixers_scf_init~~CallsGraph_edge21" class="edge">
<title>proc~mixers_init&#45;&gt;fdf_brewind</title>
<path fill="none" stroke="#000000" d="M198.7319,-188.9574C216.8167,-180.4076 241.8017,-168.7617 264,-159 267.8136,-157.323 271.8033,-155.604 275.7968,-153.9066"/>
<polygon fill="#000000" stroke="#000000" points="277.182,-157.121 285.0407,-150.0153 274.466,-150.6694 277.182,-157.121"/>
</g>
<!-- fdf_bnnames -->
<g id="proc~~mixers_scf_init~~CallsGraph_node17" class="node">
<title>fdf_bnnames</title>
<polygon fill="#777777" stroke="#777777" points="352,-108 277,-108 277,-84 352,-84 352,-108"/>
<text text-anchor="middle" x="314.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">fdf_bnnames</text>
</g>
<!-- proc~mixers_init&#45;&gt;fdf_bnnames -->
<g id="proc~~mixers_scf_init~~CallsGraph_edge23" class="edge">
<title>proc~mixers_init&#45;&gt;fdf_bnnames</title>
<path fill="none" stroke="#000000" d="M201.527,-188.8593C210.5914,-184.1109 220.2846,-178.0874 228,-171 249.2424,-151.4869 241.7253,-135.3258 264,-117 265.5673,-115.7105 267.225,-114.49 268.947,-113.3358"/>
<polygon fill="#000000" stroke="#000000" points="271.0743,-116.1484 277.9725,-108.1069 267.5652,-110.0915 271.0743,-116.1484"/>
</g>
<!-- proc~mix_method_variant&#45;&gt;leqi -->
<g id="proc~~mixers_scf_init~~CallsGraph_edge24" class="edge">
<title>proc~mix_method_variant&#45;&gt;leqi</title>
<path fill="none" stroke="#000000" d="M228.0143,-12C244.3524,-12 261.8996,-12 276.8899,-12"/>
<polygon fill="#000000" stroke="#000000" points="277.2995,-15.5001 287.2994,-12 277.2994,-8.5001 277.2995,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,0 64,0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,0 136,0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,0 209.5,0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,0 364,0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,0 436,0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="551.5,-24 454.5,-24 454.5,0 551.5,0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/mixers_scf_init.html#src">mixers_scf_init</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>  <span class="k">subroutine </span><span class="n">mixers_scf_init</span><span class="p">(</span> <span class="n">nspin</span><span class="p">,</span> <span class="n">Comm</span> <span class="p">)</span>

    <span class="k">use </span><span class="n">fdf</span>
    <span class="k">use </span><span class="nb">precision</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">dp</span>
<span class="cp">#ifdef MPI</span>
    <span class="k">use </span><span class="n">mpi_siesta</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">MPI_Comm_World</span>
<span class="cp">#endif</span>
    <span class="k">use </span><span class="n">m_mixing</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">mixers_reset</span><span class="p">,</span> <span class="n">mixers_init</span>
    <span class="k">use </span><span class="n">m_mixing</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">mix_method</span><span class="p">,</span> <span class="n">mix_method_variant</span>
    <span class="k">use </span><span class="n">m_mixing</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">mixer_init</span>
    <span class="k">use </span><span class="n">m_mixing</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">mixers_history_init</span>

    <span class="c">! The number of spin-components</span>
    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nspin</span>
    
    <span class="c">! The communicator used for the mixer</span>
    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">Comm</span>

    <span class="c">! Block constructs</span>
    <span class="k">type</span><span class="p">(</span><span class="n">block_fdf</span><span class="p">)</span> <span class="kd">::</span> <span class="n">bfdf</span>

    <span class="c">! Get number of history steps</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">n_hist</span><span class="p">,</span> <span class="n">n_kick</span><span class="p">,</span> <span class="n">n_restart</span><span class="p">,</span> <span class="n">n_save</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">w</span><span class="p">,</span> <span class="n">w_kick</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">n_lin_after</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">w_lin_after</span>
    <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lin_after</span>

    <span class="c">! number of history steps saved</span>
    <span class="k">type</span><span class="p">(</span><span class="n">tMixer</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">m</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">nm</span><span class="p">,</span> <span class="n">im</span><span class="p">,</span> <span class="n">im2</span><span class="p">,</span> <span class="n">tmp</span>
    <span class="kt">logical</span> <span class="kd">::</span> <span class="n">is_broyden</span>
    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">70</span><span class="p">)</span> <span class="kd">::</span> <span class="n">method</span><span class="p">,</span> <span class="n">variant</span><span class="p">,</span> <span class="n">opt</span>
    
    <span class="c">! If the mixers are denoted by a block, then</span>
    <span class="c">! the entire logic *MUST* be defined in the blocks</span>
    
    <span class="n">opt</span> <span class="o">=</span> <span class="n">fdf_get</span><span class="p">(</span><span class="s1">&#39;SCF.Mix.Spin&#39;</span><span class="p">,</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
    <span class="k">if</span>      <span class="p">(</span> <span class="n">leqi</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">       </span><span class="n">mix_spin</span> <span class="o">=</span> <span class="n">MIX_SPIN_ALL</span>
    <span class="k">else if</span> <span class="p">(</span> <span class="n">leqi</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="s1">&#39;spinor&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">       </span><span class="n">mix_spin</span> <span class="o">=</span> <span class="n">MIX_SPIN_SPINOR</span>
    <span class="k">else if</span> <span class="p">(</span> <span class="n">leqi</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="s1">&#39;sum&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">       </span><span class="n">mix_spin</span> <span class="o">=</span> <span class="n">MIX_SPIN_SUM</span>
    <span class="k">else if</span> <span class="p">(</span> <span class="n">leqi</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="s1">&#39;sum+diff&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">       </span><span class="n">mix_spin</span> <span class="o">=</span> <span class="n">MIX_SPIN_SUM_DIFF</span>
    <span class="k">else</span>
<span class="k">       call </span><span class="n">die</span><span class="p">(</span><span class="s2">&quot;Unknown option given for SCF.Mix.Spin &amp;</span>
<span class="s2">            &amp;all|spinor|sum|sum+diff&quot;</span><span class="p">)</span>
    <span class="k">end if</span>
    <span class="c">! If there is only one spinor we should mix all...</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">nspin</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="n">mix_spin</span> <span class="o">=</span> <span class="n">MIX_SPIN_ALL</span>

    <span class="c">! Initialize to ensure debug stuff read</span>
    <span class="k">call </span><span class="n">mixers_init</span><span class="p">(</span><span class="s1">&#39;SCF&#39;</span><span class="p">,</span> <span class="n">scf_mixs</span><span class="p">,</span> <span class="n">Comm</span> <span class="o">=</span> <span class="n">Comm</span> <span class="p">)</span>

    <span class="c">! Check for existance of the SCF.Mix block</span>
    <span class="k">if</span> <span class="p">(</span> <span class="nb">associated</span><span class="p">(</span><span class="n">scf_mixs</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>

<span class="k">       if</span> <span class="p">(</span> <span class="n">size</span><span class="p">(</span><span class="n">scf_mixs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">          return</span>
<span class="k">       end if</span>

       <span class="c">! Something has gone wrong...</span>
       <span class="c">! The user has supplied a block, but</span>
       <span class="c">! haven&#39;t added any content to the block...</span>
       <span class="c">! However, we fall-back to the default mechanism</span>
       
    <span class="k">end if</span>

    <span class="c">! ensure nullification</span>
    <span class="k">call </span><span class="n">mixers_reset</span><span class="p">(</span><span class="n">scf_mixs</span><span class="p">)</span>


    <span class="c">! &gt;&gt;&gt;*** FIRST ***&lt;&lt;&lt;</span>
    <span class="c">! Read in compatibility options</span>
    
    <span class="c">! Figure out if we are dealing with</span>
    <span class="c">! Broyden or Pulay</span>
    <span class="n">n_hist</span> <span class="o">=</span> <span class="n">fdf_get</span><span class="p">(</span><span class="s1">&#39;DM.NumberPulay&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">fdf_get</span><span class="p">(</span><span class="s1">&#39;DM.NumberBroyden&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">is_broyden</span> <span class="o">=</span> <span class="n">tmp</span> <span class="o">&gt;</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">is_broyden</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">       </span><span class="n">n_hist</span> <span class="o">=</span> <span class="n">tmp</span>
    <span class="k">end if</span>

    <span class="c">! Define default mixing weight (used for </span>
    <span class="c">! Pulay, Broyden and linear mixing)</span>
    <span class="n">w</span>      <span class="o">=</span> <span class="n">fdf_get</span><span class="p">(</span><span class="s1">&#39;DM.MixingWeight&#39;</span><span class="p">,</span> <span class="mf">0.25_dp</span><span class="p">)</span>

    <span class="c">! Default kick-options</span>
    <span class="n">n_kick</span> <span class="o">=</span> <span class="n">fdf_get</span><span class="p">(</span><span class="s1">&#39;DM.NumberKick&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">w_kick</span> <span class="o">=</span> <span class="n">fdf_get</span><span class="p">(</span><span class="s1">&#39;DM.KickMixingWeight&#39;</span><span class="p">,</span> <span class="mf">0.5_dp</span><span class="p">)</span>

    <span class="n">lin_after</span> <span class="o">=</span> <span class="n">fdf_get</span><span class="p">(</span><span class="s1">&#39;SCF.LinearMixingAfterPulay&#39;</span><span class="p">,</span> <span class="p">.</span><span class="n">false</span><span class="p">.)</span>
    <span class="n">w_lin_after</span> <span class="o">=</span> <span class="n">fdf_get</span><span class="p">(</span><span class="s1">&#39;SCF.MixingWeightAfterPulay&#39;</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
    <span class="c">! &gt;&gt;&gt;*** END ***&lt;&lt;&lt;</span>


    <span class="c">! Read options in new format</span>

    <span class="c">! Get history length</span>
    <span class="n">n_hist</span> <span class="o">=</span> <span class="n">fdf_get</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.History&#39;</span><span class="p">,</span> <span class="n">n_hist</span><span class="p">)</span>

    <span class="c">! update mixing weight and kick mixing weight</span>
    <span class="n">w</span>      <span class="o">=</span> <span class="n">fdf_get</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Weight&#39;</span><span class="p">,</span><span class="n">w</span><span class="p">)</span>
    <span class="n">n_kick</span> <span class="o">=</span> <span class="n">fdf_get</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Kick&#39;</span><span class="p">,</span><span class="n">n_kick</span><span class="p">)</span>
    <span class="n">w_kick</span> <span class="o">=</span> <span class="n">fdf_get</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Kick.Weight&#39;</span><span class="p">,</span><span class="n">w_kick</span><span class="p">)</span>

    <span class="c">! Restart after this number of iterations</span>
    <span class="n">n_restart</span> <span class="o">=</span> <span class="n">fdf_get</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Restart&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">n_save</span>    <span class="o">=</span> <span class="n">fdf_get</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Restart.Save&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c">! negative savings are not allowed</span>
    <span class="n">n_save</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_save</span><span class="p">)</span>

    <span class="c">! Get the variant of the mixing method</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">is_broyden</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">       </span><span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;Broyden&#39;</span>
    <span class="k">else if</span> <span class="p">(</span> <span class="n">n_hist</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">       </span><span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;Pulay&#39;</span>
    <span class="k">else</span>
<span class="k">       </span><span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;Linear&#39;</span>
    <span class="k">end if</span>
<span class="k">    </span><span class="n">method</span> <span class="o">=</span> <span class="n">fdf_get</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Method&#39;</span><span class="p">,</span> <span class="nb">trim</span><span class="p">(</span><span class="n">method</span><span class="p">))</span>
    <span class="n">variant</span> <span class="o">=</span> <span class="n">fdf_get</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Variant&#39;</span><span class="p">,</span> <span class="s1">&#39;original&#39;</span><span class="p">)</span>

    
    <span class="c">! Determine whether linear mixing should be</span>
    <span class="c">! performed after the &quot;advanced&quot; mixing</span>
    <span class="n">n_lin_after</span> <span class="o">=</span> <span class="n">fdf_get</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Linear.After&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">w_lin_after</span> <span class="o">=</span> <span class="n">fdf_get</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Linear.After.Weight&#39;</span><span class="p">,</span> <span class="n">w_lin_after</span><span class="p">)</span>
    
    <span class="c">! Determine total number of mixers</span>
    <span class="n">nm</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">n_lin_after</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">lin_after</span> <span class="p">)</span> <span class="n">nm</span> <span class="o">=</span> <span class="n">nm</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">n_kick</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="n">nm</span> <span class="o">=</span> <span class="n">nm</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="c">! Initiailaze all mixers</span>
    <span class="k">allocate</span><span class="p">(</span><span class="n">scf_mixs</span><span class="p">(</span><span class="n">nm</span><span class="p">))</span>
    <span class="n">scf_mixs</span><span class="p">(:)%</span><span class="n">w</span> <span class="o">=</span> <span class="n">w</span>
    <span class="n">scf_mixs</span><span class="p">(:)%</span><span class="n">n_hist</span> <span class="o">=</span> <span class="n">n_hist</span>
    <span class="n">scf_mixs</span><span class="p">(:)%</span><span class="n">restart</span> <span class="o">=</span> <span class="n">n_restart</span>
    <span class="n">scf_mixs</span><span class="p">(:)%</span><span class="n">restart_save</span> <span class="o">=</span> <span class="n">n_save</span>
    
    <span class="c">! 1. Current mixing index</span>
    <span class="n">im</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="c">! Store the advanced mixer index (for references to</span>
    <span class="c">! later mixers)</span>
    <span class="n">im2</span> <span class="o">=</span> <span class="n">im</span>
    <span class="n">m</span> <span class="o">=&gt;</span> <span class="n">scf_mixs</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
    <span class="n">m</span><span class="p">%</span><span class="n">name</span> <span class="o">=</span> <span class="n">method</span>
    <span class="n">m</span><span class="p">%</span><span class="n">m</span> <span class="o">=</span> <span class="n">mix_method</span><span class="p">(</span><span class="n">method</span><span class="p">)</span>
    <span class="n">m</span><span class="p">%</span><span class="n">v</span> <span class="o">=</span> <span class="n">mix_method_variant</span><span class="p">(</span><span class="n">m</span><span class="p">%</span><span class="n">m</span><span class="p">,</span> <span class="n">variant</span><span class="p">)</span>

    <span class="c">! 2. Setup the linear mixing after the actual mixing</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">n_lin_after</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">lin_after</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">       </span><span class="n">im</span> <span class="o">=</span> <span class="n">im</span> <span class="o">+</span> <span class="mi">1</span>
       <span class="n">m</span> <span class="o">=&gt;</span> <span class="n">scf_mixs</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
       <span class="c">! Signal to switch to this mixer after</span>
       <span class="c">! convergence</span>
       <span class="n">scf_mixs</span><span class="p">(</span><span class="n">im2</span><span class="p">)%</span><span class="n">next_conv</span> <span class="o">=&gt;</span> <span class="n">m</span>
       <span class="n">m</span><span class="p">%</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Linear-After&#39;</span>
       <span class="n">m</span><span class="p">%</span><span class="n">m</span> <span class="o">=</span> <span class="n">mix_method</span><span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
       <span class="n">m</span><span class="p">%</span><span class="n">w</span> <span class="o">=</span> <span class="n">w_lin_after</span>
       <span class="n">m</span><span class="p">%</span><span class="n">n_itt</span> <span class="o">=</span> <span class="n">n_lin_after</span>
       <span class="c">! jump back to previous after having run a</span>
       <span class="c">! few iterations</span>
       <span class="n">m</span><span class="p">%</span><span class="n">next</span> <span class="o">=&gt;</span> <span class="n">scf_mixs</span><span class="p">(</span><span class="n">im2</span><span class="p">)</span>

    <span class="k">end if</span>
    
    <span class="c">! In case we have a kick, apply the kick here</span>
    <span class="c">! This overrides the &quot;linear.after&quot; option</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">n_kick</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">       </span>
<span class="k">       </span><span class="n">im</span> <span class="o">=</span> <span class="n">im</span> <span class="o">+</span> <span class="mi">1</span>
       <span class="n">m</span> <span class="o">=&gt;</span> <span class="n">scf_mixs</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
       <span class="n">m</span><span class="p">%</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Linear-Kick&#39;</span>
       <span class="n">m</span><span class="p">%</span><span class="n">n_itt</span> <span class="o">=</span> <span class="mi">1</span>
       <span class="n">m</span><span class="p">%</span><span class="n">n_hist</span> <span class="o">=</span> <span class="mi">0</span>
       <span class="n">m</span><span class="p">%</span><span class="n">m</span> <span class="o">=</span> <span class="n">mix_method</span><span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
       <span class="n">m</span><span class="p">%</span><span class="n">w</span> <span class="o">=</span> <span class="n">w_kick</span>
       <span class="n">m</span><span class="p">%</span><span class="n">next</span> <span class="o">=&gt;</span> <span class="n">scf_mixs</span><span class="p">(</span><span class="n">im2</span><span class="p">)</span>

       <span class="c">! set the default mixer to kick</span>
       <span class="n">scf_mixs</span><span class="p">(</span><span class="n">im2</span><span class="p">)%</span><span class="n">n_itt</span> <span class="o">=</span> <span class="n">n_kick</span> <span class="o">-</span> <span class="mi">1</span>
       <span class="n">scf_mixs</span><span class="p">(</span><span class="n">im2</span><span class="p">)%</span><span class="n">next</span> <span class="o">=&gt;</span> <span class="n">m</span>
       <span class="n">scf_mixs</span><span class="p">(</span><span class="n">im2</span><span class="p">)%</span><span class="n">restart</span> <span class="o">=</span> <span class="n">n_kick</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="k">end if</span>

    <span class="c">! Correct the input</span>
    <span class="k">do </span><span class="n">im</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">nm</span>
       <span class="k">call </span><span class="n">mixer_init</span><span class="p">(</span> <span class="n">scf_mixs</span><span class="p">(</span><span class="n">im</span><span class="p">)</span> <span class="p">)</span>
    <span class="k">end do</span>

    <span class="c">! Initialize the allocation of each mixer</span>
    <span class="k">call </span><span class="n">mixers_history_init</span><span class="p">(</span> <span class="n">scf_mixs</span> <span class="p">)</span>
    
<span class="cp">#ifdef MPI</span>
    <span class="k">if</span> <span class="p">(</span> <span class="nb">present</span><span class="p">(</span><span class="n">Comm</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">       </span><span class="n">scf_mixs</span><span class="p">(:)%</span><span class="n">Comm</span> <span class="o">=</span> <span class="n">Comm</span>
    <span class="k">else</span>
<span class="k">       </span><span class="n">scf_mixs</span><span class="p">(:)%</span><span class="n">Comm</span> <span class="o">=</span> <span class="n">MPI_Comm_World</span>
    <span class="k">end if</span>
<span class="cp">#endif</span>
    
  <span class="k">end subroutine </span><span class="n">mixers_scf_init</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2018 <a rel="license" href="http://www.gnu.org/licenses/old-licenses/fdl-1.2.en.html">GNU Free Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> SIESTA was developed by SIESTA Group</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>