<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="A first-principles materials simulation code using Density Functional Theory.">
    
    <meta name="author" content="SIESTA Group" >
    <link rel="icon" href="../favicon.png">

    <title>siesta_analysis &ndash; SIESTA</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">SIESTA <small>trunk-700--vdikan-edens-710-ford-681</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>Program Overview</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>siesta_analysis
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 2.7% of total for procedures.">229 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/siesta_analysis.F"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/siesta_analysis.f.html'>siesta_analysis.F</a></li>
    
     <li><a href='../module/m_siesta_analysis.html'>m_siesta_analysis</a></li>
    
  
     <li class="active">siesta_analysis</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/siesta_analysis.html#src">siesta_analysis</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine siesta_analysis(relaxd)
    
    
   
</h2>
    
  
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
      
      <li class="list-group-item">
  <ul class="list-inline">
    
    <li>band</li>
    
    <li>writewave</li>
    
    <li>writewave</li>
    
    <li>m_ksvinit</li>
    
    <li>m_ksv</li>
    
    <li>m_projected_DOS</li>
    
    <li>m_local_DOS</li>
    
    <li>m_pexsi_local_DOS</li>
    
    <li>m_pexsi_dos</li>
    
    <li><a href='../module/siesta_options.html'>siesta_options</a></li>
    
    <li><a href='../module/units.html'>units</a></li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>siesta_geom</li>
    
    <li><a href='../module/m_dhscf.html'>m_dhscf</a></li>
    
    <li>atomlist</li>
    
    <li>atomlist</li>
    
    <li>fdf</li>
    
    <li>writewave</li>
    
    <li>siesta_cml</li>
    
    <li>files</li>
    
    <li>files</li>
    
    <li>zmatrix</li>
    
    <li>kpoint_scf_m</li>
    
    <li><a href='../module/parallel.html'>parallel</a></li>
    
    <li><a href='../module/parallel.html'>parallel</a></li>
    
    <li>files</li>
    
    <li>m_energies</li>
    
    <li>m_steps</li>
    
    <li>m_ntm</li>
    
    <li>m_spin</li>
    
    <li>m_spin</li>
    
    <li>m_dipol</li>
    
    <li>m_eo</li>
    
    <li>m_forces</li>
    
    <li>m_gamma</li>
    
    <li>alloc</li>
    
    <li>basis_enthalpy</li>
    
    <li>m_partial_charges</li>
    
    <li>m_iodm_old</li>
    
    <li>m_siesta2wannier90</li>
    
    <li>m_mpi_utils</li>
    
    <li>flook_siesta</li>
    
  </ul>
      </li>
      
      
      
      <li class="list-group-item">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~siesta_analysis~~UsesGraph Pages: 1 -->
<svg id="procsiesta_analysisUsesGraph" width="331pt" height="1460pt"
 viewBox="0.00 0.00 331.00 1460.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~siesta_analysis~~UsesGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 1456)">
<title>proc~~siesta_analysis~~UsesGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1456 327,-1456 327,4 -4,4"/>
<!-- proc~siesta_analysis -->
<g id="proc~~siesta_analysis~~UsesGraph_node1" class="node"><title>proc~siesta_analysis</title>
<polygon fill="none" stroke="black" points="323,-738 238,-738 238,-714 323,-714 323,-738"/>
<text text-anchor="middle" x="280.5" y="-723.6" font-family="Helvetica,sans-Serif" font-size="10.50">siesta_analysis</text>
</g>
<!-- flook_siesta -->
<g id="proc~~siesta_analysis~~UsesGraph_node2" class="node"><title>flook_siesta</title>
<polygon fill="#337ab7" stroke="#337ab7" points="181,-1452 112,-1452 112,-1428 181,-1428 181,-1452"/>
<text text-anchor="middle" x="146.5" y="-1437.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">flook_siesta</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;flook_siesta -->
<g id="proc~~siesta_analysis~~UsesGraph_edge1" class="edge"><title>proc~siesta_analysis&#45;&gt;flook_siesta</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M278.898,-738.088C274.435,-825.794 245.449,-1362.69 202,-1419 198.829,-1423.11 194.748,-1426.41 190.246,-1429.07"/>
<polygon fill="#000000" stroke="#000000" points="188.691,-1425.94 181.201,-1433.43 191.729,-1432.24 188.691,-1425.94"/>
</g>
<!-- m_partial_charges -->
<g id="proc~~siesta_analysis~~UsesGraph_node3" class="node"><title>m_partial_charges</title>
<polygon fill="#337ab7" stroke="#337ab7" points="197,-1410 96,-1410 96,-1386 197,-1386 197,-1410"/>
<text text-anchor="middle" x="146.5" y="-1395.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_partial_charges</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;m_partial_charges -->
<g id="proc~~siesta_analysis~~UsesGraph_edge2" class="edge"><title>proc~siesta_analysis&#45;&gt;m_partial_charges</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M279.703,-738.027C280.817,-817.937 283.464,-1272.2 202,-1377 201.315,-1377.88 200.589,-1378.72 199.826,-1379.53"/>
<polygon fill="#000000" stroke="#000000" points="197.59,-1376.84 192.09,-1385.9 202.037,-1382.25 197.59,-1376.84"/>
</g>
<!-- sparse_matrices -->
<g id="proc~~siesta_analysis~~UsesGraph_node4" class="node"><title>sparse_matrices</title>
<polygon fill="#337ab7" stroke="#337ab7" points="192,-1368 101,-1368 101,-1344 192,-1344 192,-1368"/>
<text text-anchor="middle" x="146.5" y="-1353.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sparse_matrices</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;sparse_matrices -->
<g id="proc~~siesta_analysis~~UsesGraph_edge31" class="edge"><title>proc~siesta_analysis&#45;&gt;sparse_matrices</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M279.595,-738.488C279.951,-816.59 278.27,-1237.69 202,-1335 201.312,-1335.88 200.582,-1336.72 199.816,-1337.53"/>
<polygon fill="#000000" stroke="#000000" points="197.583,-1334.83 192.061,-1343.87 202.016,-1340.25 197.583,-1334.83"/>
</g>
<!-- module~units -->
<g id="proc~~siesta_analysis~~UsesGraph_node5" class="node"><title>module~units</title>
<g id="a_proc~~siesta_analysis~~UsesGraph_node5"><a xlink:href=".././module/units.html" xlink:title="units">
<polygon fill="#337ab7" stroke="#337ab7" points="173.5,-1326 119.5,-1326 119.5,-1302 173.5,-1302 173.5,-1326"/>
<text text-anchor="middle" x="146.5" y="-1311.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">units</text>
</a>
</g>
</g>
<!-- proc~siesta_analysis&#45;&gt;module~units -->
<g id="proc~~siesta_analysis~~UsesGraph_edge4" class="edge"><title>proc~siesta_analysis&#45;&gt;module~units</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M279.467,-738.108C279.035,-812.073 273.362,-1202.82 202,-1293 197.242,-1299.01 190.538,-1303.31 183.455,-1306.37"/>
<polygon fill="#000000" stroke="#000000" points="181.958,-1303.19 173.706,-1309.83 184.301,-1309.78 181.958,-1303.19"/>
</g>
<!-- m_projected_DOS -->
<g id="proc~~siesta_analysis~~UsesGraph_node6" class="node"><title>m_projected_DOS</title>
<polygon fill="#337ab7" stroke="#337ab7" points="196.5,-1284 96.5,-1284 96.5,-1260 196.5,-1260 196.5,-1284"/>
<text text-anchor="middle" x="146.5" y="-1269.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_projected_DOS</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;m_projected_DOS -->
<g id="proc~~siesta_analysis~~UsesGraph_edge5" class="edge"><title>proc~siesta_analysis&#45;&gt;m_projected_DOS</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M279.321,-738.121C278.045,-808.863 268.336,-1168.09 202,-1251 201.287,-1251.89 200.532,-1252.74 199.739,-1253.56"/>
<polygon fill="#000000" stroke="#000000" points="197.344,-1250.99 191.73,-1259.98 201.722,-1256.46 197.344,-1250.99"/>
</g>
<!-- siesta_cml -->
<g id="proc~~siesta_analysis~~UsesGraph_node7" class="node"><title>siesta_cml</title>
<polygon fill="#337ab7" stroke="#337ab7" points="178,-1242 115,-1242 115,-1218 178,-1218 178,-1242"/>
<text text-anchor="middle" x="146.5" y="-1227.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_cml</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;siesta_cml -->
<g id="proc~~siesta_analysis~~UsesGraph_edge6" class="edge"><title>proc~siesta_analysis&#45;&gt;siesta_cml</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M279.153,-738.021C276.989,-805.146 263.358,-1133.29 202,-1209 198.156,-1213.74 193.104,-1217.42 187.626,-1220.26"/>
<polygon fill="#000000" stroke="#000000" points="185.966,-1217.17 178.143,-1224.31 188.714,-1223.6 185.966,-1217.17"/>
</g>
<!-- module~parallel -->
<g id="proc~~siesta_analysis~~UsesGraph_node8" class="node"><title>module~parallel</title>
<g id="a_proc~~siesta_analysis~~UsesGraph_node8"><a xlink:href=".././module/parallel.html" xlink:title="parallel">
<polygon fill="#337ab7" stroke="#337ab7" points="173.5,-1200 119.5,-1200 119.5,-1176 173.5,-1176 173.5,-1200"/>
<text text-anchor="middle" x="146.5" y="-1185.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel</text>
</a>
</g>
</g>
<!-- proc~siesta_analysis&#45;&gt;module~parallel -->
<g id="proc~~siesta_analysis~~UsesGraph_edge7" class="edge"><title>proc~siesta_analysis&#45;&gt;module~parallel</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M278.942,-738.217C275.791,-802.224 258.305,-1098.57 202,-1167 197.128,-1172.92 190.378,-1177.18 183.285,-1180.23"/>
<polygon fill="#000000" stroke="#000000" points="181.791,-1177.05 173.545,-1183.7 184.14,-1183.65 181.791,-1177.05"/>
</g>
<!-- m_energies -->
<g id="proc~~siesta_analysis~~UsesGraph_node9" class="node"><title>m_energies</title>
<polygon fill="#337ab7" stroke="#337ab7" points="181,-1158 112,-1158 112,-1134 181,-1134 181,-1158"/>
<text text-anchor="middle" x="146.5" y="-1143.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_energies</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;m_energies -->
<g id="proc~~siesta_analysis~~UsesGraph_edge8" class="edge"><title>proc~siesta_analysis&#45;&gt;m_energies</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M278.694,-738.234C274.497,-798.541 253.325,-1063.75 202,-1125 198.791,-1128.83 194.797,-1131.96 190.441,-1134.53"/>
<polygon fill="#000000" stroke="#000000" points="188.604,-1131.53 181.123,-1139.03 191.65,-1137.83 188.604,-1131.53"/>
</g>
<!-- kpoint_scf_m -->
<g id="proc~~siesta_analysis~~UsesGraph_node10" class="node"><title>kpoint_scf_m</title>
<polygon fill="#337ab7" stroke="#337ab7" points="184.5,-1116 108.5,-1116 108.5,-1092 184.5,-1092 184.5,-1116"/>
<text text-anchor="middle" x="146.5" y="-1101.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">kpoint_scf_m</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;kpoint_scf_m -->
<g id="proc~~siesta_analysis~~UsesGraph_edge9" class="edge"><title>proc~siesta_analysis&#45;&gt;kpoint_scf_m</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M278.408,-738.053C273.11,-794.103 248.422,-1028.82 202,-1083 199.547,-1085.86 196.656,-1088.34 193.507,-1090.48"/>
<polygon fill="#000000" stroke="#000000" points="191.723,-1087.46 184.69,-1095.39 195.13,-1093.58 191.723,-1087.46"/>
</g>
<!-- atomlist -->
<g id="proc~~siesta_analysis~~UsesGraph_node11" class="node"><title>atomlist</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173.5,-1074 119.5,-1074 119.5,-1050 173.5,-1050 173.5,-1074"/>
<text text-anchor="middle" x="146.5" y="-1059.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">atomlist</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;atomlist -->
<g id="proc~~siesta_analysis~~UsesGraph_edge32" class="edge"><title>proc~siesta_analysis&#45;&gt;atomlist</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M278.038,-738.004C271.508,-789.828 243.506,-993.878 202,-1041 196.977,-1046.7 190.225,-1050.87 183.187,-1053.9"/>
<polygon fill="#000000" stroke="#000000" points="181.763,-1050.69 173.546,-1057.38 184.141,-1057.28 181.763,-1050.69"/>
</g>
<!-- m_steps -->
<g id="proc~~siesta_analysis~~UsesGraph_node12" class="node"><title>m_steps</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173.5,-1032 119.5,-1032 119.5,-1008 173.5,-1008 173.5,-1032"/>
<text text-anchor="middle" x="146.5" y="-1017.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_steps</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;m_steps -->
<g id="proc~~siesta_analysis~~UsesGraph_edge10" class="edge"><title>proc~siesta_analysis&#45;&gt;m_steps</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M279.67,-738.155C279.593,-780.084 273.743,-920.398 202,-999 196.924,-1004.56 190.208,-1008.66 183.23,-1011.68"/>
<polygon fill="#000000" stroke="#000000" points="181.876,-1008.45 173.682,-1015.17 184.276,-1015.03 181.876,-1008.45"/>
</g>
<!-- basis_enthalpy -->
<g id="proc~~siesta_analysis~~UsesGraph_node13" class="node"><title>basis_enthalpy</title>
<polygon fill="#337ab7" stroke="#337ab7" points="188.5,-990 104.5,-990 104.5,-966 188.5,-966 188.5,-990"/>
<text text-anchor="middle" x="146.5" y="-975.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">basis_enthalpy</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;basis_enthalpy -->
<g id="proc~~siesta_analysis~~UsesGraph_edge11" class="edge"><title>proc~siesta_analysis&#45;&gt;basis_enthalpy</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M278.93,-738.117C276.519,-775.762 264.145,-892.053 202,-957 200.58,-958.484 199.044,-959.864 197.419,-961.148"/>
<polygon fill="#000000" stroke="#000000" points="195.176,-958.431 188.677,-966.799 198.976,-964.309 195.176,-958.431"/>
</g>
<!-- m_iodm_old -->
<g id="proc~~siesta_analysis~~UsesGraph_node14" class="node"><title>m_iodm_old</title>
<polygon fill="#337ab7" stroke="#337ab7" points="182,-948 111,-948 111,-924 182,-924 182,-948"/>
<text text-anchor="middle" x="146.5" y="-933.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_iodm_old</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;m_iodm_old -->
<g id="proc~~siesta_analysis~~UsesGraph_edge12" class="edge"><title>proc~siesta_analysis&#45;&gt;m_iodm_old</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M277.835,-738.478C272.754,-771.769 254.46,-863.648 202,-915 198.902,-918.032 195.319,-920.637 191.5,-922.874"/>
<polygon fill="#000000" stroke="#000000" points="189.678,-919.87 182.274,-927.449 192.788,-926.141 189.678,-919.87"/>
</g>
<!-- siesta_geom -->
<g id="proc~~siesta_analysis~~UsesGraph_node15" class="node"><title>siesta_geom</title>
<polygon fill="#337ab7" stroke="#337ab7" points="183,-906 110,-906 110,-882 183,-882 183,-906"/>
<text text-anchor="middle" x="146.5" y="-891.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_geom</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;siesta_geom -->
<g id="proc~~siesta_analysis~~UsesGraph_edge13" class="edge"><title>proc~siesta_analysis&#45;&gt;siesta_geom</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M276.307,-738.105C268.399,-765.824 245.339,-834.471 202,-873 199.016,-875.653 195.661,-877.986 192.119,-880.036"/>
<polygon fill="#000000" stroke="#000000" points="190.422,-876.971 183.036,-884.567 193.546,-883.235 190.422,-876.971"/>
</g>
<!-- m_ksvinit -->
<g id="proc~~siesta_analysis~~UsesGraph_node16" class="node"><title>m_ksvinit</title>
<polygon fill="#337ab7" stroke="#337ab7" points="175,-864 118,-864 118,-840 175,-840 175,-864"/>
<text text-anchor="middle" x="146.5" y="-849.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ksvinit</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;m_ksvinit -->
<g id="proc~~siesta_analysis~~UsesGraph_edge14" class="edge"><title>proc~siesta_analysis&#45;&gt;m_ksvinit</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M273.529,-738.134C262.342,-759.704 236.234,-804.901 202,-831 196.814,-834.954 190.794,-838.246 184.686,-840.96"/>
<polygon fill="#000000" stroke="#000000" points="183.124,-837.815 175.124,-844.761 185.71,-844.32 183.124,-837.815"/>
</g>
<!-- m_ntm -->
<g id="proc~~siesta_analysis~~UsesGraph_node17" class="node"><title>m_ntm</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173.5,-822 119.5,-822 119.5,-798 173.5,-798 173.5,-822"/>
<text text-anchor="middle" x="146.5" y="-807.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ntm</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;m_ntm -->
<g id="proc~~siesta_analysis~~UsesGraph_edge15" class="edge"><title>proc~siesta_analysis&#45;&gt;m_ntm</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M267.258,-738.038C252.705,-751.827 227.205,-774.395 202,-789 196.242,-792.336 189.855,-795.342 183.54,-797.967"/>
<polygon fill="#000000" stroke="#000000" points="181.822,-794.881 173.775,-801.773 184.363,-801.403 181.822,-794.881"/>
</g>
<!-- m_ksv -->
<g id="proc~~siesta_analysis~~UsesGraph_node18" class="node"><title>m_ksv</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173.5,-780 119.5,-780 119.5,-756 173.5,-756 173.5,-780"/>
<text text-anchor="middle" x="146.5" y="-765.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ksv</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;m_ksv -->
<g id="proc~~siesta_analysis~~UsesGraph_edge16" class="edge"><title>proc~siesta_analysis&#45;&gt;m_ksv</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M241.674,-738.036C223.29,-743.885 201.316,-750.877 183.219,-756.635"/>
<polygon fill="#000000" stroke="#000000" points="182.08,-753.324 173.612,-759.692 184.203,-759.995 182.08,-753.324"/>
</g>
<!-- files -->
<g id="proc~~siesta_analysis~~UsesGraph_node19" class="node"><title>files</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173.5,-738 119.5,-738 119.5,-714 173.5,-714 173.5,-738"/>
<text text-anchor="middle" x="146.5" y="-723.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">files</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;files -->
<g id="proc~~siesta_analysis~~UsesGraph_edge17" class="edge"><title>proc~siesta_analysis&#45;&gt;files</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M237.734,-726C220.51,-726 200.728,-726 184.084,-726"/>
<polygon fill="#000000" stroke="#000000" points="183.658,-722.5 173.658,-726 183.658,-729.5 183.658,-722.5"/>
</g>
<!-- module~siesta_options -->
<g id="proc~~siesta_analysis~~UsesGraph_node20" class="node"><title>module~siesta_options</title>
<g id="a_proc~~siesta_analysis~~UsesGraph_node20"><a xlink:href=".././module/siesta_options.html" xlink:title="siesta_options">
<polygon fill="#337ab7" stroke="#337ab7" points="187,-696 106,-696 106,-672 187,-672 187,-696"/>
<text text-anchor="middle" x="146.5" y="-681.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_options</text>
</a>
</g>
</g>
<!-- proc~siesta_analysis&#45;&gt;module~siesta_options -->
<g id="proc~~siesta_analysis~~UsesGraph_edge18" class="edge"><title>proc~siesta_analysis&#45;&gt;module~siesta_options</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M241.674,-713.964C227.176,-709.351 210.444,-704.028 195.142,-699.159"/>
<polygon fill="#000000" stroke="#000000" points="195.922,-695.734 185.331,-696.037 193.799,-702.405 195.922,-695.734"/>
</g>
<!-- m_pexsi_dos -->
<g id="proc~~siesta_analysis~~UsesGraph_node21" class="node"><title>m_pexsi_dos</title>
<polygon fill="#337ab7" stroke="#337ab7" points="184.5,-654 108.5,-654 108.5,-630 184.5,-630 184.5,-654"/>
<text text-anchor="middle" x="146.5" y="-639.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_pexsi_dos</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;m_pexsi_dos -->
<g id="proc~~siesta_analysis~~UsesGraph_edge19" class="edge"><title>proc~siesta_analysis&#45;&gt;m_pexsi_dos</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M267.258,-713.962C252.705,-700.173 227.205,-677.605 202,-663 199.149,-661.348 196.143,-659.777 193.068,-658.293"/>
<polygon fill="#000000" stroke="#000000" points="194.278,-654.999 183.72,-654.108 191.417,-661.388 194.278,-654.999"/>
</g>
<!-- module~m_dhscf -->
<g id="proc~~siesta_analysis~~UsesGraph_node22" class="node"><title>module~m_dhscf</title>
<g id="a_proc~~siesta_analysis~~UsesGraph_node22"><a xlink:href=".././module/m_dhscf.html" xlink:title="m_dhscf">
<polygon fill="#337ab7" stroke="#337ab7" points="173.5,-612 119.5,-612 119.5,-588 173.5,-588 173.5,-612"/>
<text text-anchor="middle" x="146.5" y="-597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_dhscf</text>
</a>
</g>
</g>
<!-- proc~siesta_analysis&#45;&gt;module~m_dhscf -->
<g id="proc~~siesta_analysis~~UsesGraph_edge20" class="edge"><title>proc~siesta_analysis&#45;&gt;module~m_dhscf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M273.529,-713.866C262.342,-692.296 236.234,-647.099 202,-621 196.42,-616.746 189.874,-613.257 183.292,-610.431"/>
<polygon fill="#000000" stroke="#000000" points="184.322,-607.077 173.732,-606.752 181.808,-613.61 184.322,-607.077"/>
</g>
<!-- band -->
<g id="proc~~siesta_analysis~~UsesGraph_node23" class="node"><title>band</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173.5,-570 119.5,-570 119.5,-546 173.5,-546 173.5,-570"/>
<text text-anchor="middle" x="146.5" y="-555.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">band</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;band -->
<g id="proc~~siesta_analysis~~UsesGraph_edge21" class="edge"><title>proc~siesta_analysis&#45;&gt;band</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M276.307,-713.895C268.399,-686.176 245.339,-617.529 202,-579 196.654,-574.247 190.115,-570.519 183.448,-567.612"/>
<polygon fill="#000000" stroke="#000000" points="184.302,-564.193 173.71,-563.916 181.818,-570.737 184.302,-564.193"/>
</g>
<!-- m_local_DOS -->
<g id="proc~~siesta_analysis~~UsesGraph_node24" class="node"><title>m_local_DOS</title>
<polygon fill="#337ab7" stroke="#337ab7" points="185.5,-528 107.5,-528 107.5,-504 185.5,-504 185.5,-528"/>
<text text-anchor="middle" x="146.5" y="-513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_local_DOS</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;m_local_DOS -->
<g id="proc~~siesta_analysis~~UsesGraph_edge22" class="edge"><title>proc~siesta_analysis&#45;&gt;m_local_DOS</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M277.835,-713.522C272.754,-680.231 254.46,-588.352 202,-537 199.754,-534.801 197.252,-532.827 194.59,-531.055"/>
<polygon fill="#000000" stroke="#000000" points="196.095,-527.886 185.659,-526.058 192.677,-533.995 196.095,-527.886"/>
</g>
<!-- m_spin -->
<g id="proc~~siesta_analysis~~UsesGraph_node25" class="node"><title>m_spin</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173.5,-486 119.5,-486 119.5,-462 173.5,-462 173.5,-486"/>
<text text-anchor="middle" x="146.5" y="-471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_spin</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;m_spin -->
<g id="proc~~siesta_analysis~~UsesGraph_edge23" class="edge"><title>proc~siesta_analysis&#45;&gt;m_spin</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M278.93,-713.883C276.519,-676.238 264.145,-559.947 202,-495 196.843,-489.611 190.15,-485.584 183.229,-482.583"/>
<polygon fill="#000000" stroke="#000000" points="184.366,-479.272 173.773,-479.094 181.943,-485.839 184.366,-479.272"/>
</g>
<!-- writewave -->
<g id="proc~~siesta_analysis~~UsesGraph_node26" class="node"><title>writewave</title>
<polygon fill="#337ab7" stroke="#337ab7" points="176.5,-444 116.5,-444 116.5,-420 176.5,-420 176.5,-444"/>
<text text-anchor="middle" x="146.5" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">writewave</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;writewave -->
<g id="proc~~siesta_analysis~~UsesGraph_edge25" class="edge"><title>proc~siesta_analysis&#45;&gt;writewave</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M279.67,-713.845C279.593,-671.916 273.743,-531.602 202,-453 197.649,-448.233 192.091,-444.538 186.197,-441.677"/>
<polygon fill="#000000" stroke="#000000" points="187.363,-438.372 176.782,-437.833 184.718,-444.853 187.363,-438.372"/>
</g>
<!-- m_siesta2wannier90 -->
<g id="proc~~siesta_analysis~~UsesGraph_node27" class="node"><title>m_siesta2wannier90</title>
<polygon fill="#337ab7" stroke="#337ab7" points="202,-402 91,-402 91,-378 202,-378 202,-402"/>
<text text-anchor="middle" x="146.5" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_siesta2wannier90</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;m_siesta2wannier90 -->
<g id="proc~~siesta_analysis~~UsesGraph_edge26" class="edge"><title>proc~siesta_analysis&#45;&gt;m_siesta2wannier90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M278.038,-713.996C271.508,-662.172 243.506,-458.122 202,-411 201.133,-410.016 200.214,-409.077 199.251,-408.182"/>
<polygon fill="#000000" stroke="#000000" points="201.243,-405.301 191.129,-402.144 197.066,-410.919 201.243,-405.301"/>
</g>
<!-- m_forces -->
<g id="proc~~siesta_analysis~~UsesGraph_node28" class="node"><title>m_forces</title>
<polygon fill="#337ab7" stroke="#337ab7" points="175,-360 118,-360 118,-336 175,-336 175,-360"/>
<text text-anchor="middle" x="146.5" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_forces</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;m_forces -->
<g id="proc~~siesta_analysis~~UsesGraph_edge27" class="edge"><title>proc~siesta_analysis&#45;&gt;m_forces</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M278.408,-713.947C273.11,-657.897 248.422,-423.184 202,-369 197.39,-363.619 191.237,-359.611 184.725,-356.628"/>
<polygon fill="#000000" stroke="#000000" points="185.659,-353.238 175.068,-352.949 183.167,-359.78 185.659,-353.238"/>
</g>
<!-- alloc -->
<g id="proc~~siesta_analysis~~UsesGraph_node29" class="node"><title>alloc</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173.5,-318 119.5,-318 119.5,-294 173.5,-294 173.5,-318"/>
<text text-anchor="middle" x="146.5" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">alloc</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;alloc -->
<g id="proc~~siesta_analysis~~UsesGraph_edge28" class="edge"><title>proc~siesta_analysis&#45;&gt;alloc</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M278.694,-713.766C274.497,-653.459 253.325,-388.255 202,-327 197.12,-321.176 190.427,-316.962 183.4,-313.915"/>
<polygon fill="#000000" stroke="#000000" points="184.346,-310.535 173.751,-310.441 181.974,-317.121 184.346,-310.535"/>
</g>
<!-- m_gamma -->
<g id="proc~~siesta_analysis~~UsesGraph_node30" class="node"><title>m_gamma</title>
<polygon fill="#337ab7" stroke="#337ab7" points="178.5,-276 114.5,-276 114.5,-252 178.5,-252 178.5,-276"/>
<text text-anchor="middle" x="146.5" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_gamma</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;m_gamma -->
<g id="proc~~siesta_analysis~~UsesGraph_edge29" class="edge"><title>proc~siesta_analysis&#45;&gt;m_gamma</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M278.942,-713.783C275.791,-649.776 258.305,-353.432 202,-285 198.203,-280.385 193.266,-276.782 187.914,-273.97"/>
<polygon fill="#000000" stroke="#000000" points="189.212,-270.717 178.645,-269.944 186.423,-277.138 189.212,-270.717"/>
</g>
<!-- fdf -->
<g id="proc~~siesta_analysis~~UsesGraph_node31" class="node"><title>fdf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173.5,-234 119.5,-234 119.5,-210 173.5,-210 173.5,-234"/>
<text text-anchor="middle" x="146.5" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fdf</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;fdf -->
<g id="proc~~siesta_analysis~~UsesGraph_edge30" class="edge"><title>proc~siesta_analysis&#45;&gt;fdf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M279.153,-713.979C276.989,-646.854 263.358,-318.713 202,-243 197.172,-237.042 190.44,-232.772 183.351,-229.712"/>
<polygon fill="#000000" stroke="#000000" points="184.202,-226.3 173.608,-226.245 181.855,-232.895 184.202,-226.3"/>
</g>
<!-- m_eo -->
<g id="proc~~siesta_analysis~~UsesGraph_node32" class="node"><title>m_eo</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173.5,-192 119.5,-192 119.5,-168 173.5,-168 173.5,-192"/>
<text text-anchor="middle" x="146.5" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_eo</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;m_eo -->
<g id="proc~~siesta_analysis~~UsesGraph_edge3" class="edge"><title>proc~siesta_analysis&#45;&gt;m_eo</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M279.321,-713.879C278.045,-643.137 268.336,-283.913 202,-201 197.209,-195.012 190.493,-190.73 183.407,-187.667"/>
<polygon fill="#000000" stroke="#000000" points="184.256,-184.254 173.661,-184.202 181.91,-190.85 184.256,-184.254"/>
</g>
<!-- m_mpi_utils -->
<g id="proc~~siesta_analysis~~UsesGraph_node33" class="node"><title>m_mpi_utils</title>
<polygon fill="#337ab7" stroke="#337ab7" points="181.5,-150 111.5,-150 111.5,-126 181.5,-126 181.5,-150"/>
<text text-anchor="middle" x="146.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_mpi_utils</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;m_mpi_utils -->
<g id="proc~~siesta_analysis~~UsesGraph_edge24" class="edge"><title>proc~siesta_analysis&#45;&gt;m_mpi_utils</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M279.467,-713.892C279.035,-639.927 273.362,-249.181 202,-159 198.936,-155.129 195.067,-151.97 190.809,-149.394"/>
<polygon fill="#000000" stroke="#000000" points="192.173,-146.164 181.656,-144.88 189.077,-152.442 192.173,-146.164"/>
</g>
<!-- m_dipol -->
<g id="proc~~siesta_analysis~~UsesGraph_node34" class="node"><title>m_dipol</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173.5,-108 119.5,-108 119.5,-84 173.5,-84 173.5,-108"/>
<text text-anchor="middle" x="146.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_dipol</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;m_dipol -->
<g id="proc~~siesta_analysis~~UsesGraph_edge33" class="edge"><title>proc~siesta_analysis&#45;&gt;m_dipol</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M279.595,-713.512C279.951,-635.41 278.27,-214.306 202,-117 197.269,-110.965 190.578,-106.663 183.496,-103.596"/>
<polygon fill="#000000" stroke="#000000" points="184.341,-100.182 173.746,-100.134 181.999,-106.779 184.341,-100.182"/>
</g>
<!-- zmatrix -->
<g id="proc~~siesta_analysis~~UsesGraph_node35" class="node"><title>zmatrix</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173.5,-66 119.5,-66 119.5,-42 173.5,-42 173.5,-66"/>
<text text-anchor="middle" x="146.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">zmatrix</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;zmatrix -->
<g id="proc~~siesta_analysis~~UsesGraph_edge34" class="edge"><title>proc~siesta_analysis&#45;&gt;zmatrix</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M279.703,-713.973C280.817,-634.063 283.464,-179.804 202,-75 197.294,-68.9456 190.612,-64.6357 183.533,-61.5679"/>
<polygon fill="#000000" stroke="#000000" points="184.376,-58.1531 173.781,-58.1073 182.034,-64.7501 184.376,-58.1531"/>
</g>
<!-- m_pexsi_local_DOS -->
<g id="proc~~siesta_analysis~~UsesGraph_node36" class="node"><title>m_pexsi_local_DOS</title>
<polygon fill="#337ab7" stroke="#337ab7" points="201,-24 92,-24 92,-0 201,-0 201,-24"/>
<text text-anchor="middle" x="146.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_pexsi_local_DOS</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;m_pexsi_local_DOS -->
<g id="proc~~siesta_analysis~~UsesGraph_edge35" class="edge"><title>proc~siesta_analysis&#45;&gt;m_pexsi_local_DOS</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M278.898,-713.912C274.435,-626.206 245.449,-89.3099 202,-33 201.319,-32.1169 200.595,-31.271 199.835,-30.4606"/>
<polygon fill="#000000" stroke="#000000" points="202.055,-27.755 192.116,-24.085 197.597,-33.152 202.055,-27.755"/>
</g>
<!-- module~precision -->
<g id="proc~~siesta_analysis~~UsesGraph_node37" class="node"><title>module~precision</title>
<g id="a_proc~~siesta_analysis~~UsesGraph_node37"><a xlink:href=".././module/precision.html" xlink:title="precision">
<polygon fill="#337ab7" stroke="#337ab7" points="55,-990 0,-990 0,-966 55,-966 55,-990"/>
<text text-anchor="middle" x="27.5" y="-975.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">precision</text>
</a>
</g>
</g>
<!-- module~units&#45;&gt;module~precision -->
<g id="proc~~siesta_analysis~~UsesGraph_edge36" class="edge"><title>module~units&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M119.266,-1309.55C109.052,-1306.52 98.1155,-1301.46 91,-1293 53.3303,-1248.23 35.4163,-1065.11 30.1858,-1000.61"/>
<polygon fill="#000000" stroke="#000000" points="33.6508,-1000.03 29.3793,-990.332 26.6723,-1000.58 33.6508,-1000.03"/>
</g>
<!-- module~m_dhscf&#45;&gt;module~precision -->
<g id="proc~~siesta_analysis~~UsesGraph_edge37" class="edge"><title>module~m_dhscf&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M119.452,-604.294C109.143,-607.296 98.084,-612.385 91,-621 48.4127,-672.794 33.4162,-885.8 29.5881,-955.681"/>
<polygon fill="#000000" stroke="#000000" points="26.0772,-955.799 29.0497,-965.968 33.0676,-956.165 26.0772,-955.799"/>
</g>
<!-- m_dfscf -->
<g id="proc~~siesta_analysis~~UsesGraph_node38" class="node"><title>m_dfscf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54.5,-612 0.5,-612 0.5,-588 54.5,-588 54.5,-612"/>
<text text-anchor="middle" x="27.5" y="-597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_dfscf</text>
</g>
<!-- module~m_dhscf&#45;&gt;m_dfscf -->
<g id="proc~~siesta_analysis~~UsesGraph_edge38" class="edge"><title>module~m_dhscf&#45;&gt;m_dfscf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M119.243,-600C103.286,-600 82.6741,-600 65.1287,-600"/>
<polygon fill="#000000" stroke="#000000" points="64.6695,-596.5 54.6694,-600 64.6694,-603.5 64.6695,-596.5"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="490pt" height="32pt"
 viewBox="0.00 0.00 489.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 485.5,-28 485.5,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node"><title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node"><title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="139.5,-24 72.5,-24 72.5,-0 139.5,-0 139.5,-24"/>
<text text-anchor="middle" x="106" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="222,-24 158,-24 158,-0 222,-0 222,-24"/>
<text text-anchor="middle" x="190" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="294,-24 240,-24 240,-0 294,-0 294,-24"/>
<text text-anchor="middle" x="267" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="366,-24 312,-24 312,-0 366,-0 366,-24"/>
<text text-anchor="middle" x="339" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="481.5,-24 384.5,-24 384.5,-0 481.5,-0 481.5,-24"/>
<text text-anchor="middle" x="433" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses.
    </p>
    </div></div></div></div>
      </li>
      
      </ul>
    </div>
    


    
    <p>Check that we are converged in geometry,
 if strictly required,
 before carrying out any analysis.</p>
<p>@code
@endcode</p>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-relaxd"></span>logical</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>relaxd</strong></td><td></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~siesta_analysis~~CallsGraph Pages: 1 -->
<svg id="procsiesta_analysisCallsGraph" width="641pt" height="1522pt"
 viewBox="0.00 0.00 641.00 1522.38" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~siesta_analysis~~CallsGraph" class="graph" transform="scale(0.679025 0.679025) rotate(0) translate(4 2238)">
<title>proc~~siesta_analysis~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-2238 940,-2238 940,4 -4,4"/>
<!-- proc~siesta_analysis -->
<g id="proc~~siesta_analysis~~CallsGraph_node1" class="node"><title>proc~siesta_analysis</title>
<polygon fill="none" stroke="black" points="85,-801 0,-801 0,-777 85,-777 85,-801"/>
<text text-anchor="middle" x="42.5" y="-786.6" font-family="Helvetica,sans-Serif" font-size="10.50">siesta_analysis</text>
</g>
<!-- eo -->
<g id="proc~~siesta_analysis~~CallsGraph_node2" class="node"><title>eo</title>
<polygon fill="#777777" stroke="#777777" points="223.5,-2234 169.5,-2234 169.5,-2210 223.5,-2210 223.5,-2234"/>
<text text-anchor="middle" x="196.5" y="-2219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">eo</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;eo -->
<g id="proc~~siesta_analysis~~CallsGraph_edge1" class="edge"><title>proc~siesta_analysis&#45;&gt;eo</title>
<path fill="none" stroke="#000000" d="M43.7805,-801.044C46.9397,-934.702 76.5536,-2136.93 121,-2196 130.08,-2208.07 145.155,-2214.56 159.378,-2218.05"/>
<polygon fill="#000000" stroke="#000000" points="158.992,-2221.54 169.487,-2220.09 160.378,-2214.68 158.992,-2221.54"/>
</g>
<!-- re_alloc -->
<g id="proc~~siesta_analysis~~CallsGraph_node3" class="node"><title>re_alloc</title>
<polygon fill="#777777" stroke="#777777" points="928.5,-1928 874.5,-1928 874.5,-1904 928.5,-1904 928.5,-1928"/>
<text text-anchor="middle" x="901.5" y="-1913.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">re_alloc</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;re_alloc -->
<g id="proc~~siesta_analysis~~CallsGraph_edge2" class="edge"><title>proc~siesta_analysis&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M43.7506,-801.198C46.2365,-918.682 67.5151,-1847.56 121,-1957 187.001,-2092.05 223.188,-2182 373.5,-2182 373.5,-2182 373.5,-2182 660,-2182 791.513,-2182 869.741,-2000.88 893.076,-1937.55"/>
<polygon fill="#000000" stroke="#000000" points="896.377,-1938.72 896.462,-1928.12 889.788,-1936.35 896.377,-1938.72"/>
</g>
<!-- xa -->
<g id="proc~~siesta_analysis~~CallsGraph_node4" class="node"><title>xa</title>
<polygon fill="#777777" stroke="#777777" points="223.5,-1368 169.5,-1368 169.5,-1344 223.5,-1344 223.5,-1368"/>
<text text-anchor="middle" x="196.5" y="-1353.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xa</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;xa -->
<g id="proc~~siesta_analysis~~CallsGraph_edge3" class="edge"><title>proc~siesta_analysis&#45;&gt;xa</title>
<path fill="none" stroke="#000000" d="M43.4903,-801.223C43.6802,-874.175 48.207,-1251.76 121,-1335 130.516,-1345.88 145.191,-1351.33 159.007,-1353.98"/>
<polygon fill="#000000" stroke="#000000" points="158.9,-1357.5 169.306,-1355.51 159.929,-1350.58 158.9,-1357.5"/>
</g>
<!-- scell -->
<g id="proc~~siesta_analysis~~CallsGraph_node5" class="node"><title>scell</title>
<polygon fill="#777777" stroke="#777777" points="223.5,-1326 169.5,-1326 169.5,-1302 223.5,-1302 223.5,-1326"/>
<text text-anchor="middle" x="196.5" y="-1311.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">scell</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;scell -->
<g id="proc~~siesta_analysis~~CallsGraph_edge4" class="edge"><title>proc~siesta_analysis&#45;&gt;scell</title>
<path fill="none" stroke="#000000" d="M43.6483,-801.181C44.74,-870.688 53.5403,-1216.75 121,-1293 130.579,-1303.83 145.263,-1309.26 159.071,-1311.93"/>
<polygon fill="#000000" stroke="#000000" points="158.951,-1315.45 169.359,-1313.47 159.987,-1308.52 158.951,-1315.45"/>
</g>
<!-- proc~dhscf -->
<g id="proc~~siesta_analysis~~CallsGraph_node6" class="node"><title>proc~dhscf</title>
<g id="a_proc~~siesta_analysis~~CallsGraph_node6"><a xlink:href=".././proc/dhscf.html" xlink:title="dhscf">
<polygon fill="#d9534f" stroke="#d9534f" points="223.5,-1410 169.5,-1410 169.5,-1386 223.5,-1386 223.5,-1410"/>
<text text-anchor="middle" x="196.5" y="-1395.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dhscf</text>
</a>
</g>
</g>
<!-- proc~siesta_analysis&#45;&gt;proc~dhscf -->
<g id="proc~~siesta_analysis~~CallsGraph_edge5" class="edge"><title>proc~siesta_analysis&#45;&gt;proc~dhscf</title>
<path fill="none" stroke="#000000" d="M43.3545,-801.154C42.692,-877.15 42.8237,-1286.7 121,-1377 130.555,-1388.04 145.416,-1393.49 159.359,-1396.11"/>
<polygon fill="#000000" stroke="#000000" points="158.86,-1399.57 169.261,-1397.55 159.871,-1392.64 158.86,-1399.57"/>
</g>
<!-- siesta_write_energies -->
<g id="proc~~siesta_analysis~~CallsGraph_node7" class="node"><title>siesta_write_energies</title>
<polygon fill="#777777" stroke="#777777" points="254.5,-1284 138.5,-1284 138.5,-1260 254.5,-1260 254.5,-1284"/>
<text text-anchor="middle" x="196.5" y="-1269.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_write_energies</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;siesta_write_energies -->
<g id="proc~~siesta_analysis~~CallsGraph_edge6" class="edge"><title>proc~siesta_analysis&#45;&gt;siesta_write_energies</title>
<path fill="none" stroke="#000000" d="M43.8295,-801.02C45.8699,-866.691 58.822,-1181.68 121,-1251 123.526,-1253.82 126.398,-1256.27 129.509,-1258.4"/>
<polygon fill="#000000" stroke="#000000" points="127.801,-1261.45 138.228,-1263.33 131.246,-1255.36 127.801,-1261.45"/>
</g>
<!-- de_alloc -->
<g id="proc~~siesta_analysis~~CallsGraph_node8" class="node"><title>de_alloc</title>
<polygon fill="#777777" stroke="#777777" points="928.5,-1868 874.5,-1868 874.5,-1844 928.5,-1844 928.5,-1868"/>
<text text-anchor="middle" x="901.5" y="-1853.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">de_alloc</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;de_alloc -->
<g id="proc~~siesta_analysis~~CallsGraph_edge7" class="edge"><title>proc~siesta_analysis&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M43.5589,-801.036C44.178,-901.804 50.9916,-1606.16 121,-1804 179.363,-1968.93 198.544,-2106 373.5,-2106 373.5,-2106 373.5,-2106 526,-2106 682.952,-2106 720.541,-2039.5 831,-1928 848.435,-1910.4 868.01,-1890.07 881.932,-1875.51"/>
<polygon fill="#000000" stroke="#000000" points="884.662,-1877.72 889.035,-1868.07 879.598,-1872.88 884.662,-1877.72"/>
</g>
<!-- timer -->
<g id="proc~~siesta_analysis~~CallsGraph_node9" class="node"><title>timer</title>
<polygon fill="#777777" stroke="#777777" points="928.5,-1650 874.5,-1650 874.5,-1626 928.5,-1626 928.5,-1650"/>
<text text-anchor="middle" x="901.5" y="-1635.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">timer</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;timer -->
<g id="proc~~siesta_analysis~~CallsGraph_edge31" class="edge"><title>proc~siesta_analysis&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M43.9054,-801.249C48.5559,-932.139 96.8821,-2068 373.5,-2068 373.5,-2068 373.5,-2068 526,-2068 690.328,-2068 733.212,-1991.06 831,-1859 877.249,-1796.54 893.276,-1702.46 898.356,-1660.08"/>
<polygon fill="#000000" stroke="#000000" points="901.848,-1660.34 899.469,-1650.01 894.89,-1659.57 901.848,-1660.34"/>
</g>
<!-- siesta_write_forces -->
<g id="proc~~siesta_analysis~~CallsGraph_node10" class="node"><title>siesta_write_forces</title>
<polygon fill="#777777" stroke="#777777" points="248.5,-1242 144.5,-1242 144.5,-1218 248.5,-1218 248.5,-1242"/>
<text text-anchor="middle" x="196.5" y="-1227.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_write_forces</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;siesta_write_forces -->
<g id="proc~~siesta_analysis~~CallsGraph_edge9" class="edge"><title>proc~siesta_analysis&#45;&gt;siesta_write_forces</title>
<path fill="none" stroke="#000000" d="M44.0549,-801.14C47.1428,-863.433 64.1748,-1146.67 121,-1209 125.002,-1213.39 129.843,-1216.89 135.114,-1219.68"/>
<polygon fill="#000000" stroke="#000000" points="133.756,-1222.9 144.319,-1223.72 136.574,-1216.49 133.756,-1222.9"/>
</g>
<!-- message -->
<g id="proc~~siesta_analysis~~CallsGraph_node11" class="node"><title>message</title>
<polygon fill="#777777" stroke="#777777" points="224.5,-1200 168.5,-1200 168.5,-1176 224.5,-1176 224.5,-1200"/>
<text text-anchor="middle" x="196.5" y="-1185.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">message</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;message -->
<g id="proc~~siesta_analysis~~CallsGraph_edge10" class="edge"><title>proc~siesta_analysis&#45;&gt;message</title>
<path fill="none" stroke="#000000" d="M44.3196,-801.073C48.5174,-859.411 69.4487,-1111.57 121,-1167 130.626,-1177.35 144.92,-1182.74 158.42,-1185.5"/>
<polygon fill="#000000" stroke="#000000" points="158.067,-1188.99 168.498,-1187.13 159.188,-1182.08 158.067,-1188.99"/>
</g>
<!-- fdf_boolean -->
<g id="proc~~siesta_analysis~~CallsGraph_node12" class="node"><title>fdf_boolean</title>
<polygon fill="#777777" stroke="#777777" points="231,-1158 162,-1158 162,-1134 231,-1134 231,-1158"/>
<text text-anchor="middle" x="196.5" y="-1143.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fdf_boolean</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;fdf_boolean -->
<g id="proc~~siesta_analysis~~CallsGraph_edge11" class="edge"><title>proc~siesta_analysis&#45;&gt;fdf_boolean</title>
<path fill="none" stroke="#000000" d="M44.6617,-801.162C50.0996,-855.616 74.7422,-1076.46 121,-1125 129.174,-1133.58 140.556,-1138.74 151.965,-1141.82"/>
<polygon fill="#000000" stroke="#000000" points="151.398,-1145.28 161.919,-1144.02 152.912,-1138.44 151.398,-1145.28"/>
</g>
<!-- dipol -->
<g id="proc~~siesta_analysis~~CallsGraph_node13" class="node"><title>dipol</title>
<polygon fill="#777777" stroke="#777777" points="223.5,-1116 169.5,-1116 169.5,-1092 223.5,-1092 223.5,-1116"/>
<text text-anchor="middle" x="196.5" y="-1101.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dipol</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;dipol -->
<g id="proc~~siesta_analysis~~CallsGraph_edge12" class="edge"><title>proc~siesta_analysis&#45;&gt;dipol</title>
<path fill="none" stroke="#000000" d="M45.1102,-801.308C51.9346,-851.667 80.0158,-1041.31 121,-1083 131.06,-1093.23 145.689,-1098.58 159.326,-1101.34"/>
<polygon fill="#000000" stroke="#000000" points="159.037,-1104.84 169.468,-1102.99 160.157,-1097.93 159.037,-1104.84"/>
</g>
<!-- xa_last -->
<g id="proc~~siesta_analysis~~CallsGraph_node14" class="node"><title>xa_last</title>
<polygon fill="#777777" stroke="#777777" points="223.5,-1074 169.5,-1074 169.5,-1050 223.5,-1050 223.5,-1074"/>
<text text-anchor="middle" x="196.5" y="-1059.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xa_last</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;xa_last -->
<g id="proc~~siesta_analysis~~CallsGraph_edge13" class="edge"><title>proc~siesta_analysis&#45;&gt;xa_last</title>
<path fill="none" stroke="#000000" d="M43.4094,-801.03C43.7853,-841.23 50.5969,-972.24 121,-1041 131.189,-1050.95 145.711,-1056.26 159.231,-1059.07"/>
<polygon fill="#000000" stroke="#000000" points="158.844,-1062.55 169.287,-1060.76 160.007,-1055.65 158.844,-1062.55"/>
</g>
<!-- print_spin -->
<g id="proc~~siesta_analysis~~CallsGraph_node15" class="node"><title>print_spin</title>
<polygon fill="#777777" stroke="#777777" points="226,-1032 167,-1032 167,-1008 226,-1008 226,-1032"/>
<text text-anchor="middle" x="196.5" y="-1017.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_spin</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;print_spin -->
<g id="proc~~siesta_analysis~~CallsGraph_edge14" class="edge"><title>proc~siesta_analysis&#45;&gt;print_spin</title>
<path fill="none" stroke="#000000" d="M44.2599,-801.026C47.1802,-836.774 60.7796,-943.347 121,-999 130.812,-1008.07 144.239,-1013.26 156.994,-1016.22"/>
<polygon fill="#000000" stroke="#000000" points="156.516,-1019.69 166.997,-1018.14 157.839,-1012.82 156.516,-1019.69"/>
</g>
<!-- local_dos -->
<g id="proc~~siesta_analysis~~CallsGraph_node16" class="node"><title>local_dos</title>
<polygon fill="#777777" stroke="#777777" points="225.5,-990 167.5,-990 167.5,-966 225.5,-966 225.5,-990"/>
<text text-anchor="middle" x="196.5" y="-975.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">local_dos</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;local_dos -->
<g id="proc~~siesta_analysis~~CallsGraph_edge15" class="edge"><title>proc~siesta_analysis&#45;&gt;local_dos</title>
<path fill="none" stroke="#000000" d="M45.5394,-801.256C51.3498,-832.235 70.9212,-914.245 121,-957 131.161,-965.675 144.666,-970.779 157.386,-973.778"/>
<polygon fill="#000000" stroke="#000000" points="156.848,-977.239 167.339,-975.759 158.215,-970.374 156.848,-977.239"/>
</g>
<!-- scell_last -->
<g id="proc~~siesta_analysis~~CallsGraph_node17" class="node"><title>scell_last</title>
<polygon fill="#777777" stroke="#777777" points="224.5,-948 168.5,-948 168.5,-924 224.5,-924 224.5,-948"/>
<text text-anchor="middle" x="196.5" y="-933.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">scell_last</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;scell_last -->
<g id="proc~~siesta_analysis~~CallsGraph_edge16" class="edge"><title>proc~siesta_analysis&#45;&gt;scell_last</title>
<path fill="none" stroke="#000000" d="M47.5197,-801.133C56.4999,-826.327 80.6339,-884.501 121,-915 131.744,-923.118 145.493,-928.098 158.247,-931.154"/>
<polygon fill="#000000" stroke="#000000" points="157.684,-934.611 168.186,-933.214 159.105,-927.757 157.684,-934.611"/>
</g>
<!-- siesta_write_stress_pressure -->
<g id="proc~~siesta_analysis~~CallsGraph_node18" class="node"><title>siesta_write_stress_pressure</title>
<polygon fill="#777777" stroke="#777777" points="272,-906 121,-906 121,-882 272,-882 272,-906"/>
<text text-anchor="middle" x="196.5" y="-891.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_write_stress_pressure</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;siesta_write_stress_pressure -->
<g id="proc~~siesta_analysis~~CallsGraph_edge17" class="edge"><title>proc~siesta_analysis&#45;&gt;siesta_write_stress_pressure</title>
<path fill="none" stroke="#000000" d="M51.4668,-801.266C64.0324,-819.628 90.2167,-854.119 121,-873 123.953,-874.811 127.067,-876.471 130.28,-877.991"/>
<polygon fill="#000000" stroke="#000000" points="128.969,-881.237 139.542,-881.915 131.699,-874.791 128.969,-881.237"/>
</g>
<!-- pexsi_local_dos -->
<g id="proc~~siesta_analysis~~CallsGraph_node19" class="node"><title>pexsi_local_dos</title>
<polygon fill="#777777" stroke="#777777" points="240.5,-864 152.5,-864 152.5,-840 240.5,-840 240.5,-864"/>
<text text-anchor="middle" x="196.5" y="-849.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pexsi_local_dos</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;pexsi_local_dos -->
<g id="proc~~siesta_analysis~~CallsGraph_edge18" class="edge"><title>proc~siesta_analysis&#45;&gt;pexsi_local_dos</title>
<path fill="none" stroke="#000000" d="M62.9795,-801.133C78.3072,-810.286 100.44,-822.652 121,-831 127.848,-833.78 135.192,-836.336 142.503,-838.634"/>
<polygon fill="#000000" stroke="#000000" points="141.819,-842.082 152.403,-841.605 143.832,-835.378 141.819,-842.082"/>
</g>
<!-- projected_dos -->
<g id="proc~~siesta_analysis~~CallsGraph_node20" class="node"><title>projected_dos</title>
<polygon fill="#777777" stroke="#777777" points="236.5,-822 156.5,-822 156.5,-798 236.5,-798 236.5,-822"/>
<text text-anchor="middle" x="196.5" y="-807.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">projected_dos</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;projected_dos -->
<g id="proc~~siesta_analysis~~CallsGraph_edge19" class="edge"><title>proc~siesta_analysis&#45;&gt;projected_dos</title>
<path fill="none" stroke="#000000" d="M85.0347,-794.738C103.972,-797.355 126.532,-800.471 146.312,-803.204"/>
<polygon fill="#000000" stroke="#000000" points="145.984,-806.692 156.369,-804.594 146.942,-799.758 145.984,-806.692"/>
</g>
<!-- slua_call -->
<g id="proc~~siesta_analysis~~CallsGraph_node21" class="node"><title>slua_call</title>
<polygon fill="#777777" stroke="#777777" points="223.5,-780 169.5,-780 169.5,-756 223.5,-756 223.5,-780"/>
<text text-anchor="middle" x="196.5" y="-765.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">slua_call</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;slua_call -->
<g id="proc~~siesta_analysis~~CallsGraph_edge20" class="edge"><title>proc~siesta_analysis&#45;&gt;slua_call</title>
<path fill="none" stroke="#000000" d="M85.0347,-783.262C108.254,-780.054 136.92,-776.093 159.23,-773.011"/>
<polygon fill="#000000" stroke="#000000" points="159.879,-776.455 169.305,-771.619 158.92,-769.521 159.879,-776.455"/>
</g>
<!-- write_basis_enthalpy -->
<g id="proc~~siesta_analysis~~CallsGraph_node22" class="node"><title>write_basis_enthalpy</title>
<polygon fill="#777777" stroke="#777777" points="252.5,-738 140.5,-738 140.5,-714 252.5,-714 252.5,-738"/>
<text text-anchor="middle" x="196.5" y="-723.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_basis_enthalpy</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;write_basis_enthalpy -->
<g id="proc~~siesta_analysis~~CallsGraph_edge21" class="edge"><title>proc~siesta_analysis&#45;&gt;write_basis_enthalpy</title>
<path fill="none" stroke="#000000" d="M62.9795,-776.867C78.3072,-767.714 100.44,-755.348 121,-747 126.136,-744.915 131.551,-742.956 137.022,-741.138"/>
<polygon fill="#000000" stroke="#000000" points="138.403,-744.372 146.882,-738.019 136.292,-737.698 138.403,-744.372"/>
</g>
<!-- barrier -->
<g id="proc~~siesta_analysis~~CallsGraph_node23" class="node"><title>barrier</title>
<polygon fill="#777777" stroke="#777777" points="223.5,-696 169.5,-696 169.5,-672 223.5,-672 223.5,-696"/>
<text text-anchor="middle" x="196.5" y="-681.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">barrier</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;barrier -->
<g id="proc~~siesta_analysis~~CallsGraph_edge22" class="edge"><title>proc~siesta_analysis&#45;&gt;barrier</title>
<path fill="none" stroke="#000000" d="M51.4668,-776.734C64.0324,-758.372 90.2167,-723.881 121,-705 132.57,-697.904 146.606,-693.138 159.363,-689.969"/>
<polygon fill="#000000" stroke="#000000" points="160.253,-693.356 169.247,-687.755 158.724,-686.525 160.253,-693.356"/>
</g>
<!-- bands -->
<g id="proc~~siesta_analysis~~CallsGraph_node24" class="node"><title>bands</title>
<polygon fill="#777777" stroke="#777777" points="223.5,-654 169.5,-654 169.5,-630 223.5,-630 223.5,-654"/>
<text text-anchor="middle" x="196.5" y="-639.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bands</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;bands -->
<g id="proc~~siesta_analysis~~CallsGraph_edge23" class="edge"><title>proc~siesta_analysis&#45;&gt;bands</title>
<path fill="none" stroke="#000000" d="M47.5197,-776.867C56.4999,-751.673 80.6339,-693.499 121,-663 131.998,-654.69 146.144,-649.668 159.149,-646.633"/>
<polygon fill="#000000" stroke="#000000" points="160.139,-650.004 169.253,-644.6 158.759,-643.142 160.139,-650.004"/>
</g>
<!-- bk -->
<g id="proc~~siesta_analysis~~CallsGraph_node25" class="node"><title>bk</title>
<polygon fill="#777777" stroke="#777777" points="223.5,-612 169.5,-612 169.5,-588 223.5,-588 223.5,-612"/>
<text text-anchor="middle" x="196.5" y="-597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bk</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;bk -->
<g id="proc~~siesta_analysis~~CallsGraph_edge24" class="edge"><title>proc~siesta_analysis&#45;&gt;bk</title>
<path fill="none" stroke="#000000" d="M45.5394,-776.744C51.3498,-745.765 70.9212,-663.755 121,-621 131.75,-611.822 146.244,-606.641 159.59,-603.722"/>
<polygon fill="#000000" stroke="#000000" points="160.289,-607.152 169.491,-601.901 159.023,-600.267 160.289,-607.152"/>
</g>
<!-- optical -->
<g id="proc~~siesta_analysis~~CallsGraph_node26" class="node"><title>optical</title>
<polygon fill="#777777" stroke="#777777" points="223.5,-570 169.5,-570 169.5,-546 223.5,-546 223.5,-570"/>
<text text-anchor="middle" x="196.5" y="-555.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">optical</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;optical -->
<g id="proc~~siesta_analysis~~CallsGraph_edge25" class="edge"><title>proc~siesta_analysis&#45;&gt;optical</title>
<path fill="none" stroke="#000000" d="M44.2599,-776.974C47.1802,-741.226 60.7796,-634.653 121,-579 131.381,-569.406 145.809,-564.151 159.205,-561.289"/>
<polygon fill="#000000" stroke="#000000" points="159.924,-564.716 169.165,-559.534 158.709,-557.822 159.924,-564.716"/>
</g>
<!-- pexsi_dos -->
<g id="proc~~siesta_analysis~~CallsGraph_node27" class="node"><title>pexsi_dos</title>
<polygon fill="#777777" stroke="#777777" points="227,-528 166,-528 166,-504 227,-504 227,-528"/>
<text text-anchor="middle" x="196.5" y="-513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pexsi_dos</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;pexsi_dos -->
<g id="proc~~siesta_analysis~~CallsGraph_edge26" class="edge"><title>proc~siesta_analysis&#45;&gt;pexsi_dos</title>
<path fill="none" stroke="#000000" d="M43.4094,-776.97C43.7853,-736.77 50.5969,-605.76 121,-537 130.33,-527.887 143.294,-522.666 155.795,-519.695"/>
<polygon fill="#000000" stroke="#000000" points="156.504,-523.123 165.643,-517.763 155.157,-516.253 156.504,-523.123"/>
</g>
<!-- cmladdproperty -->
<g id="proc~~siesta_analysis~~CallsGraph_node28" class="node"><title>cmladdproperty</title>
<polygon fill="#777777" stroke="#777777" points="240,-486 153,-486 153,-462 240,-462 240,-486"/>
<text text-anchor="middle" x="196.5" y="-471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cmladdproperty</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;cmladdproperty -->
<g id="proc~~siesta_analysis~~CallsGraph_edge27" class="edge"><title>proc~siesta_analysis&#45;&gt;cmladdproperty</title>
<path fill="none" stroke="#000000" d="M45.1102,-776.692C51.9346,-726.333 80.0158,-536.687 121,-495 127.094,-488.801 134.865,-484.394 143.077,-481.269"/>
<polygon fill="#000000" stroke="#000000" points="144.378,-484.528 152.845,-478.16 142.254,-477.858 144.378,-484.528"/>
</g>
<!-- cmlstartmodule -->
<g id="proc~~siesta_analysis~~CallsGraph_node29" class="node"><title>cmlstartmodule</title>
<polygon fill="#777777" stroke="#777777" points="239,-444 154,-444 154,-420 239,-420 239,-444"/>
<text text-anchor="middle" x="196.5" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cmlstartmodule</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;cmlstartmodule -->
<g id="proc~~siesta_analysis~~CallsGraph_edge28" class="edge"><title>proc~siesta_analysis&#45;&gt;cmlstartmodule</title>
<path fill="none" stroke="#000000" d="M44.6617,-776.838C50.0996,-722.384 74.7422,-501.536 121,-453 127.264,-446.427 135.412,-441.861 144.013,-438.7"/>
<polygon fill="#000000" stroke="#000000" points="145.299,-441.967 153.839,-435.696 143.253,-435.272 145.299,-441.967"/>
</g>
<!-- outcoor -->
<g id="proc~~siesta_analysis~~CallsGraph_node30" class="node"><title>outcoor</title>
<polygon fill="#777777" stroke="#777777" points="223.5,-402 169.5,-402 169.5,-378 223.5,-378 223.5,-402"/>
<text text-anchor="middle" x="196.5" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">outcoor</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;outcoor -->
<g id="proc~~siesta_analysis~~CallsGraph_edge29" class="edge"><title>proc~siesta_analysis&#45;&gt;outcoor</title>
<path fill="none" stroke="#000000" d="M44.3196,-776.927C48.5174,-718.589 69.4487,-466.433 121,-411 130.772,-400.492 145.354,-395.097 159.033,-392.377"/>
<polygon fill="#000000" stroke="#000000" points="159.886,-395.786 169.222,-390.778 158.801,-388.87 159.886,-395.786"/>
</g>
<!-- die -->
<g id="proc~~siesta_analysis~~CallsGraph_node31" class="node"><title>die</title>
<polygon fill="#777777" stroke="#777777" points="223.5,-360 169.5,-360 169.5,-336 223.5,-336 223.5,-360"/>
<text text-anchor="middle" x="196.5" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">die</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;die -->
<g id="proc~~siesta_analysis~~CallsGraph_edge30" class="edge"><title>proc~siesta_analysis&#45;&gt;die</title>
<path fill="none" stroke="#000000" d="M44.0549,-776.86C47.1428,-714.567 64.1748,-431.327 121,-369 130.74,-358.317 145.45,-352.904 159.233,-350.219"/>
<polygon fill="#000000" stroke="#000000" points="160.136,-353.622 169.494,-348.655 159.081,-346.702 160.136,-353.622"/>
</g>
<!-- fdf_get -->
<g id="proc~~siesta_analysis~~CallsGraph_node32" class="node"><title>fdf_get</title>
<polygon fill="#777777" stroke="#777777" points="223.5,-318 169.5,-318 169.5,-294 223.5,-294 223.5,-318"/>
<text text-anchor="middle" x="196.5" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fdf_get</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;fdf_get -->
<g id="proc~~siesta_analysis~~CallsGraph_edge8" class="edge"><title>proc~siesta_analysis&#45;&gt;fdf_get</title>
<path fill="none" stroke="#000000" d="M43.8295,-776.98C45.8699,-711.309 58.822,-396.322 121,-327 130.653,-316.238 145.349,-310.813 159.145,-308.139"/>
<polygon fill="#000000" stroke="#000000" points="160.055,-311.542 169.421,-306.588 159.011,-304.62 160.055,-311.542"/>
</g>
<!-- setup_wfs_list -->
<g id="proc~~siesta_analysis~~CallsGraph_node33" class="node"><title>setup_wfs_list</title>
<polygon fill="#777777" stroke="#777777" points="236,-276 157,-276 157,-252 236,-252 236,-276"/>
<text text-anchor="middle" x="196.5" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_wfs_list</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;setup_wfs_list -->
<g id="proc~~siesta_analysis~~CallsGraph_edge32" class="edge"><title>proc~siesta_analysis&#45;&gt;setup_wfs_list</title>
<path fill="none" stroke="#000000" d="M43.6483,-776.819C44.74,-707.312 53.5403,-361.25 121,-285 127.812,-277.301 137.205,-272.328 147.029,-269.139"/>
<polygon fill="#000000" stroke="#000000" points="148.152,-272.462 156.917,-266.51 146.353,-265.697 148.152,-272.462"/>
</g>
<!-- siesta_write_positions -->
<g id="proc~~siesta_analysis~~CallsGraph_node34" class="node"><title>siesta_write_positions</title>
<polygon fill="#777777" stroke="#777777" points="255,-234 138,-234 138,-210 255,-210 255,-234"/>
<text text-anchor="middle" x="196.5" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_write_positions</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;siesta_write_positions -->
<g id="proc~~siesta_analysis~~CallsGraph_edge33" class="edge"><title>proc~siesta_analysis&#45;&gt;siesta_write_positions</title>
<path fill="none" stroke="#000000" d="M43.4903,-776.777C43.6802,-703.825 48.207,-326.244 121,-243 123.372,-240.288 126.064,-237.913 128.984,-235.835"/>
<polygon fill="#000000" stroke="#000000" points="130.86,-238.793 137.736,-230.732 127.334,-232.746 130.86,-238.793"/>
</g>
<!-- ksv_pol -->
<g id="proc~~siesta_analysis~~CallsGraph_node35" class="node"><title>ksv_pol</title>
<polygon fill="#777777" stroke="#777777" points="223.5,-192 169.5,-192 169.5,-168 223.5,-168 223.5,-192"/>
<text text-anchor="middle" x="196.5" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ksv_pol</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;ksv_pol -->
<g id="proc~~siesta_analysis~~CallsGraph_edge34" class="edge"><title>proc~siesta_analysis&#45;&gt;ksv_pol</title>
<path fill="none" stroke="#000000" d="M43.3545,-776.846C42.692,-700.85 42.8237,-291.303 121,-201 130.555,-189.963 145.416,-184.512 159.359,-181.893"/>
<polygon fill="#000000" stroke="#000000" points="159.871,-185.355 169.261,-180.447 158.86,-178.429 159.871,-185.355"/>
</g>
<!-- ucell -->
<g id="proc~~siesta_analysis~~CallsGraph_node36" class="node"><title>ucell</title>
<polygon fill="#777777" stroke="#777777" points="223.5,-150 169.5,-150 169.5,-126 223.5,-126 223.5,-150"/>
<text text-anchor="middle" x="196.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ucell</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;ucell -->
<g id="proc~~siesta_analysis~~CallsGraph_edge35" class="edge"><title>proc~siesta_analysis&#45;&gt;ucell</title>
<path fill="none" stroke="#000000" d="M43.235,-776.763C41.7675,-697.44 37.4814,-256.321 121,-159 130.507,-147.922 145.361,-142.464 159.311,-139.852"/>
<polygon fill="#000000" stroke="#000000" points="159.828,-143.314 169.221,-138.413 158.822,-136.386 159.828,-143.314"/>
</g>
<!-- ucell_last -->
<g id="proc~~siesta_analysis~~CallsGraph_node37" class="node"><title>ucell_last</title>
<polygon fill="#777777" stroke="#777777" points="225,-108 168,-108 168,-84 225,-84 225,-108"/>
<text text-anchor="middle" x="196.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ucell_last</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;ucell_last -->
<g id="proc~~siesta_analysis~~CallsGraph_edge36" class="edge"><title>proc~siesta_analysis&#45;&gt;ucell_last</title>
<path fill="none" stroke="#000000" d="M44.0896,-776.963C48.4135,-690.779 76.3131,-169.473 121,-117 130.095,-106.32 144.161,-100.858 157.631,-98.1347"/>
<polygon fill="#000000" stroke="#000000" points="158.39,-101.558 167.723,-96.5448 157.3,-94.6437 158.39,-101.558"/>
</g>
<!-- read_spmatrix -->
<g id="proc~~siesta_analysis~~CallsGraph_node38" class="node"><title>read_spmatrix</title>
<polygon fill="#777777" stroke="#777777" points="237,-66 156,-66 156,-42 237,-42 237,-66"/>
<text text-anchor="middle" x="196.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">read_spmatrix</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;read_spmatrix -->
<g id="proc~~siesta_analysis~~CallsGraph_edge37" class="edge"><title>proc~siesta_analysis&#45;&gt;read_spmatrix</title>
<path fill="none" stroke="#000000" d="M44.0115,-776.791C47.8771,-687.021 73.642,-130.988 121,-75 127.509,-67.3051 136.598,-62.3164 146.198,-59.1088"/>
<polygon fill="#000000" stroke="#000000" points="147.166,-62.4725 155.89,-56.4607 145.321,-55.72 147.166,-62.4725"/>
</g>
<!-- wwave -->
<g id="proc~~siesta_analysis~~CallsGraph_node39" class="node"><title>wwave</title>
<polygon fill="#777777" stroke="#777777" points="223.5,-24 169.5,-24 169.5,-0 223.5,-0 223.5,-24"/>
<text text-anchor="middle" x="196.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">wwave</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;wwave -->
<g id="proc~~siesta_analysis~~CallsGraph_edge38" class="edge"><title>proc~siesta_analysis&#45;&gt;wwave</title>
<path fill="none" stroke="#000000" d="M43.9279,-776.969C47.3091,-684.799 70.9055,-92.5829 121,-33 130.464,-21.7435 145.451,-16.2734 159.51,-13.6995"/>
<polygon fill="#000000" stroke="#000000" points="160.075,-17.1545 169.49,-12.2959 159.1,-10.2227 160.075,-17.1545"/>
</g>
<!-- proc~dhscf&#45;&gt;re_alloc -->
<g id="proc~~siesta_analysis~~CallsGraph_edge41" class="edge"><title>proc~dhscf&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M197.721,-1410.09C199.43,-1488.44 213.14,-1923.44 308,-2004 478.122,-2148.49 779.457,-1988.84 872.408,-1933.47"/>
<polygon fill="#000000" stroke="#000000" points="874.476,-1936.31 881.234,-1928.15 870.863,-1930.32 874.476,-1936.31"/>
</g>
<!-- proc~dhscf&#45;&gt;de_alloc -->
<g id="proc~~siesta_analysis~~CallsGraph_edge70" class="edge"><title>proc~dhscf&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M197.924,-1410.13C200.836,-1485.94 220.473,-1893.98 308,-1973 379.534,-2037.58 427.629,-1992 524,-1992 524,-1992 524,-1992 660,-1992 753.594,-1992 844.23,-1912.99 882.045,-1875.42"/>
<polygon fill="#000000" stroke="#000000" points="884.762,-1877.65 889.295,-1868.07 879.779,-1872.73 884.762,-1877.65"/>
</g>
<!-- proc~dhscf&#45;&gt;timer -->
<g id="proc~~siesta_analysis~~CallsGraph_edge67" class="edge"><title>proc~dhscf&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M223.795,-1394.31C238.769,-1391.33 257.394,-1386.08 272,-1377 292.31,-1364.37 286.151,-1346.73 308,-1337 361.998,-1312.95 386.699,-1313.64 441,-1337 462.371,-1346.19 456.15,-1364.68 477,-1375 618.812,-1445.2 708.867,-1312.39 831,-1413 893.093,-1464.15 900.793,-1569.6 901.032,-1615.66"/>
<polygon fill="#000000" stroke="#000000" points="897.531,-1615.75 900.965,-1625.77 904.531,-1615.8 897.531,-1615.75"/>
</g>
<!-- elecs -->
<g id="proc~~siesta_analysis~~CallsGraph_node40" class="node"><title>elecs</title>
<polygon fill="#777777" stroke="#777777" points="401.5,-1168 347.5,-1168 347.5,-1144 401.5,-1144 401.5,-1168"/>
<text text-anchor="middle" x="374.5" y="-1153.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elecs</text>
</g>
<!-- proc~dhscf&#45;&gt;elecs -->
<g id="proc~~siesta_analysis~~CallsGraph_edge45" class="edge"><title>proc~dhscf&#45;&gt;elecs</title>
<path fill="none" stroke="#000000" d="M223.505,-1397.34C239.727,-1395.51 259.777,-1390.41 272,-1377 331.38,-1311.88 252.055,-1250.1 308,-1182 315.433,-1172.95 326.462,-1167.04 337.36,-1163.17"/>
<polygon fill="#000000" stroke="#000000" points="338.676,-1166.43 347.225,-1160.17 336.639,-1159.74 338.676,-1166.43"/>
</g>
<!-- proc~forhar -->
<g id="proc~~siesta_analysis~~CallsGraph_node41" class="node"><title>proc~forhar</title>
<g id="a_proc~~siesta_analysis~~CallsGraph_node41"><a xlink:href=".././proc/forhar.html" xlink:title="forhar">
<polygon fill="#d9534f" stroke="#d9534f" points="401.5,-1762 347.5,-1762 347.5,-1738 401.5,-1738 401.5,-1762"/>
<text text-anchor="middle" x="374.5" y="-1747.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">forhar</text>
</a>
</g>
</g>
<!-- proc~dhscf&#45;&gt;proc~forhar -->
<g id="proc~~siesta_analysis~~CallsGraph_edge40" class="edge"><title>proc~dhscf&#45;&gt;proc~forhar</title>
<path fill="none" stroke="#000000" d="M197.816,-1410.24C199.729,-1458.2 213.194,-1635.32 308,-1729 315.918,-1736.82 326.753,-1741.73 337.332,-1744.82"/>
<polygon fill="#000000" stroke="#000000" points="336.748,-1748.28 347.292,-1747.24 338.406,-1741.47 336.748,-1748.28"/>
</g>
<!-- ts_voltage -->
<g id="proc~~siesta_analysis~~CallsGraph_node42" class="node"><title>ts_voltage</title>
<polygon fill="#777777" stroke="#777777" points="405,-1126 344,-1126 344,-1102 405,-1102 405,-1126"/>
<text text-anchor="middle" x="374.5" y="-1111.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ts_voltage</text>
</g>
<!-- proc~dhscf&#45;&gt;ts_voltage -->
<g id="proc~~siesta_analysis~~CallsGraph_edge42" class="edge"><title>proc~dhscf&#45;&gt;ts_voltage</title>
<path fill="none" stroke="#000000" d="M223.663,-1397.49C239.95,-1395.71 260.012,-1390.62 272,-1377 343.853,-1295.38 237.607,-1217.88 308,-1135 314.668,-1127.15 324.277,-1122.21 334.09,-1119.1"/>
<polygon fill="#000000" stroke="#000000" points="335.065,-1122.46 343.869,-1116.57 333.31,-1115.69 335.065,-1122.46"/>
</g>
<!-- mpi_barrier -->
<g id="proc~~siesta_analysis~~CallsGraph_node43" class="node"><title>mpi_barrier</title>
<polygon fill="#777777" stroke="#777777" points="821.5,-1610 754.5,-1610 754.5,-1586 821.5,-1586 821.5,-1610"/>
<text text-anchor="middle" x="788" y="-1595.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_barrier</text>
</g>
<!-- proc~dhscf&#45;&gt;mpi_barrier -->
<g id="proc~~siesta_analysis~~CallsGraph_edge43" class="edge"><title>proc~dhscf&#45;&gt;mpi_barrier</title>
<path fill="none" stroke="#000000" d="M200.896,-1410.17C210.869,-1443.31 243.51,-1535.23 308,-1573 381.202,-1615.88 641.312,-1606.34 744.435,-1600.66"/>
<polygon fill="#000000" stroke="#000000" points="744.705,-1604.15 754.491,-1600.09 744.309,-1597.16 744.705,-1604.15"/>
</g>
<!-- ts_hartree_fix -->
<g id="proc~~siesta_analysis~~CallsGraph_node44" class="node"><title>ts_hartree_fix</title>
<polygon fill="#777777" stroke="#777777" points="413.5,-1084 335.5,-1084 335.5,-1060 413.5,-1060 413.5,-1084"/>
<text text-anchor="middle" x="374.5" y="-1069.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ts_hartree_fix</text>
</g>
<!-- proc~dhscf&#45;&gt;ts_hartree_fix -->
<g id="proc~~siesta_analysis~~CallsGraph_edge44" class="edge"><title>proc~dhscf&#45;&gt;ts_hartree_fix</title>
<path fill="none" stroke="#000000" d="M223.762,-1397.57C240.09,-1395.83 260.16,-1390.75 272,-1377 355.037,-1280.6 226.687,-1190.86 308,-1093 312.722,-1087.32 318.988,-1083.15 325.776,-1080.11"/>
<polygon fill="#000000" stroke="#000000" points="327.088,-1083.36 335.259,-1076.61 324.665,-1076.79 327.088,-1083.36"/>
</g>
<!-- volcel -->
<g id="proc~~siesta_analysis~~CallsGraph_node45" class="node"><title>volcel</title>
<polygon fill="#777777" stroke="#777777" points="401.5,-1042 347.5,-1042 347.5,-1018 401.5,-1018 401.5,-1042"/>
<text text-anchor="middle" x="374.5" y="-1027.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">volcel</text>
</g>
<!-- proc~dhscf&#45;&gt;volcel -->
<g id="proc~~siesta_analysis~~CallsGraph_edge39" class="edge"><title>proc~dhscf&#45;&gt;volcel</title>
<path fill="none" stroke="#000000" d="M223.837,-1397.64C240.195,-1395.92 260.271,-1390.84 272,-1377 366.243,-1265.79 215.746,-1163.86 308,-1051 315.291,-1042.08 326.388,-1036.9 337.387,-1033.91"/>
<polygon fill="#000000" stroke="#000000" points="338.327,-1037.29 347.349,-1031.73 336.833,-1030.45 338.327,-1037.29"/>
</g>
<!-- ddot -->
<g id="proc~~siesta_analysis~~CallsGraph_node46" class="node"><title>ddot</title>
<polygon fill="#777777" stroke="#777777" points="401.5,-1000 347.5,-1000 347.5,-976 401.5,-976 401.5,-1000"/>
<text text-anchor="middle" x="374.5" y="-985.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ddot</text>
</g>
<!-- proc~dhscf&#45;&gt;ddot -->
<g id="proc~~siesta_analysis~~CallsGraph_edge46" class="edge"><title>proc~dhscf&#45;&gt;ddot</title>
<path fill="none" stroke="#000000" d="M223.531,-1397.72C239.979,-1396.07 260.271,-1391.02 272,-1377 377.463,-1250.97 204.791,-1136.88 308,-1009 315.235,-1000.04 326.318,-994.845 337.322,-991.857"/>
<polygon fill="#000000" stroke="#000000" points="338.266,-995.234 347.293,-989.688 336.777,-988.394 338.266,-995.234"/>
</g>
<!-- jms_setmeshdistr -->
<g id="proc~~siesta_analysis~~CallsGraph_node47" class="node"><title>jms_setmeshdistr</title>
<polygon fill="#777777" stroke="#777777" points="573,-1888 477,-1888 477,-1864 573,-1864 573,-1888"/>
<text text-anchor="middle" x="525" y="-1873.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jms_setmeshdistr</text>
</g>
<!-- proc~dhscf&#45;&gt;jms_setmeshdistr -->
<g id="proc~~siesta_analysis~~CallsGraph_edge47" class="edge"><title>proc~dhscf&#45;&gt;jms_setmeshdistr</title>
<path fill="none" stroke="#000000" d="M197.196,-1410.06C196.583,-1461.56 201.226,-1665.26 308,-1771 351.681,-1814.26 389.054,-1776.12 441,-1809 461.491,-1821.97 458.11,-1834.79 477,-1850 480.795,-1853.06 484.999,-1855.95 489.287,-1858.61"/>
<polygon fill="#000000" stroke="#000000" points="487.7,-1861.74 498.102,-1863.75 491.226,-1855.69 487.7,-1861.74"/>
</g>
<!-- mpitrace_restart -->
<g id="proc~~siesta_analysis~~CallsGraph_node48" class="node"><title>mpitrace_restart</title>
<polygon fill="#777777" stroke="#777777" points="420,-958 329,-958 329,-934 420,-934 420,-958"/>
<text text-anchor="middle" x="374.5" y="-943.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpitrace_restart</text>
</g>
<!-- proc~dhscf&#45;&gt;mpitrace_restart -->
<g id="proc~~siesta_analysis~~CallsGraph_edge48" class="edge"><title>proc~dhscf&#45;&gt;mpitrace_restart</title>
<path fill="none" stroke="#000000" d="M223.577,-1397.76C240.044,-1396.12 260.341,-1391.07 272,-1377 330.347,-1306.57 250.913,-1038.46 308,-967 311.27,-962.906 315.343,-959.599 319.848,-956.929"/>
<polygon fill="#000000" stroke="#000000" points="321.46,-960.038 328.946,-952.54 318.419,-953.733 321.46,-960.038"/>
</g>
<!-- bsc_cellxc -->
<g id="proc~~siesta_analysis~~CallsGraph_node49" class="node"><title>bsc_cellxc</title>
<polygon fill="#777777" stroke="#777777" points="555.5,-1728 494.5,-1728 494.5,-1704 555.5,-1704 555.5,-1728"/>
<text text-anchor="middle" x="525" y="-1713.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bsc_cellxc</text>
</g>
<!-- proc~dhscf&#45;&gt;bsc_cellxc -->
<g id="proc~~siesta_analysis~~CallsGraph_edge49" class="edge"><title>proc~dhscf&#45;&gt;bsc_cellxc</title>
<path fill="none" stroke="#000000" d="M200.569,-1410.03C210.173,-1445.32 242.972,-1549.61 308,-1606 355.477,-1647.17 389.073,-1618.6 441,-1654 461.037,-1667.66 457.48,-1680.61 477,-1695 479.509,-1696.85 482.206,-1698.58 484.995,-1700.2"/>
<polygon fill="#000000" stroke="#000000" points="483.607,-1703.43 494.089,-1704.97 486.855,-1697.23 483.607,-1703.43"/>
</g>
<!-- write_grid_netcdf -->
<g id="proc~~siesta_analysis~~CallsGraph_node50" class="node"><title>write_grid_netcdf</title>
<polygon fill="#777777" stroke="#777777" points="421.5,-916 327.5,-916 327.5,-892 421.5,-892 421.5,-916"/>
<text text-anchor="middle" x="374.5" y="-901.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_grid_netcdf</text>
</g>
<!-- proc~dhscf&#45;&gt;write_grid_netcdf -->
<g id="proc~~siesta_analysis~~CallsGraph_edge50" class="edge"><title>proc~dhscf&#45;&gt;write_grid_netcdf</title>
<path fill="none" stroke="#000000" d="M223.615,-1397.79C240.098,-1396.17 260.398,-1391.12 272,-1377 335.965,-1299.14 245.427,-1003.98 308,-925 310.872,-921.374 314.375,-918.365 318.252,-915.869"/>
<polygon fill="#000000" stroke="#000000" points="319.988,-918.911 327.236,-911.183 316.751,-912.704 319.988,-918.911"/>
</g>
<!-- proc~bye -->
<g id="proc~~siesta_analysis~~CallsGraph_node51" class="node"><title>proc~bye</title>
<g id="a_proc~~siesta_analysis~~CallsGraph_node51"><a xlink:href=".././proc/bye.html" xlink:title="bye">
<polygon fill="#d9534f" stroke="#d9534f" points="815,-909 761,-909 761,-885 815,-885 815,-909"/>
<text text-anchor="middle" x="788" y="-894.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bye</text>
</a>
</g>
</g>
<!-- proc~dhscf&#45;&gt;proc~bye -->
<g id="proc~~siesta_analysis~~CallsGraph_edge51" class="edge"><title>proc~dhscf&#45;&gt;proc~bye</title>
<path fill="none" stroke="#000000" d="M223.732,-1397.18C239.837,-1395.26 259.671,-1390.12 272,-1377 323.987,-1321.66 255.147,-1264.51 308,-1210 350.395,-1166.27 401.74,-1223.56 441,-1177 511.239,-1093.7 397.175,-762.165 477,-688 554.206,-616.269 630.575,-666.603 709,-737 751.125,-774.813 772.901,-840.43 781.882,-874.703"/>
<polygon fill="#000000" stroke="#000000" points="778.547,-875.795 784.357,-884.654 785.34,-874.105 778.547,-875.795"/>
</g>
<!-- proc~setmeshdistr -->
<g id="proc~~siesta_analysis~~CallsGraph_node52" class="node"><title>proc~setmeshdistr</title>
<g id="a_proc~~siesta_analysis~~CallsGraph_node52"><a xlink:href=".././proc/setmeshdistr.html" xlink:title="setMeshDistr">
<polygon fill="#d9534f" stroke="#d9534f" points="562.5,-1686 487.5,-1686 487.5,-1662 562.5,-1662 562.5,-1686"/>
<text text-anchor="middle" x="525" y="-1671.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setMeshDistr</text>
</a>
</g>
</g>
<!-- proc~dhscf&#45;&gt;proc~setmeshdistr -->
<g id="proc~~siesta_analysis~~CallsGraph_edge52" class="edge"><title>proc~dhscf&#45;&gt;proc~setmeshdistr</title>
<path fill="none" stroke="#000000" d="M209.315,-1410.19C228.419,-1429.27 268.006,-1466.25 308,-1488 362.575,-1517.68 397.641,-1486.51 441,-1531 480.457,-1571.49 439.775,-1610.45 477,-1653 477.861,-1653.98 478.776,-1654.92 479.738,-1655.82"/>
<polygon fill="#000000" stroke="#000000" points="477.759,-1658.71 487.859,-1661.91 481.958,-1653.11 477.759,-1658.71"/>
</g>
<!-- rhoofdsp -->
<g id="proc~~siesta_analysis~~CallsGraph_node53" class="node"><title>rhoofdsp</title>
<polygon fill="#777777" stroke="#777777" points="402,-874 347,-874 347,-850 402,-850 402,-874"/>
<text text-anchor="middle" x="374.5" y="-859.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rhoofdsp</text>
</g>
<!-- proc~dhscf&#45;&gt;rhoofdsp -->
<g id="proc~~siesta_analysis~~CallsGraph_edge53" class="edge"><title>proc~dhscf&#45;&gt;rhoofdsp</title>
<path fill="none" stroke="#000000" d="M223.646,-1397.82C240.142,-1396.2 260.446,-1391.16 272,-1377 341.586,-1291.72 239.939,-969.503 308,-883 315.067,-874.018 326.004,-868.817 336.93,-865.825"/>
<polygon fill="#000000" stroke="#000000" points="337.83,-869.211 346.85,-863.653 336.333,-862.373 337.83,-869.211"/>
</g>
<!-- proc~die -->
<g id="proc~~siesta_analysis~~CallsGraph_node54" class="node"><title>proc~die</title>
<g id="a_proc~~siesta_analysis~~CallsGraph_node54"><a xlink:href=".././proc/die.html" xlink:title="die">
<polygon fill="#d9534f" stroke="#d9534f" points="815,-1014 761,-1014 761,-990 815,-990 815,-1014"/>
<text text-anchor="middle" x="788" y="-999.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">die</text>
</a>
</g>
</g>
<!-- proc~dhscf&#45;&gt;proc~die -->
<g id="proc~~siesta_analysis~~CallsGraph_edge54" class="edge"><title>proc~dhscf&#45;&gt;proc~die</title>
<path fill="none" stroke="#000000" d="M223.782,-1396.83C239.7,-1394.76 259.313,-1389.59 272,-1377 312.737,-1336.58 268.038,-1294.19 308,-1253 351.261,-1208.41 402.663,-1258.88 441,-1210 509.608,-1122.52 395.607,-786.733 477,-711 508.237,-681.936 534.491,-692.628 573,-711 632.77,-739.515 739.574,-919.044 775.124,-981.004"/>
<polygon fill="#000000" stroke="#000000" points="772.204,-982.948 780.2,-989.898 778.283,-979.478 772.204,-982.948"/>
</g>
<!-- get_field_from_dipole -->
<g id="proc~~siesta_analysis~~CallsGraph_node55" class="node"><title>get_field_from_dipole</title>
<polygon fill="#777777" stroke="#777777" points="432,-832 317,-832 317,-808 432,-808 432,-832"/>
<text text-anchor="middle" x="374.5" y="-817.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_field_from_dipole</text>
</g>
<!-- proc~dhscf&#45;&gt;get_field_from_dipole -->
<g id="proc~~siesta_analysis~~CallsGraph_edge55" class="edge"><title>proc~dhscf&#45;&gt;get_field_from_dipole</title>
<path fill="none" stroke="#000000" d="M223.673,-1397.84C240.18,-1396.23 260.486,-1391.19 272,-1377 347.209,-1284.29 234.448,-935.03 308,-841 308.595,-840.239 309.219,-839.505 309.868,-838.797"/>
<polygon fill="#000000" stroke="#000000" points="312.32,-841.306 317.686,-832.17 307.794,-835.966 312.32,-841.306"/>
</g>
<!-- vmatsp -->
<g id="proc~~siesta_analysis~~CallsGraph_node56" class="node"><title>vmatsp</title>
<polygon fill="#777777" stroke="#777777" points="401.5,-790 347.5,-790 347.5,-766 401.5,-766 401.5,-790"/>
<text text-anchor="middle" x="374.5" y="-775.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">vmatsp</text>
</g>
<!-- proc~dhscf&#45;&gt;vmatsp -->
<g id="proc~~siesta_analysis~~CallsGraph_edge56" class="edge"><title>proc~dhscf&#45;&gt;vmatsp</title>
<path fill="none" stroke="#000000" d="M223.695,-1397.86C240.212,-1396.26 260.521,-1391.22 272,-1377 352.834,-1276.86 228.957,-900.558 308,-799 315.132,-789.837 326.295,-784.605 337.399,-781.64"/>
<polygon fill="#000000" stroke="#000000" points="338.405,-785.004 347.462,-779.506 336.953,-778.156 338.405,-785.004"/>
</g>
<!-- add_potential_from_field -->
<g id="proc~~siesta_analysis~~CallsGraph_node57" class="node"><title>add_potential_from_field</title>
<polygon fill="#777777" stroke="#777777" points="439.5,-748 309.5,-748 309.5,-724 439.5,-724 439.5,-748"/>
<text text-anchor="middle" x="374.5" y="-733.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">add_potential_from_field</text>
</g>
<!-- proc~dhscf&#45;&gt;add_potential_from_field -->
<g id="proc~~siesta_analysis~~CallsGraph_edge57" class="edge"><title>proc~dhscf&#45;&gt;add_potential_from_field</title>
<path fill="none" stroke="#000000" d="M223.715,-1397.87C240.24,-1396.28 260.551,-1391.24 272,-1377 358.46,-1269.43 223.464,-866.088 308,-757 308.592,-756.236 309.212,-755.499 309.858,-754.789"/>
<polygon fill="#000000" stroke="#000000" points="312.313,-757.295 317.651,-748.143 307.771,-751.969 312.313,-757.295"/>
</g>
<!-- hartree_add -->
<g id="proc~~siesta_analysis~~CallsGraph_node58" class="node"><title>hartree_add</title>
<polygon fill="#777777" stroke="#777777" points="410,-706 339,-706 339,-682 410,-682 410,-706"/>
<text text-anchor="middle" x="374.5" y="-691.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hartree_add</text>
</g>
<!-- proc~dhscf&#45;&gt;hartree_add -->
<g id="proc~~siesta_analysis~~CallsGraph_edge58" class="edge"><title>proc~dhscf&#45;&gt;hartree_add</title>
<path fill="none" stroke="#000000" d="M223.732,-1397.89C240.265,-1396.3 260.577,-1391.27 272,-1377 364.087,-1262 217.969,-831.62 308,-715 313.35,-708.07 321.007,-703.387 329.212,-700.232"/>
<polygon fill="#000000" stroke="#000000" points="330.482,-703.503 338.989,-697.188 328.401,-696.819 330.482,-703.503"/>
</g>
<!-- proc~reord -->
<g id="proc~~siesta_analysis~~CallsGraph_node59" class="node"><title>proc~reord</title>
<g id="a_proc~~siesta_analysis~~CallsGraph_node59"><a xlink:href=".././proc/reord.html" xlink:title="reord">
<polygon fill="#d9534f" stroke="#d9534f" points="815,-1850 761,-1850 761,-1826 815,-1826 815,-1850"/>
<text text-anchor="middle" x="788" y="-1835.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reord</text>
</a>
</g>
</g>
<!-- proc~dhscf&#45;&gt;proc~reord -->
<g id="proc~~siesta_analysis~~CallsGraph_edge59" class="edge"><title>proc~dhscf&#45;&gt;proc~reord</title>
<path fill="none" stroke="#000000" d="M198.818,-1410.27C206.102,-1475.86 243.474,-1784.74 308,-1851 314.789,-1857.97 467.355,-1895.71 477,-1897 519.291,-1902.65 530.719,-1902.72 573,-1897 637.172,-1888.32 709.298,-1865.61 751.29,-1851.04"/>
<polygon fill="#000000" stroke="#000000" points="752.515,-1854.32 760.789,-1847.7 750.194,-1847.71 752.515,-1854.32"/>
</g>
<!-- compute_partial_charges -->
<g id="proc~~siesta_analysis~~CallsGraph_node60" class="node"><title>compute_partial_charges</title>
<polygon fill="#777777" stroke="#777777" points="441,-664 308,-664 308,-640 441,-640 441,-664"/>
<text text-anchor="middle" x="374.5" y="-649.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_partial_charges</text>
</g>
<!-- proc~dhscf&#45;&gt;compute_partial_charges -->
<g id="proc~~siesta_analysis~~CallsGraph_edge60" class="edge"><title>proc~dhscf&#45;&gt;compute_partial_charges</title>
<path fill="none" stroke="#000000" d="M223.748,-1397.9C240.287,-1396.32 260.6,-1391.28 272,-1377 369.714,-1254.56 212.475,-797.152 308,-673 308.589,-672.234 309.207,-671.495 309.85,-670.783"/>
<polygon fill="#000000" stroke="#000000" points="312.308,-673.287 317.625,-664.123 307.753,-667.971 312.308,-673.287"/>
</g>
<!-- write_tdrho -->
<g id="proc~~siesta_analysis~~CallsGraph_node61" class="node"><title>write_tdrho</title>
<polygon fill="#777777" stroke="#777777" points="407.5,-622 341.5,-622 341.5,-598 407.5,-598 407.5,-622"/>
<text text-anchor="middle" x="374.5" y="-607.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_tdrho</text>
</g>
<!-- proc~dhscf&#45;&gt;write_tdrho -->
<g id="proc~~siesta_analysis~~CallsGraph_edge61" class="edge"><title>proc~dhscf&#45;&gt;write_tdrho</title>
<path fill="none" stroke="#000000" d="M223.761,-1397.91C240.306,-1396.33 260.62,-1391.3 272,-1377 375.343,-1247.13 206.979,-762.685 308,-631 313.818,-623.416 322.402,-618.521 331.453,-615.376"/>
<polygon fill="#000000" stroke="#000000" points="332.663,-618.672 341.349,-612.605 330.775,-611.931 332.663,-618.672"/>
</g>
<!-- dfscf -->
<g id="proc~~siesta_analysis~~CallsGraph_node62" class="node"><title>dfscf</title>
<polygon fill="#777777" stroke="#777777" points="401.5,-580 347.5,-580 347.5,-556 401.5,-556 401.5,-580"/>
<text text-anchor="middle" x="374.5" y="-565.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dfscf</text>
</g>
<!-- proc~dhscf&#45;&gt;dfscf -->
<g id="proc~~siesta_analysis~~CallsGraph_edge62" class="edge"><title>proc~dhscf&#45;&gt;dfscf</title>
<path fill="none" stroke="#000000" d="M223.773,-1397.92C240.323,-1396.35 260.639,-1391.32 272,-1377 326.486,-1308.35 254.741,-658.61 308,-589 315.056,-579.778 326.201,-574.532 337.311,-571.572"/>
<polygon fill="#000000" stroke="#000000" points="338.324,-574.936 347.386,-569.448 336.879,-568.086 338.324,-574.936"/>
</g>
<!-- partialcoreonmesh -->
<g id="proc~~siesta_analysis~~CallsGraph_node63" class="node"><title>partialcoreonmesh</title>
<polygon fill="#777777" stroke="#777777" points="425,-1964 324,-1964 324,-1940 425,-1940 425,-1964"/>
<text text-anchor="middle" x="374.5" y="-1949.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">partialcoreonmesh</text>
</g>
<!-- proc~dhscf&#45;&gt;partialcoreonmesh -->
<g id="proc~~siesta_analysis~~CallsGraph_edge63" class="edge"><title>proc~dhscf&#45;&gt;partialcoreonmesh</title>
<path fill="none" stroke="#000000" d="M198.403,-1410.4C203.908,-1482.76 235.167,-1850.02 308,-1931 310.059,-1933.29 312.367,-1935.33 314.854,-1937.15"/>
<polygon fill="#000000" stroke="#000000" points="313.509,-1940.42 323.894,-1942.52 317.086,-1934.4 313.509,-1940.42"/>
</g>
<!-- mymeshbox -->
<g id="proc~~siesta_analysis~~CallsGraph_node64" class="node"><title>mymeshbox</title>
<polygon fill="#777777" stroke="#777777" points="560,-1644 490,-1644 490,-1620 560,-1620 560,-1644"/>
<text text-anchor="middle" x="525" y="-1629.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mymeshbox</text>
</g>
<!-- proc~dhscf&#45;&gt;mymeshbox -->
<g id="proc~~siesta_analysis~~CallsGraph_edge64" class="edge"><title>proc~dhscf&#45;&gt;mymeshbox</title>
<path fill="none" stroke="#000000" d="M221.352,-1410.02C243.538,-1421 277.643,-1437.41 308,-1450 366.05,-1474.07 392.755,-1457.73 441,-1498 465.462,-1518.42 460.286,-1532.87 477,-1560 487.791,-1577.51 500.585,-1597.04 510.097,-1611.33"/>
<polygon fill="#000000" stroke="#000000" points="507.354,-1613.53 515.82,-1619.89 513.174,-1609.64 507.354,-1613.53"/>
</g>
<!-- neutralatomonmesh -->
<g id="proc~~siesta_analysis~~CallsGraph_node65" class="node"><title>neutralatomonmesh</title>
<polygon fill="#777777" stroke="#777777" points="428.5,-1922 320.5,-1922 320.5,-1898 428.5,-1898 428.5,-1922"/>
<text text-anchor="middle" x="374.5" y="-1907.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">neutralatomonmesh</text>
</g>
<!-- proc~dhscf&#45;&gt;neutralatomonmesh -->
<g id="proc~~siesta_analysis~~CallsGraph_edge65" class="edge"><title>proc~dhscf&#45;&gt;neutralatomonmesh</title>
<path fill="none" stroke="#000000" d="M198.731,-1410.12C205.821,-1477.8 243.411,-1808.59 308,-1884 310.82,-1887.29 314.115,-1890.17 317.699,-1892.69"/>
<polygon fill="#000000" stroke="#000000" points="316.115,-1895.82 326.497,-1897.93 319.697,-1889.81 316.115,-1895.82"/>
</g>
<!-- interface~distmeshdata -->
<g id="proc~~siesta_analysis~~CallsGraph_node66" class="node"><title>interface~distmeshdata</title>
<g id="a_proc~~siesta_analysis~~CallsGraph_node66"><a xlink:href=".././interface/distmeshdata.html" xlink:title="distMeshData">
<polygon fill="#a7506f" stroke="#a7506f" points="564,-1770 486,-1770 486,-1746 564,-1746 564,-1770"/>
<text text-anchor="middle" x="525" y="-1755.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">distMeshData</text>
</a>
</g>
</g>
<!-- proc~dhscf&#45;&gt;interface~distmeshdata -->
<g id="proc~~siesta_analysis~~CallsGraph_edge66" class="edge"><title>proc~dhscf&#45;&gt;interface~distmeshdata</title>
<path fill="none" stroke="#000000" d="M199.374,-1410.01C206.174,-1449.56 233.209,-1576.98 308,-1644 354.266,-1685.46 390.793,-1650.41 441,-1687 463.13,-1703.13 455.768,-1719.71 477,-1737 478.559,-1738.27 480.207,-1739.48 481.917,-1740.63"/>
<polygon fill="#000000" stroke="#000000" points="480.452,-1743.83 490.847,-1745.87 483.998,-1737.79 480.452,-1743.83"/>
</g>
<!-- mpi_allreduce -->
<g id="proc~~siesta_analysis~~CallsGraph_node67" class="node"><title>mpi_allreduce</title>
<polygon fill="#777777" stroke="#777777" points="414,-1842 335,-1842 335,-1818 414,-1818 414,-1842"/>
<text text-anchor="middle" x="374.5" y="-1827.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_allreduce</text>
</g>
<!-- proc~dhscf&#45;&gt;mpi_allreduce -->
<g id="proc~~siesta_analysis~~CallsGraph_edge68" class="edge"><title>proc~dhscf&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M197.13,-1410.08C196.152,-1463.63 199.204,-1682.26 308,-1804 312.876,-1809.46 319.05,-1813.78 325.648,-1817.21"/>
<polygon fill="#000000" stroke="#000000" points="324.271,-1820.43 334.826,-1821.34 327.147,-1814.04 324.271,-1820.43"/>
</g>
<!-- vacuum_level -->
<g id="proc~~siesta_analysis~~CallsGraph_node68" class="node"><title>vacuum_level</title>
<polygon fill="#777777" stroke="#777777" points="413.5,-1720 335.5,-1720 335.5,-1696 413.5,-1696 413.5,-1720"/>
<text text-anchor="middle" x="374.5" y="-1705.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">vacuum_level</text>
</g>
<!-- proc~dhscf&#45;&gt;vacuum_level -->
<g id="proc~~siesta_analysis~~CallsGraph_edge69" class="edge"><title>proc~dhscf&#45;&gt;vacuum_level</title>
<path fill="none" stroke="#000000" d="M198.779,-1410.09C203.953,-1453.12 227.096,-1600.54 308,-1682 313.157,-1687.19 319.48,-1691.38 326.142,-1694.74"/>
<polygon fill="#000000" stroke="#000000" points="324.8,-1697.98 335.36,-1698.84 327.644,-1691.58 324.8,-1697.98"/>
</g>
<!-- localchargeonmesh -->
<g id="proc~~siesta_analysis~~CallsGraph_node69" class="node"><title>localchargeonmesh</title>
<polygon fill="#777777" stroke="#777777" points="427.5,-1564 321.5,-1564 321.5,-1540 427.5,-1540 427.5,-1564"/>
<text text-anchor="middle" x="374.5" y="-1549.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">localchargeonmesh</text>
</g>
<!-- proc~dhscf&#45;&gt;localchargeonmesh -->
<g id="proc~~siesta_analysis~~CallsGraph_edge71" class="edge"><title>proc~dhscf&#45;&gt;localchargeonmesh</title>
<path fill="none" stroke="#000000" d="M205.137,-1410.3C221.248,-1435.34 261.111,-1492.65 308,-1526 313.169,-1529.68 318.93,-1532.93 324.833,-1535.78"/>
<polygon fill="#000000" stroke="#000000" points="323.599,-1539.06 334.158,-1539.93 326.447,-1532.67 323.599,-1539.06"/>
</g>
<!-- write_debug -->
<g id="proc~~siesta_analysis~~CallsGraph_node70" class="node"><title>write_debug</title>
<polygon fill="#777777" stroke="#777777" points="823.5,-1568 752.5,-1568 752.5,-1544 823.5,-1544 823.5,-1568"/>
<text text-anchor="middle" x="788" y="-1553.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_debug</text>
</g>
<!-- proc~dhscf&#45;&gt;write_debug -->
<g id="proc~~siesta_analysis~~CallsGraph_edge72" class="edge"><title>proc~dhscf&#45;&gt;write_debug</title>
<path fill="none" stroke="#000000" d="M223.786,-1403.04C284.9,-1414.83 432.049,-1443.71 441,-1450 465.818,-1467.45 451.696,-1491.26 477,-1508 558.318,-1561.8 677.514,-1563.82 741.837,-1560.18"/>
<polygon fill="#000000" stroke="#000000" points="742.297,-1563.66 752.053,-1559.53 741.85,-1556.67 742.297,-1563.66"/>
</g>
<!-- proc~rhoofd -->
<g id="proc~~siesta_analysis~~CallsGraph_node71" class="node"><title>proc~rhoofd</title>
<g id="a_proc~~siesta_analysis~~CallsGraph_node71"><a xlink:href=".././proc/rhoofd.html" xlink:title="rhoofd">
<polygon fill="#d9534f" stroke="#d9534f" points="401.5,-1286 347.5,-1286 347.5,-1262 401.5,-1262 401.5,-1286"/>
<text text-anchor="middle" x="374.5" y="-1271.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rhoofd</text>
</a>
</g>
</g>
<!-- proc~dhscf&#45;&gt;proc~rhoofd -->
<g id="proc~~siesta_analysis~~CallsGraph_edge73" class="edge"><title>proc~dhscf&#45;&gt;proc~rhoofd</title>
<path fill="none" stroke="#000000" d="M223.759,-1395.92C239.274,-1393.49 258.465,-1388.26 272,-1377 299.815,-1353.87 282.056,-1329.21 308,-1304 316.379,-1295.86 327.363,-1289.66 337.936,-1285.08"/>
<polygon fill="#000000" stroke="#000000" points="339.436,-1288.25 347.444,-1281.31 336.858,-1281.74 339.436,-1288.25"/>
</g>
<!-- vmat -->
<g id="proc~~siesta_analysis~~CallsGraph_node72" class="node"><title>vmat</title>
<polygon fill="#777777" stroke="#777777" points="401.5,-1370 347.5,-1370 347.5,-1346 401.5,-1346 401.5,-1370"/>
<text text-anchor="middle" x="374.5" y="-1355.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">vmat</text>
</g>
<!-- proc~dhscf&#45;&gt;vmat -->
<g id="proc~~siesta_analysis~~CallsGraph_edge74" class="edge"><title>proc~dhscf&#45;&gt;vmat</title>
<path fill="none" stroke="#000000" d="M223.849,-1392.01C254.005,-1385.16 303.571,-1373.89 337.329,-1366.22"/>
<polygon fill="#000000" stroke="#000000" points="338.283,-1369.59 347.259,-1363.96 336.732,-1362.77 338.283,-1369.59"/>
</g>
<!-- proc~write_rho -->
<g id="proc~~siesta_analysis~~CallsGraph_node73" class="node"><title>proc~write_rho</title>
<g id="a_proc~~siesta_analysis~~CallsGraph_node73"><a xlink:href=".././proc/write_rho.html" xlink:title="write_rho">
<polygon fill="#d9534f" stroke="#d9534f" points="687.5,-1503 630.5,-1503 630.5,-1479 687.5,-1479 687.5,-1503"/>
<text text-anchor="middle" x="659" y="-1488.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_rho</text>
</a>
</g>
</g>
<!-- proc~dhscf&#45;&gt;proc~write_rho -->
<g id="proc~~siesta_analysis~~CallsGraph_edge75" class="edge"><title>proc~dhscf&#45;&gt;proc~write_rho</title>
<path fill="none" stroke="#000000" d="M223.797,-1393.31C271.333,-1386.31 372.936,-1378.23 441,-1422 467.801,-1439.23 449.698,-1467.57 477,-1484 520.657,-1510.27 581.554,-1506.09 620.382,-1499.48"/>
<polygon fill="#000000" stroke="#000000" points="621.031,-1502.92 630.234,-1497.67 619.767,-1496.04 621.031,-1502.92"/>
</g>
<!-- proc~forhar&#45;&gt;re_alloc -->
<g id="proc~~siesta_analysis~~CallsGraph_edge78" class="edge"><title>proc~forhar&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M401.653,-1752.81C414.333,-1755.12 429.309,-1759.33 441,-1767 462.711,-1781.23 456.294,-1797.34 477,-1813 489.639,-1822.56 593.809,-1862.49 609,-1867 667.994,-1884.52 684.326,-1882.72 745,-1893 785.733,-1899.9 832.669,-1906.68 864.227,-1911.07"/>
<polygon fill="#000000" stroke="#000000" points="863.924,-1914.57 874.309,-1912.47 864.883,-1907.63 863.924,-1914.57"/>
</g>
<!-- proc~forhar&#45;&gt;de_alloc -->
<g id="proc~~siesta_analysis~~CallsGraph_edge80" class="edge"><title>proc~forhar&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M401.794,-1756.23C413.819,-1759.23 428.207,-1763.03 441,-1767 578.243,-1809.54 603.475,-1852.18 745,-1877 782.648,-1883.6 793.188,-1882.59 831,-1877 842.056,-1875.37 853.79,-1872.35 864.407,-1869.09"/>
<polygon fill="#000000" stroke="#000000" points="865.74,-1872.34 874.185,-1865.94 863.593,-1865.68 865.74,-1872.34"/>
</g>
<!-- proc~forhar&#45;&gt;jms_setmeshdistr -->
<g id="proc~~siesta_analysis~~CallsGraph_edge81" class="edge"><title>proc~forhar&#45;&gt;jms_setmeshdistr</title>
<path fill="none" stroke="#000000" d="M401.557,-1755.57C414.669,-1759.47 430.058,-1765.85 441,-1776 467.812,-1800.88 451.826,-1823.47 477,-1850 479.96,-1853.12 483.38,-1855.96 486.997,-1858.52"/>
<polygon fill="#000000" stroke="#000000" points="485.345,-1861.61 495.672,-1863.98 489.074,-1855.69 485.345,-1861.61"/>
</g>
<!-- proc~forhar&#45;&gt;bsc_cellxc -->
<g id="proc~~siesta_analysis~~CallsGraph_edge82" class="edge"><title>proc~forhar&#45;&gt;bsc_cellxc</title>
<path fill="none" stroke="#000000" d="M401.707,-1744C424.641,-1738.75 458.292,-1731.04 484.492,-1725.05"/>
<polygon fill="#000000" stroke="#000000" points="485.523,-1728.4 494.489,-1722.76 483.96,-1721.58 485.523,-1728.4"/>
</g>
<!-- proc~forhar&#45;&gt;proc~setmeshdistr -->
<g id="proc~~siesta_analysis~~CallsGraph_edge77" class="edge"><title>proc~forhar&#45;&gt;proc~setmeshdistr</title>
<path fill="none" stroke="#000000" d="M401.503,-1744.52C414.003,-1741.19 428.867,-1736.17 441,-1729 459.949,-1717.81 458.695,-1707.22 477,-1695 479.146,-1693.57 481.407,-1692.19 483.728,-1690.88"/>
<polygon fill="#000000" stroke="#000000" points="485.612,-1693.84 492.869,-1686.12 482.382,-1687.63 485.612,-1693.84"/>
</g>
<!-- proc~forhar&#45;&gt;mymeshbox -->
<g id="proc~~siesta_analysis~~CallsGraph_edge76" class="edge"><title>proc~forhar&#45;&gt;mymeshbox</title>
<path fill="none" stroke="#000000" d="M401.543,-1746.65C414.651,-1743.82 430.041,-1738.6 441,-1729 469.115,-1704.37 450.28,-1679.13 477,-1653 478.274,-1651.75 479.634,-1650.57 481.06,-1649.46"/>
<polygon fill="#000000" stroke="#000000" points="483.339,-1652.15 489.795,-1643.75 479.509,-1646.29 483.339,-1652.15"/>
</g>
<!-- proc~forhar&#45;&gt;interface~distmeshdata -->
<g id="proc~~siesta_analysis~~CallsGraph_edge79" class="edge"><title>proc~forhar&#45;&gt;interface~distmeshdata</title>
<path fill="none" stroke="#000000" d="M401.707,-1751.41C422.107,-1752.51 450.986,-1754.07 475.558,-1755.39"/>
<polygon fill="#000000" stroke="#000000" points="475.614,-1758.9 485.788,-1755.94 475.991,-1751.91 475.614,-1758.9"/>
</g>
<!-- pxfflush -->
<g id="proc~~siesta_analysis~~CallsGraph_node81" class="node"><title>pxfflush</title>
<polygon fill="#777777" stroke="#777777" points="928.5,-972 874.5,-972 874.5,-948 928.5,-948 928.5,-972"/>
<text text-anchor="middle" x="901.5" y="-957.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pxfflush</text>
</g>
<!-- proc~bye&#45;&gt;pxfflush -->
<g id="proc~~siesta_analysis~~CallsGraph_edge83" class="edge"><title>proc~bye&#45;&gt;pxfflush</title>
<path fill="none" stroke="#000000" d="M810.498,-909.147C827.466,-918.734 851.345,-932.226 870.243,-942.904"/>
<polygon fill="#000000" stroke="#000000" points="868.64,-946.018 879.068,-947.89 872.083,-939.924 868.64,-946.018"/>
</g>
<!-- cmlfinishfile -->
<g id="proc~~siesta_analysis~~CallsGraph_node87" class="node"><title>cmlfinishfile</title>
<polygon fill="#777777" stroke="#777777" points="935,-930 868,-930 868,-906 935,-906 935,-930"/>
<text text-anchor="middle" x="901.5" y="-915.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cmlfinishfile</text>
</g>
<!-- proc~bye&#45;&gt;cmlfinishfile -->
<g id="proc~~siesta_analysis~~CallsGraph_edge85" class="edge"><title>proc~bye&#45;&gt;cmlfinishfile</title>
<path fill="none" stroke="#000000" d="M815.142,-901.924C827.78,-904.304 843.278,-907.223 857.583,-909.917"/>
<polygon fill="#000000" stroke="#000000" points="857.257,-913.417 867.732,-911.828 858.552,-906.538 857.257,-913.417"/>
</g>
<!-- mpi_finalize -->
<g id="proc~~siesta_analysis~~CallsGraph_node91" class="node"><title>mpi_finalize</title>
<polygon fill="#777777" stroke="#777777" points="936,-888 867,-888 867,-864 936,-864 936,-888"/>
<text text-anchor="middle" x="901.5" y="-873.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_finalize</text>
</g>
<!-- proc~bye&#45;&gt;mpi_finalize -->
<g id="proc~~siesta_analysis~~CallsGraph_edge84" class="edge"><title>proc~bye&#45;&gt;mpi_finalize</title>
<path fill="none" stroke="#000000" d="M815.142,-892.076C827.573,-889.735 842.77,-886.873 856.879,-884.216"/>
<polygon fill="#000000" stroke="#000000" points="857.725,-887.618 866.905,-882.327 856.43,-880.739 857.725,-887.618"/>
</g>
<!-- io_close -->
<g id="proc~~siesta_analysis~~CallsGraph_node79" class="node"><title>io_close</title>
<polygon fill="#777777" stroke="#777777" points="928.5,-1282 874.5,-1282 874.5,-1258 928.5,-1258 928.5,-1282"/>
<text text-anchor="middle" x="901.5" y="-1267.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">io_close</text>
</g>
<!-- proc~die&#45;&gt;io_close -->
<g id="proc~~siesta_analysis~~CallsGraph_edge86" class="edge"><title>proc~die&#45;&gt;io_close</title>
<path fill="none" stroke="#000000" d="M795.37,-1014.01C804.094,-1030.75 819.937,-1062.15 831,-1090 850.304,-1138.59 847.394,-1153.53 867,-1202 873.449,-1217.94 882.044,-1235.33 888.913,-1248.53"/>
<polygon fill="#000000" stroke="#000000" points="886,-1250.51 893.766,-1257.72 892.19,-1247.24 886,-1250.51"/>
</g>
<!-- io_assign -->
<g id="proc~~siesta_analysis~~CallsGraph_node80" class="node"><title>io_assign</title>
<polygon fill="#777777" stroke="#777777" points="930.5,-1193 872.5,-1193 872.5,-1169 930.5,-1169 930.5,-1193"/>
<text text-anchor="middle" x="901.5" y="-1178.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">io_assign</text>
</g>
<!-- proc~die&#45;&gt;io_assign -->
<g id="proc~~siesta_analysis~~CallsGraph_edge88" class="edge"><title>proc~die&#45;&gt;io_assign</title>
<path fill="none" stroke="#000000" d="M796.489,-1014.02C815.124,-1043.94 863.771,-1122.04 887.333,-1159.86"/>
<polygon fill="#000000" stroke="#000000" points="884.491,-1161.92 892.749,-1168.56 890.432,-1158.22 884.491,-1161.92"/>
</g>
<!-- proc~die&#45;&gt;pxfflush -->
<g id="proc~~siesta_analysis~~CallsGraph_edge91" class="edge"><title>proc~die&#45;&gt;pxfflush</title>
<path fill="none" stroke="#000000" d="M815.142,-992.153C829.854,-986.611 848.441,-979.61 864.512,-973.556"/>
<polygon fill="#000000" stroke="#000000" points="866.011,-976.731 874.136,-969.931 863.544,-970.181 866.011,-976.731"/>
</g>
<!-- proc~die&#45;&gt;cmlfinishfile -->
<g id="proc~~siesta_analysis~~CallsGraph_edge87" class="edge"><title>proc~die&#45;&gt;cmlfinishfile</title>
<path fill="none" stroke="#000000" d="M802.976,-989.862C818.285,-976.772 843.76,-955.58 867,-939 868.593,-937.864 870.246,-936.72 871.926,-935.585"/>
<polygon fill="#000000" stroke="#000000" points="873.942,-938.449 880.403,-930.053 870.116,-932.587 873.942,-938.449"/>
</g>
<!-- mpi_abort -->
<g id="proc~~siesta_analysis~~CallsGraph_node92" class="node"><title>mpi_abort</title>
<polygon fill="#777777" stroke="#777777" points="932,-1014 871,-1014 871,-990 932,-990 932,-1014"/>
<text text-anchor="middle" x="901.5" y="-999.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_abort</text>
</g>
<!-- proc~die&#45;&gt;mpi_abort -->
<g id="proc~~siesta_analysis~~CallsGraph_edge90" class="edge"><title>proc~die&#45;&gt;mpi_abort</title>
<path fill="none" stroke="#000000" d="M815.142,-1002C828.739,-1002 845.647,-1002 860.819,-1002"/>
<polygon fill="#000000" stroke="#000000" points="860.984,-1005.5 870.984,-1002 860.984,-998.5 860.984,-1005.5"/>
</g>
<!-- pxfabort -->
<g id="proc~~siesta_analysis~~CallsGraph_node93" class="node"><title>pxfabort</title>
<polygon fill="#777777" stroke="#777777" points="928.5,-1056 874.5,-1056 874.5,-1032 928.5,-1032 928.5,-1056"/>
<text text-anchor="middle" x="901.5" y="-1041.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pxfabort</text>
</g>
<!-- proc~die&#45;&gt;pxfabort -->
<g id="proc~~siesta_analysis~~CallsGraph_edge89" class="edge"><title>proc~die&#45;&gt;pxfabort</title>
<path fill="none" stroke="#000000" d="M815.142,-1011.85C829.854,-1017.39 848.441,-1024.39 864.512,-1030.44"/>
<polygon fill="#000000" stroke="#000000" points="863.544,-1033.82 874.136,-1034.07 866.011,-1027.27 863.544,-1033.82"/>
</g>
<!-- proc~reord&#45;&gt;re_alloc -->
<g id="proc~~siesta_analysis~~CallsGraph_edge92" class="edge"><title>proc~reord&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M806.422,-1850.19C824.751,-1863.01 853.792,-1883.33 874.762,-1898"/>
<polygon fill="#000000" stroke="#000000" points="873,-1901.03 883.2,-1903.9 877.013,-1895.3 873,-1901.03"/>
</g>
<!-- proc~reord&#45;&gt;de_alloc -->
<g id="proc~~siesta_analysis~~CallsGraph_edge93" class="edge"><title>proc~reord&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M815.142,-1842.22C829.715,-1844.57 848.091,-1847.54 864.056,-1850.12"/>
<polygon fill="#000000" stroke="#000000" points="863.706,-1853.61 874.136,-1851.74 864.821,-1846.69 863.706,-1853.61"/>
</g>
<!-- proc~reord&#45;&gt;timer -->
<g id="proc~~siesta_analysis~~CallsGraph_edge94" class="edge"><title>proc~reord&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M815.032,-1828.71C820.86,-1825.68 826.608,-1821.82 831,-1817 872.907,-1770.99 890.653,-1696.89 897.191,-1660.14"/>
<polygon fill="#000000" stroke="#000000" points="900.688,-1660.45 898.874,-1650.01 893.783,-1659.3 900.688,-1660.45"/>
</g>
<!-- proc~distmeshdata_rea -->
<g id="proc~~siesta_analysis~~CallsGraph_node86" class="node"><title>proc~distmeshdata_rea</title>
<g id="a_proc~~siesta_analysis~~CallsGraph_node86"><a xlink:href=".././proc/distmeshdata_rea.html" xlink:title="distMeshData_rea">
<polygon fill="#d9534f" stroke="#d9534f" points="709,-1708 609,-1708 609,-1684 709,-1684 709,-1708"/>
<text text-anchor="middle" x="659" y="-1693.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">distMeshData_rea</text>
</a>
</g>
</g>
<!-- interface~distmeshdata&#45;&gt;proc~distmeshdata_rea -->
<g id="proc~~siesta_analysis~~CallsGraph_edge95" class="edge"><title>interface~distmeshdata&#45;&gt;proc~distmeshdata_rea</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M553.399,-1745.92C559.845,-1743.03 566.678,-1739.94 573,-1737 589.982,-1729.11 608.741,-1720.1 624.306,-1712.53"/>
<polygon fill="#000000" stroke="#000000" points="626.084,-1715.56 633.541,-1708.03 623.018,-1709.27 626.084,-1715.56"/>
</g>
<!-- proc~distmeshdata_int -->
<g id="proc~~siesta_analysis~~CallsGraph_node95" class="node"><title>proc~distmeshdata_int</title>
<g id="a_proc~~siesta_analysis~~CallsGraph_node95"><a xlink:href=".././proc/distmeshdata_int.html" xlink:title="distMeshData_int">
<polygon fill="#d9534f" stroke="#d9534f" points="706.5,-1808 611.5,-1808 611.5,-1784 706.5,-1784 706.5,-1808"/>
<text text-anchor="middle" x="659" y="-1793.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">distMeshData_int</text>
</a>
</g>
</g>
<!-- interface~distmeshdata&#45;&gt;proc~distmeshdata_int -->
<g id="proc~~siesta_analysis~~CallsGraph_edge96" class="edge"><title>interface~distmeshdata&#45;&gt;proc~distmeshdata_int</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M564.18,-1768.99C577.292,-1772.77 592.197,-1777.06 606.205,-1781.09"/>
<polygon fill="#000000" stroke="#000000" points="605.631,-1784.57 616.209,-1783.97 607.567,-1777.84 605.631,-1784.57"/>
</g>
<!-- proc~rhoofd&#45;&gt;re_alloc -->
<g id="proc~~siesta_analysis~~CallsGraph_edge101" class="edge"><title>proc~rhoofd&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M390.479,-1286.21C404.588,-1298.19 425.773,-1317.46 441,-1337 460.823,-1362.44 449.409,-1383.3 477,-1400 544.349,-1440.75 774.215,-1358.48 831,-1413 905.604,-1484.63 827.341,-1781.49 867,-1877 869.852,-1883.87 874.395,-1890.4 879.227,-1896.08"/>
<polygon fill="#000000" stroke="#000000" points="876.978,-1898.8 886.35,-1903.74 882.104,-1894.03 876.978,-1898.8"/>
</g>
<!-- proc~rhoofd&#45;&gt;de_alloc -->
<g id="proc~~siesta_analysis~~CallsGraph_edge109" class="edge"><title>proc~rhoofd&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M401.508,-1281.36C414.606,-1286.12 429.998,-1293.43 441,-1304 466.51,-1328.52 446.983,-1356.27 477,-1375 610.496,-1458.29 713.569,-1275.27 831,-1380 877.655,-1421.61 857.758,-1597.17 867,-1659 876.482,-1722.43 889.74,-1796.99 896.375,-1833.52"/>
<polygon fill="#000000" stroke="#000000" points="892.973,-1834.37 898.21,-1843.58 899.859,-1833.12 892.973,-1834.37"/>
</g>
<!-- proc~rhoofd&#45;&gt;timer -->
<g id="proc~~siesta_analysis~~CallsGraph_edge104" class="edge"><title>proc~rhoofd&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M401.655,-1269.35C415.122,-1265.69 430.808,-1259.24 441,-1248 479.841,-1205.18 430.808,-1157.77 477,-1123 578.494,-1046.61 778.403,-1162.44 831,-1228 879.772,-1288.8 895.713,-1538.7 899.509,-1615.46"/>
<polygon fill="#000000" stroke="#000000" points="896.033,-1616.04 900,-1625.87 903.025,-1615.71 896.033,-1616.04"/>
</g>
<!-- proc~rhoofd&#45;&gt;proc~die -->
<g id="proc~~siesta_analysis~~CallsGraph_edge112" class="edge"><title>proc~rhoofd&#45;&gt;proc~die</title>
<path fill="none" stroke="#000000" d="M401.72,-1270.13C415.553,-1266.68 431.568,-1260.19 441,-1248 520.199,-1145.62 379.982,-1044.68 477,-959 557.215,-888.157 697.503,-951.779 757.942,-984.891"/>
<polygon fill="#000000" stroke="#000000" points="756.499,-988.094 766.935,-989.918 759.914,-981.984 756.499,-988.094"/>
</g>
<!-- endpht -->
<g id="proc~~siesta_analysis~~CallsGraph_node74" class="node"><title>endpht</title>
<polygon fill="#777777" stroke="#777777" points="552,-1198 498,-1198 498,-1174 552,-1174 552,-1198"/>
<text text-anchor="middle" x="525" y="-1183.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">endpht</text>
</g>
<!-- proc~rhoofd&#45;&gt;endpht -->
<g id="proc~~siesta_analysis~~CallsGraph_edge100" class="edge"><title>proc~rhoofd&#45;&gt;endpht</title>
<path fill="none" stroke="#000000" d="M401.794,-1266.73C414.362,-1262.49 429.2,-1256.32 441,-1248 460.82,-1234.03 457.48,-1221.39 477,-1207 480.48,-1204.43 484.323,-1202.09 488.268,-1199.97"/>
<polygon fill="#000000" stroke="#000000" points="490.082,-1202.98 497.533,-1195.45 487.011,-1196.69 490.082,-1202.98"/>
</g>
<!-- listp2 -->
<g id="proc~~siesta_analysis~~CallsGraph_node75" class="node"><title>listp2</title>
<polygon fill="#777777" stroke="#777777" points="552,-1156 498,-1156 498,-1132 552,-1132 552,-1156"/>
<text text-anchor="middle" x="525" y="-1141.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">listp2</text>
</g>
<!-- proc~rhoofd&#45;&gt;listp2 -->
<g id="proc~~siesta_analysis~~CallsGraph_edge102" class="edge"><title>proc~rhoofd&#45;&gt;listp2</title>
<path fill="none" stroke="#000000" d="M401.741,-1268.62C414.903,-1264.78 430.281,-1258.39 441,-1248 469.875,-1220.02 448.724,-1193.59 477,-1165 480.433,-1161.53 484.541,-1158.58 488.879,-1156.1"/>
<polygon fill="#000000" stroke="#000000" points="490.545,-1159.18 497.966,-1151.62 487.449,-1152.9 490.545,-1159.18"/>
</g>
<!-- needdscfl -->
<g id="proc~~siesta_analysis~~CallsGraph_node76" class="node"><title>needdscfl</title>
<polygon fill="#777777" stroke="#777777" points="554,-1076 496,-1076 496,-1052 554,-1052 554,-1076"/>
<text text-anchor="middle" x="525" y="-1061.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">needdscfl</text>
</g>
<!-- proc~rhoofd&#45;&gt;needdscfl -->
<g id="proc~~siesta_analysis~~CallsGraph_edge103" class="edge"><title>proc~rhoofd&#45;&gt;needdscfl</title>
<path fill="none" stroke="#000000" d="M401.584,-1269.67C415.199,-1266.08 431.049,-1259.61 441,-1248 487.863,-1193.31 433.714,-1147.56 477,-1090 479.786,-1086.29 483.263,-1083.05 487.057,-1080.22"/>
<polygon fill="#000000" stroke="#000000" points="489.178,-1083.02 495.725,-1074.69 485.412,-1077.12 489.178,-1083.02"/>
</g>
<!-- numdl -->
<g id="proc~~siesta_analysis~~CallsGraph_node77" class="node"><title>numdl</title>
<polygon fill="#777777" stroke="#777777" points="552,-1034 498,-1034 498,-1010 552,-1010 552,-1034"/>
<text text-anchor="middle" x="525" y="-1019.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">numdl</text>
</g>
<!-- proc~rhoofd&#45;&gt;numdl -->
<g id="proc~~siesta_analysis~~CallsGraph_edge110" class="edge"><title>proc~rhoofd&#45;&gt;numdl</title>
<path fill="none" stroke="#000000" d="M401.815,-1269.86C415.501,-1266.34 431.344,-1259.86 441,-1248 499.41,-1176.27 420.121,-1115.95 477,-1043 480.067,-1039.07 484.031,-1035.85 488.354,-1033.22"/>
<polygon fill="#000000" stroke="#000000" points="490.18,-1036.22 497.562,-1028.63 487.052,-1029.96 490.18,-1036.22"/>
</g>
<!-- phi -->
<g id="proc~~siesta_analysis~~CallsGraph_node83" class="node"><title>phi</title>
<polygon fill="#777777" stroke="#777777" points="552,-992 498,-992 498,-968 552,-968 552,-992"/>
<text text-anchor="middle" x="525" y="-977.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">phi</text>
</g>
<!-- proc~rhoofd&#45;&gt;phi -->
<g id="proc~~siesta_analysis~~CallsGraph_edge97" class="edge"><title>proc~rhoofd&#45;&gt;phi</title>
<path fill="none" stroke="#000000" d="M401.623,-1270.05C415.425,-1266.58 431.441,-1260.09 441,-1248 509.789,-1160.96 410.068,-1089.47 477,-1001 480.154,-996.83 484.321,-993.47 488.874,-990.766"/>
<polygon fill="#000000" stroke="#000000" points="490.489,-993.872 497.937,-986.337 487.416,-987.583 490.489,-993.872"/>
</g>
<!-- indxuo -->
<g id="proc~~siesta_analysis~~CallsGraph_node84" class="node"><title>indxuo</title>
<polygon fill="#777777" stroke="#777777" points="552,-870 498,-870 498,-846 552,-846 552,-870"/>
<text text-anchor="middle" x="525" y="-855.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">indxuo</text>
</g>
<!-- proc~rhoofd&#45;&gt;indxuo -->
<g id="proc~~siesta_analysis~~CallsGraph_edge98" class="edge"><title>proc~rhoofd&#45;&gt;indxuo</title>
<path fill="none" stroke="#000000" d="M401.517,-1270.31C415.464,-1266.91 431.657,-1260.42 441,-1248 540.076,-1116.33 380.732,-1012.73 477,-879 480.054,-874.757 484.167,-871.356 488.695,-868.635"/>
<polygon fill="#000000" stroke="#000000" points="490.309,-871.742 497.745,-864.195 487.226,-865.457 490.309,-871.742"/>
</g>
<!-- listsc -->
<g id="proc~~siesta_analysis~~CallsGraph_node85" class="node"><title>listsc</title>
<polygon fill="#777777" stroke="#777777" points="552,-828 498,-828 498,-804 552,-804 552,-828"/>
<text text-anchor="middle" x="525" y="-813.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">listsc</text>
</g>
<!-- proc~rhoofd&#45;&gt;listsc -->
<g id="proc~~siesta_analysis~~CallsGraph_edge99" class="edge"><title>proc~rhoofd&#45;&gt;listsc</title>
<path fill="none" stroke="#000000" d="M401.564,-1270.34C415.526,-1266.96 431.719,-1260.46 441,-1248 495.763,-1174.47 423.805,-911.673 477,-837 480.033,-832.742 484.135,-829.333 488.658,-826.608"/>
<polygon fill="#000000" stroke="#000000" points="490.271,-829.715 497.705,-822.167 487.186,-823.432 490.271,-829.715"/>
</g>
<!-- listdlptr -->
<g id="proc~~siesta_analysis~~CallsGraph_node88" class="node"><title>listdlptr</title>
<polygon fill="#777777" stroke="#777777" points="552,-786 498,-786 498,-762 552,-762 552,-786"/>
<text text-anchor="middle" x="525" y="-771.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">listdlptr</text>
</g>
<!-- proc~rhoofd&#45;&gt;listdlptr -->
<g id="proc~~siesta_analysis~~CallsGraph_edge105" class="edge"><title>proc~rhoofd&#45;&gt;listdlptr</title>
<path fill="none" stroke="#000000" d="M401.602,-1270.37C415.577,-1267 431.769,-1260.5 441,-1248 500.992,-1166.77 418.74,-877.484 477,-795 480.016,-790.73 484.108,-787.314 488.627,-784.586"/>
<polygon fill="#000000" stroke="#000000" points="490.239,-787.694 497.672,-780.143 487.153,-781.411 490.239,-787.694"/>
</g>
<!-- lstpht -->
<g id="proc~~siesta_analysis~~CallsGraph_node89" class="node"><title>lstpht</title>
<polygon fill="#777777" stroke="#777777" points="552,-744 498,-744 498,-720 552,-720 552,-744"/>
<text text-anchor="middle" x="525" y="-729.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lstpht</text>
</g>
<!-- proc~rhoofd&#45;&gt;lstpht -->
<g id="proc~~siesta_analysis~~CallsGraph_edge107" class="edge"><title>proc~rhoofd&#45;&gt;lstpht</title>
<path fill="none" stroke="#000000" d="M401.634,-1270.39C415.619,-1267.03 431.811,-1260.53 441,-1248 506.223,-1159.06 413.674,-843.298 477,-753 480.002,-748.719 484.086,-745.299 488.601,-742.568"/>
<polygon fill="#000000" stroke="#000000" points="490.213,-745.676 497.644,-738.124 487.126,-739.394 490.213,-745.676"/>
</g>
<!-- globaltolocalorb -->
<g id="proc~~siesta_analysis~~CallsGraph_node90" class="node"><title>globaltolocalorb</title>
<polygon fill="#777777" stroke="#777777" points="569,-1366 481,-1366 481,-1342 569,-1342 569,-1366"/>
<text text-anchor="middle" x="525" y="-1351.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">globaltolocalorb</text>
</g>
<!-- proc~rhoofd&#45;&gt;globaltolocalorb -->
<g id="proc~~siesta_analysis~~CallsGraph_edge108" class="edge"><title>proc~rhoofd&#45;&gt;globaltolocalorb</title>
<path fill="none" stroke="#000000" d="M401.77,-1284.26C414.054,-1289.49 428.66,-1296.37 441,-1304 458.475,-1314.81 459.475,-1322.28 477,-1333 479.43,-1334.49 481.983,-1335.93 484.592,-1337.31"/>
<polygon fill="#000000" stroke="#000000" points="483.062,-1340.46 493.574,-1341.79 486.184,-1334.2 483.062,-1340.46"/>
</g>
<!-- matrixotom -->
<g id="proc~~siesta_analysis~~CallsGraph_node94" class="node"><title>matrixotom</title>
<polygon fill="#777777" stroke="#777777" points="558,-1324 492,-1324 492,-1300 558,-1300 558,-1324"/>
<text text-anchor="middle" x="525" y="-1309.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">matrixotom</text>
</g>
<!-- proc~rhoofd&#45;&gt;matrixotom -->
<g id="proc~~siesta_analysis~~CallsGraph_edge106" class="edge"><title>proc~rhoofd&#45;&gt;matrixotom</title>
<path fill="none" stroke="#000000" d="M401.707,-1280.71C423.906,-1286.39 456.146,-1294.64 481.95,-1301.24"/>
<polygon fill="#000000" stroke="#000000" points="481.292,-1304.68 491.848,-1303.77 483.028,-1297.9 481.292,-1304.68"/>
</g>
<!-- proc~rcut -->
<g id="proc~~siesta_analysis~~CallsGraph_node96" class="node"><title>proc~rcut</title>
<g id="a_proc~~siesta_analysis~~CallsGraph_node96"><a xlink:href=".././proc/rcut.html" xlink:title="rcut">
<polygon fill="#d94e8f" stroke="#d94e8f" points="552,-912 498,-912 498,-888 552,-888 552,-912"/>
<text text-anchor="middle" x="525" y="-897.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rcut</text>
</a>
</g>
</g>
<!-- proc~rhoofd&#45;&gt;proc~rcut -->
<g id="proc~~siesta_analysis~~CallsGraph_edge111" class="edge"><title>proc~rhoofd&#45;&gt;proc~rcut</title>
<path fill="none" stroke="#000000" d="M401.78,-1270.17C415.631,-1266.74 431.645,-1260.25 441,-1248 528.393,-1133.55 397.071,-1045.78 477,-926 480.106,-921.346 484.337,-917.445 488.996,-914.2"/>
<polygon fill="#000000" stroke="#000000" points="490.875,-917.156 497.694,-909.047 487.307,-911.133 490.875,-917.156"/>
</g>
<!-- dscfl -->
<g id="proc~~siesta_analysis~~CallsGraph_node97" class="node"><title>dscfl</title>
<polygon fill="#777777" stroke="#777777" points="552,-1282 498,-1282 498,-1258 552,-1258 552,-1282"/>
<text text-anchor="middle" x="525" y="-1267.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dscfl</text>
</g>
<!-- proc~rhoofd&#45;&gt;dscfl -->
<g id="proc~~siesta_analysis~~CallsGraph_edge113" class="edge"><title>proc~rhoofd&#45;&gt;dscfl</title>
<path fill="none" stroke="#000000" d="M401.707,-1273.29C425.523,-1272.65 460.896,-1271.7 487.481,-1270.98"/>
<polygon fill="#000000" stroke="#000000" points="487.653,-1274.48 497.555,-1270.71 487.465,-1267.48 487.653,-1274.48"/>
</g>
<!-- listdl -->
<g id="proc~~siesta_analysis~~CallsGraph_node98" class="node"><title>listdl</title>
<polygon fill="#777777" stroke="#777777" points="552,-1240 498,-1240 498,-1216 552,-1216 552,-1240"/>
<text text-anchor="middle" x="525" y="-1225.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">listdl</text>
</g>
<!-- proc~rhoofd&#45;&gt;listdl -->
<g id="proc~~siesta_analysis~~CallsGraph_edge114" class="edge"><title>proc~rhoofd&#45;&gt;listdl</title>
<path fill="none" stroke="#000000" d="M401.707,-1265.88C425.629,-1258.47 461.21,-1247.45 487.833,-1239.2"/>
<polygon fill="#000000" stroke="#000000" points="489.039,-1242.49 497.555,-1236.19 486.968,-1235.81 489.039,-1242.49"/>
</g>
<!-- proc~write_rho&#45;&gt;de_alloc -->
<g id="proc~~siesta_analysis~~CallsGraph_edge119" class="edge"><title>proc~write_rho&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M687.627,-1494.56C730.794,-1500.69 811.341,-1514.57 831,-1535 852.018,-1556.85 886.077,-1763.91 897.006,-1833.39"/>
<polygon fill="#000000" stroke="#000000" points="893.609,-1834.32 898.61,-1843.66 900.525,-1833.24 893.609,-1834.32"/>
</g>
<!-- proc~write_rho&#45;&gt;mpi_barrier -->
<g id="proc~~siesta_analysis~~CallsGraph_edge118" class="edge"><title>proc~write_rho&#45;&gt;mpi_barrier</title>
<path fill="none" stroke="#000000" d="M669.692,-1503.08C684.486,-1520.94 714.241,-1554.69 745,-1577 746.823,-1578.32 748.742,-1579.6 750.714,-1580.84"/>
<polygon fill="#000000" stroke="#000000" points="749.161,-1583.98 759.577,-1585.92 752.646,-1577.91 749.161,-1583.98"/>
</g>
<!-- proc~write_rho&#45;&gt;write_debug -->
<g id="proc~~siesta_analysis~~CallsGraph_edge120" class="edge"><title>proc~write_rho&#45;&gt;write_debug</title>
<path fill="none" stroke="#000000" d="M683.59,-1503.07C703.55,-1513.29 732.357,-1528.03 754.5,-1539.37"/>
<polygon fill="#000000" stroke="#000000" points="753.04,-1542.55 763.536,-1543.99 756.229,-1536.32 753.04,-1542.55"/>
</g>
<!-- mpi_wait -->
<g id="proc~~siesta_analysis~~CallsGraph_node78" class="node"><title>mpi_wait</title>
<polygon fill="#777777" stroke="#777777" points="815.5,-1446 760.5,-1446 760.5,-1422 815.5,-1422 815.5,-1446"/>
<text text-anchor="middle" x="788" y="-1431.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_wait</text>
</g>
<!-- proc~write_rho&#45;&gt;mpi_wait -->
<g id="proc~~siesta_analysis~~CallsGraph_edge117" class="edge"><title>proc~write_rho&#45;&gt;mpi_wait</title>
<path fill="none" stroke="#000000" d="M686.933,-1478.91C705.539,-1470.56 730.498,-1459.36 750.835,-1450.23"/>
<polygon fill="#000000" stroke="#000000" points="752.415,-1453.36 760.105,-1446.07 749.549,-1446.97 752.415,-1453.36"/>
</g>
<!-- proc~write_rho&#45;&gt;io_close -->
<g id="proc~~siesta_analysis~~CallsGraph_edge115" class="edge"><title>proc~write_rho&#45;&gt;io_close</title>
<path fill="none" stroke="#000000" d="M673.273,-1478.8C713.021,-1442.28 831.326,-1333.57 879.619,-1289.19"/>
<polygon fill="#000000" stroke="#000000" points="882.273,-1291.5 887.268,-1282.16 877.537,-1286.35 882.273,-1291.5"/>
</g>
<!-- proc~write_rho&#45;&gt;io_assign -->
<g id="proc~~siesta_analysis~~CallsGraph_edge116" class="edge"><title>proc~write_rho&#45;&gt;io_assign</title>
<path fill="none" stroke="#000000" d="M664.987,-1478.59C676.555,-1450.64 707.136,-1381.24 745,-1331 784.999,-1277.93 844.111,-1226.47 876.724,-1199.81"/>
<polygon fill="#000000" stroke="#000000" points="879.228,-1202.29 884.8,-1193.28 874.825,-1196.85 879.228,-1202.29"/>
</g>
<!-- mpi_irecv -->
<g id="proc~~siesta_analysis~~CallsGraph_node82" class="node"><title>mpi_irecv</title>
<polygon fill="#777777" stroke="#777777" points="817,-1488 759,-1488 759,-1464 817,-1464 817,-1488"/>
<text text-anchor="middle" x="788" y="-1473.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_irecv</text>
</g>
<!-- proc~write_rho&#45;&gt;mpi_irecv -->
<g id="proc~~siesta_analysis~~CallsGraph_edge121" class="edge"><title>proc~write_rho&#45;&gt;mpi_irecv</title>
<path fill="none" stroke="#000000" d="M687.557,-1487.75C705.367,-1485.64 728.801,-1482.87 748.447,-1480.55"/>
<polygon fill="#000000" stroke="#000000" points="749.097,-1484 758.617,-1479.35 748.276,-1477.05 749.097,-1484"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;re_alloc -->
<g id="proc~~siesta_analysis~~CallsGraph_edge125" class="edge"><title>proc~distmeshdata_rea&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M684.447,-1708.06C701.378,-1716.34 724.474,-1727.52 745,-1737 782.935,-1754.52 802.608,-1744.34 831,-1775 863.664,-1810.27 842.926,-1835.39 867,-1877 870.933,-1883.8 876.121,-1890.53 881.236,-1896.44"/>
<polygon fill="#000000" stroke="#000000" points="878.721,-1898.88 888.041,-1903.92 883.898,-1894.17 878.721,-1898.88"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;de_alloc -->
<g id="proc~~siesta_analysis~~CallsGraph_edge128" class="edge"><title>proc~distmeshdata_rea&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M700.536,-1683.93C737.621,-1675.46 792.426,-1669.64 831,-1695 878.49,-1726.23 893.676,-1797.53 898.418,-1833.85"/>
<polygon fill="#000000" stroke="#000000" points="894.957,-1834.38 899.579,-1843.92 901.911,-1833.58 894.957,-1834.38"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;timer -->
<g id="proc~~siesta_analysis~~CallsGraph_edge126" class="edge"><title>proc~distmeshdata_rea&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M685.889,-1683.86C702.463,-1676.53 724.609,-1667.57 745,-1662 785.008,-1651.06 832.259,-1644.66 864.088,-1641.26"/>
<polygon fill="#000000" stroke="#000000" points="864.666,-1644.71 874.258,-1640.21 863.953,-1637.75 864.666,-1644.71"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;mpi_barrier -->
<g id="proc~~siesta_analysis~~CallsGraph_edge127" class="edge"><title>proc~distmeshdata_rea&#45;&gt;mpi_barrier</title>
<path fill="none" stroke="#000000" d="M673.042,-1683.89C689.311,-1669.04 718.25,-1643.44 745,-1624 748.954,-1621.13 753.229,-1618.24 757.487,-1615.5"/>
<polygon fill="#000000" stroke="#000000" points="759.48,-1618.38 766.093,-1610.1 755.761,-1612.45 759.48,-1618.38"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;proc~die -->
<g id="proc~~siesta_analysis~~CallsGraph_edge130" class="edge"><title>proc~distmeshdata_rea&#45;&gt;proc~die</title>
<path fill="none" stroke="#000000" d="M663.798,-1683.62C672.729,-1654.14 695.34,-1577.36 709,-1512 748.046,-1325.16 776.135,-1095.99 784.452,-1024.43"/>
<polygon fill="#000000" stroke="#000000" points="787.948,-1024.66 785.616,-1014.32 780.994,-1023.86 787.948,-1024.66"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;proc~reord -->
<g id="proc~~siesta_analysis~~CallsGraph_edge124" class="edge"><title>proc~distmeshdata_rea&#45;&gt;proc~reord</title>
<path fill="none" stroke="#000000" d="M667.377,-1708.02C684.2,-1735.17 725.451,-1800.16 745,-1817 747.201,-1818.9 749.602,-1820.67 752.106,-1822.32"/>
<polygon fill="#000000" stroke="#000000" points="750.471,-1825.42 760.87,-1827.45 754.008,-1819.38 750.471,-1825.42"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;write_debug -->
<g id="proc~~siesta_analysis~~CallsGraph_edge129" class="edge"><title>proc~distmeshdata_rea&#45;&gt;write_debug</title>
<path fill="none" stroke="#000000" d="M666.141,-1683.71C678.353,-1660.3 707.747,-1608.83 745,-1577 746.321,-1575.87 747.713,-1574.78 749.155,-1573.74"/>
<polygon fill="#000000" stroke="#000000" points="751.25,-1576.56 757.818,-1568.24 747.499,-1570.65 751.25,-1576.56"/>
</g>
<!-- mpitrace_event -->
<g id="proc~~siesta_analysis~~CallsGraph_node99" class="node"><title>mpitrace_event</title>
<polygon fill="#777777" stroke="#777777" points="831,-1728 745,-1728 745,-1704 831,-1704 831,-1728"/>
<text text-anchor="middle" x="788" y="-1713.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpitrace_event</text>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;mpitrace_event -->
<g id="proc~~siesta_analysis~~CallsGraph_edge122" class="edge"><title>proc~distmeshdata_rea&#45;&gt;mpitrace_event</title>
<path fill="none" stroke="#000000" d="M709.102,-1703.73C717.438,-1705.05 726.125,-1706.41 734.544,-1707.74"/>
<polygon fill="#000000" stroke="#000000" points="734.216,-1711.23 744.639,-1709.33 735.305,-1704.32 734.216,-1711.23"/>
</g>
<!-- proc~boxintersection -->
<g id="proc~~siesta_analysis~~CallsGraph_node100" class="node"><title>proc~boxintersection</title>
<g id="a_proc~~siesta_analysis~~CallsGraph_node100"><a xlink:href=".././proc/boxintersection.html" xlink:title="boxIntersection">
<polygon fill="#d9534f" stroke="#d9534f" points="830.5,-1808 745.5,-1808 745.5,-1784 830.5,-1784 830.5,-1808"/>
<text text-anchor="middle" x="788" y="-1793.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">boxIntersection</text>
</a>
</g>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;proc~boxintersection -->
<g id="proc~~siesta_analysis~~CallsGraph_edge123" class="edge"><title>proc~distmeshdata_rea&#45;&gt;proc~boxintersection</title>
<path fill="none" stroke="#000000" d="M672.7,-1708.22C688.854,-1723.49 717.913,-1750.03 745,-1770 748.934,-1772.9 753.199,-1775.8 757.452,-1778.55"/>
<polygon fill="#000000" stroke="#000000" points="755.724,-1781.6 766.054,-1783.95 759.446,-1775.67 755.724,-1781.6"/>
</g>
<!-- proc~distmeshdata_int&#45;&gt;re_alloc -->
<g id="proc~~siesta_analysis~~CallsGraph_edge131" class="edge"><title>proc~distmeshdata_int&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M669.291,-1808.2C683.574,-1826.08 712.683,-1859.2 745,-1877 782.616,-1897.72 831.379,-1907.63 864.186,-1912.24"/>
<polygon fill="#000000" stroke="#000000" points="863.873,-1915.73 874.242,-1913.55 864.781,-1908.78 863.873,-1915.73"/>
</g>
<!-- proc~distmeshdata_int&#45;&gt;de_alloc -->
<g id="proc~~siesta_analysis~~CallsGraph_edge133" class="edge"><title>proc~distmeshdata_int&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M671.235,-1808.17C686.29,-1823.48 714.651,-1848.98 745,-1859 784.161,-1871.93 831.945,-1868.36 864.122,-1863.38"/>
<polygon fill="#000000" stroke="#000000" points="865.117,-1866.76 874.401,-1861.66 863.961,-1859.86 865.117,-1866.76"/>
</g>
<!-- proc~distmeshdata_int&#45;&gt;proc~die -->
<g id="proc~~siesta_analysis~~CallsGraph_edge134" class="edge"><title>proc~distmeshdata_int&#45;&gt;proc~die</title>
<path fill="none" stroke="#000000" d="M670.052,-1783.76C681.604,-1768.96 700.112,-1742.79 709,-1717 714.814,-1700.13 772.454,-1143.13 784.714,-1024.2"/>
<polygon fill="#000000" stroke="#000000" points="788.213,-1024.4 785.756,-1014.09 781.249,-1023.68 788.213,-1024.4"/>
</g>
<!-- proc~distmeshdata_int&#45;&gt;proc~boxintersection -->
<g id="proc~~siesta_analysis~~CallsGraph_edge132" class="edge"><title>proc~distmeshdata_int&#45;&gt;proc~boxintersection</title>
<path fill="none" stroke="#000000" d="M706.569,-1796C715.927,-1796 725.814,-1796 735.333,-1796"/>
<polygon fill="#000000" stroke="#000000" points="735.476,-1799.5 745.476,-1796 735.476,-1792.5 735.476,-1799.5"/>
</g>
<!-- proc~chk -->
<g id="proc~~siesta_analysis~~CallsGraph_node101" class="node"><title>proc~chk</title>
<g id="a_proc~~siesta_analysis~~CallsGraph_node101"><a xlink:href=".././proc/chk.html" xlink:title="chk">
<polygon fill="#d9534f" stroke="#d9534f" points="686,-912 632,-912 632,-888 686,-888 686,-912"/>
<text text-anchor="middle" x="659" y="-897.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">chk</text>
</a>
</g>
</g>
<!-- proc~rcut&#45;&gt;proc~chk -->
<g id="proc~~siesta_analysis~~CallsGraph_edge135" class="edge"><title>proc~rcut&#45;&gt;proc~chk</title>
<path fill="none" stroke="#000000" d="M552.079,-900C572.056,-900 599.851,-900 621.955,-900"/>
<polygon fill="#000000" stroke="#000000" points="621.975,-903.5 631.975,-900 621.975,-896.5 621.975,-903.5"/>
</g>
<!-- proc~chk&#45;&gt;proc~die -->
<g id="proc~~siesta_analysis~~CallsGraph_edge136" class="edge"><title>proc~chk&#45;&gt;proc~die</title>
<path fill="none" stroke="#000000" d="M686.003,-912.044C693.681,-916.058 701.919,-920.836 709,-926 731.765,-942.602 754.457,-965.629 769.448,-981.975"/>
<polygon fill="#000000" stroke="#000000" points="767.248,-984.762 776.544,-989.845 772.446,-980.074 767.248,-984.762"/>
</g>
</g>
</svg>
</div><script>var panprocsiesta_analysisCallsGraph = svgPanZoom('#procsiesta_analysisCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,-0 209.5,-0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.5,-24 454.5,-24 454.5,-0 551.5,-0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/siesta_analysis.html#src">siesta_analysis</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>      <span class="k">subroutine </span><span class="n">siesta_analysis</span><span class="p">(</span> <span class="n">relaxd</span> <span class="p">)</span>
      <span class="k">USE </span><span class="n">band</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">nbk</span><span class="p">,</span> <span class="n">bk</span><span class="p">,</span> <span class="n">maxbk</span><span class="p">,</span> <span class="n">bands</span>
      <span class="k">USE </span><span class="n">writewave</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">nwk</span><span class="p">,</span> <span class="n">wfk</span><span class="p">,</span> <span class="n">wwave</span>
      <span class="k">USE </span><span class="n">writewave</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">setup_wfs_list</span><span class="p">,</span> <span class="n">wfs_filename</span>
      <span class="k">USE </span><span class="n">m_ksvinit</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">nkpol</span><span class="p">,</span> <span class="n">kpol</span><span class="p">,</span> <span class="n">wgthpol</span>
      <span class="k">use </span><span class="n">m_ksv</span>
      <span class="k">USE </span><span class="n">m_projected_DOS</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">projected_DOS</span>
      <span class="k">USE </span><span class="n">m_local_DOS</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">local_DOS</span>
<span class="cp">#ifdef SIESTA__PEXSI</span>
      <span class="k">USE </span><span class="n">m_pexsi_local_DOS</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">pexsi_local_DOS</span>
      <span class="k">USE </span><span class="n">m_pexsi_dos</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">pexsi_dos</span>
<span class="cp">#endif      </span>
      <span class="k">USE </span><span class="n">siesta_options</span>
      <span class="k">use </span><span class="n">units</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">Debye</span><span class="p">,</span> <span class="n">eV</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">numh</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">H</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">Dscf</span><span class="p">,</span> <span class="n">xijo</span>
      <span class="k">use </span><span class="n">siesta_geom</span>
      <span class="k">use </span><span class="n">m_dhscf</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">dhscf</span>
      <span class="k">use </span><span class="n">atomlist</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">indxuo</span><span class="p">,</span> <span class="n">iaorb</span><span class="p">,</span> <span class="n">lastkb</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span> <span class="n">datm</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span>
     <span class="p">&amp;</span>                    <span class="n">iphkb</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">iza</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span> <span class="n">rmaxo</span><span class="p">,</span> <span class="n">indxua</span>
      <span class="k">use </span><span class="n">atomlist</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">qtot</span>
      <span class="k">use </span><span class="n">fdf</span>
      <span class="k">use </span><span class="n">writewave</span><span class="p">,</span>    <span class="n">only</span><span class="p">:</span> <span class="n">wwave</span>
      <span class="k">use </span><span class="n">siesta_cml</span>
      <span class="k">use </span><span class="n">files</span><span class="p">,</span>        <span class="n">only</span> <span class="p">:</span> <span class="n">slabel</span>
      <span class="k">use </span><span class="n">files</span><span class="p">,</span>        <span class="n">only</span> <span class="p">:</span> <span class="n">filesOut_t</span>   <span class="c">! derived type for output file names</span>
      <span class="k">use </span><span class="n">zmatrix</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">lUseZmatrix</span><span class="p">,</span> <span class="n">write_zmatrix</span>
      <span class="k">use </span><span class="n">kpoint_scf_m</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">kpoints_scf</span>
      <span class="k">use </span><span class="n">parallel</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">IOnode</span>
      <span class="k">use </span><span class="n">parallel</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">SIESTA_worker</span>
      <span class="k">use </span><span class="n">files</span><span class="p">,</span>       <span class="n">only</span> <span class="p">:</span> <span class="n">label_length</span>
      <span class="k">use </span><span class="n">m_energies</span>
      <span class="k">use </span><span class="n">m_steps</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="k">final</span>
<span class="k">      use </span><span class="n">m_ntm</span>
      <span class="k">use </span><span class="n">m_spin</span><span class="p">,</span>         <span class="n">only</span><span class="p">:</span> <span class="n">nspin</span><span class="p">,</span> <span class="n">spinor_dim</span><span class="p">,</span> <span class="n">h_spin_dim</span>
      <span class="k">use </span><span class="n">m_spin</span><span class="p">,</span>         <span class="n">only</span><span class="p">:</span> <span class="n">SpOrb</span><span class="p">,</span> <span class="n">NonCol</span><span class="p">,</span> <span class="n">SPpol</span><span class="p">,</span> <span class="n">NoMagn</span>
      <span class="k">use </span><span class="n">m_dipol</span>
      <span class="k">use </span><span class="n">m_eo</span>
      <span class="k">use </span><span class="n">m_forces</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">fa</span>
      <span class="k">use </span><span class="n">m_gamma</span> 
      <span class="k">use </span><span class="n">alloc</span><span class="p">,</span>             <span class="n">only</span><span class="p">:</span> <span class="n">re_alloc</span><span class="p">,</span> <span class="n">de_alloc</span>
      <span class="k">use </span><span class="n">basis_enthalpy</span><span class="p">,</span>    <span class="n">only</span><span class="p">:</span> <span class="n">write_basis_enthalpy</span>
      <span class="k">use </span><span class="n">m_partial_charges</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">want_partial_charges</span>
      <span class="k">use </span><span class="n">m_iodm_old</span><span class="p">,</span>        <span class="n">only</span><span class="p">:</span> <span class="n">read_spmatrix</span>
      <span class="k">use </span><span class="n">m_siesta2wannier90</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">siesta2wannier90</span>

      <span class="k">use </span><span class="n">m_mpi_utils</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">barrier</span>
<span class="cp">#ifdef SIESTA__FLOOK</span>
      <span class="k">use </span><span class="n">flook_siesta</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">slua_call</span><span class="p">,</span> <span class="n">LUA_ANALYSIS</span>
<span class="cp">#endif</span>
      
      <span class="k">implicit none</span>

<span class="k">      </span><span class="kt">logical</span> <span class="kd">::</span> <span class="n">relaxd</span><span class="p">,</span> <span class="n">getPSI</span><span class="p">,</span> <span class="n">quenched_MD</span><span class="p">,</span> <span class="n">found</span>

      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">dummy_str</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">dummy_strl</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">qspin</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>         <span class="c">! Local</span>

      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">polxyz</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">nspin</span><span class="p">)</span>  <span class="c">! Autom., small</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">polR</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">nspin</span><span class="p">)</span>    <span class="c">! Autom., small</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">qaux</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">ebk</span><span class="p">(:,:,:)</span>       <span class="c">! Band energies</span>

      <span class="kt">integer</span>           <span class="kd">::</span> <span class="n">j</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">ik</span><span class="p">,</span> <span class="n">io</span><span class="p">,</span> <span class="n">ispin</span>
      <span class="kt">integer</span>           <span class="kd">::</span> <span class="n">wfs_band_min</span><span class="p">,</span> <span class="n">wfs_band_max</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">g2max</span><span class="p">,</span> <span class="n">current_ef</span>
      <span class="k">type</span><span class="p">(</span><span class="n">filesOut_t</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">filesOut</span> <span class="c">! blank output file names</span>

<span class="c">!-----------------------------------------------------------------------BEGIN</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">SIESTA_worker</span><span class="p">)</span> <span class="k">call </span><span class="n">timer</span><span class="p">(</span><span class="s2">&quot;Analysis&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

      <span class="c">!! Check that we are converged in geometry,</span>
      <span class="c">!! if strictly required,</span>
      <span class="c">!! before carrying out any analysis.</span>

      <span class="c">!!@code</span>
      <span class="n">quenched_MD</span> <span class="o">=</span>  <span class="p">(</span> <span class="p">(</span><span class="n">iquench</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>
     <span class="err">$</span>     <span class="p">((</span><span class="n">idyn</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">idyn</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">3</span><span class="p">))</span> <span class="p">)</span>

      <span class="k">if</span> <span class="p">((</span><span class="n">nmove</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">quenched_MD</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         if</span> <span class="p">(</span><span class="n">SIESTA_worker</span><span class="p">)</span> <span class="k">then</span>  <span class="c">! For timing ops and associated barrier</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">GeometryMustConverge</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">relaxd</span><span class="p">))</span> <span class="k">then</span>
<span class="k">            call </span><span class="n">message</span><span class="p">(</span><span class="s2">&quot;FATAL&quot;</span><span class="p">,</span>
     <span class="err">$</span>           <span class="s2">&quot;GEOM_NOT_CONV: Geometry relaxation not converged&quot;</span><span class="p">)</span>
            <span class="k">call </span><span class="n">timer</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">call </span><span class="n">timer</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
            <span class="k">call </span><span class="n">barrier</span><span class="p">()</span>
            <span class="k">call </span><span class="n">die</span><span class="p">(</span><span class="s2">&quot;ABNORMAL_TERMINATION&quot;</span><span class="p">)</span>
          <span class="n">endif</span>
         <span class="n">endif</span>
      <span class="n">endif</span>
      <span class="c">!!@endcode</span>

<span class="c">!     All the comments below assume that this compatibility option</span>
<span class="c">!     is not used.</span>
<span class="c">!     Note also that full compatibility cannot be guaranteed</span>

      <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">compat_pre_v4_dynamics</span><span class="p">)</span> <span class="k">then</span>

<span class="c">!     This is a sanity safeguard: we reset the geometry (which might</span>
<span class="c">!     have been moved by the relaxation or MD routines) to the one used</span>
<span class="c">!     in the last computation of the electronic structure.</span>
<span class="c">!     See the comments below for explanation</span>

<span class="c">!$OMP parallel workshare default(shared)</span>
         <span class="n">xa</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">na_s</span><span class="p">)</span> <span class="o">=</span> <span class="n">xa_last</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">na_s</span><span class="p">)</span>
         <span class="n">ucell</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">ucell_last</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span>
         <span class="n">scell</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">scell_last</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span>
<span class="c">!$OMP end parallel workshare</span>

      <span class="n">endif</span>

      <span class="c">! zmatrix info reset??</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">fdf_get</span><span class="p">(</span><span class="s2">&quot;Read-H-from-file&quot;</span><span class="p">,.</span><span class="n">false</span><span class="p">.))</span> <span class="k">then</span>
<span class="k">         if</span> <span class="p">(</span><span class="n">SIESTA_worker</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            call </span><span class="n">read_spmatrix</span><span class="p">(</span><span class="n">maxnh</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">h_spin_dim</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span>
     <span class="p">.</span>           <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">userfile</span><span class="o">=</span><span class="s2">&quot;H_IN&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">found</span><span class="p">)</span> <span class="k">call </span><span class="n">die</span><span class="p">(</span><span class="s2">&quot;Could not find H_IN&quot;</span><span class="p">)</span>
            <span class="n">current_ef</span> <span class="o">=</span> <span class="n">ef</span>
            <span class="n">ef</span> <span class="o">=</span> <span class="n">fdf_get</span><span class="p">(</span><span class="s2">&quot;Manual-Fermi-Level&quot;</span><span class="p">,</span><span class="n">current_ef</span><span class="p">,</span><span class="s2">&quot;Ry&quot;</span><span class="p">)</span> 
         <span class="n">endif</span>
      <span class="n">endif</span>

<span class="cp">#ifdef SIESTA__PEXSI</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">fdf_get</span><span class="p">(</span><span class="s2">&quot;PEXSI.DOS&quot;</span><span class="p">,.</span><span class="n">false</span><span class="p">.))</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">pexsi_dos</span><span class="p">(</span><span class="n">no_u</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">spinor_dim</span><span class="p">,</span>
     <span class="err">$</span>        <span class="n">maxnh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">qtot</span><span class="p">,</span> <span class="n">ef</span><span class="p">)</span>
         
      <span class="n">endif</span>
<span class="cp">#endif</span>
      <span class="c">! section done by Siesta subset of nodes</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">SIESTA_worker</span><span class="p">)</span> <span class="k">then</span>

<span class="k">      final</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">cml_p</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">cmlStartModule</span><span class="p">(</span><span class="n">xf</span><span class="o">=</span><span class="n">mainXML</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Finalization&#39;</span><span class="p">)</span>
      <span class="n">endif</span>

<span class="cp">#ifdef SIESTA__FLOOK</span>
      <span class="c">! Call lua right before doing the analysis,</span>
      <span class="c">! possibly changing some of the variables</span>
      <span class="k">call </span><span class="n">slua_call</span><span class="p">(</span><span class="n">LUA</span><span class="p">,</span><span class="n">LUA_ANALYSIS</span><span class="p">)</span>
<span class="cp">#endif</span>

<span class="c">!</span>
<span class="c">!     NOTE that the geometry output by the following sections</span>
<span class="c">!     used to be that &quot;predicted&quot; for the next MD or relaxation step.</span>
<span class="c">!     This is now changed</span>

<span class="c">!</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">IOnode</span><span class="p">)</span> <span class="k">then</span>
        <span class="c">! Print atomic coordinates</span>

        <span class="c">! This covers CG and MD-quench (verlet, pr), instances in which </span>
        <span class="c">! &quot;relaxd&quot; is meaningful</span>

        <span class="k">if</span> <span class="p">((</span><span class="n">nmove</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">quenched_MD</span> <span class="p">)</span> <span class="k">then</span>

<span class="k">          if</span> <span class="p">(</span><span class="n">relaxd</span><span class="p">)</span> <span class="k">then</span>  <span class="c">! xa = xa_last</span>
             <span class="c">! The &quot;relaxation&quot; routines do not update</span>
             <span class="c">! the coordinates if relaxed, so this behavior is unchanged</span>
             <span class="k">call </span><span class="n">outcoor</span><span class="p">(</span><span class="n">ucell</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="s1">&#39;Relaxed&#39;</span><span class="p">,</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span> <span class="p">)</span>
          <span class="k">else</span>  
             <span class="c">! Since xa = xa_last now, this will just repeat the</span>
             <span class="c">! last set of coordinates used, not the predicted ones.</span>
             <span class="k">call </span><span class="n">outcoor</span><span class="p">(</span><span class="n">ucell</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="s1">&#39;Final (unrelaxed)&#39;</span><span class="p">,</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span> <span class="p">)</span>
          <span class="n">endif</span>

        <span class="n">endif</span>

        <span class="c">! This call will write xa_last to the .STRUCT_OUT file</span>
        <span class="c">! (again, since it has already been written by state_init),</span>
        <span class="c">! CML records of the latest processed structure, and </span>
        <span class="c">! possibly zmatrix info.  *** unmoved?? how?</span>
        <span class="c">! Note that the .STRUCT_NEXT_ITER file is produced</span>
        <span class="c">! in siesta_move for checkpointing of relaxations and MD runs.</span>

        <span class="c">! If all we want are the CML records (to satisfy some expectation</span>
        <span class="c">! of appearance in the &quot;finalization&quot; section, we might put the</span>
        <span class="c">! cml call explicitly and forget about the rest.</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">compat_pre_v4_dynamics</span><span class="p">)</span> <span class="k">then</span>
<span class="k">           call </span><span class="n">siesta_write_positions</span><span class="p">(</span><span class="n">moved</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>  
        <span class="k">else</span>
<span class="k">           call </span><span class="n">siesta_write_positions</span><span class="p">(</span><span class="n">moved</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.)</span>  
        <span class="n">endif</span>


        
        <span class="c">! ??  Clarify Zmatrix behavior ****</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">lUseZmatrix</span><span class="p">)</span> <span class="k">call </span><span class="n">write_Zmatrix</span>

        <span class="c">! Print unit cell (cell_last) for variable cell and server operation</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">varcel</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">idyn</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">8</span><span class="p">))</span> <span class="k">call </span><span class="n">outcell</span><span class="p">(</span><span class="n">ucell</span><span class="p">)</span>

<span class="c">!------------------------------------------------------------------</span>
        <span class="c">! It can be argued that these needed the xa_last coordinates</span>
        <span class="c">! all along</span>

<span class="c">!       Print coordinates in xmol format in a separate file</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">fdf_boolean</span><span class="p">(</span><span class="s1">&#39;WriteCoorXmol&#39;</span><span class="p">,.</span><span class="n">false</span><span class="p">.))</span> 
     <span class="p">&amp;</span>     <span class="k">call </span><span class="n">coxmol</span><span class="p">(</span><span class="n">iza</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">na_u</span> <span class="p">)</span>

<span class="c">!       Print coordinates in cerius format in a separate file</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">fdf_boolean</span><span class="p">(</span><span class="s1">&#39;WriteCoorCerius&#39;</span><span class="p">,.</span><span class="n">false</span><span class="p">.))</span>
     <span class="p">&amp;</span>     <span class="k">call </span><span class="n">coceri</span><span class="p">(</span><span class="n">iza</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">ucell</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">sname</span> <span class="p">)</span>

<span class="c">!       Find interatomic distances (output in file BONDS_FINAL)</span>
        <span class="k">call </span><span class="n">bonds</span><span class="p">(</span> <span class="n">ucell</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">isa</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span>
     <span class="p">&amp;</span>       <span class="n">rmax_bonds</span><span class="p">,</span> <span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;.BONDS_FINAL&quot;</span> <span class="p">)</span>

      <span class="n">endif</span> <span class="c">! IONode</span>
<span class="c">!--- end output of geometry information</span>
<span class="c">!</span>
<span class="c">!</span>
<span class="c">! NOTE: In the following sections, wavefunction generation, computation</span>
<span class="c">!       of band structure, etc, are carried out using the last Hamiltonian</span>
<span class="c">!       generated in the SCF run for the last geometry considered.</span>

<span class="c">!   But, if xa /= xa_last, the computation of, say, bands, will use</span>
<span class="c">!      H phases which are not the same as those producing the final </span>
<span class="c">!      ground-state electronic structure.</span>
<span class="c">!</span>
<span class="c">!    Also, since we have removed the replication (superx call) </span>
<span class="c">!      of &quot;moved&quot; coordinates</span>
<span class="c">!      into the auxiliary supercell from &#39;siesta_move&#39; (recall that it is</span>
<span class="c">!      done always in state_init for every new geometry), the &quot;moved unit</span>
<span class="c">!      cell coordinates&quot; could coexist here with &quot;unmoved non-unit cell SC coords&quot;,</span>
<span class="c">!      which is wrong.</span>

<span class="c">!      For all of the above, we should put here a sanity safeguard</span>
<span class="c">!        (if we have not done so already at the top of this routine)</span>

<span class="c">!        xa(1:3,1:na_s) = xa_last(1:3,1:na_s)</span>
<span class="c">!        ucell(1:3,1:3) = ucell_last(1:3,1:3)</span>
<span class="c">!        scell(1:3,1:3) = scell_last(1:3,1:3)</span>

<span class="c">!        DM and H issues</span>
<span class="c">!</span>
<span class="c">!        Some of the routines that follow use H and S, and some use the DM.</span>
<span class="c">!        Those which use the DM should work with the final &quot;out&quot; DM for</span>
<span class="c">!        consistency.</span>
<span class="c">!        Those which use H,S should work with the latest diagonalized H,S pair.</span>
<span class="c">!</span>
<span class="c">!      If mixing the DM during the scf loop we should avoid mixing it one more time</span>
<span class="c">!        after convergence (or restoring Dold)</span>
<span class="c">!        If mixing H, we should avoid mixing it one more time</span>
<span class="c">!        after convergence (and restoring Hold to have the exact H that generated the</span>
<span class="c">!        latest DM, although this is probably too much).</span>
<span class="c">!        See the logic in siesta_forces.</span>

<span class="c">!     Find and print wavefunctions at selected k-points</span>
<span class="c">!   This uses H,S, and xa</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">nwk</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        </span><span class="n">wfs_filename</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;.selected.WFSX&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">IONode</span><span class="p">)</span> <span class="k">print</span> <span class="s2">&quot;(a)&quot;</span><span class="p">,</span>
     <span class="err">$</span>              <span class="s2">&quot;Writing WFSX for selected k-points in &quot;</span>
     <span class="err">$</span>                           <span class="o">//</span> <span class="nb">trim</span><span class="p">(</span><span class="n">wfs_filename</span><span class="p">)</span>
        <span class="k">call </span><span class="n">wwave</span><span class="p">(</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">h_spin_dim</span><span class="p">,</span> <span class="n">spinor_dim</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> 
     <span class="p">&amp;</span>              <span class="n">nwk</span><span class="p">,</span>
     <span class="p">&amp;</span>              <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">Ef</span><span class="p">,</span> <span class="n">xijo</span><span class="p">,</span> <span class="n">indxuo</span><span class="p">,</span>
     <span class="p">&amp;</span>              <span class="n">nwk</span><span class="p">,</span> <span class="n">wfk</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="nb">gamma</span><span class="p">,</span> <span class="n">occtol</span> <span class="p">)</span>
      <span class="n">endif</span>


<span class="c">!   This uses H,S, and xa</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">write_coop</span><span class="p">)</span> <span class="k">then</span>
        <span class="c">! Output the wavefunctions for the kpoints in the SCF set</span>
        <span class="c">! Note that we allow both a band number and an energy range</span>
        <span class="c">! The user is responsible for using appropriate values.</span>
        <span class="n">wfs_band_min</span> <span class="o">=</span> <span class="n">fdf_get</span><span class="p">(</span><span class="s2">&quot;WFS.BandMin&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">wfs_band_max</span> <span class="o">=</span> <span class="n">fdf_get</span><span class="p">(</span><span class="s2">&quot;WFS.BandMax&quot;</span><span class="p">,</span><span class="n">no_u</span><span class="p">)</span>
        <span class="k">call </span><span class="n">setup_wfs_list</span><span class="p">(</span><span class="n">kpoints_scf</span><span class="p">%</span><span class="n">N</span><span class="p">,</span><span class="n">no_u</span><span class="p">,</span>
     <span class="p">&amp;</span>                      <span class="n">wfs_band_min</span><span class="p">,</span><span class="n">wfs_band_max</span><span class="p">,</span>
     <span class="err">$</span>                      <span class="n">use_scf_weights</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.,</span>
     <span class="err">$</span>                      <span class="n">use_energy_window</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
         <span class="n">wfs_filename</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;.fullBZ.WFSX&quot;</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">IONode</span><span class="p">)</span> <span class="k">print</span> <span class="s2">&quot;(a)&quot;</span><span class="p">,</span> <span class="s2">&quot;Writing WFSX for COOP/COHP in &quot;</span> 
     <span class="err">$</span>                           <span class="o">//</span> <span class="nb">trim</span><span class="p">(</span><span class="n">wfs_filename</span><span class="p">)</span>
         <span class="k">call </span><span class="n">wwave</span><span class="p">(</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">h_spin_dim</span><span class="p">,</span> <span class="n">spinor_dim</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> 
     <span class="p">.</span>        <span class="n">kpoints_scf</span><span class="p">%</span><span class="n">N</span><span class="p">,</span>
     <span class="p">.</span>        <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">Ef</span><span class="p">,</span> <span class="n">xijo</span><span class="p">,</span> <span class="n">indxuo</span><span class="p">,</span>
     <span class="p">.</span>        <span class="n">kpoints_scf</span><span class="p">%</span><span class="n">N</span><span class="p">,</span> <span class="n">kpoints_scf</span><span class="p">%</span><span class="n">k</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="nb">gamma</span><span class="p">,</span> <span class="n">occtol</span><span class="p">)</span>
      <span class="n">endif</span>

<span class="c">!     Compute bands</span>
<span class="c">!   This uses H,S, and xa</span>
      <span class="k">nullify</span><span class="p">(</span> <span class="n">ebk</span> <span class="p">)</span>
      <span class="k">call </span><span class="n">re_alloc</span><span class="p">(</span> <span class="n">ebk</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">spinor_dim</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">maxbk</span><span class="p">,</span>
     <span class="p">&amp;</span>               <span class="s1">&#39;ebk&#39;</span><span class="p">,</span> <span class="s1">&#39;siesta_analysis&#39;</span> <span class="p">)</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">nbk</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        if</span> <span class="p">(</span><span class="n">IONode</span><span class="p">)</span> <span class="k">print</span> <span class="s2">&quot;(a)&quot;</span><span class="p">,</span> <span class="s2">&quot;Computing bands...&quot;</span>
        <span class="n">getPSI</span> <span class="o">=</span> <span class="n">fdf_get</span><span class="p">(</span><span class="s1">&#39;WFS.Write.For.Bands&#39;</span><span class="p">,</span> <span class="p">.</span><span class="n">false</span><span class="p">.)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">getPSI</span><span class="p">)</span> <span class="k">then</span>
<span class="k">           </span><span class="n">wfs_filename</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;.bands.WFSX&quot;</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">IONode</span><span class="p">)</span> <span class="k">print</span> <span class="s2">&quot;(a)&quot;</span><span class="p">,</span> <span class="s2">&quot;Writing WFSX for bands in &quot;</span>
     <span class="err">$</span>                           <span class="o">//</span> <span class="nb">trim</span><span class="p">(</span><span class="n">wfs_filename</span><span class="p">)</span>
           <span class="n">wfs_band_min</span> <span class="o">=</span> <span class="n">fdf_get</span><span class="p">(</span><span class="s2">&quot;WFS.BandMin&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
           <span class="n">wfs_band_max</span> <span class="o">=</span> <span class="n">fdf_get</span><span class="p">(</span><span class="s2">&quot;WFS.BandMax&quot;</span><span class="p">,</span><span class="n">no_u</span><span class="p">)</span>
           <span class="k">call </span><span class="n">setup_wfs_list</span><span class="p">(</span><span class="n">nbk</span><span class="p">,</span><span class="n">no_u</span><span class="p">,</span><span class="n">wfs_band_min</span><span class="p">,</span><span class="n">wfs_band_max</span><span class="p">,</span>
     <span class="err">$</span>          <span class="n">use_scf_weights</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span>
     <span class="err">$</span>          <span class="n">use_energy_window</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.)</span>
        <span class="n">endif</span>
        <span class="k">call </span><span class="n">bands</span><span class="p">(</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">h_spin_dim</span><span class="p">,</span> <span class="n">spinor_dim</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> 
     <span class="p">.</span>              <span class="n">maxbk</span><span class="p">,</span>
     <span class="p">.</span>              <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">Ef</span><span class="p">,</span> <span class="n">xijo</span><span class="p">,</span> <span class="n">indxuo</span><span class="p">,</span>
     <span class="p">.</span>              <span class="p">.</span><span class="n">true</span><span class="p">.,</span> <span class="n">nbk</span><span class="p">,</span> <span class="n">bk</span><span class="p">,</span> <span class="n">ebk</span><span class="p">,</span> <span class="n">occtol</span><span class="p">,</span> <span class="n">getPSI</span> <span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">IOnode</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          if</span> <span class="p">(</span> <span class="n">writbk</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,a,/,a4,a12)&#39;</span><span class="p">)</span>
     <span class="p">&amp;</span>       <span class="s1">&#39;siesta: Band k vectors (Bohr**-1):&#39;</span><span class="p">,</span> <span class="s1">&#39;ik&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span>
            <span class="k">do </span><span class="n">ik</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nbk</span>
              <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(i4,3f12.6)&#39;</span><span class="p">)</span> <span class="n">ik</span><span class="p">,</span> <span class="p">(</span><span class="n">bk</span><span class="p">(</span><span class="n">ix</span><span class="p">,</span><span class="n">ik</span><span class="p">),</span><span class="n">ix</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
            <span class="n">enddo</span>
          <span class="n">endif</span>
        
          <span class="k">if</span> <span class="p">(</span> <span class="n">writb</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,a,/,a4,a3,a7)&#39;</span><span class="p">)</span>
     <span class="p">&amp;</span>       <span class="s1">&#39;siesta: Band energies (eV):&#39;</span><span class="p">,</span> <span class="s1">&#39;ik&#39;</span><span class="p">,</span> <span class="s1">&#39;is&#39;</span><span class="p">,</span> <span class="s1">&#39;eps&#39;</span>
            <span class="k">do </span><span class="n">ispin</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">spinor_dim</span>
              <span class="k">do </span><span class="n">ik</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nbk</span>
                <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(i4,i3,10f7.2)&#39;</span><span class="p">)</span>
     <span class="p">&amp;</span>            <span class="n">ik</span><span class="p">,</span> <span class="n">ispin</span><span class="p">,</span> <span class="p">(</span><span class="n">ebk</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="n">ispin</span><span class="p">,</span><span class="n">ik</span><span class="p">)</span><span class="o">/</span><span class="n">eV</span><span class="p">,</span><span class="n">io</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="nb">min</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">no_u</span><span class="p">))</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">no_u</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">10</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(7x,10f7.2)&#39;</span><span class="p">)</span>
     <span class="p">&amp;</span>              <span class="p">(</span><span class="n">ebk</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="n">ispin</span><span class="p">,</span><span class="n">ik</span><span class="p">)</span><span class="o">/</span><span class="n">eV</span><span class="p">,</span><span class="n">io</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span><span class="n">no_u</span><span class="p">)</span>
              <span class="n">enddo</span>
            <span class="n">enddo</span>
          <span class="n">endif</span>
        <span class="n">endif</span>
      <span class="n">endif</span>

<span class="c">!     Print eigenvalues</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">IOnode</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">writeig</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        if</span> <span class="p">((</span><span class="n">isolve</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">SOLVE_DIAGON</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>
     <span class="p">&amp;</span>       <span class="p">((</span><span class="n">isolve</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">SOLVE_MINIM</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">minim_calc_eigenvalues</span><span class="p">))</span>
     <span class="p">&amp;</span>      <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">no_l</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mi">1000</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          if</span> <span class="p">(</span> <span class="n">h_spin_dim</span> <span class="o">&lt;=</span> <span class="mi">2</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,a,/,a4,a3,a7)&#39;</span><span class="p">)</span>
     <span class="p">&amp;</span>       <span class="s1">&#39;siesta: Eigenvalues (eV):&#39;</span><span class="p">,</span> <span class="s1">&#39;ik&#39;</span><span class="p">,</span> <span class="s1">&#39;is&#39;</span><span class="p">,</span> <span class="s1">&#39;eps&#39;</span>
            <span class="k">do </span><span class="n">ik</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">kpoints_scf</span><span class="p">%</span><span class="n">N</span>
              <span class="k">do </span><span class="n">ispin</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">spinor_dim</span>
                <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(i4,i3,10f7.2)&#39;</span><span class="p">)</span>
     <span class="p">&amp;</span>            <span class="n">ik</span><span class="p">,</span><span class="n">ispin</span><span class="p">,(</span><span class="n">eo</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="n">ispin</span><span class="p">,</span><span class="n">ik</span><span class="p">)</span><span class="o">/</span><span class="n">eV</span><span class="p">,</span><span class="n">io</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="nb">min</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">neigwanted</span><span class="p">))</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">no_u</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">10</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(7x,10f7.2)&#39;</span><span class="p">)</span>
     <span class="p">&amp;</span>            <span class="p">(</span><span class="n">eo</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="n">ispin</span><span class="p">,</span><span class="n">ik</span><span class="p">)</span><span class="o">/</span><span class="n">eV</span><span class="p">,</span><span class="n">io</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span><span class="n">neigwanted</span><span class="p">)</span>
              <span class="n">enddo</span>
            <span class="n">enddo</span>
          <span class="k">else</span>
<span class="k">            write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,a)&#39;</span><span class="p">)</span> <span class="s1">&#39;siesta: Eigenvalues (eV):&#39;</span>
            <span class="k">do </span><span class="n">ik</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">kpoints_scf</span><span class="p">%</span><span class="n">N</span>
              <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(a,i6)&#39;</span><span class="p">)</span> <span class="s1">&#39;ik =&#39;</span><span class="p">,</span> <span class="n">ik</span>
              <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(10f7.2)&#39;</span><span class="p">)</span>
     <span class="p">&amp;</span>          <span class="p">((</span><span class="n">eo</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="n">ispin</span><span class="p">,</span><span class="n">ik</span><span class="p">)</span><span class="o">/</span><span class="n">eV</span><span class="p">,</span><span class="n">io</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">neigwanted</span><span class="p">),</span><span class="n">ispin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">enddo</span>
          <span class="n">endif</span>
          <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(a,f15.6,a)&#39;</span><span class="p">)</span> <span class="s1">&#39;siesta: Fermi energy =&#39;</span><span class="p">,</span> <span class="n">ef</span><span class="o">/</span><span class="n">eV</span><span class="p">,</span> <span class="s1">&#39; eV&#39;</span>
        <span class="n">endif</span>
      <span class="n">endif</span>

      <span class="k">if</span> <span class="p">(((</span><span class="n">isolve</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">SOLVE_DIAGON</span><span class="p">).</span><span class="nb">or</span><span class="p">.</span>
     <span class="p">&amp;</span>     <span class="p">((</span><span class="n">isolve</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">SOLVE_MINIM</span><span class="p">).</span><span class="nb">and</span><span class="p">.</span><span class="n">minim_calc_eigenvalues</span><span class="p">))</span>
     <span class="p">&amp;</span>     <span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">IOnode</span><span class="p">)</span>
     <span class="p">&amp;</span>    <span class="k">call </span><span class="n">ioeig</span><span class="p">(</span><span class="n">eo</span><span class="p">,</span><span class="n">ef</span><span class="p">,</span><span class="n">neigwanted</span><span class="p">,</span><span class="n">nspin</span><span class="p">,</span><span class="n">kpoints_scf</span><span class="p">%</span><span class="n">N</span><span class="p">,</span>
     <span class="p">&amp;</span>     <span class="n">no_u</span><span class="p">,</span><span class="n">spinor_dim</span><span class="p">,</span>
     <span class="p">&amp;</span>     <span class="n">kpoints_scf</span><span class="p">%</span><span class="n">N</span><span class="p">,</span> <span class="n">kpoints_scf</span><span class="p">%</span><span class="n">k</span><span class="p">,</span> <span class="n">kpoints_scf</span><span class="p">%</span><span class="n">w</span><span class="p">)</span>


<span class="c">!   This uses H,S, and xa, as it diagonalizes them again</span>
      <span class="k">call </span><span class="n">projected_DOS</span><span class="p">()</span>

<span class="c">!     Print program&#39;s energy decomposition and final forces</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">IOnode</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">siesta_write_energies</span><span class="p">(</span> <span class="n">iscf</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dDmax</span><span class="o">=</span><span class="mf">0._dp</span><span class="p">,</span> <span class="n">dHmax</span><span class="o">=</span><span class="mf">0._dp</span><span class="p">)</span>
        <span class="c">! final == .true. which makes the step counter irrelevant</span>
        <span class="k">call </span><span class="n">siesta_write_forces</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">call </span><span class="n">siesta_write_stress_pressure</span><span class="p">()</span>
        <span class="k">call </span><span class="n">write_basis_enthalpy</span><span class="p">(</span><span class="n">FreeE</span><span class="p">,</span><span class="n">FreeEHarris</span><span class="p">)</span>
      <span class="n">endif</span>

<span class="c">! NOTE: Here, the spin polarization is computed using Dscf, which is</span>
<span class="c">!       a density matrix obtained after mixing the &quot;in&quot; and &quot;out&quot;</span>
<span class="c">!       DMs of the SCF run for the last geometry considered.</span>
<span class="c">!       This can be considered a feature or a bug.</span>

      <span class="k">call </span><span class="n">print_spin</span><span class="p">(</span><span class="n">qspin</span><span class="p">)</span>  <span class="c">! qspin returned for use below</span>

<span class="c">!     This uses the last computed dipole in dhscf during the scf cycle,</span>
<span class="c">!     which is in fact derived from the &quot;in&quot; DM.</span>
<span class="c">!     Perhaps this section should be moved after the call to dhscf below</span>
<span class="c">!     AND use the DM_out of the last step (but there might not be a call</span>
<span class="c">!     to dhscf if there are no files to output, and the computation of the</span>
<span class="c">!     charge density is expensive...</span>

<span class="c">!     Print electric dipole</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">shape</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="s1">&#39;bulk&#39;</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        if</span> <span class="p">(</span><span class="n">IOnode</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,a,3f12.6)&#39;</span><span class="p">)</span>
     <span class="p">&amp;</span>      <span class="s1">&#39;siesta: Electric dipole (a.u.)  =&#39;</span><span class="p">,</span> <span class="n">dipol</span>
          <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(a,3f12.6)&#39;</span><span class="p">)</span>
     <span class="p">&amp;</span>      <span class="s1">&#39;siesta: Electric dipole (Debye) =&#39;</span><span class="p">,</span> 
     <span class="p">&amp;</span>      <span class="p">(</span><span class="n">dipol</span><span class="p">(</span><span class="n">ix</span><span class="p">)</span><span class="o">/</span><span class="n">Debye</span><span class="p">,</span><span class="n">ix</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">endif</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">cml_p</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          call </span><span class="n">cmlAddProperty</span><span class="p">(</span><span class="n">xf</span><span class="o">=</span><span class="n">mainXML</span><span class="p">,</span> <span class="k">value</span><span class="o">=</span><span class="n">dipol</span><span class="o">/</span><span class="n">Debye</span><span class="p">,</span>
     <span class="p">&amp;</span>         <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Electric dipole&#39;</span><span class="p">,</span> <span class="n">dictref</span><span class="o">=</span><span class="s1">&#39;siesta:dipol&#39;</span><span class="p">,</span>
     <span class="p">.</span>         <span class="n">units</span><span class="o">=</span><span class="s1">&#39;siestaUnits:Debye&#39;</span><span class="p">)</span>
        <span class="n">endif</span> <span class="c">!cml_p</span>
      <span class="n">endif</span>

<span class="c">! NOTE: The use of *_last geometries in the following sections</span>
<span class="c">!       guarantees that the analysis of the electronic structure</span>
<span class="c">!       is done for the geometry for which it was computed.</span>

<span class="c">!  BUT these routines need H,S, so H should not be mixed after</span>
<span class="c">!       convergence.</span>

<span class="c">!     Calculation of the bulk polarization using the Berry phase</span>
<span class="c">!     formulas by King-Smith and Vanderbilt</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">nkpol</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="n">bornz</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        if</span> <span class="p">(</span><span class="n">NonCol</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SpOrb</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          if</span> <span class="p">(</span><span class="n">IOnode</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/a)&#39;</span><span class="p">)</span>
     <span class="p">.</span>       <span class="s1">&#39;siesta_analysis: bulk polarization implemented only for&#39;</span>
            <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/a)&#39;</span><span class="p">)</span>
     <span class="p">.</span>       <span class="s1">&#39;siesta_analysis: paramagnetic or collinear spin runs&#39;</span>
          <span class="n">endif</span>
        <span class="k">else</span>
<span class="k">         call </span><span class="n">KSV_pol</span><span class="p">(</span><span class="n">na_u</span><span class="p">,</span> <span class="n">na_s</span><span class="p">,</span> <span class="n">xa_last</span><span class="p">,</span> <span class="n">rmaxo</span><span class="p">,</span> <span class="n">scell_last</span><span class="p">,</span> 
     <span class="p">&amp;</span>               <span class="n">ucell_last</span><span class="p">,</span><span class="n">no_u</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">nspin</span><span class="p">,</span> <span class="n">qspin</span><span class="p">,</span> 
     <span class="p">&amp;</span>               <span class="n">maxnh</span><span class="p">,</span> <span class="n">nkpol</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> 
     <span class="p">&amp;</span>               <span class="n">H</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">xijo</span><span class="p">,</span> <span class="n">indxuo</span><span class="p">,</span> <span class="n">isa</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span> 
     <span class="p">&amp;</span>               <span class="n">iaorb</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span> <span class="nb">shape</span><span class="p">,</span>
     <span class="p">&amp;</span>               <span class="n">nkpol</span><span class="p">,</span><span class="n">kpol</span><span class="p">,</span><span class="n">wgthpol</span><span class="p">,</span> <span class="n">polR</span><span class="p">,</span> <span class="n">polxyz</span> <span class="p">)</span> 
       <span class="n">endif</span>
      <span class="n">endif</span>

<span class="c">!     Calculation of the optical conductivity</span>
      <span class="k">call </span><span class="n">optical</span><span class="p">(</span><span class="n">na_u</span><span class="p">,</span> <span class="n">na_s</span><span class="p">,</span> <span class="n">xa_last</span><span class="p">,</span> <span class="n">scell_last</span><span class="p">,</span> <span class="n">ucell_last</span><span class="p">,</span>
     <span class="p">&amp;</span>             <span class="n">no_u</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">nspin</span><span class="p">,</span> <span class="n">qspin</span><span class="p">,</span>
     <span class="p">&amp;</span>             <span class="n">maxnh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">xijo</span><span class="p">,</span>
     <span class="err">$</span>             <span class="n">indxuo</span><span class="p">,</span> <span class="n">ebk</span><span class="p">,</span> <span class="n">ef</span><span class="p">,</span> <span class="n">temp</span><span class="p">,</span>
     <span class="p">&amp;</span>             <span class="n">isa</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span> <span class="n">iphKB</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span> <span class="n">lastkb</span><span class="p">,</span> <span class="nb">shape</span> <span class="p">)</span>

      <span class="k">call </span><span class="n">de_alloc</span><span class="p">(</span> <span class="n">ebk</span><span class="p">,</span> <span class="s1">&#39;ebk&#39;</span><span class="p">,</span> <span class="s1">&#39;siesta_analysis&#39;</span> <span class="p">)</span>
<span class="c">!...................................</span>

<span class="c">!</span>
<span class="c">!  NOTE: Dscf here might be the mixed one (see above).</span>
<span class="c">!</span>
      <span class="n">want_partial_charges</span> <span class="o">=</span> <span class="p">(</span><span class="n">hirshpop</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">voropop</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>
     <span class="err">$</span>                   <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">partial_charges_at_every_geometry</span><span class="p">)</span>

<span class="c">!     Save electron density and potential</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">saverho</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">savedrho</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">saverhoxc</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> 
     <span class="p">&amp;</span>    <span class="n">savevh</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">savevt</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">savevna</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>
     <span class="p">&amp;</span>    <span class="n">savepsch</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">savetoch</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> 
     <span class="p">&amp;</span>    <span class="n">save_ebs_dens</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> 
     <span class="p">&amp;</span>    <span class="n">want_partial_charges</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        if</span> <span class="p">(</span><span class="n">saverho</span><span class="p">)</span>   <span class="n">filesOut</span><span class="p">%</span><span class="n">rho</span>   <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span> <span class="o">//</span> <span class="s1">&#39;.RHO&#39;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">savedrho</span><span class="p">)</span>  <span class="n">filesOut</span><span class="p">%</span><span class="n">drho</span>  <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span> <span class="o">//</span> <span class="s1">&#39;.DRHO&#39;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">saverhoxc</span><span class="p">)</span> <span class="n">filesOut</span><span class="p">%</span><span class="n">rhoxc</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span> <span class="o">//</span> <span class="s1">&#39;.RHOXC&#39;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">save_ebs_dens</span><span class="p">)</span> <span class="n">filesOut</span><span class="p">%</span><span class="n">ebs_dens</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span> <span class="o">//</span> <span class="s1">&#39;.EBS&#39;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">savevh</span><span class="p">)</span>    <span class="n">filesOut</span><span class="p">%</span><span class="n">vh</span>    <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span> <span class="o">//</span> <span class="s1">&#39;.VH&#39;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">savevt</span><span class="p">)</span>    <span class="n">filesOut</span><span class="p">%</span><span class="n">vt</span>    <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span> <span class="o">//</span> <span class="s1">&#39;.VT&#39;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">savevna</span><span class="p">)</span>   <span class="n">filesOut</span><span class="p">%</span><span class="n">vna</span>   <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span> <span class="o">//</span> <span class="s1">&#39;.VNA&#39;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">savepsch</span><span class="p">)</span>  <span class="n">filesOut</span><span class="p">%</span><span class="n">psch</span>  <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span> <span class="o">//</span> <span class="s1">&#39;.IOCH&#39;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">savetoch</span><span class="p">)</span>  <span class="n">filesOut</span><span class="p">%</span><span class="n">toch</span>  <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span> <span class="o">//</span> <span class="s1">&#39;.TOCH&#39;</span>
        <span class="n">g2max</span> <span class="o">=</span> <span class="n">g2cut</span>
        <span class="n">dummy_str</span>  <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">dummy_strl</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">call </span><span class="n">dhscf</span><span class="p">(</span> <span class="n">nspin</span><span class="p">,</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">iaorb</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span>
     <span class="p">.</span>              <span class="n">no_u</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">na_s</span><span class="p">,</span> <span class="n">isa</span><span class="p">,</span> <span class="n">xa_last</span><span class="p">,</span> <span class="n">indxua</span><span class="p">,</span> 
     <span class="p">&amp;</span>              <span class="n">ntm</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">filesOut</span><span class="p">,</span> 
     <span class="p">&amp;</span>              <span class="n">maxnh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">Dscf</span><span class="p">,</span> <span class="n">Datm</span><span class="p">,</span>
     <span class="p">&amp;</span>              <span class="n">maxnh</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">Enaatm</span><span class="p">,</span> <span class="n">Enascf</span><span class="p">,</span> <span class="n">Uatm</span><span class="p">,</span> <span class="n">Uscf</span><span class="p">,</span> <span class="n">DUscf</span><span class="p">,</span> <span class="n">DUext</span><span class="p">,</span>
     <span class="p">&amp;</span>              <span class="n">Exc</span><span class="p">,</span> <span class="n">Dxc</span><span class="p">,</span> <span class="n">dipol</span><span class="p">,</span> <span class="n">dummy_str</span><span class="p">,</span> <span class="n">fa</span><span class="p">,</span> <span class="n">dummy_strl</span> <span class="p">)</span>
                    <span class="c">! next to last argument is dummy here,</span>
                    <span class="c">! as no forces are calculated</span>
                    <span class="c">! todo: make all these optional</span>
      <span class="n">endif</span>
<span class="n">C</span>    
<span class="n">C</span>     <span class="k">Call </span><span class="n">the</span> <span class="n">wannier90</span> <span class="k">interface </span><span class="n">here</span><span class="p">,</span> <span class="n">as</span> <span class="n">local_DOS</span> <span class="n">destroys</span> <span class="n">the</span> <span class="n">DM</span><span class="p">...</span>
<span class="n">C</span>
      <span class="k">if</span><span class="p">(</span> <span class="n">w90_processing</span> <span class="p">)</span> <span class="k">call </span><span class="n">siesta2wannier90</span><span class="p">()</span>

<span class="n">C</span>     <span class="n">Find</span> <span class="n">local</span> <span class="n">density</span> <span class="n">of</span> <span class="n">states</span>
<span class="c">!  It needs H,S, and xa, as it diagonalizes them again</span>
<span class="c">!  NOTE: This call will obliterate Dscf</span>
<span class="c">!  It is better to put a explicit out argument for the partial DM computed.</span>
      <span class="k">call </span><span class="n">local_DOS</span><span class="p">()</span>

<span class="c">! In summary, it is better to:</span>
<span class="c">!</span>
<span class="c">!   -- Avoid (or warn the user about) doing any analysis if the calculation is not converged</span>
<span class="c">!   -- Avoid mixing DM or H after scf convergence</span>
<span class="c">!   -- Set xa to xa_last at the top of this file. Write any &quot;next iter&quot; coordinate file</span>
<span class="c">!      in &#39;siesta_move&#39;</span>

      <span class="n">endif</span> <span class="c">! SIESTA_worker</span>
<span class="cp">#ifdef SIESTA__PEXSI</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">fdf_get</span><span class="p">(</span><span class="s2">&quot;PEXSI.LDOS&quot;</span><span class="p">,.</span><span class="n">false</span><span class="p">.))</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">pexsi_local_DOS</span><span class="p">()</span>
      <span class="n">endif</span>
<span class="cp">#endif</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">SIESTA_worker</span><span class="p">)</span> <span class="k">call </span><span class="n">timer</span><span class="p">(</span><span class="s2">&quot;Analysis&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

<span class="c">!------------------------------------------------------------------------- END</span>
      <span class="k">END subroutine </span><span class="n">siesta_analysis</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2018 <a rel="license" href="http://www.gnu.org/licenses/old-licenses/fdl-1.2.en.html">GNU Free Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> SIESTA was developed by SIESTA Group</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>