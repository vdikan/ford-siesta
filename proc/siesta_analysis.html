<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="A first-principles materials simulation code using Density Functional Theory.">
    
    <meta name="author" content="SIESTA Group" >
    <link rel="icon" href="../favicon.png">

    <title>siesta_analysis &ndash; SIESTA</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">SIESTA <small>trunk-700--vdikan-edens-708-ford-681</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>Program Overview</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>siesta_analysis
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 3.7% of total for procedures.">229 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/siesta_analysis.F"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/siesta_analysis.f.html'>siesta_analysis.F</a></li>
    
     <li><a href='../module/m_siesta_analysis.html'>m_siesta_analysis</a></li>
    
  
     <li class="active">siesta_analysis</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/siesta_analysis.html#src">siesta_analysis</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine siesta_analysis(relaxd)
    
    
   
</h2>
    
  
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
      
      <li class="list-group-item">
  <ul class="list-inline">
    
    <li>band</li>
    
    <li>writewave</li>
    
    <li>writewave</li>
    
    <li>m_ksvinit</li>
    
    <li>m_ksv</li>
    
    <li>m_projected_DOS</li>
    
    <li>m_local_DOS</li>
    
    <li>m_pexsi_local_DOS</li>
    
    <li>m_pexsi_dos</li>
    
    <li>siesta_options</li>
    
    <li>units</li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>siesta_geom</li>
    
    <li><a href='../module/m_dhscf.html'>m_dhscf</a></li>
    
    <li>atomlist</li>
    
    <li>atomlist</li>
    
    <li>fdf</li>
    
    <li>writewave</li>
    
    <li>siesta_cml</li>
    
    <li>files</li>
    
    <li>files</li>
    
    <li>zmatrix</li>
    
    <li>kpoint_scf_m</li>
    
    <li>parallel</li>
    
    <li>parallel</li>
    
    <li>files</li>
    
    <li>m_energies</li>
    
    <li>m_steps</li>
    
    <li>m_ntm</li>
    
    <li>m_spin</li>
    
    <li>m_spin</li>
    
    <li>m_dipol</li>
    
    <li>m_eo</li>
    
    <li>m_forces</li>
    
    <li>m_gamma</li>
    
    <li>alloc</li>
    
    <li>basis_enthalpy</li>
    
    <li>m_partial_charges</li>
    
    <li>m_iodm_old</li>
    
    <li>m_siesta2wannier90</li>
    
    <li>m_mpi_utils</li>
    
    <li>flook_siesta</li>
    
  </ul>
      </li>
      
      
      
      <li class="list-group-item">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~siesta_analysis~~UsesGraph Pages: 1 -->
<svg id="procsiesta_analysisUsesGraph" width="331pt" height="1460pt"
 viewBox="0.00 0.00 331.00 1460.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~siesta_analysis~~UsesGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 1456)">
<title>proc~~siesta_analysis~~UsesGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1456 327,-1456 327,4 -4,4"/>
<!-- proc~siesta_analysis -->
<g id="proc~~siesta_analysis~~UsesGraph_node1" class="node"><title>proc~siesta_analysis</title>
<polygon fill="none" stroke="black" points="323,-738 238,-738 238,-714 323,-714 323,-738"/>
<text text-anchor="middle" x="280.5" y="-723.6" font-family="Helvetica,sans-Serif" font-size="10.50">siesta_analysis</text>
</g>
<!-- siesta_options -->
<g id="proc~~siesta_analysis~~UsesGraph_node2" class="node"><title>siesta_options</title>
<polygon fill="#337ab7" stroke="#337ab7" points="187,-1452 106,-1452 106,-1428 187,-1428 187,-1452"/>
<text text-anchor="middle" x="146.5" y="-1437.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_options</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;siesta_options -->
<g id="proc~~siesta_analysis~~UsesGraph_edge17" class="edge"><title>proc~siesta_analysis&#45;&gt;siesta_options</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M278.898,-738.088C274.435,-825.794 245.449,-1362.69 202,-1419 200.171,-1421.37 198.038,-1423.47 195.697,-1425.34"/>
<polygon fill="#000000" stroke="#000000" points="193.638,-1422.5 187.068,-1430.81 197.388,-1428.41 193.638,-1422.5"/>
</g>
<!-- flook_siesta -->
<g id="proc~~siesta_analysis~~UsesGraph_node3" class="node"><title>flook_siesta</title>
<polygon fill="#337ab7" stroke="#337ab7" points="181,-1410 112,-1410 112,-1386 181,-1386 181,-1410"/>
<text text-anchor="middle" x="146.5" y="-1395.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">flook_siesta</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;flook_siesta -->
<g id="proc~~siesta_analysis~~UsesGraph_edge2" class="edge"><title>proc~siesta_analysis&#45;&gt;flook_siesta</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M279.703,-738.027C280.817,-817.937 283.464,-1272.2 202,-1377 198.815,-1381.1 194.724,-1384.4 190.218,-1387.05"/>
<polygon fill="#000000" stroke="#000000" points="188.662,-1383.92 181.168,-1391.41 191.697,-1390.22 188.662,-1383.92"/>
</g>
<!-- m_partial_charges -->
<g id="proc~~siesta_analysis~~UsesGraph_node4" class="node"><title>m_partial_charges</title>
<polygon fill="#337ab7" stroke="#337ab7" points="197,-1368 96,-1368 96,-1344 197,-1344 197,-1368"/>
<text text-anchor="middle" x="146.5" y="-1353.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_partial_charges</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;m_partial_charges -->
<g id="proc~~siesta_analysis~~UsesGraph_edge3" class="edge"><title>proc~siesta_analysis&#45;&gt;m_partial_charges</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M279.595,-738.488C279.951,-816.59 278.27,-1237.69 202,-1335 201.312,-1335.88 200.582,-1336.72 199.816,-1337.53"/>
<polygon fill="#000000" stroke="#000000" points="197.583,-1334.83 192.061,-1343.87 202.016,-1340.25 197.583,-1334.83"/>
</g>
<!-- sparse_matrices -->
<g id="proc~~siesta_analysis~~UsesGraph_node5" class="node"><title>sparse_matrices</title>
<polygon fill="#337ab7" stroke="#337ab7" points="192,-1326 101,-1326 101,-1302 192,-1302 192,-1326"/>
<text text-anchor="middle" x="146.5" y="-1311.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sparse_matrices</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;sparse_matrices -->
<g id="proc~~siesta_analysis~~UsesGraph_edge31" class="edge"><title>proc~siesta_analysis&#45;&gt;sparse_matrices</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M279.467,-738.108C279.035,-812.073 273.362,-1202.82 202,-1293 201.308,-1293.87 200.575,-1294.71 199.805,-1295.52"/>
<polygon fill="#000000" stroke="#000000" points="197.574,-1292.82 192.028,-1301.85 201.993,-1298.25 197.574,-1292.82"/>
</g>
<!-- m_projected_DOS -->
<g id="proc~~siesta_analysis~~UsesGraph_node6" class="node"><title>m_projected_DOS</title>
<polygon fill="#337ab7" stroke="#337ab7" points="196.5,-1284 96.5,-1284 96.5,-1260 196.5,-1260 196.5,-1284"/>
<text text-anchor="middle" x="146.5" y="-1269.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_projected_DOS</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;m_projected_DOS -->
<g id="proc~~siesta_analysis~~UsesGraph_edge5" class="edge"><title>proc~siesta_analysis&#45;&gt;m_projected_DOS</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M279.321,-738.121C278.045,-808.863 268.336,-1168.09 202,-1251 201.287,-1251.89 200.532,-1252.74 199.739,-1253.56"/>
<polygon fill="#000000" stroke="#000000" points="197.344,-1250.99 191.73,-1259.98 201.722,-1256.46 197.344,-1250.99"/>
</g>
<!-- siesta_cml -->
<g id="proc~~siesta_analysis~~UsesGraph_node7" class="node"><title>siesta_cml</title>
<polygon fill="#337ab7" stroke="#337ab7" points="178,-1242 115,-1242 115,-1218 178,-1218 178,-1242"/>
<text text-anchor="middle" x="146.5" y="-1227.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_cml</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;siesta_cml -->
<g id="proc~~siesta_analysis~~UsesGraph_edge6" class="edge"><title>proc~siesta_analysis&#45;&gt;siesta_cml</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M279.153,-738.021C276.989,-805.146 263.358,-1133.29 202,-1209 198.156,-1213.74 193.104,-1217.42 187.626,-1220.26"/>
<polygon fill="#000000" stroke="#000000" points="185.966,-1217.17 178.143,-1224.31 188.714,-1223.6 185.966,-1217.17"/>
</g>
<!-- m_energies -->
<g id="proc~~siesta_analysis~~UsesGraph_node8" class="node"><title>m_energies</title>
<polygon fill="#337ab7" stroke="#337ab7" points="181,-1200 112,-1200 112,-1176 181,-1176 181,-1200"/>
<text text-anchor="middle" x="146.5" y="-1185.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_energies</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;m_energies -->
<g id="proc~~siesta_analysis~~UsesGraph_edge7" class="edge"><title>proc~siesta_analysis&#45;&gt;m_energies</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M278.942,-738.217C275.791,-802.224 258.305,-1098.57 202,-1167 198.825,-1170.86 194.853,-1174.01 190.508,-1176.58"/>
<polygon fill="#000000" stroke="#000000" points="188.673,-1173.58 181.202,-1181.09 191.727,-1179.88 188.673,-1173.58"/>
</g>
<!-- kpoint_scf_m -->
<g id="proc~~siesta_analysis~~UsesGraph_node9" class="node"><title>kpoint_scf_m</title>
<polygon fill="#337ab7" stroke="#337ab7" points="184.5,-1158 108.5,-1158 108.5,-1134 184.5,-1134 184.5,-1158"/>
<text text-anchor="middle" x="146.5" y="-1143.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">kpoint_scf_m</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;kpoint_scf_m -->
<g id="proc~~siesta_analysis~~UsesGraph_edge8" class="edge"><title>proc~siesta_analysis&#45;&gt;kpoint_scf_m</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M278.694,-738.234C274.497,-798.541 253.325,-1063.75 202,-1125 199.544,-1127.93 196.628,-1130.46 193.442,-1132.63"/>
<polygon fill="#000000" stroke="#000000" points="191.545,-1129.68 184.505,-1137.6 194.946,-1135.8 191.545,-1129.68"/>
</g>
<!-- atomlist -->
<g id="proc~~siesta_analysis~~UsesGraph_node10" class="node"><title>atomlist</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173.5,-1116 119.5,-1116 119.5,-1092 173.5,-1092 173.5,-1116"/>
<text text-anchor="middle" x="146.5" y="-1101.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">atomlist</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;atomlist -->
<g id="proc~~siesta_analysis~~UsesGraph_edge32" class="edge"><title>proc~siesta_analysis&#45;&gt;atomlist</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M278.408,-738.053C273.11,-794.103 248.422,-1028.82 202,-1083 197.056,-1088.77 190.337,-1092.96 183.305,-1096"/>
<polygon fill="#000000" stroke="#000000" points="181.88,-1092.8 173.66,-1099.48 184.254,-1099.38 181.88,-1092.8"/>
</g>
<!-- m_steps -->
<g id="proc~~siesta_analysis~~UsesGraph_node11" class="node"><title>m_steps</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173.5,-1074 119.5,-1074 119.5,-1050 173.5,-1050 173.5,-1074"/>
<text text-anchor="middle" x="146.5" y="-1059.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_steps</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;m_steps -->
<g id="proc~~siesta_analysis~~UsesGraph_edge9" class="edge"><title>proc~siesta_analysis&#45;&gt;m_steps</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M278.038,-738.004C271.508,-789.828 243.506,-993.878 202,-1041 196.977,-1046.7 190.225,-1050.87 183.187,-1053.9"/>
<polygon fill="#000000" stroke="#000000" points="181.763,-1050.69 173.546,-1057.38 184.141,-1057.28 181.763,-1050.69"/>
</g>
<!-- basis_enthalpy -->
<g id="proc~~siesta_analysis~~UsesGraph_node12" class="node"><title>basis_enthalpy</title>
<polygon fill="#337ab7" stroke="#337ab7" points="188.5,-1032 104.5,-1032 104.5,-1008 188.5,-1008 188.5,-1032"/>
<text text-anchor="middle" x="146.5" y="-1017.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">basis_enthalpy</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;basis_enthalpy -->
<g id="proc~~siesta_analysis~~UsesGraph_edge10" class="edge"><title>proc~siesta_analysis&#45;&gt;basis_enthalpy</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M279.67,-738.155C279.593,-780.084 273.743,-920.398 202,-999 200.473,-1000.67 198.797,-1002.21 197.01,-1003.63"/>
<polygon fill="#000000" stroke="#000000" points="195.06,-1000.73 188.581,-1009.11 198.874,-1006.6 195.06,-1000.73"/>
</g>
<!-- m_iodm_old -->
<g id="proc~~siesta_analysis~~UsesGraph_node13" class="node"><title>m_iodm_old</title>
<polygon fill="#337ab7" stroke="#337ab7" points="182,-990 111,-990 111,-966 182,-966 182,-990"/>
<text text-anchor="middle" x="146.5" y="-975.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_iodm_old</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;m_iodm_old -->
<g id="proc~~siesta_analysis~~UsesGraph_edge11" class="edge"><title>proc~siesta_analysis&#45;&gt;m_iodm_old</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M278.93,-738.117C276.519,-775.762 264.145,-892.053 202,-957 198.879,-960.261 195.196,-963.023 191.24,-965.361"/>
<polygon fill="#000000" stroke="#000000" points="189.651,-962.243 182.257,-969.831 192.769,-968.51 189.651,-962.243"/>
</g>
<!-- siesta_geom -->
<g id="proc~~siesta_analysis~~UsesGraph_node14" class="node"><title>siesta_geom</title>
<polygon fill="#337ab7" stroke="#337ab7" points="183,-948 110,-948 110,-924 183,-924 183,-948"/>
<text text-anchor="middle" x="146.5" y="-933.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_geom</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;siesta_geom -->
<g id="proc~~siesta_analysis~~UsesGraph_edge12" class="edge"><title>proc~siesta_analysis&#45;&gt;siesta_geom</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M277.835,-738.478C272.754,-771.769 254.46,-863.648 202,-915 199.107,-917.832 195.791,-920.291 192.255,-922.425"/>
<polygon fill="#000000" stroke="#000000" points="190.438,-919.422 183.123,-927.087 193.621,-925.657 190.438,-919.422"/>
</g>
<!-- m_ksvinit -->
<g id="proc~~siesta_analysis~~UsesGraph_node15" class="node"><title>m_ksvinit</title>
<polygon fill="#337ab7" stroke="#337ab7" points="175,-906 118,-906 118,-882 175,-882 175,-906"/>
<text text-anchor="middle" x="146.5" y="-891.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ksvinit</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;m_ksvinit -->
<g id="proc~~siesta_analysis~~UsesGraph_edge13" class="edge"><title>proc~siesta_analysis&#45;&gt;m_ksvinit</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M276.307,-738.105C268.399,-765.824 245.339,-834.471 202,-873 197.027,-877.421 191.022,-880.956 184.841,-883.767"/>
<polygon fill="#000000" stroke="#000000" points="183.12,-880.684 175.107,-887.615 185.693,-887.194 183.12,-880.684"/>
</g>
<!-- units -->
<g id="proc~~siesta_analysis~~UsesGraph_node16" class="node"><title>units</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173.5,-864 119.5,-864 119.5,-840 173.5,-840 173.5,-864"/>
<text text-anchor="middle" x="146.5" y="-849.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">units</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;units -->
<g id="proc~~siesta_analysis~~UsesGraph_edge14" class="edge"><title>proc~siesta_analysis&#45;&gt;units</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M273.529,-738.134C262.342,-759.704 236.234,-804.901 202,-831 196.42,-835.254 189.874,-838.743 183.292,-841.569"/>
<polygon fill="#000000" stroke="#000000" points="181.808,-838.39 173.732,-845.248 184.322,-844.923 181.808,-838.39"/>
</g>
<!-- m_ntm -->
<g id="proc~~siesta_analysis~~UsesGraph_node17" class="node"><title>m_ntm</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173.5,-822 119.5,-822 119.5,-798 173.5,-798 173.5,-822"/>
<text text-anchor="middle" x="146.5" y="-807.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ntm</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;m_ntm -->
<g id="proc~~siesta_analysis~~UsesGraph_edge15" class="edge"><title>proc~siesta_analysis&#45;&gt;m_ntm</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M267.258,-738.038C252.705,-751.827 227.205,-774.395 202,-789 196.242,-792.336 189.855,-795.342 183.54,-797.967"/>
<polygon fill="#000000" stroke="#000000" points="181.822,-794.881 173.775,-801.773 184.363,-801.403 181.822,-794.881"/>
</g>
<!-- m_ksv -->
<g id="proc~~siesta_analysis~~UsesGraph_node18" class="node"><title>m_ksv</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173.5,-780 119.5,-780 119.5,-756 173.5,-756 173.5,-780"/>
<text text-anchor="middle" x="146.5" y="-765.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ksv</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;m_ksv -->
<g id="proc~~siesta_analysis~~UsesGraph_edge16" class="edge"><title>proc~siesta_analysis&#45;&gt;m_ksv</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M241.674,-738.036C223.29,-743.885 201.316,-750.877 183.219,-756.635"/>
<polygon fill="#000000" stroke="#000000" points="182.08,-753.324 173.612,-759.692 184.203,-759.995 182.08,-753.324"/>
</g>
<!-- files -->
<g id="proc~~siesta_analysis~~UsesGraph_node19" class="node"><title>files</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173.5,-738 119.5,-738 119.5,-714 173.5,-714 173.5,-738"/>
<text text-anchor="middle" x="146.5" y="-723.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">files</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;files -->
<g id="proc~~siesta_analysis~~UsesGraph_edge1" class="edge"><title>proc~siesta_analysis&#45;&gt;files</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M237.734,-726C220.51,-726 200.728,-726 184.084,-726"/>
<polygon fill="#000000" stroke="#000000" points="183.658,-722.5 173.658,-726 183.658,-729.5 183.658,-722.5"/>
</g>
<!-- m_pexsi_dos -->
<g id="proc~~siesta_analysis~~UsesGraph_node20" class="node"><title>m_pexsi_dos</title>
<polygon fill="#337ab7" stroke="#337ab7" points="184.5,-696 108.5,-696 108.5,-672 184.5,-672 184.5,-696"/>
<text text-anchor="middle" x="146.5" y="-681.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_pexsi_dos</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;m_pexsi_dos -->
<g id="proc~~siesta_analysis~~UsesGraph_edge18" class="edge"><title>proc~siesta_analysis&#45;&gt;m_pexsi_dos</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M241.674,-713.964C227.051,-709.312 210.155,-703.936 194.747,-699.033"/>
<polygon fill="#000000" stroke="#000000" points="195.466,-695.589 184.875,-695.892 193.343,-702.259 195.466,-695.589"/>
</g>
<!-- module~m_dhscf -->
<g id="proc~~siesta_analysis~~UsesGraph_node21" class="node"><title>module~m_dhscf</title>
<g id="a_proc~~siesta_analysis~~UsesGraph_node21"><a xlink:href=".././module/m_dhscf.html" xlink:title="m_dhscf">
<polygon fill="#337ab7" stroke="#337ab7" points="173.5,-654 119.5,-654 119.5,-630 173.5,-630 173.5,-654"/>
<text text-anchor="middle" x="146.5" y="-639.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_dhscf</text>
</a>
</g>
</g>
<!-- proc~siesta_analysis&#45;&gt;module~m_dhscf -->
<g id="proc~~siesta_analysis~~UsesGraph_edge19" class="edge"><title>proc~siesta_analysis&#45;&gt;module~m_dhscf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M267.258,-713.962C252.705,-700.173 227.205,-677.605 202,-663 196.242,-659.664 189.855,-656.658 183.54,-654.033"/>
<polygon fill="#000000" stroke="#000000" points="184.363,-650.597 173.775,-650.227 181.822,-657.119 184.363,-650.597"/>
</g>
<!-- band -->
<g id="proc~~siesta_analysis~~UsesGraph_node22" class="node"><title>band</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173.5,-612 119.5,-612 119.5,-588 173.5,-588 173.5,-612"/>
<text text-anchor="middle" x="146.5" y="-597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">band</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;band -->
<g id="proc~~siesta_analysis~~UsesGraph_edge20" class="edge"><title>proc~siesta_analysis&#45;&gt;band</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M273.529,-713.866C262.342,-692.296 236.234,-647.099 202,-621 196.42,-616.746 189.874,-613.257 183.292,-610.431"/>
<polygon fill="#000000" stroke="#000000" points="184.322,-607.077 173.732,-606.752 181.808,-613.61 184.322,-607.077"/>
</g>
<!-- m_local_DOS -->
<g id="proc~~siesta_analysis~~UsesGraph_node23" class="node"><title>m_local_DOS</title>
<polygon fill="#337ab7" stroke="#337ab7" points="185.5,-570 107.5,-570 107.5,-546 185.5,-546 185.5,-570"/>
<text text-anchor="middle" x="146.5" y="-555.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_local_DOS</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;m_local_DOS -->
<g id="proc~~siesta_analysis~~UsesGraph_edge21" class="edge"><title>proc~siesta_analysis&#45;&gt;m_local_DOS</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M276.307,-713.895C268.399,-686.176 245.339,-617.529 202,-579 199.687,-576.944 197.152,-575.08 194.479,-573.391"/>
<polygon fill="#000000" stroke="#000000" points="196.042,-570.257 185.582,-568.573 192.709,-576.413 196.042,-570.257"/>
</g>
<!-- m_spin -->
<g id="proc~~siesta_analysis~~UsesGraph_node24" class="node"><title>m_spin</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173.5,-528 119.5,-528 119.5,-504 173.5,-504 173.5,-528"/>
<text text-anchor="middle" x="146.5" y="-513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_spin</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;m_spin -->
<g id="proc~~siesta_analysis~~UsesGraph_edge22" class="edge"><title>proc~siesta_analysis&#45;&gt;m_spin</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M277.835,-713.522C272.754,-680.231 254.46,-588.352 202,-537 196.67,-531.782 189.902,-527.829 182.964,-524.845"/>
<polygon fill="#000000" stroke="#000000" points="184.109,-521.537 173.516,-521.348 181.68,-528.101 184.109,-521.537"/>
</g>
<!-- writewave -->
<g id="proc~~siesta_analysis~~UsesGraph_node25" class="node"><title>writewave</title>
<polygon fill="#337ab7" stroke="#337ab7" points="176.5,-486 116.5,-486 116.5,-462 176.5,-462 176.5,-486"/>
<text text-anchor="middle" x="146.5" y="-471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">writewave</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;writewave -->
<g id="proc~~siesta_analysis~~UsesGraph_edge24" class="edge"><title>proc~siesta_analysis&#45;&gt;writewave</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M278.93,-713.883C276.519,-676.238 264.145,-559.947 202,-495 197.538,-490.336 191.925,-486.694 186.009,-483.852"/>
<polygon fill="#000000" stroke="#000000" points="187.168,-480.545 176.587,-480.016 184.528,-487.028 187.168,-480.545"/>
</g>
<!-- parallel -->
<g id="proc~~siesta_analysis~~UsesGraph_node26" class="node"><title>parallel</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173.5,-444 119.5,-444 119.5,-420 173.5,-420 173.5,-444"/>
<text text-anchor="middle" x="146.5" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;parallel -->
<g id="proc~~siesta_analysis~~UsesGraph_edge25" class="edge"><title>proc~siesta_analysis&#45;&gt;parallel</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M279.67,-713.845C279.593,-671.916 273.743,-531.602 202,-453 196.924,-447.439 190.208,-443.337 183.23,-440.316"/>
<polygon fill="#000000" stroke="#000000" points="184.276,-436.972 173.682,-436.831 181.876,-443.548 184.276,-436.972"/>
</g>
<!-- m_siesta2wannier90 -->
<g id="proc~~siesta_analysis~~UsesGraph_node27" class="node"><title>m_siesta2wannier90</title>
<polygon fill="#337ab7" stroke="#337ab7" points="202,-402 91,-402 91,-378 202,-378 202,-402"/>
<text text-anchor="middle" x="146.5" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_siesta2wannier90</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;m_siesta2wannier90 -->
<g id="proc~~siesta_analysis~~UsesGraph_edge26" class="edge"><title>proc~siesta_analysis&#45;&gt;m_siesta2wannier90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M278.038,-713.996C271.508,-662.172 243.506,-458.122 202,-411 201.133,-410.016 200.214,-409.077 199.251,-408.182"/>
<polygon fill="#000000" stroke="#000000" points="201.243,-405.301 191.129,-402.144 197.066,-410.919 201.243,-405.301"/>
</g>
<!-- m_forces -->
<g id="proc~~siesta_analysis~~UsesGraph_node28" class="node"><title>m_forces</title>
<polygon fill="#337ab7" stroke="#337ab7" points="175,-360 118,-360 118,-336 175,-336 175,-360"/>
<text text-anchor="middle" x="146.5" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_forces</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;m_forces -->
<g id="proc~~siesta_analysis~~UsesGraph_edge27" class="edge"><title>proc~siesta_analysis&#45;&gt;m_forces</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M278.408,-713.947C273.11,-657.897 248.422,-423.184 202,-369 197.39,-363.619 191.237,-359.611 184.725,-356.628"/>
<polygon fill="#000000" stroke="#000000" points="185.659,-353.238 175.068,-352.949 183.167,-359.78 185.659,-353.238"/>
</g>
<!-- alloc -->
<g id="proc~~siesta_analysis~~UsesGraph_node29" class="node"><title>alloc</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173.5,-318 119.5,-318 119.5,-294 173.5,-294 173.5,-318"/>
<text text-anchor="middle" x="146.5" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">alloc</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;alloc -->
<g id="proc~~siesta_analysis~~UsesGraph_edge28" class="edge"><title>proc~siesta_analysis&#45;&gt;alloc</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M278.694,-713.766C274.497,-653.459 253.325,-388.255 202,-327 197.12,-321.176 190.427,-316.962 183.4,-313.915"/>
<polygon fill="#000000" stroke="#000000" points="184.346,-310.535 173.751,-310.441 181.974,-317.121 184.346,-310.535"/>
</g>
<!-- m_gamma -->
<g id="proc~~siesta_analysis~~UsesGraph_node30" class="node"><title>m_gamma</title>
<polygon fill="#337ab7" stroke="#337ab7" points="178.5,-276 114.5,-276 114.5,-252 178.5,-252 178.5,-276"/>
<text text-anchor="middle" x="146.5" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_gamma</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;m_gamma -->
<g id="proc~~siesta_analysis~~UsesGraph_edge29" class="edge"><title>proc~siesta_analysis&#45;&gt;m_gamma</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M278.942,-713.783C275.791,-649.776 258.305,-353.432 202,-285 198.203,-280.385 193.266,-276.782 187.914,-273.97"/>
<polygon fill="#000000" stroke="#000000" points="189.212,-270.717 178.645,-269.944 186.423,-277.138 189.212,-270.717"/>
</g>
<!-- fdf -->
<g id="proc~~siesta_analysis~~UsesGraph_node31" class="node"><title>fdf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173.5,-234 119.5,-234 119.5,-210 173.5,-210 173.5,-234"/>
<text text-anchor="middle" x="146.5" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fdf</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;fdf -->
<g id="proc~~siesta_analysis~~UsesGraph_edge30" class="edge"><title>proc~siesta_analysis&#45;&gt;fdf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M279.153,-713.979C276.989,-646.854 263.358,-318.713 202,-243 197.172,-237.042 190.44,-232.772 183.351,-229.712"/>
<polygon fill="#000000" stroke="#000000" points="184.202,-226.3 173.608,-226.245 181.855,-232.895 184.202,-226.3"/>
</g>
<!-- m_eo -->
<g id="proc~~siesta_analysis~~UsesGraph_node32" class="node"><title>m_eo</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173.5,-192 119.5,-192 119.5,-168 173.5,-168 173.5,-192"/>
<text text-anchor="middle" x="146.5" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_eo</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;m_eo -->
<g id="proc~~siesta_analysis~~UsesGraph_edge4" class="edge"><title>proc~siesta_analysis&#45;&gt;m_eo</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M279.321,-713.879C278.045,-643.137 268.336,-283.913 202,-201 197.209,-195.012 190.493,-190.73 183.407,-187.667"/>
<polygon fill="#000000" stroke="#000000" points="184.256,-184.254 173.661,-184.202 181.91,-190.85 184.256,-184.254"/>
</g>
<!-- m_mpi_utils -->
<g id="proc~~siesta_analysis~~UsesGraph_node33" class="node"><title>m_mpi_utils</title>
<polygon fill="#337ab7" stroke="#337ab7" points="181.5,-150 111.5,-150 111.5,-126 181.5,-126 181.5,-150"/>
<text text-anchor="middle" x="146.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_mpi_utils</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;m_mpi_utils -->
<g id="proc~~siesta_analysis~~UsesGraph_edge23" class="edge"><title>proc~siesta_analysis&#45;&gt;m_mpi_utils</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M279.467,-713.892C279.035,-639.927 273.362,-249.181 202,-159 198.936,-155.129 195.067,-151.97 190.809,-149.394"/>
<polygon fill="#000000" stroke="#000000" points="192.173,-146.164 181.656,-144.88 189.077,-152.442 192.173,-146.164"/>
</g>
<!-- m_dipol -->
<g id="proc~~siesta_analysis~~UsesGraph_node34" class="node"><title>m_dipol</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173.5,-108 119.5,-108 119.5,-84 173.5,-84 173.5,-108"/>
<text text-anchor="middle" x="146.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_dipol</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;m_dipol -->
<g id="proc~~siesta_analysis~~UsesGraph_edge33" class="edge"><title>proc~siesta_analysis&#45;&gt;m_dipol</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M279.595,-713.512C279.951,-635.41 278.27,-214.306 202,-117 197.269,-110.965 190.578,-106.663 183.496,-103.596"/>
<polygon fill="#000000" stroke="#000000" points="184.341,-100.182 173.746,-100.134 181.999,-106.779 184.341,-100.182"/>
</g>
<!-- zmatrix -->
<g id="proc~~siesta_analysis~~UsesGraph_node35" class="node"><title>zmatrix</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173.5,-66 119.5,-66 119.5,-42 173.5,-42 173.5,-66"/>
<text text-anchor="middle" x="146.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">zmatrix</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;zmatrix -->
<g id="proc~~siesta_analysis~~UsesGraph_edge34" class="edge"><title>proc~siesta_analysis&#45;&gt;zmatrix</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M279.703,-713.973C280.817,-634.063 283.464,-179.804 202,-75 197.294,-68.9456 190.612,-64.6357 183.533,-61.5679"/>
<polygon fill="#000000" stroke="#000000" points="184.376,-58.1531 173.781,-58.1073 182.034,-64.7501 184.376,-58.1531"/>
</g>
<!-- m_pexsi_local_DOS -->
<g id="proc~~siesta_analysis~~UsesGraph_node36" class="node"><title>m_pexsi_local_DOS</title>
<polygon fill="#337ab7" stroke="#337ab7" points="201,-24 92,-24 92,-0 201,-0 201,-24"/>
<text text-anchor="middle" x="146.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_pexsi_local_DOS</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;m_pexsi_local_DOS -->
<g id="proc~~siesta_analysis~~UsesGraph_edge35" class="edge"><title>proc~siesta_analysis&#45;&gt;m_pexsi_local_DOS</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M278.898,-713.912C274.435,-626.206 245.449,-89.3099 202,-33 201.319,-32.1169 200.595,-31.271 199.835,-30.4606"/>
<polygon fill="#000000" stroke="#000000" points="202.055,-27.755 192.116,-24.085 197.597,-33.152 202.055,-27.755"/>
</g>
<!-- precision -->
<g id="proc~~siesta_analysis~~UsesGraph_node37" class="node"><title>precision</title>
<polygon fill="#337ab7" stroke="#337ab7" points="55,-675 0,-675 0,-651 55,-651 55,-675"/>
<text text-anchor="middle" x="27.5" y="-660.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">precision</text>
</g>
<!-- module~m_dhscf&#45;&gt;precision -->
<g id="proc~~siesta_analysis~~UsesGraph_edge36" class="edge"><title>module~m_dhscf&#45;&gt;precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M119.243,-646.713C103.248,-649.584 82.5762,-653.294 65.0037,-656.448"/>
<polygon fill="#000000" stroke="#000000" points="64.2986,-653.019 55.0743,-658.23 65.5353,-659.908 64.2986,-653.019"/>
</g>
<!-- m_dfscf -->
<g id="proc~~siesta_analysis~~UsesGraph_node38" class="node"><title>m_dfscf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54.5,-633 0.5,-633 0.5,-609 54.5,-609 54.5,-633"/>
<text text-anchor="middle" x="27.5" y="-618.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_dfscf</text>
</g>
<!-- module~m_dhscf&#45;&gt;m_dfscf -->
<g id="proc~~siesta_analysis~~UsesGraph_edge37" class="edge"><title>module~m_dhscf&#45;&gt;m_dfscf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M119.243,-637.287C103.135,-634.396 82.2848,-630.654 64.6329,-627.485"/>
<polygon fill="#000000" stroke="#000000" points="65.1305,-624.019 54.6694,-625.697 63.8938,-630.909 65.1305,-624.019"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="490pt" height="32pt"
 viewBox="0.00 0.00 489.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 485.5,-28 485.5,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node"><title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node"><title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="139.5,-24 72.5,-24 72.5,-0 139.5,-0 139.5,-24"/>
<text text-anchor="middle" x="106" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="222,-24 158,-24 158,-0 222,-0 222,-24"/>
<text text-anchor="middle" x="190" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="294,-24 240,-24 240,-0 294,-0 294,-24"/>
<text text-anchor="middle" x="267" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="366,-24 312,-24 312,-0 366,-0 366,-24"/>
<text text-anchor="middle" x="339" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="481.5,-24 384.5,-24 384.5,-0 481.5,-0 481.5,-24"/>
<text text-anchor="middle" x="433" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses.
    </p>
    </div></div></div></div>
      </li>
      
      </ul>
    </div>
    


    
    <p>Check that we are converged in geometry,
 if strictly required,
 before carrying out any analysis.</p>
<p>@code
@endcode</p>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-relaxd"></span>logical</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>relaxd</strong></td><td></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~siesta_analysis~~CallsGraph Pages: 1 -->
<svg id="procsiesta_analysisCallsGraph" width="641pt" height="1855pt"
 viewBox="0.00 0.00 641.00 1854.64" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~siesta_analysis~~CallsGraph" class="graph" transform="scale(0.804266 0.804266) rotate(0) translate(4 2302)">
<title>proc~~siesta_analysis~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-2302 793,-2302 793,4 -4,4"/>
<!-- proc~siesta_analysis -->
<g id="proc~~siesta_analysis~~CallsGraph_node1" class="node"><title>proc~siesta_analysis</title>
<polygon fill="none" stroke="black" points="85,-801 0,-801 0,-777 85,-777 85,-801"/>
<text text-anchor="middle" x="42.5" y="-786.6" font-family="Helvetica,sans-Serif" font-size="10.50">siesta_analysis</text>
</g>
<!-- eo -->
<g id="proc~~siesta_analysis~~CallsGraph_node2" class="node"><title>eo</title>
<polygon fill="#777777" stroke="#777777" points="223.5,-2298 169.5,-2298 169.5,-2274 223.5,-2274 223.5,-2298"/>
<text text-anchor="middle" x="196.5" y="-2283.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">eo</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;eo -->
<g id="proc~~siesta_analysis~~CallsGraph_edge1" class="edge"><title>proc~siesta_analysis&#45;&gt;eo</title>
<path fill="none" stroke="#000000" d="M43.7534,-801.162C46.6658,-938.724 74.5637,-2198.13 121,-2260 130.065,-2272.08 145.139,-2278.58 159.364,-2282.06"/>
<polygon fill="#000000" stroke="#000000" points="158.98,-2285.55 169.475,-2284.1 160.365,-2278.69 158.98,-2285.55"/>
</g>
<!-- re_alloc -->
<g id="proc~~siesta_analysis~~CallsGraph_node3" class="node"><title>re_alloc</title>
<polygon fill="#777777" stroke="#777777" points="789,-1752 735,-1752 735,-1728 789,-1728 789,-1752"/>
<text text-anchor="middle" x="762" y="-1737.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">re_alloc</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;re_alloc -->
<g id="proc~~siesta_analysis~~CallsGraph_edge2" class="edge"><title>proc~siesta_analysis&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M43.537,-801.036C43.9786,-904.881 49.6281,-1650.73 121,-1861 182.305,-2041.61 182.769,-2208 373.5,-2208 373.5,-2208 373.5,-2208 528,-2208 623.469,-2208 649.011,-2159.33 699,-2078 732.001,-2024.31 752.76,-1829.02 759.006,-1762.43"/>
<polygon fill="#000000" stroke="#000000" points="762.515,-1762.49 759.944,-1752.21 755.544,-1761.85 762.515,-1762.49"/>
</g>
<!-- xa -->
<g id="proc~~siesta_analysis~~CallsGraph_node4" class="node"><title>xa</title>
<polygon fill="#777777" stroke="#777777" points="223.5,-1326 169.5,-1326 169.5,-1302 223.5,-1302 223.5,-1326"/>
<text text-anchor="middle" x="196.5" y="-1311.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xa</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;xa -->
<g id="proc~~siesta_analysis~~CallsGraph_edge3" class="edge"><title>proc~siesta_analysis&#45;&gt;xa</title>
<path fill="none" stroke="#000000" d="M43.6483,-801.181C44.74,-870.688 53.5403,-1216.75 121,-1293 130.579,-1303.83 145.263,-1309.26 159.071,-1311.93"/>
<polygon fill="#000000" stroke="#000000" points="158.951,-1315.45 169.359,-1313.47 159.987,-1308.52 158.951,-1315.45"/>
</g>
<!-- scell -->
<g id="proc~~siesta_analysis~~CallsGraph_node5" class="node"><title>scell</title>
<polygon fill="#777777" stroke="#777777" points="223.5,-1284 169.5,-1284 169.5,-1260 223.5,-1260 223.5,-1284"/>
<text text-anchor="middle" x="196.5" y="-1269.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">scell</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;scell -->
<g id="proc~~siesta_analysis~~CallsGraph_edge4" class="edge"><title>proc~siesta_analysis&#45;&gt;scell</title>
<path fill="none" stroke="#000000" d="M43.8295,-801.02C45.8699,-866.691 58.822,-1181.68 121,-1251 130.653,-1261.76 145.349,-1267.19 159.145,-1269.86"/>
<polygon fill="#000000" stroke="#000000" points="159.011,-1273.38 169.421,-1271.41 160.055,-1266.46 159.011,-1273.38"/>
</g>
<!-- proc~dhscf -->
<g id="proc~~siesta_analysis~~CallsGraph_node6" class="node"><title>proc~dhscf</title>
<g id="a_proc~~siesta_analysis~~CallsGraph_node6"><a xlink:href=".././proc/dhscf.html" xlink:title="dhscf">
<polygon fill="#d9534f" stroke="#d9534f" points="223.5,-1406 169.5,-1406 169.5,-1382 223.5,-1382 223.5,-1406"/>
<text text-anchor="middle" x="196.5" y="-1391.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dhscf</text>
</a>
</g>
</g>
<!-- proc~siesta_analysis&#45;&gt;proc~dhscf -->
<g id="proc~~siesta_analysis~~CallsGraph_edge5" class="edge"><title>proc~siesta_analysis&#45;&gt;proc~dhscf</title>
<path fill="none" stroke="#000000" d="M43.4553,-801.394C43.4252,-877.107 46.8175,-1277.02 121,-1368 130.474,-1379.62 145.462,-1386.06 159.519,-1389.62"/>
<polygon fill="#000000" stroke="#000000" points="158.99,-1393.08 169.498,-1391.74 160.443,-1386.24 158.99,-1393.08"/>
</g>
<!-- siesta_write_energies -->
<g id="proc~~siesta_analysis~~CallsGraph_node7" class="node"><title>siesta_write_energies</title>
<polygon fill="#777777" stroke="#777777" points="254.5,-1242 138.5,-1242 138.5,-1218 254.5,-1218 254.5,-1242"/>
<text text-anchor="middle" x="196.5" y="-1227.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_write_energies</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;siesta_write_energies -->
<g id="proc~~siesta_analysis~~CallsGraph_edge6" class="edge"><title>proc~siesta_analysis&#45;&gt;siesta_write_energies</title>
<path fill="none" stroke="#000000" d="M44.0549,-801.14C47.1428,-863.433 64.1748,-1146.67 121,-1209 123.549,-1211.8 126.439,-1214.23 129.563,-1216.35"/>
<polygon fill="#000000" stroke="#000000" points="127.875,-1219.42 138.309,-1221.26 131.3,-1213.31 127.875,-1219.42"/>
</g>
<!-- de_alloc -->
<g id="proc~~siesta_analysis~~CallsGraph_node8" class="node"><title>de_alloc</title>
<polygon fill="#777777" stroke="#777777" points="789,-1992 735,-1992 735,-1968 789,-1968 789,-1992"/>
<text text-anchor="middle" x="762" y="-1977.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">de_alloc</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;de_alloc -->
<g id="proc~~siesta_analysis~~CallsGraph_edge7" class="edge"><title>proc~siesta_analysis&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M43.7288,-801.224C46.0775,-923.035 66.8316,-1916.63 121,-2035 181.855,-2167.98 227.253,-2246 373.5,-2246 373.5,-2246 373.5,-2246 528,-2246 568.214,-2246 663.501,-2188.58 699,-2145 734.25,-2101.73 750.743,-2036.37 757.313,-2002.35"/>
<polygon fill="#000000" stroke="#000000" points="760.832,-2002.56 759.173,-1992.1 753.944,-2001.31 760.832,-2002.56"/>
</g>
<!-- timer -->
<g id="proc~~siesta_analysis~~CallsGraph_node9" class="node"><title>timer</title>
<polygon fill="#777777" stroke="#777777" points="789,-1151 735,-1151 735,-1127 789,-1127 789,-1151"/>
<text text-anchor="middle" x="762" y="-1136.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">timer</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;timer -->
<g id="proc~~siesta_analysis~~CallsGraph_edge31" class="edge"><title>proc~siesta_analysis&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M43.1941,-801.049C41.6058,-874.602 37.3123,-1262.35 121,-1335 171.68,-1378.99 223.364,-1381.24 272,-1335 329.487,-1280.34 250.513,-676.657 308,-622 444.82,-491.914 616.06,-618.404 699,-788 754.816,-902.132 760.982,-1058.96 761.235,-1116.59"/>
<polygon fill="#000000" stroke="#000000" points="757.735,-1116.75 761.22,-1126.75 764.735,-1116.76 757.735,-1116.75"/>
</g>
<!-- siesta_write_forces -->
<g id="proc~~siesta_analysis~~CallsGraph_node10" class="node"><title>siesta_write_forces</title>
<polygon fill="#777777" stroke="#777777" points="248.5,-1200 144.5,-1200 144.5,-1176 248.5,-1176 248.5,-1200"/>
<text text-anchor="middle" x="196.5" y="-1185.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_write_forces</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;siesta_write_forces -->
<g id="proc~~siesta_analysis~~CallsGraph_edge9" class="edge"><title>proc~siesta_analysis&#45;&gt;siesta_write_forces</title>
<path fill="none" stroke="#000000" d="M44.3196,-801.073C48.5174,-859.411 69.4487,-1111.57 121,-1167 125.045,-1171.35 129.915,-1174.82 135.203,-1177.59"/>
<polygon fill="#000000" stroke="#000000" points="133.862,-1180.83 144.427,-1181.62 136.664,-1174.41 133.862,-1180.83"/>
</g>
<!-- message -->
<g id="proc~~siesta_analysis~~CallsGraph_node11" class="node"><title>message</title>
<polygon fill="#777777" stroke="#777777" points="224.5,-1158 168.5,-1158 168.5,-1134 224.5,-1134 224.5,-1158"/>
<text text-anchor="middle" x="196.5" y="-1143.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">message</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;message -->
<g id="proc~~siesta_analysis~~CallsGraph_edge10" class="edge"><title>proc~siesta_analysis&#45;&gt;message</title>
<path fill="none" stroke="#000000" d="M44.6617,-801.162C50.0996,-855.616 74.7422,-1076.46 121,-1125 130.678,-1135.15 144.851,-1140.52 158.244,-1143.31"/>
<polygon fill="#000000" stroke="#000000" points="157.806,-1146.79 168.246,-1144.98 158.96,-1139.88 157.806,-1146.79"/>
</g>
<!-- fdf_boolean -->
<g id="proc~~siesta_analysis~~CallsGraph_node12" class="node"><title>fdf_boolean</title>
<polygon fill="#777777" stroke="#777777" points="231,-1116 162,-1116 162,-1092 231,-1092 231,-1116"/>
<text text-anchor="middle" x="196.5" y="-1101.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fdf_boolean</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;fdf_boolean -->
<g id="proc~~siesta_analysis~~CallsGraph_edge11" class="edge"><title>proc~siesta_analysis&#45;&gt;fdf_boolean</title>
<path fill="none" stroke="#000000" d="M45.1102,-801.308C51.9346,-851.667 80.0158,-1041.31 121,-1083 129.234,-1091.38 140.529,-1096.48 151.835,-1099.57"/>
<polygon fill="#000000" stroke="#000000" points="151.172,-1103.01 161.697,-1101.8 152.715,-1096.18 151.172,-1103.01"/>
</g>
<!-- dipol -->
<g id="proc~~siesta_analysis~~CallsGraph_node13" class="node"><title>dipol</title>
<polygon fill="#777777" stroke="#777777" points="223.5,-1074 169.5,-1074 169.5,-1050 223.5,-1050 223.5,-1074"/>
<text text-anchor="middle" x="196.5" y="-1059.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dipol</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;dipol -->
<g id="proc~~siesta_analysis~~CallsGraph_edge12" class="edge"><title>proc~siesta_analysis&#45;&gt;dipol</title>
<path fill="none" stroke="#000000" d="M43.4094,-801.03C43.7853,-841.23 50.5969,-972.24 121,-1041 131.189,-1050.95 145.711,-1056.26 159.231,-1059.07"/>
<polygon fill="#000000" stroke="#000000" points="158.844,-1062.55 169.287,-1060.76 160.007,-1055.65 158.844,-1062.55"/>
</g>
<!-- xa_last -->
<g id="proc~~siesta_analysis~~CallsGraph_node14" class="node"><title>xa_last</title>
<polygon fill="#777777" stroke="#777777" points="223.5,-1032 169.5,-1032 169.5,-1008 223.5,-1008 223.5,-1032"/>
<text text-anchor="middle" x="196.5" y="-1017.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xa_last</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;xa_last -->
<g id="proc~~siesta_analysis~~CallsGraph_edge13" class="edge"><title>proc~siesta_analysis&#45;&gt;xa_last</title>
<path fill="none" stroke="#000000" d="M44.2599,-801.026C47.1802,-836.774 60.7796,-943.347 121,-999 131.381,-1008.59 145.809,-1013.85 159.205,-1016.71"/>
<polygon fill="#000000" stroke="#000000" points="158.709,-1020.18 169.165,-1018.47 159.924,-1013.28 158.709,-1020.18"/>
</g>
<!-- print_spin -->
<g id="proc~~siesta_analysis~~CallsGraph_node15" class="node"><title>print_spin</title>
<polygon fill="#777777" stroke="#777777" points="226,-990 167,-990 167,-966 226,-966 226,-990"/>
<text text-anchor="middle" x="196.5" y="-975.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_spin</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;print_spin -->
<g id="proc~~siesta_analysis~~CallsGraph_edge14" class="edge"><title>proc~siesta_analysis&#45;&gt;print_spin</title>
<path fill="none" stroke="#000000" d="M45.5394,-801.256C51.3498,-832.235 70.9212,-914.245 121,-957 131.08,-965.606 144.452,-970.698 157.083,-973.706"/>
<polygon fill="#000000" stroke="#000000" points="156.482,-977.155 166.976,-975.699 157.864,-970.293 156.482,-977.155"/>
</g>
<!-- local_dos -->
<g id="proc~~siesta_analysis~~CallsGraph_node16" class="node"><title>local_dos</title>
<polygon fill="#777777" stroke="#777777" points="225.5,-948 167.5,-948 167.5,-924 225.5,-924 225.5,-948"/>
<text text-anchor="middle" x="196.5" y="-933.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">local_dos</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;local_dos -->
<g id="proc~~siesta_analysis~~CallsGraph_edge15" class="edge"><title>proc~siesta_analysis&#45;&gt;local_dos</title>
<path fill="none" stroke="#000000" d="M47.5197,-801.133C56.4999,-826.327 80.6339,-884.501 121,-915 131.575,-922.99 145.06,-927.941 157.644,-931.008"/>
<polygon fill="#000000" stroke="#000000" points="156.961,-934.441 167.469,-933.086 158.41,-927.592 156.961,-934.441"/>
</g>
<!-- scell_last -->
<g id="proc~~siesta_analysis~~CallsGraph_node17" class="node"><title>scell_last</title>
<polygon fill="#777777" stroke="#777777" points="224.5,-906 168.5,-906 168.5,-882 224.5,-882 224.5,-906"/>
<text text-anchor="middle" x="196.5" y="-891.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">scell_last</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;scell_last -->
<g id="proc~~siesta_analysis~~CallsGraph_edge16" class="edge"><title>proc~siesta_analysis&#45;&gt;scell_last</title>
<path fill="none" stroke="#000000" d="M51.4668,-801.266C64.0324,-819.628 90.2167,-854.119 121,-873 132.186,-879.861 145.68,-884.544 158.092,-887.711"/>
<polygon fill="#000000" stroke="#000000" points="157.659,-891.203 168.189,-890.03 159.226,-884.381 157.659,-891.203"/>
</g>
<!-- siesta_write_stress_pressure -->
<g id="proc~~siesta_analysis~~CallsGraph_node18" class="node"><title>siesta_write_stress_pressure</title>
<polygon fill="#777777" stroke="#777777" points="272,-864 121,-864 121,-840 272,-840 272,-864"/>
<text text-anchor="middle" x="196.5" y="-849.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_write_stress_pressure</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;siesta_write_stress_pressure -->
<g id="proc~~siesta_analysis~~CallsGraph_edge17" class="edge"><title>proc~siesta_analysis&#45;&gt;siesta_write_stress_pressure</title>
<path fill="none" stroke="#000000" d="M62.9795,-801.133C78.3072,-810.286 100.44,-822.652 121,-831 126.136,-833.085 131.551,-835.044 137.022,-836.862"/>
<polygon fill="#000000" stroke="#000000" points="136.292,-840.302 146.882,-839.981 138.403,-833.628 136.292,-840.302"/>
</g>
<!-- pexsi_local_dos -->
<g id="proc~~siesta_analysis~~CallsGraph_node19" class="node"><title>pexsi_local_dos</title>
<polygon fill="#777777" stroke="#777777" points="240.5,-822 152.5,-822 152.5,-798 240.5,-798 240.5,-822"/>
<text text-anchor="middle" x="196.5" y="-807.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pexsi_local_dos</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;pexsi_local_dos -->
<g id="proc~~siesta_analysis~~CallsGraph_edge18" class="edge"><title>proc~siesta_analysis&#45;&gt;pexsi_local_dos</title>
<path fill="none" stroke="#000000" d="M85.0347,-794.738C102.768,-797.188 123.677,-800.077 142.506,-802.678"/>
<polygon fill="#000000" stroke="#000000" points="142.041,-806.147 152.426,-804.049 142.999,-799.213 142.041,-806.147"/>
</g>
<!-- projected_dos -->
<g id="proc~~siesta_analysis~~CallsGraph_node20" class="node"><title>projected_dos</title>
<polygon fill="#777777" stroke="#777777" points="236.5,-780 156.5,-780 156.5,-756 236.5,-756 236.5,-780"/>
<text text-anchor="middle" x="196.5" y="-765.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">projected_dos</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;projected_dos -->
<g id="proc~~siesta_analysis~~CallsGraph_edge19" class="edge"><title>proc~siesta_analysis&#45;&gt;projected_dos</title>
<path fill="none" stroke="#000000" d="M85.0347,-783.262C103.972,-780.645 126.532,-777.529 146.312,-774.796"/>
<polygon fill="#000000" stroke="#000000" points="146.942,-778.242 156.369,-773.406 145.984,-771.308 146.942,-778.242"/>
</g>
<!-- slua_call -->
<g id="proc~~siesta_analysis~~CallsGraph_node21" class="node"><title>slua_call</title>
<polygon fill="#777777" stroke="#777777" points="223.5,-738 169.5,-738 169.5,-714 223.5,-714 223.5,-738"/>
<text text-anchor="middle" x="196.5" y="-723.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">slua_call</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;slua_call -->
<g id="proc~~siesta_analysis~~CallsGraph_edge20" class="edge"><title>proc~siesta_analysis&#45;&gt;slua_call</title>
<path fill="none" stroke="#000000" d="M62.9795,-776.867C78.3072,-767.714 100.44,-755.348 121,-747 133.159,-742.063 146.883,-737.837 159.208,-734.497"/>
<polygon fill="#000000" stroke="#000000" points="160.371,-737.811 169.167,-731.905 158.608,-731.037 160.371,-737.811"/>
</g>
<!-- write_basis_enthalpy -->
<g id="proc~~siesta_analysis~~CallsGraph_node22" class="node"><title>write_basis_enthalpy</title>
<polygon fill="#777777" stroke="#777777" points="252.5,-696 140.5,-696 140.5,-672 252.5,-672 252.5,-696"/>
<text text-anchor="middle" x="196.5" y="-681.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_basis_enthalpy</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;write_basis_enthalpy -->
<g id="proc~~siesta_analysis~~CallsGraph_edge21" class="edge"><title>proc~siesta_analysis&#45;&gt;write_basis_enthalpy</title>
<path fill="none" stroke="#000000" d="M51.4668,-776.734C64.0324,-758.372 90.2167,-723.881 121,-705 124.164,-703.059 127.513,-701.292 130.97,-699.685"/>
<polygon fill="#000000" stroke="#000000" points="132.434,-702.867 140.32,-695.793 129.743,-696.405 132.434,-702.867"/>
</g>
<!-- barrier -->
<g id="proc~~siesta_analysis~~CallsGraph_node23" class="node"><title>barrier</title>
<polygon fill="#777777" stroke="#777777" points="223.5,-654 169.5,-654 169.5,-630 223.5,-630 223.5,-654"/>
<text text-anchor="middle" x="196.5" y="-639.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">barrier</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;barrier -->
<g id="proc~~siesta_analysis~~CallsGraph_edge22" class="edge"><title>proc~siesta_analysis&#45;&gt;barrier</title>
<path fill="none" stroke="#000000" d="M47.5197,-776.867C56.4999,-751.673 80.6339,-693.499 121,-663 131.998,-654.69 146.144,-649.668 159.149,-646.633"/>
<polygon fill="#000000" stroke="#000000" points="160.139,-650.004 169.253,-644.6 158.759,-643.142 160.139,-650.004"/>
</g>
<!-- bands -->
<g id="proc~~siesta_analysis~~CallsGraph_node24" class="node"><title>bands</title>
<polygon fill="#777777" stroke="#777777" points="223.5,-612 169.5,-612 169.5,-588 223.5,-588 223.5,-612"/>
<text text-anchor="middle" x="196.5" y="-597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bands</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;bands -->
<g id="proc~~siesta_analysis~~CallsGraph_edge23" class="edge"><title>proc~siesta_analysis&#45;&gt;bands</title>
<path fill="none" stroke="#000000" d="M45.5394,-776.744C51.3498,-745.765 70.9212,-663.755 121,-621 131.75,-611.822 146.244,-606.641 159.59,-603.722"/>
<polygon fill="#000000" stroke="#000000" points="160.289,-607.152 169.491,-601.901 159.023,-600.267 160.289,-607.152"/>
</g>
<!-- bk -->
<g id="proc~~siesta_analysis~~CallsGraph_node25" class="node"><title>bk</title>
<polygon fill="#777777" stroke="#777777" points="223.5,-570 169.5,-570 169.5,-546 223.5,-546 223.5,-570"/>
<text text-anchor="middle" x="196.5" y="-555.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bk</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;bk -->
<g id="proc~~siesta_analysis~~CallsGraph_edge24" class="edge"><title>proc~siesta_analysis&#45;&gt;bk</title>
<path fill="none" stroke="#000000" d="M44.2599,-776.974C47.1802,-741.226 60.7796,-634.653 121,-579 131.381,-569.406 145.809,-564.151 159.205,-561.289"/>
<polygon fill="#000000" stroke="#000000" points="159.924,-564.716 169.165,-559.534 158.709,-557.822 159.924,-564.716"/>
</g>
<!-- optical -->
<g id="proc~~siesta_analysis~~CallsGraph_node26" class="node"><title>optical</title>
<polygon fill="#777777" stroke="#777777" points="223.5,-528 169.5,-528 169.5,-504 223.5,-504 223.5,-528"/>
<text text-anchor="middle" x="196.5" y="-513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">optical</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;optical -->
<g id="proc~~siesta_analysis~~CallsGraph_edge25" class="edge"><title>proc~siesta_analysis&#45;&gt;optical</title>
<path fill="none" stroke="#000000" d="M43.4094,-776.97C43.7853,-736.77 50.5969,-605.76 121,-537 131.189,-527.049 145.711,-521.738 159.231,-518.931"/>
<polygon fill="#000000" stroke="#000000" points="160.007,-522.349 169.287,-517.237 158.844,-515.447 160.007,-522.349"/>
</g>
<!-- pexsi_dos -->
<g id="proc~~siesta_analysis~~CallsGraph_node27" class="node"><title>pexsi_dos</title>
<polygon fill="#777777" stroke="#777777" points="227,-486 166,-486 166,-462 227,-462 227,-486"/>
<text text-anchor="middle" x="196.5" y="-471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pexsi_dos</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;pexsi_dos -->
<g id="proc~~siesta_analysis~~CallsGraph_edge26" class="edge"><title>proc~siesta_analysis&#45;&gt;pexsi_dos</title>
<path fill="none" stroke="#000000" d="M45.1102,-776.692C51.9346,-726.333 80.0158,-536.687 121,-495 130.218,-485.624 143.272,-480.347 155.884,-477.406"/>
<polygon fill="#000000" stroke="#000000" points="156.653,-480.823 165.822,-475.515 155.344,-473.946 156.653,-480.823"/>
</g>
<!-- cmladdproperty -->
<g id="proc~~siesta_analysis~~CallsGraph_node28" class="node"><title>cmladdproperty</title>
<polygon fill="#777777" stroke="#777777" points="240,-444 153,-444 153,-420 240,-420 240,-444"/>
<text text-anchor="middle" x="196.5" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cmladdproperty</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;cmladdproperty -->
<g id="proc~~siesta_analysis~~CallsGraph_edge27" class="edge"><title>proc~siesta_analysis&#45;&gt;cmladdproperty</title>
<path fill="none" stroke="#000000" d="M44.6617,-776.838C50.0996,-722.384 74.7422,-501.536 121,-453 126.997,-446.707 134.72,-442.254 142.914,-439.112"/>
<polygon fill="#000000" stroke="#000000" points="144.214,-442.372 152.675,-435.995 142.084,-435.703 144.214,-442.372"/>
</g>
<!-- cmlstartmodule -->
<g id="proc~~siesta_analysis~~CallsGraph_node29" class="node"><title>cmlstartmodule</title>
<polygon fill="#777777" stroke="#777777" points="239,-402 154,-402 154,-378 239,-378 239,-402"/>
<text text-anchor="middle" x="196.5" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cmlstartmodule</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;cmlstartmodule -->
<g id="proc~~siesta_analysis~~CallsGraph_edge28" class="edge"><title>proc~siesta_analysis&#45;&gt;cmlstartmodule</title>
<path fill="none" stroke="#000000" d="M44.3196,-776.927C48.5174,-718.589 69.4487,-466.433 121,-411 127.184,-404.351 135.293,-399.749 143.881,-396.576"/>
<polygon fill="#000000" stroke="#000000" points="145.166,-399.843 153.704,-393.569 143.117,-393.15 145.166,-399.843"/>
</g>
<!-- outcoor -->
<g id="proc~~siesta_analysis~~CallsGraph_node30" class="node"><title>outcoor</title>
<polygon fill="#777777" stroke="#777777" points="223.5,-360 169.5,-360 169.5,-336 223.5,-336 223.5,-360"/>
<text text-anchor="middle" x="196.5" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">outcoor</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;outcoor -->
<g id="proc~~siesta_analysis~~CallsGraph_edge29" class="edge"><title>proc~siesta_analysis&#45;&gt;outcoor</title>
<path fill="none" stroke="#000000" d="M44.0549,-776.86C47.1428,-714.567 64.1748,-431.327 121,-369 130.74,-358.317 145.45,-352.904 159.233,-350.219"/>
<polygon fill="#000000" stroke="#000000" points="160.136,-353.622 169.494,-348.655 159.081,-346.702 160.136,-353.622"/>
</g>
<!-- die -->
<g id="proc~~siesta_analysis~~CallsGraph_node31" class="node"><title>die</title>
<polygon fill="#777777" stroke="#777777" points="683,-2069 629,-2069 629,-2045 683,-2045 683,-2069"/>
<text text-anchor="middle" x="656" y="-2054.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">die</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;die -->
<g id="proc~~siesta_analysis~~CallsGraph_edge30" class="edge"><title>proc~siesta_analysis&#45;&gt;die</title>
<path fill="none" stroke="#000000" d="M43.8717,-801.008C47.9161,-922.829 87.9756,-1934.13 308,-2109 401.619,-2183.41 463.474,-2152.58 577,-2115 599.979,-2107.39 621.695,-2090.1 636.349,-2076.37"/>
<polygon fill="#000000" stroke="#000000" points="639.002,-2078.67 643.727,-2069.19 634.119,-2073.65 639.002,-2078.67"/>
</g>
<!-- fdf_get -->
<g id="proc~~siesta_analysis~~CallsGraph_node32" class="node"><title>fdf_get</title>
<polygon fill="#777777" stroke="#777777" points="223.5,-318 169.5,-318 169.5,-294 223.5,-294 223.5,-318"/>
<text text-anchor="middle" x="196.5" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fdf_get</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;fdf_get -->
<g id="proc~~siesta_analysis~~CallsGraph_edge8" class="edge"><title>proc~siesta_analysis&#45;&gt;fdf_get</title>
<path fill="none" stroke="#000000" d="M43.8295,-776.98C45.8699,-711.309 58.822,-396.322 121,-327 130.653,-316.238 145.349,-310.813 159.145,-308.139"/>
<polygon fill="#000000" stroke="#000000" points="160.055,-311.542 169.421,-306.588 159.011,-304.62 160.055,-311.542"/>
</g>
<!-- setup_wfs_list -->
<g id="proc~~siesta_analysis~~CallsGraph_node33" class="node"><title>setup_wfs_list</title>
<polygon fill="#777777" stroke="#777777" points="236,-276 157,-276 157,-252 236,-252 236,-276"/>
<text text-anchor="middle" x="196.5" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_wfs_list</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;setup_wfs_list -->
<g id="proc~~siesta_analysis~~CallsGraph_edge32" class="edge"><title>proc~siesta_analysis&#45;&gt;setup_wfs_list</title>
<path fill="none" stroke="#000000" d="M43.6483,-776.819C44.74,-707.312 53.5403,-361.25 121,-285 127.812,-277.301 137.205,-272.328 147.029,-269.139"/>
<polygon fill="#000000" stroke="#000000" points="148.152,-272.462 156.917,-266.51 146.353,-265.697 148.152,-272.462"/>
</g>
<!-- siesta_write_positions -->
<g id="proc~~siesta_analysis~~CallsGraph_node34" class="node"><title>siesta_write_positions</title>
<polygon fill="#777777" stroke="#777777" points="255,-234 138,-234 138,-210 255,-210 255,-234"/>
<text text-anchor="middle" x="196.5" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_write_positions</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;siesta_write_positions -->
<g id="proc~~siesta_analysis~~CallsGraph_edge33" class="edge"><title>proc~siesta_analysis&#45;&gt;siesta_write_positions</title>
<path fill="none" stroke="#000000" d="M43.4903,-776.777C43.6802,-703.825 48.207,-326.244 121,-243 123.372,-240.288 126.064,-237.913 128.984,-235.835"/>
<polygon fill="#000000" stroke="#000000" points="130.86,-238.793 137.736,-230.732 127.334,-232.746 130.86,-238.793"/>
</g>
<!-- ksv_pol -->
<g id="proc~~siesta_analysis~~CallsGraph_node35" class="node"><title>ksv_pol</title>
<polygon fill="#777777" stroke="#777777" points="223.5,-192 169.5,-192 169.5,-168 223.5,-168 223.5,-192"/>
<text text-anchor="middle" x="196.5" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ksv_pol</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;ksv_pol -->
<g id="proc~~siesta_analysis~~CallsGraph_edge34" class="edge"><title>proc~siesta_analysis&#45;&gt;ksv_pol</title>
<path fill="none" stroke="#000000" d="M43.3545,-776.846C42.692,-700.85 42.8237,-291.303 121,-201 130.555,-189.963 145.416,-184.512 159.359,-181.893"/>
<polygon fill="#000000" stroke="#000000" points="159.871,-185.355 169.261,-180.447 158.86,-178.429 159.871,-185.355"/>
</g>
<!-- ucell -->
<g id="proc~~siesta_analysis~~CallsGraph_node36" class="node"><title>ucell</title>
<polygon fill="#777777" stroke="#777777" points="223.5,-150 169.5,-150 169.5,-126 223.5,-126 223.5,-150"/>
<text text-anchor="middle" x="196.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ucell</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;ucell -->
<g id="proc~~siesta_analysis~~CallsGraph_edge35" class="edge"><title>proc~siesta_analysis&#45;&gt;ucell</title>
<path fill="none" stroke="#000000" d="M43.235,-776.763C41.7675,-697.44 37.4814,-256.321 121,-159 130.507,-147.922 145.361,-142.464 159.311,-139.852"/>
<polygon fill="#000000" stroke="#000000" points="159.828,-143.314 169.221,-138.413 158.822,-136.386 159.828,-143.314"/>
</g>
<!-- ucell_last -->
<g id="proc~~siesta_analysis~~CallsGraph_node37" class="node"><title>ucell_last</title>
<polygon fill="#777777" stroke="#777777" points="225,-108 168,-108 168,-84 225,-84 225,-108"/>
<text text-anchor="middle" x="196.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ucell_last</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;ucell_last -->
<g id="proc~~siesta_analysis~~CallsGraph_edge36" class="edge"><title>proc~siesta_analysis&#45;&gt;ucell_last</title>
<path fill="none" stroke="#000000" d="M44.0896,-776.963C48.4135,-690.779 76.3131,-169.473 121,-117 130.095,-106.32 144.161,-100.858 157.631,-98.1347"/>
<polygon fill="#000000" stroke="#000000" points="158.39,-101.558 167.723,-96.5448 157.3,-94.6437 158.39,-101.558"/>
</g>
<!-- read_spmatrix -->
<g id="proc~~siesta_analysis~~CallsGraph_node38" class="node"><title>read_spmatrix</title>
<polygon fill="#777777" stroke="#777777" points="237,-66 156,-66 156,-42 237,-42 237,-66"/>
<text text-anchor="middle" x="196.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">read_spmatrix</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;read_spmatrix -->
<g id="proc~~siesta_analysis~~CallsGraph_edge37" class="edge"><title>proc~siesta_analysis&#45;&gt;read_spmatrix</title>
<path fill="none" stroke="#000000" d="M44.0115,-776.791C47.8771,-687.021 73.642,-130.988 121,-75 127.509,-67.3051 136.598,-62.3164 146.198,-59.1088"/>
<polygon fill="#000000" stroke="#000000" points="147.166,-62.4725 155.89,-56.4607 145.321,-55.72 147.166,-62.4725"/>
</g>
<!-- wwave -->
<g id="proc~~siesta_analysis~~CallsGraph_node39" class="node"><title>wwave</title>
<polygon fill="#777777" stroke="#777777" points="223.5,-24 169.5,-24 169.5,-0 223.5,-0 223.5,-24"/>
<text text-anchor="middle" x="196.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">wwave</text>
</g>
<!-- proc~siesta_analysis&#45;&gt;wwave -->
<g id="proc~~siesta_analysis~~CallsGraph_edge38" class="edge"><title>proc~siesta_analysis&#45;&gt;wwave</title>
<path fill="none" stroke="#000000" d="M43.9279,-776.969C47.3091,-684.799 70.9055,-92.5829 121,-33 130.464,-21.7435 145.451,-16.2734 159.51,-13.6995"/>
<polygon fill="#000000" stroke="#000000" points="160.075,-17.1545 169.49,-12.2959 159.1,-10.2227 160.075,-17.1545"/>
</g>
<!-- proc~dhscf&#45;&gt;re_alloc -->
<g id="proc~~siesta_analysis~~CallsGraph_edge40" class="edge"><title>proc~dhscf&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M214.183,-1406.06C235.058,-1420.52 272.402,-1444.4 308,-1457 473.998,-1515.76 567.615,-1403.76 699,-1521 756.621,-1572.42 762.398,-1672.97 761.907,-1717.66"/>
<polygon fill="#000000" stroke="#000000" points="758.405,-1717.68 761.674,-1727.76 765.403,-1717.84 758.405,-1717.68"/>
</g>
<!-- proc~dhscf&#45;&gt;de_alloc -->
<g id="proc~~siesta_analysis~~CallsGraph_edge72" class="edge"><title>proc~dhscf&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M197.378,-1406.21C196.79,-1492.62 197.911,-2011.18 308,-2109 438.31,-2224.79 560.286,-2183.58 699,-2078 725.118,-2058.12 743.115,-2023.82 752.742,-2001.52"/>
<polygon fill="#000000" stroke="#000000" points="756.002,-2002.8 756.576,-1992.22 749.53,-2000.13 756.002,-2002.8"/>
</g>
<!-- proc~dhscf&#45;&gt;timer -->
<g id="proc~~siesta_analysis~~CallsGraph_edge68" class="edge"><title>proc~dhscf&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M223.533,-1392.11C240.202,-1389.41 260.747,-1383.02 272,-1368 319.031,-1305.23 251.141,-717.029 308,-663 398.795,-576.723 493.645,-653.516 577,-747 681.999,-864.759 738.5,-1052.88 755.456,-1116.86"/>
<polygon fill="#000000" stroke="#000000" points="752.104,-1117.88 758.003,-1126.69 758.88,-1116.13 752.104,-1117.88"/>
</g>
<!-- proc~dhscf&#45;&gt;die -->
<g id="proc~~siesta_analysis~~CallsGraph_edge67" class="edge"><title>proc~dhscf&#45;&gt;die</title>
<path fill="none" stroke="#000000" d="M197.443,-1406.21C197.331,-1490.41 201.267,-1984.19 308,-2075 396.896,-2150.63 549.634,-2101.66 618.931,-2073.23"/>
<polygon fill="#000000" stroke="#000000" points="620.665,-2076.3 628.532,-2069.2 617.957,-2069.84 620.665,-2076.3"/>
</g>
<!-- elecs -->
<g id="proc~~siesta_analysis~~CallsGraph_node40" class="node"><title>elecs</title>
<polygon fill="#777777" stroke="#777777" points="401.5,-1200 347.5,-1200 347.5,-1176 401.5,-1176 401.5,-1200"/>
<text text-anchor="middle" x="374.5" y="-1185.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elecs</text>
</g>
<!-- proc~dhscf&#45;&gt;elecs -->
<g id="proc~~siesta_analysis~~CallsGraph_edge44" class="edge"><title>proc~dhscf&#45;&gt;elecs</title>
<path fill="none" stroke="#000000" d="M223.803,-1391.24C239.935,-1388.17 259.774,-1381.69 272,-1368 320.256,-1313.95 259.059,-1262.43 308,-1209 315.658,-1200.64 326.644,-1195.59 337.437,-1192.55"/>
<polygon fill="#000000" stroke="#000000" points="338.245,-1195.96 347.193,-1190.28 336.66,-1189.14 338.245,-1195.96"/>
</g>
<!-- ts_voltage -->
<g id="proc~~siesta_analysis~~CallsGraph_node41" class="node"><title>ts_voltage</title>
<polygon fill="#777777" stroke="#777777" points="405,-1158 344,-1158 344,-1134 405,-1134 405,-1158"/>
<text text-anchor="middle" x="374.5" y="-1143.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ts_voltage</text>
</g>
<!-- proc~dhscf&#45;&gt;ts_voltage -->
<g id="proc~~siesta_analysis~~CallsGraph_edge41" class="edge"><title>proc~dhscf&#45;&gt;ts_voltage</title>
<path fill="none" stroke="#000000" d="M223.655,-1391.5C239.938,-1388.53 260,-1382.07 272,-1368 330.89,-1298.95 248.234,-1235.3 308,-1167 314.724,-1159.32 324.263,-1154.42 333.986,-1151.31"/>
<polygon fill="#000000" stroke="#000000" points="334.896,-1154.69 343.673,-1148.76 333.112,-1147.92 334.896,-1154.69"/>
</g>
<!-- dfscf -->
<g id="proc~~siesta_analysis~~CallsGraph_node42" class="node"><title>dfscf</title>
<polygon fill="#777777" stroke="#777777" points="401.5,-1116 347.5,-1116 347.5,-1092 401.5,-1092 401.5,-1116"/>
<text text-anchor="middle" x="374.5" y="-1101.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dfscf</text>
</g>
<!-- proc~dhscf&#45;&gt;dfscf -->
<g id="proc~~siesta_analysis~~CallsGraph_edge61" class="edge"><title>proc~dhscf&#45;&gt;dfscf</title>
<path fill="none" stroke="#000000" d="M223.798,-1391.62C240.14,-1388.7 260.213,-1382.25 272,-1368 341.585,-1283.87 237.348,-1208.24 308,-1125 315.396,-1116.29 326.416,-1111.15 337.317,-1108.14"/>
<polygon fill="#000000" stroke="#000000" points="338.195,-1111.53 347.187,-1105.93 336.664,-1104.7 338.195,-1111.53"/>
</g>
<!-- ts_hartree_fix -->
<g id="proc~~siesta_analysis~~CallsGraph_node43" class="node"><title>ts_hartree_fix</title>
<polygon fill="#777777" stroke="#777777" points="413.5,-1074 335.5,-1074 335.5,-1050 413.5,-1050 413.5,-1074"/>
<text text-anchor="middle" x="374.5" y="-1059.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ts_hartree_fix</text>
</g>
<!-- proc~dhscf&#45;&gt;ts_hartree_fix -->
<g id="proc~~siesta_analysis~~CallsGraph_edge43" class="edge"><title>proc~dhscf&#45;&gt;ts_hartree_fix</title>
<path fill="none" stroke="#000000" d="M223.537,-1391.76C239.987,-1388.92 260.28,-1382.48 272,-1368 352.313,-1268.75 226.427,-1181.22 308,-1083 312.721,-1077.32 318.986,-1073.15 325.773,-1070.11"/>
<polygon fill="#000000" stroke="#000000" points="327.086,-1073.35 335.256,-1066.61 324.663,-1066.79 327.086,-1073.35"/>
</g>
<!-- volcel -->
<g id="proc~~siesta_analysis~~CallsGraph_node44" class="node"><title>volcel</title>
<polygon fill="#777777" stroke="#777777" points="401.5,-1032 347.5,-1032 347.5,-1008 401.5,-1008 401.5,-1032"/>
<text text-anchor="middle" x="374.5" y="-1017.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">volcel</text>
</g>
<!-- proc~dhscf&#45;&gt;volcel -->
<g id="proc~~siesta_analysis~~CallsGraph_edge39" class="edge"><title>proc~dhscf&#45;&gt;volcel</title>
<path fill="none" stroke="#000000" d="M223.614,-1391.83C240.096,-1389 260.397,-1382.58 272,-1368 363.063,-1253.61 215.485,-1154.22 308,-1041 315.289,-1032.08 326.386,-1026.9 337.386,-1023.91"/>
<polygon fill="#000000" stroke="#000000" points="338.325,-1027.29 347.348,-1021.73 336.831,-1020.45 338.325,-1027.29"/>
</g>
<!-- ddot -->
<g id="proc~~siesta_analysis~~CallsGraph_node45" class="node"><title>ddot</title>
<polygon fill="#777777" stroke="#777777" points="401.5,-990 347.5,-990 347.5,-966 401.5,-966 401.5,-990"/>
<text text-anchor="middle" x="374.5" y="-975.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ddot</text>
</g>
<!-- proc~dhscf&#45;&gt;ddot -->
<g id="proc~~siesta_analysis~~CallsGraph_edge45" class="edge"><title>proc~dhscf&#45;&gt;ddot</title>
<path fill="none" stroke="#000000" d="M223.673,-1391.87C240.181,-1389.07 260.487,-1382.65 272,-1368 373.825,-1238.45 204.53,-1127.24 308,-999 315.234,-990.034 326.317,-984.844 337.321,-981.856"/>
<polygon fill="#000000" stroke="#000000" points="338.265,-985.233 347.292,-979.687 336.776,-978.393 338.265,-985.233"/>
</g>
<!-- jms_setmeshdistr -->
<g id="proc~~siesta_analysis~~CallsGraph_node46" class="node"><title>jms_setmeshdistr</title>
<polygon fill="#777777" stroke="#777777" points="422.5,-948 326.5,-948 326.5,-924 422.5,-924 422.5,-948"/>
<text text-anchor="middle" x="374.5" y="-933.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jms_setmeshdistr</text>
</g>
<!-- proc~dhscf&#45;&gt;jms_setmeshdistr -->
<g id="proc~~siesta_analysis~~CallsGraph_edge46" class="edge"><title>proc~dhscf&#45;&gt;jms_setmeshdistr</title>
<path fill="none" stroke="#000000" d="M223.721,-1391.91C240.249,-1389.12 260.56,-1382.7 272,-1368 328.299,-1295.64 250.782,-1028.64 308,-957 310.683,-953.641 313.907,-950.811 317.466,-948.429"/>
<polygon fill="#000000" stroke="#000000" points="319.165,-951.489 326.283,-943.642 315.825,-945.337 319.165,-951.489"/>
</g>
<!-- mpitrace_restart -->
<g id="proc~~siesta_analysis~~CallsGraph_node47" class="node"><title>mpitrace_restart</title>
<polygon fill="#777777" stroke="#777777" points="420,-906 329,-906 329,-882 420,-882 420,-906"/>
<text text-anchor="middle" x="374.5" y="-891.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpitrace_restart</text>
</g>
<!-- proc~dhscf&#45;&gt;mpitrace_restart -->
<g id="proc~~siesta_analysis~~CallsGraph_edge47" class="edge"><title>proc~dhscf&#45;&gt;mpitrace_restart</title>
<path fill="none" stroke="#000000" d="M223.76,-1391.94C240.304,-1389.17 260.619,-1382.75 272,-1368 333.688,-1288.05 245.297,-994.158 308,-915 311.253,-910.893 315.315,-907.577 319.813,-904.901"/>
<polygon fill="#000000" stroke="#000000" points="321.424,-908.01 328.903,-900.506 318.377,-901.708 321.424,-908.01"/>
</g>
<!-- bsc_cellxc -->
<g id="proc~~siesta_analysis~~CallsGraph_node48" class="node"><title>bsc_cellxc</title>
<polygon fill="#777777" stroke="#777777" points="405,-864 344,-864 344,-840 405,-840 405,-864"/>
<text text-anchor="middle" x="374.5" y="-849.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bsc_cellxc</text>
</g>
<!-- proc~dhscf&#45;&gt;bsc_cellxc -->
<g id="proc~~siesta_analysis~~CallsGraph_edge48" class="edge"><title>proc~dhscf&#45;&gt;bsc_cellxc</title>
<path fill="none" stroke="#000000" d="M223.793,-1391.97C240.351,-1389.2 260.669,-1382.79 272,-1368 339.08,-1280.45 239.808,-959.683 308,-873 314.424,-864.835 324.046,-859.794 333.951,-856.697"/>
<polygon fill="#000000" stroke="#000000" points="335.001,-860.042 343.843,-854.204 333.29,-853.254 335.001,-860.042"/>
</g>
<!-- write_grid_netcdf -->
<g id="proc~~siesta_analysis~~CallsGraph_node49" class="node"><title>write_grid_netcdf</title>
<polygon fill="#777777" stroke="#777777" points="421.5,-822 327.5,-822 327.5,-798 421.5,-798 421.5,-822"/>
<text text-anchor="middle" x="374.5" y="-807.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_grid_netcdf</text>
</g>
<!-- proc~dhscf&#45;&gt;write_grid_netcdf -->
<g id="proc~~siesta_analysis~~CallsGraph_edge49" class="edge"><title>proc~dhscf&#45;&gt;write_grid_netcdf</title>
<path fill="none" stroke="#000000" d="M223.821,-1391.99C240.39,-1389.23 260.71,-1382.82 272,-1368 344.474,-1272.86 234.318,-925.209 308,-831 310.85,-827.356 314.336,-824.335 318.202,-821.83"/>
<polygon fill="#000000" stroke="#000000" points="319.937,-824.873 327.171,-817.132 316.689,-818.672 319.937,-824.873"/>
</g>
<!-- proc~setmeshdistr -->
<g id="proc~~siesta_analysis~~CallsGraph_node50" class="node"><title>proc~setmeshdistr</title>
<g id="a_proc~~siesta_analysis~~CallsGraph_node50"><a xlink:href=".././proc/setmeshdistr.html" xlink:title="setMeshDistr">
<polygon fill="#d9534f" stroke="#d9534f" points="412,-780 337,-780 337,-756 412,-756 412,-780"/>
<text text-anchor="middle" x="374.5" y="-765.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setMeshDistr</text>
</a>
</g>
</g>
<!-- proc~dhscf&#45;&gt;proc~setmeshdistr -->
<g id="proc~~siesta_analysis~~CallsGraph_edge50" class="edge"><title>proc~dhscf&#45;&gt;proc~setmeshdistr</title>
<path fill="none" stroke="#000000" d="M223.844,-1392C240.424,-1389.26 260.746,-1382.85 272,-1368 349.87,-1265.26 228.826,-890.738 308,-789 312.95,-782.639 319.844,-778.172 327.312,-775.043"/>
<polygon fill="#000000" stroke="#000000" points="328.637,-778.289 336.975,-771.753 326.381,-771.663 328.637,-778.289"/>
</g>
<!-- rhoofd -->
<g id="proc~~siesta_analysis~~CallsGraph_node51" class="node"><title>rhoofd</title>
<polygon fill="#777777" stroke="#777777" points="401.5,-738 347.5,-738 347.5,-714 401.5,-714 401.5,-738"/>
<text text-anchor="middle" x="374.5" y="-723.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rhoofd</text>
</g>
<!-- proc~dhscf&#45;&gt;rhoofd -->
<g id="proc~~siesta_analysis~~CallsGraph_edge54" class="edge"><title>proc~dhscf&#45;&gt;rhoofd</title>
<path fill="none" stroke="#000000" d="M223.865,-1392.02C240.453,-1389.28 260.777,-1382.87 272,-1368 355.266,-1257.66 223.333,-856.268 308,-747 315.112,-737.822 326.271,-732.586 337.376,-729.622"/>
<polygon fill="#000000" stroke="#000000" points="338.384,-732.986 347.442,-727.491 336.934,-726.138 338.384,-732.986"/>
</g>
<!-- bye -->
<g id="proc~~siesta_analysis~~CallsGraph_node52" class="node"><title>bye</title>
<polygon fill="#777777" stroke="#777777" points="401.5,-696 347.5,-696 347.5,-672 401.5,-672 401.5,-696"/>
<text text-anchor="middle" x="374.5" y="-681.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bye</text>
</g>
<!-- proc~dhscf&#45;&gt;bye -->
<g id="proc~~siesta_analysis~~CallsGraph_edge51" class="edge"><title>proc~dhscf&#45;&gt;bye</title>
<path fill="none" stroke="#000000" d="M223.517,-1392.09C240.179,-1389.39 260.722,-1383 272,-1368 360.664,-1250.06 217.839,-821.799 308,-705 315.095,-695.809 326.25,-690.57 337.357,-687.607"/>
<polygon fill="#000000" stroke="#000000" points="338.366,-690.971 347.426,-685.478 336.918,-684.123 338.366,-690.971"/>
</g>
<!-- get_field_from_dipole -->
<g id="proc~~siesta_analysis~~CallsGraph_node53" class="node"><title>get_field_from_dipole</title>
<polygon fill="#777777" stroke="#777777" points="432,-2066 317,-2066 317,-2042 432,-2042 432,-2066"/>
<text text-anchor="middle" x="374.5" y="-2051.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_field_from_dipole</text>
</g>
<!-- proc~dhscf&#45;&gt;get_field_from_dipole -->
<g id="proc~~siesta_analysis~~CallsGraph_edge52" class="edge"><title>proc~dhscf&#45;&gt;get_field_from_dipole</title>
<path fill="none" stroke="#000000" d="M197.931,-1406.15C200.996,-1485.88 221.921,-1934.04 308,-2033 308.86,-2033.99 309.766,-2034.93 310.713,-2035.83"/>
<polygon fill="#000000" stroke="#000000" points="308.606,-2038.62 318.686,-2041.89 312.842,-2033.05 308.606,-2038.62"/>
</g>
<!-- vmatsp -->
<g id="proc~~siesta_analysis~~CallsGraph_node54" class="node"><title>vmatsp</title>
<polygon fill="#777777" stroke="#777777" points="401.5,-2024 347.5,-2024 347.5,-2000 401.5,-2000 401.5,-2024"/>
<text text-anchor="middle" x="374.5" y="-2009.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">vmatsp</text>
</g>
<!-- proc~dhscf&#45;&gt;vmatsp -->
<g id="proc~~siesta_analysis~~CallsGraph_edge53" class="edge"><title>proc~dhscf&#45;&gt;vmatsp</title>
<path fill="none" stroke="#000000" d="M198.101,-1406.34C202.1,-1483.48 227.213,-1899.22 308,-1991 315.551,-1999.58 326.61,-2004.68 337.5,-2007.7"/>
<polygon fill="#000000" stroke="#000000" points="336.82,-2011.14 347.347,-2009.93 338.368,-2004.31 336.82,-2011.14"/>
</g>
<!-- add_potential_from_field -->
<g id="proc~~siesta_analysis~~CallsGraph_node55" class="node"><title>add_potential_from_field</title>
<polygon fill="#777777" stroke="#777777" points="439.5,-1982 309.5,-1982 309.5,-1958 439.5,-1958 439.5,-1982"/>
<text text-anchor="middle" x="374.5" y="-1967.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">add_potential_from_field</text>
</g>
<!-- proc~dhscf&#45;&gt;add_potential_from_field -->
<g id="proc~~siesta_analysis~~CallsGraph_edge56" class="edge"><title>proc~dhscf&#45;&gt;add_potential_from_field</title>
<path fill="none" stroke="#000000" d="M198.294,-1406.42C203.273,-1480.57 232.452,-1864.33 308,-1949 308.894,-1950 309.837,-1950.96 310.821,-1951.87"/>
<polygon fill="#000000" stroke="#000000" points="308.97,-1954.85 319.09,-1957.99 313.136,-1949.23 308.97,-1954.85"/>
</g>
<!-- hartree_add -->
<g id="proc~~siesta_analysis~~CallsGraph_node56" class="node"><title>hartree_add</title>
<polygon fill="#777777" stroke="#777777" points="410,-1940 339,-1940 339,-1916 410,-1916 410,-1940"/>
<text text-anchor="middle" x="374.5" y="-1925.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hartree_add</text>
</g>
<!-- proc~dhscf&#45;&gt;hartree_add -->
<g id="proc~~siesta_analysis~~CallsGraph_edge55" class="edge"><title>proc~dhscf&#45;&gt;hartree_add</title>
<path fill="none" stroke="#000000" d="M198.511,-1406.4C204.513,-1477.14 237.637,-1829.37 308,-1907 313.645,-1913.23 321.136,-1917.62 329.033,-1920.71"/>
<polygon fill="#000000" stroke="#000000" points="328.177,-1924.11 338.769,-1923.88 330.341,-1917.46 328.177,-1924.11"/>
</g>
<!-- proc~reord -->
<g id="proc~~siesta_analysis~~CallsGraph_node57" class="node"><title>proc~reord</title>
<g id="a_proc~~siesta_analysis~~CallsGraph_node57"><a xlink:href=".././proc/reord.html" xlink:title="reord">
<polygon fill="#d9534f" stroke="#d9534f" points="683,-1712 629,-1712 629,-1688 683,-1688 683,-1712"/>
<text text-anchor="middle" x="656" y="-1697.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reord</text>
</a>
</g>
</g>
<!-- proc~dhscf&#45;&gt;proc~reord -->
<g id="proc~~siesta_analysis~~CallsGraph_edge57" class="edge"><title>proc~dhscf&#45;&gt;proc~reord</title>
<path fill="none" stroke="#000000" d="M197.392,-1406.25C197.718,-1454.12 206.044,-1629.34 308,-1701 357.174,-1735.56 540.511,-1715.64 618.986,-1705.17"/>
<polygon fill="#000000" stroke="#000000" points="619.463,-1708.64 628.901,-1703.82 618.521,-1701.7 619.463,-1708.64"/>
</g>
<!-- rhoofdsp -->
<g id="proc~~siesta_analysis~~CallsGraph_node58" class="node"><title>rhoofdsp</title>
<polygon fill="#777777" stroke="#777777" points="402,-1898 347,-1898 347,-1874 402,-1874 402,-1898"/>
<text text-anchor="middle" x="374.5" y="-1883.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rhoofdsp</text>
</g>
<!-- proc~dhscf&#45;&gt;rhoofdsp -->
<g id="proc~~siesta_analysis~~CallsGraph_edge63" class="edge"><title>proc~dhscf&#45;&gt;rhoofdsp</title>
<path fill="none" stroke="#000000" d="M198.751,-1406.25C205.819,-1473.21 242.765,-1794.34 308,-1865 315.55,-1873.18 326.286,-1878.19 336.886,-1881.25"/>
<polygon fill="#000000" stroke="#000000" points="336.362,-1884.72 346.9,-1883.62 337.979,-1877.91 336.362,-1884.72"/>
</g>
<!-- compute_partial_charges -->
<g id="proc~~siesta_analysis~~CallsGraph_node59" class="node"><title>compute_partial_charges</title>
<polygon fill="#777777" stroke="#777777" points="441,-1856 308,-1856 308,-1832 441,-1832 441,-1856"/>
<text text-anchor="middle" x="374.5" y="-1841.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_partial_charges</text>
</g>
<!-- proc~dhscf&#45;&gt;compute_partial_charges -->
<g id="proc~~siesta_analysis~~CallsGraph_edge59" class="edge"><title>proc~dhscf&#45;&gt;compute_partial_charges</title>
<path fill="none" stroke="#000000" d="M199.071,-1406.4C207.366,-1470.03 247.963,-1759.37 308,-1823 309.05,-1824.11 310.159,-1825.17 311.318,-1826.17"/>
<polygon fill="#000000" stroke="#000000" points="309.414,-1829.1 319.612,-1831.98 313.432,-1823.37 309.414,-1829.1"/>
</g>
<!-- write_tdrho -->
<g id="proc~~siesta_analysis~~CallsGraph_node60" class="node"><title>write_tdrho</title>
<polygon fill="#777777" stroke="#777777" points="407.5,-1814 341.5,-1814 341.5,-1790 407.5,-1790 407.5,-1814"/>
<text text-anchor="middle" x="374.5" y="-1799.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_tdrho</text>
</g>
<!-- proc~dhscf&#45;&gt;write_tdrho -->
<g id="proc~~siesta_analysis~~CallsGraph_edge60" class="edge"><title>proc~dhscf&#45;&gt;write_tdrho</title>
<path fill="none" stroke="#000000" d="M197.132,-1406.05C196.207,-1458.48 199.605,-1669.07 308,-1781 314.398,-1787.61 322.874,-1792.14 331.6,-1795.25"/>
<polygon fill="#000000" stroke="#000000" points="330.876,-1798.68 341.459,-1798.19 332.876,-1791.98 330.876,-1798.68"/>
</g>
<!-- mpi_barrier -->
<g id="proc~~siesta_analysis~~CallsGraph_node61" class="node"><title>mpi_barrier</title>
<polygon fill="#777777" stroke="#777777" points="689.5,-1554 622.5,-1554 622.5,-1530 689.5,-1530 689.5,-1554"/>
<text text-anchor="middle" x="656" y="-1539.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_barrier</text>
</g>
<!-- proc~dhscf&#45;&gt;mpi_barrier -->
<g id="proc~~siesta_analysis~~CallsGraph_edge42" class="edge"><title>proc~dhscf&#45;&gt;mpi_barrier</title>
<path fill="none" stroke="#000000" d="M207.282,-1406.15C224.94,-1427.15 264.383,-1469.89 308,-1490 409.606,-1536.85 544.038,-1543.24 611.889,-1543.11"/>
<polygon fill="#000000" stroke="#000000" points="612.216,-1546.61 622.191,-1543.04 612.167,-1539.61 612.216,-1546.61"/>
</g>
<!-- write_rho -->
<g id="proc~~siesta_analysis~~CallsGraph_node62" class="node"><title>write_rho</title>
<polygon fill="#777777" stroke="#777777" points="403,-1448 346,-1448 346,-1424 403,-1424 403,-1448"/>
<text text-anchor="middle" x="374.5" y="-1433.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_rho</text>
</g>
<!-- proc~dhscf&#45;&gt;write_rho -->
<g id="proc~~siesta_analysis~~CallsGraph_edge62" class="edge"><title>proc~dhscf&#45;&gt;write_rho</title>
<path fill="none" stroke="#000000" d="M223.849,-1400.29C253.57,-1407.38 302.147,-1418.97 335.86,-1427.02"/>
<polygon fill="#000000" stroke="#000000" points="335.269,-1430.47 345.808,-1429.39 336.893,-1423.67 335.269,-1430.47"/>
</g>
<!-- partialcoreonmesh -->
<g id="proc~~siesta_analysis~~CallsGraph_node63" class="node"><title>partialcoreonmesh</title>
<polygon fill="#777777" stroke="#777777" points="425,-1692 324,-1692 324,-1668 425,-1668 425,-1692"/>
<text text-anchor="middle" x="374.5" y="-1677.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">partialcoreonmesh</text>
</g>
<!-- proc~dhscf&#45;&gt;partialcoreonmesh -->
<g id="proc~~siesta_analysis~~CallsGraph_edge58" class="edge"><title>proc~dhscf&#45;&gt;partialcoreonmesh</title>
<path fill="none" stroke="#000000" d="M198.943,-1406.05C204.555,-1447.58 228.708,-1586.16 308,-1659 310.144,-1660.97 312.473,-1662.75 314.933,-1664.37"/>
<polygon fill="#000000" stroke="#000000" points="313.28,-1667.46 323.721,-1669.25 316.677,-1661.34 313.28,-1667.46"/>
</g>
<!-- mymeshbox -->
<g id="proc~~siesta_analysis~~CallsGraph_node64" class="node"><title>mymeshbox</title>
<polygon fill="#777777" stroke="#777777" points="409.5,-1650 339.5,-1650 339.5,-1626 409.5,-1626 409.5,-1650"/>
<text text-anchor="middle" x="374.5" y="-1635.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mymeshbox</text>
</g>
<!-- proc~dhscf&#45;&gt;mymeshbox -->
<g id="proc~~siesta_analysis~~CallsGraph_edge64" class="edge"><title>proc~dhscf&#45;&gt;mymeshbox</title>
<path fill="none" stroke="#000000" d="M200.017,-1406.2C208.351,-1443.53 238.564,-1557.26 308,-1617 314.242,-1622.37 321.875,-1626.37 329.695,-1629.35"/>
<polygon fill="#000000" stroke="#000000" points="328.654,-1632.69 339.247,-1632.5 330.847,-1626.05 328.654,-1632.69"/>
</g>
<!-- neutralatomonmesh -->
<g id="proc~~siesta_analysis~~CallsGraph_node65" class="node"><title>neutralatomonmesh</title>
<polygon fill="#777777" stroke="#777777" points="428.5,-1608 320.5,-1608 320.5,-1584 428.5,-1584 428.5,-1608"/>
<text text-anchor="middle" x="374.5" y="-1593.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">neutralatomonmesh</text>
</g>
<!-- proc~dhscf&#45;&gt;neutralatomonmesh -->
<g id="proc~~siesta_analysis~~CallsGraph_edge65" class="edge"><title>proc~dhscf&#45;&gt;neutralatomonmesh</title>
<path fill="none" stroke="#000000" d="M201.511,-1406.18C212.821,-1438.62 248.098,-1527.89 308,-1575 309.83,-1576.44 311.762,-1577.78 313.769,-1579.03"/>
<polygon fill="#000000" stroke="#000000" points="312.499,-1582.32 322.967,-1583.96 315.802,-1576.15 312.499,-1582.32"/>
</g>
<!-- interface~distmeshdata -->
<g id="proc~~siesta_analysis~~CallsGraph_node66" class="node"><title>interface~distmeshdata</title>
<g id="a_proc~~siesta_analysis~~CallsGraph_node66"><a xlink:href=".././interface/distmeshdata.html" xlink:title="distMeshData">
<polygon fill="#a7506f" stroke="#a7506f" points="413.5,-1772 335.5,-1772 335.5,-1748 413.5,-1748 413.5,-1772"/>
<text text-anchor="middle" x="374.5" y="-1757.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">distMeshData</text>
</a>
</g>
</g>
<!-- proc~dhscf&#45;&gt;interface~distmeshdata -->
<g id="proc~~siesta_analysis~~CallsGraph_edge66" class="edge"><title>proc~dhscf&#45;&gt;interface~distmeshdata</title>
<path fill="none" stroke="#000000" d="M197.883,-1406.04C200.05,-1454.08 214.355,-1634.2 308,-1734 313.065,-1739.4 319.394,-1743.7 326.107,-1747.11"/>
<polygon fill="#000000" stroke="#000000" points="324.856,-1750.39 335.416,-1751.25 327.698,-1743.99 324.856,-1750.39"/>
</g>
<!-- mpi_allreduce -->
<g id="proc~~siesta_analysis~~CallsGraph_node67" class="node"><title>mpi_allreduce</title>
<polygon fill="#777777" stroke="#777777" points="414,-1566 335,-1566 335,-1542 414,-1542 414,-1566"/>
<text text-anchor="middle" x="374.5" y="-1551.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_allreduce</text>
</g>
<!-- proc~dhscf&#45;&gt;mpi_allreduce -->
<g id="proc~~siesta_analysis~~CallsGraph_edge69" class="edge"><title>proc~dhscf&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M204.515,-1406.1C220.031,-1431.91 259.742,-1492.85 308,-1528 313.257,-1531.83 319.154,-1535.19 325.2,-1538.11"/>
<polygon fill="#000000" stroke="#000000" points="324.192,-1541.49 334.752,-1542.34 327.027,-1535.09 324.192,-1541.49"/>
</g>
<!-- forhar -->
<g id="proc~~siesta_analysis~~CallsGraph_node68" class="node"><title>forhar</title>
<polygon fill="#777777" stroke="#777777" points="401.5,-1406 347.5,-1406 347.5,-1382 401.5,-1382 401.5,-1406"/>
<text text-anchor="middle" x="374.5" y="-1391.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">forhar</text>
</g>
<!-- proc~dhscf&#45;&gt;forhar -->
<g id="proc~~siesta_analysis~~CallsGraph_edge70" class="edge"><title>proc~dhscf&#45;&gt;forhar</title>
<path fill="none" stroke="#000000" d="M223.849,-1394C253.875,-1394 303.145,-1394 336.891,-1394"/>
<polygon fill="#000000" stroke="#000000" points="337.259,-1397.5 347.259,-1394 337.259,-1390.5 337.259,-1397.5"/>
</g>
<!-- vacuum_level -->
<g id="proc~~siesta_analysis~~CallsGraph_node69" class="node"><title>vacuum_level</title>
<polygon fill="#777777" stroke="#777777" points="413.5,-1326 335.5,-1326 335.5,-1302 413.5,-1302 413.5,-1326"/>
<text text-anchor="middle" x="374.5" y="-1311.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">vacuum_level</text>
</g>
<!-- proc~dhscf&#45;&gt;vacuum_level -->
<g id="proc~~siesta_analysis~~CallsGraph_edge71" class="edge"><title>proc~dhscf&#45;&gt;vacuum_level</title>
<path fill="none" stroke="#000000" d="M223.546,-1387.18C238.264,-1382.78 256.719,-1376.32 272,-1368 289.804,-1358.31 290.404,-1350.06 308,-1340 314.353,-1336.37 321.312,-1333.01 328.249,-1330"/>
<polygon fill="#000000" stroke="#000000" points="329.73,-1333.18 337.633,-1326.12 327.055,-1326.71 329.73,-1333.18"/>
</g>
<!-- localchargeonmesh -->
<g id="proc~~siesta_analysis~~CallsGraph_node70" class="node"><title>localchargeonmesh</title>
<polygon fill="#777777" stroke="#777777" points="427.5,-1284 321.5,-1284 321.5,-1260 427.5,-1260 427.5,-1284"/>
<text text-anchor="middle" x="374.5" y="-1269.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">localchargeonmesh</text>
</g>
<!-- proc~dhscf&#45;&gt;localchargeonmesh -->
<g id="proc~~siesta_analysis~~CallsGraph_edge73" class="edge"><title>proc~dhscf&#45;&gt;localchargeonmesh</title>
<path fill="none" stroke="#000000" d="M223.516,-1390.09C239.134,-1386.59 258.519,-1380.05 272,-1368 299.564,-1343.36 280.124,-1317.29 308,-1293 309.519,-1291.68 311.123,-1290.44 312.793,-1289.27"/>
<polygon fill="#000000" stroke="#000000" points="314.769,-1292.17 321.617,-1284.09 311.222,-1286.14 314.769,-1292.17"/>
</g>
<!-- write_debug -->
<g id="proc~~siesta_analysis~~CallsGraph_node71" class="node"><title>write_debug</title>
<polygon fill="#777777" stroke="#777777" points="691.5,-1407 620.5,-1407 620.5,-1383 691.5,-1383 691.5,-1407"/>
<text text-anchor="middle" x="656" y="-1392.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_debug</text>
</g>
<!-- proc~dhscf&#45;&gt;write_debug -->
<g id="proc~~siesta_analysis~~CallsGraph_edge74" class="edge"><title>proc~dhscf&#45;&gt;write_debug</title>
<path fill="none" stroke="#000000" d="M223.647,-1387.59C245.913,-1382.48 278.838,-1375.75 308,-1373 416.388,-1362.79 544.28,-1377.89 610.4,-1387.7"/>
<polygon fill="#000000" stroke="#000000" points="610.058,-1391.19 620.469,-1389.22 611.106,-1384.26 610.058,-1391.19"/>
</g>
<!-- vmat -->
<g id="proc~~siesta_analysis~~CallsGraph_node72" class="node"><title>vmat</title>
<polygon fill="#777777" stroke="#777777" points="401.5,-1242 347.5,-1242 347.5,-1218 401.5,-1218 401.5,-1242"/>
<text text-anchor="middle" x="374.5" y="-1227.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">vmat</text>
</g>
<!-- proc~dhscf&#45;&gt;vmat -->
<g id="proc~~siesta_analysis~~CallsGraph_edge75" class="edge"><title>proc~dhscf&#45;&gt;vmat</title>
<path fill="none" stroke="#000000" d="M223.814,-1390.85C239.744,-1387.63 259.359,-1381.12 272,-1368 309.747,-1328.82 269.756,-1289.7 308,-1251 315.824,-1243.08 326.634,-1238.15 337.219,-1235.07"/>
<polygon fill="#000000" stroke="#000000" points="338.298,-1238.41 347.193,-1232.66 336.65,-1231.61 338.298,-1238.41"/>
</g>
<!-- meshlim -->
<g id="proc~~siesta_analysis~~CallsGraph_node73" class="node"><title>meshlim</title>
<polygon fill="#777777" stroke="#777777" points="554,-780 500,-780 500,-756 554,-756 554,-780"/>
<text text-anchor="middle" x="527" y="-765.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">meshlim</text>
</g>
<!-- proc~setmeshdistr&#45;&gt;meshlim -->
<g id="proc~~siesta_analysis~~CallsGraph_edge76" class="edge"><title>proc~setmeshdistr&#45;&gt;meshlim</title>
<path fill="none" stroke="#000000" d="M412.316,-768C435.861,-768 466.268,-768 489.71,-768"/>
<polygon fill="#000000" stroke="#000000" points="489.941,-771.5 499.941,-768 489.941,-764.5 489.941,-771.5"/>
</g>
<!-- proc~reord&#45;&gt;re_alloc -->
<g id="proc~~siesta_analysis~~CallsGraph_edge77" class="edge"><title>proc~reord&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M683.244,-1710.09C695.93,-1714.97 711.353,-1720.9 725.107,-1726.2"/>
<polygon fill="#000000" stroke="#000000" points="724.175,-1729.59 734.765,-1729.91 726.688,-1723.05 724.175,-1729.59"/>
</g>
<!-- proc~reord&#45;&gt;de_alloc -->
<g id="proc~~siesta_analysis~~CallsGraph_edge78" class="edge"><title>proc~reord&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M667.711,-1712.32C677.144,-1723.73 690.646,-1741.53 699,-1759 731.914,-1827.83 750.274,-1917.31 757.44,-1958.06"/>
<polygon fill="#000000" stroke="#000000" points="754.001,-1958.72 759.131,-1967.99 760.902,-1957.54 754.001,-1958.72"/>
</g>
<!-- proc~reord&#45;&gt;timer -->
<g id="proc~~siesta_analysis~~CallsGraph_edge79" class="edge"><title>proc~reord&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M670.344,-1687.69C680.013,-1677.92 692.488,-1663.39 699,-1648 737.099,-1557.97 755.461,-1247.75 759.909,-1161.44"/>
<polygon fill="#000000" stroke="#000000" points="763.416,-1161.37 760.424,-1151.21 756.425,-1161.02 763.416,-1161.37"/>
</g>
<!-- proc~distmeshdata_rea -->
<g id="proc~~siesta_analysis~~CallsGraph_node74" class="node"><title>proc~distmeshdata_rea</title>
<g id="a_proc~~siesta_analysis~~CallsGraph_node74"><a xlink:href=".././proc/distmeshdata_rea.html" xlink:title="distMeshData_rea">
<polygon fill="#d9534f" stroke="#d9534f" points="577,-1772 477,-1772 477,-1748 577,-1748 577,-1772"/>
<text text-anchor="middle" x="527" y="-1757.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">distMeshData_rea</text>
</a>
</g>
</g>
<!-- interface~distmeshdata&#45;&gt;proc~distmeshdata_rea -->
<g id="proc~~siesta_analysis~~CallsGraph_edge80" class="edge"><title>interface~distmeshdata&#45;&gt;proc~distmeshdata_rea</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M413.867,-1760C429.883,-1760 448.861,-1760 466.606,-1760"/>
<polygon fill="#000000" stroke="#000000" points="466.88,-1763.5 476.88,-1760 466.88,-1756.5 466.88,-1763.5"/>
</g>
<!-- proc~distmeshdata_int -->
<g id="proc~~siesta_analysis~~CallsGraph_node75" class="node"><title>proc~distmeshdata_int</title>
<g id="a_proc~~siesta_analysis~~CallsGraph_node75"><a xlink:href=".././proc/distmeshdata_int.html" xlink:title="distMeshData_int">
<polygon fill="#d9534f" stroke="#d9534f" points="574.5,-1954 479.5,-1954 479.5,-1930 574.5,-1930 574.5,-1954"/>
<text text-anchor="middle" x="527" y="-1939.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">distMeshData_int</text>
</a>
</g>
</g>
<!-- interface~distmeshdata&#45;&gt;proc~distmeshdata_int -->
<g id="proc~~siesta_analysis~~CallsGraph_edge81" class="edge"><title>interface~distmeshdata&#45;&gt;proc~distmeshdata_int</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M413.72,-1766.86C423.387,-1769.97 433.221,-1774.48 441,-1781 485.589,-1818.38 510.002,-1885.25 520.201,-1919.87"/>
<polygon fill="#000000" stroke="#000000" points="516.944,-1921.22 523.02,-1929.9 523.683,-1919.32 516.944,-1921.22"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;re_alloc -->
<g id="proc~~siesta_analysis~~CallsGraph_edge85" class="edge"><title>proc~distmeshdata_rea&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M577.129,-1755.78C621.251,-1752 685.017,-1746.52 724.688,-1743.12"/>
<polygon fill="#000000" stroke="#000000" points="725.05,-1746.6 734.714,-1742.26 724.452,-1739.62 725.05,-1746.6"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;de_alloc -->
<g id="proc~~siesta_analysis~~CallsGraph_edge89" class="edge"><title>proc~distmeshdata_rea&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M537.896,-1772.1C552.719,-1789.61 582.25,-1822.2 613,-1843 647.611,-1866.41 667.411,-1853.65 699,-1881 723.861,-1902.53 742.104,-1936.51 752.137,-1958.52"/>
<polygon fill="#000000" stroke="#000000" points="748.944,-1959.96 756.164,-1967.71 755.355,-1957.15 748.944,-1959.96"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;timer -->
<g id="proc~~siesta_analysis~~CallsGraph_edge87" class="edge"><title>proc~distmeshdata_rea&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M540.147,-1747.9C575.831,-1712.1 679.081,-1606.43 699,-1563 732.483,-1490 753.59,-1238.52 759.379,-1161.56"/>
<polygon fill="#000000" stroke="#000000" points="762.902,-1161.37 760.149,-1151.14 755.921,-1160.85 762.902,-1161.37"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;die -->
<g id="proc~~siesta_analysis~~CallsGraph_edge91" class="edge"><title>proc~distmeshdata_rea&#45;&gt;die</title>
<path fill="none" stroke="#000000" d="M533.136,-1772.01C552.442,-1817.16 620.832,-1977.09 645.794,-2035.47"/>
<polygon fill="#000000" stroke="#000000" points="642.65,-2037.02 649.8,-2044.84 649.087,-2034.27 642.65,-2037.02"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;proc~reord -->
<g id="proc~~siesta_analysis~~CallsGraph_edge84" class="edge"><title>proc~distmeshdata_rea&#45;&gt;proc~reord</title>
<path fill="none" stroke="#000000" d="M553.7,-1747.86C572.808,-1738.83 599.095,-1726.41 620.102,-1716.49"/>
<polygon fill="#000000" stroke="#000000" points="621.791,-1719.56 629.338,-1712.12 618.801,-1713.23 621.791,-1719.56"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;mpi_barrier -->
<g id="proc~~siesta_analysis~~CallsGraph_edge88" class="edge"><title>proc~distmeshdata_rea&#45;&gt;mpi_barrier</title>
<path fill="none" stroke="#000000" d="M535.009,-1747.97C555.647,-1712.54 616.388,-1608.28 642.659,-1563.18"/>
<polygon fill="#000000" stroke="#000000" points="645.847,-1564.67 647.856,-1554.26 639.798,-1561.14 645.847,-1564.67"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;write_debug -->
<g id="proc~~siesta_analysis~~CallsGraph_edge90" class="edge"><title>proc~distmeshdata_rea&#45;&gt;write_debug</title>
<path fill="none" stroke="#000000" d="M532.226,-1747.86C550.569,-1695.14 623.447,-1485.68 647.357,-1416.96"/>
<polygon fill="#000000" stroke="#000000" points="650.778,-1417.78 650.759,-1407.19 644.167,-1415.48 650.778,-1417.78"/>
</g>
<!-- mpitrace_event -->
<g id="proc~~siesta_analysis~~CallsGraph_node76" class="node"><title>mpitrace_event</title>
<polygon fill="#777777" stroke="#777777" points="699,-1792 613,-1792 613,-1768 699,-1768 699,-1792"/>
<text text-anchor="middle" x="656" y="-1777.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpitrace_event</text>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;mpitrace_event -->
<g id="proc~~siesta_analysis~~CallsGraph_edge82" class="edge"><title>proc~distmeshdata_rea&#45;&gt;mpitrace_event</title>
<path fill="none" stroke="#000000" d="M577.102,-1767.73C585.438,-1769.05 594.125,-1770.41 602.544,-1771.74"/>
<polygon fill="#000000" stroke="#000000" points="602.216,-1775.23 612.639,-1773.33 603.305,-1768.32 602.216,-1775.23"/>
</g>
<!-- nmeshg -->
<g id="proc~~siesta_analysis~~CallsGraph_node77" class="node"><title>nmeshg</title>
<polygon fill="#777777" stroke="#777777" points="683,-1834 629,-1834 629,-1810 683,-1810 683,-1834"/>
<text text-anchor="middle" x="656" y="-1819.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nmeshg</text>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;nmeshg -->
<g id="proc~~siesta_analysis~~CallsGraph_edge83" class="edge"><title>proc~distmeshdata_rea&#45;&gt;nmeshg</title>
<path fill="none" stroke="#000000" d="M552.788,-1772.1C572.281,-1781.62 599.645,-1794.98 621.154,-1805.48"/>
<polygon fill="#000000" stroke="#000000" points="619.752,-1808.69 630.274,-1809.93 622.823,-1802.4 619.752,-1808.69"/>
</g>
<!-- proc~boxintersection -->
<g id="proc~~siesta_analysis~~CallsGraph_node78" class="node"><title>proc~boxintersection</title>
<g id="a_proc~~siesta_analysis~~CallsGraph_node78"><a xlink:href=".././proc/boxintersection.html" xlink:title="boxIntersection">
<polygon fill="#d9534f" stroke="#d9534f" points="698.5,-1914 613.5,-1914 613.5,-1890 698.5,-1890 698.5,-1914"/>
<text text-anchor="middle" x="656" y="-1899.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">boxIntersection</text>
</a>
</g>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;proc~boxintersection -->
<g id="proc~~siesta_analysis~~CallsGraph_edge86" class="edge"><title>proc~distmeshdata_rea&#45;&gt;proc~boxintersection</title>
<path fill="none" stroke="#000000" d="M534.683,-1772.02C547.591,-1794.48 577.807,-1843.45 613,-1876 616.187,-1878.95 619.757,-1881.75 623.432,-1884.34"/>
<polygon fill="#000000" stroke="#000000" points="621.786,-1887.45 632.071,-1889.99 625.619,-1881.59 621.786,-1887.45"/>
</g>
<!-- proc~distmeshdata_int&#45;&gt;re_alloc -->
<g id="proc~~siesta_analysis~~CallsGraph_edge95" class="edge"><title>proc~distmeshdata_int&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M574.851,-1949.47C612.432,-1952.74 664.437,-1950.8 699,-1923 748.589,-1883.11 758.73,-1801.84 760.656,-1762.43"/>
<polygon fill="#000000" stroke="#000000" points="764.16,-1762.39 761.012,-1752.28 757.164,-1762.15 764.16,-1762.39"/>
</g>
<!-- proc~distmeshdata_int&#45;&gt;de_alloc -->
<g id="proc~~siesta_analysis~~CallsGraph_edge94" class="edge"><title>proc~distmeshdata_int&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M574.76,-1949.72C587.188,-1951.77 600.602,-1953.97 613,-1956 651.147,-1962.23 694.835,-1969.31 724.801,-1974.16"/>
<polygon fill="#000000" stroke="#000000" points="724.367,-1977.63 734.797,-1975.77 725.483,-1970.72 724.367,-1977.63"/>
</g>
<!-- proc~distmeshdata_int&#45;&gt;die -->
<g id="proc~~siesta_analysis~~CallsGraph_edge92" class="edge"><title>proc~distmeshdata_int&#45;&gt;die</title>
<path fill="none" stroke="#000000" d="M541.591,-1954.31C563.744,-1974.37 607.787,-2014.25 633.991,-2037.98"/>
<polygon fill="#000000" stroke="#000000" points="631.745,-2040.66 641.506,-2044.78 636.443,-2035.47 631.745,-2040.66"/>
</g>
<!-- proc~distmeshdata_int&#45;&gt;proc~boxintersection -->
<g id="proc~~siesta_analysis~~CallsGraph_edge93" class="edge"><title>proc~distmeshdata_int&#45;&gt;proc~boxintersection</title>
<path fill="none" stroke="#000000" d="M566.104,-1930C578.921,-1925.96 593.391,-1921.4 606.876,-1917.16"/>
<polygon fill="#000000" stroke="#000000" points="607.997,-1920.47 616.484,-1914.13 605.894,-1913.8 607.997,-1920.47"/>
</g>
</g>
</svg>
</div><script>var panprocsiesta_analysisCallsGraph = svgPanZoom('#procsiesta_analysisCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,-0 209.5,-0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.5,-24 454.5,-24 454.5,-0 551.5,-0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/siesta_analysis.html#src">siesta_analysis</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>      <span class="k">subroutine </span><span class="n">siesta_analysis</span><span class="p">(</span> <span class="n">relaxd</span> <span class="p">)</span>
      <span class="k">USE </span><span class="n">band</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">nbk</span><span class="p">,</span> <span class="n">bk</span><span class="p">,</span> <span class="n">maxbk</span><span class="p">,</span> <span class="n">bands</span>
      <span class="k">USE </span><span class="n">writewave</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">nwk</span><span class="p">,</span> <span class="n">wfk</span><span class="p">,</span> <span class="n">wwave</span>
      <span class="k">USE </span><span class="n">writewave</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">setup_wfs_list</span><span class="p">,</span> <span class="n">wfs_filename</span>
      <span class="k">USE </span><span class="n">m_ksvinit</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">nkpol</span><span class="p">,</span> <span class="n">kpol</span><span class="p">,</span> <span class="n">wgthpol</span>
      <span class="k">use </span><span class="n">m_ksv</span>
      <span class="k">USE </span><span class="n">m_projected_DOS</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">projected_DOS</span>
      <span class="k">USE </span><span class="n">m_local_DOS</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">local_DOS</span>
<span class="cp">#ifdef SIESTA__PEXSI</span>
      <span class="k">USE </span><span class="n">m_pexsi_local_DOS</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">pexsi_local_DOS</span>
      <span class="k">USE </span><span class="n">m_pexsi_dos</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">pexsi_dos</span>
<span class="cp">#endif      </span>
      <span class="k">USE </span><span class="n">siesta_options</span>
      <span class="k">use </span><span class="n">units</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">Debye</span><span class="p">,</span> <span class="n">eV</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">numh</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">H</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">Dscf</span><span class="p">,</span> <span class="n">xijo</span>
      <span class="k">use </span><span class="n">siesta_geom</span>
      <span class="k">use </span><span class="n">m_dhscf</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">dhscf</span>
      <span class="k">use </span><span class="n">atomlist</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">indxuo</span><span class="p">,</span> <span class="n">iaorb</span><span class="p">,</span> <span class="n">lastkb</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span> <span class="n">datm</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span>
     <span class="p">&amp;</span>                    <span class="n">iphkb</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">iza</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span> <span class="n">rmaxo</span><span class="p">,</span> <span class="n">indxua</span>
      <span class="k">use </span><span class="n">atomlist</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">qtot</span>
      <span class="k">use </span><span class="n">fdf</span>
      <span class="k">use </span><span class="n">writewave</span><span class="p">,</span>    <span class="n">only</span><span class="p">:</span> <span class="n">wwave</span>
      <span class="k">use </span><span class="n">siesta_cml</span>
      <span class="k">use </span><span class="n">files</span><span class="p">,</span>        <span class="n">only</span> <span class="p">:</span> <span class="n">slabel</span>
      <span class="k">use </span><span class="n">files</span><span class="p">,</span>        <span class="n">only</span> <span class="p">:</span> <span class="n">filesOut_t</span>   <span class="c">! derived type for output file names</span>
      <span class="k">use </span><span class="n">zmatrix</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">lUseZmatrix</span><span class="p">,</span> <span class="n">write_zmatrix</span>
      <span class="k">use </span><span class="n">kpoint_scf_m</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">kpoints_scf</span>
      <span class="k">use </span><span class="n">parallel</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">IOnode</span>
      <span class="k">use </span><span class="n">parallel</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">SIESTA_worker</span>
      <span class="k">use </span><span class="n">files</span><span class="p">,</span>       <span class="n">only</span> <span class="p">:</span> <span class="n">label_length</span>
      <span class="k">use </span><span class="n">m_energies</span>
      <span class="k">use </span><span class="n">m_steps</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="k">final</span>
<span class="k">      use </span><span class="n">m_ntm</span>
      <span class="k">use </span><span class="n">m_spin</span><span class="p">,</span>         <span class="n">only</span><span class="p">:</span> <span class="n">nspin</span><span class="p">,</span> <span class="n">spinor_dim</span><span class="p">,</span> <span class="n">h_spin_dim</span>
      <span class="k">use </span><span class="n">m_spin</span><span class="p">,</span>         <span class="n">only</span><span class="p">:</span> <span class="n">SpOrb</span><span class="p">,</span> <span class="n">NonCol</span><span class="p">,</span> <span class="n">SPpol</span><span class="p">,</span> <span class="n">NoMagn</span>
      <span class="k">use </span><span class="n">m_dipol</span>
      <span class="k">use </span><span class="n">m_eo</span>
      <span class="k">use </span><span class="n">m_forces</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">fa</span>
      <span class="k">use </span><span class="n">m_gamma</span> 
      <span class="k">use </span><span class="n">alloc</span><span class="p">,</span>             <span class="n">only</span><span class="p">:</span> <span class="n">re_alloc</span><span class="p">,</span> <span class="n">de_alloc</span>
      <span class="k">use </span><span class="n">basis_enthalpy</span><span class="p">,</span>    <span class="n">only</span><span class="p">:</span> <span class="n">write_basis_enthalpy</span>
      <span class="k">use </span><span class="n">m_partial_charges</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">want_partial_charges</span>
      <span class="k">use </span><span class="n">m_iodm_old</span><span class="p">,</span>        <span class="n">only</span><span class="p">:</span> <span class="n">read_spmatrix</span>
      <span class="k">use </span><span class="n">m_siesta2wannier90</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">siesta2wannier90</span>

      <span class="k">use </span><span class="n">m_mpi_utils</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">barrier</span>
<span class="cp">#ifdef SIESTA__FLOOK</span>
      <span class="k">use </span><span class="n">flook_siesta</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">slua_call</span><span class="p">,</span> <span class="n">LUA_ANALYSIS</span>
<span class="cp">#endif</span>
      
      <span class="k">implicit none</span>

<span class="k">      </span><span class="kt">logical</span> <span class="kd">::</span> <span class="n">relaxd</span><span class="p">,</span> <span class="n">getPSI</span><span class="p">,</span> <span class="n">quenched_MD</span><span class="p">,</span> <span class="n">found</span>

      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">dummy_str</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">dummy_strl</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">qspin</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>         <span class="c">! Local</span>

      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">polxyz</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">nspin</span><span class="p">)</span>  <span class="c">! Autom., small</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">polR</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">nspin</span><span class="p">)</span>    <span class="c">! Autom., small</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">qaux</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">ebk</span><span class="p">(:,:,:)</span>       <span class="c">! Band energies</span>

      <span class="kt">integer</span>           <span class="kd">::</span> <span class="n">j</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">ik</span><span class="p">,</span> <span class="n">io</span><span class="p">,</span> <span class="n">ispin</span>
      <span class="kt">integer</span>           <span class="kd">::</span> <span class="n">wfs_band_min</span><span class="p">,</span> <span class="n">wfs_band_max</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">g2max</span><span class="p">,</span> <span class="n">current_ef</span>
      <span class="k">type</span><span class="p">(</span><span class="n">filesOut_t</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">filesOut</span> <span class="c">! blank output file names</span>

<span class="c">!-----------------------------------------------------------------------BEGIN</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">SIESTA_worker</span><span class="p">)</span> <span class="k">call </span><span class="n">timer</span><span class="p">(</span><span class="s2">&quot;Analysis&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

      <span class="c">!! Check that we are converged in geometry,</span>
      <span class="c">!! if strictly required,</span>
      <span class="c">!! before carrying out any analysis.</span>

      <span class="c">!!@code</span>
      <span class="n">quenched_MD</span> <span class="o">=</span>  <span class="p">(</span> <span class="p">(</span><span class="n">iquench</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>
     <span class="err">$</span>     <span class="p">((</span><span class="n">idyn</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">idyn</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">3</span><span class="p">))</span> <span class="p">)</span>

      <span class="k">if</span> <span class="p">((</span><span class="n">nmove</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">quenched_MD</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         if</span> <span class="p">(</span><span class="n">SIESTA_worker</span><span class="p">)</span> <span class="k">then</span>  <span class="c">! For timing ops and associated barrier</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">GeometryMustConverge</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">relaxd</span><span class="p">))</span> <span class="k">then</span>
<span class="k">            call </span><span class="n">message</span><span class="p">(</span><span class="s2">&quot;FATAL&quot;</span><span class="p">,</span>
     <span class="err">$</span>           <span class="s2">&quot;GEOM_NOT_CONV: Geometry relaxation not converged&quot;</span><span class="p">)</span>
            <span class="k">call </span><span class="n">timer</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">call </span><span class="n">timer</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
            <span class="k">call </span><span class="n">barrier</span><span class="p">()</span>
            <span class="k">call </span><span class="n">die</span><span class="p">(</span><span class="s2">&quot;ABNORMAL_TERMINATION&quot;</span><span class="p">)</span>
          <span class="n">endif</span>
         <span class="n">endif</span>
      <span class="n">endif</span>
      <span class="c">!!@endcode</span>

<span class="c">!     All the comments below assume that this compatibility option</span>
<span class="c">!     is not used.</span>
<span class="c">!     Note also that full compatibility cannot be guaranteed</span>

      <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">compat_pre_v4_dynamics</span><span class="p">)</span> <span class="k">then</span>

<span class="c">!     This is a sanity safeguard: we reset the geometry (which might</span>
<span class="c">!     have been moved by the relaxation or MD routines) to the one used</span>
<span class="c">!     in the last computation of the electronic structure.</span>
<span class="c">!     See the comments below for explanation</span>

<span class="c">!$OMP parallel workshare default(shared)</span>
         <span class="n">xa</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">na_s</span><span class="p">)</span> <span class="o">=</span> <span class="n">xa_last</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">na_s</span><span class="p">)</span>
         <span class="n">ucell</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">ucell_last</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span>
         <span class="n">scell</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">scell_last</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span>
<span class="c">!$OMP end parallel workshare</span>

      <span class="n">endif</span>

      <span class="c">! zmatrix info reset??</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">fdf_get</span><span class="p">(</span><span class="s2">&quot;Read-H-from-file&quot;</span><span class="p">,.</span><span class="n">false</span><span class="p">.))</span> <span class="k">then</span>
<span class="k">         if</span> <span class="p">(</span><span class="n">SIESTA_worker</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            call </span><span class="n">read_spmatrix</span><span class="p">(</span><span class="n">maxnh</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">h_spin_dim</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span>
     <span class="p">.</span>           <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">userfile</span><span class="o">=</span><span class="s2">&quot;H_IN&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">found</span><span class="p">)</span> <span class="k">call </span><span class="n">die</span><span class="p">(</span><span class="s2">&quot;Could not find H_IN&quot;</span><span class="p">)</span>
            <span class="n">current_ef</span> <span class="o">=</span> <span class="n">ef</span>
            <span class="n">ef</span> <span class="o">=</span> <span class="n">fdf_get</span><span class="p">(</span><span class="s2">&quot;Manual-Fermi-Level&quot;</span><span class="p">,</span><span class="n">current_ef</span><span class="p">,</span><span class="s2">&quot;Ry&quot;</span><span class="p">)</span> 
         <span class="n">endif</span>
      <span class="n">endif</span>

<span class="cp">#ifdef SIESTA__PEXSI</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">fdf_get</span><span class="p">(</span><span class="s2">&quot;PEXSI.DOS&quot;</span><span class="p">,.</span><span class="n">false</span><span class="p">.))</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">pexsi_dos</span><span class="p">(</span><span class="n">no_u</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">spinor_dim</span><span class="p">,</span>
     <span class="err">$</span>        <span class="n">maxnh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">qtot</span><span class="p">,</span> <span class="n">ef</span><span class="p">)</span>
         
      <span class="n">endif</span>
<span class="cp">#endif</span>
      <span class="c">! section done by Siesta subset of nodes</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">SIESTA_worker</span><span class="p">)</span> <span class="k">then</span>

<span class="k">      final</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">cml_p</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">cmlStartModule</span><span class="p">(</span><span class="n">xf</span><span class="o">=</span><span class="n">mainXML</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Finalization&#39;</span><span class="p">)</span>
      <span class="n">endif</span>

<span class="cp">#ifdef SIESTA__FLOOK</span>
      <span class="c">! Call lua right before doing the analysis,</span>
      <span class="c">! possibly changing some of the variables</span>
      <span class="k">call </span><span class="n">slua_call</span><span class="p">(</span><span class="n">LUA</span><span class="p">,</span><span class="n">LUA_ANALYSIS</span><span class="p">)</span>
<span class="cp">#endif</span>

<span class="c">!</span>
<span class="c">!     NOTE that the geometry output by the following sections</span>
<span class="c">!     used to be that &quot;predicted&quot; for the next MD or relaxation step.</span>
<span class="c">!     This is now changed</span>

<span class="c">!</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">IOnode</span><span class="p">)</span> <span class="k">then</span>
        <span class="c">! Print atomic coordinates</span>

        <span class="c">! This covers CG and MD-quench (verlet, pr), instances in which </span>
        <span class="c">! &quot;relaxd&quot; is meaningful</span>

        <span class="k">if</span> <span class="p">((</span><span class="n">nmove</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">quenched_MD</span> <span class="p">)</span> <span class="k">then</span>

<span class="k">          if</span> <span class="p">(</span><span class="n">relaxd</span><span class="p">)</span> <span class="k">then</span>  <span class="c">! xa = xa_last</span>
             <span class="c">! The &quot;relaxation&quot; routines do not update</span>
             <span class="c">! the coordinates if relaxed, so this behavior is unchanged</span>
             <span class="k">call </span><span class="n">outcoor</span><span class="p">(</span><span class="n">ucell</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="s1">&#39;Relaxed&#39;</span><span class="p">,</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span> <span class="p">)</span>
          <span class="k">else</span>  
             <span class="c">! Since xa = xa_last now, this will just repeat the</span>
             <span class="c">! last set of coordinates used, not the predicted ones.</span>
             <span class="k">call </span><span class="n">outcoor</span><span class="p">(</span><span class="n">ucell</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="s1">&#39;Final (unrelaxed)&#39;</span><span class="p">,</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span> <span class="p">)</span>
          <span class="n">endif</span>

        <span class="n">endif</span>

        <span class="c">! This call will write xa_last to the .STRUCT_OUT file</span>
        <span class="c">! (again, since it has already been written by state_init),</span>
        <span class="c">! CML records of the latest processed structure, and </span>
        <span class="c">! possibly zmatrix info.  *** unmoved?? how?</span>
        <span class="c">! Note that the .STRUCT_NEXT_ITER file is produced</span>
        <span class="c">! in siesta_move for checkpointing of relaxations and MD runs.</span>

        <span class="c">! If all we want are the CML records (to satisfy some expectation</span>
        <span class="c">! of appearance in the &quot;finalization&quot; section, we might put the</span>
        <span class="c">! cml call explicitly and forget about the rest.</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">compat_pre_v4_dynamics</span><span class="p">)</span> <span class="k">then</span>
<span class="k">           call </span><span class="n">siesta_write_positions</span><span class="p">(</span><span class="n">moved</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>  
        <span class="k">else</span>
<span class="k">           call </span><span class="n">siesta_write_positions</span><span class="p">(</span><span class="n">moved</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.)</span>  
        <span class="n">endif</span>


        
        <span class="c">! ??  Clarify Zmatrix behavior ****</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">lUseZmatrix</span><span class="p">)</span> <span class="k">call </span><span class="n">write_Zmatrix</span>

        <span class="c">! Print unit cell (cell_last) for variable cell and server operation</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">varcel</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">idyn</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">8</span><span class="p">))</span> <span class="k">call </span><span class="n">outcell</span><span class="p">(</span><span class="n">ucell</span><span class="p">)</span>

<span class="c">!------------------------------------------------------------------</span>
        <span class="c">! It can be argued that these needed the xa_last coordinates</span>
        <span class="c">! all along</span>

<span class="c">!       Print coordinates in xmol format in a separate file</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">fdf_boolean</span><span class="p">(</span><span class="s1">&#39;WriteCoorXmol&#39;</span><span class="p">,.</span><span class="n">false</span><span class="p">.))</span> 
     <span class="p">&amp;</span>     <span class="k">call </span><span class="n">coxmol</span><span class="p">(</span><span class="n">iza</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">na_u</span> <span class="p">)</span>

<span class="c">!       Print coordinates in cerius format in a separate file</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">fdf_boolean</span><span class="p">(</span><span class="s1">&#39;WriteCoorCerius&#39;</span><span class="p">,.</span><span class="n">false</span><span class="p">.))</span>
     <span class="p">&amp;</span>     <span class="k">call </span><span class="n">coceri</span><span class="p">(</span><span class="n">iza</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">ucell</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">sname</span> <span class="p">)</span>

<span class="c">!       Find interatomic distances (output in file BONDS_FINAL)</span>
        <span class="k">call </span><span class="n">bonds</span><span class="p">(</span> <span class="n">ucell</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">isa</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span>
     <span class="p">&amp;</span>       <span class="n">rmax_bonds</span><span class="p">,</span> <span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;.BONDS_FINAL&quot;</span> <span class="p">)</span>

      <span class="n">endif</span> <span class="c">! IONode</span>
<span class="c">!--- end output of geometry information</span>
<span class="c">!</span>
<span class="c">!</span>
<span class="c">! NOTE: In the following sections, wavefunction generation, computation</span>
<span class="c">!       of band structure, etc, are carried out using the last Hamiltonian</span>
<span class="c">!       generated in the SCF run for the last geometry considered.</span>

<span class="c">!   But, if xa /= xa_last, the computation of, say, bands, will use</span>
<span class="c">!      H phases which are not the same as those producing the final </span>
<span class="c">!      ground-state electronic structure.</span>
<span class="c">!</span>
<span class="c">!    Also, since we have removed the replication (superx call) </span>
<span class="c">!      of &quot;moved&quot; coordinates</span>
<span class="c">!      into the auxiliary supercell from &#39;siesta_move&#39; (recall that it is</span>
<span class="c">!      done always in state_init for every new geometry), the &quot;moved unit</span>
<span class="c">!      cell coordinates&quot; could coexist here with &quot;unmoved non-unit cell SC coords&quot;,</span>
<span class="c">!      which is wrong.</span>

<span class="c">!      For all of the above, we should put here a sanity safeguard</span>
<span class="c">!        (if we have not done so already at the top of this routine)</span>

<span class="c">!        xa(1:3,1:na_s) = xa_last(1:3,1:na_s)</span>
<span class="c">!        ucell(1:3,1:3) = ucell_last(1:3,1:3)</span>
<span class="c">!        scell(1:3,1:3) = scell_last(1:3,1:3)</span>

<span class="c">!        DM and H issues</span>
<span class="c">!</span>
<span class="c">!        Some of the routines that follow use H and S, and some use the DM.</span>
<span class="c">!        Those which use the DM should work with the final &quot;out&quot; DM for</span>
<span class="c">!        consistency.</span>
<span class="c">!        Those which use H,S should work with the latest diagonalized H,S pair.</span>
<span class="c">!</span>
<span class="c">!      If mixing the DM during the scf loop we should avoid mixing it one more time</span>
<span class="c">!        after convergence (or restoring Dold)</span>
<span class="c">!        If mixing H, we should avoid mixing it one more time</span>
<span class="c">!        after convergence (and restoring Hold to have the exact H that generated the</span>
<span class="c">!        latest DM, although this is probably too much).</span>
<span class="c">!        See the logic in siesta_forces.</span>

<span class="c">!     Find and print wavefunctions at selected k-points</span>
<span class="c">!   This uses H,S, and xa</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">nwk</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        </span><span class="n">wfs_filename</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;.selected.WFSX&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">IONode</span><span class="p">)</span> <span class="k">print</span> <span class="s2">&quot;(a)&quot;</span><span class="p">,</span>
     <span class="err">$</span>              <span class="s2">&quot;Writing WFSX for selected k-points in &quot;</span>
     <span class="err">$</span>                           <span class="o">//</span> <span class="nb">trim</span><span class="p">(</span><span class="n">wfs_filename</span><span class="p">)</span>
        <span class="k">call </span><span class="n">wwave</span><span class="p">(</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">h_spin_dim</span><span class="p">,</span> <span class="n">spinor_dim</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> 
     <span class="p">&amp;</span>              <span class="n">nwk</span><span class="p">,</span>
     <span class="p">&amp;</span>              <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">Ef</span><span class="p">,</span> <span class="n">xijo</span><span class="p">,</span> <span class="n">indxuo</span><span class="p">,</span>
     <span class="p">&amp;</span>              <span class="n">nwk</span><span class="p">,</span> <span class="n">wfk</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="nb">gamma</span><span class="p">,</span> <span class="n">occtol</span> <span class="p">)</span>
      <span class="n">endif</span>


<span class="c">!   This uses H,S, and xa</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">write_coop</span><span class="p">)</span> <span class="k">then</span>
        <span class="c">! Output the wavefunctions for the kpoints in the SCF set</span>
        <span class="c">! Note that we allow both a band number and an energy range</span>
        <span class="c">! The user is responsible for using appropriate values.</span>
        <span class="n">wfs_band_min</span> <span class="o">=</span> <span class="n">fdf_get</span><span class="p">(</span><span class="s2">&quot;WFS.BandMin&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">wfs_band_max</span> <span class="o">=</span> <span class="n">fdf_get</span><span class="p">(</span><span class="s2">&quot;WFS.BandMax&quot;</span><span class="p">,</span><span class="n">no_u</span><span class="p">)</span>
        <span class="k">call </span><span class="n">setup_wfs_list</span><span class="p">(</span><span class="n">kpoints_scf</span><span class="p">%</span><span class="n">N</span><span class="p">,</span><span class="n">no_u</span><span class="p">,</span>
     <span class="p">&amp;</span>                      <span class="n">wfs_band_min</span><span class="p">,</span><span class="n">wfs_band_max</span><span class="p">,</span>
     <span class="err">$</span>                      <span class="n">use_scf_weights</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.,</span>
     <span class="err">$</span>                      <span class="n">use_energy_window</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
         <span class="n">wfs_filename</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;.fullBZ.WFSX&quot;</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">IONode</span><span class="p">)</span> <span class="k">print</span> <span class="s2">&quot;(a)&quot;</span><span class="p">,</span> <span class="s2">&quot;Writing WFSX for COOP/COHP in &quot;</span> 
     <span class="err">$</span>                           <span class="o">//</span> <span class="nb">trim</span><span class="p">(</span><span class="n">wfs_filename</span><span class="p">)</span>
         <span class="k">call </span><span class="n">wwave</span><span class="p">(</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">h_spin_dim</span><span class="p">,</span> <span class="n">spinor_dim</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> 
     <span class="p">.</span>        <span class="n">kpoints_scf</span><span class="p">%</span><span class="n">N</span><span class="p">,</span>
     <span class="p">.</span>        <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">Ef</span><span class="p">,</span> <span class="n">xijo</span><span class="p">,</span> <span class="n">indxuo</span><span class="p">,</span>
     <span class="p">.</span>        <span class="n">kpoints_scf</span><span class="p">%</span><span class="n">N</span><span class="p">,</span> <span class="n">kpoints_scf</span><span class="p">%</span><span class="n">k</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="nb">gamma</span><span class="p">,</span> <span class="n">occtol</span><span class="p">)</span>
      <span class="n">endif</span>

<span class="c">!     Compute bands</span>
<span class="c">!   This uses H,S, and xa</span>
      <span class="k">nullify</span><span class="p">(</span> <span class="n">ebk</span> <span class="p">)</span>
      <span class="k">call </span><span class="n">re_alloc</span><span class="p">(</span> <span class="n">ebk</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">spinor_dim</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">maxbk</span><span class="p">,</span>
     <span class="p">&amp;</span>               <span class="s1">&#39;ebk&#39;</span><span class="p">,</span> <span class="s1">&#39;siesta_analysis&#39;</span> <span class="p">)</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">nbk</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        if</span> <span class="p">(</span><span class="n">IONode</span><span class="p">)</span> <span class="k">print</span> <span class="s2">&quot;(a)&quot;</span><span class="p">,</span> <span class="s2">&quot;Computing bands...&quot;</span>
        <span class="n">getPSI</span> <span class="o">=</span> <span class="n">fdf_get</span><span class="p">(</span><span class="s1">&#39;WFS.Write.For.Bands&#39;</span><span class="p">,</span> <span class="p">.</span><span class="n">false</span><span class="p">.)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">getPSI</span><span class="p">)</span> <span class="k">then</span>
<span class="k">           </span><span class="n">wfs_filename</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;.bands.WFSX&quot;</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">IONode</span><span class="p">)</span> <span class="k">print</span> <span class="s2">&quot;(a)&quot;</span><span class="p">,</span> <span class="s2">&quot;Writing WFSX for bands in &quot;</span>
     <span class="err">$</span>                           <span class="o">//</span> <span class="nb">trim</span><span class="p">(</span><span class="n">wfs_filename</span><span class="p">)</span>
           <span class="n">wfs_band_min</span> <span class="o">=</span> <span class="n">fdf_get</span><span class="p">(</span><span class="s2">&quot;WFS.BandMin&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
           <span class="n">wfs_band_max</span> <span class="o">=</span> <span class="n">fdf_get</span><span class="p">(</span><span class="s2">&quot;WFS.BandMax&quot;</span><span class="p">,</span><span class="n">no_u</span><span class="p">)</span>
           <span class="k">call </span><span class="n">setup_wfs_list</span><span class="p">(</span><span class="n">nbk</span><span class="p">,</span><span class="n">no_u</span><span class="p">,</span><span class="n">wfs_band_min</span><span class="p">,</span><span class="n">wfs_band_max</span><span class="p">,</span>
     <span class="err">$</span>          <span class="n">use_scf_weights</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span>
     <span class="err">$</span>          <span class="n">use_energy_window</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.)</span>
        <span class="n">endif</span>
        <span class="k">call </span><span class="n">bands</span><span class="p">(</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">h_spin_dim</span><span class="p">,</span> <span class="n">spinor_dim</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> 
     <span class="p">.</span>              <span class="n">maxbk</span><span class="p">,</span>
     <span class="p">.</span>              <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">Ef</span><span class="p">,</span> <span class="n">xijo</span><span class="p">,</span> <span class="n">indxuo</span><span class="p">,</span>
     <span class="p">.</span>              <span class="p">.</span><span class="n">true</span><span class="p">.,</span> <span class="n">nbk</span><span class="p">,</span> <span class="n">bk</span><span class="p">,</span> <span class="n">ebk</span><span class="p">,</span> <span class="n">occtol</span><span class="p">,</span> <span class="n">getPSI</span> <span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">IOnode</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          if</span> <span class="p">(</span> <span class="n">writbk</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,a,/,a4,a12)&#39;</span><span class="p">)</span>
     <span class="p">&amp;</span>       <span class="s1">&#39;siesta: Band k vectors (Bohr**-1):&#39;</span><span class="p">,</span> <span class="s1">&#39;ik&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span>
            <span class="k">do </span><span class="n">ik</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nbk</span>
              <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(i4,3f12.6)&#39;</span><span class="p">)</span> <span class="n">ik</span><span class="p">,</span> <span class="p">(</span><span class="n">bk</span><span class="p">(</span><span class="n">ix</span><span class="p">,</span><span class="n">ik</span><span class="p">),</span><span class="n">ix</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
            <span class="n">enddo</span>
          <span class="n">endif</span>
        
          <span class="k">if</span> <span class="p">(</span> <span class="n">writb</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,a,/,a4,a3,a7)&#39;</span><span class="p">)</span>
     <span class="p">&amp;</span>       <span class="s1">&#39;siesta: Band energies (eV):&#39;</span><span class="p">,</span> <span class="s1">&#39;ik&#39;</span><span class="p">,</span> <span class="s1">&#39;is&#39;</span><span class="p">,</span> <span class="s1">&#39;eps&#39;</span>
            <span class="k">do </span><span class="n">ispin</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">spinor_dim</span>
              <span class="k">do </span><span class="n">ik</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nbk</span>
                <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(i4,i3,10f7.2)&#39;</span><span class="p">)</span>
     <span class="p">&amp;</span>            <span class="n">ik</span><span class="p">,</span> <span class="n">ispin</span><span class="p">,</span> <span class="p">(</span><span class="n">ebk</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="n">ispin</span><span class="p">,</span><span class="n">ik</span><span class="p">)</span><span class="o">/</span><span class="n">eV</span><span class="p">,</span><span class="n">io</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="nb">min</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">no_u</span><span class="p">))</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">no_u</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">10</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(7x,10f7.2)&#39;</span><span class="p">)</span>
     <span class="p">&amp;</span>              <span class="p">(</span><span class="n">ebk</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="n">ispin</span><span class="p">,</span><span class="n">ik</span><span class="p">)</span><span class="o">/</span><span class="n">eV</span><span class="p">,</span><span class="n">io</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span><span class="n">no_u</span><span class="p">)</span>
              <span class="n">enddo</span>
            <span class="n">enddo</span>
          <span class="n">endif</span>
        <span class="n">endif</span>
      <span class="n">endif</span>

<span class="c">!     Print eigenvalues</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">IOnode</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">writeig</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        if</span> <span class="p">((</span><span class="n">isolve</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">SOLVE_DIAGON</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>
     <span class="p">&amp;</span>       <span class="p">((</span><span class="n">isolve</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">SOLVE_MINIM</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">minim_calc_eigenvalues</span><span class="p">))</span>
     <span class="p">&amp;</span>      <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">no_l</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mi">1000</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          if</span> <span class="p">(</span> <span class="n">h_spin_dim</span> <span class="o">&lt;=</span> <span class="mi">2</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,a,/,a4,a3,a7)&#39;</span><span class="p">)</span>
     <span class="p">&amp;</span>       <span class="s1">&#39;siesta: Eigenvalues (eV):&#39;</span><span class="p">,</span> <span class="s1">&#39;ik&#39;</span><span class="p">,</span> <span class="s1">&#39;is&#39;</span><span class="p">,</span> <span class="s1">&#39;eps&#39;</span>
            <span class="k">do </span><span class="n">ik</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">kpoints_scf</span><span class="p">%</span><span class="n">N</span>
              <span class="k">do </span><span class="n">ispin</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">spinor_dim</span>
                <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(i4,i3,10f7.2)&#39;</span><span class="p">)</span>
     <span class="p">&amp;</span>            <span class="n">ik</span><span class="p">,</span><span class="n">ispin</span><span class="p">,(</span><span class="n">eo</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="n">ispin</span><span class="p">,</span><span class="n">ik</span><span class="p">)</span><span class="o">/</span><span class="n">eV</span><span class="p">,</span><span class="n">io</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="nb">min</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">neigwanted</span><span class="p">))</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">no_u</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">10</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(7x,10f7.2)&#39;</span><span class="p">)</span>
     <span class="p">&amp;</span>            <span class="p">(</span><span class="n">eo</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="n">ispin</span><span class="p">,</span><span class="n">ik</span><span class="p">)</span><span class="o">/</span><span class="n">eV</span><span class="p">,</span><span class="n">io</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span><span class="n">neigwanted</span><span class="p">)</span>
              <span class="n">enddo</span>
            <span class="n">enddo</span>
          <span class="k">else</span>
<span class="k">            write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,a)&#39;</span><span class="p">)</span> <span class="s1">&#39;siesta: Eigenvalues (eV):&#39;</span>
            <span class="k">do </span><span class="n">ik</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">kpoints_scf</span><span class="p">%</span><span class="n">N</span>
              <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(a,i6)&#39;</span><span class="p">)</span> <span class="s1">&#39;ik =&#39;</span><span class="p">,</span> <span class="n">ik</span>
              <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(10f7.2)&#39;</span><span class="p">)</span>
     <span class="p">&amp;</span>          <span class="p">((</span><span class="n">eo</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="n">ispin</span><span class="p">,</span><span class="n">ik</span><span class="p">)</span><span class="o">/</span><span class="n">eV</span><span class="p">,</span><span class="n">io</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">neigwanted</span><span class="p">),</span><span class="n">ispin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">enddo</span>
          <span class="n">endif</span>
          <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(a,f15.6,a)&#39;</span><span class="p">)</span> <span class="s1">&#39;siesta: Fermi energy =&#39;</span><span class="p">,</span> <span class="n">ef</span><span class="o">/</span><span class="n">eV</span><span class="p">,</span> <span class="s1">&#39; eV&#39;</span>
        <span class="n">endif</span>
      <span class="n">endif</span>

      <span class="k">if</span> <span class="p">(((</span><span class="n">isolve</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">SOLVE_DIAGON</span><span class="p">).</span><span class="nb">or</span><span class="p">.</span>
     <span class="p">&amp;</span>     <span class="p">((</span><span class="n">isolve</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">SOLVE_MINIM</span><span class="p">).</span><span class="nb">and</span><span class="p">.</span><span class="n">minim_calc_eigenvalues</span><span class="p">))</span>
     <span class="p">&amp;</span>     <span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">IOnode</span><span class="p">)</span>
     <span class="p">&amp;</span>    <span class="k">call </span><span class="n">ioeig</span><span class="p">(</span><span class="n">eo</span><span class="p">,</span><span class="n">ef</span><span class="p">,</span><span class="n">neigwanted</span><span class="p">,</span><span class="n">nspin</span><span class="p">,</span><span class="n">kpoints_scf</span><span class="p">%</span><span class="n">N</span><span class="p">,</span>
     <span class="p">&amp;</span>     <span class="n">no_u</span><span class="p">,</span><span class="n">spinor_dim</span><span class="p">,</span>
     <span class="p">&amp;</span>     <span class="n">kpoints_scf</span><span class="p">%</span><span class="n">N</span><span class="p">,</span> <span class="n">kpoints_scf</span><span class="p">%</span><span class="n">k</span><span class="p">,</span> <span class="n">kpoints_scf</span><span class="p">%</span><span class="n">w</span><span class="p">)</span>


<span class="c">!   This uses H,S, and xa, as it diagonalizes them again</span>
      <span class="k">call </span><span class="n">projected_DOS</span><span class="p">()</span>

<span class="c">!     Print program&#39;s energy decomposition and final forces</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">IOnode</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">siesta_write_energies</span><span class="p">(</span> <span class="n">iscf</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dDmax</span><span class="o">=</span><span class="mf">0._dp</span><span class="p">,</span> <span class="n">dHmax</span><span class="o">=</span><span class="mf">0._dp</span><span class="p">)</span>
        <span class="c">! final == .true. which makes the step counter irrelevant</span>
        <span class="k">call </span><span class="n">siesta_write_forces</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">call </span><span class="n">siesta_write_stress_pressure</span><span class="p">()</span>
        <span class="k">call </span><span class="n">write_basis_enthalpy</span><span class="p">(</span><span class="n">FreeE</span><span class="p">,</span><span class="n">FreeEHarris</span><span class="p">)</span>
      <span class="n">endif</span>

<span class="c">! NOTE: Here, the spin polarization is computed using Dscf, which is</span>
<span class="c">!       a density matrix obtained after mixing the &quot;in&quot; and &quot;out&quot;</span>
<span class="c">!       DMs of the SCF run for the last geometry considered.</span>
<span class="c">!       This can be considered a feature or a bug.</span>

      <span class="k">call </span><span class="n">print_spin</span><span class="p">(</span><span class="n">qspin</span><span class="p">)</span>  <span class="c">! qspin returned for use below</span>

<span class="c">!     This uses the last computed dipole in dhscf during the scf cycle,</span>
<span class="c">!     which is in fact derived from the &quot;in&quot; DM.</span>
<span class="c">!     Perhaps this section should be moved after the call to dhscf below</span>
<span class="c">!     AND use the DM_out of the last step (but there might not be a call</span>
<span class="c">!     to dhscf if there are no files to output, and the computation of the</span>
<span class="c">!     charge density is expensive...</span>

<span class="c">!     Print electric dipole</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">shape</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="s1">&#39;bulk&#39;</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        if</span> <span class="p">(</span><span class="n">IOnode</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,a,3f12.6)&#39;</span><span class="p">)</span>
     <span class="p">&amp;</span>      <span class="s1">&#39;siesta: Electric dipole (a.u.)  =&#39;</span><span class="p">,</span> <span class="n">dipol</span>
          <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(a,3f12.6)&#39;</span><span class="p">)</span>
     <span class="p">&amp;</span>      <span class="s1">&#39;siesta: Electric dipole (Debye) =&#39;</span><span class="p">,</span> 
     <span class="p">&amp;</span>      <span class="p">(</span><span class="n">dipol</span><span class="p">(</span><span class="n">ix</span><span class="p">)</span><span class="o">/</span><span class="n">Debye</span><span class="p">,</span><span class="n">ix</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">endif</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">cml_p</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          call </span><span class="n">cmlAddProperty</span><span class="p">(</span><span class="n">xf</span><span class="o">=</span><span class="n">mainXML</span><span class="p">,</span> <span class="k">value</span><span class="o">=</span><span class="n">dipol</span><span class="o">/</span><span class="n">Debye</span><span class="p">,</span>
     <span class="p">&amp;</span>         <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Electric dipole&#39;</span><span class="p">,</span> <span class="n">dictref</span><span class="o">=</span><span class="s1">&#39;siesta:dipol&#39;</span><span class="p">,</span>
     <span class="p">.</span>         <span class="n">units</span><span class="o">=</span><span class="s1">&#39;siestaUnits:Debye&#39;</span><span class="p">)</span>
        <span class="n">endif</span> <span class="c">!cml_p</span>
      <span class="n">endif</span>

<span class="c">! NOTE: The use of *_last geometries in the following sections</span>
<span class="c">!       guarantees that the analysis of the electronic structure</span>
<span class="c">!       is done for the geometry for which it was computed.</span>

<span class="c">!  BUT these routines need H,S, so H should not be mixed after</span>
<span class="c">!       convergence.</span>

<span class="c">!     Calculation of the bulk polarization using the Berry phase</span>
<span class="c">!     formulas by King-Smith and Vanderbilt</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">nkpol</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="n">bornz</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        if</span> <span class="p">(</span><span class="n">NonCol</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SpOrb</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          if</span> <span class="p">(</span><span class="n">IOnode</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/a)&#39;</span><span class="p">)</span>
     <span class="p">.</span>       <span class="s1">&#39;siesta_analysis: bulk polarization implemented only for&#39;</span>
            <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/a)&#39;</span><span class="p">)</span>
     <span class="p">.</span>       <span class="s1">&#39;siesta_analysis: paramagnetic or collinear spin runs&#39;</span>
          <span class="n">endif</span>
        <span class="k">else</span>
<span class="k">         call </span><span class="n">KSV_pol</span><span class="p">(</span><span class="n">na_u</span><span class="p">,</span> <span class="n">na_s</span><span class="p">,</span> <span class="n">xa_last</span><span class="p">,</span> <span class="n">rmaxo</span><span class="p">,</span> <span class="n">scell_last</span><span class="p">,</span> 
     <span class="p">&amp;</span>               <span class="n">ucell_last</span><span class="p">,</span><span class="n">no_u</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">nspin</span><span class="p">,</span> <span class="n">qspin</span><span class="p">,</span> 
     <span class="p">&amp;</span>               <span class="n">maxnh</span><span class="p">,</span> <span class="n">nkpol</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> 
     <span class="p">&amp;</span>               <span class="n">H</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">xijo</span><span class="p">,</span> <span class="n">indxuo</span><span class="p">,</span> <span class="n">isa</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span> 
     <span class="p">&amp;</span>               <span class="n">iaorb</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span> <span class="nb">shape</span><span class="p">,</span>
     <span class="p">&amp;</span>               <span class="n">nkpol</span><span class="p">,</span><span class="n">kpol</span><span class="p">,</span><span class="n">wgthpol</span><span class="p">,</span> <span class="n">polR</span><span class="p">,</span> <span class="n">polxyz</span> <span class="p">)</span> 
       <span class="n">endif</span>
      <span class="n">endif</span>

<span class="c">!     Calculation of the optical conductivity</span>
      <span class="k">call </span><span class="n">optical</span><span class="p">(</span><span class="n">na_u</span><span class="p">,</span> <span class="n">na_s</span><span class="p">,</span> <span class="n">xa_last</span><span class="p">,</span> <span class="n">scell_last</span><span class="p">,</span> <span class="n">ucell_last</span><span class="p">,</span>
     <span class="p">&amp;</span>             <span class="n">no_u</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">nspin</span><span class="p">,</span> <span class="n">qspin</span><span class="p">,</span>
     <span class="p">&amp;</span>             <span class="n">maxnh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">xijo</span><span class="p">,</span>
     <span class="err">$</span>             <span class="n">indxuo</span><span class="p">,</span> <span class="n">ebk</span><span class="p">,</span> <span class="n">ef</span><span class="p">,</span> <span class="n">temp</span><span class="p">,</span>
     <span class="p">&amp;</span>             <span class="n">isa</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span> <span class="n">iphKB</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span> <span class="n">lastkb</span><span class="p">,</span> <span class="nb">shape</span> <span class="p">)</span>

      <span class="k">call </span><span class="n">de_alloc</span><span class="p">(</span> <span class="n">ebk</span><span class="p">,</span> <span class="s1">&#39;ebk&#39;</span><span class="p">,</span> <span class="s1">&#39;siesta_analysis&#39;</span> <span class="p">)</span>
<span class="c">!...................................</span>

<span class="c">!</span>
<span class="c">!  NOTE: Dscf here might be the mixed one (see above).</span>
<span class="c">!</span>
      <span class="n">want_partial_charges</span> <span class="o">=</span> <span class="p">(</span><span class="n">hirshpop</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">voropop</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>
     <span class="err">$</span>                   <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">partial_charges_at_every_geometry</span><span class="p">)</span>

<span class="c">!     Save electron density and potential</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">saverho</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">savedrho</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">saverhoxc</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> 
     <span class="p">&amp;</span>    <span class="n">savevh</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">savevt</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">savevna</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>
     <span class="p">&amp;</span>    <span class="n">savepsch</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">savetoch</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> 
     <span class="p">&amp;</span>    <span class="n">save_ebs_dens</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> 
     <span class="p">&amp;</span>    <span class="n">want_partial_charges</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        if</span> <span class="p">(</span><span class="n">saverho</span><span class="p">)</span>   <span class="n">filesOut</span><span class="p">%</span><span class="n">rho</span>   <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span> <span class="o">//</span> <span class="s1">&#39;.RHO&#39;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">savedrho</span><span class="p">)</span>  <span class="n">filesOut</span><span class="p">%</span><span class="n">drho</span>  <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span> <span class="o">//</span> <span class="s1">&#39;.DRHO&#39;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">saverhoxc</span><span class="p">)</span> <span class="n">filesOut</span><span class="p">%</span><span class="n">rhoxc</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span> <span class="o">//</span> <span class="s1">&#39;.RHOXC&#39;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">save_ebs_dens</span><span class="p">)</span> <span class="n">filesOut</span><span class="p">%</span><span class="n">ebs_dens</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span> <span class="o">//</span> <span class="s1">&#39;.EBS&#39;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">savevh</span><span class="p">)</span>    <span class="n">filesOut</span><span class="p">%</span><span class="n">vh</span>    <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span> <span class="o">//</span> <span class="s1">&#39;.VH&#39;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">savevt</span><span class="p">)</span>    <span class="n">filesOut</span><span class="p">%</span><span class="n">vt</span>    <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span> <span class="o">//</span> <span class="s1">&#39;.VT&#39;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">savevna</span><span class="p">)</span>   <span class="n">filesOut</span><span class="p">%</span><span class="n">vna</span>   <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span> <span class="o">//</span> <span class="s1">&#39;.VNA&#39;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">savepsch</span><span class="p">)</span>  <span class="n">filesOut</span><span class="p">%</span><span class="n">psch</span>  <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span> <span class="o">//</span> <span class="s1">&#39;.IOCH&#39;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">savetoch</span><span class="p">)</span>  <span class="n">filesOut</span><span class="p">%</span><span class="n">toch</span>  <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span> <span class="o">//</span> <span class="s1">&#39;.TOCH&#39;</span>
        <span class="n">g2max</span> <span class="o">=</span> <span class="n">g2cut</span>
        <span class="n">dummy_str</span>  <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">dummy_strl</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">call </span><span class="n">dhscf</span><span class="p">(</span> <span class="n">nspin</span><span class="p">,</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">iaorb</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span>
     <span class="p">.</span>              <span class="n">no_u</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">na_s</span><span class="p">,</span> <span class="n">isa</span><span class="p">,</span> <span class="n">xa_last</span><span class="p">,</span> <span class="n">indxua</span><span class="p">,</span> 
     <span class="p">&amp;</span>              <span class="n">ntm</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">filesOut</span><span class="p">,</span> 
     <span class="p">&amp;</span>              <span class="n">maxnh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">Dscf</span><span class="p">,</span> <span class="n">Datm</span><span class="p">,</span>
     <span class="p">&amp;</span>              <span class="n">maxnh</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">Enaatm</span><span class="p">,</span> <span class="n">Enascf</span><span class="p">,</span> <span class="n">Uatm</span><span class="p">,</span> <span class="n">Uscf</span><span class="p">,</span> <span class="n">DUscf</span><span class="p">,</span> <span class="n">DUext</span><span class="p">,</span>
     <span class="p">&amp;</span>              <span class="n">Exc</span><span class="p">,</span> <span class="n">Dxc</span><span class="p">,</span> <span class="n">dipol</span><span class="p">,</span> <span class="n">dummy_str</span><span class="p">,</span> <span class="n">fa</span><span class="p">,</span> <span class="n">dummy_strl</span> <span class="p">)</span>
                    <span class="c">! next to last argument is dummy here,</span>
                    <span class="c">! as no forces are calculated</span>
                    <span class="c">! todo: make all these optional</span>
      <span class="n">endif</span>
<span class="n">C</span>    
<span class="n">C</span>     <span class="k">Call </span><span class="n">the</span> <span class="n">wannier90</span> <span class="k">interface </span><span class="n">here</span><span class="p">,</span> <span class="n">as</span> <span class="n">local_DOS</span> <span class="n">destroys</span> <span class="n">the</span> <span class="n">DM</span><span class="p">...</span>
<span class="n">C</span>
      <span class="k">if</span><span class="p">(</span> <span class="n">w90_processing</span> <span class="p">)</span> <span class="k">call </span><span class="n">siesta2wannier90</span><span class="p">()</span>

<span class="n">C</span>     <span class="n">Find</span> <span class="n">local</span> <span class="n">density</span> <span class="n">of</span> <span class="n">states</span>
<span class="c">!  It needs H,S, and xa, as it diagonalizes them again</span>
<span class="c">!  NOTE: This call will obliterate Dscf</span>
<span class="c">!  It is better to put a explicit out argument for the partial DM computed.</span>
      <span class="k">call </span><span class="n">local_DOS</span><span class="p">()</span>

<span class="c">! In summary, it is better to:</span>
<span class="c">!</span>
<span class="c">!   -- Avoid (or warn the user about) doing any analysis if the calculation is not converged</span>
<span class="c">!   -- Avoid mixing DM or H after scf convergence</span>
<span class="c">!   -- Set xa to xa_last at the top of this file. Write any &quot;next iter&quot; coordinate file</span>
<span class="c">!      in &#39;siesta_move&#39;</span>

      <span class="n">endif</span> <span class="c">! SIESTA_worker</span>
<span class="cp">#ifdef SIESTA__PEXSI</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">fdf_get</span><span class="p">(</span><span class="s2">&quot;PEXSI.LDOS&quot;</span><span class="p">,.</span><span class="n">false</span><span class="p">.))</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">pexsi_local_DOS</span><span class="p">()</span>
      <span class="n">endif</span>
<span class="cp">#endif</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">SIESTA_worker</span><span class="p">)</span> <span class="k">call </span><span class="n">timer</span><span class="p">(</span><span class="s2">&quot;Analysis&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

<span class="c">!------------------------------------------------------------------------- END</span>
      <span class="k">END subroutine </span><span class="n">siesta_analysis</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2018 <a rel="license" href="http://www.gnu.org/licenses/old-licenses/fdl-1.2.en.html">GNU Free Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> SIESTA was developed by SIESTA Group</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>