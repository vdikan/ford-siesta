<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="A first-principles materials simulation code using Density Functional Theory.">
    
    <meta name="author" content="SIESTA Group" >
    <link rel="icon" href="../favicon.png">

    <title>compute_dm &ndash; SIESTA</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">SIESTA <small>trunk-700--vdikan-edens-711-ford-681</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>Program Overview</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>compute_dm
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 1.4% of total for procedures.">132 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/compute_dm.F"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/compute_dm.f.html'>compute_dm.F</a></li>
    
     <li><a href='../module/m_compute_dm.html'>m_compute_dm</a></li>
    
  
     <li class="active">compute_dm</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/compute_dm.html#src">compute_dm</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine compute_dm(iscf)
    
    
   
</h2>
    
  
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
      
      <li class="list-group-item">
  <ul class="list-inline">
    
    <li><a href='../module/precision.html'>precision</a></li>
    
    <li><a href='../module/units.html'>units</a></li>
    
    <li><a href='../module/siesta_options.html'>siesta_options</a></li>
    
    <li>class_dSpData1D</li>
    
    <li>sparse_matrices</li>
    
    <li>siesta_geom</li>
    
    <li>atomlist</li>
    
    <li><a href='../module/sys.html'>sys</a></li>
    
    <li>kpoint_scf_m</li>
    
    <li>m_energies</li>
    
    <li>m_energies</li>
    
    <li>m_rmaxh</li>
    
    <li>m_eo</li>
    
    <li>m_spin</li>
    
    <li>m_diagon</li>
    
    <li>m_gamma</li>
    
    <li><a href='../module/parallel.html'>parallel</a></li>
    
    <li><a href='../module/parallel.html'>parallel</a></li>
    
    <li>m_compute_ebs_shift</li>
    
    <li>m_pexsi_solver</li>
    
    <li>m_hsx</li>
    
    <li>mpi_siesta</li>
    
    <li>iodmhs_netcdf</li>
    
    <li>m_dminim</li>
    
    <li>m_zminim</li>
    
    <li>m_ordern</li>
    
    <li>m_steps</li>
    
    <li>m_normalize_dm</li>
    
    <li>m_chess</li>
    
    <li>m_energies</li>
    
    <li>m_ts_global_vars</li>
    
    <li>m_transiesta</li>
    
  </ul>
      </li>
      
      
      
      <li class="list-group-item">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~compute_dm~~UsesGraph Pages: 1 -->
<svg id="proccompute_dmUsesGraph" width="328pt" height="1204pt"
 viewBox="0.00 0.00 328.00 1204.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~compute_dm~~UsesGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 1200)">
<title>proc~~compute_dm~~UsesGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1200 324,-1200 324,4 -4,4"/>
<!-- proc~compute_dm -->
<g id="proc~~compute_dm~~UsesGraph_node1" class="node"><title>proc~compute_dm</title>
<polygon fill="none" stroke="black" points="320,-608 245,-608 245,-584 320,-584 320,-608"/>
<text text-anchor="middle" x="282.5" y="-593.6" font-family="Helvetica,sans-Serif" font-size="10.50">compute_dm</text>
</g>
<!-- m_diagon -->
<g id="proc~~compute_dm~~UsesGraph_node2" class="node"><title>m_diagon</title>
<polygon fill="#337ab7" stroke="#337ab7" points="180,-1196 120,-1196 120,-1172 180,-1172 180,-1196"/>
<text text-anchor="middle" x="150" y="-1181.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_diagon</text>
</g>
<!-- proc~compute_dm&#45;&gt;m_diagon -->
<g id="proc~~compute_dm~~UsesGraph_edge22" class="edge"><title>proc~compute_dm&#45;&gt;m_diagon</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M281.608,-608.122C282.032,-682.173 280.808,-1073.34 209,-1163 204.01,-1169.23 197.01,-1173.61 189.593,-1176.69"/>
<polygon fill="#000000" stroke="#000000" points="188.422,-1173.4 180.094,-1179.95 190.689,-1180.02 188.422,-1173.4"/>
</g>
<!-- m_eo -->
<g id="proc~~compute_dm~~UsesGraph_node3" class="node"><title>m_eo</title>
<polygon fill="#337ab7" stroke="#337ab7" points="177,-1154 123,-1154 123,-1130 177,-1130 177,-1154"/>
<text text-anchor="middle" x="150" y="-1139.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_eo</text>
</g>
<!-- proc~compute_dm&#45;&gt;m_eo -->
<g id="proc~~compute_dm~~UsesGraph_edge27" class="edge"><title>proc~compute_dm&#45;&gt;m_eo</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M281.471,-608.136C281.065,-678.958 275.705,-1038.57 209,-1121 203.383,-1127.94 195.273,-1132.59 186.89,-1135.7"/>
<polygon fill="#000000" stroke="#000000" points="185.603,-1132.43 177.055,-1138.69 187.641,-1139.13 185.603,-1132.43"/>
</g>
<!-- module~units -->
<g id="proc~~compute_dm~~UsesGraph_node4" class="node"><title>module~units</title>
<g id="a_proc~~compute_dm~~UsesGraph_node4"><a xlink:href=".././module/units.html" xlink:title="units">
<polygon fill="#337ab7" stroke="#337ab7" points="177,-1112 123,-1112 123,-1088 177,-1088 177,-1112"/>
<text text-anchor="middle" x="150" y="-1097.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">units</text>
</a>
</g>
</g>
<!-- proc~compute_dm&#45;&gt;module~units -->
<g id="proc~~compute_dm~~UsesGraph_edge3" class="edge"><title>proc~compute_dm&#45;&gt;module~units</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M281.312,-608.035C280.031,-675.236 270.65,-1003.72 209,-1079 203.343,-1085.91 195.218,-1090.54 186.834,-1093.65"/>
<polygon fill="#000000" stroke="#000000" points="185.549,-1090.39 177.004,-1096.65 187.59,-1097.08 185.549,-1090.39"/>
</g>
<!-- m_ts_global_vars -->
<g id="proc~~compute_dm~~UsesGraph_node5" class="node"><title>m_ts_global_vars</title>
<polygon fill="#337ab7" stroke="#337ab7" points="198.5,-1070 101.5,-1070 101.5,-1046 198.5,-1046 198.5,-1070"/>
<text text-anchor="middle" x="150" y="-1055.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_global_vars</text>
</g>
<!-- proc~compute_dm&#45;&gt;m_ts_global_vars -->
<g id="proc~~compute_dm~~UsesGraph_edge4" class="edge"><title>proc~compute_dm&#45;&gt;m_ts_global_vars</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M281.116,-608.231C278.872,-672.309 265.52,-968.96 209,-1037 208.264,-1037.89 207.488,-1038.73 206.676,-1039.55"/>
<polygon fill="#000000" stroke="#000000" points="204.239,-1037.01 198.53,-1045.93 208.558,-1042.52 204.239,-1037.01"/>
</g>
<!-- module~parallel -->
<g id="proc~~compute_dm~~UsesGraph_node6" class="node"><title>module~parallel</title>
<g id="a_proc~~compute_dm~~UsesGraph_node6"><a xlink:href=".././module/parallel.html" xlink:title="parallel">
<polygon fill="#337ab7" stroke="#337ab7" points="177,-1028 123,-1028 123,-1004 177,-1004 177,-1028"/>
<text text-anchor="middle" x="150" y="-1013.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel</text>
</a>
</g>
</g>
<!-- proc~compute_dm&#45;&gt;module~parallel -->
<g id="proc~~compute_dm~~UsesGraph_edge5" class="edge"><title>proc~compute_dm&#45;&gt;module~parallel</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M280.884,-608.248C277.614,-668.623 260.462,-934.097 209,-995 203.287,-1001.76 195.217,-1006.35 186.907,-1009.45"/>
<polygon fill="#000000" stroke="#000000" points="185.687,-1006.17 177.169,-1012.47 187.757,-1012.85 185.687,-1006.17"/>
</g>
<!-- m_energies -->
<g id="proc~~compute_dm~~UsesGraph_node7" class="node"><title>m_energies</title>
<polygon fill="#337ab7" stroke="#337ab7" points="184.5,-986 115.5,-986 115.5,-962 184.5,-962 184.5,-986"/>
<text text-anchor="middle" x="150" y="-971.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_energies</text>
</g>
<!-- proc~compute_dm&#45;&gt;m_energies -->
<g id="proc~~compute_dm~~UsesGraph_edge6" class="edge"><title>proc~compute_dm&#45;&gt;m_energies</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M280.613,-608.067C276.261,-664.179 255.479,-899.13 209,-953 204.966,-957.675 199.808,-961.309 194.235,-964.135"/>
<polygon fill="#000000" stroke="#000000" points="192.468,-961.08 184.592,-968.167 195.169,-967.538 192.468,-961.08"/>
</g>
<!-- m_ordern -->
<g id="proc~~compute_dm~~UsesGraph_node8" class="node"><title>m_ordern</title>
<polygon fill="#337ab7" stroke="#337ab7" points="179.5,-944 120.5,-944 120.5,-920 179.5,-920 179.5,-944"/>
<text text-anchor="middle" x="150" y="-929.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ordern</text>
</g>
<!-- proc~compute_dm&#45;&gt;m_ordern -->
<g id="proc~~compute_dm~~UsesGraph_edge7" class="edge"><title>proc~compute_dm&#45;&gt;m_ordern</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M280.264,-608.018C274.708,-659.9 250.484,-864.158 209,-911 203.708,-916.975 196.582,-921.251 189.137,-924.311"/>
<polygon fill="#000000" stroke="#000000" points="187.97,-921.011 179.651,-927.572 190.246,-927.631 187.97,-921.011"/>
</g>
<!-- module~sys -->
<g id="proc~~compute_dm~~UsesGraph_node9" class="node"><title>module~sys</title>
<g id="a_proc~~compute_dm~~UsesGraph_node9"><a xlink:href=".././module/sys.html" xlink:title="sys">
<polygon fill="#337ab7" stroke="#337ab7" points="177,-902 123,-902 123,-878 177,-878 177,-902"/>
<text text-anchor="middle" x="150" y="-887.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sys</text>
</a>
</g>
</g>
<!-- proc~compute_dm&#45;&gt;module~sys -->
<g id="proc~~compute_dm~~UsesGraph_edge8" class="edge"><title>proc~compute_dm&#45;&gt;module~sys</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M281.983,-608.191C282.97,-650.237 280.54,-790.886 209,-869 203.074,-875.471 194.999,-879.951 186.759,-883.052"/>
<polygon fill="#000000" stroke="#000000" points="185.609,-879.744 177.128,-886.095 187.718,-886.419 185.609,-879.744"/>
</g>
<!-- kpoint_scf_m -->
<g id="proc~~compute_dm~~UsesGraph_node10" class="node"><title>kpoint_scf_m</title>
<polygon fill="#337ab7" stroke="#337ab7" points="188,-860 112,-860 112,-836 188,-836 188,-860"/>
<text text-anchor="middle" x="150" y="-845.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">kpoint_scf_m</text>
</g>
<!-- proc~compute_dm&#45;&gt;kpoint_scf_m -->
<g id="proc~~compute_dm~~UsesGraph_edge9" class="edge"><title>proc~compute_dm&#45;&gt;kpoint_scf_m</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M281.283,-608.155C279.949,-645.911 270.778,-762.49 209,-827 205.614,-830.536 201.587,-833.479 197.257,-835.928"/>
<polygon fill="#000000" stroke="#000000" points="195.587,-832.846 188.05,-840.292 198.585,-839.171 195.587,-832.846"/>
</g>
<!-- atomlist -->
<g id="proc~~compute_dm~~UsesGraph_node11" class="node"><title>atomlist</title>
<polygon fill="#337ab7" stroke="#337ab7" points="177,-818 123,-818 123,-794 177,-794 177,-818"/>
<text text-anchor="middle" x="150" y="-803.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">atomlist</text>
</g>
<!-- proc~compute_dm&#45;&gt;atomlist -->
<g id="proc~~compute_dm~~UsesGraph_edge28" class="edge"><title>proc~compute_dm&#45;&gt;atomlist</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M280.312,-608.042C276.427,-641.031 261.175,-733.802 209,-785 202.914,-790.972 195.002,-795.261 186.99,-798.336"/>
<polygon fill="#000000" stroke="#000000" points="185.697,-795.076 177.283,-801.516 187.876,-801.729 185.697,-795.076"/>
</g>
<!-- m_steps -->
<g id="proc~~compute_dm~~UsesGraph_node12" class="node"><title>m_steps</title>
<polygon fill="#337ab7" stroke="#337ab7" points="177,-776 123,-776 123,-752 177,-752 177,-776"/>
<text text-anchor="middle" x="150" y="-761.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_steps</text>
</g>
<!-- proc~compute_dm&#45;&gt;m_steps -->
<g id="proc~~compute_dm~~UsesGraph_edge11" class="edge"><title>proc~compute_dm&#45;&gt;m_steps</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M278.801,-608.158C272.008,-635.99 251.621,-704.858 209,-743 202.702,-748.636 194.776,-752.792 186.824,-755.846"/>
<polygon fill="#000000" stroke="#000000" points="185.597,-752.566 177.218,-759.05 187.812,-759.206 185.597,-752.566"/>
</g>
<!-- m_normalize_dm -->
<g id="proc~~compute_dm~~UsesGraph_node13" class="node"><title>m_normalize_dm</title>
<polygon fill="#337ab7" stroke="#337ab7" points="197.5,-734 102.5,-734 102.5,-710 197.5,-710 197.5,-734"/>
<text text-anchor="middle" x="150" y="-719.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_normalize_dm</text>
</g>
<!-- proc~compute_dm&#45;&gt;m_normalize_dm -->
<g id="proc~~compute_dm~~UsesGraph_edge12" class="edge"><title>proc~compute_dm&#45;&gt;m_normalize_dm</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M276.174,-608.213C266.121,-629.908 242.329,-675.296 209,-701 207.174,-702.408 205.245,-703.728 203.243,-704.964"/>
<polygon fill="#000000" stroke="#000000" points="201.255,-702.059 194.093,-709.866 204.561,-708.229 201.255,-702.059"/>
</g>
<!-- m_compute_ebs_shift -->
<g id="proc~~compute_dm~~UsesGraph_node14" class="node"><title>m_compute_ebs_shift</title>
<polygon fill="#337ab7" stroke="#337ab7" points="209,-692 91,-692 91,-668 209,-668 209,-692"/>
<text text-anchor="middle" x="150" y="-677.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_compute_ebs_shift</text>
</g>
<!-- proc~compute_dm&#45;&gt;m_compute_ebs_shift -->
<g id="proc~~compute_dm~~UsesGraph_edge13" class="edge"><title>proc~compute_dm&#45;&gt;m_compute_ebs_shift</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M270.25,-608.183C256.827,-622.109 233.151,-644.804 209,-659 206.138,-660.682 203.119,-662.265 200.022,-663.748"/>
<polygon fill="#000000" stroke="#000000" points="198.328,-660.669 190.58,-667.895 201.144,-667.078 198.328,-660.669"/>
</g>
<!-- siesta_geom -->
<g id="proc~~compute_dm~~UsesGraph_node15" class="node"><title>siesta_geom</title>
<polygon fill="#337ab7" stroke="#337ab7" points="186.5,-650 113.5,-650 113.5,-626 186.5,-626 186.5,-650"/>
<text text-anchor="middle" x="150" y="-635.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_geom</text>
</g>
<!-- proc~compute_dm&#45;&gt;siesta_geom -->
<g id="proc~~compute_dm~~UsesGraph_edge14" class="edge"><title>proc~compute_dm&#45;&gt;siesta_geom</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M244.801,-607.811C229.693,-612.674 212.041,-618.355 196.151,-623.469"/>
<polygon fill="#000000" stroke="#000000" points="194.971,-620.172 186.524,-626.567 197.115,-626.835 194.971,-620.172"/>
</g>
<!-- iodmhs_netcdf -->
<g id="proc~~compute_dm~~UsesGraph_node16" class="node"><title>iodmhs_netcdf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="191,-608 109,-608 109,-584 191,-584 191,-608"/>
<text text-anchor="middle" x="150" y="-593.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iodmhs_netcdf</text>
</g>
<!-- proc~compute_dm&#45;&gt;iodmhs_netcdf -->
<g id="proc~~compute_dm~~UsesGraph_edge15" class="edge"><title>proc~compute_dm&#45;&gt;iodmhs_netcdf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M244.801,-596C231.334,-596 215.845,-596 201.385,-596"/>
<polygon fill="#000000" stroke="#000000" points="201.082,-592.5 191.081,-596 201.081,-599.5 201.082,-592.5"/>
</g>
<!-- m_pexsi_solver -->
<g id="proc~~compute_dm~~UsesGraph_node17" class="node"><title>m_pexsi_solver</title>
<polygon fill="#337ab7" stroke="#337ab7" points="193.5,-566 106.5,-566 106.5,-542 193.5,-542 193.5,-566"/>
<text text-anchor="middle" x="150" y="-551.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_pexsi_solver</text>
</g>
<!-- proc~compute_dm&#45;&gt;m_pexsi_solver -->
<g id="proc~~compute_dm~~UsesGraph_edge16" class="edge"><title>proc~compute_dm&#45;&gt;m_pexsi_solver</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M244.801,-584.189C230.33,-579.532 213.525,-574.123 198.171,-569.181"/>
<polygon fill="#000000" stroke="#000000" points="198.921,-565.746 188.329,-566.014 196.776,-572.409 198.921,-565.746"/>
</g>
<!-- m_hsx -->
<g id="proc~~compute_dm~~UsesGraph_node18" class="node"><title>m_hsx</title>
<polygon fill="#337ab7" stroke="#337ab7" points="177,-524 123,-524 123,-500 177,-500 177,-524"/>
<text text-anchor="middle" x="150" y="-509.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_hsx</text>
</g>
<!-- proc~compute_dm&#45;&gt;m_hsx -->
<g id="proc~~compute_dm~~UsesGraph_edge17" class="edge"><title>proc~compute_dm&#45;&gt;m_hsx</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M270.25,-583.817C256.827,-569.891 233.151,-547.196 209,-533 202.054,-528.917 194.181,-525.42 186.527,-522.518"/>
<polygon fill="#000000" stroke="#000000" points="187.628,-519.195 177.033,-519.16 185.294,-525.794 187.628,-519.195"/>
</g>
<!-- module~siesta_options -->
<g id="proc~~compute_dm~~UsesGraph_node19" class="node"><title>module~siesta_options</title>
<g id="a_proc~~compute_dm~~UsesGraph_node19"><a xlink:href=".././module/siesta_options.html" xlink:title="siesta_options">
<polygon fill="#337ab7" stroke="#337ab7" points="190.5,-482 109.5,-482 109.5,-458 190.5,-458 190.5,-482"/>
<text text-anchor="middle" x="150" y="-467.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_options</text>
</a>
</g>
</g>
<!-- proc~compute_dm&#45;&gt;module~siesta_options -->
<g id="proc~~compute_dm~~UsesGraph_edge18" class="edge"><title>proc~compute_dm&#45;&gt;module~siesta_options</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M276.174,-583.787C266.121,-562.092 242.329,-516.704 209,-491 206.202,-488.842 203.161,-486.891 199.987,-485.13"/>
<polygon fill="#000000" stroke="#000000" points="201.303,-481.878 190.779,-480.656 198.243,-488.174 201.303,-481.878"/>
</g>
<!-- m_dminim -->
<g id="proc~~compute_dm~~UsesGraph_node20" class="node"><title>m_dminim</title>
<polygon fill="#337ab7" stroke="#337ab7" points="181,-440 119,-440 119,-416 181,-416 181,-440"/>
<text text-anchor="middle" x="150" y="-425.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_dminim</text>
</g>
<!-- proc~compute_dm&#45;&gt;m_dminim -->
<g id="proc~~compute_dm~~UsesGraph_edge19" class="edge"><title>proc~compute_dm&#45;&gt;m_dminim</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M278.801,-583.842C272.008,-556.01 251.621,-487.142 209,-449 203.746,-444.298 197.357,-440.625 190.766,-437.764"/>
<polygon fill="#000000" stroke="#000000" points="191.664,-434.362 181.072,-434.126 189.204,-440.916 191.664,-434.362"/>
</g>
<!-- m_chess -->
<g id="proc~~compute_dm~~UsesGraph_node21" class="node"><title>m_chess</title>
<polygon fill="#337ab7" stroke="#337ab7" points="177.5,-398 122.5,-398 122.5,-374 177.5,-374 177.5,-398"/>
<text text-anchor="middle" x="150" y="-383.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_chess</text>
</g>
<!-- proc~compute_dm&#45;&gt;m_chess -->
<g id="proc~~compute_dm~~UsesGraph_edge20" class="edge"><title>proc~compute_dm&#45;&gt;m_chess</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M280.312,-583.958C276.427,-550.969 261.175,-458.198 209,-407 202.968,-401.081 195.144,-396.816 187.205,-393.747"/>
<polygon fill="#000000" stroke="#000000" points="188.171,-390.38 177.577,-390.566 185.975,-397.027 188.171,-390.38"/>
</g>
<!-- mpi_siesta -->
<g id="proc~~compute_dm~~UsesGraph_node22" class="node"><title>mpi_siesta</title>
<polygon fill="#337ab7" stroke="#337ab7" points="182,-356 118,-356 118,-332 182,-332 182,-356"/>
<text text-anchor="middle" x="150" y="-341.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_siesta</text>
</g>
<!-- proc~compute_dm&#45;&gt;mpi_siesta -->
<g id="proc~~compute_dm~~UsesGraph_edge21" class="edge"><title>proc~compute_dm&#45;&gt;mpi_siesta</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M281.283,-583.845C279.949,-546.089 270.778,-429.51 209,-365 204.173,-359.959 198.044,-356.124 191.59,-353.207"/>
<polygon fill="#000000" stroke="#000000" points="192.605,-349.849 182.015,-349.557 190.112,-356.39 192.605,-349.849"/>
</g>
<!-- m_spin -->
<g id="proc~~compute_dm~~UsesGraph_node23" class="node"><title>m_spin</title>
<polygon fill="#337ab7" stroke="#337ab7" points="177,-314 123,-314 123,-290 177,-290 177,-314"/>
<text text-anchor="middle" x="150" y="-299.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_spin</text>
</g>
<!-- proc~compute_dm&#45;&gt;m_spin -->
<g id="proc~~compute_dm~~UsesGraph_edge1" class="edge"><title>proc~compute_dm&#45;&gt;m_spin</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M281.983,-583.809C282.97,-541.763 280.54,-401.114 209,-323 203.074,-316.529 194.999,-312.049 186.759,-308.948"/>
<polygon fill="#000000" stroke="#000000" points="187.718,-305.581 177.128,-305.905 185.609,-312.256 187.718,-305.581"/>
</g>
<!-- m_transiesta -->
<g id="proc~~compute_dm~~UsesGraph_node24" class="node"><title>m_transiesta</title>
<polygon fill="#337ab7" stroke="#337ab7" points="187,-272 113,-272 113,-248 187,-248 187,-272"/>
<text text-anchor="middle" x="150" y="-257.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_transiesta</text>
</g>
<!-- proc~compute_dm&#45;&gt;m_transiesta -->
<g id="proc~~compute_dm~~UsesGraph_edge23" class="edge"><title>proc~compute_dm&#45;&gt;m_transiesta</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M280.264,-583.982C274.708,-532.1 250.484,-327.842 209,-281 205.495,-277.043 201.186,-273.831 196.513,-271.224"/>
<polygon fill="#000000" stroke="#000000" points="197.738,-267.935 187.192,-266.92 194.803,-274.29 197.738,-267.935"/>
</g>
<!-- class_dSpData1D -->
<g id="proc~~compute_dm~~UsesGraph_node25" class="node"><title>class_dSpData1D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="198.5,-230 101.5,-230 101.5,-206 198.5,-206 198.5,-230"/>
<text text-anchor="middle" x="150" y="-215.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_dSpData1D</text>
</g>
<!-- proc~compute_dm&#45;&gt;class_dSpData1D -->
<g id="proc~~compute_dm~~UsesGraph_edge24" class="edge"><title>proc~compute_dm&#45;&gt;class_dSpData1D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M280.613,-583.933C276.261,-527.821 255.479,-292.87 209,-239 208.134,-237.997 207.217,-237.041 206.254,-236.131"/>
<polygon fill="#000000" stroke="#000000" points="208.212,-233.224 198.116,-230.012 204.005,-238.819 208.212,-233.224"/>
</g>
<!-- module~precision -->
<g id="proc~~compute_dm~~UsesGraph_node26" class="node"><title>module~precision</title>
<g id="a_proc~~compute_dm~~UsesGraph_node26"><a xlink:href=".././module/precision.html" xlink:title="precision">
<polygon fill="#337ab7" stroke="#337ab7" points="55,-651 0,-651 0,-627 55,-627 55,-651"/>
<text text-anchor="middle" x="27.5" y="-636.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">precision</text>
</a>
</g>
</g>
<!-- proc~compute_dm&#45;&gt;module~precision -->
<g id="proc~~compute_dm~~UsesGraph_edge25" class="edge"><title>proc~compute_dm&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M281.281,-583.771C279.904,-522.323 270.348,-248.205 209,-197 168.738,-163.394 130.595,-162.61 91,-197 27.1541,-252.453 26.7428,-534.573 28.0109,-616.602"/>
<polygon fill="#000000" stroke="#000000" points="24.515,-616.869 28.1945,-626.804 31.5139,-616.743 24.515,-616.869"/>
</g>
<!-- m_gamma -->
<g id="proc~~compute_dm~~UsesGraph_node27" class="node"><title>m_gamma</title>
<polygon fill="#337ab7" stroke="#337ab7" points="182,-150 118,-150 118,-126 182,-126 182,-150"/>
<text text-anchor="middle" x="150" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_gamma</text>
</g>
<!-- proc~compute_dm&#45;&gt;m_gamma -->
<g id="proc~~compute_dm~~UsesGraph_edge26" class="edge"><title>proc~compute_dm&#45;&gt;m_gamma</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M280.971,-583.675C278.032,-520.408 261.889,-232.454 209,-164 204.408,-158.057 198.158,-153.436 191.456,-149.854"/>
<polygon fill="#000000" stroke="#000000" points="192.699,-146.574 182.15,-145.588 189.782,-152.937 192.699,-146.574"/>
</g>
<!-- sparse_matrices -->
<g id="proc~~compute_dm~~UsesGraph_node28" class="node"><title>sparse_matrices</title>
<polygon fill="#337ab7" stroke="#337ab7" points="195.5,-108 104.5,-108 104.5,-84 195.5,-84 195.5,-108"/>
<text text-anchor="middle" x="150" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sparse_matrices</text>
</g>
<!-- proc~compute_dm&#45;&gt;sparse_matrices -->
<g id="proc~~compute_dm~~UsesGraph_edge2" class="edge"><title>proc~compute_dm&#45;&gt;sparse_matrices</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M281.288,-583.624C279.894,-515.997 270.063,-191.468 209,-117 207.538,-115.217 205.912,-113.585 204.159,-112.092"/>
<polygon fill="#000000" stroke="#000000" points="206.019,-109.125 195.782,-106.393 202.081,-114.912 206.019,-109.125"/>
</g>
<!-- m_rmaxh -->
<g id="proc~~compute_dm~~UsesGraph_node29" class="node"><title>m_rmaxh</title>
<polygon fill="#337ab7" stroke="#337ab7" points="179,-66 121,-66 121,-42 179,-42 179,-66"/>
<text text-anchor="middle" x="150" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_rmaxh</text>
</g>
<!-- proc~compute_dm&#45;&gt;m_rmaxh -->
<g id="proc~~compute_dm~~UsesGraph_edge10" class="edge"><title>proc~compute_dm&#45;&gt;m_rmaxh</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M281.457,-583.956C280.974,-513.669 275.249,-156.784 209,-75 203.776,-68.5515 196.401,-64.0827 188.654,-60.9861"/>
<polygon fill="#000000" stroke="#000000" points="189.735,-57.657 179.142,-57.8484 187.542,-64.3047 189.735,-57.657"/>
</g>
<!-- m_zminim -->
<g id="proc~~compute_dm~~UsesGraph_node30" class="node"><title>m_zminim</title>
<polygon fill="#337ab7" stroke="#337ab7" points="180.5,-24 119.5,-24 119.5,-0 180.5,-0 180.5,-24"/>
<text text-anchor="middle" x="150" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_zminim</text>
</g>
<!-- proc~compute_dm&#45;&gt;m_zminim -->
<g id="proc~~compute_dm~~UsesGraph_edge29" class="edge"><title>proc~compute_dm&#45;&gt;m_zminim</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M281.595,-583.963C281.944,-510.431 280.349,-122.004 209,-33 204.211,-27.0256 197.572,-22.7504 190.491,-19.6911"/>
<polygon fill="#000000" stroke="#000000" points="191.288,-16.2606 180.693,-16.2278 188.955,-22.8604 191.288,-16.2606"/>
</g>
<!-- module~units&#45;&gt;module~precision -->
<g id="proc~~compute_dm~~UsesGraph_edge30" class="edge"><title>module~units&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M122.962,-1096.68C111.476,-1093.86 98.833,-1088.64 91,-1079 38.1385,-1013.93 29.9858,-742.273 28.729,-661.651"/>
<polygon fill="#000000" stroke="#000000" points="32.2226,-661.142 28.5891,-651.19 25.2232,-661.235 32.2226,-661.142"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="490pt" height="32pt"
 viewBox="0.00 0.00 489.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 485.5,-28 485.5,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node"><title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node"><title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="139.5,-24 72.5,-24 72.5,-0 139.5,-0 139.5,-24"/>
<text text-anchor="middle" x="106" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="222,-24 158,-24 158,-0 222,-0 222,-24"/>
<text text-anchor="middle" x="190" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="294,-24 240,-24 240,-0 294,-0 294,-24"/>
<text text-anchor="middle" x="267" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="366,-24 312,-24 312,-0 366,-0 366,-24"/>
<text text-anchor="middle" x="339" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="481.5,-24 384.5,-24 384.5,-0 481.5,-0 481.5,-24"/>
<text text-anchor="middle" x="433" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses.
    </p>
    </div></div></div></div>
      </li>
      
      </ul>
    </div>
    


    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iscf%7E3"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>iscf</strong></td><td></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~compute_dm~~CallsGraph Pages: 1 -->
<svg id="proccompute_dmCallsGraph" width="328pt" height="830pt"
 viewBox="0.00 0.00 328.00 830.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~compute_dm~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 826)">
<title>proc~~compute_dm~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-826 324,-826 324,4 -4,4"/>
<!-- proc~compute_dm -->
<g id="proc~~compute_dm~~CallsGraph_node1" class="node"><title>proc~compute_dm</title>
<polygon fill="none" stroke="black" points="75,-423 7.10543e-15,-423 7.10543e-15,-399 75,-399 75,-423"/>
<text text-anchor="middle" x="37.5" y="-408.6" font-family="Helvetica,sans-Serif" font-size="10.50">compute_dm</text>
</g>
<!-- ordern -->
<g id="proc~~compute_dm~~CallsGraph_node2" class="node"><title>ordern</title>
<polygon fill="#777777" stroke="#777777" points="190,-822 136,-822 136,-798 190,-798 190,-822"/>
<text text-anchor="middle" x="163" y="-807.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ordern</text>
</g>
<!-- proc~compute_dm&#45;&gt;ordern -->
<g id="proc~~compute_dm~~CallsGraph_edge1" class="edge"><title>proc~compute_dm&#45;&gt;ordern</title>
<path fill="none" stroke="#000000" d="M39.3127,-423.333C43.3905,-481.8 63.343,-730.647 111,-789 115.094,-794.013 120.582,-797.843 126.442,-800.765"/>
<polygon fill="#000000" stroke="#000000" points="125.231,-804.052 135.809,-804.649 127.912,-797.586 125.231,-804.052"/>
</g>
<!-- write_hs_formatted -->
<g id="proc~~compute_dm~~CallsGraph_node3" class="node"><title>write_hs_formatted</title>
<polygon fill="#777777" stroke="#777777" points="215,-780 111,-780 111,-756 215,-756 215,-780"/>
<text text-anchor="middle" x="163" y="-765.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_hs_formatted</text>
</g>
<!-- proc~compute_dm&#45;&gt;write_hs_formatted -->
<g id="proc~~compute_dm~~CallsGraph_edge15" class="edge"><title>proc~compute_dm&#45;&gt;write_hs_formatted</title>
<path fill="none" stroke="#000000" d="M39.6057,-423.034C44.7745,-476.931 68.1292,-695.724 111,-747 111.737,-747.882 112.517,-748.727 113.334,-749.537"/>
<polygon fill="#000000" stroke="#000000" points="111.502,-752.546 121.545,-755.921 115.799,-747.02 111.502,-752.546"/>
</g>
<!-- zminim -->
<g id="proc~~compute_dm~~CallsGraph_node4" class="node"><title>zminim</title>
<polygon fill="#777777" stroke="#777777" points="190,-738 136,-738 136,-714 190,-714 190,-738"/>
<text text-anchor="middle" x="163" y="-723.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">zminim</text>
</g>
<!-- proc~compute_dm&#45;&gt;zminim -->
<g id="proc~~compute_dm~~CallsGraph_edge3" class="edge"><title>proc~compute_dm&#45;&gt;zminim</title>
<path fill="none" stroke="#000000" d="M40.0251,-423.176C46.4836,-473.012 73.0056,-660.884 111,-705 115.183,-709.857 120.665,-713.609 126.481,-716.503"/>
<polygon fill="#000000" stroke="#000000" points="125.18,-719.753 135.757,-720.379 127.879,-713.294 125.18,-719.753"/>
</g>
<!-- eold -->
<g id="proc~~compute_dm~~CallsGraph_node5" class="node"><title>eold</title>
<polygon fill="#777777" stroke="#777777" points="190,-696 136,-696 136,-672 190,-672 190,-696"/>
<text text-anchor="middle" x="163" y="-681.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">eold</text>
</g>
<!-- proc~compute_dm&#45;&gt;eold -->
<g id="proc~~compute_dm~~CallsGraph_edge5" class="edge"><title>proc~compute_dm&#45;&gt;eold</title>
<path fill="none" stroke="#000000" d="M38.4669,-423.262C39.0161,-463.087 46.0201,-590.414 111,-663 115.275,-667.776 120.801,-671.489 126.632,-674.37"/>
<polygon fill="#000000" stroke="#000000" points="125.333,-677.621 135.91,-678.245 128.031,-671.161 125.333,-677.621"/>
</g>
<!-- proc~bye -->
<g id="proc~~compute_dm~~CallsGraph_node6" class="node"><title>proc~bye</title>
<g id="a_proc~~compute_dm~~CallsGraph_node6"><a xlink:href=".././proc/bye.html" xlink:title="bye">
<polygon fill="#d9534f" stroke="#d9534f" points="190,-654 136,-654 136,-630 190,-630 190,-654"/>
<text text-anchor="middle" x="163" y="-639.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bye</text>
</a>
</g>
</g>
<!-- proc~compute_dm&#45;&gt;proc~bye -->
<g id="proc~~compute_dm~~CallsGraph_edge7" class="edge"><title>proc~compute_dm&#45;&gt;proc~bye</title>
<path fill="none" stroke="#000000" d="M39.2974,-423.198C42.2386,-458.516 55.4167,-562.085 111,-621 115.252,-625.507 120.612,-629.077 126.249,-631.896"/>
<polygon fill="#000000" stroke="#000000" points="125.277,-635.285 135.85,-635.963 128.008,-628.839 125.277,-635.285"/>
</g>
<!-- val -->
<g id="proc~~compute_dm~~CallsGraph_node7" class="node"><title>val</title>
<polygon fill="#777777" stroke="#777777" points="190,-612 136,-612 136,-588 190,-588 190,-612"/>
<text text-anchor="middle" x="163" y="-597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">val</text>
</g>
<!-- proc~compute_dm&#45;&gt;val -->
<g id="proc~~compute_dm~~CallsGraph_edge6" class="edge"><title>proc~compute_dm&#45;&gt;val</title>
<path fill="none" stroke="#000000" d="M40.5394,-423.355C46.1904,-453.86 64.7934,-533.563 111,-579 115.374,-583.301 120.752,-586.764 126.359,-589.54"/>
<polygon fill="#000000" stroke="#000000" points="125.3,-592.893 135.872,-593.589 128.041,-586.452 125.3,-592.893"/>
</g>
<!-- escf -->
<g id="proc~~compute_dm~~CallsGraph_node8" class="node"><title>escf</title>
<polygon fill="#777777" stroke="#777777" points="190,-570 136,-570 136,-546 190,-546 190,-570"/>
<text text-anchor="middle" x="163" y="-555.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">escf</text>
</g>
<!-- proc~compute_dm&#45;&gt;escf -->
<g id="proc~~compute_dm~~CallsGraph_edge8" class="edge"><title>proc~compute_dm&#45;&gt;escf</title>
<path fill="none" stroke="#000000" d="M42.4503,-423.147C51.064,-447.858 73.7993,-504.396 111,-537 115.521,-540.962 120.892,-544.244 126.424,-546.941"/>
<polygon fill="#000000" stroke="#000000" points="125.194,-550.222 135.764,-550.944 127.951,-543.788 125.194,-550.222"/>
</g>
<!-- transiesta -->
<g id="proc~~compute_dm~~CallsGraph_node9" class="node"><title>transiesta</title>
<polygon fill="#777777" stroke="#777777" points="192.5,-528 133.5,-528 133.5,-504 192.5,-504 192.5,-528"/>
<text text-anchor="middle" x="163" y="-513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">transiesta</text>
</g>
<!-- proc~compute_dm&#45;&gt;transiesta -->
<g id="proc~~compute_dm~~CallsGraph_edge9" class="edge"><title>proc~compute_dm&#45;&gt;transiesta</title>
<path fill="none" stroke="#000000" d="M46.2394,-423.154C58.1856,-441.061 82.7169,-474.608 111,-495 114.966,-497.86 119.379,-500.414 123.903,-502.671"/>
<polygon fill="#000000" stroke="#000000" points="122.682,-505.96 133.236,-506.889 125.565,-499.581 122.682,-505.96"/>
</g>
<!-- chess_wrapper -->
<g id="proc~~compute_dm~~CallsGraph_node10" class="node"><title>chess_wrapper</title>
<polygon fill="#777777" stroke="#777777" points="205.5,-486 120.5,-486 120.5,-462 205.5,-462 205.5,-486"/>
<text text-anchor="middle" x="163" y="-471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">chess_wrapper</text>
</g>
<!-- proc~compute_dm&#45;&gt;chess_wrapper -->
<g id="proc~~compute_dm~~CallsGraph_edge10" class="edge"><title>proc~compute_dm&#45;&gt;chess_wrapper</title>
<path fill="none" stroke="#000000" d="M57.8037,-423.137C72.1914,-431.946 92.4715,-443.87 111,-453 114.377,-454.664 117.919,-456.312 121.496,-457.91"/>
<polygon fill="#000000" stroke="#000000" points="120.39,-461.245 130.958,-461.999 123.167,-454.819 120.39,-461.245"/>
</g>
<!-- pexsi_solver -->
<g id="proc~~compute_dm~~CallsGraph_node11" class="node"><title>pexsi_solver</title>
<polygon fill="#777777" stroke="#777777" points="199,-444 127,-444 127,-420 199,-420 199,-444"/>
<text text-anchor="middle" x="163" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pexsi_solver</text>
</g>
<!-- proc~compute_dm&#45;&gt;pexsi_solver -->
<g id="proc~~compute_dm~~CallsGraph_edge4" class="edge"><title>proc~compute_dm&#45;&gt;pexsi_solver</title>
<path fill="none" stroke="#000000" d="M75.2197,-417.244C88.2514,-419.46 103.074,-421.98 116.734,-424.303"/>
<polygon fill="#000000" stroke="#000000" points="116.46,-427.807 126.905,-426.032 117.634,-420.906 116.46,-427.807"/>
</g>
<!-- write_dmh_netcdf -->
<g id="proc~~compute_dm~~CallsGraph_node12" class="node"><title>write_dmh_netcdf</title>
<polygon fill="#777777" stroke="#777777" points="211.5,-402 114.5,-402 114.5,-378 211.5,-378 211.5,-402"/>
<text text-anchor="middle" x="163" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_dmh_netcdf</text>
</g>
<!-- proc~compute_dm&#45;&gt;write_dmh_netcdf -->
<g id="proc~~compute_dm~~CallsGraph_edge12" class="edge"><title>proc~compute_dm&#45;&gt;write_dmh_netcdf</title>
<path fill="none" stroke="#000000" d="M75.2197,-404.756C84.2964,-403.213 94.2416,-401.522 104.058,-399.852"/>
<polygon fill="#000000" stroke="#000000" points="104.927,-403.255 114.199,-398.128 103.754,-396.354 104.927,-403.255"/>
</g>
<!-- timer -->
<g id="proc~~compute_dm~~CallsGraph_node13" class="node"><title>timer</title>
<polygon fill="#777777" stroke="#777777" points="190,-360 136,-360 136,-336 190,-336 190,-360"/>
<text text-anchor="middle" x="163" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">timer</text>
</g>
<!-- proc~compute_dm&#45;&gt;timer -->
<g id="proc~~compute_dm~~CallsGraph_edge13" class="edge"><title>proc~compute_dm&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M57.8037,-398.863C72.1914,-390.054 92.4715,-378.13 111,-369 115.939,-366.566 121.232,-364.167 126.471,-361.908"/>
<polygon fill="#000000" stroke="#000000" points="127.884,-365.111 135.755,-358.019 125.179,-358.655 127.884,-365.111"/>
</g>
<!-- dold -->
<g id="proc~~compute_dm~~CallsGraph_node14" class="node"><title>dold</title>
<polygon fill="#777777" stroke="#777777" points="190,-318 136,-318 136,-294 190,-294 190,-318"/>
<text text-anchor="middle" x="163" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dold</text>
</g>
<!-- proc~compute_dm&#45;&gt;dold -->
<g id="proc~~compute_dm~~CallsGraph_edge14" class="edge"><title>proc~compute_dm&#45;&gt;dold</title>
<path fill="none" stroke="#000000" d="M46.2394,-398.846C58.1856,-380.939 82.7169,-347.392 111,-327 115.66,-323.64 120.938,-320.701 126.287,-318.171"/>
<polygon fill="#000000" stroke="#000000" points="128.066,-321.216 135.875,-314.055 125.305,-314.784 128.066,-321.216"/>
</g>
<!-- diagon -->
<g id="proc~~compute_dm~~CallsGraph_node15" class="node"><title>diagon</title>
<polygon fill="#777777" stroke="#777777" points="190,-276 136,-276 136,-252 190,-252 190,-276"/>
<text text-anchor="middle" x="163" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">diagon</text>
</g>
<!-- proc~compute_dm&#45;&gt;diagon -->
<g id="proc~~compute_dm~~CallsGraph_edge2" class="edge"><title>proc~compute_dm&#45;&gt;diagon</title>
<path fill="none" stroke="#000000" d="M42.4503,-398.853C51.064,-374.142 73.7993,-317.604 111,-285 115.521,-281.038 120.892,-277.756 126.424,-275.059"/>
<polygon fill="#000000" stroke="#000000" points="127.951,-278.212 135.764,-271.056 125.194,-271.778 127.951,-278.212"/>
</g>
<!-- write_orb_indx -->
<g id="proc~~compute_dm~~CallsGraph_node16" class="node"><title>write_orb_indx</title>
<polygon fill="#777777" stroke="#777777" points="204,-234 122,-234 122,-210 204,-210 204,-234"/>
<text text-anchor="middle" x="163" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_orb_indx</text>
</g>
<!-- proc~compute_dm&#45;&gt;write_orb_indx -->
<g id="proc~~compute_dm~~CallsGraph_edge16" class="edge"><title>proc~compute_dm&#45;&gt;write_orb_indx</title>
<path fill="none" stroke="#000000" d="M40.5394,-398.645C46.1904,-368.14 64.7934,-288.437 111,-243 112.109,-241.909 113.284,-240.872 114.51,-239.886"/>
<polygon fill="#000000" stroke="#000000" points="116.826,-242.549 123.221,-234.102 112.954,-236.718 116.826,-242.549"/>
</g>
<!-- mpi_bcast -->
<g id="proc~~compute_dm~~CallsGraph_node17" class="node"><title>mpi_bcast</title>
<polygon fill="#777777" stroke="#777777" points="193.5,-192 132.5,-192 132.5,-168 193.5,-168 193.5,-192"/>
<text text-anchor="middle" x="163" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_bcast</text>
</g>
<!-- proc~compute_dm&#45;&gt;mpi_bcast -->
<g id="proc~~compute_dm~~CallsGraph_edge11" class="edge"><title>proc~compute_dm&#45;&gt;mpi_bcast</title>
<path fill="none" stroke="#000000" d="M39.2974,-398.802C42.2386,-363.484 55.4167,-259.915 111,-201 114.433,-197.361 118.59,-194.332 123.031,-191.817"/>
<polygon fill="#000000" stroke="#000000" points="124.889,-194.808 132.407,-187.343 121.874,-188.491 124.889,-194.808"/>
</g>
<!-- dscf -->
<g id="proc~~compute_dm~~CallsGraph_node18" class="node"><title>dscf</title>
<polygon fill="#777777" stroke="#777777" points="190,-150 136,-150 136,-126 190,-126 190,-150"/>
<text text-anchor="middle" x="163" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dscf</text>
</g>
<!-- proc~compute_dm&#45;&gt;dscf -->
<g id="proc~~compute_dm~~CallsGraph_edge17" class="edge"><title>proc~compute_dm&#45;&gt;dscf</title>
<path fill="none" stroke="#000000" d="M38.4669,-398.738C39.0161,-358.913 46.0201,-231.586 111,-159 115.275,-154.224 120.801,-150.511 126.632,-147.63"/>
<polygon fill="#000000" stroke="#000000" points="128.031,-150.839 135.91,-143.755 125.333,-144.379 128.031,-150.839"/>
</g>
<!-- normalize_dm -->
<g id="proc~~compute_dm~~CallsGraph_node19" class="node"><title>normalize_dm</title>
<polygon fill="#777777" stroke="#777777" points="203,-108 123,-108 123,-84 203,-84 203,-108"/>
<text text-anchor="middle" x="163" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">normalize_dm</text>
</g>
<!-- proc~compute_dm&#45;&gt;normalize_dm -->
<g id="proc~~compute_dm~~CallsGraph_edge18" class="edge"><title>proc~compute_dm&#45;&gt;normalize_dm</title>
<path fill="none" stroke="#000000" d="M40.0251,-398.824C46.4836,-348.988 73.0056,-161.116 111,-117 112.138,-115.678 113.373,-114.438 114.685,-113.275"/>
<polygon fill="#000000" stroke="#000000" points="116.789,-116.073 122.9,-107.418 112.726,-110.373 116.789,-116.073"/>
</g>
<!-- dminim -->
<g id="proc~~compute_dm~~CallsGraph_node20" class="node"><title>dminim</title>
<polygon fill="#777777" stroke="#777777" points="190,-66 136,-66 136,-42 190,-42 190,-66"/>
<text text-anchor="middle" x="163" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dminim</text>
</g>
<!-- proc~compute_dm&#45;&gt;dminim -->
<g id="proc~~compute_dm~~CallsGraph_edge19" class="edge"><title>proc~compute_dm&#45;&gt;dminim</title>
<path fill="none" stroke="#000000" d="M39.6057,-398.966C44.7745,-345.069 68.1292,-126.276 111,-75 115.152,-70.0345 120.666,-66.2271 126.535,-63.3124"/>
<polygon fill="#000000" stroke="#000000" points="128.006,-66.4916 135.903,-59.4289 125.325,-60.0251 128.006,-66.4916"/>
</g>
<!-- compute_ebs_shift -->
<g id="proc~~compute_dm~~CallsGraph_node21" class="node"><title>compute_ebs_shift</title>
<polygon fill="#777777" stroke="#777777" points="214.5,-24 111.5,-24 111.5,-0 214.5,-0 214.5,-24"/>
<text text-anchor="middle" x="163" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_ebs_shift</text>
</g>
<!-- proc~compute_dm&#45;&gt;compute_ebs_shift -->
<g id="proc~~compute_dm~~CallsGraph_edge20" class="edge"><title>proc~compute_dm&#45;&gt;compute_ebs_shift</title>
<path fill="none" stroke="#000000" d="M39.3127,-398.667C43.3905,-340.2 63.343,-91.3529 111,-33 111.727,-32.11 112.498,-31.2574 113.307,-30.4405"/>
<polygon fill="#000000" stroke="#000000" points="115.776,-32.9504 121.464,-24.0119 111.444,-27.4523 115.776,-32.9504"/>
</g>
<!-- pxfflush -->
<g id="proc~~compute_dm~~CallsGraph_node22" class="node"><title>pxfflush</title>
<polygon fill="#777777" stroke="#777777" points="312.5,-696 258.5,-696 258.5,-672 312.5,-672 312.5,-696"/>
<text text-anchor="middle" x="285.5" y="-681.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pxfflush</text>
</g>
<!-- proc~bye&#45;&gt;pxfflush -->
<g id="proc~~compute_dm~~CallsGraph_edge21" class="edge"><title>proc~bye&#45;&gt;pxfflush</title>
<path fill="none" stroke="#000000" d="M190.147,-651.113C207.358,-657.112 230.107,-665.041 248.954,-671.61"/>
<polygon fill="#000000" stroke="#000000" points="247.809,-674.918 258.404,-674.904 250.113,-668.308 247.809,-674.918"/>
</g>
<!-- mpi_finalize -->
<g id="proc~~compute_dm~~CallsGraph_node23" class="node"><title>mpi_finalize</title>
<polygon fill="#777777" stroke="#777777" points="320,-654 251,-654 251,-630 320,-630 320,-654"/>
<text text-anchor="middle" x="285.5" y="-639.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_finalize</text>
</g>
<!-- proc~bye&#45;&gt;mpi_finalize -->
<g id="proc~~compute_dm~~CallsGraph_edge22" class="edge"><title>proc~bye&#45;&gt;mpi_finalize</title>
<path fill="none" stroke="#000000" d="M190.147,-642C204.821,-642 223.52,-642 240.395,-642"/>
<polygon fill="#000000" stroke="#000000" points="240.613,-645.5 250.613,-642 240.613,-638.5 240.613,-645.5"/>
</g>
<!-- cmlfinishfile -->
<g id="proc~~compute_dm~~CallsGraph_node24" class="node"><title>cmlfinishfile</title>
<polygon fill="#777777" stroke="#777777" points="319,-612 252,-612 252,-588 319,-588 319,-612"/>
<text text-anchor="middle" x="285.5" y="-597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cmlfinishfile</text>
</g>
<!-- proc~bye&#45;&gt;cmlfinishfile -->
<g id="proc~~compute_dm~~CallsGraph_edge23" class="edge"><title>proc~bye&#45;&gt;cmlfinishfile</title>
<path fill="none" stroke="#000000" d="M190.147,-632.887C205.307,-627.603 224.762,-620.822 242.064,-614.791"/>
<polygon fill="#000000" stroke="#000000" points="243.662,-617.941 251.953,-611.344 241.358,-611.331 243.662,-617.941"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,-0 209.5,-0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.5,-24 454.5,-24 454.5,-0 551.5,-0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~compute_dm~~CalledByGraph Pages: 1 -->
<svg id="proccompute_dmCalledByGraph" width="195pt" height="32pt"
 viewBox="0.00 0.00 195.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~compute_dm~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~compute_dm~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 191,-28 191,4 -4,4"/>
<!-- proc~compute_dm -->
<g id="proc~~compute_dm~~CalledByGraph_node1" class="node"><title>proc~compute_dm</title>
<polygon fill="none" stroke="black" points="187,-24 112,-24 112,-0 187,-0 187,-24"/>
<text text-anchor="middle" x="149.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">compute_dm</text>
</g>
<!-- proc~siesta_forces -->
<g id="proc~~compute_dm~~CalledByGraph_node2" class="node"><title>proc~siesta_forces</title>
<g id="a_proc~~compute_dm~~CalledByGraph_node2"><a xlink:href=".././proc/siesta_forces.html" xlink:title="siesta_forces">
<polygon fill="#d9534f" stroke="#d9534f" points="76,-24 0,-24 0,-0 76,-0 76,-24"/>
<text text-anchor="middle" x="38" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_forces</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;proc~compute_dm -->
<g id="proc~~compute_dm~~CalledByGraph_edge1" class="edge"><title>proc~siesta_forces&#45;&gt;proc~compute_dm</title>
<path fill="none" stroke="#000000" d="M76.0717,-12C84.2761,-12 93.0739,-12 101.611,-12"/>
<polygon fill="#000000" stroke="#000000" points="101.838,-15.5001 111.838,-12 101.838,-8.5001 101.838,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,-0 209.5,-0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.5,-24 454.5,-24 454.5,-0 551.5,-0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/compute_dm.html#src">compute_dm</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>      <span class="k">subroutine </span><span class="n">compute_dm</span><span class="p">(</span> <span class="n">iscf</span> <span class="p">)</span>
      <span class="k">use </span><span class="nb">precision</span>
<span class="nb">      </span><span class="k">use </span><span class="n">units</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">eV</span>
      <span class="k">USE </span><span class="n">siesta_options</span>
      <span class="k">use </span><span class="n">class_dSpData1D</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">val</span>
      <span class="k">use </span><span class="n">sparse_matrices</span>
      <span class="k">use </span><span class="n">siesta_geom</span>
      <span class="k">use </span><span class="n">atomlist</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">qa</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span> <span class="n">iaorb</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">indxuo</span><span class="p">,</span> 
     <span class="p">&amp;</span>                    <span class="n">qtot</span><span class="p">,</span> <span class="n">Qtots</span><span class="p">,</span> <span class="n">no_l</span>
      <span class="k">use </span><span class="n">sys</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">die</span><span class="p">,</span> <span class="n">bye</span>
      <span class="k">use </span><span class="n">kpoint_scf_m</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">kpoints_scf</span>
      <span class="k">use </span><span class="n">m_energies</span><span class="p">,</span>   <span class="n">only</span><span class="p">:</span> <span class="n">Ebs</span><span class="p">,</span> <span class="n">Ecorrec</span><span class="p">,</span> <span class="n">Entropy</span><span class="p">,</span> <span class="n">DE_NEGF</span>
      <span class="k">use </span><span class="n">m_energies</span><span class="p">,</span>   <span class="n">only</span><span class="p">:</span> <span class="n">Ef</span><span class="p">,</span> <span class="n">Efs</span>
      <span class="k">use </span><span class="n">m_rmaxh</span>
      <span class="k">use </span><span class="n">m_eo</span>
      <span class="k">use </span><span class="n">m_spin</span><span class="p">,</span>   <span class="n">only</span><span class="p">:</span> <span class="n">spin</span>
      <span class="k">use </span><span class="n">m_diagon</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">diagon</span>
      <span class="k">use </span><span class="n">m_gamma</span>
      <span class="k">use </span><span class="n">parallel</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">IONode</span>
      <span class="k">use </span><span class="n">parallel</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">SIESTA_worker</span>
      <span class="k">use </span><span class="n">m_compute_ebs_shift</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">compute_ebs_shift</span>
<span class="cp">#ifdef SIESTA__PEXSI</span>
      <span class="k">use </span><span class="n">m_pexsi_solver</span><span class="p">,</span>  <span class="n">only</span><span class="p">:</span> <span class="n">pexsi_solver</span>
<span class="cp">#endif</span>
      <span class="k">use </span><span class="n">m_hsx</span><span class="p">,</span> <span class="n">only</span>      <span class="p">:</span> <span class="n">write_hs_formatted</span>
<span class="cp">#ifdef MPI</span>
      <span class="k">use </span><span class="n">mpi_siesta</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef CDF</span>
      <span class="k">use </span><span class="n">iodmhs_netcdf</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">write_dmh_netcdf</span>
<span class="cp">#endif</span>
      <span class="k">use </span><span class="n">m_dminim</span><span class="p">,</span>        <span class="n">only</span> <span class="p">:</span> <span class="n">dminim</span>
      <span class="k">use </span><span class="n">m_zminim</span><span class="p">,</span>        <span class="n">only</span> <span class="p">:</span> <span class="n">zminim</span>
      <span class="k">use </span><span class="n">m_ordern</span><span class="p">,</span>        <span class="n">only</span> <span class="p">:</span> <span class="n">ordern</span>
      <span class="k">use </span><span class="n">m_steps</span><span class="p">,</span>         <span class="n">only</span> <span class="p">:</span> <span class="n">istp</span>
      <span class="k">use </span><span class="n">m_normalize_dm</span><span class="p">,</span>  <span class="n">only</span> <span class="p">:</span> <span class="n">normalize_dm</span>
<span class="cp">#ifdef SIESTA__CHESS</span>
      <span class="k">use </span><span class="n">m_chess</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">CheSS_wrapper</span>
<span class="cp">#endif</span>
      <span class="k">use </span><span class="n">m_energies</span><span class="p">,</span>   <span class="n">only</span><span class="p">:</span> <span class="n">DE_NEGF</span>
      <span class="k">use </span><span class="n">m_ts_global_vars</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">TSmode</span><span class="p">,</span> <span class="n">TSinit</span><span class="p">,</span> <span class="n">TSrun</span>
      <span class="k">use </span><span class="n">m_transiesta</span><span class="p">,</span>     <span class="n">only</span> <span class="p">:</span> <span class="n">transiesta</span>
      
      <span class="k">implicit none</span>
      
<span class="c">!     Input variables</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iscf</span>

      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">delta_Ebs</span><span class="p">,</span> <span class="n">delta_Ef</span>
      <span class="kt">logical</span>             <span class="kd">::</span> <span class="n">CallDiagon</span>
      <span class="kt">integer</span>             <span class="kd">::</span> <span class="n">nnz</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">H_kin</span><span class="p">(:)</span>

      <span class="c">! e1&gt;e2 to signal that we do not want DOS weights</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">e1</span> <span class="o">=</span> <span class="mf">1.0_dp</span><span class="p">,</span> <span class="n">e2</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0_dp</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">buffer1</span>
      <span class="kt">integer</span>             <span class="kd">::</span> <span class="n">mpierr</span>

<span class="c">!       character(15)            :: filename, indexstr</span>
<span class="c">!       character(15), parameter :: fnameform = &#39;(A,A,A)&#39;</span>


<span class="c">!-------------------------------------------------------------------- BEGIN</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">SIESTA_worker</span><span class="p">)</span> <span class="k">call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;compute_dm&#39;</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span>

<span class="cp">#ifdef MPI</span>
      <span class="k">call </span><span class="n">MPI_Bcast</span><span class="p">(</span><span class="n">isolve</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">MPI_integer</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">true_MPI_Comm_World</span><span class="p">,</span><span class="n">mpierr</span><span class="p">)</span>
<span class="cp">#endif     </span>

      <span class="k">if</span> <span class="p">(</span><span class="n">SIESTA_worker</span><span class="p">)</span> <span class="k">then</span>
         <span class="c">! Save present density matrix</span>
<span class="c">!$OMP parallel default(shared)</span>
         <span class="k">if</span> <span class="p">(</span> <span class="n">converge_EDM</span> <span class="p">)</span> <span class="k">then</span>
<span class="c">!$OMP workshare</span>
            <span class="n">Eold</span><span class="p">(:,:)</span> <span class="o">=</span> <span class="n">Escf</span><span class="p">(:,:)</span>
            <span class="n">Dold</span><span class="p">(:,:)</span> <span class="o">=</span> <span class="n">Dscf</span><span class="p">(:,:)</span>
<span class="c">!$OMP end workshare</span>
         <span class="k">else</span>
<span class="c">!$OMP workshare</span>
            <span class="n">Dold</span><span class="p">(:,:)</span> <span class="o">=</span> <span class="n">Dscf</span><span class="p">(:,:)</span>
<span class="c">!$OMP end workshare</span>
         <span class="k">end if</span>
<span class="c">!$OMP end parallel</span>
      <span class="k">end if</span>

      <span class="c">! Compute shift in Tr(H*DM) for fermi-level bracketting</span>
      <span class="c">! Use the current H, the previous iteration H, and the</span>
      <span class="c">! previous iteration DM</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">SIESTA_worker</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         if</span> <span class="p">(</span><span class="n">iscf</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            call </span><span class="n">compute_Ebs_shift</span><span class="p">(</span><span class="n">Dscf</span><span class="p">,</span><span class="n">H</span><span class="p">,</span><span class="n">Hold</span><span class="p">,</span><span class="n">delta_Ebs</span><span class="p">)</span>
            <span class="n">delta_Ef</span> <span class="o">=</span> <span class="n">delta_Ebs</span> <span class="o">/</span> <span class="n">qtot</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">ionode</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">isolve</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">SOLVE_PEXSI</span><span class="p">)</span> <span class="k">then</span>
<span class="k">               write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s2">&quot;(a,f16.5)&quot;</span><span class="p">)</span>
     <span class="err">$</span>              <span class="s2">&quot;Estimated change in band-structure energy:&quot;</span><span class="p">,</span>
     <span class="err">$</span>              <span class="n">delta_Ebs</span><span class="o">/</span><span class="n">eV</span><span class="p">,</span> <span class="s2">&quot;Estimated shift in E_fermi: &quot;</span><span class="p">,</span>
     <span class="err">$</span>              <span class="n">delta_Ef</span><span class="o">/</span><span class="n">eV</span>
            <span class="n">endif</span>
               
         <span class="k">else</span>
<span class="k">            </span><span class="n">delta_Ebs</span> <span class="o">=</span> <span class="mf">0.0_dp</span>
            <span class="n">delta_Ef</span>  <span class="o">=</span> <span class="mf">0.0_dp</span>
         <span class="n">endif</span>
      <span class="n">endif</span>

<span class="cp">#ifdef SIESTA__PEXSI</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">isolve</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SOLVE_PEXSI</span><span class="p">)</span> <span class="k">then</span>
        <span class="c">! This test done in node 0 since NonCol and SpOrb</span>
        <span class="c">! are not set for PEXSI-solver-only processes</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">ionode</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            if</span> <span class="p">(</span><span class="n">spin</span><span class="p">%</span><span class="n">NCol</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">spin</span><span class="p">%</span><span class="n">SO</span><span class="p">)</span> <span class="k">call </span><span class="n">die</span><span class="p">(</span>
     <span class="err">$</span>               <span class="s2">&quot;The PEXSI solver does not implement &quot;</span><span class="o">//</span>
     <span class="err">$</span>               <span class="s2">&quot;non-coll spins or Spin-orbit yet&quot;</span><span class="p">)</span>
         <span class="n">endif</span>
         <span class="k">call </span><span class="n">pexsi_solver</span><span class="p">(</span><span class="n">iscf</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">spinor</span><span class="p">,</span>
     <span class="err">$</span>              <span class="n">maxnh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span>
     <span class="err">$</span>              <span class="n">H</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">qtot</span><span class="p">,</span> <span class="n">Dscf</span><span class="p">,</span> <span class="n">Escf</span><span class="p">,</span>
     <span class="err">$</span>              <span class="n">ef</span><span class="p">,</span> <span class="n">Entropy</span><span class="p">,</span> <span class="n">temp</span><span class="p">,</span> <span class="n">delta_Ef</span><span class="p">)</span>
      <span class="n">endif</span>
      <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SIESTA_worker</span><span class="p">)</span> <span class="k">RETURN</span>
<span class="cp">#endif</span>
      <span class="c">! Here we decide if we want to calculate one or more SCF steps by</span>
      <span class="c">! diagonalization before proceeding with the OMM routine</span>
      <span class="n">CallDiagon</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">isolve</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SOLVE_MINIM</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        if</span> <span class="p">(</span><span class="n">istp</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          if</span> <span class="p">((</span><span class="n">iscf</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="n">call_diagon_first_step</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>
     <span class="p">&amp;</span>        <span class="p">(</span><span class="n">call_diagon_first_step</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">))</span> <span class="n">CallDiagon</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
        <span class="k">else</span>
<span class="k">          if</span> <span class="p">((</span><span class="n">iscf</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="n">call_diagon_default</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>
     <span class="p">&amp;</span>        <span class="p">(</span><span class="n">call_diagon_default</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">))</span> <span class="n">CallDiagon</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
        <span class="n">endif</span>
      <span class="n">endif</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">isolve</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">MATRIX_WRITE</span><span class="p">)</span> <span class="k">then</span>
<span class="c">!             write(indexstr,&#39;(I15)&#39;) iscf</span>
<span class="c">!             write(filename,fnameform) &#39;H_&#39;, trim(adjustl(indexstr)), </span>
<span class="c">!      &amp;                                &#39;.matrix&#39;</span>
<span class="c">!             call write_global_matrix( no_s, no_l, maxnh, numh, listh,</span>
<span class="c">!      &amp;           H(1:maxnh,1), filename )</span>
<span class="c">!  </span>
<span class="c">!             write(filename,fnameform) &#39;S_&#39;, trim(adjustl(indexstr)), </span>
<span class="c">!      &amp;                                &#39;.matrix&#39;</span>

<span class="c">!        Note: only one-shot for now</span>
         <span class="k">call </span><span class="n">write_hs_formatted</span><span class="p">(</span><span class="n">no_u</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span>
     <span class="err">$</span>        <span class="n">maxnh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">S</span><span class="p">)</span>
         <span class="k">call </span><span class="n">bye</span><span class="p">(</span><span class="s2">&quot;End of run after writing H.matrix and S.matrix&quot;</span><span class="p">)</span>

<span class="n">c$$$</span>        <span class="k">call </span><span class="n">write_global_matrix_singlenodewrite</span><span class="p">(</span> 
<span class="n">c$$$</span>     <span class="p">&amp;</span>           <span class="n">no_u</span><span class="p">,</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> 
<span class="n">c$$$</span>     <span class="p">&amp;</span>           <span class="n">H</span><span class="p">(:,</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;H.matrix&#39;</span><span class="p">)</span>
<span class="n">c$$$</span>
<span class="n">c$$$</span>        <span class="k">call </span><span class="n">write_global_matrix_singlenodewrite</span><span class="p">(</span> 
<span class="n">c$$$</span>     <span class="p">&amp;</span>           <span class="n">no_u</span><span class="p">,</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> 
<span class="n">c$$$</span>     <span class="p">&amp;</span>           <span class="n">S</span><span class="p">,</span> <span class="s1">&#39;S.matrix&#39;</span><span class="p">)</span>

      <span class="n">elseif</span> <span class="p">((</span><span class="n">isolve</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SOLVE_DIAGON</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">CallDiagon</span><span class="p">))</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">diagon</span><span class="p">(</span><span class="n">no_s</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">spinor</span><span class="p">,</span> 
     <span class="p">&amp;</span>              <span class="n">no_l</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span>
     <span class="p">&amp;</span>              <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> 
     <span class="p">&amp;</span>              <span class="n">H</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">qtot</span><span class="p">,</span> <span class="n">fixspin</span><span class="p">,</span> <span class="n">qtots</span><span class="p">,</span> <span class="n">temp</span><span class="p">,</span> <span class="n">e1</span><span class="p">,</span> <span class="n">e2</span><span class="p">,</span>
     <span class="p">&amp;</span>              <span class="nb">gamma</span><span class="p">,</span> <span class="n">xijo</span><span class="p">,</span> <span class="n">indxuo</span><span class="p">,</span>
     <span class="p">&amp;</span>              <span class="n">kpoints_scf</span><span class="p">%</span><span class="n">N</span><span class="p">,</span> <span class="n">kpoints_scf</span><span class="p">%</span><span class="n">k</span><span class="p">,</span> <span class="n">kpoints_scf</span><span class="p">%</span><span class="n">w</span><span class="p">,</span>
     <span class="p">&amp;</span>              <span class="n">eo</span><span class="p">,</span> <span class="n">qo</span><span class="p">,</span> <span class="n">Dscf</span><span class="p">,</span> <span class="n">Escf</span><span class="p">,</span> <span class="n">ef</span><span class="p">,</span> <span class="n">efs</span><span class="p">,</span> <span class="n">Entropy</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span>
     <span class="p">&amp;</span>              <span class="n">occtol</span><span class="p">,</span> <span class="n">iscf</span><span class="p">,</span> <span class="n">neigwanted</span><span class="p">)</span>
        <span class="n">Ecorrec</span> <span class="o">=</span> <span class="mf">0.0_dp</span>
        <span class="n">PreviousCallDiagon</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
      <span class="n">elseif</span> <span class="p">(</span><span class="n">isolve</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SOLVE_ORDERN</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="nb">gamma</span><span class="p">)</span> <span class="k">call </span><span class="n">die</span><span class="p">(</span><span class="s2">&quot;Cannot do O(N) with k-points.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">spin</span><span class="p">%</span><span class="n">NCol</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">spin</span><span class="p">%</span><span class="n">SO</span> <span class="p">)</span>
     <span class="p">.</span>      <span class="k">call </span><span class="n">die</span><span class="p">(</span><span class="s2">&quot;Cannot do O(N) with non-coll spins or Spin-orbit&quot;</span><span class="p">)</span>
        <span class="k">call </span><span class="n">ordern</span><span class="p">(</span><span class="n">usesavelwf</span><span class="p">,</span> <span class="n">ioptlwf</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span>
     <span class="p">&amp;</span>               <span class="n">isa</span><span class="p">,</span> <span class="n">qa</span><span class="p">,</span> <span class="n">rcoor</span><span class="p">,</span> <span class="n">rmaxh</span><span class="p">,</span> <span class="n">ucell</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">iscf</span><span class="p">,</span>
     <span class="p">&amp;</span>               <span class="n">istp</span><span class="p">,</span> <span class="n">ncgmax</span><span class="p">,</span> <span class="n">etol</span><span class="p">,</span> <span class="n">eta</span><span class="p">,</span> <span class="n">qtot</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span>
     <span class="p">&amp;</span>               <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">chebef</span><span class="p">,</span> <span class="n">noeta</span><span class="p">,</span> <span class="n">rcoorcp</span><span class="p">,</span>
     <span class="p">&amp;</span>               <span class="n">beta</span><span class="p">,</span> <span class="n">pmax</span><span class="p">,</span> <span class="n">Dscf</span><span class="p">,</span> <span class="n">Escf</span><span class="p">,</span> <span class="n">Ecorrec</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span> <span class="n">qtots</span> <span class="p">)</span>
        <span class="n">Entropy</span> <span class="o">=</span> <span class="mf">0.0_dp</span>
      <span class="n">elseif</span> <span class="p">(</span><span class="n">isolve</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SOLVE_MINIM</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        if</span> <span class="p">(</span> <span class="n">spin</span><span class="p">%</span><span class="n">NCol</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">spin</span><span class="p">%</span><span class="n">SO</span> <span class="p">)</span> 
     <span class="p">&amp;</span>      <span class="k">call </span><span class="n">die</span><span class="p">(</span><span class="s1">&#39;ERROR: Non-collinear spin calculations</span>
<span class="s1">     &amp;                       not yet implemented with OMM!&#39;</span><span class="p">)</span>
        <span class="n">H_kin</span> <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">H_kin_1D</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">gamma</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          call </span><span class="n">dminim</span><span class="p">(.</span><span class="n">false</span><span class="p">.,</span> <span class="n">PreviousCallDiagon</span><span class="p">,</span> <span class="n">iscf</span><span class="p">,</span> <span class="n">istp</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span>
     <span class="p">&amp;</span>                 <span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">Dscf</span><span class="p">,</span>
     <span class="p">&amp;</span>                 <span class="n">eta</span><span class="p">,</span> <span class="n">qtots</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">H_kin</span><span class="p">)</span>
        <span class="k">else</span>
<span class="k">          call </span><span class="n">zminim</span><span class="p">(.</span><span class="n">false</span><span class="p">.,</span> <span class="n">PreviousCallDiagon</span><span class="p">,</span> <span class="n">iscf</span><span class="p">,</span> <span class="n">istp</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span>
     <span class="p">&amp;</span>                 <span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">Dscf</span><span class="p">,</span>
     <span class="p">&amp;</span>                 <span class="n">eta</span><span class="p">,</span> <span class="n">qtots</span><span class="p">,</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">xijo</span><span class="p">,</span> <span class="n">indxuo</span><span class="p">,</span>
     <span class="p">&amp;</span>                 <span class="n">kpoints_scf</span><span class="p">%</span><span class="n">N</span><span class="p">,</span> <span class="n">kpoints_scf</span><span class="p">%</span><span class="n">k</span><span class="p">,</span> <span class="n">kpoints_scf</span><span class="p">%</span><span class="n">w</span><span class="p">,</span>
     <span class="p">&amp;</span>                 <span class="n">H</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">H_kin</span><span class="p">)</span>
        <span class="k">end if</span>
<span class="k">        </span><span class="n">Ecorrec</span> <span class="o">=</span> <span class="mf">0.0_dp</span>
        <span class="n">Entropy</span> <span class="o">=</span> <span class="mf">0.0_dp</span>
        <span class="n">PreviousCallDiagon</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<span class="cp">#ifdef SIESTA__CHESS</span>
      <span class="n">elseif</span> <span class="p">(</span><span class="n">isolve</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SOLVE_CHESS</span><span class="p">)</span> <span class="k">then</span>
        <span class="c">! FOE solver from the CheSS library</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">gamma</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          call </span><span class="n">CheSS_wrapper</span><span class="p">(.</span><span class="n">false</span><span class="p">.,</span> <span class="n">PreviousCallDiagon</span><span class="p">,</span> 
     <span class="p">&amp;</span>         <span class="n">iscf</span><span class="p">,</span> <span class="n">istp</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span>
     <span class="p">&amp;</span>         <span class="n">spin</span><span class="p">%</span><span class="n">spinor</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> 
     <span class="p">&amp;</span>         <span class="n">qs</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span>
     <span class="p">&amp;</span>         <span class="n">Dscf</span><span class="p">,</span> <span class="n">Escf</span><span class="p">,</span> <span class="n">Ef</span><span class="p">)</span>
        <span class="k">end if</span>
<span class="k">        </span><span class="n">Ecorrec</span> <span class="o">=</span> <span class="mf">0.0_dp</span>
        <span class="n">Entropy</span> <span class="o">=</span> <span class="mf">0.0_dp</span>
        <span class="n">PreviousCallDiagon</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<span class="cp">#endif</span>
      <span class="n">elseif</span> <span class="p">(</span><span class="n">TSmode</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">TSinit</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">diagon</span><span class="p">(</span><span class="n">no_s</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">spinor</span><span class="p">,</span> 
     <span class="p">&amp;</span>              <span class="n">no_l</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span>
     <span class="p">&amp;</span>              <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span>
     <span class="p">&amp;</span>              <span class="n">H</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">qtot</span><span class="p">,</span> <span class="n">fixspin</span><span class="p">,</span> <span class="n">qtots</span><span class="p">,</span> <span class="n">temp</span><span class="p">,</span> <span class="n">e1</span><span class="p">,</span> <span class="n">e2</span><span class="p">,</span>
     <span class="p">&amp;</span>              <span class="nb">gamma</span><span class="p">,</span> <span class="n">xijo</span><span class="p">,</span> <span class="n">indxuo</span><span class="p">,</span>
     <span class="p">&amp;</span>              <span class="n">kpoints_scf</span><span class="p">%</span><span class="n">N</span><span class="p">,</span> <span class="n">kpoints_scf</span><span class="p">%</span><span class="n">k</span><span class="p">,</span> <span class="n">kpoints_scf</span><span class="p">%</span><span class="n">w</span><span class="p">,</span>
     <span class="p">&amp;</span>              <span class="n">eo</span><span class="p">,</span> <span class="n">qo</span><span class="p">,</span> <span class="n">Dscf</span><span class="p">,</span> <span class="n">Escf</span><span class="p">,</span> <span class="n">ef</span><span class="p">,</span> <span class="n">efs</span><span class="p">,</span> <span class="n">Entropy</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span>
     <span class="p">&amp;</span>              <span class="n">occtol</span><span class="p">,</span> <span class="n">iscf</span><span class="p">,</span> <span class="n">neigwanted</span><span class="p">)</span>

        <span class="n">Ecorrec</span> <span class="o">=</span> <span class="mf">0._dp</span>

      <span class="k">else if</span> <span class="p">(</span><span class="n">TSrun</span><span class="p">)</span> <span class="k">then</span>

<span class="k">         call </span><span class="n">transiesta</span><span class="p">(</span><span class="n">iscf</span><span class="p">,</span><span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span> <span class="n">block_dist</span><span class="p">,</span> <span class="n">sparse_pattern</span><span class="p">,</span>
     <span class="p">&amp;</span>        <span class="nb">Gamma</span><span class="p">,</span> <span class="n">ucell</span><span class="p">,</span> <span class="n">nsc</span><span class="p">,</span> <span class="n">isc_off</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span>
     <span class="p">&amp;</span>        <span class="n">H</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">Dscf</span><span class="p">,</span> <span class="n">Escf</span><span class="p">,</span> <span class="n">Ef</span><span class="p">,</span> <span class="n">Qtot</span><span class="p">,</span> <span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">DE_NEGF</span> <span class="p">)</span>

         <span class="n">Ecorrec</span> <span class="o">=</span> <span class="mf">0._dp</span>
         <span class="n">Entropy</span> <span class="o">=</span> <span class="mf">0.0_dp</span>
         
      <span class="k">else</span>
        <span class="c">!call die(&#39;siesta: ERROR: wrong solution method&#39;)</span>
      <span class="n">endif</span>

<span class="cp">#ifdef CDF</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">writedmhs_cdf_history</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">write_dmh_netcdf</span><span class="p">(</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span> <span class="n">Dold</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">Dscf</span> <span class="p">)</span>
      <span class="k">else if</span> <span class="p">(</span><span class="n">writedmhs_cdf</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">write_dmh_netcdf</span><span class="p">(</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span> <span class="n">Dold</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">Dscf</span><span class="p">,</span>
     <span class="p">&amp;</span>                         <span class="n">overwrite</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span> <span class="p">)</span>
      <span class="n">endif</span>
<span class="cp">#endif</span>

<span class="c">! Write orbital indexes. JMS Dec.2009</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">IOnode</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">iscf</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">write_orb_indx</span><span class="p">(</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">na_s</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">isa</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span>
     <span class="p">.</span>        <span class="n">iaorb</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span> <span class="n">indxuo</span><span class="p">,</span> <span class="n">nsc</span><span class="p">,</span> <span class="n">ucell</span> <span class="p">)</span>
      <span class="n">endif</span>

<span class="c">!     Normalize density matrix to exact charge</span>
<span class="c">!     Placed here for now to avoid disturbing EHarris</span>
      <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">TSrun</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">normalize_dm</span><span class="p">(</span> <span class="n">first</span><span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="p">)</span>
      <span class="k">end if</span>

<span class="k">      call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;compute_dm&#39;</span><span class="p">,</span> <span class="mi">2</span> <span class="p">)</span>
<span class="cp">#ifdef SIESTA__PEXSI</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">ionode</span><span class="p">)</span> <span class="k">call </span><span class="n">memory_snapshot</span><span class="p">(</span><span class="s2">&quot;after compute_DM&quot;</span><span class="p">)</span>
<span class="cp">#endif</span>

<span class="c">!-----------------------------------------------------------------------END</span>
      <span class="k">END subroutine </span><span class="n">compute_dm</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2018 <a rel="license" href="http://www.gnu.org/licenses/old-licenses/fdl-1.2.en.html">GNU Free Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> SIESTA was developed by SIESTA Group</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>