<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="A first-principles materials simulation code using Density Functional Theory.">
    
    <meta name="author" content="SIESTA Group" >
    <link rel="icon" href="../favicon.png">

    <title>compute_dm &ndash; SIESTA</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">SIESTA <small>trunk-674--vdikan-ford-681</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>Program Overview</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>compute_dm
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 2.7% of total for procedures.">140 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/compute_dm.F"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/compute_dm.f.html'>compute_dm.F</a></li>
    
     <li><a href='../module/m_compute_dm.html'>m_compute_dm</a></li>
    
  
     <li class="active">compute_dm</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/compute_dm.html#src">compute_dm</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine compute_dm(iscf)
    
    
   
</h2>
    
  
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
      
      <li class="list-group-item">
  <ul class="list-inline">
    
    <li>precision</li>
    
    <li>units</li>
    
    <li>siesta_options</li>
    
    <li>class_dSpData1D</li>
    
    <li>sparse_matrices</li>
    
    <li>siesta_geom</li>
    
    <li>atomlist</li>
    
    <li>sys</li>
    
    <li>Kpoint_grid</li>
    
    <li>m_energies</li>
    
    <li>m_energies</li>
    
    <li>m_rmaxh</li>
    
    <li>m_eo</li>
    
    <li>m_spin</li>
    
    <li>m_diagon</li>
    
    <li>m_gamma</li>
    
    <li>parallel</li>
    
    <li>parallel</li>
    
    <li>m_compute_ebs_shift</li>
    
    <li>m_pexsi_solver</li>
    
    <li>m_hsx</li>
    
    <li>mpi_siesta</li>
    
    <li>iodmhs_netcdf</li>
    
    <li>m_dminim</li>
    
    <li>m_zminim</li>
    
    <li>m_ordern</li>
    
    <li>m_steps</li>
    
    <li>m_normalize_dm</li>
    
    <li>m_chess</li>
    
    <li>m_energies</li>
    
    <li>m_ts_global_vars</li>
    
    <li>m_transiesta</li>
    
  </ul>
      </li>
      
      
      
      <li class="list-group-item">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: proc~~compute_dm~~UsesGraph Pages: 1 -->
<svg id="proccompute_dmUsesGraph" width="237pt" height="1208pt"
 viewBox="0.00 0.00 237.00 1208.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~compute_dm~~UsesGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 1204)">
<title>proc~~compute_dm~~UsesGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1204 233,-1204 233,4 -4,4"/>
<!-- proc~compute_dm -->
<g id="proc~~compute_dm~~UsesGraph_node1" class="node">
<title>proc~compute_dm</title>
<polygon fill="none" stroke="#000000" points="229,-612 154,-612 154,-588 229,-588 229,-612"/>
<text text-anchor="middle" x="191.5" y="-597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">compute_dm</text>
</g>
<!-- m_diagon -->
<g id="proc~~compute_dm~~UsesGraph_node2" class="node">
<title>m_diagon</title>
<polygon fill="#337ab7" stroke="#337ab7" points="89,-1200 29,-1200 29,-1176 89,-1176 89,-1200"/>
<text text-anchor="middle" x="59" y="-1185.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_diagon</text>
</g>
<!-- proc~compute_dm&#45;&gt;m_diagon -->
<g id="proc~~compute_dm~~UsesGraph_edge1" class="edge">
<title>proc~compute_dm&#45;&gt;m_diagon</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M190.6888,-612.0686C185.3433,-690.1484 154.2672,-1122.0486 118,-1167 113.0077,-1173.1877 106.0534,-1177.5539 98.6655,-1180.6343"/>
<polygon fill="#000000" stroke="#000000" points="97.511,-1177.3301 89.1904,-1183.8889 99.785,-1183.9504 97.511,-1177.3301"/>
</g>
<!-- atomlist -->
<g id="proc~~compute_dm~~UsesGraph_node3" class="node">
<title>atomlist</title>
<polygon fill="#337ab7" stroke="#337ab7" points="86,-1158 32,-1158 32,-1134 86,-1134 86,-1158"/>
<text text-anchor="middle" x="59" y="-1143.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">atomlist</text>
</g>
<!-- proc~compute_dm&#45;&gt;atomlist -->
<g id="proc~~compute_dm~~UsesGraph_edge2" class="edge">
<title>proc~compute_dm&#45;&gt;atomlist</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M190.5341,-612.3708C184.547,-687.7777 151.6569,-1083.7158 118,-1125 112.3708,-1131.9049 104.3009,-1136.541 95.9293,-1139.6533"/>
<polygon fill="#000000" stroke="#000000" points="94.6367,-1136.3883 86.0914,-1142.6516 96.6774,-1143.0842 94.6367,-1136.3883"/>
</g>
<!-- parallel -->
<g id="proc~~compute_dm~~UsesGraph_node4" class="node">
<title>parallel</title>
<polygon fill="#337ab7" stroke="#337ab7" points="86,-1116 32,-1116 32,-1092 86,-1092 86,-1116"/>
<text text-anchor="middle" x="59" y="-1101.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">parallel</text>
</g>
<!-- proc~compute_dm&#45;&gt;parallel -->
<g id="proc~~compute_dm~~UsesGraph_edge3" class="edge">
<title>proc~compute_dm&#45;&gt;parallel</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M191.2917,-612.042C189.8962,-679.2787 179.9492,-1007.93 118,-1083 112.3298,-1089.8712 104.2451,-1094.4952 95.8724,-1097.6066"/>
<polygon fill="#000000" stroke="#000000" points="94.5812,-1094.3412 86.0387,-1100.6083 96.6249,-1101.0363 94.5812,-1094.3412"/>
</g>
<!-- m_normalize_dm -->
<g id="proc~~compute_dm~~UsesGraph_node5" class="node">
<title>m_normalize_dm</title>
<polygon fill="#337ab7" stroke="#337ab7" points="106.5,-1074 11.5,-1074 11.5,-1050 106.5,-1050 106.5,-1074"/>
<text text-anchor="middle" x="59" y="-1059.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_normalize_dm</text>
</g>
<!-- proc~compute_dm&#45;&gt;m_normalize_dm -->
<g id="proc~~compute_dm~~UsesGraph_edge4" class="edge">
<title>proc~compute_dm&#45;&gt;m_normalize_dm</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M191.093,-612.2379C188.7262,-676.3514 174.8003,-973.152 118,-1041 117.0185,-1042.1724 115.9669,-1043.2793 114.8557,-1044.3244"/>
<polygon fill="#000000" stroke="#000000" points="112.6876,-1041.5753 106.771,-1050.3642 116.8771,-1047.1832 112.6876,-1041.5753"/>
</g>
<!-- sys -->
<g id="proc~~compute_dm~~UsesGraph_node6" class="node">
<title>sys</title>
<polygon fill="#337ab7" stroke="#337ab7" points="86,-1032 32,-1032 32,-1008 86,-1008 86,-1032"/>
<text text-anchor="middle" x="59" y="-1017.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">sys</text>
</g>
<!-- proc~compute_dm&#45;&gt;sys -->
<g id="proc~~compute_dm~~UsesGraph_edge5" class="edge">
<title>proc~compute_dm&#45;&gt;sys</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M190.8574,-612.2547C187.4573,-672.6631 169.7239,-938.2731 118,-999 112.2741,-1005.7225 104.2428,-1010.2932 95.9453,-1013.4008"/>
<polygon fill="#000000" stroke="#000000" points="94.7212,-1010.1158 86.2045,-1016.418 96.7924,-1016.8024 94.7212,-1010.1158"/>
</g>
<!-- class_dSpData1D -->
<g id="proc~~compute_dm~~UsesGraph_node7" class="node">
<title>class_dSpData1D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="107.5,-990 10.5,-990 10.5,-966 107.5,-966 107.5,-990"/>
<text text-anchor="middle" x="59" y="-975.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">class_dSpData1D</text>
</g>
<!-- proc~compute_dm&#45;&gt;class_dSpData1D -->
<g id="proc~~compute_dm~~UsesGraph_edge6" class="edge">
<title>proc~compute_dm&#45;&gt;class_dSpData1D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M190.5831,-612.0742C186.0929,-668.2181 164.7236,-903.2898 118,-957 117.137,-957.9921 116.2238,-958.9372 115.2672,-959.8378"/>
<polygon fill="#000000" stroke="#000000" points="113.0855,-957.0991 107.1927,-965.904 117.2901,-962.6957 113.0855,-957.0991"/>
</g>
<!-- Kpoint_grid -->
<g id="proc~~compute_dm~~UsesGraph_node8" class="node">
<title>Kpoint_grid</title>
<polygon fill="#337ab7" stroke="#337ab7" points="92.5,-948 25.5,-948 25.5,-924 92.5,-924 92.5,-948"/>
<text text-anchor="middle" x="59" y="-933.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Kpoint_grid</text>
</g>
<!-- proc~compute_dm&#45;&gt;Kpoint_grid -->
<g id="proc~~compute_dm~~UsesGraph_edge7" class="edge">
<title>proc~compute_dm&#45;&gt;Kpoint_grid</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M190.2302,-612.0255C184.5257,-663.9371 159.7108,-868.3012 118,-915 113.6747,-919.8425 108.1567,-923.5686 102.2379,-926.4354"/>
<polygon fill="#000000" stroke="#000000" points="100.6879,-923.2865 92.7207,-930.2704 103.3042,-929.7792 100.6879,-923.2865"/>
</g>
<!-- m_hsx -->
<g id="proc~~compute_dm~~UsesGraph_node9" class="node">
<title>m_hsx</title>
<polygon fill="#337ab7" stroke="#337ab7" points="86,-906 32,-906 32,-882 86,-882 86,-906"/>
<text text-anchor="middle" x="59" y="-891.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_hsx</text>
</g>
<!-- proc~compute_dm&#45;&gt;m_hsx -->
<g id="proc~~compute_dm~~UsesGraph_edge8" class="edge">
<title>proc~compute_dm&#45;&gt;m_hsx</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M189.7704,-612.0004C182.714,-659.442 154.7248,-833.2548 118,-873 112.0602,-879.4283 104.022,-883.8903 95.7925,-886.987"/>
<polygon fill="#000000" stroke="#000000" points="94.6389,-883.6809 86.158,-890.0311 96.7479,-890.3556 94.6389,-883.6809"/>
</g>
<!-- mpi_siesta -->
<g id="proc~~compute_dm~~UsesGraph_node10" class="node">
<title>mpi_siesta</title>
<polygon fill="#337ab7" stroke="#337ab7" points="91,-864 27,-864 27,-840 91,-840 91,-864"/>
<text text-anchor="middle" x="59" y="-849.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mpi_siesta</text>
</g>
<!-- proc~compute_dm&#45;&gt;mpi_siesta -->
<g id="proc~~compute_dm~~UsesGraph_edge9" class="edge">
<title>proc~compute_dm&#45;&gt;mpi_siesta</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M189.1119,-612.1642C180.481,-655.0185 149.7364,-798.1691 118,-831 113.1767,-835.9896 107.0909,-839.7966 100.6719,-842.7004"/>
<polygon fill="#000000" stroke="#000000" points="99.2307,-839.5042 91.1373,-846.3413 101.7279,-846.0436 99.2307,-839.5042"/>
</g>
<!-- m_eo -->
<g id="proc~~compute_dm~~UsesGraph_node11" class="node">
<title>m_eo</title>
<polygon fill="#337ab7" stroke="#337ab7" points="86,-822 32,-822 32,-798 86,-798 86,-822"/>
<text text-anchor="middle" x="59" y="-807.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_eo</text>
</g>
<!-- proc~compute_dm&#45;&gt;m_eo -->
<g id="proc~~compute_dm~~UsesGraph_edge10" class="edge">
<title>proc~compute_dm&#45;&gt;m_eo</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M190.2568,-612.0602C186.2183,-645.0956 170.5248,-737.9738 118,-789 111.7783,-795.0442 103.7042,-799.3607 95.5367,-802.4393"/>
<polygon fill="#000000" stroke="#000000" points="94.4525,-799.1114 86.0111,-805.5141 96.6028,-805.773 94.4525,-799.1114"/>
</g>
<!-- units -->
<g id="proc~~compute_dm~~UsesGraph_node12" class="node">
<title>units</title>
<polygon fill="#337ab7" stroke="#337ab7" points="86,-780 32,-780 32,-756 86,-756 86,-780"/>
<text text-anchor="middle" x="59" y="-765.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">units</text>
</g>
<!-- proc~compute_dm&#45;&gt;units -->
<g id="proc~~compute_dm~~UsesGraph_edge11" class="edge">
<title>proc~compute_dm&#45;&gt;units</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M188.7267,-612.1764C181.7634,-640.0453 160.9448,-708.9874 118,-747 111.6911,-752.5843 103.7955,-756.7121 95.8519,-759.7534"/>
<polygon fill="#000000" stroke="#000000" points="94.6266,-756.4723 86.2421,-762.9492 96.8356,-763.1147 94.6266,-756.4723"/>
</g>
<!-- sparse_matrices -->
<g id="proc~~compute_dm~~UsesGraph_node13" class="node">
<title>sparse_matrices</title>
<polygon fill="#337ab7" stroke="#337ab7" points="104.5,-738 13.5,-738 13.5,-714 104.5,-714 104.5,-738"/>
<text text-anchor="middle" x="59" y="-723.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">sparse_matrices</text>
</g>
<!-- proc~compute_dm&#45;&gt;sparse_matrices -->
<g id="proc~~compute_dm~~UsesGraph_edge12" class="edge">
<title>proc~compute_dm&#45;&gt;sparse_matrices</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M186.069,-612.2299C175.8278,-633.9512 151.6309,-679.38 118,-705 116.1378,-706.4186 114.1715,-707.7472 112.1318,-708.9907"/>
<polygon fill="#000000" stroke="#000000" points="110.0197,-706.1482 102.8135,-713.9149 113.2903,-712.3372 110.0197,-706.1482"/>
</g>
<!-- m_dminim -->
<g id="proc~~compute_dm~~UsesGraph_node14" class="node">
<title>m_dminim</title>
<polygon fill="#337ab7" stroke="#337ab7" points="90,-696 28,-696 28,-672 90,-672 90,-696"/>
<text text-anchor="middle" x="59" y="-681.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_dminim</text>
</g>
<!-- proc~compute_dm&#45;&gt;m_dminim -->
<g id="proc~~compute_dm~~UsesGraph_edge13" class="edge">
<title>proc~compute_dm&#45;&gt;m_dminim</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M180.0754,-612.1959C166.4482,-626.134 142.4282,-648.8413 118,-663 112.3824,-666.256 106.1751,-669.1356 99.9589,-671.6374"/>
<polygon fill="#000000" stroke="#000000" points="98.4099,-668.4797 90.2666,-675.2574 100.8592,-675.0372 98.4099,-668.4797"/>
</g>
<!-- siesta_options -->
<g id="proc~~compute_dm~~UsesGraph_node15" class="node">
<title>siesta_options</title>
<polygon fill="#337ab7" stroke="#337ab7" points="99.5,-654 18.5,-654 18.5,-630 99.5,-630 99.5,-654"/>
<text text-anchor="middle" x="59" y="-639.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">siesta_options</text>
</g>
<!-- proc~compute_dm&#45;&gt;siesta_options -->
<g id="proc~~compute_dm~~UsesGraph_edge14" class="edge">
<title>proc~compute_dm&#45;&gt;siesta_options</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M153.8852,-611.9232C139.3245,-616.5386 122.4787,-621.8785 107.0582,-626.7665"/>
<polygon fill="#000000" stroke="#000000" points="105.6439,-623.5431 97.1689,-629.9012 107.7591,-630.2159 105.6439,-623.5431"/>
</g>
<!-- m_chess -->
<g id="proc~~compute_dm~~UsesGraph_node16" class="node">
<title>m_chess</title>
<polygon fill="#337ab7" stroke="#337ab7" points="86.5,-612 31.5,-612 31.5,-588 86.5,-588 86.5,-612"/>
<text text-anchor="middle" x="59" y="-597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_chess</text>
</g>
<!-- proc~compute_dm&#45;&gt;m_chess -->
<g id="proc~~compute_dm~~UsesGraph_edge15" class="edge">
<title>proc~compute_dm&#45;&gt;m_chess</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M153.8852,-600C135.9773,-600 114.6127,-600 96.6945,-600"/>
<polygon fill="#000000" stroke="#000000" points="96.595,-596.5001 86.5949,-600 96.5949,-603.5001 96.595,-596.5001"/>
</g>
<!-- precision -->
<g id="proc~~compute_dm~~UsesGraph_node17" class="node">
<title>precision</title>
<polygon fill="#337ab7" stroke="#337ab7" points="86.5,-570 31.5,-570 31.5,-546 86.5,-546 86.5,-570"/>
<text text-anchor="middle" x="59" y="-555.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">precision</text>
</g>
<!-- proc~compute_dm&#45;&gt;precision -->
<g id="proc~~compute_dm~~UsesGraph_edge16" class="edge">
<title>proc~compute_dm&#45;&gt;precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M153.8852,-588.0768C135.8099,-582.3473 114.213,-575.5015 96.193,-569.7895"/>
<polygon fill="#000000" stroke="#000000" points="97.1851,-566.4324 86.5949,-566.7471 95.0699,-573.1052 97.1851,-566.4324"/>
</g>
<!-- m_zminim -->
<g id="proc~~compute_dm~~UsesGraph_node18" class="node">
<title>m_zminim</title>
<polygon fill="#337ab7" stroke="#337ab7" points="89.5,-528 28.5,-528 28.5,-504 89.5,-504 89.5,-528"/>
<text text-anchor="middle" x="59" y="-513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_zminim</text>
</g>
<!-- proc~compute_dm&#45;&gt;m_zminim -->
<g id="proc~~compute_dm~~UsesGraph_edge17" class="edge">
<title>proc~compute_dm&#45;&gt;m_zminim</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M180.0754,-587.8041C166.4482,-573.866 142.4282,-551.1587 118,-537 112.1223,-533.5932 105.5989,-530.5985 99.0952,-528.0175"/>
<polygon fill="#000000" stroke="#000000" points="100.2515,-524.7135 89.6582,-524.5324 97.8264,-531.28 100.2515,-524.7135"/>
</g>
<!-- m_rmaxh -->
<g id="proc~~compute_dm~~UsesGraph_node19" class="node">
<title>m_rmaxh</title>
<polygon fill="#337ab7" stroke="#337ab7" points="88,-486 30,-486 30,-462 88,-462 88,-486"/>
<text text-anchor="middle" x="59" y="-471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_rmaxh</text>
</g>
<!-- proc~compute_dm&#45;&gt;m_rmaxh -->
<g id="proc~~compute_dm~~UsesGraph_edge18" class="edge">
<title>proc~compute_dm&#45;&gt;m_rmaxh</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M186.069,-587.7701C175.8278,-566.0488 151.6309,-520.62 118,-495 111.9945,-490.425 104.9061,-486.7869 97.7642,-483.9139"/>
<polygon fill="#000000" stroke="#000000" points="98.6833,-480.5256 88.0887,-480.4545 96.3265,-487.1169 98.6833,-480.5256"/>
</g>
<!-- m_pexsi_solver -->
<g id="proc~~compute_dm~~UsesGraph_node20" class="node">
<title>m_pexsi_solver</title>
<polygon fill="#337ab7" stroke="#337ab7" points="102.5,-444 15.5,-444 15.5,-420 102.5,-420 102.5,-444"/>
<text text-anchor="middle" x="59" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_pexsi_solver</text>
</g>
<!-- proc~compute_dm&#45;&gt;m_pexsi_solver -->
<g id="proc~~compute_dm~~UsesGraph_edge19" class="edge">
<title>proc~compute_dm&#45;&gt;m_pexsi_solver</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M188.7267,-587.8236C181.7634,-559.9547 160.9448,-491.0126 118,-453 116.041,-451.266 113.929,-449.6724 111.7101,-448.2082"/>
<polygon fill="#000000" stroke="#000000" points="113.1551,-445.0061 102.7191,-443.1785 109.7375,-451.1152 113.1551,-445.0061"/>
</g>
<!-- m_ordern -->
<g id="proc~~compute_dm~~UsesGraph_node21" class="node">
<title>m_ordern</title>
<polygon fill="#337ab7" stroke="#337ab7" points="88.5,-402 29.5,-402 29.5,-378 88.5,-378 88.5,-402"/>
<text text-anchor="middle" x="59" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ordern</text>
</g>
<!-- proc~compute_dm&#45;&gt;m_ordern -->
<g id="proc~~compute_dm~~UsesGraph_edge20" class="edge">
<title>proc~compute_dm&#45;&gt;m_ordern</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M190.2568,-587.9398C186.2183,-554.9044 170.5248,-462.0262 118,-411 112.5313,-405.6873 105.6316,-401.7095 98.4951,-398.7338"/>
<polygon fill="#000000" stroke="#000000" points="99.3238,-395.314 88.729,-395.266 96.9814,-401.9105 99.3238,-395.314"/>
</g>
<!-- m_energies -->
<g id="proc~~compute_dm~~UsesGraph_node22" class="node">
<title>m_energies</title>
<polygon fill="#337ab7" stroke="#337ab7" points="93.5,-360 24.5,-360 24.5,-336 93.5,-336 93.5,-360"/>
<text text-anchor="middle" x="59" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_energies</text>
</g>
<!-- proc~compute_dm&#45;&gt;m_energies -->
<g id="proc~~compute_dm~~UsesGraph_edge21" class="edge">
<title>proc~compute_dm&#45;&gt;m_energies</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M189.1119,-587.8358C180.481,-544.9815 149.7364,-401.8309 118,-369 113.7883,-364.6431 108.614,-361.1879 103.0958,-358.4484"/>
<polygon fill="#000000" stroke="#000000" points="104.1702,-355.1042 93.5937,-354.4806 101.4729,-361.5636 104.1702,-355.1042"/>
</g>
<!-- iodmhs_netcdf -->
<g id="proc~~compute_dm~~UsesGraph_node23" class="node">
<title>iodmhs_netcdf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="100,-318 18,-318 18,-294 100,-294 100,-318"/>
<text text-anchor="middle" x="59" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">iodmhs_netcdf</text>
</g>
<!-- proc~compute_dm&#45;&gt;iodmhs_netcdf -->
<g id="proc~~compute_dm~~UsesGraph_edge22" class="edge">
<title>proc~compute_dm&#45;&gt;iodmhs_netcdf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M189.7704,-587.9996C182.714,-540.558 154.7248,-366.7452 118,-327 115.4129,-324.2001 112.4276,-321.7732 109.2019,-319.6697"/>
<polygon fill="#000000" stroke="#000000" points="110.6731,-316.4867 100.2097,-314.8228 107.3517,-322.6485 110.6731,-316.4867"/>
</g>
<!-- m_gamma -->
<g id="proc~~compute_dm~~UsesGraph_node24" class="node">
<title>m_gamma</title>
<polygon fill="#337ab7" stroke="#337ab7" points="91,-276 27,-276 27,-252 91,-252 91,-276"/>
<text text-anchor="middle" x="59" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_gamma</text>
</g>
<!-- proc~compute_dm&#45;&gt;m_gamma -->
<g id="proc~~compute_dm~~UsesGraph_edge23" class="edge">
<title>proc~compute_dm&#45;&gt;m_gamma</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M190.2302,-587.9745C184.5257,-536.0629 159.7108,-331.6988 118,-285 113.3284,-279.7698 107.2655,-275.842 100.809,-272.8924"/>
<polygon fill="#000000" stroke="#000000" points="101.775,-269.5153 91.1839,-269.2329 99.2873,-276.0583 101.775,-269.5153"/>
</g>
<!-- m_steps -->
<g id="proc~~compute_dm~~UsesGraph_node25" class="node">
<title>m_steps</title>
<polygon fill="#337ab7" stroke="#337ab7" points="86,-234 32,-234 32,-210 86,-210 86,-234"/>
<text text-anchor="middle" x="59" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_steps</text>
</g>
<!-- proc~compute_dm&#45;&gt;m_steps -->
<g id="proc~~compute_dm~~UsesGraph_edge24" class="edge">
<title>proc~compute_dm&#45;&gt;m_steps</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M190.5831,-587.9258C186.0929,-531.7819 164.7236,-296.7102 118,-243 112.2042,-236.3376 104.1474,-231.7889 95.8476,-228.6833"/>
<polygon fill="#000000" stroke="#000000" points="96.7017,-225.2837 86.1136,-225.6603 94.6256,-231.9688 96.7017,-225.2837"/>
</g>
<!-- siesta_geom -->
<g id="proc~~compute_dm~~UsesGraph_node26" class="node">
<title>siesta_geom</title>
<polygon fill="#337ab7" stroke="#337ab7" points="95.5,-192 22.5,-192 22.5,-168 95.5,-168 95.5,-192"/>
<text text-anchor="middle" x="59" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">siesta_geom</text>
</g>
<!-- proc~compute_dm&#45;&gt;siesta_geom -->
<g id="proc~~compute_dm~~UsesGraph_edge25" class="edge">
<title>proc~compute_dm&#45;&gt;siesta_geom</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M190.8574,-587.7453C187.4573,-527.3369 169.7239,-261.7269 118,-201 114.3869,-196.758 109.8558,-193.3728 104.9191,-190.6714"/>
<polygon fill="#000000" stroke="#000000" points="106.26,-187.4366 95.7057,-186.5099 103.3785,-193.816 106.26,-187.4366"/>
</g>
<!-- m_compute_ebs_shift -->
<g id="proc~~compute_dm~~UsesGraph_node27" class="node">
<title>m_compute_ebs_shift</title>
<polygon fill="#337ab7" stroke="#337ab7" points="118,-150 0,-150 0,-126 118,-126 118,-150"/>
<text text-anchor="middle" x="59" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_compute_ebs_shift</text>
</g>
<!-- proc~compute_dm&#45;&gt;m_compute_ebs_shift -->
<g id="proc~~compute_dm~~UsesGraph_edge26" class="edge">
<title>proc~compute_dm&#45;&gt;m_compute_ebs_shift</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M191.093,-587.7621C188.7262,-523.6486 174.8003,-226.848 118,-159 117.2672,-158.1246 116.4952,-157.2858 115.6885,-156.4818"/>
<polygon fill="#000000" stroke="#000000" points="117.6409,-153.5651 107.6118,-150.1494 113.3219,-159.0738 117.6409,-153.5651"/>
</g>
<!-- m_spin -->
<g id="proc~~compute_dm~~UsesGraph_node28" class="node">
<title>m_spin</title>
<polygon fill="#337ab7" stroke="#337ab7" points="86,-108 32,-108 32,-84 86,-84 86,-108"/>
<text text-anchor="middle" x="59" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_spin</text>
</g>
<!-- proc~compute_dm&#45;&gt;m_spin -->
<g id="proc~~compute_dm~~UsesGraph_edge27" class="edge">
<title>proc~compute_dm&#45;&gt;m_spin</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M191.2917,-587.958C189.8962,-520.7213 179.9492,-192.07 118,-117 112.3298,-110.1288 104.2451,-105.5048 95.8724,-102.3934"/>
<polygon fill="#000000" stroke="#000000" points="96.6249,-98.9637 86.0387,-99.3917 94.5812,-105.6588 96.6249,-98.9637"/>
</g>
<!-- m_transiesta -->
<g id="proc~~compute_dm~~UsesGraph_node29" class="node">
<title>m_transiesta</title>
<polygon fill="#337ab7" stroke="#337ab7" points="96,-66 22,-66 22,-42 96,-42 96,-66"/>
<text text-anchor="middle" x="59" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_transiesta</text>
</g>
<!-- proc~compute_dm&#45;&gt;m_transiesta -->
<g id="proc~~compute_dm~~UsesGraph_edge28" class="edge">
<title>proc~compute_dm&#45;&gt;m_transiesta</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M190.5341,-587.6292C184.547,-512.2223 151.6569,-116.2842 118,-75 114.609,-70.8405 110.3322,-67.5043 105.6374,-64.8285"/>
<polygon fill="#000000" stroke="#000000" points="106.7605,-61.4912 96.2165,-60.4541 103.8124,-67.8401 106.7605,-61.4912"/>
</g>
<!-- m_ts_global_vars -->
<g id="proc~~compute_dm~~UsesGraph_node30" class="node">
<title>m_ts_global_vars</title>
<polygon fill="#337ab7" stroke="#337ab7" points="107.5,-24 10.5,-24 10.5,0 107.5,0 107.5,-24"/>
<text text-anchor="middle" x="59" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ts_global_vars</text>
</g>
<!-- proc~compute_dm&#45;&gt;m_ts_global_vars -->
<g id="proc~~compute_dm~~UsesGraph_edge29" class="edge">
<title>proc~compute_dm&#45;&gt;m_ts_global_vars</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M190.6888,-587.9314C185.3433,-509.8516 154.2672,-77.9514 118,-33 117.2832,-32.1115 116.5259,-31.2606 115.7326,-30.4456"/>
<polygon fill="#000000" stroke="#000000" points="117.7364,-27.566 107.7458,-24.0393 113.3565,-33.0265 117.7364,-27.566"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="490pt" height="32pt"
 viewBox="0.00 0.00 489.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 485.5,-28 485.5,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node">
<title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node">
<title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="139.5,-24 72.5,-24 72.5,0 139.5,0 139.5,-24"/>
<text text-anchor="middle" x="106" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="222,-24 158,-24 158,0 222,0 222,-24"/>
<text text-anchor="middle" x="190" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="294,-24 240,-24 240,0 294,0 294,-24"/>
<text text-anchor="middle" x="267" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="366,-24 312,-24 312,0 366,0 366,-24"/>
<text text-anchor="middle" x="339" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="481.5,-24 384.5,-24 384.5,0 481.5,0 481.5,-24"/>
<text text-anchor="middle" x="433" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses.
    </p>
    </div></div></div></div>
      </li>
      
      </ul>
    </div>
    


    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iscf%7E2"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>iscf</strong></td><td></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: proc~~compute_dm~~CallsGraph Pages: 1 -->
<svg id="proccompute_dmCallsGraph" width="223pt" height="914pt"
 viewBox="0.00 0.00 223.00 914.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~compute_dm~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 910)">
<title>proc~~compute_dm~~CallsGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-910 219,-910 219,4 -4,4"/>
<!-- proc~compute_dm -->
<g id="proc~~compute_dm~~CallsGraph_node1" class="node">
<title>proc~compute_dm</title>
<polygon fill="none" stroke="#000000" points="75,-465 0,-465 0,-441 75,-441 75,-465"/>
<text text-anchor="middle" x="37.5" y="-450.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">compute_dm</text>
</g>
<!-- escf -->
<g id="proc~~compute_dm~~CallsGraph_node2" class="node">
<title>escf</title>
<polygon fill="#777777" stroke="#777777" points="190,-906 136,-906 136,-882 190,-882 190,-906"/>
<text text-anchor="middle" x="163" y="-891.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">escf</text>
</g>
<!-- proc~compute_dm&#45;&gt;escf -->
<g id="proc~~compute_dm~~CallsGraph_edge1" class="edge">
<title>proc~compute_dm&#45;&gt;escf</title>
<path fill="none" stroke="#000000" d="M38.0611,-465.0231C41.1638,-526.7333 58.0463,-807.5318 111,-873 115.0985,-878.0671 120.6089,-881.9201 126.5126,-884.8475"/>
<polygon fill="#000000" stroke="#000000" points="125.3871,-888.1688 135.9672,-888.7273 128.0446,-881.6929 125.3871,-888.1688"/>
</g>
<!-- bye -->
<g id="proc~~compute_dm~~CallsGraph_node3" class="node">
<title>bye</title>
<polygon fill="#777777" stroke="#777777" points="190,-864 136,-864 136,-840 190,-840 190,-864"/>
<text text-anchor="middle" x="163" y="-849.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">bye</text>
</g>
<!-- proc~compute_dm&#45;&gt;bye -->
<g id="proc~~compute_dm~~CallsGraph_edge3" class="edge">
<title>proc~compute_dm&#45;&gt;bye</title>
<path fill="none" stroke="#000000" d="M38.3393,-465.3415C42.5442,-523.8468 63.0474,-772.8417 111,-831 115.1053,-835.979 120.5706,-839.7876 126.4165,-842.6979"/>
<polygon fill="#000000" stroke="#000000" points="125.1969,-845.981 135.7753,-846.5711 127.8738,-839.5131 125.1969,-845.981"/>
</g>
<!-- dold -->
<g id="proc~~compute_dm~~CallsGraph_node4" class="node">
<title>dold</title>
<polygon fill="#777777" stroke="#777777" points="190,-822 136,-822 136,-798 190,-798 190,-822"/>
<text text-anchor="middle" x="163" y="-807.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">dold</text>
</g>
<!-- proc~compute_dm&#45;&gt;dold -->
<g id="proc~~compute_dm~~CallsGraph_edge2" class="edge">
<title>proc~compute_dm&#45;&gt;dold</title>
<path fill="none" stroke="#000000" d="M38.6358,-465.0421C43.9406,-518.9748 67.8561,-737.8991 111,-789 115.1631,-793.9309 120.6562,-797.7161 126.5116,-800.6185"/>
<polygon fill="#000000" stroke="#000000" points="125.2936,-803.9023 135.8721,-804.4904 127.9693,-797.4338 125.2936,-803.9023"/>
</g>
<!-- compute_ebs_shift -->
<g id="proc~~compute_dm~~CallsGraph_node5" class="node">
<title>compute_ebs_shift</title>
<polygon fill="#777777" stroke="#777777" points="214.5,-780 111.5,-780 111.5,-756 214.5,-756 214.5,-780"/>
<text text-anchor="middle" x="163" y="-765.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">compute_ebs_shift</text>
</g>
<!-- proc~compute_dm&#45;&gt;compute_ebs_shift -->
<g id="proc~~compute_dm~~CallsGraph_edge4" class="edge">
<title>proc~compute_dm&#45;&gt;compute_ebs_shift</title>
<path fill="none" stroke="#000000" d="M39.0611,-465.1843C45.6675,-515.0539 72.7552,-703.0393 111,-747 111.8627,-747.9916 112.779,-748.9371 113.7409,-749.8385"/>
<polygon fill="#000000" stroke="#000000" points="111.7693,-752.7345 121.8737,-755.9208 115.9617,-747.1288 111.7693,-752.7345"/>
</g>
<!-- write_hs_formatted -->
<g id="proc~~compute_dm~~CallsGraph_node6" class="node">
<title>write_hs_formatted</title>
<polygon fill="#777777" stroke="#777777" points="215,-738 111,-738 111,-714 215,-714 215,-738"/>
<text text-anchor="middle" x="163" y="-723.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">write_hs_formatted</text>
</g>
<!-- proc~compute_dm&#45;&gt;write_hs_formatted -->
<g id="proc~~compute_dm~~CallsGraph_edge5" class="edge">
<title>proc~compute_dm&#45;&gt;write_hs_formatted</title>
<path fill="none" stroke="#000000" d="M39.6192,-465.2611C47.6704,-510.6039 77.5983,-668.0783 111,-705 111.9002,-705.995 112.8541,-706.9438 113.8534,-707.8483"/>
<polygon fill="#000000" stroke="#000000" points="112.1149,-710.9113 122.2638,-713.9529 116.2268,-705.2462 112.1149,-710.9113"/>
</g>
<!-- pexsi_solver -->
<g id="proc~~compute_dm~~CallsGraph_node7" class="node">
<title>pexsi_solver</title>
<polygon fill="#777777" stroke="#777777" points="199,-696 127,-696 127,-672 199,-672 199,-696"/>
<text text-anchor="middle" x="163" y="-681.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pexsi_solver</text>
</g>
<!-- proc~compute_dm&#45;&gt;pexsi_solver -->
<g id="proc~~compute_dm~~CallsGraph_edge6" class="edge">
<title>proc~compute_dm&#45;&gt;pexsi_solver</title>
<path fill="none" stroke="#000000" d="M38.3432,-465.2192C41.4194,-500.5952 55.0098,-604.306 111,-663 113.0791,-665.1795 115.4151,-667.1389 117.9156,-668.8996"/>
<polygon fill="#000000" stroke="#000000" points="116.5152,-672.1347 126.9164,-674.1513 120.043,-666.0886 116.5152,-672.1347"/>
</g>
<!-- write_orb_indx -->
<g id="proc~~compute_dm~~CallsGraph_node8" class="node">
<title>write_orb_indx</title>
<polygon fill="#777777" stroke="#777777" points="204,-654 122,-654 122,-630 204,-630 204,-654"/>
<text text-anchor="middle" x="163" y="-639.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">write_orb_indx</text>
</g>
<!-- proc~compute_dm&#45;&gt;write_orb_indx -->
<g id="proc~~compute_dm~~CallsGraph_edge7" class="edge">
<title>proc~compute_dm&#45;&gt;write_orb_indx</title>
<path fill="none" stroke="#000000" d="M39.6008,-465.3764C45.4057,-495.9307 64.425,-575.738 111,-621 112.2481,-622.2129 113.5754,-623.3588 114.9648,-624.4411"/>
<polygon fill="#000000" stroke="#000000" points="113.188,-627.4605 123.4816,-629.9691 116.9991,-621.5889 113.188,-627.4605"/>
</g>
<!-- timer -->
<g id="proc~~compute_dm~~CallsGraph_node9" class="node">
<title>timer</title>
<polygon fill="#777777" stroke="#777777" points="190,-612 136,-612 136,-588 190,-588 190,-612"/>
<text text-anchor="middle" x="163" y="-597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">timer</text>
</g>
<!-- proc~compute_dm&#45;&gt;timer -->
<g id="proc~~compute_dm~~CallsGraph_edge8" class="edge">
<title>proc~compute_dm&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M43.3494,-465.2198C57.0772,-493.4894 91.6572,-562.2641 111,-579 115.5281,-582.9178 120.8816,-586.1652 126.4027,-588.8382"/>
<polygon fill="#000000" stroke="#000000" points="125.1643,-592.1149 135.7362,-592.8113 127.906,-585.6742 125.1643,-592.1149"/>
</g>
<!-- ordern -->
<g id="proc~~compute_dm~~CallsGraph_node10" class="node">
<title>ordern</title>
<polygon fill="#777777" stroke="#777777" points="190,-570 136,-570 136,-546 190,-546 190,-570"/>
<text text-anchor="middle" x="163" y="-555.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ordern</text>
</g>
<!-- proc~compute_dm&#45;&gt;ordern -->
<g id="proc~~compute_dm~~CallsGraph_edge9" class="edge">
<title>proc~compute_dm&#45;&gt;ordern</title>
<path fill="none" stroke="#000000" d="M45.3679,-465.1729C57.5066,-483.1033 82.4112,-516.681 111,-537 115.6624,-540.3137 120.9235,-543.2125 126.2629,-545.7122"/>
<polygon fill="#000000" stroke="#000000" points="125.2738,-549.0947 135.8461,-549.7843 128.0113,-542.6522 125.2738,-549.0947"/>
</g>
<!-- dscf -->
<g id="proc~~compute_dm~~CallsGraph_node11" class="node">
<title>dscf</title>
<polygon fill="#777777" stroke="#777777" points="190,-528 136,-528 136,-504 190,-504 190,-528"/>
<text text-anchor="middle" x="163" y="-513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">dscf</text>
</g>
<!-- proc~compute_dm&#45;&gt;dscf -->
<g id="proc~~compute_dm~~CallsGraph_edge10" class="edge">
<title>proc~compute_dm&#45;&gt;dscf</title>
<path fill="none" stroke="#000000" d="M57.0733,-465.1516C71.6611,-473.9681 92.2216,-485.8947 111,-495 115.9826,-497.416 121.3179,-499.795 126.6032,-502.0342"/>
<polygon fill="#000000" stroke="#000000" points="125.3964,-505.3223 135.976,-505.8916 128.0605,-498.8491 125.3964,-505.3223"/>
</g>
<!-- normalize_dm -->
<g id="proc~~compute_dm~~CallsGraph_node12" class="node">
<title>normalize_dm</title>
<polygon fill="#777777" stroke="#777777" points="203,-486 123,-486 123,-462 203,-462 203,-486"/>
<text text-anchor="middle" x="163" y="-471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">normalize_dm</text>
</g>
<!-- proc~compute_dm&#45;&gt;normalize_dm -->
<g id="proc~~compute_dm~~CallsGraph_edge11" class="edge">
<title>proc~compute_dm&#45;&gt;normalize_dm</title>
<path fill="none" stroke="#000000" d="M75.1541,-459.3007C87.0041,-461.2836 100.2836,-463.5056 112.8586,-465.6098"/>
<polygon fill="#000000" stroke="#000000" points="112.311,-469.0668 122.7516,-467.2652 113.4663,-462.1627 112.311,-469.0668"/>
</g>
<!-- mulliken -->
<g id="proc~~compute_dm~~CallsGraph_node13" class="node">
<title>mulliken</title>
<polygon fill="#777777" stroke="#777777" points="190,-444 136,-444 136,-420 190,-420 190,-444"/>
<text text-anchor="middle" x="163" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mulliken</text>
</g>
<!-- proc~compute_dm&#45;&gt;mulliken -->
<g id="proc~~compute_dm~~CallsGraph_edge12" class="edge">
<title>proc~compute_dm&#45;&gt;mulliken</title>
<path fill="none" stroke="#000000" d="M75.1541,-446.6993C91.1455,-444.0235 109.7403,-440.912 125.6935,-438.2425"/>
<polygon fill="#000000" stroke="#000000" points="126.4566,-441.6636 135.7418,-436.5611 125.3013,-434.7596 126.4566,-441.6636"/>
</g>
<!-- dminim -->
<g id="proc~~compute_dm~~CallsGraph_node14" class="node">
<title>dminim</title>
<polygon fill="#777777" stroke="#777777" points="190,-402 136,-402 136,-378 190,-378 190,-402"/>
<text text-anchor="middle" x="163" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">dminim</text>
</g>
<!-- proc~compute_dm&#45;&gt;dminim -->
<g id="proc~~compute_dm~~CallsGraph_edge13" class="edge">
<title>proc~compute_dm&#45;&gt;dminim</title>
<path fill="none" stroke="#000000" d="M57.0733,-440.8484C71.6611,-432.0319 92.2216,-420.1053 111,-411 115.9826,-408.584 121.3179,-406.205 126.6032,-403.9658"/>
<polygon fill="#000000" stroke="#000000" points="128.0605,-407.1509 135.976,-400.1084 125.3964,-400.6777 128.0605,-407.1509"/>
</g>
<!-- mpi_bcast -->
<g id="proc~~compute_dm~~CallsGraph_node15" class="node">
<title>mpi_bcast</title>
<polygon fill="#777777" stroke="#777777" points="193.5,-360 132.5,-360 132.5,-336 193.5,-336 193.5,-360"/>
<text text-anchor="middle" x="163" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mpi_bcast</text>
</g>
<!-- proc~compute_dm&#45;&gt;mpi_bcast -->
<g id="proc~~compute_dm~~CallsGraph_edge14" class="edge">
<title>proc~compute_dm&#45;&gt;mpi_bcast</title>
<path fill="none" stroke="#000000" d="M45.3679,-440.8271C57.5066,-422.8967 82.4112,-389.319 111,-369 114.7163,-366.3587 118.8129,-363.9811 123.0264,-361.859"/>
<polygon fill="#000000" stroke="#000000" points="124.6857,-364.9493 132.3349,-357.6185 121.7837,-358.5791 124.6857,-364.9493"/>
</g>
<!-- transiesta -->
<g id="proc~~compute_dm~~CallsGraph_node16" class="node">
<title>transiesta</title>
<polygon fill="#777777" stroke="#777777" points="192.5,-318 133.5,-318 133.5,-294 192.5,-294 192.5,-318"/>
<text text-anchor="middle" x="163" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">transiesta</text>
</g>
<!-- proc~compute_dm&#45;&gt;transiesta -->
<g id="proc~~compute_dm~~CallsGraph_edge15" class="edge">
<title>proc~compute_dm&#45;&gt;transiesta</title>
<path fill="none" stroke="#000000" d="M43.3494,-440.7802C57.0772,-412.5106 91.6572,-343.7359 111,-327 114.9034,-323.6227 119.4202,-320.7435 124.129,-318.3011"/>
<polygon fill="#000000" stroke="#000000" points="125.6556,-321.4518 133.3098,-314.1263 122.758,-315.0797 125.6556,-321.4518"/>
</g>
<!-- moments -->
<g id="proc~~compute_dm~~CallsGraph_node17" class="node">
<title>moments</title>
<polygon fill="#777777" stroke="#777777" points="191.5,-276 134.5,-276 134.5,-252 191.5,-252 191.5,-276"/>
<text text-anchor="middle" x="163" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">moments</text>
</g>
<!-- proc~compute_dm&#45;&gt;moments -->
<g id="proc~~compute_dm~~CallsGraph_edge16" class="edge">
<title>proc~compute_dm&#45;&gt;moments</title>
<path fill="none" stroke="#000000" d="M39.6008,-440.6236C45.4057,-410.0693 64.425,-330.262 111,-285 115.0584,-281.056 119.9546,-277.8204 125.0989,-275.1748"/>
<polygon fill="#000000" stroke="#000000" points="126.7649,-278.2653 134.4993,-271.0244 123.9376,-271.8616 126.7649,-278.2653"/>
</g>
<!-- eold -->
<g id="proc~~compute_dm~~CallsGraph_node18" class="node">
<title>eold</title>
<polygon fill="#777777" stroke="#777777" points="190,-234 136,-234 136,-210 190,-210 190,-234"/>
<text text-anchor="middle" x="163" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">eold</text>
</g>
<!-- proc~compute_dm&#45;&gt;eold -->
<g id="proc~~compute_dm~~CallsGraph_edge17" class="edge">
<title>proc~compute_dm&#45;&gt;eold</title>
<path fill="none" stroke="#000000" d="M38.3432,-440.7808C41.4194,-405.4048 55.0098,-301.694 111,-243 115.2622,-238.532 120.604,-234.989 126.2291,-232.1868"/>
<polygon fill="#000000" stroke="#000000" points="127.9702,-235.2509 135.8222,-228.1378 125.2482,-228.8018 127.9702,-235.2509"/>
</g>
<!-- diagon -->
<g id="proc~~compute_dm~~CallsGraph_node19" class="node">
<title>diagon</title>
<polygon fill="#777777" stroke="#777777" points="190,-192 136,-192 136,-168 190,-168 190,-192"/>
<text text-anchor="middle" x="163" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">diagon</text>
</g>
<!-- proc~compute_dm&#45;&gt;diagon -->
<g id="proc~~compute_dm~~CallsGraph_edge18" class="edge">
<title>proc~compute_dm&#45;&gt;diagon</title>
<path fill="none" stroke="#000000" d="M39.6192,-440.7389C47.6704,-395.3961 77.5983,-237.9217 111,-201 115.2865,-196.2618 120.7924,-192.5729 126.6109,-189.7066"/>
<polygon fill="#000000" stroke="#000000" points="127.9946,-192.9218 135.8813,-185.8471 125.3041,-186.4595 127.9946,-192.9218"/>
</g>
<!-- chess_wrapper -->
<g id="proc~~compute_dm~~CallsGraph_node20" class="node">
<title>chess_wrapper</title>
<polygon fill="#777777" stroke="#777777" points="205.5,-150 120.5,-150 120.5,-126 205.5,-126 205.5,-150"/>
<text text-anchor="middle" x="163" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">chess_wrapper</text>
</g>
<!-- proc~compute_dm&#45;&gt;chess_wrapper -->
<g id="proc~~compute_dm~~CallsGraph_edge19" class="edge">
<title>proc~compute_dm&#45;&gt;chess_wrapper</title>
<path fill="none" stroke="#000000" d="M39.0611,-440.8157C45.6675,-390.9461 72.7552,-202.9607 111,-159 111.8627,-158.0084 112.779,-157.0629 113.7409,-156.1615"/>
<polygon fill="#000000" stroke="#000000" points="115.9617,-158.8712 121.8737,-150.0792 111.7693,-153.2655 115.9617,-158.8712"/>
</g>
<!-- write_dmh_netcdf -->
<g id="proc~~compute_dm~~CallsGraph_node21" class="node">
<title>write_dmh_netcdf</title>
<polygon fill="#777777" stroke="#777777" points="211.5,-108 114.5,-108 114.5,-84 211.5,-84 211.5,-108"/>
<text text-anchor="middle" x="163" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">write_dmh_netcdf</text>
</g>
<!-- proc~compute_dm&#45;&gt;write_dmh_netcdf -->
<g id="proc~~compute_dm~~CallsGraph_edge20" class="edge">
<title>proc~compute_dm&#45;&gt;write_dmh_netcdf</title>
<path fill="none" stroke="#000000" d="M38.6358,-440.9579C43.9406,-387.0252 67.8561,-168.1009 111,-117 111.7223,-116.1445 112.4846,-115.3234 113.282,-114.5355"/>
<polygon fill="#000000" stroke="#000000" points="115.5383,-117.2144 121.2661,-108.3013 111.2302,-111.6971 115.5383,-117.2144"/>
</g>
<!-- zminim -->
<g id="proc~~compute_dm~~CallsGraph_node22" class="node">
<title>zminim</title>
<polygon fill="#777777" stroke="#777777" points="190,-66 136,-66 136,-42 190,-42 190,-66"/>
<text text-anchor="middle" x="163" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">zminim</text>
</g>
<!-- proc~compute_dm&#45;&gt;zminim -->
<g id="proc~~compute_dm~~CallsGraph_edge21" class="edge">
<title>proc~compute_dm&#45;&gt;zminim</title>
<path fill="none" stroke="#000000" d="M38.3393,-440.6585C42.5442,-382.1532 63.0474,-133.1583 111,-75 115.1053,-70.021 120.5706,-66.2124 126.4165,-63.3021"/>
<polygon fill="#000000" stroke="#000000" points="127.8738,-66.4869 135.7753,-59.4289 125.1969,-60.019 127.8738,-66.4869"/>
</g>
<!-- val -->
<g id="proc~~compute_dm~~CallsGraph_node23" class="node">
<title>val</title>
<polygon fill="#777777" stroke="#777777" points="190,-24 136,-24 136,0 190,0 190,-24"/>
<text text-anchor="middle" x="163" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">val</text>
</g>
<!-- proc~compute_dm&#45;&gt;val -->
<g id="proc~~compute_dm~~CallsGraph_edge22" class="edge">
<title>proc~compute_dm&#45;&gt;val</title>
<path fill="none" stroke="#000000" d="M38.0611,-440.9769C41.1638,-379.2667 58.0463,-98.4682 111,-33 115.0985,-27.9329 120.6089,-24.0799 126.5126,-21.1525"/>
<polygon fill="#000000" stroke="#000000" points="128.0446,-24.3071 135.9672,-17.2727 125.3871,-17.8312 128.0446,-24.3071"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,0 64,0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,0 136,0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,0 209.5,0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,0 364,0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,0 436,0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="551.5,-24 454.5,-24 454.5,0 551.5,0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: proc~~compute_dm~~CalledByGraph Pages: 1 -->
<svg id="proccompute_dmCalledByGraph" width="195pt" height="32pt"
 viewBox="0.00 0.00 195.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~compute_dm~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~compute_dm~~CalledByGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 191,-28 191,4 -4,4"/>
<!-- proc~compute_dm -->
<g id="proc~~compute_dm~~CalledByGraph_node1" class="node">
<title>proc~compute_dm</title>
<polygon fill="none" stroke="#000000" points="187,-24 112,-24 112,0 187,0 187,-24"/>
<text text-anchor="middle" x="149.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">compute_dm</text>
</g>
<!-- proc~siesta_forces -->
<g id="proc~~compute_dm~~CalledByGraph_node2" class="node">
<title>proc~siesta_forces</title>
<g id="a_proc~~compute_dm~~CalledByGraph_node2"><a xlink:href=".././proc/siesta_forces.html" xlink:title="siesta_forces">
<polygon fill="#d9534f" stroke="#d9534f" points="76,-24 0,-24 0,0 76,0 76,-24"/>
<text text-anchor="middle" x="38" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">siesta_forces</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;proc~compute_dm -->
<g id="proc~~compute_dm~~CalledByGraph_edge1" class="edge">
<title>proc~siesta_forces&#45;&gt;proc~compute_dm</title>
<path fill="none" stroke="#000000" d="M76.0601,-12C84.3127,-12 93.1423,-12 101.7153,-12"/>
<polygon fill="#000000" stroke="#000000" points="101.9892,-15.5001 111.9892,-12 101.9891,-8.5001 101.9892,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,0 64,0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,0 136,0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,0 209.5,0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,0 364,0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,0 436,0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="551.5,-24 454.5,-24 454.5,0 551.5,0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/compute_dm.html#src">compute_dm</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>      <span class="k">subroutine </span><span class="n">compute_dm</span><span class="p">(</span> <span class="n">iscf</span> <span class="p">)</span>
      <span class="k">use </span><span class="nb">precision</span>
<span class="nb">      </span><span class="k">use </span><span class="n">units</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">eV</span>
      <span class="k">USE </span><span class="n">siesta_options</span>
      <span class="k">use </span><span class="n">class_dSpData1D</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">val</span>
      <span class="k">use </span><span class="n">sparse_matrices</span>
      <span class="k">use </span><span class="n">siesta_geom</span>
      <span class="k">use </span><span class="n">atomlist</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">qa</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span> <span class="n">iaorb</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">indxuo</span><span class="p">,</span> 
     <span class="p">&amp;</span>                    <span class="n">qtot</span><span class="p">,</span> <span class="n">Qtots</span><span class="p">,</span> <span class="n">no_l</span>
      <span class="k">use </span><span class="n">sys</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">die</span><span class="p">,</span> <span class="n">bye</span>
      <span class="k">use </span><span class="n">Kpoint_grid</span>
      <span class="k">use </span><span class="n">m_energies</span><span class="p">,</span>   <span class="n">only</span><span class="p">:</span> <span class="n">Ebs</span><span class="p">,</span> <span class="n">Ecorrec</span><span class="p">,</span> <span class="n">Entropy</span><span class="p">,</span> <span class="n">DE_NEGF</span>
      <span class="k">use </span><span class="n">m_energies</span><span class="p">,</span>   <span class="n">only</span><span class="p">:</span> <span class="n">Ef</span><span class="p">,</span> <span class="n">Efs</span>
      <span class="k">use </span><span class="n">m_rmaxh</span>
      <span class="k">use </span><span class="n">m_eo</span>
      <span class="k">use </span><span class="n">m_spin</span><span class="p">,</span>   <span class="n">only</span><span class="p">:</span> <span class="n">spin</span>
      <span class="k">use </span><span class="n">m_diagon</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">diagon</span>
      <span class="k">use </span><span class="n">m_gamma</span>
      <span class="k">use </span><span class="n">parallel</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">IONode</span>
      <span class="k">use </span><span class="n">parallel</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">SIESTA_worker</span>
      <span class="k">use </span><span class="n">m_compute_ebs_shift</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">compute_ebs_shift</span>
<span class="cp">#ifdef SIESTA__PEXSI</span>
      <span class="k">use </span><span class="n">m_pexsi_solver</span><span class="p">,</span>  <span class="n">only</span><span class="p">:</span> <span class="n">pexsi_solver</span>
<span class="cp">#endif</span>
      <span class="k">use </span><span class="n">m_hsx</span><span class="p">,</span> <span class="n">only</span>      <span class="p">:</span> <span class="n">write_hs_formatted</span>
<span class="cp">#ifdef MPI</span>
      <span class="k">use </span><span class="n">mpi_siesta</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef CDF</span>
      <span class="k">use </span><span class="n">iodmhs_netcdf</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">write_dmh_netcdf</span>
<span class="cp">#endif</span>
      <span class="k">use </span><span class="n">m_dminim</span><span class="p">,</span>        <span class="n">only</span> <span class="p">:</span> <span class="n">dminim</span>
      <span class="k">use </span><span class="n">m_zminim</span><span class="p">,</span>        <span class="n">only</span> <span class="p">:</span> <span class="n">zminim</span>
      <span class="k">use </span><span class="n">m_ordern</span><span class="p">,</span>        <span class="n">only</span> <span class="p">:</span> <span class="n">ordern</span>
      <span class="k">use </span><span class="n">m_steps</span><span class="p">,</span>         <span class="n">only</span> <span class="p">:</span> <span class="n">istp</span>
      <span class="k">use </span><span class="n">m_normalize_dm</span><span class="p">,</span>  <span class="n">only</span> <span class="p">:</span> <span class="n">normalize_dm</span>
<span class="cp">#ifdef SIESTA__CHESS</span>
      <span class="k">use </span><span class="n">m_chess</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">CheSS_wrapper</span>
<span class="cp">#endif</span>
      <span class="k">use </span><span class="n">m_energies</span><span class="p">,</span>   <span class="n">only</span><span class="p">:</span> <span class="n">DE_NEGF</span>
      <span class="k">use </span><span class="n">m_ts_global_vars</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">TSmode</span><span class="p">,</span> <span class="n">TSinit</span><span class="p">,</span> <span class="n">TSrun</span>
      <span class="k">use </span><span class="n">m_transiesta</span><span class="p">,</span>     <span class="n">only</span> <span class="p">:</span> <span class="n">transiesta</span>
      
      <span class="k">implicit none</span>
      
<span class="c">!     Input variables</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iscf</span>

      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">delta_Ebs</span><span class="p">,</span> <span class="n">delta_Ef</span>
      <span class="kt">logical</span>             <span class="kd">::</span> <span class="n">CallDiagon</span>
      <span class="kt">integer</span>             <span class="kd">::</span> <span class="n">nnz</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">H_kin</span><span class="p">(:)</span>

      <span class="c">! e1&gt;e2 to signal that we do not want DOS weights</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">e1</span> <span class="o">=</span> <span class="mf">1.0_dp</span><span class="p">,</span> <span class="n">e2</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0_dp</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">buffer1</span>
      <span class="kt">integer</span>             <span class="kd">::</span> <span class="n">mpierr</span>

<span class="c">!       character(15)            :: filename, indexstr</span>
<span class="c">!       character(15), parameter :: fnameform = &#39;(A,A,A)&#39;</span>


<span class="c">!-------------------------------------------------------------------- BEGIN</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">SIESTA_worker</span><span class="p">)</span> <span class="k">call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;compute_dm&#39;</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span>

<span class="cp">#ifdef MPI</span>
      <span class="k">call </span><span class="n">MPI_Bcast</span><span class="p">(</span><span class="n">isolve</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">MPI_integer</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">true_MPI_Comm_World</span><span class="p">,</span><span class="n">mpierr</span><span class="p">)</span>
<span class="cp">#endif     </span>

      <span class="k">if</span> <span class="p">(</span><span class="n">SIESTA_worker</span><span class="p">)</span> <span class="k">then</span>
         <span class="c">! Save present density matrix</span>
<span class="c">!$OMP parallel default(shared)</span>
         <span class="k">if</span> <span class="p">(</span> <span class="n">converge_EDM</span> <span class="p">)</span> <span class="k">then</span>
<span class="c">!$OMP workshare</span>
            <span class="n">Eold</span><span class="p">(:,:)</span> <span class="o">=</span> <span class="n">Escf</span><span class="p">(:,:)</span>
            <span class="n">Dold</span><span class="p">(:,:)</span> <span class="o">=</span> <span class="n">Dscf</span><span class="p">(:,:)</span>
<span class="c">!$OMP end workshare</span>
         <span class="k">else</span>
<span class="c">!$OMP workshare</span>
            <span class="n">Dold</span><span class="p">(:,:)</span> <span class="o">=</span> <span class="n">Dscf</span><span class="p">(:,:)</span>
<span class="c">!$OMP end workshare</span>
         <span class="k">end if</span>
<span class="c">!$OMP end parallel</span>
      <span class="k">end if</span>

      <span class="c">! Compute shift in Tr(H*DM) for fermi-level bracketting</span>
      <span class="c">! Use the current H, the previous iteration H, and the</span>
      <span class="c">! previous iteration DM</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">SIESTA_worker</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         if</span> <span class="p">(</span><span class="n">iscf</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            call </span><span class="n">compute_Ebs_shift</span><span class="p">(</span><span class="n">Dscf</span><span class="p">,</span><span class="n">H</span><span class="p">,</span><span class="n">Hold</span><span class="p">,</span><span class="n">delta_Ebs</span><span class="p">)</span>
            <span class="n">delta_Ef</span> <span class="o">=</span> <span class="n">delta_Ebs</span> <span class="o">/</span> <span class="n">qtot</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">ionode</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">isolve</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">SOLVE_PEXSI</span><span class="p">)</span> <span class="k">then</span>
<span class="k">               write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s2">&quot;(a,f16.5)&quot;</span><span class="p">)</span>
     <span class="err">$</span>              <span class="s2">&quot;Estimated change in band-structure energy:&quot;</span><span class="p">,</span>
     <span class="err">$</span>              <span class="n">delta_Ebs</span><span class="o">/</span><span class="n">eV</span><span class="p">,</span> <span class="s2">&quot;Estimated shift in E_fermi: &quot;</span><span class="p">,</span>
     <span class="err">$</span>              <span class="n">delta_Ef</span><span class="o">/</span><span class="n">eV</span>
            <span class="n">endif</span>
               
         <span class="k">else</span>
<span class="k">            </span><span class="n">delta_Ebs</span> <span class="o">=</span> <span class="mf">0.0_dp</span>
            <span class="n">delta_Ef</span>  <span class="o">=</span> <span class="mf">0.0_dp</span>
         <span class="n">endif</span>
      <span class="n">endif</span>

<span class="cp">#ifdef SIESTA__PEXSI</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">isolve</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SOLVE_PEXSI</span><span class="p">)</span> <span class="k">then</span>
        <span class="c">! This test done in node 0 since NonCol and SpOrb</span>
        <span class="c">! are not set for PEXSI-solver-only processes</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">ionode</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            if</span> <span class="p">(</span><span class="n">spin</span><span class="p">%</span><span class="n">NCol</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">spin</span><span class="p">%</span><span class="n">SO</span><span class="p">)</span> <span class="k">call </span><span class="n">die</span><span class="p">(</span>
     <span class="err">$</span>               <span class="s2">&quot;The PEXSI solver does not implement &quot;</span><span class="o">//</span>
     <span class="err">$</span>               <span class="s2">&quot;non-coll spins or Spin-orbit yet&quot;</span><span class="p">)</span>
         <span class="n">endif</span>
         <span class="k">call </span><span class="n">pexsi_solver</span><span class="p">(</span><span class="n">iscf</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">spinor</span><span class="p">,</span>
     <span class="err">$</span>              <span class="n">maxnh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span>
     <span class="err">$</span>              <span class="n">H</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">qtot</span><span class="p">,</span> <span class="n">Dscf</span><span class="p">,</span> <span class="n">Escf</span><span class="p">,</span>
     <span class="err">$</span>              <span class="n">ef</span><span class="p">,</span> <span class="n">Entropy</span><span class="p">,</span> <span class="n">temp</span><span class="p">,</span> <span class="n">delta_Ef</span><span class="p">)</span>
      <span class="n">endif</span>
      <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SIESTA_worker</span><span class="p">)</span> <span class="k">RETURN</span>
<span class="cp">#endif</span>
      <span class="c">! Here we decide if we want to calculate one or more SCF steps by</span>
      <span class="c">! diagonalization before proceeding with the OMM routine</span>
      <span class="n">CallDiagon</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">isolve</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SOLVE_MINIM</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        if</span> <span class="p">(</span><span class="n">istp</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          if</span> <span class="p">((</span><span class="n">iscf</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="n">call_diagon_first_step</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>
     <span class="p">&amp;</span>        <span class="p">(</span><span class="n">call_diagon_first_step</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">))</span> <span class="n">CallDiagon</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
        <span class="k">else</span>
<span class="k">          if</span> <span class="p">((</span><span class="n">iscf</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="n">call_diagon_default</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>
     <span class="p">&amp;</span>        <span class="p">(</span><span class="n">call_diagon_default</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">))</span> <span class="n">CallDiagon</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
        <span class="n">endif</span>
      <span class="n">endif</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">isolve</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">MATRIX_WRITE</span><span class="p">)</span> <span class="k">then</span>
<span class="c">!             write(indexstr,&#39;(I15)&#39;) iscf</span>
<span class="c">!             write(filename,fnameform) &#39;H_&#39;, trim(adjustl(indexstr)), </span>
<span class="c">!      &amp;                                &#39;.matrix&#39;</span>
<span class="c">!             call write_global_matrix( no_s, no_l, maxnh, numh, listh,</span>
<span class="c">!      &amp;           H(1:maxnh,1), filename )</span>
<span class="c">!  </span>
<span class="c">!             write(filename,fnameform) &#39;S_&#39;, trim(adjustl(indexstr)), </span>
<span class="c">!      &amp;                                &#39;.matrix&#39;</span>

<span class="c">!        Note: only one-shot for now</span>
         <span class="k">call </span><span class="n">write_hs_formatted</span><span class="p">(</span><span class="n">no_u</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span>
     <span class="err">$</span>        <span class="n">maxnh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">S</span><span class="p">)</span>
         <span class="k">call </span><span class="n">bye</span><span class="p">(</span><span class="s2">&quot;End of run after writing H.matrix and S.matrix&quot;</span><span class="p">)</span>

<span class="n">c$$$</span>        <span class="k">call </span><span class="n">write_global_matrix_singlenodewrite</span><span class="p">(</span> 
<span class="n">c$$$</span>     <span class="p">&amp;</span>           <span class="n">no_u</span><span class="p">,</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> 
<span class="n">c$$$</span>     <span class="p">&amp;</span>           <span class="n">H</span><span class="p">(:,</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;H.matrix&#39;</span><span class="p">)</span>
<span class="n">c$$$</span>
<span class="n">c$$$</span>        <span class="k">call </span><span class="n">write_global_matrix_singlenodewrite</span><span class="p">(</span> 
<span class="n">c$$$</span>     <span class="p">&amp;</span>           <span class="n">no_u</span><span class="p">,</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> 
<span class="n">c$$$</span>     <span class="p">&amp;</span>           <span class="n">S</span><span class="p">,</span> <span class="s1">&#39;S.matrix&#39;</span><span class="p">)</span>

      <span class="n">elseif</span> <span class="p">((</span><span class="n">isolve</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SOLVE_DIAGON</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">CallDiagon</span><span class="p">))</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">diagon</span><span class="p">(</span><span class="n">no_s</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">spinor</span><span class="p">,</span> 
     <span class="p">&amp;</span>              <span class="n">no_l</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span>
     <span class="p">&amp;</span>              <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> 
     <span class="p">&amp;</span>              <span class="n">H</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">qtot</span><span class="p">,</span> <span class="n">fixspin</span><span class="p">,</span> <span class="n">qtots</span><span class="p">,</span> <span class="n">temp</span><span class="p">,</span> <span class="n">e1</span><span class="p">,</span> <span class="n">e2</span><span class="p">,</span>
     <span class="p">&amp;</span>              <span class="nb">gamma</span><span class="p">,</span> <span class="n">xijo</span><span class="p">,</span> <span class="n">indxuo</span><span class="p">,</span> <span class="n">nkpnt</span><span class="p">,</span> <span class="n">kpoint</span><span class="p">,</span> <span class="n">kweight</span><span class="p">,</span>
     <span class="p">&amp;</span>              <span class="n">eo</span><span class="p">,</span> <span class="n">qo</span><span class="p">,</span> <span class="n">Dscf</span><span class="p">,</span> <span class="n">Escf</span><span class="p">,</span> <span class="n">ef</span><span class="p">,</span> <span class="n">efs</span><span class="p">,</span> <span class="n">Entropy</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span>
     <span class="p">&amp;</span>              <span class="n">occtol</span><span class="p">,</span> <span class="n">iscf</span><span class="p">,</span> <span class="n">neigwanted</span><span class="p">)</span>
        <span class="n">Ecorrec</span> <span class="o">=</span> <span class="mf">0.0_dp</span>
        <span class="n">PreviousCallDiagon</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
      <span class="n">elseif</span> <span class="p">(</span><span class="n">isolve</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SOLVE_ORDERN</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="nb">gamma</span><span class="p">)</span> <span class="k">call </span><span class="n">die</span><span class="p">(</span><span class="s2">&quot;Cannot do O(N) with k-points.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">spin</span><span class="p">%</span><span class="n">NCol</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">spin</span><span class="p">%</span><span class="n">SO</span> <span class="p">)</span>
     <span class="p">.</span>      <span class="k">call </span><span class="n">die</span><span class="p">(</span><span class="s2">&quot;Cannot do O(N) with non-coll spins or Spin-orbit&quot;</span><span class="p">)</span>
        <span class="k">call </span><span class="n">ordern</span><span class="p">(</span><span class="n">usesavelwf</span><span class="p">,</span> <span class="n">ioptlwf</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span>
     <span class="p">&amp;</span>               <span class="n">isa</span><span class="p">,</span> <span class="n">qa</span><span class="p">,</span> <span class="n">rcoor</span><span class="p">,</span> <span class="n">rmaxh</span><span class="p">,</span> <span class="n">ucell</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">iscf</span><span class="p">,</span>
     <span class="p">&amp;</span>               <span class="n">istp</span><span class="p">,</span> <span class="n">ncgmax</span><span class="p">,</span> <span class="n">etol</span><span class="p">,</span> <span class="n">eta</span><span class="p">,</span> <span class="n">qtot</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span>
     <span class="p">&amp;</span>               <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">chebef</span><span class="p">,</span> <span class="n">noeta</span><span class="p">,</span> <span class="n">rcoorcp</span><span class="p">,</span>
     <span class="p">&amp;</span>               <span class="n">beta</span><span class="p">,</span> <span class="n">pmax</span><span class="p">,</span> <span class="n">Dscf</span><span class="p">,</span> <span class="n">Escf</span><span class="p">,</span> <span class="n">Ecorrec</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span> <span class="n">qtots</span> <span class="p">)</span>
        <span class="n">Entropy</span> <span class="o">=</span> <span class="mf">0.0_dp</span>
      <span class="n">elseif</span> <span class="p">(</span><span class="n">isolve</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SOLVE_MINIM</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        if</span> <span class="p">(</span> <span class="n">spin</span><span class="p">%</span><span class="n">NCol</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">spin</span><span class="p">%</span><span class="n">SO</span> <span class="p">)</span> 
     <span class="p">&amp;</span>      <span class="k">call </span><span class="n">die</span><span class="p">(</span><span class="s1">&#39;ERROR: Non-collinear spin calculations</span>
<span class="s1">     &amp;                       not yet implemented with OMM!&#39;</span><span class="p">)</span>
        <span class="n">H_kin</span> <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">H_kin_1D</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">gamma</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          call </span><span class="n">dminim</span><span class="p">(.</span><span class="n">false</span><span class="p">.,</span> <span class="n">PreviousCallDiagon</span><span class="p">,</span> <span class="n">iscf</span><span class="p">,</span> <span class="n">istp</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span>
     <span class="p">&amp;</span>                 <span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">Dscf</span><span class="p">,</span>
     <span class="p">&amp;</span>                 <span class="n">eta</span><span class="p">,</span> <span class="n">qtots</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">H_kin</span><span class="p">)</span>
        <span class="k">else</span>
<span class="k">          call </span><span class="n">zminim</span><span class="p">(.</span><span class="n">false</span><span class="p">.,</span> <span class="n">PreviousCallDiagon</span><span class="p">,</span> <span class="n">iscf</span><span class="p">,</span> <span class="n">istp</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span>
     <span class="p">&amp;</span>                 <span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">Dscf</span><span class="p">,</span>
     <span class="p">&amp;</span>                 <span class="n">eta</span><span class="p">,</span> <span class="n">qtots</span><span class="p">,</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">xijo</span><span class="p">,</span> <span class="n">indxuo</span><span class="p">,</span> <span class="n">nkpnt</span><span class="p">,</span> <span class="n">kpoint</span><span class="p">,</span>
     <span class="p">&amp;</span>                 <span class="n">kweight</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">H_kin</span><span class="p">)</span>
        <span class="k">end if</span>
<span class="k">        </span><span class="n">Ecorrec</span> <span class="o">=</span> <span class="mf">0.0_dp</span>
        <span class="n">Entropy</span> <span class="o">=</span> <span class="mf">0.0_dp</span>
        <span class="n">PreviousCallDiagon</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<span class="cp">#ifdef SIESTA__CHESS</span>
      <span class="n">elseif</span> <span class="p">(</span><span class="n">isolve</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SOLVE_CHESS</span><span class="p">)</span> <span class="k">then</span>
        <span class="c">! FOE solver from the CheSS library</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">gamma</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          call </span><span class="n">CheSS_wrapper</span><span class="p">(.</span><span class="n">false</span><span class="p">.,</span> <span class="n">PreviousCallDiagon</span><span class="p">,</span> 
     <span class="p">&amp;</span>         <span class="n">iscf</span><span class="p">,</span> <span class="n">istp</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span>
     <span class="p">&amp;</span>         <span class="n">spin</span><span class="p">%</span><span class="n">spinor</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> 
     <span class="p">&amp;</span>         <span class="n">qs</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span>
     <span class="p">&amp;</span>         <span class="n">Dscf</span><span class="p">,</span> <span class="n">Escf</span><span class="p">,</span> <span class="n">Ef</span><span class="p">)</span>
        <span class="k">end if</span>
<span class="k">        </span><span class="n">Ecorrec</span> <span class="o">=</span> <span class="mf">0.0_dp</span>
        <span class="n">Entropy</span> <span class="o">=</span> <span class="mf">0.0_dp</span>
        <span class="n">PreviousCallDiagon</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<span class="cp">#endif</span>
      <span class="n">elseif</span> <span class="p">(</span><span class="n">TSmode</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">TSinit</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">diagon</span><span class="p">(</span><span class="n">no_s</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">spinor</span><span class="p">,</span> 
     <span class="p">&amp;</span>              <span class="n">no_l</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span>
     <span class="p">&amp;</span>              <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span>
     <span class="p">&amp;</span>              <span class="n">H</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">qtot</span><span class="p">,</span> <span class="n">fixspin</span><span class="p">,</span> <span class="n">qtots</span><span class="p">,</span> <span class="n">temp</span><span class="p">,</span> <span class="n">e1</span><span class="p">,</span> <span class="n">e2</span><span class="p">,</span>
     <span class="p">&amp;</span>              <span class="nb">gamma</span><span class="p">,</span> <span class="n">xijo</span><span class="p">,</span> <span class="n">indxuo</span><span class="p">,</span> <span class="n">nkpnt</span><span class="p">,</span> <span class="n">kpoint</span><span class="p">,</span> <span class="n">kweight</span><span class="p">,</span>
     <span class="p">&amp;</span>              <span class="n">eo</span><span class="p">,</span> <span class="n">qo</span><span class="p">,</span> <span class="n">Dscf</span><span class="p">,</span> <span class="n">Escf</span><span class="p">,</span> <span class="n">ef</span><span class="p">,</span> <span class="n">efs</span><span class="p">,</span> <span class="n">Entropy</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span>
     <span class="p">&amp;</span>              <span class="n">occtol</span><span class="p">,</span> <span class="n">iscf</span><span class="p">,</span> <span class="n">neigwanted</span><span class="p">)</span>

        <span class="n">Ecorrec</span> <span class="o">=</span> <span class="mf">0._dp</span>

      <span class="k">else if</span> <span class="p">(</span><span class="n">TSrun</span><span class="p">)</span> <span class="k">then</span>

<span class="k">         call </span><span class="n">transiesta</span><span class="p">(</span><span class="n">iscf</span><span class="p">,</span><span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span> <span class="n">block_dist</span><span class="p">,</span> <span class="n">sparse_pattern</span><span class="p">,</span>
     <span class="p">&amp;</span>        <span class="nb">Gamma</span><span class="p">,</span> <span class="n">ucell</span><span class="p">,</span> <span class="n">nsc</span><span class="p">,</span> <span class="n">isc_off</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span>
     <span class="p">&amp;</span>        <span class="n">H</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">Dscf</span><span class="p">,</span> <span class="n">Escf</span><span class="p">,</span> <span class="n">Ef</span><span class="p">,</span> <span class="n">Qtot</span><span class="p">,</span> <span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">DE_NEGF</span> <span class="p">)</span>

         <span class="n">Ecorrec</span> <span class="o">=</span> <span class="mf">0._dp</span>
         <span class="n">Entropy</span> <span class="o">=</span> <span class="mf">0.0_dp</span>
         
      <span class="k">else</span>
        <span class="c">!call die(&#39;siesta: ERROR: wrong solution method&#39;)</span>
      <span class="n">endif</span>

<span class="cp">#ifdef CDF</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">writedmhs_cdf_history</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">write_dmh_netcdf</span><span class="p">(</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span> <span class="n">Dold</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">Dscf</span> <span class="p">)</span>
      <span class="k">else if</span> <span class="p">(</span><span class="n">writedmhs_cdf</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">write_dmh_netcdf</span><span class="p">(</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span> <span class="n">Dold</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">Dscf</span><span class="p">,</span>
     <span class="p">&amp;</span>                         <span class="n">overwrite</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span> <span class="p">)</span>
      <span class="n">endif</span>
<span class="cp">#endif</span>

<span class="c">!     Print populations at each SCF step if requested before mixing ......</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">muldeb</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        if</span> <span class="p">(</span><span class="n">ionode</span><span class="p">)</span> <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s2">&quot;(/a)&quot;</span><span class="p">)</span>
     <span class="p">&amp;</span>    <span class="s1">&#39;siesta: Mulliken populations (DM_out)&#39;</span>
            <span class="k">if</span> <span class="p">(</span> <span class="n">spin</span><span class="p">%</span><span class="n">SO</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">              call </span><span class="n">moments</span><span class="p">(</span> <span class="n">mullipop</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span>
     <span class="p">.</span>                      <span class="n">listh</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">Dscf</span><span class="p">,</span> <span class="n">isa</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span> <span class="n">iaorb</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span>
     <span class="p">.</span>                      <span class="n">indxuo</span> <span class="p">)</span>
            <span class="k">else</span>
<span class="k">             call </span><span class="n">mulliken</span><span class="p">(</span> <span class="n">mullipop</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">DM</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span>
     <span class="p">&amp;</span>                 <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">Dscf</span><span class="p">,</span> <span class="n">isa</span><span class="p">,</span>
     <span class="p">&amp;</span>                 <span class="n">lasto</span><span class="p">,</span> <span class="n">iaorb</span><span class="p">,</span> <span class="n">iphorb</span> <span class="p">)</span>
            <span class="n">endif</span>
      <span class="n">endif</span>

<span class="c">! Write orbital indexes. JMS Dec.2009</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">IOnode</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">iscf</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">write_orb_indx</span><span class="p">(</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">na_s</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">isa</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span>
     <span class="p">.</span>        <span class="n">iaorb</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span> <span class="n">indxuo</span><span class="p">,</span> <span class="n">nsc</span><span class="p">,</span> <span class="n">ucell</span> <span class="p">)</span>
      <span class="n">endif</span>

<span class="c">!     Normalize density matrix to exact charge</span>
<span class="c">!     Placed here for now to avoid disturbing EHarris</span>
      <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">TSrun</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">normalize_dm</span><span class="p">(</span> <span class="n">first</span><span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="p">)</span>
      <span class="k">end if</span>

<span class="k">      call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;compute_dm&#39;</span><span class="p">,</span> <span class="mi">2</span> <span class="p">)</span>
<span class="cp">#ifdef SIESTA__PEXSI</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">ionode</span><span class="p">)</span> <span class="k">call </span><span class="n">memory_snapshot</span><span class="p">(</span><span class="s2">&quot;after compute_DM&quot;</span><span class="p">)</span>
<span class="cp">#endif</span>

<span class="c">!-----------------------------------------------------------------------END</span>
      <span class="k">END subroutine </span><span class="n">compute_dm</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2018 <a rel="license" href="http://www.gnu.org/licenses/old-licenses/fdl-1.2.en.html">GNU Free Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> SIESTA was developed by SIESTA Group</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>