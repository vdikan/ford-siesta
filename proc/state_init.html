<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="A first-principles materials simulation code using Density Functional Theory.">
    
    <meta name="author" content="SIESTA Group" >
    <link rel="icon" href="../favicon.png">

    <title>state_init &ndash; SIESTA</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">SIESTA <small>trunk-700--vdikan-edens-708-ford-681</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>Program Overview</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>state_init
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 6.1% of total for procedures.">385 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/state_init.F"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/state_init.f.html'>state_init.F</a></li>
    
     <li><a href='../module/m_state_init.html'>m_state_init</a></li>
    
  
     <li class="active">state_init</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/state_init.html#src">state_init</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine state_init(istep)
    
    
   
</h2>
    
  
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
      
      <li class="list-group-item">
  <ul class="list-inline">
    
    <li>kpoint_scf_m</li>
    
    <li>kpoint_t_m</li>
    
    <li>m_os</li>
    
    <li>m_new_dm</li>
    
    <li>m_proximity_check</li>
    
    <li>siesta_options</li>
    
    <li>units</li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>create_Sparsity_SC</li>
    
    <li>m_sparsity_handling</li>
    
    <li>m_sparsity_handling</li>
    
    <li>m_pivot_methods</li>
    
    <li>siesta_geom</li>
    
    <li>atomlist</li>
    
    <li>alloc</li>
    
    <li>m_hsparse</li>
    
    <li>m_overlap</li>
    
    <li>m_supercell</li>
    
    <li>siesta_cml</li>
    
    <li>siesta_cml</li>
    
    <li>siesta_cml</li>
    
    <li>siesta_cml</li>
    
    <li>zmatrix</li>
    
    <li>m_energies</li>
    
    <li>write_subs</li>
    
    <li>m_ioxv</li>
    
    <li>m_iotdxv</li>
    
    <li>m_steps</li>
    
    <li>parallel</li>
    
    <li>m_spin</li>
    
    <li>m_rmaxh</li>
    
    <li><a href='../module/m_mixing.html'>m_mixing</a></li>
    
    <li><a href='../module/m_mixing_scf.html'>m_mixing_scf</a></li>
    
    <li>m_normalize_dm</li>
    
    <li>m_eo</li>
    
    <li>m_gamma</li>
    
    <li>files</li>
    
    <li>m_mpi_utils</li>
    
    <li>m_mpi_utils</li>
    
    <li>domain_decom</li>
    
    <li>ldau_specs</li>
    
    <li>fdf</li>
    
    <li>sys</li>
    
    <li>m_sparse</li>
    
    <li>ts_kpoint_scf_m</li>
    
    <li>m_ts_charge</li>
    
    <li>m_ts_options</li>
    
    <li>m_ts_options</li>
    
    <li>m_ts_options</li>
    
    <li>m_ts_electype</li>
    
    <li>m_ts_global_vars</li>
    
    <li>sys</li>
    
    <li>m_ts_io</li>
    
    <li>m_ts_sparse</li>
    
    <li>m_ts_tri_init</li>
    
    <li>files</li>
    
    <li>m_chess</li>
    
    <li>iodm_netcdf</li>
    
    <li>iodmhs_netcdf</li>
    
    <li>class_Sparsity</li>
    
    <li>class_dSpData1D</li>
    
    <li>class_dSpData2D</li>
    
    <li>class_zSpData2D</li>
    
    <li>class_dData2D</li>
    
    <li>m_test_io</li>
    
    <li>siesta_dicts</li>
    
  </ul>
      </li>
      
      
      
      <li class="list-group-item">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~state_init~~UsesGraph Pages: 1 -->
<svg id="procstate_initUsesGraph" width="462pt" height="2380pt"
 viewBox="0.00 0.00 462.00 2380.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~state_init~~UsesGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 2376)">
<title>proc~~state_init~~UsesGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-2376 458,-2376 458,4 -4,4"/>
<!-- proc~state_init -->
<g id="proc~~state_init~~UsesGraph_node1" class="node"><title>proc~state_init</title>
<polygon fill="none" stroke="black" points="454,-1196 399,-1196 399,-1172 454,-1172 454,-1196"/>
<text text-anchor="middle" x="426.5" y="-1181.6" font-family="Helvetica,sans-Serif" font-size="10.50">state_init</text>
</g>
<!-- m_sparse -->
<g id="proc~~state_init~~UsesGraph_node2" class="node"><title>m_sparse</title>
<polygon fill="#337ab7" stroke="#337ab7" points="337.5,-2372 277.5,-2372 277.5,-2348 337.5,-2348 337.5,-2372"/>
<text text-anchor="middle" x="307.5" y="-2357.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_sparse</text>
</g>
<!-- proc~state_init&#45;&gt;m_sparse -->
<g id="proc~~state_init~~UsesGraph_edge1" class="edge"><title>proc~state_init&#45;&gt;m_sparse</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.632,-1196.19C426.802,-1313.62 433.769,-2241.64 363,-2339 358.954,-2344.57 353.224,-2348.66 346.986,-2351.66"/>
<polygon fill="#000000" stroke="#000000" points="345.652,-2348.43 337.622,-2355.34 348.209,-2354.94 345.652,-2348.43"/>
</g>
<!-- siesta_options -->
<g id="proc~~state_init~~UsesGraph_node3" class="node"><title>siesta_options</title>
<polygon fill="#337ab7" stroke="#337ab7" points="348,-2330 267,-2330 267,-2306 348,-2306 348,-2330"/>
<text text-anchor="middle" x="307.5" y="-2315.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_options</text>
</g>
<!-- proc~state_init&#45;&gt;siesta_options -->
<g id="proc~~state_init~~UsesGraph_edge33" class="edge"><title>proc~state_init&#45;&gt;siesta_options</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.605,-1196.11C426.498,-1310.78 431.227,-2203.34 363,-2297 361.209,-2299.46 359.089,-2301.63 356.742,-2303.55"/>
<polygon fill="#000000" stroke="#000000" points="354.563,-2300.79 348.037,-2309.13 358.343,-2306.68 354.563,-2300.79"/>
</g>
<!-- m_os -->
<g id="proc~~state_init~~UsesGraph_node4" class="node"><title>m_os</title>
<polygon fill="#337ab7" stroke="#337ab7" points="334.5,-2288 280.5,-2288 280.5,-2264 334.5,-2264 334.5,-2288"/>
<text text-anchor="middle" x="307.5" y="-2273.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_os</text>
</g>
<!-- proc~state_init&#45;&gt;m_os -->
<g id="proc~~state_init~~UsesGraph_edge3" class="edge"><title>proc~state_init&#45;&gt;m_os</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.578,-1196.35C426.19,-1309.58 428.622,-2165.12 363,-2255 358.437,-2261.25 351.752,-2265.64 344.615,-2268.72"/>
<polygon fill="#000000" stroke="#000000" points="343.043,-2265.56 334.759,-2272.17 345.354,-2272.17 343.043,-2265.56"/>
</g>
<!-- m_test_io -->
<g id="proc~~state_init~~UsesGraph_node5" class="node"><title>m_test_io</title>
<polygon fill="#337ab7" stroke="#337ab7" points="337,-2246 278,-2246 278,-2222 337,-2222 337,-2246"/>
<text text-anchor="middle" x="307.5" y="-2231.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_test_io</text>
</g>
<!-- proc~state_init&#45;&gt;m_test_io -->
<g id="proc~~state_init~~UsesGraph_edge5" class="edge"><title>proc~state_init&#45;&gt;m_test_io</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.546,-1196.21C425.864,-1306.38 426.094,-2126.8 363,-2213 358.855,-2218.66 352.969,-2222.8 346.585,-2225.82"/>
<polygon fill="#000000" stroke="#000000" points="345.101,-2222.64 337.022,-2229.49 347.612,-2229.17 345.101,-2222.64"/>
</g>
<!-- ts_kpoint_scf_m -->
<g id="proc~~state_init~~UsesGraph_node6" class="node"><title>ts_kpoint_scf_m</title>
<polygon fill="#337ab7" stroke="#337ab7" points="352.5,-2204 262.5,-2204 262.5,-2180 352.5,-2180 352.5,-2204"/>
<text text-anchor="middle" x="307.5" y="-2189.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ts_kpoint_scf_m</text>
</g>
<!-- proc~state_init&#45;&gt;ts_kpoint_scf_m -->
<g id="proc~~state_init~~UsesGraph_edge6" class="edge"><title>proc~state_init&#45;&gt;ts_kpoint_scf_m</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.513,-1196.05C425.528,-1303.05 423.572,-2088.47 363,-2171 362.207,-2172.08 361.35,-2173.11 360.439,-2174.08"/>
<polygon fill="#000000" stroke="#000000" points="358.053,-2171.51 352.525,-2180.55 362.483,-2176.93 358.053,-2171.51"/>
</g>
<!-- ldau_specs -->
<g id="proc~~state_init~~UsesGraph_node7" class="node"><title>ldau_specs</title>
<polygon fill="#337ab7" stroke="#337ab7" points="341,-2162 274,-2162 274,-2138 341,-2138 341,-2162"/>
<text text-anchor="middle" x="307.5" y="-2147.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ldau_specs</text>
</g>
<!-- proc~state_init&#45;&gt;ldau_specs -->
<g id="proc~~state_init~~UsesGraph_edge27" class="edge"><title>proc~state_init&#45;&gt;ldau_specs</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.477,-1196.19C425.175,-1301.14 420.993,-2050.21 363,-2129 359.694,-2133.49 355.293,-2137.02 350.42,-2139.8"/>
<polygon fill="#000000" stroke="#000000" points="348.884,-2136.65 341.274,-2144.02 351.82,-2143.01 348.884,-2136.65"/>
</g>
<!-- write_subs -->
<g id="proc~~state_init~~UsesGraph_node8" class="node"><title>write_subs</title>
<polygon fill="#337ab7" stroke="#337ab7" points="339.5,-2120 275.5,-2120 275.5,-2096 339.5,-2096 339.5,-2120"/>
<text text-anchor="middle" x="307.5" y="-2105.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_subs</text>
</g>
<!-- proc~state_init&#45;&gt;write_subs -->
<g id="proc~~state_init~~UsesGraph_edge8" class="edge"><title>proc~state_init&#45;&gt;write_subs</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.436,-1196.29C424.804,-1298.95 418.426,-2011.94 363,-2087 359.373,-2091.91 354.436,-2095.68 349.007,-2098.56"/>
<polygon fill="#000000" stroke="#000000" points="347.353,-2095.46 339.55,-2102.63 350.119,-2101.89 347.353,-2095.46"/>
</g>
<!-- m_ts_options -->
<g id="proc~~state_init~~UsesGraph_node9" class="node"><title>m_ts_options</title>
<polygon fill="#337ab7" stroke="#337ab7" points="345.5,-2078 269.5,-2078 269.5,-2054 345.5,-2054 345.5,-2078"/>
<text text-anchor="middle" x="307.5" y="-2063.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_options</text>
</g>
<!-- proc~state_init&#45;&gt;m_ts_options -->
<g id="proc~~state_init~~UsesGraph_edge9" class="edge"><title>proc~state_init&#45;&gt;m_ts_options</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.395,-1196.03C424.433,-1295.04 415.925,-1973.58 363,-2045 360.691,-2048.12 357.855,-2050.77 354.701,-2053.03"/>
<polygon fill="#000000" stroke="#000000" points="352.703,-2050.14 345.755,-2058.14 356.175,-2056.22 352.703,-2050.14"/>
</g>
<!-- class_dData2D -->
<g id="proc~~state_init~~UsesGraph_node10" class="node"><title>class_dData2D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="350,-2036 265,-2036 265,-2012 350,-2012 350,-2036"/>
<text text-anchor="middle" x="307.5" y="-2021.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_dData2D</text>
</g>
<!-- proc~state_init&#45;&gt;class_dData2D -->
<g id="proc~~state_init~~UsesGraph_edge10" class="edge"><title>proc~state_init&#45;&gt;class_dData2D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.347,-1196.05C424.03,-1292.35 413.376,-1935.28 363,-2003 361.623,-2004.85 360.061,-2006.54 358.356,-2008.08"/>
<polygon fill="#000000" stroke="#000000" points="356.249,-2005.28 350.111,-2013.92 360.295,-2010.99 356.249,-2005.28"/>
</g>
<!-- m_supercell -->
<g id="proc~~state_init~~UsesGraph_node11" class="node"><title>m_supercell</title>
<polygon fill="#337ab7" stroke="#337ab7" points="342.5,-1994 272.5,-1994 272.5,-1970 342.5,-1970 342.5,-1994"/>
<text text-anchor="middle" x="307.5" y="-1979.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_supercell</text>
</g>
<!-- proc~state_init&#45;&gt;m_supercell -->
<g id="proc~~state_init~~UsesGraph_edge11" class="edge"><title>proc~state_init&#45;&gt;m_supercell</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.296,-1196.02C423.61,-1289.38 410.839,-1896.97 363,-1961 360.009,-1965 356.15,-1968.24 351.868,-1970.87"/>
<polygon fill="#000000" stroke="#000000" points="350.044,-1967.86 342.627,-1975.43 353.143,-1974.14 350.044,-1967.86"/>
</g>
<!-- m_proximity_check -->
<g id="proc~~state_init~~UsesGraph_node12" class="node"><title>m_proximity_check</title>
<polygon fill="#337ab7" stroke="#337ab7" points="359.5,-1952 255.5,-1952 255.5,-1928 359.5,-1928 359.5,-1952"/>
<text text-anchor="middle" x="307.5" y="-1937.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_proximity_check</text>
</g>
<!-- proc~state_init&#45;&gt;m_proximity_check -->
<g id="proc~~state_init~~UsesGraph_edge12" class="edge"><title>proc~state_init&#45;&gt;m_proximity_check</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.233,-1196.22C423.14,-1287.34 408.264,-1858.7 363,-1919 362.414,-1919.78 361.795,-1920.53 361.147,-1921.26"/>
<polygon fill="#000000" stroke="#000000" points="358.573,-1918.85 353.213,-1927.99 363.102,-1924.19 358.573,-1918.85"/>
</g>
<!-- m_overlap -->
<g id="proc~~state_init~~UsesGraph_node13" class="node"><title>m_overlap</title>
<polygon fill="#337ab7" stroke="#337ab7" points="339,-1910 276,-1910 276,-1886 339,-1886 339,-1910"/>
<text text-anchor="middle" x="307.5" y="-1895.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_overlap</text>
</g>
<!-- proc~state_init&#45;&gt;m_overlap -->
<g id="proc~~state_init~~UsesGraph_edge44" class="edge"><title>proc~state_init&#45;&gt;m_overlap</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.17,-1196.08C422.681,-1283.74 405.751,-1820.35 363,-1877 359.283,-1881.93 354.253,-1885.7 348.744,-1888.58"/>
<polygon fill="#000000" stroke="#000000" points="347.003,-1885.52 339.169,-1892.65 349.742,-1891.96 347.003,-1885.52"/>
</g>
<!-- m_energies -->
<g id="proc~~state_init~~UsesGraph_node14" class="node"><title>m_energies</title>
<polygon fill="#337ab7" stroke="#337ab7" points="342,-1868 273,-1868 273,-1844 342,-1844 342,-1868"/>
<text text-anchor="middle" x="307.5" y="-1853.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_energies</text>
</g>
<!-- proc~state_init&#45;&gt;m_energies -->
<g id="proc~~state_init~~UsesGraph_edge14" class="edge"><title>proc~state_init&#45;&gt;m_energies</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.094,-1196.15C422.163,-1280.92 403.206,-1782.04 363,-1835 359.862,-1839.13 355.799,-1842.45 351.308,-1845.12"/>
<polygon fill="#000000" stroke="#000000" points="349.754,-1841.98 342.272,-1849.49 352.799,-1848.29 349.754,-1841.98"/>
</g>
<!-- domain_decom -->
<g id="proc~~state_init~~UsesGraph_node15" class="node"><title>domain_decom</title>
<polygon fill="#337ab7" stroke="#337ab7" points="350.5,-1826 264.5,-1826 264.5,-1802 350.5,-1802 350.5,-1826"/>
<text text-anchor="middle" x="307.5" y="-1811.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">domain_decom</text>
</g>
<!-- proc~state_init&#45;&gt;domain_decom -->
<g id="proc~~state_init~~UsesGraph_edge23" class="edge"><title>proc~state_init&#45;&gt;domain_decom</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.01,-1196.14C421.62,-1277.68 400.678,-1743.71 363,-1793 361.753,-1794.63 360.362,-1796.14 358.858,-1797.52"/>
<polygon fill="#000000" stroke="#000000" points="356.594,-1794.84 350.537,-1803.53 360.693,-1800.52 356.594,-1794.84"/>
</g>
<!-- kpoint_scf_m -->
<g id="proc~~state_init~~UsesGraph_node16" class="node"><title>kpoint_scf_m</title>
<polygon fill="#337ab7" stroke="#337ab7" points="345.5,-1784 269.5,-1784 269.5,-1760 345.5,-1760 345.5,-1784"/>
<text text-anchor="middle" x="307.5" y="-1769.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">kpoint_scf_m</text>
</g>
<!-- proc~state_init&#45;&gt;kpoint_scf_m -->
<g id="proc~~state_init~~UsesGraph_edge15" class="edge"><title>proc~state_init&#45;&gt;kpoint_scf_m</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M424.917,-1196.05C421.051,-1274.02 398.167,-1705.35 363,-1751 360.633,-1754.07 357.757,-1756.7 354.576,-1758.94"/>
<polygon fill="#000000" stroke="#000000" points="352.573,-1756.05 345.587,-1764.01 356.015,-1762.14 352.573,-1756.05"/>
</g>
<!-- atomlist -->
<g id="proc~~state_init~~UsesGraph_node17" class="node"><title>atomlist</title>
<polygon fill="#337ab7" stroke="#337ab7" points="334.5,-1742 280.5,-1742 280.5,-1718 334.5,-1718 334.5,-1742"/>
<text text-anchor="middle" x="307.5" y="-1727.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">atomlist</text>
</g>
<!-- proc~state_init&#45;&gt;atomlist -->
<g id="proc~~state_init~~UsesGraph_edge53" class="edge"><title>proc~state_init&#45;&gt;atomlist</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.696,-1196.1C426.603,-1266.74 427.923,-1625.48 363,-1709 358.294,-1715.05 351.612,-1719.36 344.533,-1722.43"/>
<polygon fill="#000000" stroke="#000000" points="343.034,-1719.25 334.781,-1725.89 345.376,-1725.85 343.034,-1719.25"/>
</g>
<!-- m_steps -->
<g id="proc~~state_init~~UsesGraph_node18" class="node"><title>m_steps</title>
<polygon fill="#337ab7" stroke="#337ab7" points="334.5,-1700 280.5,-1700 280.5,-1676 334.5,-1676 334.5,-1700"/>
<text text-anchor="middle" x="307.5" y="-1685.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_steps</text>
</g>
<!-- proc~state_init&#45;&gt;m_steps -->
<g id="proc~~state_init~~UsesGraph_edge17" class="edge"><title>proc~state_init&#45;&gt;m_steps</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.556,-1196C425.639,-1263.02 422.935,-1590.7 363,-1667 358.263,-1673.03 351.569,-1677.33 344.487,-1680.4"/>
<polygon fill="#000000" stroke="#000000" points="342.989,-1677.21 334.737,-1683.86 345.332,-1683.81 342.989,-1677.21"/>
</g>
<!-- m_ts_electype -->
<g id="proc~~state_init~~UsesGraph_node19" class="node"><title>m_ts_electype</title>
<polygon fill="#337ab7" stroke="#337ab7" points="348.5,-1658 266.5,-1658 266.5,-1634 348.5,-1634 348.5,-1658"/>
<text text-anchor="middle" x="307.5" y="-1643.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_electype</text>
</g>
<!-- proc~state_init&#45;&gt;m_ts_electype -->
<g id="proc~~state_init~~UsesGraph_edge18" class="edge"><title>proc~state_init&#45;&gt;m_ts_electype</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.39,-1196.2C424.579,-1260.1 417.873,-1556.01 363,-1625 361.343,-1627.08 359.453,-1628.96 357.395,-1630.65"/>
<polygon fill="#000000" stroke="#000000" points="355.218,-1627.89 348.762,-1636.29 359.048,-1633.75 355.218,-1627.89"/>
</g>
<!-- m_normalize_dm -->
<g id="proc~~state_init~~UsesGraph_node20" class="node"><title>m_normalize_dm</title>
<polygon fill="#337ab7" stroke="#337ab7" points="355,-1616 260,-1616 260,-1592 355,-1592 355,-1616"/>
<text text-anchor="middle" x="307.5" y="-1601.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_normalize_dm</text>
</g>
<!-- proc~state_init&#45;&gt;m_normalize_dm -->
<g id="proc~~state_init~~UsesGraph_edge19" class="edge"><title>proc~state_init&#45;&gt;m_normalize_dm</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.189,-1196.21C423.421,-1256.42 412.88,-1521.22 363,-1583 362.283,-1583.89 361.525,-1584.74 360.729,-1585.55"/>
<polygon fill="#000000" stroke="#000000" points="358.336,-1582.98 352.698,-1591.95 362.699,-1588.46 358.336,-1582.98"/>
</g>
<!-- class_dSpData2D -->
<g id="proc~~state_init~~UsesGraph_node21" class="node"><title>class_dSpData2D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="356,-1574 259,-1574 259,-1550 356,-1550 356,-1574"/>
<text text-anchor="middle" x="307.5" y="-1559.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_dSpData2D</text>
</g>
<!-- proc~state_init&#45;&gt;class_dSpData2D -->
<g id="proc~~state_init~~UsesGraph_edge20" class="edge"><title>proc~state_init&#45;&gt;class_dSpData2D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M424.95,-1196.03C422.168,-1251.98 407.958,-1486.32 363,-1541 362.275,-1541.88 361.509,-1542.73 360.707,-1543.53"/>
<polygon fill="#000000" stroke="#000000" points="358.318,-1540.96 352.634,-1549.9 362.653,-1546.46 358.318,-1540.96"/>
</g>
<!-- siesta_geom -->
<g id="proc~~state_init~~UsesGraph_node22" class="node"><title>siesta_geom</title>
<polygon fill="#337ab7" stroke="#337ab7" points="344,-1532 271,-1532 271,-1508 344,-1508 344,-1532"/>
<text text-anchor="middle" x="307.5" y="-1517.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_geom</text>
</g>
<!-- proc~state_init&#45;&gt;siesta_geom -->
<g id="proc~~state_init~~UsesGraph_edge21" class="edge"><title>proc~state_init&#45;&gt;siesta_geom</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M424.621,-1196.33C420.664,-1248.63 402.931,-1451.54 363,-1499 360.209,-1502.32 356.831,-1505.11 353.139,-1507.47"/>
<polygon fill="#000000" stroke="#000000" points="351.325,-1504.47 344.084,-1512.2 354.567,-1510.67 351.325,-1504.47"/>
</g>
<!-- m_sparsity_handling -->
<g id="proc~~state_init~~UsesGraph_node23" class="node"><title>m_sparsity_handling</title>
<polygon fill="#337ab7" stroke="#337ab7" points="363,-1490 252,-1490 252,-1466 363,-1466 363,-1490"/>
<text text-anchor="middle" x="307.5" y="-1475.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_sparsity_handling</text>
</g>
<!-- proc~state_init&#45;&gt;m_sparsity_handling -->
<g id="proc~~state_init~~UsesGraph_edge22" class="edge"><title>proc~state_init&#45;&gt;m_sparsity_handling</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M424.218,-1196.28C419.009,-1244.01 398.026,-1416.58 363,-1457 362.141,-1457.99 361.229,-1458.94 360.273,-1459.84"/>
<polygon fill="#000000" stroke="#000000" points="358.083,-1457.1 352.187,-1465.91 362.286,-1462.7 358.083,-1457.1"/>
</g>
<!-- m_ts_charge -->
<g id="proc~~state_init~~UsesGraph_node24" class="node"><title>m_ts_charge</title>
<polygon fill="#337ab7" stroke="#337ab7" points="345,-1448 270,-1448 270,-1424 345,-1424 345,-1448"/>
<text text-anchor="middle" x="307.5" y="-1433.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_charge</text>
</g>
<!-- proc~state_init&#45;&gt;m_ts_charge -->
<g id="proc~~state_init~~UsesGraph_edge4" class="edge"><title>proc~state_init&#45;&gt;m_ts_charge</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.82,-1196.06C426.153,-1233.55 422.113,-1349.43 363,-1415 360.439,-1417.84 357.45,-1420.3 354.214,-1422.43"/>
<polygon fill="#000000" stroke="#000000" points="352.313,-1419.48 345.197,-1427.33 355.655,-1425.63 352.313,-1419.48"/>
</g>
<!-- m_iotdxv -->
<g id="proc~~state_init~~UsesGraph_node25" class="node"><title>m_iotdxv</title>
<polygon fill="#337ab7" stroke="#337ab7" points="335,-1406 280,-1406 280,-1382 335,-1382 335,-1406"/>
<text text-anchor="middle" x="307.5" y="-1391.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_iotdxv</text>
</g>
<!-- proc~state_init&#45;&gt;m_iotdxv -->
<g id="proc~~state_init~~UsesGraph_edge24" class="edge"><title>proc~state_init&#45;&gt;m_iotdxv</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M424.931,-1196.43C422.754,-1229.6 412.347,-1321.2 363,-1373 358.019,-1378.23 351.591,-1382.17 344.907,-1385.14"/>
<polygon fill="#000000" stroke="#000000" points="343.203,-1382.04 335.07,-1388.83 345.662,-1388.6 343.203,-1382.04"/>
</g>
<!-- m_ts_tri_init -->
<g id="proc~~state_init~~UsesGraph_node26" class="node"><title>m_ts_tri_init</title>
<polygon fill="#337ab7" stroke="#337ab7" points="342.5,-1364 272.5,-1364 272.5,-1340 342.5,-1340 342.5,-1364"/>
<text text-anchor="middle" x="307.5" y="-1349.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_tri_init</text>
</g>
<!-- proc~state_init&#45;&gt;m_ts_tri_init -->
<g id="proc~~state_init~~UsesGraph_edge25" class="edge"><title>proc~state_init&#45;&gt;m_ts_tri_init</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M423.635,-1196.08C418.753,-1223.74 403.083,-1292.27 363,-1331 359.712,-1334.18 355.891,-1336.89 351.827,-1339.2"/>
<polygon fill="#000000" stroke="#000000" points="350.134,-1336.13 342.656,-1343.63 353.182,-1342.43 350.134,-1336.13"/>
</g>
<!-- iodmhs_netcdf -->
<g id="proc~~state_init~~UsesGraph_node27" class="node"><title>iodmhs_netcdf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="348.5,-1322 266.5,-1322 266.5,-1298 348.5,-1298 348.5,-1322"/>
<text text-anchor="middle" x="307.5" y="-1307.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iodmhs_netcdf</text>
</g>
<!-- proc~state_init&#45;&gt;iodmhs_netcdf -->
<g id="proc~~state_init~~UsesGraph_edge26" class="edge"><title>proc~state_init&#45;&gt;iodmhs_netcdf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M421.322,-1196.16C413.312,-1217.76 393.807,-1263.01 363,-1289 361.268,-1290.46 359.424,-1291.83 357.499,-1293.1"/>
<polygon fill="#000000" stroke="#000000" points="355.609,-1290.15 348.651,-1298.14 359.073,-1296.24 355.609,-1290.15"/>
</g>
<!-- units -->
<g id="proc~~state_init~~UsesGraph_node28" class="node"><title>units</title>
<polygon fill="#337ab7" stroke="#337ab7" points="334.5,-1280 280.5,-1280 280.5,-1256 334.5,-1256 334.5,-1280"/>
<text text-anchor="middle" x="307.5" y="-1265.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">units</text>
</g>
<!-- proc~state_init&#45;&gt;units -->
<g id="proc~~state_init~~UsesGraph_edge28" class="edge"><title>proc~state_init&#45;&gt;units</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M416.104,-1196.2C404.815,-1210.14 384.67,-1232.85 363,-1247 357.182,-1250.8 350.573,-1254.07 344.014,-1256.82"/>
<polygon fill="#000000" stroke="#000000" points="342.604,-1253.62 334.538,-1260.48 345.127,-1260.14 342.604,-1253.62"/>
</g>
<!-- kpoint_t_m -->
<g id="proc~~state_init~~UsesGraph_node29" class="node"><title>kpoint_t_m</title>
<polygon fill="#337ab7" stroke="#337ab7" points="340,-1238 275,-1238 275,-1214 340,-1214 340,-1238"/>
<text text-anchor="middle" x="307.5" y="-1223.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">kpoint_t_m</text>
</g>
<!-- proc~state_init&#45;&gt;kpoint_t_m -->
<g id="proc~~state_init~~UsesGraph_edge30" class="edge"><title>proc~state_init&#45;&gt;kpoint_t_m</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M398.951,-1193.53C384.546,-1198.7 366.412,-1205.21 350.171,-1211.04"/>
<polygon fill="#000000" stroke="#000000" points="348.582,-1207.89 340.352,-1214.57 350.947,-1214.48 348.582,-1207.89"/>
</g>
<!-- m_mpi_utils -->
<g id="proc~~state_init~~UsesGraph_node30" class="node"><title>m_mpi_utils</title>
<polygon fill="#337ab7" stroke="#337ab7" points="342.5,-1196 272.5,-1196 272.5,-1172 342.5,-1172 342.5,-1196"/>
<text text-anchor="middle" x="307.5" y="-1181.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_mpi_utils</text>
</g>
<!-- proc~state_init&#45;&gt;m_mpi_utils -->
<g id="proc~~state_init~~UsesGraph_edge31" class="edge"><title>proc~state_init&#45;&gt;m_mpi_utils</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M398.951,-1184C385.235,-1184 368.138,-1184 352.513,-1184"/>
<polygon fill="#000000" stroke="#000000" points="352.508,-1180.5 342.508,-1184 352.508,-1187.5 352.508,-1180.5"/>
</g>
<!-- class_zSpData2D -->
<g id="proc~~state_init~~UsesGraph_node31" class="node"><title>class_zSpData2D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="356,-1154 259,-1154 259,-1130 356,-1130 356,-1154"/>
<text text-anchor="middle" x="307.5" y="-1139.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_zSpData2D</text>
</g>
<!-- proc~state_init&#45;&gt;class_zSpData2D -->
<g id="proc~~state_init~~UsesGraph_edge32" class="edge"><title>proc~state_init&#45;&gt;class_zSpData2D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M398.951,-1174.47C384.992,-1169.46 367.533,-1163.19 351.687,-1157.5"/>
<polygon fill="#000000" stroke="#000000" points="352.669,-1154.14 342.074,-1154.05 350.303,-1160.73 352.669,-1154.14"/>
</g>
<!-- files -->
<g id="proc~~state_init~~UsesGraph_node32" class="node"><title>files</title>
<polygon fill="#337ab7" stroke="#337ab7" points="334.5,-1112 280.5,-1112 280.5,-1088 334.5,-1088 334.5,-1112"/>
<text text-anchor="middle" x="307.5" y="-1097.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">files</text>
</g>
<!-- proc~state_init&#45;&gt;files -->
<g id="proc~~state_init~~UsesGraph_edge2" class="edge"><title>proc~state_init&#45;&gt;files</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M416.104,-1171.8C404.815,-1157.86 384.67,-1135.15 363,-1121 357.182,-1117.2 350.573,-1113.93 344.014,-1111.18"/>
<polygon fill="#000000" stroke="#000000" points="345.127,-1107.86 334.538,-1107.52 342.604,-1114.38 345.127,-1107.86"/>
</g>
<!-- m_pivot_methods -->
<g id="proc~~state_init~~UsesGraph_node33" class="node"><title>m_pivot_methods</title>
<polygon fill="#337ab7" stroke="#337ab7" points="356,-1070 259,-1070 259,-1046 356,-1046 356,-1070"/>
<text text-anchor="middle" x="307.5" y="-1055.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_pivot_methods</text>
</g>
<!-- proc~state_init&#45;&gt;m_pivot_methods -->
<g id="proc~~state_init~~UsesGraph_edge47" class="edge"><title>proc~state_init&#45;&gt;m_pivot_methods</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M421.322,-1171.84C413.312,-1150.24 393.807,-1104.99 363,-1079 361.46,-1077.7 359.83,-1076.48 358.134,-1075.32"/>
<polygon fill="#000000" stroke="#000000" points="359.615,-1072.14 349.211,-1070.13 356.097,-1078.19 359.615,-1072.14"/>
</g>
<!-- siesta_dicts -->
<g id="proc~~state_init~~UsesGraph_node34" class="node"><title>siesta_dicts</title>
<polygon fill="#337ab7" stroke="#337ab7" points="341.5,-1028 273.5,-1028 273.5,-1004 341.5,-1004 341.5,-1028"/>
<text text-anchor="middle" x="307.5" y="-1013.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_dicts</text>
</g>
<!-- proc~state_init&#45;&gt;siesta_dicts -->
<g id="proc~~state_init~~UsesGraph_edge35" class="edge"><title>proc~state_init&#45;&gt;siesta_dicts</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M423.635,-1171.92C418.753,-1144.26 403.083,-1075.73 363,-1037 359.45,-1033.57 355.279,-1030.68 350.851,-1028.26"/>
<polygon fill="#000000" stroke="#000000" points="352.063,-1024.96 341.52,-1023.91 349.104,-1031.31 352.063,-1024.96"/>
</g>
<!-- class_Sparsity -->
<g id="proc~~state_init~~UsesGraph_node35" class="node"><title>class_Sparsity</title>
<polygon fill="#337ab7" stroke="#337ab7" points="348,-986 267,-986 267,-962 348,-962 348,-986"/>
<text text-anchor="middle" x="307.5" y="-971.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_Sparsity</text>
</g>
<!-- proc~state_init&#45;&gt;class_Sparsity -->
<g id="proc~~state_init~~UsesGraph_edge36" class="edge"><title>proc~state_init&#45;&gt;class_Sparsity</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M424.931,-1171.57C422.754,-1138.4 412.347,-1046.8 363,-995 361.164,-993.073 359.131,-991.32 356.962,-989.726"/>
<polygon fill="#000000" stroke="#000000" points="358.411,-986.512 348.042,-984.334 354.789,-992.503 358.411,-986.512"/>
</g>
<!-- m_ts_global_vars -->
<g id="proc~~state_init~~UsesGraph_node36" class="node"><title>m_ts_global_vars</title>
<polygon fill="#337ab7" stroke="#337ab7" points="356,-944 259,-944 259,-920 356,-920 356,-944"/>
<text text-anchor="middle" x="307.5" y="-929.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_global_vars</text>
</g>
<!-- proc~state_init&#45;&gt;m_ts_global_vars -->
<g id="proc~~state_init~~UsesGraph_edge37" class="edge"><title>proc~state_init&#45;&gt;m_ts_global_vars</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.82,-1171.94C426.153,-1134.45 422.113,-1018.57 363,-953 362.103,-952.004 361.152,-951.056 360.158,-950.152"/>
<polygon fill="#000000" stroke="#000000" points="361.928,-947.112 351.783,-944.058 357.81,-952.772 361.928,-947.112"/>
</g>
<!-- m_ts_io -->
<g id="proc~~state_init~~UsesGraph_node37" class="node"><title>m_ts_io</title>
<polygon fill="#337ab7" stroke="#337ab7" points="334.5,-902 280.5,-902 280.5,-878 334.5,-878 334.5,-902"/>
<text text-anchor="middle" x="307.5" y="-887.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_io</text>
</g>
<!-- proc~state_init&#45;&gt;m_ts_io -->
<g id="proc~~state_init~~UsesGraph_edge38" class="edge"><title>proc~state_init&#45;&gt;m_ts_io</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M424.218,-1171.72C419.009,-1123.99 398.026,-951.419 363,-911 358.024,-905.258 351.291,-901.078 344.256,-898.037"/>
<polygon fill="#000000" stroke="#000000" points="345.207,-894.66 334.613,-894.558 342.832,-901.244 345.207,-894.66"/>
</g>
<!-- m_chess -->
<g id="proc~~state_init~~UsesGraph_node38" class="node"><title>m_chess</title>
<polygon fill="#337ab7" stroke="#337ab7" points="335,-860 280,-860 280,-836 335,-836 335,-860"/>
<text text-anchor="middle" x="307.5" y="-845.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_chess</text>
</g>
<!-- proc~state_init&#45;&gt;m_chess -->
<g id="proc~~state_init~~UsesGraph_edge39" class="edge"><title>proc~state_init&#45;&gt;m_chess</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M424.621,-1171.67C420.664,-1119.37 402.931,-916.462 363,-869 358.153,-863.239 351.533,-859.053 344.576,-856.013"/>
<polygon fill="#000000" stroke="#000000" points="345.61,-852.665 335.016,-852.539 343.218,-859.244 345.61,-852.665"/>
</g>
<!-- sys -->
<g id="proc~~state_init~~UsesGraph_node39" class="node"><title>sys</title>
<polygon fill="#337ab7" stroke="#337ab7" points="334.5,-818 280.5,-818 280.5,-794 334.5,-794 334.5,-818"/>
<text text-anchor="middle" x="307.5" y="-803.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sys</text>
</g>
<!-- proc~state_init&#45;&gt;sys -->
<g id="proc~~state_init~~UsesGraph_edge40" class="edge"><title>proc~state_init&#45;&gt;sys</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M424.95,-1171.97C422.168,-1116.02 407.958,-881.677 363,-827 358.13,-821.077 351.381,-816.821 344.288,-813.763"/>
<polygon fill="#000000" stroke="#000000" points="345.142,-810.352 334.548,-810.294 342.793,-816.946 345.142,-810.352"/>
</g>
<!-- m_ioxv -->
<g id="proc~~state_init~~UsesGraph_node40" class="node"><title>m_ioxv</title>
<polygon fill="#337ab7" stroke="#337ab7" points="334.5,-776 280.5,-776 280.5,-752 334.5,-752 334.5,-776"/>
<text text-anchor="middle" x="307.5" y="-761.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ioxv</text>
</g>
<!-- proc~state_init&#45;&gt;m_ioxv -->
<g id="proc~~state_init~~UsesGraph_edge49" class="edge"><title>proc~state_init&#45;&gt;m_ioxv</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.189,-1171.79C423.421,-1111.58 412.88,-846.784 363,-785 358.183,-779.033 351.456,-774.759 344.368,-771.699"/>
<polygon fill="#000000" stroke="#000000" points="345.218,-768.286 334.623,-768.232 342.872,-774.881 345.218,-768.286"/>
</g>
<!-- siesta_cml -->
<g id="proc~~state_init~~UsesGraph_node41" class="node"><title>siesta_cml</title>
<polygon fill="#337ab7" stroke="#337ab7" points="339,-734 276,-734 276,-710 339,-710 339,-734"/>
<text text-anchor="middle" x="307.5" y="-719.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_cml</text>
</g>
<!-- proc~state_init&#45;&gt;siesta_cml -->
<g id="proc~~state_init~~UsesGraph_edge41" class="edge"><title>proc~state_init&#45;&gt;siesta_cml</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.39,-1171.8C424.579,-1107.9 417.873,-811.993 363,-743 359.199,-738.221 354.171,-734.528 348.703,-731.676"/>
<polygon fill="#000000" stroke="#000000" points="349.795,-728.336 339.224,-727.623 347.043,-734.773 349.795,-728.336"/>
</g>
<!-- m_spin -->
<g id="proc~~state_init~~UsesGraph_node42" class="node"><title>m_spin</title>
<polygon fill="#337ab7" stroke="#337ab7" points="334.5,-692 280.5,-692 280.5,-668 334.5,-668 334.5,-692"/>
<text text-anchor="middle" x="307.5" y="-677.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_spin</text>
</g>
<!-- proc~state_init&#45;&gt;m_spin -->
<g id="proc~~state_init~~UsesGraph_edge42" class="edge"><title>proc~state_init&#45;&gt;m_spin</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.556,-1172C425.639,-1104.98 422.935,-777.3 363,-701 358.263,-694.97 351.569,-690.67 344.487,-687.604"/>
<polygon fill="#000000" stroke="#000000" points="345.332,-684.19 334.737,-684.141 342.989,-690.786 345.332,-684.19"/>
</g>
<!-- module~m_mixing -->
<g id="proc~~state_init~~UsesGraph_node43" class="node"><title>module~m_mixing</title>
<g id="a_proc~~state_init~~UsesGraph_node43"><a xlink:href=".././module/m_mixing.html" xlink:title="m_mixing">
<polygon fill="#337ab7" stroke="#337ab7" points="216,-150 158,-150 158,-126 216,-126 216,-150"/>
<text text-anchor="middle" x="187" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_mixing</text>
</a>
</g>
</g>
<!-- proc~state_init&#45;&gt;module~m_mixing -->
<g id="proc~~state_init~~UsesGraph_edge43" class="edge"><title>proc~state_init&#45;&gt;module~m_mixing</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.742,-1171.86C426.916,-1101.01 429.496,-741.276 363,-659 330.223,-618.445 285.045,-661.337 252,-621 193.132,-549.141 188.167,-245.05 187.944,-160.115"/>
<polygon fill="#000000" stroke="#000000" points="191.444,-160.039 187.938,-150.042 184.444,-160.044 191.444,-160.039"/>
</g>
<!-- m_new_dm -->
<g id="proc~~state_init~~UsesGraph_node44" class="node"><title>m_new_dm</title>
<polygon fill="#337ab7" stroke="#337ab7" points="341.5,-612 273.5,-612 273.5,-588 341.5,-588 341.5,-612"/>
<text text-anchor="middle" x="307.5" y="-597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_new_dm</text>
</g>
<!-- proc~state_init&#45;&gt;m_new_dm -->
<g id="proc~~state_init~~UsesGraph_edge13" class="edge"><title>proc~state_init&#45;&gt;m_new_dm</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.696,-1171.7C426.641,-1098.25 428.291,-717.726 363,-626 359.732,-621.409 355.434,-617.6 350.683,-614.447"/>
<polygon fill="#000000" stroke="#000000" points="352.199,-611.285 341.764,-609.452 348.779,-617.392 352.199,-611.285"/>
</g>
<!-- m_hsparse -->
<g id="proc~~state_init~~UsesGraph_node45" class="node"><title>m_hsparse</title>
<polygon fill="#337ab7" stroke="#337ab7" points="340.5,-570 274.5,-570 274.5,-546 340.5,-546 340.5,-570"/>
<text text-anchor="middle" x="307.5" y="-555.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_hsparse</text>
</g>
<!-- proc~state_init&#45;&gt;m_hsparse -->
<g id="proc~~state_init~~UsesGraph_edge45" class="edge"><title>proc~state_init&#45;&gt;m_hsparse</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.004,-1171.94C421.579,-1090.93 400.45,-627.96 363,-579 359.535,-574.47 354.961,-570.916 349.933,-568.129"/>
<polygon fill="#000000" stroke="#000000" points="351.09,-564.812 340.534,-563.895 348.214,-571.194 351.09,-564.812"/>
</g>
<!-- parallel -->
<g id="proc~~state_init~~UsesGraph_node46" class="node"><title>parallel</title>
<polygon fill="#337ab7" stroke="#337ab7" points="334.5,-528 280.5,-528 280.5,-504 334.5,-504 334.5,-528"/>
<text text-anchor="middle" x="307.5" y="-513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel</text>
</g>
<!-- proc~state_init&#45;&gt;parallel -->
<g id="proc~~state_init~~UsesGraph_edge46" class="edge"><title>proc~state_init&#45;&gt;parallel</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.089,-1171.92C422.124,-1087.67 402.977,-589.625 363,-537 358.319,-530.838 351.586,-526.484 344.44,-523.407"/>
<polygon fill="#000000" stroke="#000000" points="345.189,-519.961 334.594,-519.954 342.872,-526.566 345.189,-519.961"/>
</g>
<!-- class_dSpData1D -->
<g id="proc~~state_init~~UsesGraph_node47" class="node"><title>class_dSpData1D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="356,-486 259,-486 259,-462 356,-462 356,-486"/>
<text text-anchor="middle" x="307.5" y="-471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_dSpData1D</text>
</g>
<!-- proc~state_init&#45;&gt;class_dSpData1D -->
<g id="proc~~state_init~~UsesGraph_edge34" class="edge"><title>proc~state_init&#45;&gt;class_dSpData1D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.166,-1171.99C422.643,-1084.84 405.521,-551.314 363,-495 362.412,-494.221 361.791,-493.471 361.141,-492.749"/>
<polygon fill="#000000" stroke="#000000" points="363.088,-489.812 353.192,-486.027 358.568,-495.157 363.088,-489.812"/>
</g>
<!-- sparse_matrices -->
<g id="proc~~state_init~~UsesGraph_node48" class="node"><title>sparse_matrices</title>
<polygon fill="#337ab7" stroke="#337ab7" points="353,-444 262,-444 262,-420 353,-420 353,-444"/>
<text text-anchor="middle" x="307.5" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sparse_matrices</text>
</g>
<!-- proc~state_init&#45;&gt;sparse_matrices -->
<g id="proc~~state_init~~UsesGraph_edge52" class="edge"><title>proc~state_init&#45;&gt;sparse_matrices</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.228,-1171.84C423.103,-1081.22 408.033,-512.963 363,-453 362.414,-452.22 361.795,-451.468 361.146,-450.745"/>
<polygon fill="#000000" stroke="#000000" points="363.101,-447.813 353.211,-444.012 358.572,-453.151 363.101,-447.813"/>
</g>
<!-- alloc -->
<g id="proc~~state_init~~UsesGraph_node49" class="node"><title>alloc</title>
<polygon fill="#337ab7" stroke="#337ab7" points="334.5,-402 280.5,-402 280.5,-378 334.5,-378 334.5,-402"/>
<text text-anchor="middle" x="307.5" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">alloc</text>
</g>
<!-- proc~state_init&#45;&gt;alloc -->
<g id="proc~~state_init~~UsesGraph_edge48" class="edge"><title>proc~state_init&#45;&gt;alloc</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.286,-1171.75C423.547,-1077.88 410.557,-474.629 363,-411 358.367,-404.802 351.654,-400.433 344.512,-397.353"/>
<polygon fill="#000000" stroke="#000000" points="345.256,-393.906 334.662,-393.903 342.942,-400.512 345.256,-393.906"/>
</g>
<!-- m_gamma -->
<g id="proc~~state_init~~UsesGraph_node50" class="node"><title>m_gamma</title>
<polygon fill="#337ab7" stroke="#337ab7" points="339.5,-360 275.5,-360 275.5,-336 339.5,-336 339.5,-360"/>
<text text-anchor="middle" x="307.5" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_gamma</text>
</g>
<!-- proc~state_init&#45;&gt;m_gamma -->
<g id="proc~~state_init~~UsesGraph_edge29" class="edge"><title>proc~state_init&#45;&gt;m_gamma</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.339,-1171.71C423.972,-1074.82 413.091,-436.31 363,-369 359.355,-364.101 354.409,-360.346 348.975,-357.466"/>
<polygon fill="#000000" stroke="#000000" points="350.085,-354.133 339.516,-353.399 347.321,-360.564 350.085,-354.133"/>
</g>
<!-- fdf -->
<g id="proc~~state_init~~UsesGraph_node51" class="node"><title>fdf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="334.5,-318 280.5,-318 280.5,-294 334.5,-294 334.5,-318"/>
<text text-anchor="middle" x="307.5" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fdf</text>
</g>
<!-- proc~state_init&#45;&gt;fdf -->
<g id="proc~~state_init~~UsesGraph_edge50" class="edge"><title>proc~state_init&#45;&gt;fdf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.388,-1171.71C424.38,-1072.05 415.637,-398.007 363,-327 358.392,-320.784 351.688,-316.407 344.548,-313.327"/>
<polygon fill="#000000" stroke="#000000" points="345.291,-309.878 334.696,-309.877 342.977,-316.485 345.291,-309.878"/>
</g>
<!-- create_Sparsity_SC -->
<g id="proc~~state_init~~UsesGraph_node52" class="node"><title>create_Sparsity_SC</title>
<polygon fill="#337ab7" stroke="#337ab7" points="361,-276 254,-276 254,-252 361,-252 361,-276"/>
<text text-anchor="middle" x="307.5" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">create_Sparsity_SC</text>
</g>
<!-- proc~state_init&#45;&gt;create_Sparsity_SC -->
<g id="proc~~state_init~~UsesGraph_edge51" class="edge"><title>proc~state_init&#45;&gt;create_Sparsity_SC</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.433,-1171.76C424.77,-1069.56 418.193,-359.72 363,-285 362.433,-284.233 361.835,-283.494 361.207,-282.782"/>
<polygon fill="#000000" stroke="#000000" points="363.377,-280.031 353.523,-276.138 358.799,-285.326 363.377,-280.031"/>
</g>
<!-- m_eo -->
<g id="proc~~state_init~~UsesGraph_node53" class="node"><title>m_eo</title>
<polygon fill="#337ab7" stroke="#337ab7" points="334.5,-234 280.5,-234 280.5,-210 334.5,-210 334.5,-234"/>
<text text-anchor="middle" x="307.5" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_eo</text>
</g>
<!-- proc~state_init&#45;&gt;m_eo -->
<g id="proc~~state_init~~UsesGraph_edge7" class="edge"><title>proc~state_init&#45;&gt;m_eo</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.473,-1171.86C425.142,-1067.36 420.76,-321.448 363,-243 358.412,-236.769 351.716,-232.387 344.578,-229.305"/>
<polygon fill="#000000" stroke="#000000" points="345.319,-225.856 334.724,-225.856 343.007,-232.463 345.319,-225.856"/>
</g>
<!-- m_rmaxh -->
<g id="proc~~state_init~~UsesGraph_node54" class="node"><title>m_rmaxh</title>
<polygon fill="#337ab7" stroke="#337ab7" points="336.5,-192 278.5,-192 278.5,-168 336.5,-168 336.5,-192"/>
<text text-anchor="middle" x="307.5" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_rmaxh</text>
</g>
<!-- proc~state_init&#45;&gt;m_rmaxh -->
<g id="proc~~state_init~~UsesGraph_edge16" class="edge"><title>proc~state_init&#45;&gt;m_rmaxh</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.51,-1172C425.496,-1065.44 423.338,-283.192 363,-201 358.807,-195.289 352.843,-191.13 346.387,-188.103"/>
<polygon fill="#000000" stroke="#000000" points="347.315,-184.712 336.724,-184.428 344.827,-191.255 347.315,-184.712"/>
</g>
<!-- m_ts_sparse -->
<g id="proc~~state_init~~UsesGraph_node55" class="node"><title>m_ts_sparse</title>
<polygon fill="#337ab7" stroke="#337ab7" points="344.5,-150 270.5,-150 270.5,-126 344.5,-126 344.5,-150"/>
<text text-anchor="middle" x="307.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_sparse</text>
</g>
<!-- proc~state_init&#45;&gt;m_ts_sparse -->
<g id="proc~~state_init~~UsesGraph_edge54" class="edge"><title>proc~state_init&#45;&gt;m_ts_sparse</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.543,-1171.83C425.832,-1062.09 425.86,-244.861 363,-159 360.439,-155.502 357.214,-152.587 353.618,-150.158"/>
<polygon fill="#000000" stroke="#000000" points="355.15,-147.008 344.69,-145.324 351.818,-153.163 355.15,-147.008"/>
</g>
<!-- module~m_mixing_scf -->
<g id="proc~~state_init~~UsesGraph_node56" class="node"><title>module~m_mixing_scf</title>
<g id="a_proc~~state_init~~UsesGraph_node56"><a xlink:href=".././module/m_mixing_scf.html" xlink:title="m_mixing_scf">
<polygon fill="#337ab7" stroke="#337ab7" points="346.5,-108 268.5,-108 268.5,-84 346.5,-84 346.5,-108"/>
<text text-anchor="middle" x="307.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_mixing_scf</text>
</a>
</g>
</g>
<!-- proc~state_init&#45;&gt;module~m_mixing_scf -->
<g id="proc~~state_init~~UsesGraph_edge55" class="edge"><title>proc~state_init&#45;&gt;module~m_mixing_scf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.575,-1171.69C426.159,-1058.89 428.388,-206.538 363,-117 360.872,-114.087 358.284,-111.577 355.403,-109.416"/>
<polygon fill="#000000" stroke="#000000" points="357.033,-106.314 346.651,-104.201 353.45,-112.327 357.033,-106.314"/>
</g>
<!-- iodm_netcdf -->
<g id="proc~~state_init~~UsesGraph_node57" class="node"><title>iodm_netcdf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="343,-66 272,-66 272,-42 343,-42 343,-66"/>
<text text-anchor="middle" x="307.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iodm_netcdf</text>
</g>
<!-- proc~state_init&#45;&gt;iodm_netcdf -->
<g id="proc~~state_init~~UsesGraph_edge56" class="edge"><title>proc~state_init&#45;&gt;iodm_netcdf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.602,-1171.94C426.468,-1057.68 430.992,-168.321 363,-75 360.093,-71.0099 356.32,-67.7779 352.116,-65.16"/>
<polygon fill="#000000" stroke="#000000" points="353.53,-61.9534 343.021,-60.6027 350.394,-68.2117 353.53,-61.9534"/>
</g>
<!-- zmatrix -->
<g id="proc~~state_init~~UsesGraph_node58" class="node"><title>zmatrix</title>
<polygon fill="#337ab7" stroke="#337ab7" points="334.5,-24 280.5,-24 280.5,-0 334.5,-0 334.5,-24"/>
<text text-anchor="middle" x="307.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">zmatrix</text>
</g>
<!-- proc~state_init&#45;&gt;zmatrix -->
<g id="proc~~state_init~~UsesGraph_edge57" class="edge"><title>proc~state_init&#45;&gt;zmatrix</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.629,-1171.85C426.772,-1054.83 433.533,-130.018 363,-33 358.45,-26.7412 351.769,-22.3478 344.633,-19.2638"/>
<polygon fill="#000000" stroke="#000000" points="345.372,-15.8142 334.777,-15.8177 343.061,-22.422 345.372,-15.8142"/>
</g>
<!-- class_Fstack_dData1D -->
<g id="proc~~state_init~~UsesGraph_node59" class="node"><title>class_Fstack_dData1D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="122,-108 -7.10543e-15,-108 -7.10543e-15,-84 122,-84 122,-108"/>
<text text-anchor="middle" x="61" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_Fstack_dData1D</text>
</g>
<!-- module~m_mixing&#45;&gt;class_Fstack_dData1D -->
<g id="proc~~state_init~~UsesGraph_edge58" class="edge"><title>module~m_mixing&#45;&gt;class_Fstack_dData1D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M157.862,-128.47C142.929,-123.412 124.216,-117.073 107.296,-111.342"/>
<polygon fill="#000000" stroke="#000000" points="108.177,-107.945 97.5827,-108.052 105.931,-114.575 108.177,-107.945"/>
</g>
<!-- precision -->
<g id="proc~~state_init~~UsesGraph_node60" class="node"><title>precision</title>
<polygon fill="#337ab7" stroke="#337ab7" points="88.5,-150 33.5,-150 33.5,-126 88.5,-126 88.5,-150"/>
<text text-anchor="middle" x="61" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">precision</text>
</g>
<!-- module~m_mixing&#45;&gt;precision -->
<g id="proc~~state_init~~UsesGraph_edge59" class="edge"><title>module~m_mixing&#45;&gt;precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M157.862,-138C140.378,-138 117.711,-138 98.8085,-138"/>
<polygon fill="#000000" stroke="#000000" points="98.7511,-134.5 88.7511,-138 98.7511,-141.5 98.7511,-134.5"/>
</g>
<!-- class_dData1D -->
<g id="proc~~state_init~~UsesGraph_node61" class="node"><title>class_dData1D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="103.5,-192 18.5,-192 18.5,-168 103.5,-168 103.5,-192"/>
<text text-anchor="middle" x="61" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_dData1D</text>
</g>
<!-- module~m_mixing&#45;&gt;class_dData1D -->
<g id="proc~~state_init~~UsesGraph_edge60" class="edge"><title>module~m_mixing&#45;&gt;class_dData1D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M157.862,-147.53C142.929,-152.588 124.216,-158.927 107.296,-164.658"/>
<polygon fill="#000000" stroke="#000000" points="105.931,-161.425 97.5827,-167.948 108.177,-168.055 105.931,-161.425"/>
</g>
<!-- module~m_mixing_scf&#45;&gt;module~m_mixing -->
<g id="proc~~state_init~~UsesGraph_edge62" class="edge"><title>module~m_mixing_scf&#45;&gt;module~m_mixing</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M272.543,-108.036C257.956,-113.205 240.852,-119.268 225.858,-124.582"/>
<polygon fill="#000000" stroke="#000000" points="224.614,-121.309 216.358,-127.949 226.953,-127.907 224.614,-121.309"/>
</g>
<!-- module~m_mixing_scf&#45;&gt;class_Fstack_dData1D -->
<g id="proc~~state_init~~UsesGraph_edge61" class="edge"><title>module~m_mixing_scf&#45;&gt;class_Fstack_dData1D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M268.297,-96C232.038,-96 176.66,-96 132.406,-96"/>
<polygon fill="#000000" stroke="#000000" points="132.281,-92.5001 122.281,-96 132.281,-99.5001 132.281,-92.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="490pt" height="32pt"
 viewBox="0.00 0.00 489.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 485.5,-28 485.5,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node"><title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node"><title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="139.5,-24 72.5,-24 72.5,-0 139.5,-0 139.5,-24"/>
<text text-anchor="middle" x="106" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="222,-24 158,-24 158,-0 222,-0 222,-24"/>
<text text-anchor="middle" x="190" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="294,-24 240,-24 240,-0 294,-0 294,-24"/>
<text text-anchor="middle" x="267" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="366,-24 312,-24 312,-0 366,-0 366,-24"/>
<text text-anchor="middle" x="339" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="481.5,-24 384.5,-24 384.5,-0 481.5,-0 481.5,-24"/>
<text text-anchor="middle" x="433" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses.
    </p>
    </div></div></div></div>
      </li>
      
      </ul>
    </div>
    


    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-istep%7E2"></span>integer</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>istep</strong></td><td></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~state_init~~CallsGraph Pages: 1 -->
<svg id="procstate_initCallsGraph" width="322pt" height="2754pt"
 viewBox="0.00 0.00 322.00 2754.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~state_init~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 2750)">
<title>proc~~state_init~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-2750 318,-2750 318,4 -4,4"/>
<!-- proc~state_init -->
<g id="proc~~state_init~~CallsGraph_node1" class="node"><title>proc~state_init</title>
<polygon fill="none" stroke="black" points="55,-1389 0,-1389 0,-1365 55,-1365 55,-1389"/>
<text text-anchor="middle" x="27.5" y="-1374.6" font-family="Helvetica,sans-Serif" font-size="10.50">state_init</text>
</g>
<!-- volcel -->
<g id="proc~~state_init~~CallsGraph_node2" class="node"><title>volcel</title>
<polygon fill="#777777" stroke="#777777" points="181,-2746 127,-2746 127,-2722 181,-2722 181,-2746"/>
<text text-anchor="middle" x="154" y="-2731.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">volcel</text>
</g>
<!-- proc~state_init&#45;&gt;volcel -->
<g id="proc~~state_init~~CallsGraph_edge1" class="edge"><title>proc~state_init&#45;&gt;volcel</title>
<path fill="none" stroke="#000000" d="M28.679,-1389.24C30.6405,-1520.07 48.8758,-2657.07 91,-2713 97.3069,-2721.37 107.119,-2726.44 117.092,-2729.49"/>
<polygon fill="#000000" stroke="#000000" points="116.448,-2732.94 126.994,-2731.93 118.117,-2726.14 116.448,-2732.94"/>
</g>
<!-- kpoint_delete -->
<g id="proc~~state_init~~CallsGraph_node3" class="node"><title>kpoint_delete</title>
<polygon fill="#777777" stroke="#777777" points="192,-2704 116,-2704 116,-2680 192,-2680 192,-2704"/>
<text text-anchor="middle" x="154" y="-2689.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">kpoint_delete</text>
</g>
<!-- proc~state_init&#45;&gt;kpoint_delete -->
<g id="proc~~state_init~~CallsGraph_edge43" class="edge"><title>proc~state_init&#45;&gt;kpoint_delete</title>
<path fill="none" stroke="#000000" d="M28.6983,-1389.25C30.8282,-1517.86 50.1984,-2616.91 91,-2671 94.9522,-2676.24 100.276,-2680.18 106.152,-2683.15"/>
<polygon fill="#000000" stroke="#000000" points="105.141,-2686.52 115.723,-2687.05 107.785,-2680.04 105.141,-2686.52"/>
</g>
<!-- mscell -->
<g id="proc~~state_init~~CallsGraph_node4" class="node"><title>mscell</title>
<polygon fill="#777777" stroke="#777777" points="181,-2662 127,-2662 127,-2638 181,-2638 181,-2662"/>
<text text-anchor="middle" x="154" y="-2647.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mscell</text>
</g>
<!-- proc~state_init&#45;&gt;mscell -->
<g id="proc~~state_init~~CallsGraph_edge3" class="edge"><title>proc~state_init&#45;&gt;mscell</title>
<path fill="none" stroke="#000000" d="M28.7186,-1389.24C31.0206,-1515.5 51.5183,-2576.74 91,-2629 97.2686,-2637.3 106.977,-2642.35 116.865,-2645.41"/>
<polygon fill="#000000" stroke="#000000" points="116.143,-2648.83 126.692,-2647.85 117.834,-2642.04 116.143,-2648.83"/>
</g>
<!-- escf -->
<g id="proc~~state_init~~CallsGraph_node5" class="node"><title>escf</title>
<polygon fill="#777777" stroke="#777777" points="181,-2620 127,-2620 127,-2596 181,-2596 181,-2620"/>
<text text-anchor="middle" x="154" y="-2605.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">escf</text>
</g>
<!-- proc~state_init&#45;&gt;escf -->
<g id="proc~~state_init~~CallsGraph_edge4" class="edge"><title>proc~state_init&#45;&gt;escf</title>
<path fill="none" stroke="#000000" d="M28.7399,-1389.22C31.2178,-1512.98 52.8355,-2536.58 91,-2587 97.2758,-2595.29 106.986,-2600.34 116.874,-2603.4"/>
<polygon fill="#000000" stroke="#000000" points="116.15,-2606.83 126.7,-2605.85 117.843,-2600.04 116.15,-2606.83"/>
</g>
<!-- re_alloc -->
<g id="proc~~state_init~~CallsGraph_node6" class="node"><title>re_alloc</title>
<polygon fill="#777777" stroke="#777777" points="181,-2578 127,-2578 127,-2554 181,-2554 181,-2578"/>
<text text-anchor="middle" x="154" y="-2563.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">re_alloc</text>
</g>
<!-- proc~state_init&#45;&gt;re_alloc -->
<g id="proc~~state_init~~CallsGraph_edge5" class="edge"><title>proc~state_init&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M28.7622,-1389.17C31.4196,-1510.32 54.1499,-2496.41 91,-2545 97.2834,-2553.29 106.996,-2558.33 116.883,-2561.39"/>
<polygon fill="#000000" stroke="#000000" points="116.159,-2564.82 126.708,-2563.84 117.852,-2558.03 116.159,-2564.82"/>
</g>
<!-- newddata2d -->
<g id="proc~~state_init~~CallsGraph_node7" class="node"><title>newddata2d</title>
<polygon fill="#777777" stroke="#777777" points="189.5,-2536 118.5,-2536 118.5,-2512 189.5,-2512 189.5,-2536"/>
<text text-anchor="middle" x="154" y="-2521.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">newddata2d</text>
</g>
<!-- proc~state_init&#45;&gt;newddata2d -->
<g id="proc~~state_init~~CallsGraph_edge6" class="edge"><title>proc~state_init&#45;&gt;newddata2d</title>
<path fill="none" stroke="#000000" d="M28.3615,-1389.27C27.1538,-1505.44 20.0712,-2409.67 91,-2503 95.5383,-2508.97 101.857,-2513.26 108.738,-2516.34"/>
<polygon fill="#000000" stroke="#000000" points="107.759,-2519.7 118.353,-2519.82 110.146,-2513.12 107.759,-2519.7"/>
</g>
<!-- nsc -->
<g id="proc~~state_init~~CallsGraph_node8" class="node"><title>nsc</title>
<polygon fill="#777777" stroke="#777777" points="181,-2494 127,-2494 127,-2470 181,-2470 181,-2494"/>
<text text-anchor="middle" x="154" y="-2479.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nsc</text>
</g>
<!-- proc~state_init&#45;&gt;nsc -->
<g id="proc~~state_init~~CallsGraph_edge7" class="edge"><title>proc~state_init&#45;&gt;nsc</title>
<path fill="none" stroke="#000000" d="M28.3903,-1389.16C27.4713,-1502.47 22.6837,-2371.3 91,-2461 97.3006,-2469.27 107.018,-2474.31 116.904,-2477.38"/>
<polygon fill="#000000" stroke="#000000" points="116.177,-2480.8 126.727,-2479.83 117.872,-2474.01 116.177,-2480.8"/>
</g>
<!-- proc~mixers_history_init -->
<g id="proc~~state_init~~CallsGraph_node9" class="node"><title>proc~mixers_history_init</title>
<g id="a_proc~~state_init~~CallsGraph_node9"><a xlink:href=".././proc/mixers_history_init.html" xlink:title="mixers_history_init">
<polygon fill="#d9534f" stroke="#d9534f" points="204.5,-2452 103.5,-2452 103.5,-2428 204.5,-2428 204.5,-2452"/>
<text text-anchor="middle" x="154" y="-2437.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mixers_history_init</text>
</a>
</g>
</g>
<!-- proc~state_init&#45;&gt;proc~mixers_history_init -->
<g id="proc~~state_init~~CallsGraph_edge8" class="edge"><title>proc~state_init&#45;&gt;proc~mixers_history_init</title>
<path fill="none" stroke="#000000" d="M28.4209,-1389.04C27.7981,-1499.36 25.2906,-2332.93 91,-2419 92.2413,-2420.63 93.6146,-2422.13 95.0952,-2423.51"/>
<polygon fill="#000000" stroke="#000000" points="93.1465,-2426.42 103.277,-2429.52 97.2914,-2420.78 93.1465,-2426.42"/>
</g>
<!-- globalize_or -->
<g id="proc~~state_init~~CallsGraph_node10" class="node"><title>globalize_or</title>
<polygon fill="#777777" stroke="#777777" points="189,-2410 119,-2410 119,-2386 189,-2386 189,-2410"/>
<text text-anchor="middle" x="154" y="-2395.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">globalize_or</text>
</g>
<!-- proc~state_init&#45;&gt;globalize_or -->
<g id="proc~~state_init~~CallsGraph_edge9" class="edge"><title>proc~state_init&#45;&gt;globalize_or</title>
<path fill="none" stroke="#000000" d="M28.4525,-1389.23C28.1338,-1497.79 27.958,-2294.64 91,-2377 95.6065,-2383.02 102.02,-2387.33 108.987,-2390.41"/>
<polygon fill="#000000" stroke="#000000" points="108.118,-2393.81 118.713,-2393.89 110.479,-2387.22 108.118,-2393.81"/>
</g>
<!-- iotdxv -->
<g id="proc~~state_init~~CallsGraph_node11" class="node"><title>iotdxv</title>
<polygon fill="#777777" stroke="#777777" points="181,-2368 127,-2368 127,-2344 181,-2344 181,-2368"/>
<text text-anchor="middle" x="154" y="-2353.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iotdxv</text>
</g>
<!-- proc~state_init&#45;&gt;iotdxv -->
<g id="proc~~state_init~~CallsGraph_edge10" class="edge"><title>proc~state_init&#45;&gt;iotdxv</title>
<path fill="none" stroke="#000000" d="M28.4879,-1389.04C28.484,-1494.32 30.551,-2256.25 91,-2335 97.3318,-2343.25 107.058,-2348.28 116.943,-2351.35"/>
<polygon fill="#000000" stroke="#000000" points="116.211,-2354.77 126.761,-2353.8 117.908,-2347.98 116.211,-2354.77"/>
</g>
<!-- timer -->
<g id="proc~~state_init~~CallsGraph_node12" class="node"><title>timer</title>
<polygon fill="#777777" stroke="#777777" points="181,-2326 127,-2326 127,-2302 181,-2302 181,-2326"/>
<text text-anchor="middle" x="154" y="-2311.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">timer</text>
</g>
<!-- proc~state_init&#45;&gt;timer -->
<g id="proc~~state_init~~CallsGraph_edge54" class="edge"><title>proc~state_init&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M28.5264,-1389.16C28.8524,-1492.24 33.1992,-2217.93 91,-2293 97.344,-2301.24 107.074,-2306.27 116.958,-2309.34"/>
<polygon fill="#000000" stroke="#000000" points="116.224,-2312.76 126.775,-2311.79 117.923,-2305.97 116.224,-2312.76"/>
</g>
<!-- time_io -->
<g id="proc~~state_init~~CallsGraph_node13" class="node"><title>time_io</title>
<polygon fill="#777777" stroke="#777777" points="181,-2284 127,-2284 127,-2260 181,-2260 181,-2284"/>
<text text-anchor="middle" x="154" y="-2269.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">time_io</text>
</g>
<!-- proc~state_init&#45;&gt;time_io -->
<g id="proc~~state_init~~CallsGraph_edge12" class="edge"><title>proc~state_init&#45;&gt;time_io</title>
<path fill="none" stroke="#000000" d="M28.6146,-1389.13C29.6547,-1488.96 38.6714,-2173.13 91,-2246 97.3458,-2254.84 107.29,-2260.69 117.371,-2264.55"/>
<polygon fill="#000000" stroke="#000000" points="116.373,-2267.91 126.965,-2267.68 118.544,-2261.25 116.373,-2267.91"/>
</g>
<!-- message -->
<g id="proc~~state_init~~CallsGraph_node14" class="node"><title>message</title>
<polygon fill="#777777" stroke="#777777" points="311.5,-1206 255.5,-1206 255.5,-1182 311.5,-1182 311.5,-1206"/>
<text text-anchor="middle" x="283.5" y="-1191.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">message</text>
</g>
<!-- proc~state_init&#45;&gt;message -->
<g id="proc~~state_init~~CallsGraph_edge15" class="edge"><title>proc~state_init&#45;&gt;message</title>
<path fill="none" stroke="#000000" d="M28.4826,-1389.21C28.4689,-1485.44 30.676,-2119.22 91,-2175 132.115,-2213.02 176.104,-2213.26 217,-2175 289.292,-2107.37 284.351,-1356.77 282.788,-1216.51"/>
<polygon fill="#000000" stroke="#000000" points="286.283,-1216.11 282.666,-1206.15 279.284,-1216.19 286.283,-1216.11"/>
</g>
<!-- proc~check_cohp -->
<g id="proc~~state_init~~CallsGraph_node15" class="node"><title>proc~check_cohp</title>
<g id="a_proc~~state_init~~CallsGraph_node15"><a xlink:href=".././proc/check_cohp.html" xlink:title="check_cohp">
<polygon fill="#d9534f" stroke="#d9534f" points="189,-66 119,-66 119,-42 189,-42 189,-66"/>
<text text-anchor="middle" x="154" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_cohp</text>
</a>
</g>
</g>
<!-- proc~state_init&#45;&gt;proc~check_cohp -->
<g id="proc~~state_init~~CallsGraph_edge16" class="edge"><title>proc~state_init&#45;&gt;proc~check_cohp</title>
<path fill="none" stroke="#000000" d="M28.6958,-1364.67C30.7997,-1235.27 49.9548,-129.433 91,-75 95.61,-68.8864 102.088,-64.5362 109.131,-61.4447"/>
<polygon fill="#000000" stroke="#000000" points="110.706,-64.6 118.964,-57.9618 108.369,-58.0017 110.706,-64.6"/>
</g>
<!-- file_exist -->
<g id="proc~~state_init~~CallsGraph_node16" class="node"><title>file_exist</title>
<polygon fill="#777777" stroke="#777777" points="181,-2166 127,-2166 127,-2142 181,-2142 181,-2166"/>
<text text-anchor="middle" x="154" y="-2151.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">file_exist</text>
</g>
<!-- proc~state_init&#45;&gt;file_exist -->
<g id="proc~~state_init~~CallsGraph_edge17" class="edge"><title>proc~state_init&#45;&gt;file_exist</title>
<path fill="none" stroke="#000000" d="M28.7087,-1389C30.4083,-1480.94 43.1544,-2071.78 91,-2133 97.403,-2141.19 107.149,-2146.21 117.031,-2149.28"/>
<polygon fill="#000000" stroke="#000000" points="116.288,-2152.7 126.839,-2151.74 117.992,-2145.91 116.288,-2152.7"/>
</g>
<!-- listhptr -->
<g id="proc~~state_init~~CallsGraph_node17" class="node"><title>listhptr</title>
<polygon fill="#777777" stroke="#777777" points="181,-2124 127,-2124 127,-2100 181,-2100 181,-2124"/>
<text text-anchor="middle" x="154" y="-2109.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">listhptr</text>
</g>
<!-- proc~state_init&#45;&gt;listhptr -->
<g id="proc~~state_init~~CallsGraph_edge18" class="edge"><title>proc~state_init&#45;&gt;listhptr</title>
<path fill="none" stroke="#000000" d="M28.7744,-1389.18C30.8936,-1478.73 45.7986,-2033.45 91,-2091 97.4228,-2099.18 107.175,-2104.19 117.056,-2107.26"/>
<polygon fill="#000000" stroke="#000000" points="116.309,-2110.68 126.861,-2109.72 118.016,-2103.89 116.309,-2110.68"/>
</g>
<!-- crtsparsity_sc -->
<g id="proc~~state_init~~CallsGraph_node18" class="node"><title>crtsparsity_sc</title>
<polygon fill="#777777" stroke="#777777" points="193,-2082 115,-2082 115,-2058 193,-2058 193,-2082"/>
<text text-anchor="middle" x="154" y="-2067.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">crtsparsity_sc</text>
</g>
<!-- proc~state_init&#45;&gt;crtsparsity_sc -->
<g id="proc~~state_init~~CallsGraph_edge19" class="edge"><title>proc~state_init&#45;&gt;crtsparsity_sc</title>
<path fill="none" stroke="#000000" d="M28.8395,-1389.01C31.3698,-1474.97 48.3805,-1995.04 91,-2049 94.929,-2053.97 100.09,-2057.78 105.758,-2060.69"/>
<polygon fill="#000000" stroke="#000000" points="104.405,-2063.91 114.981,-2064.56 107.113,-2057.46 104.405,-2063.91"/>
</g>
<!-- setup_kpoint_scf -->
<g id="proc~~state_init~~CallsGraph_node19" class="node"><title>setup_kpoint_scf</title>
<polygon fill="#777777" stroke="#777777" points="200.5,-2040 107.5,-2040 107.5,-2016 200.5,-2016 200.5,-2040"/>
<text text-anchor="middle" x="154" y="-2025.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_kpoint_scf</text>
</g>
<!-- proc~state_init&#45;&gt;setup_kpoint_scf -->
<g id="proc~~state_init~~CallsGraph_edge20" class="edge"><title>proc~state_init&#45;&gt;setup_kpoint_scf</title>
<path fill="none" stroke="#000000" d="M28.919,-1389.04C31.9045,-1471.98 50.9935,-1956.66 91,-2007 93.2241,-2009.8 95.8375,-2012.23 98.7111,-2014.33"/>
<polygon fill="#000000" stroke="#000000" points="97.0002,-2017.39 107.391,-2019.46 100.558,-2011.36 97.0002,-2017.39"/>
</g>
<!-- proximity_check -->
<g id="proc~~state_init~~CallsGraph_node20" class="node"><title>proximity_check</title>
<polygon fill="#777777" stroke="#777777" points="198.5,-1998 109.5,-1998 109.5,-1974 198.5,-1974 198.5,-1998"/>
<text text-anchor="middle" x="154" y="-1983.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">proximity_check</text>
</g>
<!-- proc~state_init&#45;&gt;proximity_check -->
<g id="proc~~state_init~~CallsGraph_edge21" class="edge"><title>proc~state_init&#45;&gt;proximity_check</title>
<path fill="none" stroke="#000000" d="M29.0179,-1389.26C32.511,-1469.52 53.6295,-1918.32 91,-1965 93.6766,-1968.34 96.9089,-1971.16 100.475,-1973.53"/>
<polygon fill="#000000" stroke="#000000" points="98.835,-1976.62 109.298,-1978.28 102.156,-1970.46 98.835,-1976.62"/>
</g>
<!-- siesta_write_positions -->
<g id="proc~~state_init~~CallsGraph_node21" class="node"><title>siesta_write_positions</title>
<polygon fill="#777777" stroke="#777777" points="212.5,-1956 95.5,-1956 95.5,-1932 212.5,-1932 212.5,-1956"/>
<text text-anchor="middle" x="154" y="-1941.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_write_positions</text>
</g>
<!-- proc~state_init&#45;&gt;siesta_write_positions -->
<g id="proc~~state_init~~CallsGraph_edge56" class="edge"><title>proc~state_init&#45;&gt;siesta_write_positions</title>
<path fill="none" stroke="#000000" d="M29.1285,-1389.36C33.1524,-1466.5 56.2427,-1879.94 91,-1923 91.7138,-1923.88 92.4664,-1924.73 93.2538,-1925.54"/>
<polygon fill="#000000" stroke="#000000" points="91.1869,-1928.37 101.166,-1931.93 95.5848,-1922.93 91.1869,-1928.37"/>
</g>
<!-- superc -->
<g id="proc~~state_init~~CallsGraph_node22" class="node"><title>superc</title>
<polygon fill="#777777" stroke="#777777" points="181,-1914 127,-1914 127,-1890 181,-1890 181,-1914"/>
<text text-anchor="middle" x="154" y="-1899.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">superc</text>
</g>
<!-- proc~state_init&#45;&gt;superc -->
<g id="proc~~state_init~~CallsGraph_edge23" class="edge"><title>proc~state_init&#45;&gt;superc</title>
<path fill="none" stroke="#000000" d="M28.3209,-1389.11C27.5393,-1458.21 26.9442,-1802.4 91,-1881 97.5154,-1888.99 107.203,-1893.96 116.994,-1897.04"/>
<polygon fill="#000000" stroke="#000000" points="116.151,-1900.44 126.707,-1899.53 117.891,-1893.66 116.151,-1900.44"/>
</g>
<!-- attach -->
<g id="proc~~state_init~~CallsGraph_node23" class="node"><title>attach</title>
<polygon fill="#777777" stroke="#777777" points="181,-1872 127,-1872 127,-1848 181,-1848 181,-1872"/>
<text text-anchor="middle" x="154" y="-1857.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">attach</text>
</g>
<!-- proc~state_init&#45;&gt;attach -->
<g id="proc~~state_init~~CallsGraph_edge24" class="edge"><title>proc~state_init&#45;&gt;attach</title>
<path fill="none" stroke="#000000" d="M28.4726,-1389.38C28.5704,-1455.6 32.1847,-1767.64 91,-1839 97.5596,-1846.96 107.26,-1851.91 117.05,-1854.99"/>
<polygon fill="#000000" stroke="#000000" points="116.199,-1858.39 126.756,-1857.49 117.944,-1851.61 116.199,-1858.39"/>
</g>
<!-- cmlendpropertylist -->
<g id="proc~~state_init~~CallsGraph_node24" class="node"><title>cmlendpropertylist</title>
<polygon fill="#777777" stroke="#777777" points="204,-1830 104,-1830 104,-1806 204,-1806 204,-1830"/>
<text text-anchor="middle" x="154" y="-1815.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cmlendpropertylist</text>
</g>
<!-- proc~state_init&#45;&gt;cmlendpropertylist -->
<g id="proc~~state_init~~CallsGraph_edge25" class="edge"><title>proc~state_init&#45;&gt;cmlendpropertylist</title>
<path fill="none" stroke="#000000" d="M28.6524,-1389.06C29.6708,-1450.98 37.2374,-1732.65 91,-1797 92.3388,-1798.6 93.8049,-1800.08 95.373,-1801.45"/>
<polygon fill="#000000" stroke="#000000" points="93.7354,-1804.57 103.948,-1807.4 97.7236,-1798.82 93.7354,-1804.57"/>
</g>
<!-- newdspdata1d -->
<g id="proc~~state_init~~CallsGraph_node25" class="node"><title>newdspdata1d</title>
<polygon fill="#777777" stroke="#777777" points="195,-1788 113,-1788 113,-1764 195,-1764 195,-1788"/>
<text text-anchor="middle" x="154" y="-1773.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">newdspdata1d</text>
</g>
<!-- proc~state_init&#45;&gt;newdspdata1d -->
<g id="proc~~state_init~~CallsGraph_edge26" class="edge"><title>proc~state_init&#45;&gt;newdspdata1d</title>
<path fill="none" stroke="#000000" d="M28.8828,-1389.38C30.9379,-1448.08 42.4545,-1697.83 91,-1755 94.4517,-1759.06 98.721,-1762.34 103.392,-1764.99"/>
<polygon fill="#000000" stroke="#000000" points="102.217,-1768.3 112.761,-1769.34 105.164,-1761.96 102.217,-1768.3"/>
</g>
<!-- ts_sparse_init -->
<g id="proc~~state_init~~CallsGraph_node26" class="node"><title>ts_sparse_init</title>
<polygon fill="#777777" stroke="#777777" points="193.5,-1746 114.5,-1746 114.5,-1722 193.5,-1722 193.5,-1746"/>
<text text-anchor="middle" x="154" y="-1731.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ts_sparse_init</text>
</g>
<!-- proc~state_init&#45;&gt;ts_sparse_init -->
<g id="proc~~state_init~~CallsGraph_edge28" class="edge"><title>proc~state_init&#45;&gt;ts_sparse_init</title>
<path fill="none" stroke="#000000" d="M29.1455,-1389.08C32.2681,-1443.2 47.4787,-1662.78 91,-1713 94.9098,-1717.51 99.8256,-1721.06 105.17,-1723.84"/>
<polygon fill="#000000" stroke="#000000" points="103.898,-1727.1 114.467,-1727.84 106.667,-1720.67 103.898,-1727.1"/>
</g>
<!-- setup_dm_netcdf_file -->
<g id="proc~~state_init~~CallsGraph_node27" class="node"><title>setup_dm_netcdf_file</title>
<polygon fill="#777777" stroke="#777777" points="211.5,-1704 96.5,-1704 96.5,-1680 211.5,-1680 211.5,-1704"/>
<text text-anchor="middle" x="154" y="-1689.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_dm_netcdf_file</text>
</g>
<!-- proc~state_init&#45;&gt;setup_dm_netcdf_file -->
<g id="proc~~state_init~~CallsGraph_edge29" class="edge"><title>proc~state_init&#45;&gt;setup_dm_netcdf_file</title>
<path fill="none" stroke="#000000" d="M29.507,-1389.23C33.8597,-1439.26 52.5966,-1627.81 91,-1671 91.8921,-1672 92.8338,-1672.96 93.8188,-1673.87"/>
<polygon fill="#000000" stroke="#000000" points="91.9842,-1676.86 102.108,-1679.99 96.1417,-1671.23 91.9842,-1676.86"/>
</g>
<!-- sp_to_spglobal -->
<g id="proc~~state_init~~CallsGraph_node28" class="node"><title>sp_to_spglobal</title>
<polygon fill="#777777" stroke="#777777" points="196.5,-1662 111.5,-1662 111.5,-1638 196.5,-1638 196.5,-1662"/>
<text text-anchor="middle" x="154" y="-1647.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sp_to_spglobal</text>
</g>
<!-- proc~state_init&#45;&gt;sp_to_spglobal -->
<g id="proc~~state_init~~CallsGraph_edge27" class="edge"><title>proc~state_init&#45;&gt;sp_to_spglobal</title>
<path fill="none" stroke="#000000" d="M29.9843,-1389.3C35.7024,-1434.8 57.6617,-1592.76 91,-1629 94.158,-1632.43 97.8973,-1635.31 101.95,-1637.71"/>
<polygon fill="#000000" stroke="#000000" points="100.7,-1640.99 111.22,-1642.25 103.782,-1634.71 100.7,-1640.99"/>
</g>
<!-- bye -->
<g id="proc~~state_init~~CallsGraph_node29" class="node"><title>bye</title>
<polygon fill="#777777" stroke="#777777" points="181,-1620 127,-1620 127,-1596 181,-1596 181,-1620"/>
<text text-anchor="middle" x="154" y="-1605.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bye</text>
</g>
<!-- proc~state_init&#45;&gt;bye -->
<g id="proc~~state_init~~CallsGraph_edge31" class="edge"><title>proc~state_init&#45;&gt;bye</title>
<path fill="none" stroke="#000000" d="M28.4565,-1389.08C28.995,-1424.52 35.4469,-1529.33 91,-1587 97.9638,-1594.23 107.502,-1598.97 117.01,-1602.08"/>
<polygon fill="#000000" stroke="#000000" points="116.228,-1605.49 126.797,-1604.76 118.079,-1598.74 116.228,-1605.49"/>
</g>
<!-- globalize_sum -->
<g id="proc~~state_init~~CallsGraph_node30" class="node"><title>globalize_sum</title>
<polygon fill="#777777" stroke="#777777" points="194.5,-1578 113.5,-1578 113.5,-1554 194.5,-1554 194.5,-1578"/>
<text text-anchor="middle" x="154" y="-1563.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">globalize_sum</text>
</g>
<!-- proc~state_init&#45;&gt;globalize_sum -->
<g id="proc~~state_init~~CallsGraph_edge35" class="edge"><title>proc~state_init&#45;&gt;globalize_sum</title>
<path fill="none" stroke="#000000" d="M29.5034,-1389.06C32.6845,-1419.56 45.2278,-1500.56 91,-1545 94.7763,-1548.67 99.2154,-1551.69 103.954,-1554.19"/>
<polygon fill="#000000" stroke="#000000" points="102.781,-1557.5 113.34,-1558.38 105.631,-1551.11 102.781,-1557.5"/>
</g>
<!-- ioxv -->
<g id="proc~~state_init~~CallsGraph_node31" class="node"><title>ioxv</title>
<polygon fill="#777777" stroke="#777777" points="181,-1536 127,-1536 127,-1512 181,-1512 181,-1536"/>
<text text-anchor="middle" x="154" y="-1521.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ioxv</text>
</g>
<!-- proc~state_init&#45;&gt;ioxv -->
<g id="proc~~state_init~~CallsGraph_edge32" class="edge"><title>proc~state_init&#45;&gt;ioxv</title>
<path fill="none" stroke="#000000" d="M31.2528,-1389.33C37.4746,-1414.37 54.97,-1471.5 91,-1503 98.3511,-1509.43 107.752,-1513.91 116.998,-1517.02"/>
<polygon fill="#000000" stroke="#000000" points="116.287,-1520.46 126.867,-1519.89 118.243,-1513.74 116.287,-1520.46"/>
</g>
<!-- setup_ts_kpoint_scf -->
<g id="proc~~state_init~~CallsGraph_node32" class="node"><title>setup_ts_kpoint_scf</title>
<polygon fill="#777777" stroke="#777777" points="207.5,-1494 100.5,-1494 100.5,-1470 207.5,-1470 207.5,-1494"/>
<text text-anchor="middle" x="154" y="-1479.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_ts_kpoint_scf</text>
</g>
<!-- proc~state_init&#45;&gt;setup_ts_kpoint_scf -->
<g id="proc~~state_init~~CallsGraph_edge33" class="edge"><title>proc~state_init&#45;&gt;setup_ts_kpoint_scf</title>
<path fill="none" stroke="#000000" d="M34.4413,-1389.12C43.9433,-1407.29 64.246,-1441.54 91,-1461 93.0909,-1462.52 95.2997,-1463.94 97.5891,-1465.26"/>
<polygon fill="#000000" stroke="#000000" points="96.2345,-1468.49 106.739,-1469.87 99.3861,-1462.24 96.2345,-1468.49"/>
</g>
<!-- init_val -->
<g id="proc~~state_init~~CallsGraph_node33" class="node"><title>init_val</title>
<polygon fill="#777777" stroke="#777777" points="181,-1452 127,-1452 127,-1428 181,-1428 181,-1452"/>
<text text-anchor="middle" x="154" y="-1437.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_val</text>
</g>
<!-- proc~state_init&#45;&gt;init_val -->
<g id="proc~~state_init~~CallsGraph_edge34" class="edge"><title>proc~state_init&#45;&gt;init_val</title>
<path fill="none" stroke="#000000" d="M44.2308,-1389.29C56.4584,-1398.41 74.1243,-1410.66 91,-1419 99.2162,-1423.06 108.409,-1426.65 117.147,-1429.66"/>
<polygon fill="#000000" stroke="#000000" points="116.151,-1433.01 126.744,-1432.8 118.331,-1426.36 116.151,-1433.01"/>
</g>
<!-- newsparsity -->
<g id="proc~~state_init~~CallsGraph_node34" class="node"><title>newsparsity</title>
<polygon fill="#777777" stroke="#777777" points="188.5,-1410 119.5,-1410 119.5,-1386 188.5,-1386 188.5,-1410"/>
<text text-anchor="middle" x="154" y="-1395.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">newsparsity</text>
</g>
<!-- proc~state_init&#45;&gt;newsparsity -->
<g id="proc~~state_init~~CallsGraph_edge14" class="edge"><title>proc~state_init&#45;&gt;newsparsity</title>
<path fill="none" stroke="#000000" d="M55.2084,-1381.51C70.9301,-1384.16 91.2004,-1387.58 109.206,-1390.61"/>
<polygon fill="#000000" stroke="#000000" points="108.769,-1394.09 119.212,-1392.3 109.934,-1387.19 108.769,-1394.09"/>
</g>
<!-- setup_ordern_indexes -->
<g id="proc~~state_init~~CallsGraph_node35" class="node"><title>setup_ordern_indexes</title>
<polygon fill="#777777" stroke="#777777" points="213.5,-1368 94.5,-1368 94.5,-1344 213.5,-1344 213.5,-1368"/>
<text text-anchor="middle" x="154" y="-1353.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_ordern_indexes</text>
</g>
<!-- proc~state_init&#45;&gt;setup_ordern_indexes -->
<g id="proc~~state_init~~CallsGraph_edge36" class="edge"><title>proc~state_init&#45;&gt;setup_ordern_indexes</title>
<path fill="none" stroke="#000000" d="M55.2084,-1372.49C63.9258,-1371.02 74.0417,-1369.32 84.3945,-1367.57"/>
<polygon fill="#000000" stroke="#000000" points="85.0765,-1371.01 94.3551,-1365.89 83.9122,-1364.1 85.0765,-1371.01"/>
</g>
<!-- setup_dmhs_netcdf_file -->
<g id="proc~~state_init~~CallsGraph_node36" class="node"><title>setup_dmhs_netcdf_file</title>
<polygon fill="#777777" stroke="#777777" points="217,-1326 91,-1326 91,-1302 217,-1302 217,-1326"/>
<text text-anchor="middle" x="154" y="-1311.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_dmhs_netcdf_file</text>
</g>
<!-- proc~state_init&#45;&gt;setup_dmhs_netcdf_file -->
<g id="proc~~state_init~~CallsGraph_edge13" class="edge"><title>proc~state_init&#45;&gt;setup_dmhs_netcdf_file</title>
<path fill="none" stroke="#000000" d="M44.2308,-1364.71C56.4584,-1355.59 74.1243,-1343.34 91,-1335 94.7822,-1333.13 98.7712,-1331.36 102.828,-1329.7"/>
<polygon fill="#000000" stroke="#000000" points="104.273,-1332.9 112.349,-1326.04 101.759,-1326.36 104.273,-1332.9"/>
</g>
<!-- cmlstartpropertylist -->
<g id="proc~~state_init~~CallsGraph_node37" class="node"><title>cmlstartpropertylist</title>
<polygon fill="#777777" stroke="#777777" points="205.5,-1284 102.5,-1284 102.5,-1260 205.5,-1260 205.5,-1284"/>
<text text-anchor="middle" x="154" y="-1269.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cmlstartpropertylist</text>
</g>
<!-- proc~state_init&#45;&gt;cmlstartpropertylist -->
<g id="proc~~state_init~~CallsGraph_edge61" class="edge"><title>proc~state_init&#45;&gt;cmlstartpropertylist</title>
<path fill="none" stroke="#000000" d="M34.4413,-1364.88C43.9433,-1346.71 64.246,-1312.46 91,-1293 93.0909,-1291.48 95.2997,-1290.06 97.5891,-1288.74"/>
<polygon fill="#000000" stroke="#000000" points="99.3861,-1291.76 106.739,-1284.13 96.2345,-1285.51 99.3861,-1291.76"/>
</g>
<!-- newdspdata2d -->
<g id="proc~~state_init~~CallsGraph_node38" class="node"><title>newdspdata2d</title>
<polygon fill="#777777" stroke="#777777" points="195,-1242 113,-1242 113,-1218 195,-1218 195,-1242"/>
<text text-anchor="middle" x="154" y="-1227.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">newdspdata2d</text>
</g>
<!-- proc~state_init&#45;&gt;newdspdata2d -->
<g id="proc~~state_init~~CallsGraph_edge39" class="edge"><title>proc~state_init&#45;&gt;newdspdata2d</title>
<path fill="none" stroke="#000000" d="M31.2528,-1364.67C37.4746,-1339.63 54.97,-1282.5 91,-1251 94.7083,-1247.76 98.9382,-1245.01 103.407,-1242.69"/>
<polygon fill="#000000" stroke="#000000" points="105.12,-1245.75 112.824,-1238.48 102.266,-1239.36 105.12,-1245.75"/>
</g>
<!-- new_dm -->
<g id="proc~~state_init~~CallsGraph_node39" class="node"><title>new_dm</title>
<polygon fill="#777777" stroke="#777777" points="181,-1200 127,-1200 127,-1176 181,-1176 181,-1200"/>
<text text-anchor="middle" x="154" y="-1185.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">new_dm</text>
</g>
<!-- proc~state_init&#45;&gt;new_dm -->
<g id="proc~~state_init~~CallsGraph_edge40" class="edge"><title>proc~state_init&#45;&gt;new_dm</title>
<path fill="none" stroke="#000000" d="M29.5034,-1364.94C32.6845,-1334.44 45.2278,-1253.44 91,-1209 98.1411,-1202.07 107.652,-1197.42 117.076,-1194.31"/>
<polygon fill="#000000" stroke="#000000" points="118.082,-1197.66 126.762,-1191.58 116.188,-1190.92 118.082,-1197.66"/>
</g>
<!-- madelung -->
<g id="proc~~state_init~~CallsGraph_node40" class="node"><title>madelung</title>
<polygon fill="#777777" stroke="#777777" points="184,-1158 124,-1158 124,-1134 184,-1134 184,-1158"/>
<text text-anchor="middle" x="154" y="-1143.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">madelung</text>
</g>
<!-- proc~state_init&#45;&gt;madelung -->
<g id="proc~~state_init~~CallsGraph_edge42" class="edge"><title>proc~state_init&#45;&gt;madelung</title>
<path fill="none" stroke="#000000" d="M28.4565,-1364.92C28.995,-1329.48 35.4469,-1224.67 91,-1167 97.3016,-1160.46 105.711,-1155.96 114.299,-1152.85"/>
<polygon fill="#000000" stroke="#000000" points="115.417,-1156.17 123.967,-1149.92 113.381,-1149.48 115.417,-1156.17"/>
</g>
<!-- chess_init -->
<g id="proc~~state_init~~CallsGraph_node41" class="node"><title>chess_init</title>
<polygon fill="#777777" stroke="#777777" points="184,-1116 124,-1116 124,-1092 184,-1092 184,-1116"/>
<text text-anchor="middle" x="154" y="-1101.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">chess_init</text>
</g>
<!-- proc~state_init&#45;&gt;chess_init -->
<g id="proc~~state_init~~CallsGraph_edge62" class="edge"><title>proc~state_init&#45;&gt;chess_init</title>
<path fill="none" stroke="#000000" d="M29.9843,-1364.7C35.7024,-1319.2 57.6617,-1161.24 91,-1125 97.1489,-1118.32 105.501,-1113.76 114.082,-1110.65"/>
<polygon fill="#000000" stroke="#000000" points="115.204,-1113.97 123.762,-1107.72 113.177,-1107.27 115.204,-1113.97"/>
</g>
<!-- exact_sc_ag -->
<g id="proc~~state_init~~CallsGraph_node42" class="node"><title>exact_sc_ag</title>
<polygon fill="#777777" stroke="#777777" points="190.5,-1074 117.5,-1074 117.5,-1050 190.5,-1050 190.5,-1074"/>
<text text-anchor="middle" x="154" y="-1059.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">exact_sc_ag</text>
</g>
<!-- proc~state_init&#45;&gt;exact_sc_ag -->
<g id="proc~~state_init~~CallsGraph_edge2" class="edge"><title>proc~state_init&#45;&gt;exact_sc_ag</title>
<path fill="none" stroke="#000000" d="M29.507,-1364.77C33.8597,-1314.74 52.5966,-1126.19 91,-1083 95.6173,-1077.81 101.566,-1073.9 107.946,-1070.95"/>
<polygon fill="#000000" stroke="#000000" points="109.411,-1074.14 117.498,-1067.29 106.907,-1067.6 109.411,-1074.14"/>
</g>
<!-- normalize_dm -->
<g id="proc~~state_init~~CallsGraph_node43" class="node"><title>normalize_dm</title>
<polygon fill="#777777" stroke="#777777" points="194,-1032 114,-1032 114,-1008 194,-1008 194,-1032"/>
<text text-anchor="middle" x="154" y="-1017.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">normalize_dm</text>
</g>
<!-- proc~state_init&#45;&gt;normalize_dm -->
<g id="proc~~state_init~~CallsGraph_edge44" class="edge"><title>proc~state_init&#45;&gt;normalize_dm</title>
<path fill="none" stroke="#000000" d="M29.1455,-1364.92C32.2681,-1310.8 47.4787,-1091.22 91,-1041 94.7214,-1036.71 99.3542,-1033.29 104.4,-1030.57"/>
<polygon fill="#000000" stroke="#000000" points="106.102,-1033.64 113.823,-1026.39 103.263,-1027.24 106.102,-1033.64"/>
</g>
<!-- get_chess_parameter -->
<g id="proc~~state_init~~CallsGraph_node44" class="node"><title>get_chess_parameter</title>
<polygon fill="#777777" stroke="#777777" points="212.5,-990 95.5,-990 95.5,-966 212.5,-966 212.5,-990"/>
<text text-anchor="middle" x="154" y="-975.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_chess_parameter</text>
</g>
<!-- proc~state_init&#45;&gt;get_chess_parameter -->
<g id="proc~~state_init~~CallsGraph_edge45" class="edge"><title>proc~state_init&#45;&gt;get_chess_parameter</title>
<path fill="none" stroke="#000000" d="M28.8828,-1364.62C30.9379,-1305.92 42.4545,-1056.17 91,-999 91.8483,-998.001 92.7459,-997.05 93.6868,-996.143"/>
<polygon fill="#000000" stroke="#000000" points="95.8382,-998.904 101.644,-990.041 91.5784,-993.349 95.8382,-998.904"/>
</g>
<!-- numh -->
<g id="proc~~state_init~~CallsGraph_node45" class="node"><title>numh</title>
<polygon fill="#777777" stroke="#777777" points="181,-948 127,-948 127,-924 181,-924 181,-948"/>
<text text-anchor="middle" x="154" y="-933.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">numh</text>
</g>
<!-- proc~state_init&#45;&gt;numh -->
<g id="proc~~state_init~~CallsGraph_edge46" class="edge"><title>proc~state_init&#45;&gt;numh</title>
<path fill="none" stroke="#000000" d="M28.6524,-1364.94C29.6708,-1303.02 37.2374,-1021.35 91,-957 97.6122,-949.085 107.328,-944.143 117.115,-941.06"/>
<polygon fill="#000000" stroke="#000000" points="118.007,-944.445 126.815,-938.556 116.257,-937.667 118.007,-944.445"/>
</g>
<!-- write_zmatrix -->
<g id="proc~~state_init~~CallsGraph_node46" class="node"><title>write_zmatrix</title>
<polygon fill="#777777" stroke="#777777" points="192,-906 116,-906 116,-882 192,-882 192,-906"/>
<text text-anchor="middle" x="154" y="-891.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_zmatrix</text>
</g>
<!-- proc~state_init&#45;&gt;write_zmatrix -->
<g id="proc~~state_init~~CallsGraph_edge58" class="edge"><title>proc~state_init&#45;&gt;write_zmatrix</title>
<path fill="none" stroke="#000000" d="M28.4726,-1364.62C28.5704,-1298.4 32.1847,-986.358 91,-915 95.1268,-909.993 100.497,-906.175 106.35,-903.264"/>
<polygon fill="#000000" stroke="#000000" points="107.898,-906.413 115.837,-899.397 105.255,-899.931 107.898,-906.413"/>
</g>
<!-- hsparse -->
<g id="proc~~state_init~~CallsGraph_node47" class="node"><title>hsparse</title>
<polygon fill="#777777" stroke="#777777" points="181,-864 127,-864 127,-840 181,-840 181,-864"/>
<text text-anchor="middle" x="154" y="-849.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hsparse</text>
</g>
<!-- proc~state_init&#45;&gt;hsparse -->
<g id="proc~~state_init~~CallsGraph_edge47" class="edge"><title>proc~state_init&#45;&gt;hsparse</title>
<path fill="none" stroke="#000000" d="M28.3209,-1364.89C27.5393,-1295.79 26.9442,-951.6 91,-873 97.5154,-865.005 107.203,-860.04 116.994,-856.96"/>
<polygon fill="#000000" stroke="#000000" points="117.891,-860.344 126.707,-854.467 116.151,-853.564 117.891,-860.344"/>
</g>
<!-- dict_repopulate_md -->
<g id="proc~~state_init~~CallsGraph_node48" class="node"><title>dict_repopulate_md</title>
<polygon fill="#777777" stroke="#777777" points="207.5,-822 100.5,-822 100.5,-798 207.5,-798 207.5,-822"/>
<text text-anchor="middle" x="154" y="-807.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dict_repopulate_md</text>
</g>
<!-- proc~state_init&#45;&gt;dict_repopulate_md -->
<g id="proc~~state_init~~CallsGraph_edge37" class="edge"><title>proc~state_init&#45;&gt;dict_repopulate_md</title>
<path fill="none" stroke="#000000" d="M29.1285,-1364.64C33.1524,-1287.5 56.2427,-874.061 91,-831 91.7138,-830.116 92.4664,-829.268 93.2538,-828.457"/>
<polygon fill="#000000" stroke="#000000" points="95.5848,-831.073 101.166,-822.067 91.1869,-825.627 95.5848,-831.073"/>
</g>
<!-- cmladdproperty -->
<g id="proc~~state_init~~CallsGraph_node49" class="node"><title>cmladdproperty</title>
<polygon fill="#777777" stroke="#777777" points="197.5,-780 110.5,-780 110.5,-756 197.5,-756 197.5,-780"/>
<text text-anchor="middle" x="154" y="-765.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cmladdproperty</text>
</g>
<!-- proc~state_init&#45;&gt;cmladdproperty -->
<g id="proc~~state_init~~CallsGraph_edge48" class="edge"><title>proc~state_init&#45;&gt;cmladdproperty</title>
<path fill="none" stroke="#000000" d="M29.0179,-1364.74C32.511,-1284.48 53.6295,-835.683 91,-789 93.8742,-785.41 97.389,-782.43 101.27,-779.957"/>
<polygon fill="#000000" stroke="#000000" points="102.972,-783.017 110.245,-775.313 99.7551,-776.8 102.972,-783.017"/>
</g>
<!-- val -->
<g id="proc~~state_init~~CallsGraph_node50" class="node"><title>val</title>
<polygon fill="#777777" stroke="#777777" points="181,-738 127,-738 127,-714 181,-714 181,-738"/>
<text text-anchor="middle" x="154" y="-723.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">val</text>
</g>
<!-- proc~state_init&#45;&gt;val -->
<g id="proc~~state_init~~CallsGraph_edge49" class="edge"><title>proc~state_init&#45;&gt;val</title>
<path fill="none" stroke="#000000" d="M28.919,-1364.96C31.9045,-1282.02 50.9935,-797.337 91,-747 97.47,-738.859 107.235,-733.855 117.114,-730.786"/>
<polygon fill="#000000" stroke="#000000" points="118.071,-734.154 126.913,-728.316 116.361,-727.366 118.071,-734.154"/>
</g>
<!-- outcoor -->
<g id="proc~~state_init~~CallsGraph_node51" class="node"><title>outcoor</title>
<polygon fill="#777777" stroke="#777777" points="181,-696 127,-696 127,-672 181,-672 181,-696"/>
<text text-anchor="middle" x="154" y="-681.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">outcoor</text>
</g>
<!-- proc~state_init&#45;&gt;outcoor -->
<g id="proc~~state_init~~CallsGraph_edge50" class="edge"><title>proc~state_init&#45;&gt;outcoor</title>
<path fill="none" stroke="#000000" d="M28.8395,-1364.99C31.3698,-1279.03 48.3805,-758.964 91,-705 97.445,-696.84 107.203,-691.83 117.083,-688.761"/>
<polygon fill="#000000" stroke="#000000" points="118.042,-692.129 126.885,-686.294 116.333,-685.341 118.042,-692.129"/>
</g>
<!-- die -->
<g id="proc~~state_init~~CallsGraph_node52" class="node"><title>die</title>
<polygon fill="#777777" stroke="#777777" points="181,-654 127,-654 127,-630 181,-630 181,-654"/>
<text text-anchor="middle" x="154" y="-639.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">die</text>
</g>
<!-- proc~state_init&#45;&gt;die -->
<g id="proc~~state_init~~CallsGraph_edge51" class="edge"><title>proc~state_init&#45;&gt;die</title>
<path fill="none" stroke="#000000" d="M28.7744,-1364.82C30.8936,-1275.27 45.7986,-720.553 91,-663 97.4228,-654.822 107.175,-649.807 117.056,-646.739"/>
<polygon fill="#000000" stroke="#000000" points="118.016,-650.107 126.861,-644.275 116.309,-643.318 118.016,-650.107"/>
</g>
<!-- sporb_to_spatom -->
<g id="proc~~state_init~~CallsGraph_node53" class="node"><title>sporb_to_spatom</title>
<polygon fill="#777777" stroke="#777777" points="202,-612 106,-612 106,-588 202,-588 202,-612"/>
<text text-anchor="middle" x="154" y="-597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sporb_to_spatom</text>
</g>
<!-- proc~state_init&#45;&gt;sporb_to_spatom -->
<g id="proc~~state_init~~CallsGraph_edge52" class="edge"><title>proc~state_init&#45;&gt;sporb_to_spatom</title>
<path fill="none" stroke="#000000" d="M28.7087,-1365C30.4083,-1273.06 43.1544,-682.224 91,-621 92.8369,-618.649 94.949,-616.56 97.2606,-614.703"/>
<polygon fill="#000000" stroke="#000000" points="99.2481,-617.587 105.778,-609.243 95.4703,-611.693 99.2481,-617.587"/>
</g>
<!-- xij_offset -->
<g id="proc~~state_init~~CallsGraph_node54" class="node"><title>xij_offset</title>
<polygon fill="#777777" stroke="#777777" points="181.5,-570 126.5,-570 126.5,-546 181.5,-546 181.5,-570"/>
<text text-anchor="middle" x="154" y="-555.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xij_offset</text>
</g>
<!-- proc~state_init&#45;&gt;xij_offset -->
<g id="proc~~state_init~~CallsGraph_edge53" class="edge"><title>proc~state_init&#45;&gt;xij_offset</title>
<path fill="none" stroke="#000000" d="M28.6545,-1364.94C29.9727,-1269.94 40.547,-643.849 91,-579 97.2152,-571.011 106.61,-566.04 116.22,-562.952"/>
<polygon fill="#000000" stroke="#000000" points="117.385,-566.266 126.188,-560.37 115.63,-559.49 117.385,-566.266"/>
</g>
<!-- fdf_get -->
<g id="proc~~state_init~~CallsGraph_node55" class="node"><title>fdf_get</title>
<polygon fill="#777777" stroke="#777777" points="181,-528 127,-528 127,-504 181,-504 181,-528"/>
<text text-anchor="middle" x="154" y="-513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fdf_get</text>
</g>
<!-- proc~state_init&#45;&gt;fdf_get -->
<g id="proc~~state_init~~CallsGraph_edge11" class="edge"><title>proc~state_init&#45;&gt;fdf_get</title>
<path fill="none" stroke="#000000" d="M28.6047,-1364.94C29.5552,-1267.11 37.9284,-605.489 91,-537 97.3693,-528.78 107.106,-523.754 116.989,-520.688"/>
<polygon fill="#000000" stroke="#000000" points="117.953,-524.055 126.802,-518.229 116.252,-517.264 117.953,-524.055"/>
</g>
<!-- newzspdata2d -->
<g id="proc~~state_init~~CallsGraph_node56" class="node"><title>newzspdata2d</title>
<polygon fill="#777777" stroke="#777777" points="195,-486 113,-486 113,-462 195,-462 195,-486"/>
<text text-anchor="middle" x="154" y="-471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">newzspdata2d</text>
</g>
<!-- proc~state_init&#45;&gt;newzspdata2d -->
<g id="proc~~state_init~~CallsGraph_edge55" class="edge"><title>proc~state_init&#45;&gt;newzspdata2d</title>
<path fill="none" stroke="#000000" d="M28.5593,-1364.98C29.1562,-1264.56 35.2986,-567.145 91,-495 94.4292,-490.558 98.8419,-487.049 103.731,-484.277"/>
<polygon fill="#000000" stroke="#000000" points="105.315,-487.402 112.937,-480.043 102.39,-481.042 105.315,-487.402"/>
</g>
<!-- ts_tri_analyze -->
<g id="proc~~state_init~~CallsGraph_node57" class="node"><title>ts_tri_analyze</title>
<polygon fill="#777777" stroke="#777777" points="193.5,-444 114.5,-444 114.5,-420 193.5,-420 193.5,-444"/>
<text text-anchor="middle" x="154" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ts_tri_analyze</text>
</g>
<!-- proc~state_init&#45;&gt;ts_tri_analyze -->
<g id="proc~~state_init~~CallsGraph_edge22" class="edge"><title>proc~state_init&#45;&gt;ts_tri_analyze</title>
<path fill="none" stroke="#000000" d="M28.519,-1364.74C28.7839,-1260.75 32.719,-528.737 91,-453 94.6852,-448.211 99.5142,-444.505 104.853,-441.64"/>
<polygon fill="#000000" stroke="#000000" points="106.436,-444.768 114.207,-437.567 103.641,-438.35 106.436,-444.768"/>
</g>
<!-- kpoint_nullify -->
<g id="proc~~state_init~~CallsGraph_node58" class="node"><title>kpoint_nullify</title>
<polygon fill="#777777" stroke="#777777" points="191,-402 117,-402 117,-378 191,-378 191,-402"/>
<text text-anchor="middle" x="154" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">kpoint_nullify</text>
</g>
<!-- proc~state_init&#45;&gt;kpoint_nullify -->
<g id="proc~~state_init~~CallsGraph_edge57" class="edge"><title>proc~state_init&#45;&gt;kpoint_nullify</title>
<path fill="none" stroke="#000000" d="M28.481,-1364.86C28.4172,-1258.7 30.0697,-490.42 91,-411 95.2294,-405.487 100.975,-401.41 107.272,-398.397"/>
<polygon fill="#000000" stroke="#000000" points="108.726,-401.586 116.778,-394.7 106.189,-395.062 108.726,-401.586"/>
</g>
<!-- ucell -->
<g id="proc~~state_init~~CallsGraph_node59" class="node"><title>ucell</title>
<polygon fill="#777777" stroke="#777777" points="181,-360 127,-360 127,-336 181,-336 181,-360"/>
<text text-anchor="middle" x="154" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ucell</text>
</g>
<!-- proc~state_init&#45;&gt;ucell -->
<g id="proc~~state_init~~CallsGraph_edge30" class="edge"><title>proc~state_init&#45;&gt;ucell</title>
<path fill="none" stroke="#000000" d="M28.4457,-1364.68C28.068,-1255.25 27.4761,-452.031 91,-369 97.3185,-360.741 107.041,-355.703 116.926,-352.639"/>
<polygon fill="#000000" stroke="#000000" points="117.893,-356.005 126.747,-350.187 116.197,-349.214 117.893,-356.005"/>
</g>
<!-- overlap -->
<g id="proc~~state_init~~CallsGraph_node60" class="node"><title>overlap</title>
<polygon fill="#777777" stroke="#777777" points="181,-318 127,-318 127,-294 181,-294 181,-318"/>
<text text-anchor="middle" x="154" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">overlap</text>
</g>
<!-- proc~state_init&#45;&gt;overlap -->
<g id="proc~~state_init~~CallsGraph_edge59" class="edge"><title>proc~state_init&#45;&gt;overlap</title>
<path fill="none" stroke="#000000" d="M28.4145,-1364.87C27.734,-1253.7 24.8076,-413.741 91,-327 97.3083,-318.733 107.028,-313.693 116.914,-310.629"/>
<polygon fill="#000000" stroke="#000000" points="117.881,-313.996 126.735,-308.178 116.185,-307.204 117.881,-313.996"/>
</g>
<!-- write_debug -->
<g id="proc~~state_init~~CallsGraph_node61" class="node"><title>write_debug</title>
<polygon fill="#777777" stroke="#777777" points="189.5,-276 118.5,-276 118.5,-252 189.5,-252 189.5,-276"/>
<text text-anchor="middle" x="154" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_debug</text>
</g>
<!-- proc~state_init&#45;&gt;write_debug -->
<g id="proc~~state_init~~CallsGraph_edge60" class="edge"><title>proc~state_init&#45;&gt;write_debug</title>
<path fill="none" stroke="#000000" d="M28.3841,-1364.75C27.408,-1250.6 22.2002,-375.372 91,-285 95.5434,-279.032 101.865,-274.745 108.746,-271.67"/>
<polygon fill="#000000" stroke="#000000" points="110.154,-274.883 118.362,-268.183 107.767,-268.302 110.154,-274.883"/>
</g>
<!-- ts_write_tshs -->
<g id="proc~~state_init~~CallsGraph_node62" class="node"><title>ts_write_tshs</title>
<polygon fill="#777777" stroke="#777777" points="191.5,-234 116.5,-234 116.5,-210 191.5,-210 191.5,-234"/>
<text text-anchor="middle" x="154" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ts_write_tshs</text>
</g>
<!-- proc~state_init&#45;&gt;ts_write_tshs -->
<g id="proc~~state_init~~CallsGraph_edge38" class="edge"><title>proc~state_init&#45;&gt;ts_write_tshs</title>
<path fill="none" stroke="#000000" d="M28.3555,-1364.65C27.0914,-1247.65 19.5871,-337.01 91,-243 95.1569,-237.528 100.809,-233.469 107.018,-230.461"/>
<polygon fill="#000000" stroke="#000000" points="108.383,-233.686 116.405,-226.765 105.818,-227.172 108.383,-233.686"/>
</g>
<!-- fname_tshs -->
<g id="proc~~state_init~~CallsGraph_node63" class="node"><title>fname_tshs</title>
<polygon fill="#777777" stroke="#777777" points="188,-192 120,-192 120,-168 188,-168 188,-192"/>
<text text-anchor="middle" x="154" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fname_tshs</text>
</g>
<!-- proc~state_init&#45;&gt;fname_tshs -->
<g id="proc~~state_init~~CallsGraph_edge41" class="edge"><title>proc~state_init&#45;&gt;fname_tshs</title>
<path fill="none" stroke="#000000" d="M28.7594,-1364.75C31.3897,-1242.77 53.9071,-249.93 91,-201 95.8756,-194.569 102.817,-190.089 110.304,-186.974"/>
<polygon fill="#000000" stroke="#000000" points="111.608,-190.228 119.963,-183.713 109.369,-183.596 111.608,-190.228"/>
</g>
<!-- nscold -->
<g id="proc~~state_init~~CallsGraph_node64" class="node"><title>nscold</title>
<polygon fill="#777777" stroke="#777777" points="181,-150 127,-150 127,-126 181,-126 181,-150"/>
<text text-anchor="middle" x="154" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nscold</text>
</g>
<!-- proc~state_init&#45;&gt;nscold -->
<g id="proc~~state_init~~CallsGraph_edge63" class="edge"><title>proc~state_init&#45;&gt;nscold</title>
<path fill="none" stroke="#000000" d="M28.7372,-1364.7C31.1883,-1240.12 52.5924,-209.76 91,-159 97.2744,-150.708 106.984,-145.66 116.872,-142.598"/>
<polygon fill="#000000" stroke="#000000" points="117.841,-145.963 126.698,-140.15 116.149,-139.171 117.841,-145.963"/>
</g>
<!-- isc_off -->
<g id="proc~~state_init~~CallsGraph_node65" class="node"><title>isc_off</title>
<polygon fill="#777777" stroke="#777777" points="181,-108 127,-108 127,-84 181,-84 181,-108"/>
<text text-anchor="middle" x="154" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">isc_off</text>
</g>
<!-- proc~state_init&#45;&gt;isc_off -->
<g id="proc~~state_init~~CallsGraph_edge64" class="edge"><title>proc~state_init&#45;&gt;isc_off</title>
<path fill="none" stroke="#000000" d="M28.716,-1364.68C30.9916,-1237.62 51.275,-169.595 91,-117 97.2673,-108.702 106.975,-103.653 116.863,-100.591"/>
<polygon fill="#000000" stroke="#000000" points="117.833,-103.957 126.691,-98.1439 116.141,-97.1639 117.833,-103.957"/>
</g>
<!-- delete -->
<g id="proc~~state_init~~CallsGraph_node66" class="node"><title>delete</title>
<polygon fill="#777777" stroke="#777777" points="310.5,-2316 256.5,-2316 256.5,-2292 310.5,-2292 310.5,-2316"/>
<text text-anchor="middle" x="283.5" y="-2301.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">delete</text>
</g>
<!-- proc~state_init&#45;&gt;delete -->
<g id="proc~~state_init~~CallsGraph_edge66" class="edge"><title>proc~state_init&#45;&gt;delete</title>
<path fill="none" stroke="#000000" d="M28.6434,-1389.15C29.8892,-1486.29 40.0874,-2134.79 91,-2203 126.844,-2251.02 165.059,-2221.11 217,-2251 233.433,-2260.46 250.016,-2273.92 262.384,-2284.91"/>
<polygon fill="#000000" stroke="#000000" points="260.107,-2287.57 269.86,-2291.71 264.817,-2282.4 260.107,-2287.57"/>
</g>
<!-- domaindecom -->
<g id="proc~~state_init~~CallsGraph_node67" class="node"><title>domaindecom</title>
<polygon fill="#777777" stroke="#777777" points="194,-24 114,-24 114,-0 194,-0 194,-24"/>
<text text-anchor="middle" x="154" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">domaindecom</text>
</g>
<!-- proc~state_init&#45;&gt;domaindecom -->
<g id="proc~~state_init~~CallsGraph_edge65" class="edge"><title>proc~state_init&#45;&gt;domaindecom</title>
<path fill="none" stroke="#000000" d="M28.6766,-1364.69C30.6124,-1233.07 48.6319,-89.2746 91,-33 94.5908,-28.2306 99.3185,-24.5344 104.565,-21.6716"/>
<polygon fill="#000000" stroke="#000000" points="106.046,-24.8437 113.777,-17.5985 103.215,-18.4417 106.046,-24.8437"/>
</g>
<!-- proc~mixers_history_init&#45;&gt;delete -->
<g id="proc~~state_init~~CallsGraph_edge69" class="edge"><title>proc~mixers_history_init&#45;&gt;delete</title>
<path fill="none" stroke="#000000" d="M202.63,-2427.96C207.782,-2425.5 212.705,-2422.54 217,-2419 247.064,-2394.2 266.044,-2351.77 275.43,-2325.97"/>
<polygon fill="#000000" stroke="#000000" points="278.8,-2326.93 278.767,-2316.34 272.185,-2324.64 278.8,-2326.93"/>
</g>
<!-- new -->
<g id="proc~~state_init~~CallsGraph_node68" class="node"><title>new</title>
<polygon fill="#777777" stroke="#777777" points="310.5,-2473 256.5,-2473 256.5,-2449 310.5,-2449 310.5,-2473"/>
<text text-anchor="middle" x="283.5" y="-2458.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">new</text>
</g>
<!-- proc~mixers_history_init&#45;&gt;new -->
<g id="proc~~state_init~~CallsGraph_edge67" class="edge"><title>proc~mixers_history_init&#45;&gt;new</title>
<path fill="none" stroke="#000000" d="M204.66,-2448.18C218.563,-2450.47 233.408,-2452.91 246.366,-2455.05"/>
<polygon fill="#000000" stroke="#000000" points="245.863,-2458.51 256.299,-2456.68 247.001,-2451.61 245.863,-2458.51"/>
</g>
<!-- proc~current_itt -->
<g id="proc~~state_init~~CallsGraph_node69" class="node"><title>proc~current_itt</title>
<g id="a_proc~~state_init~~CallsGraph_node69"><a xlink:href=".././proc/current_itt.html" xlink:title="current_itt">
<polygon fill="#d94e8f" stroke="#d94e8f" points="314,-2431 253,-2431 253,-2407 314,-2407 314,-2431"/>
<text text-anchor="middle" x="283.5" y="-2416.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">current_itt</text>
</a>
</g>
</g>
<!-- proc~mixers_history_init&#45;&gt;proc~current_itt -->
<g id="proc~~state_init~~CallsGraph_edge68" class="edge"><title>proc~mixers_history_init&#45;&gt;proc~current_itt</title>
<path fill="none" stroke="#000000" d="M204.66,-2431.82C217.206,-2429.75 230.52,-2427.56 242.521,-2425.58"/>
<polygon fill="#000000" stroke="#000000" points="243.379,-2428.99 252.677,-2423.91 242.241,-2422.08 243.379,-2428.99"/>
</g>
<!-- proc~check_cohp&#45;&gt;message -->
<g id="proc~~state_init~~CallsGraph_edge70" class="edge"><title>proc~check_cohp&#45;&gt;message</title>
<path fill="none" stroke="#000000" d="M189.307,-58.0943C199.797,-61.095 210.317,-66.2332 217,-75 285.846,-165.311 283.6,-1021.23 282.668,-1171.52"/>
<polygon fill="#000000" stroke="#000000" points="279.166,-1171.79 282.599,-1181.81 286.166,-1171.83 279.166,-1171.79"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,-0 209.5,-0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.5,-24 454.5,-24 454.5,-0 551.5,-0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~state_init~~CalledByGraph Pages: 1 -->
<svg id="procstate_initCalledByGraph" width="175pt" height="32pt"
 viewBox="0.00 0.00 175.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~state_init~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~state_init~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 171,-28 171,4 -4,4"/>
<!-- proc~state_init -->
<g id="proc~~state_init~~CalledByGraph_node1" class="node"><title>proc~state_init</title>
<polygon fill="none" stroke="black" points="167,-24 112,-24 112,-0 167,-0 167,-24"/>
<text text-anchor="middle" x="139.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">state_init</text>
</g>
<!-- proc~siesta_forces -->
<g id="proc~~state_init~~CalledByGraph_node2" class="node"><title>proc~siesta_forces</title>
<g id="a_proc~~state_init~~CalledByGraph_node2"><a xlink:href=".././proc/siesta_forces.html" xlink:title="siesta_forces">
<polygon fill="#d9534f" stroke="#d9534f" points="76,-24 0,-24 0,-0 76,-0 76,-24"/>
<text text-anchor="middle" x="38" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_forces</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;proc~state_init -->
<g id="proc~~state_init~~CalledByGraph_edge1" class="edge"><title>proc~siesta_forces&#45;&gt;proc~state_init</title>
<path fill="none" stroke="#000000" d="M76.0501,-12C84.4416,-12 93.3497,-12 101.73,-12"/>
<polygon fill="#000000" stroke="#000000" points="101.983,-15.5001 111.983,-12 101.983,-8.5001 101.983,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,-0 209.5,-0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.5,-24 454.5,-24 454.5,-0 551.5,-0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/state_init.html#src">state_init</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>      <span class="k">subroutine </span><span class="n">state_init</span><span class="p">(</span> <span class="n">istep</span> <span class="p">)</span>
      <span class="k">use </span><span class="n">kpoint_scf_m</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">setup_kpoint_scf</span><span class="p">,</span> <span class="n">kpoints_scf</span>
      <span class="k">use </span><span class="n">kpoint_t_m</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">kpoint_delete</span><span class="p">,</span> <span class="n">kpoint_nullify</span>

      <span class="k">use </span><span class="n">m_os</span><span class="p">,</span>              <span class="n">only</span><span class="p">:</span> <span class="n">file_exist</span>
      <span class="k">use </span><span class="n">m_new_dm</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">new_dm</span>
      <span class="k">use </span><span class="n">m_proximity_check</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">proximity_check</span>
      <span class="k">use </span><span class="n">siesta_options</span>
      <span class="k">use </span><span class="n">units</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">Ang</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">listhptr</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">Dold</span><span class="p">,</span> <span class="n">Dscf</span><span class="p">,</span> <span class="n">DM_2D</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">Eold</span><span class="p">,</span> <span class="n">Escf</span><span class="p">,</span> <span class="n">EDM_2D</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">Hold</span><span class="p">,</span> <span class="n">H</span>   <span class="p">,</span> <span class="n">H_2D</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">xijo</span><span class="p">,</span> <span class="n">xij_2D</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">S</span>   <span class="p">,</span> <span class="n">S_1D</span>

      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">H_kin_1D</span><span class="p">,</span> <span class="n">H_vkb_1D</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">H_ldau_2D</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">H_so_on_2D</span><span class="p">,</span> <span class="n">H_so_off_2D</span>

      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">sparse_pattern</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">block_dist</span><span class="p">,</span> <span class="n">single_dist</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">DM_history</span>


      <span class="k">use </span><span class="n">create_Sparsity_SC</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">crtSparsity_SC</span>
      <span class="k">use </span><span class="n">m_sparsity_handling</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">SpOrb_to_SpAtom</span>
      <span class="k">use </span><span class="n">m_sparsity_handling</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">Sp_to_Spglobal</span>
      <span class="k">use </span><span class="n">m_pivot_methods</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">sp2graphviz</span>

      <span class="k">use </span><span class="n">siesta_geom</span>
      <span class="k">use </span><span class="n">atomlist</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">iphorb</span><span class="p">,</span> <span class="n">iphkb</span><span class="p">,</span> <span class="n">indxua</span><span class="p">,</span>
     <span class="p">&amp;</span>                             <span class="n">rmaxo</span><span class="p">,</span> <span class="n">rmaxkb</span><span class="p">,</span> <span class="n">rmaxv</span><span class="p">,</span> <span class="n">rmaxldau</span><span class="p">,</span>
     <span class="p">&amp;</span>                             <span class="n">lastkb</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span> <span class="n">superc</span><span class="p">,</span> <span class="n">indxuo</span><span class="p">,</span>
     <span class="p">&amp;</span>                             <span class="n">no_u</span><span class="p">,</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">iza</span><span class="p">,</span> <span class="n">qtots</span>
      <span class="k">use </span><span class="n">alloc</span><span class="p">,</span>             <span class="n">only</span><span class="p">:</span> <span class="n">re_alloc</span><span class="p">,</span> <span class="n">de_alloc</span><span class="p">,</span> <span class="n">alloc_report</span>
      <span class="k">use </span><span class="n">m_hsparse</span><span class="p">,</span>         <span class="n">only</span><span class="p">:</span> <span class="n">hsparse</span>
      <span class="k">use </span><span class="n">m_overlap</span><span class="p">,</span>         <span class="n">only</span><span class="p">:</span> <span class="n">overlap</span>
      <span class="k">use </span><span class="n">m_supercell</span><span class="p">,</span>       <span class="n">only</span><span class="p">:</span> <span class="n">exact_sc_ag</span>
      <span class="k">use </span><span class="n">siesta_cml</span><span class="p">,</span>        <span class="n">only</span><span class="p">:</span> <span class="n">cml_p</span><span class="p">,</span> <span class="n">cmlStartStep</span><span class="p">,</span> <span class="n">mainXML</span>
      <span class="k">use </span><span class="n">siesta_cml</span><span class="p">,</span>        <span class="n">only</span><span class="p">:</span> <span class="n">cmlStartPropertyList</span>
      <span class="k">use </span><span class="n">siesta_cml</span><span class="p">,</span>        <span class="n">only</span><span class="p">:</span> <span class="n">cmlEndPropertyList</span>
      <span class="k">use </span><span class="n">siesta_cml</span><span class="p">,</span>        <span class="n">only</span><span class="p">:</span> <span class="n">cmlAddProperty</span>
      <span class="k">use </span><span class="n">zmatrix</span><span class="p">,</span>           <span class="n">only</span><span class="p">:</span> <span class="n">lUseZmatrix</span><span class="p">,</span> <span class="n">write_zmatrix</span>
      <span class="k">use </span><span class="n">m_energies</span><span class="p">,</span>        <span class="n">only</span><span class="p">:</span> <span class="n">Emad</span>
      <span class="k">use </span><span class="n">write_subs</span>
      <span class="k">use </span><span class="n">m_ioxv</span><span class="p">,</span>            <span class="n">only</span><span class="p">:</span> <span class="n">ioxv</span>
      <span class="k">use </span><span class="n">m_iotdxv</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">iotdxv</span>
      <span class="k">use </span><span class="n">m_steps</span>
      <span class="k">use </span><span class="n">parallel</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">IOnode</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">nodes</span><span class="p">,</span> <span class="n">BlockSize</span>
      <span class="k">use </span><span class="n">m_spin</span><span class="p">,</span>            <span class="n">only</span><span class="p">:</span> <span class="n">spin</span>
      <span class="k">use </span><span class="n">m_rmaxh</span>
      <span class="k">use </span><span class="n">m_mixing</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">mixers_history_init</span>
      <span class="k">use </span><span class="n">m_mixing_scf</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">scf_mixs</span><span class="p">,</span> <span class="n">scf_mix</span>

      <span class="k">use </span><span class="n">m_normalize_dm</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">normalize_dm</span>

      <span class="k">use </span><span class="n">m_eo</span>
      <span class="k">use </span><span class="n">m_gamma</span>
      <span class="k">use </span><span class="n">files</span><span class="p">,</span>             <span class="n">only</span><span class="p">:</span> <span class="n">slabel</span>
      <span class="k">use </span><span class="n">m_mpi_utils</span><span class="p">,</span>       <span class="n">only</span><span class="p">:</span> <span class="n">globalize_or</span>
      <span class="k">use </span><span class="n">m_mpi_utils</span><span class="p">,</span>       <span class="n">only</span><span class="p">:</span> <span class="n">globalize_sum</span>
      <span class="k">use </span><span class="n">domain_decom</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">domainDecom</span><span class="p">,</span> <span class="n">use_dd</span><span class="p">,</span> <span class="n">use_dd_perm</span>
      <span class="k">use </span><span class="n">ldau_specs</span><span class="p">,</span>        <span class="n">only</span><span class="p">:</span> <span class="n">switch_ldau</span><span class="p">,</span> <span class="n">ldau_init</span>
      <span class="k">use </span><span class="n">fdf</span><span class="p">,</span>               <span class="n">only</span><span class="p">:</span> <span class="n">fdf_get</span>
      <span class="k">use </span><span class="n">sys</span><span class="p">,</span>               <span class="n">only</span><span class="p">:</span> <span class="n">message</span><span class="p">,</span> <span class="n">die</span>
      <span class="k">use </span><span class="n">m_sparse</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">xij_offset</span>

      <span class="k">use </span><span class="n">ts_kpoint_scf_m</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">setup_ts_kpoint_scf</span><span class="p">,</span> <span class="n">ts_kpoints_scf</span>
      <span class="k">use </span><span class="n">m_ts_charge</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">TS_RHOCORR_METHOD</span><span class="p">,</span> <span class="n">TS_RHOCORR_FERMI</span>
      <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">BTD_method</span>
      <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">TS_Analyze</span>
      <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">N_Elec</span><span class="p">,</span> <span class="n">Elecs</span><span class="p">,</span> <span class="n">IsVolt</span>
      <span class="k">use </span><span class="n">m_ts_electype</span>
      <span class="k">use </span><span class="n">m_ts_global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">TSrun</span><span class="p">,</span> <span class="n">TSmode</span><span class="p">,</span> <span class="n">onlyS</span>
      <span class="k">use </span><span class="n">sys</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">bye</span>
      <span class="k">use </span><span class="n">m_ts_io</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">fname_TSHS</span><span class="p">,</span> <span class="n">ts_write_tshs</span>
      <span class="k">use </span><span class="n">m_ts_sparse</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">ts_sparse_init</span>
      <span class="k">use </span><span class="n">m_ts_tri_init</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">ts_tri_init</span><span class="p">,</span> <span class="n">ts_tri_analyze</span>
      <span class="k">use </span><span class="n">files</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">slabel</span><span class="p">,</span> <span class="n">label_length</span>
<span class="cp">#ifdef SIESTA__CHESS</span>
      <span class="k">use </span><span class="n">m_chess</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">CheSS_init</span><span class="p">,</span> <span class="n">get_CheSS_parameter</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef CDF</span>
      <span class="k">use </span><span class="n">iodm_netcdf</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">setup_dm_netcdf_file</span>
      <span class="k">use </span><span class="n">iodmhs_netcdf</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">setup_dmhs_netcdf_file</span>
<span class="cp">#endif</span>
      <span class="k">use </span><span class="n">class_Sparsity</span>
      <span class="k">use </span><span class="n">class_dSpData1D</span>
      <span class="k">use </span><span class="n">class_dSpData2D</span>
      <span class="k">use </span><span class="n">class_zSpData2D</span>
      <span class="k">use </span><span class="n">class_dData2D</span>
<span class="cp">#ifdef TEST_IO</span>
      <span class="k">use </span><span class="n">m_test_io</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef SIESTA__FLOOK</span>
      <span class="k">use </span><span class="n">siesta_dicts</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">dict_repopulate_MD</span>
<span class="cp">#endif</span>

      <span class="k">implicit none</span>

<span class="k">      </span><span class="kt">integer</span>            <span class="kd">::</span> <span class="n">istep</span><span class="p">,</span> <span class="n">nnz</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">veclen</span>      <span class="c">! Length of a unit-cell vector</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">rmax</span>
      <span class="kt">logical</span>            <span class="kd">::</span> <span class="n">cell_can_change</span>
      <span class="kt">integer</span>            <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iadispl</span><span class="p">,</span> <span class="n">ixdispl</span>
      <span class="kt">logical</span>            <span class="kd">::</span> <span class="n">auxchanged</span>   <span class="c">! Auxiliary supercell changed?</span>
      <span class="kt">logical</span>            <span class="kd">::</span> <span class="n">folding</span><span class="p">,</span> <span class="n">folding1</span>
      <span class="kt">logical</span>            <span class="kd">::</span> <span class="n">diag_folding</span><span class="p">,</span> <span class="n">diag_folding1</span>
      <span class="kt">logical</span>            <span class="kd">::</span> <span class="n">foundxv</span>  <span class="c">! dummy for call to ioxv</span>

      <span class="k">external</span>           <span class="kd">::</span>  <span class="n">madelung</span><span class="p">,</span> <span class="n">timer</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">external</span> <span class="kd">::</span> <span class="n">volcel</span>

      <span class="kt">integer</span>                       <span class="kd">::</span> <span class="n">ts_kscell_file</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>                      <span class="kd">::</span> <span class="n">ts_kdispl_file</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0</span>
      <span class="kt">logical</span>                       <span class="kd">::</span> <span class="n">ts_Gamma_file</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
      <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">label_length</span><span class="o">+</span><span class="mi">6</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fname</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>                      <span class="kd">::</span> <span class="n">dummyef</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">dummyqtot</span><span class="o">=</span><span class="mf">0.0</span>
<span class="cp">#ifdef SIESTA__CHESS</span>
      <span class="kt">integer</span> <span class="kd">::</span> <span class="n">maxnh_kernel</span><span class="p">,</span> <span class="n">maxnh_mult</span><span class="p">,</span> <span class="n">no_l_kernel</span><span class="p">,</span> <span class="n">no_l_mult</span>
      <span class="kt">integer</span><span class="p">,</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">allocatable</span> <span class="kd">::</span> <span class="n">listh_kernel</span><span class="p">,</span> <span class="n">listh_mult</span>
      <span class="kt">integer</span><span class="p">,</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">allocatable</span> <span class="kd">::</span> <span class="n">numh_kernel</span><span class="p">,</span> <span class="n">numh_mult</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">chess_value</span>
<span class="cp">#endif</span>
      <span class="k">type</span><span class="p">(</span><span class="n">Sparsity</span><span class="p">)</span> <span class="kd">::</span> <span class="n">g_Sp</span>
      
      <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">oname</span>

      <span class="k">type</span><span class="p">(</span><span class="n">dData2D</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tmp_2D</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dummy_qspin</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>

<span class="c">!------------------------------------------------------------------- BEGIN</span>
      <span class="k">call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;IterGeom&#39;</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span>
<span class="cp">#ifdef DEBUG</span>
      <span class="k">call </span><span class="n">write_debug</span><span class="p">(</span> <span class="s1">&#39;  PRE state_init&#39;</span> <span class="p">)</span>
<span class="cp">#endif</span>
      <span class="k">call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;state_init&#39;</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span>

      <span class="n">istp</span> <span class="o">=</span> <span class="n">istp</span> <span class="o">+</span> <span class="mi">1</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">IOnode</span><span class="p">)</span> <span class="k">then</span>
<span class="k">      write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,t22,a)&#39;</span><span class="p">)</span> <span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">,</span><span class="mi">36</span><span class="p">)</span>
      <span class="k">select case</span> <span class="p">(</span><span class="n">idyn</span><span class="p">)</span>
      <span class="k">case</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">nmove</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t25,a)&#39;</span><span class="p">)</span> <span class="s1">&#39;Single-point calculation&#39;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">cml_p</span><span class="p">)</span> <span class="k">call </span><span class="n">cmlStartStep</span><span class="p">(</span><span class="n">mainXML</span><span class="p">,</span> <span class="k">type</span><span class="o">=</span><span class="s1">&#39;Single-Point&#39;</span><span class="p">,</span>
     <span class="err">$</span>           <span class="nb">index</span><span class="o">=</span><span class="n">istp</span><span class="p">)</span>
         <span class="k">else</span>
<span class="k">            if</span> <span class="p">(</span><span class="n">broyden_optim</span><span class="p">)</span> <span class="k">then</span>
<span class="k">               write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t25,a,i6)&#39;</span><span class="p">)</span> <span class="s1">&#39;Begin Broyden opt. move = &#39;</span><span class="p">,</span>
     <span class="err">$</span>              <span class="n">istep</span>
            <span class="k">else if</span> <span class="p">(</span><span class="n">fire_optim</span><span class="p">)</span> <span class="k">then</span>
<span class="k">               write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t25,a,i6)&#39;</span><span class="p">)</span> <span class="s1">&#39;Begin FIRE opt. move = &#39;</span><span class="p">,</span>
     <span class="err">$</span>              <span class="n">istep</span>
            <span class="k">else</span>
<span class="k">               write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t25,a,i6)&#39;</span><span class="p">)</span> <span class="s1">&#39;Begin CG opt. move = &#39;</span><span class="p">,</span>
     <span class="err">$</span>              <span class="n">istep</span>
            <span class="k">end if</span>
<span class="k">            if</span> <span class="p">(</span><span class="n">cml_p</span><span class="p">)</span> <span class="k">call </span><span class="n">cmlStartStep</span><span class="p">(</span><span class="n">mainXML</span><span class="p">,</span> <span class="k">type</span><span class="o">=</span><span class="s1">&#39;Geom. Optim&#39;</span><span class="p">,</span>
     <span class="err">$</span>           <span class="nb">index</span><span class="o">=</span><span class="n">istp</span><span class="p">)</span>
         <span class="n">endif</span>
         
<span class="c">!        Print Z-matrix coordinates</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">lUseZmatrix</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            call </span><span class="n">write_Zmatrix</span><span class="p">()</span>
         <span class="n">endif</span>
      <span class="k">case</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">iquench</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t25,a,i6)&#39;</span><span class="p">)</span> <span class="s1">&#39;Begin MD quenched step = &#39;</span><span class="p">,</span>
     <span class="err">$</span>           <span class="n">istep</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">cml_p</span><span class="p">)</span> <span class="k">call </span><span class="n">cmlStartStep</span><span class="p">(</span><span class="n">mainXML</span><span class="p">,</span> <span class="k">type</span><span class="o">=</span><span class="s1">&#39;MD-quenched&#39;</span><span class="p">,</span>
     <span class="err">$</span>           <span class="nb">index</span><span class="o">=</span><span class="n">istep</span><span class="p">)</span>
         <span class="k">else</span>
<span class="k">            write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t25,a,i6)&#39;</span><span class="p">)</span> <span class="s1">&#39;Begin MD step = &#39;</span><span class="p">,</span>
     <span class="err">$</span>           <span class="n">istep</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">cml_p</span><span class="p">)</span> <span class="k">call </span><span class="n">cmlStartStep</span><span class="p">(</span><span class="n">mainXML</span><span class="p">,</span> <span class="k">type</span><span class="o">=</span><span class="s1">&#39;MD&#39;</span><span class="p">,</span>
     <span class="err">$</span>             <span class="nb">index</span><span class="o">=</span><span class="n">istep</span><span class="p">)</span>
         <span class="n">endif</span>
      <span class="k">case</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
         <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t25,a,i6)&#39;</span><span class="p">)</span> <span class="s1">&#39;Begin MD step = &#39;</span><span class="p">,</span> <span class="n">istep</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">cml_p</span><span class="p">)</span> <span class="k">call </span><span class="n">cmlStartStep</span><span class="p">(</span><span class="n">mainXML</span><span class="p">,</span> <span class="k">type</span><span class="o">=</span><span class="s1">&#39;MD&#39;</span><span class="p">,</span> <span class="nb">index</span><span class="o">=</span><span class="n">istep</span><span class="p">)</span>
      <span class="k">case</span> <span class="p">(</span><span class="mi">6</span><span class="p">)</span>
          <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t25,a,i6)&#39;</span><span class="p">)</span> <span class="s1">&#39;Begin FC step = &#39;</span><span class="p">,</span><span class="n">istep</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">cml_p</span><span class="p">)</span> <span class="k">call </span><span class="n">cmlStartStep</span><span class="p">(</span><span class="n">mainXML</span><span class="p">,</span> <span class="k">type</span><span class="o">=</span><span class="s1">&#39;FC&#39;</span><span class="p">,</span> <span class="nb">index</span><span class="o">=</span><span class="n">istep</span><span class="p">)</span>
          
          <span class="k">if</span> <span class="p">(</span><span class="n">istep</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t25,a)&#39;</span><span class="p">)</span> <span class="s1">&#39;Undisplaced coordinates&#39;</span>
         <span class="k">else</span>
<span class="k">            </span><span class="n">iadispl</span> <span class="o">=</span> <span class="p">(</span><span class="n">istep</span><span class="o">-</span><span class="nb">mod</span><span class="p">(</span><span class="n">istep</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">/</span><span class="mi">6</span><span class="o">+</span><span class="n">ia1</span>
            <span class="n">ix</span> <span class="o">=</span> <span class="nb">mod</span><span class="p">(</span><span class="n">istep</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
            <span class="n">ixdispl</span> <span class="o">=</span> <span class="p">(</span><span class="n">ix</span> <span class="o">-</span> <span class="nb">mod</span><span class="p">(</span><span class="n">ix</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
            <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t26,a,i0,/,t26,a,i1,a,f10.6,a)&#39;</span><span class="p">)</span> <span class="s1">&#39;displace atom &#39;</span><span class="p">,</span>
     <span class="p">&amp;</span>           <span class="n">iadispl</span><span class="p">,</span><span class="s1">&#39;in direction &#39;</span><span class="p">,</span><span class="n">ixdispl</span><span class="p">,</span><span class="s1">&#39; by&#39;</span><span class="p">,</span> <span class="n">dx</span><span class="o">/</span><span class="n">Ang</span><span class="p">,</span><span class="s1">&#39; Ang&#39;</span>
         <span class="n">endif</span>
         
      <span class="k">case</span> <span class="p">(</span><span class="mi">8</span><span class="p">)</span>
         <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t25,a,i6)&#39;</span><span class="p">)</span> <span class="s1">&#39;Begin Server step = &#39;</span><span class="p">,</span><span class="n">istep</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">cml_p</span><span class="p">)</span> <span class="k">call </span><span class="n">cmlStartStep</span><span class="p">(</span><span class="n">mainXML</span><span class="p">,</span> <span class="k">type</span><span class="o">=</span><span class="s1">&#39;FS&#39;</span><span class="p">,</span> <span class="nb">index</span><span class="o">=</span><span class="n">istep</span><span class="p">)</span>
         
      <span class="k">case</span> <span class="p">(</span><span class="mi">9</span><span class="p">)</span>
         <span class="k">if</span> <span class="p">(</span> <span class="n">istep</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t25,a,i7)&#39;</span><span class="p">)</span><span class="s1">&#39;Explicit coord. initialization&#39;</span>
         <span class="k">else</span>
<span class="k">            write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t25,a,i7)&#39;</span><span class="p">)</span><span class="s1">&#39;Explicit coord. step =&#39;</span><span class="p">,</span><span class="n">istep</span>
         <span class="k">end if</span>
<span class="k">         if</span> <span class="p">(</span><span class="n">cml_p</span><span class="p">)</span> <span class="k">call </span><span class="n">cmlStartStep</span><span class="p">(</span><span class="n">mainXML</span><span class="p">,</span> <span class="k">type</span><span class="o">=</span><span class="s1">&#39;ECS&#39;</span><span class="p">,</span> <span class="nb">index</span><span class="o">=</span><span class="n">istep</span><span class="p">)</span>
         
      <span class="k">case</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span>
         <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t25,a,i7)&#39;</span><span class="p">)</span><span class="s1">&#39;LUA coord. step =&#39;</span><span class="p">,</span><span class="n">istep</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">cml_p</span><span class="p">)</span> <span class="k">call </span><span class="n">cmlStartStep</span><span class="p">(</span><span class="n">mainXML</span><span class="p">,</span> <span class="k">type</span><span class="o">=</span><span class="s1">&#39;LUA&#39;</span><span class="p">,</span> <span class="nb">index</span><span class="o">=</span><span class="n">istep</span><span class="p">)</span>
         
      <span class="k">end select</span>
<span class="k">      </span>
<span class="k">      write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t22,a)&#39;</span><span class="p">)</span> <span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">,</span><span class="mi">36</span><span class="p">)</span>
      
<span class="c">!     Print atomic coordinates</span>
      <span class="k">call </span><span class="n">outcoor</span><span class="p">(</span> <span class="n">ucell</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">writec</span> <span class="p">)</span>

<span class="c">!     Save structural information in crystallographic format</span>
<span class="c">!     (in file SystemLabel.STRUCT_OUT),</span>
<span class="c">!     canonical Zmatrix (if applicable), and CML record</span>
      
      <span class="k">call </span><span class="n">siesta_write_positions</span><span class="p">(</span><span class="n">moved</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.)</span>
       
      <span class="n">endif</span> <span class="c">! IONode</span>

      <span class="c">! Write the XV file for single-point calculations, so that</span>
      <span class="c">! it is there at the end for those users who rely on it</span>
      <span class="k">call </span><span class="n">ioxv</span><span class="p">(</span> <span class="s1">&#39;write&#39;</span><span class="p">,</span> <span class="n">ucell</span><span class="p">,</span> <span class="n">vcell</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">isa</span><span class="p">,</span> <span class="n">iza</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">va</span><span class="p">,</span> 
     <span class="p">&amp;</span>           <span class="n">foundxv</span><span class="p">)</span>
      <span class="c">! Write TDXV file for TDDFT restart.</span>
      <span class="k">if</span><span class="p">(</span><span class="n">writetdwf</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">td_elec_dyn</span><span class="p">)</span> <span class="k">then</span>
<span class="k">      call </span><span class="n">iotdxv</span><span class="p">(</span><span class="s1">&#39;write&#39;</span><span class="p">,</span><span class="n">ucell</span><span class="p">,</span><span class="n">vcell</span><span class="p">,</span><span class="n">na_u</span><span class="p">,</span><span class="n">isa</span><span class="p">,</span><span class="n">iza</span><span class="p">,</span><span class="n">xa</span><span class="p">,</span><span class="n">va</span><span class="p">,</span><span class="n">foundxv</span><span class="p">)</span>
      <span class="k">end if</span>  

<span class="c">!     Actualize things if variable cell </span>
      <span class="n">auxchanged</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
      <span class="n">cell_can_change</span> <span class="o">=</span> <span class="p">(</span> <span class="n">varcel</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>
     <span class="p">&amp;</span>                    <span class="p">(</span><span class="n">idyn</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">8</span><span class="p">)</span>  <span class="c">! Force/stress evaluation</span>
     <span class="p">&amp;</span>                  <span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">change_kgrid_in_md</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         </span><span class="n">cell_can_change</span> <span class="o">=</span> <span class="n">cell_can_change</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>
     <span class="p">&amp;</span>                     <span class="p">(</span><span class="n">idyn</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">3</span><span class="p">)</span>   <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="c">! Parrinello-Rahman</span>
     <span class="p">&amp;</span>                     <span class="p">(</span><span class="n">idyn</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">4</span><span class="p">)</span>   <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="c">! Nose-Parrinello-Rahman</span>
     <span class="p">&amp;</span>                     <span class="p">(</span><span class="n">idyn</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">5</span><span class="p">)</span>        <span class="c">! Anneal</span>
      <span class="n">endif</span>

      <span class="k">if</span> <span class="p">(</span> <span class="n">cell_can_change</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>
     <span class="p">&amp;</span>     <span class="p">(</span><span class="n">istep</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">inicoor</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="nb">gamma</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>

<span class="c">!       Will print k-points also</span>
        <span class="k">call </span><span class="n">kpoint_delete</span><span class="p">(</span><span class="n">kpoints_scf</span><span class="p">)</span>
        <span class="k">call </span><span class="n">setup_kpoint_scf</span><span class="p">(</span> <span class="n">ucell</span> <span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span> <span class="n">TSmode</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">          call </span><span class="n">kpoint_delete</span><span class="p">(</span> <span class="n">ts_kpoints_scf</span> <span class="p">)</span>
        <span class="k">else</span>
<span class="k">          call </span><span class="n">kpoint_nullify</span><span class="p">(</span> <span class="n">ts_kpoints_scf</span> <span class="p">)</span>
        <span class="k">end if</span>
<span class="k">        call </span><span class="n">setup_ts_kpoint_scf</span><span class="p">(</span> <span class="n">ucell</span><span class="p">,</span> <span class="n">kpoints_scf</span> <span class="p">)</span>

        <span class="k">call </span><span class="n">re_alloc</span><span class="p">(</span> <span class="n">eo</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">spinor</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kpoints_scf</span><span class="p">%</span><span class="n">N</span><span class="p">,</span>
     <span class="p">&amp;</span>                 <span class="s1">&#39;eo&#39;</span><span class="p">,</span> <span class="s1">&#39;state_init&#39;</span><span class="p">)</span>
        <span class="k">call </span><span class="n">re_alloc</span><span class="p">(</span> <span class="n">qo</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">spinor</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kpoints_scf</span><span class="p">%</span><span class="n">N</span><span class="p">,</span> 
     <span class="p">&amp;</span>                 <span class="s1">&#39;qo&#39;</span><span class="p">,</span> <span class="s1">&#39;state_init&#39;</span> <span class="p">)</span>

<span class="c">!       Find required supercell</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">gamma</span><span class="p">)</span> <span class="k">then</span>
<span class="k">           </span><span class="n">nsc</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span>
<span class="k">           do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="mi">3</span>
              <span class="n">veclen</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="n">ucell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">ucell</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">ucell</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
              <span class="n">nsc</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">ceiling</span><span class="p">(</span> <span class="n">rmaxh</span> <span class="o">/</span> <span class="n">veclen</span> <span class="p">)</span>
           <span class="k">end do</span>
           <span class="c">! The above is kept for historical reasons,</span>
           <span class="c">! but a tight supercell can be found from the atom-graph info:</span>
           <span class="k">call </span><span class="n">exact_sc_ag</span><span class="p">(</span><span class="n">negl</span><span class="p">,</span><span class="n">ucell</span><span class="p">,</span><span class="n">na_u</span><span class="p">,</span><span class="n">isa</span><span class="p">,</span><span class="n">xa</span><span class="p">,</span><span class="n">nsc</span><span class="p">)</span>
        <span class="n">endif</span>

        <span class="n">mscell</span> <span class="o">=</span> <span class="mf">0.0_dp</span>
        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span>
           <span class="n">mscell</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">nsc</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
           <span class="k">if</span> <span class="p">(</span><span class="n">nsc</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">/=</span> <span class="n">nscold</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="n">auxchanged</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
           <span class="n">nscold</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">nsc</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">enddo</span>

<span class="c">!       Madelung correction for charged systems </span>
        <span class="k">if</span> <span class="p">(</span><span class="n">charnet</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mf">0.0_dp</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          call </span><span class="n">madelung</span><span class="p">(</span><span class="n">ucell</span><span class="p">,</span> <span class="nb">shape</span><span class="p">,</span> <span class="n">charnet</span><span class="p">,</span> <span class="n">Emad</span><span class="p">)</span>
        <span class="n">endif</span>

      <span class="n">endif</span>
<span class="c">!     End variable cell actualization</span>

<span class="c">!     Auxiliary supercell</span>
<span class="c">!     Do not move from here, as the coordinates might have changed</span>
<span class="c">!     even if not the unit cell</span>
      <span class="k">call </span><span class="n">superc</span><span class="p">(</span><span class="n">ucell</span><span class="p">,</span> <span class="n">scell</span><span class="p">,</span> <span class="n">nsc</span><span class="p">)</span>
<span class="cp">#ifdef SIESTA__FLOOK</span>
      <span class="k">call </span><span class="n">dict_repopulate_MD</span><span class="p">()</span>
<span class="cp">#endif</span>

<span class="c">!     Print unit cell and compute cell volume</span>
<span class="c">!     Possible BUG: </span>
<span class="c">!     Note that this volume is later used in write_subs and the md output</span>
<span class="c">!     routines, even if the cell later changes.</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">IOnode</span><span class="p">)</span> <span class="k">call </span><span class="n">outcell</span><span class="p">(</span><span class="n">ucell</span><span class="p">)</span>
      <span class="n">volume_of_some_cell</span> <span class="o">=</span> <span class="n">volcel</span><span class="p">(</span><span class="n">ucell</span><span class="p">)</span>

<span class="c">!     Use largest possible range in program, except hsparse...</span>
<span class="c">!     2 * rmaxv: Vna overlap</span>
<span class="c">!     rmaxo + rmaxkb: Non-local KB action</span>
<span class="c">!     2 * (rmaxo + rmaxldau): Interaction through LDAU projector</span>
<span class="c">!     2.0_dp * (rmaxo+rmaxkb) : Orbital interaction through KB projectors</span>
      <span class="n">rmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span> <span class="mf">2._dp</span><span class="o">*</span><span class="n">rmaxv</span><span class="p">,</span> <span class="mf">2._dp</span><span class="o">*</span><span class="p">(</span><span class="n">rmaxo</span><span class="o">+</span><span class="n">rmaxldau</span><span class="p">),</span> <span class="n">rmaxo</span><span class="o">+</span><span class="n">rmaxkb</span><span class="p">)</span>

      <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">negl</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">        </span><span class="n">rmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">rmax</span><span class="p">,</span> <span class="mf">2.0_dp</span> <span class="o">*</span> <span class="p">(</span><span class="n">rmaxo</span><span class="o">+</span><span class="n">rmaxkb</span><span class="p">)</span> <span class="p">)</span>
      <span class="n">endif</span>

<span class="c">!     Check if any two atoms are unreasonably close</span>
      <span class="k">call </span><span class="n">proximity_check</span><span class="p">(</span><span class="n">rmax</span><span class="p">)</span>

      <span class="c">! Clear history of mixing parameters</span>
      <span class="k">call </span><span class="n">mixers_history_init</span><span class="p">(</span> <span class="n">scf_mixs</span> <span class="p">)</span>
      <span class="n">scf_mix</span> <span class="o">=&gt;</span> <span class="n">scf_mixs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

      <span class="c">! Ensure sparsity pattern is empty</span>
      <span class="k">call </span><span class="n">delete</span><span class="p">(</span><span class="n">sparse_pattern</span><span class="p">)</span>
      <span class="c">! sadly deleting the sparse pattern does not necessarily</span>
      <span class="c">! mean that the arrays are de-associated.</span>
      <span class="c">! Remember that the reference counter could (in MD)</span>
      <span class="c">! be higher than 1, hence we need to create &quot;fake&quot;</span>
      <span class="c">! containers and let the new&lt;class&gt; delete the old</span>
      <span class="c">! sparsity pattern</span>

      <span class="k">nullify</span><span class="p">(</span><span class="n">numh</span><span class="p">,</span><span class="n">listhptr</span><span class="p">,</span><span class="n">listh</span><span class="p">)</span>
      <span class="k">allocate</span><span class="p">(</span><span class="n">numh</span><span class="p">(</span><span class="n">no_l</span><span class="p">),</span><span class="n">listhptr</span><span class="p">(</span><span class="n">no_l</span><span class="p">))</span>
      <span class="c">! We do not need to allocate listh</span>
      <span class="c">! that will be allocated in hsparse</span>

<span class="cp">#ifdef SIESTA__CHESS</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">isolve</span> <span class="o">==</span> <span class="n">SOLVE_CHESS</span><span class="p">)</span> <span class="k">then</span>
<span class="c">!         Calculate a sparsity pattern with some buffers... Only required</span>
<span class="c">!         for CheSS</span>
          <span class="n">chess_value</span> <span class="o">=</span> <span class="n">get_chess_parameter</span><span class="p">(</span><span class="s1">&#39;chess_buffer_kernel&#39;</span><span class="p">)</span>
          <span class="k">call </span><span class="n">hsparse</span><span class="p">(</span> <span class="n">negl</span><span class="p">,</span> <span class="n">scell</span><span class="p">,</span> <span class="n">nsc</span><span class="p">,</span> <span class="n">na_s</span><span class="p">,</span> <span class="n">isa</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span>
     <span class="p">&amp;</span>              <span class="n">lastkb</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span> <span class="n">iphKB</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="nb">gamma</span><span class="p">,</span> 
     <span class="p">&amp;</span>              <span class="n">set_xijo</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.,</span> <span class="n">folding</span><span class="o">=</span><span class="n">folding1</span><span class="p">,</span>
     <span class="err">$</span>              <span class="n">diagonal_folding</span><span class="o">=</span><span class="n">diag_folding1</span><span class="p">,</span>
     <span class="err">$</span>              <span class="n">buffer</span><span class="o">=</span><span class="n">chess_value</span><span class="p">)</span>
          <span class="n">maxnh_kernel</span> <span class="o">=</span> <span class="n">maxnh</span>
          <span class="n">no_l_kernel</span> <span class="o">=</span> <span class="n">no_l</span>
          <span class="k">allocate</span><span class="p">(</span><span class="n">listh_kernel</span><span class="p">(</span><span class="n">maxnh_kernel</span><span class="p">))</span>
          <span class="k">allocate</span><span class="p">(</span><span class="n">numh_kernel</span><span class="p">(</span><span class="n">no_l_kernel</span><span class="p">))</span>
          <span class="n">listh_kernel</span> <span class="o">=</span> <span class="n">listh</span>
          <span class="n">numh_kernel</span> <span class="o">=</span> <span class="n">numh</span>
    
          <span class="n">chess_value</span> <span class="o">=</span> <span class="n">get_chess_parameter</span><span class="p">(</span><span class="s1">&#39;chess_buffer_mult&#39;</span><span class="p">)</span>
          <span class="k">call </span><span class="n">hsparse</span><span class="p">(</span> <span class="n">negl</span><span class="p">,</span> <span class="n">scell</span><span class="p">,</span> <span class="n">nsc</span><span class="p">,</span> <span class="n">na_s</span><span class="p">,</span> <span class="n">isa</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span>
     <span class="p">&amp;</span>                  <span class="n">lastkb</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span> <span class="n">iphKB</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="nb">gamma</span><span class="p">,</span>
     <span class="p">&amp;</span>                  <span class="n">set_xijo</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.,</span> <span class="n">folding</span><span class="o">=</span><span class="n">folding1</span><span class="p">,</span>
     <span class="err">$</span>                  <span class="n">diagonal_folding</span><span class="o">=</span><span class="n">diag_folding1</span><span class="p">,</span>
     <span class="err">$</span>                  <span class="n">buffer</span><span class="o">=</span><span class="n">chess_value</span><span class="p">)</span>
          <span class="n">maxnh_mult</span> <span class="o">=</span> <span class="n">maxnh</span>
          <span class="n">no_l_mult</span> <span class="o">=</span> <span class="n">no_l</span>
          <span class="k">allocate</span><span class="p">(</span><span class="n">listh_mult</span><span class="p">(</span><span class="n">maxnh_mult</span><span class="p">))</span>
          <span class="k">allocate</span><span class="p">(</span><span class="n">numh_mult</span><span class="p">(</span><span class="n">no_l_mult</span><span class="p">))</span>
          <span class="n">listh_mult</span> <span class="o">=</span> <span class="n">listh</span>
          <span class="n">numh_mult</span> <span class="o">=</span> <span class="n">numh</span>
      <span class="k">end if</span>
<span class="cp">#endif /* CHESS */</span>

<span class="c">!     List of nonzero Hamiltonian matrix elements</span>
<span class="c">!     and, if applicable,  vectors between orbital centers</span>

<span class="c">!     Listh and xijo are allocated inside hsparse</span>
<span class="c">!     Note: We always generate xijo now, for COOP and other</span>
<span class="c">!           analyses.</span>
      <span class="k">call </span><span class="n">delete</span><span class="p">(</span><span class="n">xij_2D</span><span class="p">)</span> <span class="c">! as xijo will be reallocated</span>
      <span class="k">nullify</span><span class="p">(</span><span class="n">xijo</span><span class="p">)</span>
      <span class="k">call </span><span class="n">hsparse</span><span class="p">(</span> <span class="n">negl</span><span class="p">,</span> <span class="n">scell</span><span class="p">,</span> <span class="n">nsc</span><span class="p">,</span> <span class="n">na_s</span><span class="p">,</span> <span class="n">isa</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span>
     <span class="p">&amp;</span>              <span class="n">lastkb</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span> <span class="n">iphKB</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="nb">gamma</span><span class="p">,</span>
     <span class="err">$</span>              <span class="n">set_xijo</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.,</span> <span class="n">folding</span><span class="o">=</span><span class="n">folding1</span><span class="p">,</span>
     <span class="err">$</span>              <span class="n">diagonal_folding</span><span class="o">=</span><span class="n">diag_folding1</span><span class="p">,</span>
     <span class="err">$</span>              <span class="n">debug_folding</span><span class="o">=</span><span class="n">fdf_get</span><span class="p">(</span><span class="s1">&#39;debug-folding&#39;</span><span class="p">,.</span><span class="n">false</span><span class="p">.))</span>
<span class="c">!</span>
      <span class="k">call </span><span class="n">globalize_or</span><span class="p">(</span><span class="n">diag_folding1</span><span class="p">,</span><span class="n">diag_folding</span><span class="p">)</span>
      <span class="k">call </span><span class="n">globalize_or</span><span class="p">(</span><span class="n">folding1</span><span class="p">,</span><span class="n">folding</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">diag_folding</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="nb">gamma</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">message</span><span class="p">(</span><span class="s2">&quot;WARNING&quot;</span><span class="p">,</span><span class="s2">&quot;Gamma-point calculation &quot;</span> <span class="o">//</span>
     <span class="err">$</span>         <span class="s2">&quot;with interaction between periodic images&quot;</span><span class="p">)</span>
         <span class="k">call </span><span class="n">message</span><span class="p">(</span><span class="s2">&quot;WARNING&quot;</span><span class="p">,</span>
     <span class="err">$</span>           <span class="s2">&quot;Some features might not work optimally:&quot;</span><span class="p">)</span>
         <span class="k">call </span><span class="n">message</span><span class="p">(</span><span class="s2">&quot;WARNING&quot;</span><span class="p">,</span>
     <span class="err">$</span>           <span class="s2">&quot;e.g. DM initialization from atomic data&quot;</span><span class="p">)</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">harrisfun</span><span class="p">)</span> <span class="k">call </span><span class="n">die</span><span class="p">(</span><span class="s2">&quot;Harris functional run needs &quot;</span> <span class="o">//</span>
     <span class="err">$</span>                              <span class="s2">&quot;&#39;force-aux-cell T&#39;&quot;</span><span class="p">)</span>

      <span class="k">else if</span> <span class="p">(</span><span class="n">folding</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         if</span> <span class="p">(</span><span class="nb">gamma</span><span class="p">)</span> <span class="k">then</span>
<span class="k">               call </span><span class="n">message</span><span class="p">(</span><span class="s2">&quot;INFO&quot;</span><span class="p">,</span><span class="s2">&quot;Gamma-point calculation &quot;</span> <span class="o">//</span>
     <span class="err">$</span>                      <span class="s2">&quot;with multiply-connected orbital pairs&quot;</span><span class="p">)</span>
               <span class="k">call </span><span class="n">message</span><span class="p">(</span><span class="s2">&quot;INFO&quot;</span><span class="p">,</span>
     <span class="err">$</span>              <span class="s2">&quot;Folding of H and S implicitly performed&quot;</span><span class="p">)</span>
               <span class="k">call </span><span class="n">check_cohp</span><span class="p">()</span>
         <span class="k">else</span>
<span class="k">            write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s2">&quot;(a,/,a)&quot;</span><span class="p">)</span> <span class="s2">&quot;Non Gamma-point calculation &quot;</span> <span class="o">//</span>
     <span class="err">$</span>           <span class="s2">&quot;with multiply-connected orbital pairs &quot;</span> <span class="o">//</span>
     <span class="err">$</span>           <span class="s2">&quot;in auxiliary supercell.&quot;</span><span class="p">,</span>
     <span class="err">$</span>           <span class="s2">&quot;Possible internal error. &quot;</span> <span class="o">//</span>
     <span class="err">$</span>           <span class="s2">&quot;Use &#39;debug-folding T&#39; to debug.&quot;</span>
            <span class="k">call </span><span class="n">die</span><span class="p">(</span><span class="s2">&quot;Inadequate auxiliary supercell&quot;</span><span class="p">)</span>
         <span class="n">endif</span>
      <span class="n">endif</span>
<span class="c">!</span>
      <span class="k">call </span><span class="n">globalize_sum</span><span class="p">(</span><span class="n">maxnh</span><span class="p">,</span><span class="n">nnz</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">cml_p</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">cmlStartPropertyList</span><span class="p">(</span><span class="n">mainXML</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Orbital info&#39;</span><span class="p">)</span>
         <span class="k">call </span><span class="n">cmlAddProperty</span><span class="p">(</span><span class="n">xf</span><span class="o">=</span><span class="n">mainXML</span><span class="p">,</span> <span class="k">value</span><span class="o">=</span><span class="n">no_u</span><span class="p">,</span>
     <span class="err">$</span>        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Number of orbitals in unit cell&#39;</span><span class="p">,</span>
     <span class="err">$</span>        <span class="n">dictref</span><span class="o">=</span><span class="s1">&#39;siesta:no_u&#39;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;cmlUnits:countable&quot;</span><span class="p">)</span>
         <span class="k">call </span><span class="n">cmlAddProperty</span><span class="p">(</span><span class="n">xf</span><span class="o">=</span><span class="n">mainXML</span><span class="p">,</span> <span class="k">value</span><span class="o">=</span><span class="n">nnz</span><span class="p">,</span>
     <span class="err">$</span>        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Number of non-zeros&#39;</span><span class="p">,</span>
     <span class="err">$</span>        <span class="n">dictref</span><span class="o">=</span><span class="s1">&#39;siesta:nnz&#39;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;cmlUnits:countable&quot;</span><span class="p">)</span>
         <span class="k">call </span><span class="n">cmlEndPropertyList</span><span class="p">(</span><span class="n">mainXML</span><span class="p">)</span>
      <span class="n">endif</span>
      <span class="c">!</span>
<span class="cp">#ifdef SIESTA__CHESS</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">isolve</span> <span class="o">==</span> <span class="n">SOLVE_CHESS</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          call </span><span class="n">CheSS_init</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">nodes</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">maxnh_kernel</span><span class="p">,</span> <span class="n">maxnh_mult</span><span class="p">,</span> 
     <span class="p">&amp;</span>         <span class="n">no_u</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">no_l_kernel</span><span class="p">,</span> <span class="n">no_l_mult</span><span class="p">,</span> <span class="n">BlockSize</span><span class="p">,</span> 
     <span class="p">&amp;</span>         <span class="n">spin</span><span class="p">%</span><span class="n">spinor</span><span class="p">,</span> <span class="n">qtots</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">listh_kernel</span><span class="p">,</span> <span class="n">listh_mult</span><span class="p">,</span> 
     <span class="p">&amp;</span>         <span class="n">numh</span><span class="p">,</span> <span class="n">numh_kernel</span><span class="p">,</span> <span class="n">numh_mult</span><span class="p">)</span>
          <span class="k">deallocate</span><span class="p">(</span><span class="n">listh_kernel</span><span class="p">)</span>
          <span class="k">deallocate</span><span class="p">(</span><span class="n">numh_kernel</span><span class="p">)</span>
          <span class="k">deallocate</span><span class="p">(</span><span class="n">listh_mult</span><span class="p">)</span>
          <span class="k">deallocate</span><span class="p">(</span><span class="n">numh_mult</span><span class="p">)</span>
      <span class="k">end if</span>
<span class="cp">#endif /* CHESS */</span>
      <span class="c">!</span>
      <span class="c">! If using domain decomposition, redistribute orbitals</span>
      <span class="c">! for this geometry, based on the hsparse info. </span>
      <span class="c">! The first time round, the initial distribution is a</span>
      <span class="c">! simple block one (given by preSetOrbitLimits).</span>
      <span class="c">!</span>
      <span class="c">! Any DM, etc, read from file will be redistributed according</span>
      <span class="c">! to the new pattern. </span>
      <span class="c">! Inherited DMs from a previous geometry cannot be used if the</span>
      <span class="c">! orbital distribution changes. For now, we avoid changing the</span>
      <span class="c">! distribution (the variable use_dd_perm is .true. if domain</span>
      <span class="c">! decomposition is in effect). Names should be changed...</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">use_dd</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">use_dd_perm</span><span class="p">))</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">domainDecom</span><span class="p">(</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">maxnh</span> <span class="p">)</span>  <span class="c">! maxnh intent(in) here</span>
         <span class="n">maxnh</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">numh</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">no_l</span><span class="p">))</span>
         <span class="c">! We still need to re-create Julian Gale&#39;s</span>
         <span class="c">! indexing for O(N) in parallel.</span>
         <span class="k">print</span> <span class="s2">&quot;(a5,i3,a20,3i8)&quot;</span><span class="p">,</span>
     <span class="err">$</span>         <span class="s2">&quot;Node: &quot;</span><span class="p">,</span> <span class="n">Node</span><span class="p">,</span> <span class="s2">&quot;no_u, no_l, maxnh: &quot;</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">maxnh</span>
         <span class="k">call </span><span class="n">setup_ordern_indexes</span><span class="p">(</span><span class="n">no_l</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">Nodes</span><span class="p">)</span>
      <span class="n">endif</span>

      <span class="c">! I would like to skip this alloc/move/dealloc/attach</span>
      <span class="c">! by allowing sparsity to have pointer targets.</span>
      <span class="c">! However, this poses a problem with intel compilers,</span>
      <span class="c">! as it apparently errors out when de-allocating a target pointer</span>
      <span class="k">write</span><span class="p">(</span><span class="n">oname</span><span class="p">,</span><span class="s2">&quot;(a,i0)&quot;</span><span class="p">)</span> <span class="s2">&quot;sparsity for geom step &quot;</span><span class="p">,</span> <span class="n">istep</span>
      <span class="k">call </span><span class="n">newSparsity</span><span class="p">(</span><span class="n">sparse_pattern</span><span class="p">,</span><span class="n">no_l</span><span class="p">,</span><span class="n">no_u</span><span class="p">,</span><span class="n">maxnh</span><span class="p">,</span>
     <span class="p">&amp;</span>     <span class="n">numh</span><span class="p">,</span><span class="n">listhptr</span><span class="p">,</span><span class="n">listh</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="n">oname</span><span class="p">)</span>
      <span class="k">deallocate</span><span class="p">(</span><span class="n">numh</span><span class="p">,</span><span class="n">listhptr</span><span class="p">,</span><span class="n">listh</span><span class="p">)</span>
      <span class="k">call </span><span class="n">attach</span><span class="p">(</span><span class="n">sparse_pattern</span><span class="p">,</span> 
     <span class="p">&amp;</span>     <span class="n">n_col</span> <span class="o">=</span> <span class="n">numh</span><span class="p">,</span> <span class="n">list_ptr</span> <span class="o">=</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">list_col</span> <span class="o">=</span> <span class="n">listh</span> <span class="p">)</span>

      <span class="c">! In case the user requests to create the connectivity graph</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">write_GRAPHVIZ</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">then</span>
         <span class="c">! first create the unit-cell sparsity pattern</span>
         <span class="k">call </span><span class="n">crtSparsity_SC</span><span class="p">(</span><span class="n">sparse_pattern</span><span class="p">,</span> <span class="n">g_Sp</span><span class="p">,</span> <span class="n">UC</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
         <span class="c">! next move to global sparsity pattern</span>
         <span class="k">call </span><span class="n">Sp_to_Spglobal</span><span class="p">(</span><span class="n">block_dist</span><span class="p">,</span> <span class="n">g_Sp</span><span class="p">,</span> <span class="n">g_Sp</span><span class="p">)</span>
         <span class="k">if</span> <span class="p">(</span> <span class="n">IONode</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            if</span> <span class="p">(</span> <span class="n">write_GRAPHVIZ</span> <span class="o">/=</span> <span class="mi">2</span> <span class="p">)</span>
     <span class="p">&amp;</span>           <span class="k">call </span><span class="n">sp2graphviz</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.ORB.gv&#39;</span><span class="p">,</span> <span class="n">g_Sp</span><span class="p">)</span>
            <span class="c">! Convert to atomic </span>
            <span class="k">if</span> <span class="p">(</span> <span class="n">write_GRAPHVIZ</span> <span class="o">/=</span> <span class="mi">1</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">               call </span><span class="n">SpOrb_to_SpAtom</span><span class="p">(</span><span class="n">single_dist</span><span class="p">,</span><span class="n">g_Sp</span><span class="p">,</span><span class="n">na_u</span><span class="p">,</span><span class="n">lasto</span><span class="p">,</span><span class="n">g_Sp</span><span class="p">)</span>
               <span class="k">call </span><span class="n">sp2graphviz</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.ATOM.gv&#39;</span><span class="p">,</span> <span class="n">g_Sp</span><span class="p">)</span>
            <span class="k">end if</span>
<span class="k">         end if</span>
<span class="k">         call </span><span class="n">delete</span><span class="p">(</span><span class="n">g_Sp</span><span class="p">)</span>
      <span class="k">end if</span>

             
      <span class="c">! Copy over xijo array (we can first do it here... :( )</span>
      <span class="k">call </span><span class="n">newdData2D</span><span class="p">(</span><span class="n">tmp_2D</span><span class="p">,</span><span class="n">xijo</span><span class="p">,</span><span class="s1">&#39;xijo&#39;</span><span class="p">)</span>
      <span class="k">deallocate</span><span class="p">(</span><span class="n">xijo</span><span class="p">)</span>
      <span class="k">write</span><span class="p">(</span><span class="n">oname</span><span class="p">,</span><span class="s2">&quot;(a,i0)&quot;</span><span class="p">)</span> <span class="s2">&quot;xijo at geom step &quot;</span><span class="p">,</span> <span class="n">istep</span>
      <span class="k">call </span><span class="n">newdSpData2D</span><span class="p">(</span><span class="n">sparse_pattern</span><span class="p">,</span><span class="n">tmp_2D</span><span class="p">,</span><span class="n">block_dist</span><span class="p">,</span><span class="n">xij_2D</span><span class="p">,</span> 
     <span class="p">&amp;</span>     <span class="n">name</span><span class="o">=</span><span class="n">oname</span><span class="p">)</span>
      <span class="k">call </span><span class="n">delete</span><span class="p">(</span><span class="n">tmp_2D</span><span class="p">)</span> <span class="c">! decrement container...</span>
      <span class="n">xijo</span> <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">xij_2D</span><span class="p">)</span>

      <span class="c">! Calculate the super-cell offsets...</span>
      <span class="k">if</span> <span class="p">(</span> <span class="nb">Gamma</span> <span class="p">)</span> <span class="k">then</span>
         <span class="c">! Here we create the super-cell offsets</span>
         <span class="k">call </span><span class="n">re_alloc</span><span class="p">(</span><span class="n">isc_off</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">isc_off</span><span class="p">(:,:)</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="k">else</span>
<span class="k">         call </span><span class="n">xij_offset</span><span class="p">(</span><span class="n">ucell</span><span class="p">,</span><span class="n">nsc</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span><span class="n">xa</span><span class="p">,</span><span class="n">lasto</span><span class="p">,</span> 
     <span class="p">&amp;</span>        <span class="n">xij_2D</span><span class="p">,</span> <span class="n">isc_off</span><span class="p">,</span>
     <span class="p">&amp;</span>        <span class="n">Bcast</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
      <span class="k">end if</span>

      
      <span class="c">! When the user requests to only do an analyzation, we can call</span>
      <span class="c">! appropriate routines and quit</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">TS_Analyze</span> <span class="p">)</span> <span class="k">then</span>

         <span class="c">! Force the creation of the full sparsity pattern</span>
         <span class="k">call </span><span class="n">ts_sparse_init</span><span class="p">(</span><span class="n">slabel</span><span class="p">,</span><span class="n">IsVolt</span><span class="p">,</span> <span class="n">N_Elec</span><span class="p">,</span> <span class="n">Elecs</span><span class="p">,</span> 
     <span class="p">&amp;</span>        <span class="n">ucell</span><span class="p">,</span> <span class="n">nsc</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span> <span class="n">block_dist</span><span class="p">,</span> <span class="n">sparse_pattern</span><span class="p">,</span> 
     <span class="p">&amp;</span>        <span class="nb">Gamma</span><span class="p">,</span> <span class="n">isc_off</span><span class="p">)</span>

         <span class="c">! create the tri-diagonal matrix</span>
         <span class="k">call </span><span class="n">ts_tri_analyze</span><span class="p">(</span> <span class="n">block_dist</span><span class="p">,</span> <span class="n">sparse_pattern</span> <span class="p">,</span> <span class="n">N_Elec</span><span class="p">,</span>
     <span class="p">&amp;</span>        <span class="n">Elecs</span><span class="p">,</span> <span class="n">ucell</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span> <span class="n">nsc</span><span class="p">,</span> <span class="n">isc_off</span><span class="p">,</span>
     <span class="p">&amp;</span>        <span class="n">BTD_method</span> <span class="p">)</span>

         <span class="c">! Print-out timers</span>
         <span class="k">call </span><span class="n">timer</span><span class="p">(</span><span class="s1">&#39;TS-rgn2tri&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>

         <span class="c">! Bye also waits for all processors</span>
         <span class="k">call </span><span class="n">bye</span><span class="p">(</span><span class="s1">&#39;transiesta analyzation performed&#39;</span><span class="p">)</span>
         
      <span class="k">end if</span>


<span class="k">      write</span><span class="p">(</span><span class="n">oname</span><span class="p">,</span><span class="s2">&quot;(a,i0)&quot;</span><span class="p">)</span> <span class="s2">&quot;EDM at geom step &quot;</span><span class="p">,</span> <span class="n">istep</span>
      <span class="k">call </span><span class="n">newdSpData2D</span><span class="p">(</span><span class="n">sparse_pattern</span><span class="p">,</span><span class="n">spin</span><span class="p">%</span><span class="n">EDM</span><span class="p">,</span><span class="n">block_dist</span><span class="p">,</span><span class="n">EDM_2D</span><span class="p">,</span>
     <span class="p">&amp;</span>     <span class="n">name</span><span class="o">=</span><span class="n">oname</span><span class="p">)</span>
      <span class="c">!if (ionode) call print_type(EDM_2D)</span>
      <span class="n">Escf</span> <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">EDM_2D</span><span class="p">)</span>

      <span class="k">call </span><span class="n">re_alloc</span><span class="p">(</span><span class="n">Dold</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">maxnh</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">spin</span><span class="p">%</span><span class="n">DM</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Dold&#39;</span><span class="p">,</span>
     <span class="p">.</span>     <span class="n">routine</span><span class="o">=</span><span class="s1">&#39;sparseMat&#39;</span><span class="p">,</span><span class="n">copy</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span><span class="n">shrink</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
      <span class="k">call </span><span class="n">re_alloc</span><span class="p">(</span><span class="n">Hold</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">maxnh</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Hold&#39;</span><span class="p">,</span>
     <span class="p">.</span>     <span class="n">routine</span><span class="o">=</span><span class="s1">&#39;sparseMat&#39;</span><span class="p">,</span><span class="n">copy</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span><span class="n">shrink</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">converge_EDM</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">re_alloc</span><span class="p">(</span><span class="n">Eold</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">maxnh</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">spin</span><span class="p">%</span><span class="n">EDM</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Eold&#39;</span><span class="p">,</span>
     <span class="p">.</span>     <span class="n">routine</span><span class="o">=</span><span class="s1">&#39;sparseMat&#39;</span><span class="p">,</span><span class="n">copy</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span><span class="n">shrink</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
      <span class="k">end if</span>

<span class="c">!     Allocate/reallocate storage associated with Hamiltonian/Overlap matrix</span>
      <span class="k">write</span><span class="p">(</span><span class="n">oname</span><span class="p">,</span><span class="s2">&quot;(a,i0)&quot;</span><span class="p">)</span> <span class="s2">&quot;H at geom step &quot;</span><span class="p">,</span> <span class="n">istep</span>
      <span class="k">call </span><span class="n">newdSpData2D</span><span class="p">(</span><span class="n">sparse_pattern</span><span class="p">,</span><span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span><span class="n">block_dist</span><span class="p">,</span><span class="n">H_2D</span><span class="p">,</span>
     <span class="p">&amp;</span>                  <span class="n">name</span><span class="o">=</span><span class="n">oname</span><span class="p">)</span>
      <span class="c">!if (ionode) call print_type(H_2D)</span>
      <span class="n">H</span> <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">H_2D</span><span class="p">)</span>

      <span class="k">write</span><span class="p">(</span><span class="n">oname</span><span class="p">,</span><span class="s2">&quot;(a,i0)&quot;</span><span class="p">)</span> <span class="s2">&quot;H_vkb at geom step &quot;</span><span class="p">,</span> <span class="n">istep</span>
      <span class="k">call </span><span class="n">newdSpData1D</span><span class="p">(</span><span class="n">sparse_pattern</span><span class="p">,</span><span class="n">block_dist</span><span class="p">,</span><span class="n">H_vkb_1D</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="n">oname</span><span class="p">)</span>
      <span class="c">!if (ionode) call print_type(H_vkb_1D)</span>

      <span class="k">write</span><span class="p">(</span><span class="n">oname</span><span class="p">,</span><span class="s2">&quot;(a,i0)&quot;</span><span class="p">)</span> <span class="s2">&quot;H_kin at geom step &quot;</span><span class="p">,</span> <span class="n">istep</span>
      <span class="k">call </span><span class="n">newdSpData1D</span><span class="p">(</span><span class="n">sparse_pattern</span><span class="p">,</span><span class="n">block_dist</span><span class="p">,</span><span class="n">H_kin_1D</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="n">oname</span><span class="p">)</span>
      <span class="c">!if (ionode) call print_type(H_kin_1D)</span>

      <span class="k">if</span> <span class="p">(</span> <span class="n">switch_ldau</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">         write</span><span class="p">(</span><span class="n">oname</span><span class="p">,</span><span class="s2">&quot;(a,i0)&quot;</span><span class="p">)</span> <span class="s2">&quot;H_ldau at geom step &quot;</span><span class="p">,</span> <span class="n">istep</span>
         <span class="k">call </span><span class="n">newdSpData2D</span><span class="p">(</span><span class="n">sparse_pattern</span><span class="p">,</span><span class="n">spin</span><span class="p">%</span><span class="n">spinor</span><span class="p">,</span>
     <span class="p">&amp;</span>        <span class="n">block_dist</span><span class="p">,</span><span class="n">H_ldau_2D</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="n">oname</span><span class="p">)</span>
         
         <span class="c">! Initialize to 0, LDA+U may re-calculate</span>
         <span class="c">!   this matrix sporadically doing the SCF.</span>
         <span class="c">! Hence initialization MUST be performed upon</span>
         <span class="c">! re-allocation.</span>
         <span class="k">call </span><span class="n">init_val</span><span class="p">(</span><span class="n">H_ldau_2D</span><span class="p">)</span>
         <span class="k">if</span> <span class="p">(</span> <span class="n">inicoor</span> <span class="o">/=</span> <span class="n">istep</span> <span class="p">)</span> <span class="k">then</span>
            <span class="c">! Force initialization of the LDA+U</span>
            <span class="c">! when changing geometry</span>
            <span class="c">! For the first geometry this is controlled</span>
            <span class="c">! by the user via an fdf-key</span>
            <span class="n">ldau_init</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
         <span class="k">end if</span>
<span class="k">      end if</span>
<span class="k">      </span>
<span class="k">      if</span> <span class="p">(</span> <span class="n">spin</span><span class="p">%</span><span class="n">SO_onsite</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="n">oname</span><span class="p">,</span><span class="s2">&quot;(a,i0)&quot;</span><span class="p">)</span> <span class="s2">&quot;H_so (onsite) at geom step &quot;</span><span class="p">,</span> <span class="n">istep</span>
        <span class="k">call </span><span class="n">newdSpData2D</span><span class="p">(</span><span class="n">sparse_pattern</span><span class="p">,</span><span class="n">spin</span><span class="p">%</span><span class="n">H</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span>
     <span class="p">&amp;</span>      <span class="n">block_dist</span><span class="p">,</span><span class="n">H_so_on_2D</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="n">oname</span><span class="p">)</span>
      <span class="k">else if</span> <span class="p">(</span> <span class="n">spin</span><span class="p">%</span><span class="n">SO_offsite</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="n">oname</span><span class="p">,</span><span class="s2">&quot;(a,i0)&quot;</span><span class="p">)</span> <span class="s2">&quot;H_so (offsite) at geom step &quot;</span><span class="p">,</span> <span class="n">istep</span>
        <span class="k">call </span><span class="n">newzSpData2D</span><span class="p">(</span><span class="n">sparse_pattern</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span>
     <span class="p">&amp;</span>      <span class="n">block_dist</span><span class="p">,</span><span class="n">H_so_off_2D</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="n">oname</span><span class="p">)</span>
      <span class="n">endif</span>

      <span class="k">write</span><span class="p">(</span><span class="n">oname</span><span class="p">,</span><span class="s2">&quot;(a,i0)&quot;</span><span class="p">)</span> <span class="s2">&quot;S at geom step &quot;</span><span class="p">,</span> <span class="n">istep</span>
      <span class="k">call </span><span class="n">newdSpData1D</span><span class="p">(</span><span class="n">sparse_pattern</span><span class="p">,</span><span class="n">block_dist</span><span class="p">,</span><span class="n">S_1D</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="n">oname</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">ionode</span><span class="p">)</span> <span class="k">call </span><span class="n">print_type</span><span class="p">(</span><span class="n">S_1D</span><span class="p">)</span>
      <span class="n">S</span> <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">S_1D</span><span class="p">)</span>

<span class="c">!     Find overlap matrix </span>
      <span class="k">call </span><span class="n">overlap</span><span class="p">(</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">na_s</span><span class="p">,</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">scell</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">indxua</span><span class="p">,</span> <span class="n">rmaxo</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span>
     <span class="p">&amp;</span>              <span class="n">lasto</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span> <span class="n">isa</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">S</span> <span class="p">)</span>


<span class="c">!</span>
<span class="c">!     Here we could also read a Hamiltonian, either to proceed to</span>
<span class="c">!     the analysis section (with nscf=0) or to start a mix-H scf cycle.</span>
<span class="c">!</span>
<span class="c">!     Initialize density matrix</span>
      <span class="c">! The resizing of Dscf is done inside new_dm</span>
      <span class="k">call </span><span class="n">new_DM</span><span class="p">(</span><span class="n">auxchanged</span><span class="p">,</span> <span class="n">DM_history</span><span class="p">,</span> <span class="n">DM_2D</span><span class="p">,</span> <span class="n">EDM_2D</span><span class="p">)</span>

      <span class="n">Dscf</span> <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">DM_2D</span><span class="p">)</span>
      <span class="n">Escf</span> <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">EDM_2D</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">spin</span><span class="p">%</span><span class="n">H</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">call </span><span class="n">print_spin</span><span class="p">(</span><span class="n">dummy_qspin</span><span class="p">)</span>

      <span class="c">! Initialize energy-density matrix to zero for first call to overfsm</span>
      <span class="c">! Only part of Escf is updated in TS, so if it is put as zero here</span>
      <span class="c">! a continuation run gives bad forces.</span>
      <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">TSrun</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">normalize_DM</span><span class="p">(</span> <span class="n">first</span><span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span> <span class="p">)</span>
<span class="c">!$OMP parallel workshare default(shared)</span>
         <span class="n">Escf</span><span class="p">(:,:)</span> <span class="o">=</span> <span class="mf">0.0_dp</span>
<span class="c">!$OMP end parallel workshare</span>
      <span class="k">end if</span>

<span class="cp">#ifdef TEST_IO</span>
      <span class="c">! We test the io-performance here</span>
      <span class="k">call </span><span class="n">time_io</span><span class="p">(</span><span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span><span class="n">H_2D</span><span class="p">)</span>
<span class="cp">#endif</span>

<span class="c">!     If onlyS, Save overlap matrix and exit</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">onlyS</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">         </span><span class="n">fname</span> <span class="o">=</span> <span class="n">fname_TSHS</span><span class="p">(</span><span class="n">slabel</span><span class="p">,</span> <span class="n">onlyS</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span> <span class="p">)</span>
         <span class="c">! We include H as S, well-knowing that we only write one of</span>
         <span class="c">! them, there is no need to allocate space for no reason!</span>
         <span class="k">call </span><span class="n">ts_write_tshs</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> 
     <span class="p">&amp;</span>        <span class="p">.</span><span class="n">true</span><span class="p">.,</span> <span class="nb">Gamma</span><span class="p">,</span> <span class="n">ts_Gamma_file</span><span class="p">,</span>
     <span class="p">&amp;</span>        <span class="n">ucell</span><span class="p">,</span> <span class="n">nsc</span><span class="p">,</span> <span class="n">isc_off</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span>
     <span class="p">&amp;</span>        <span class="n">ts_kscell_file</span><span class="p">,</span> <span class="n">ts_kdispl_file</span><span class="p">,</span>
     <span class="p">&amp;</span>        <span class="n">xa</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span> 
     <span class="p">&amp;</span>        <span class="n">H_2D</span><span class="p">,</span> <span class="n">S_1D</span><span class="p">,</span> <span class="n">indxuo</span><span class="p">,</span> 
     <span class="p">&amp;</span>        <span class="n">dummyEf</span><span class="p">,</span> <span class="n">dummyQtot</span><span class="p">,</span> <span class="n">Temp</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
         <span class="k">call </span><span class="n">bye</span><span class="p">(</span> <span class="s1">&#39;Save overlap matrix and exit&#39;</span> <span class="p">)</span> <span class="c">! Exit siesta</span>
         
      <span class="n">endif</span> 

      <span class="c">! In case the user is requesting a Fermi-correction</span>
      <span class="c">! we need to delete the TS_FERMI file after each iteration</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">TSmode</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">TS_RHOCORR_METHOD</span> <span class="o">==</span> <span class="n">TS_RHOCORR_FERMI</span>
     <span class="p">&amp;</span>     <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">IONode</span> <span class="p">)</span> <span class="k">then</span>
          <span class="c">! Delete the TS_FERMI file (enables</span>
          <span class="c">! reading it in and improve on the convergence)</span>
          <span class="k">if</span> <span class="p">(</span> <span class="n">file_exist</span><span class="p">(</span><span class="s1">&#39;TS_FERMI&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">             </span><span class="n">i</span> <span class="o">=</span> <span class="mi">23455</span> <span class="c">! this should just not be used any were...</span>
             <span class="c">! Delete the file...</span>
             <span class="k">open</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">i</span><span class="p">,</span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;TS_FERMI&#39;</span><span class="p">)</span>
             <span class="k">close</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">status</span><span class="o">=</span><span class="s1">&#39;delete&#39;</span><span class="p">)</span>
          <span class="k">end if</span>
<span class="k">       end if</span>
      
<span class="cp">#ifdef CDF</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">writedm_cdf</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">setup_dm_netcdf_file</span><span class="p">(</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span>
     <span class="p">&amp;</span>                              <span class="n">no_s</span><span class="p">,</span> <span class="n">indxuo</span><span class="p">,</span>
     <span class="p">&amp;</span>                              <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">)</span>
      <span class="n">endif</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">writedm_cdf_history</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">setup_dm_netcdf_file</span><span class="p">(</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span>
     <span class="p">&amp;</span>                              <span class="n">no_s</span><span class="p">,</span> <span class="n">indxuo</span><span class="p">,</span>
     <span class="p">&amp;</span>                              <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span>
     <span class="p">&amp;</span>                              <span class="n">istep</span><span class="p">)</span>
      <span class="n">endif</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">writedmhs_cdf</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">setup_dmhs_netcdf_file</span><span class="p">(</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span>
     <span class="p">&amp;</span>                              <span class="n">no_s</span><span class="p">,</span> <span class="n">indxuo</span><span class="p">,</span>
     <span class="p">&amp;</span>                              <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span>
     <span class="p">&amp;</span>                              <span class="n">s</span><span class="p">)</span>
      <span class="n">endif</span>
      <span class="k">if</span><span class="p">(</span><span class="n">writedmhs_cdf_history</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">setup_dmhs_netcdf_file</span><span class="p">(</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span>
     <span class="p">&amp;</span>                              <span class="n">no_s</span><span class="p">,</span> <span class="n">indxuo</span><span class="p">,</span>
     <span class="p">&amp;</span>                              <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span>
     <span class="p">&amp;</span>                              <span class="n">s</span><span class="p">,</span>
     <span class="p">&amp;</span>                              <span class="n">istep</span><span class="p">)</span>
      <span class="n">endif</span>
<span class="cp">#endif</span>
      <span class="k">call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;state_init&#39;</span><span class="p">,</span> <span class="mi">2</span> <span class="p">)</span>

      <span class="k">END subroutine </span><span class="n">state_init</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2018 <a rel="license" href="http://www.gnu.org/licenses/old-licenses/fdl-1.2.en.html">GNU Free Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> SIESTA was developed by SIESTA Group</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>