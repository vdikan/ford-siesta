<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="A first-principles materials simulation code using Density Functional Theory.">
    
    <meta name="author" content="SIESTA Group" >
    <link rel="icon" href="../favicon.png">

    <title>state_init &ndash; SIESTA</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">SIESTA <small>trunk-700--vdikan-edens-710-ford-681</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>Program Overview</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>state_init
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 4.5% of total for procedures.">385 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/state_init.F"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/state_init.f.html'>state_init.F</a></li>
    
     <li><a href='../module/m_state_init.html'>m_state_init</a></li>
    
  
     <li class="active">state_init</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/state_init.html#src">state_init</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine state_init(istep)
    
    
   
</h2>
    
  
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
      
      <li class="list-group-item">
  <ul class="list-inline">
    
    <li>kpoint_scf_m</li>
    
    <li>kpoint_t_m</li>
    
    <li>m_os</li>
    
    <li>m_new_dm</li>
    
    <li>m_proximity_check</li>
    
    <li><a href='../module/siesta_options.html'>siesta_options</a></li>
    
    <li><a href='../module/units.html'>units</a></li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>create_Sparsity_SC</li>
    
    <li>m_sparsity_handling</li>
    
    <li>m_sparsity_handling</li>
    
    <li>m_pivot_methods</li>
    
    <li>siesta_geom</li>
    
    <li>atomlist</li>
    
    <li>alloc</li>
    
    <li>m_hsparse</li>
    
    <li>m_overlap</li>
    
    <li>m_supercell</li>
    
    <li>siesta_cml</li>
    
    <li>siesta_cml</li>
    
    <li>siesta_cml</li>
    
    <li>siesta_cml</li>
    
    <li>zmatrix</li>
    
    <li>m_energies</li>
    
    <li>write_subs</li>
    
    <li>m_ioxv</li>
    
    <li>m_iotdxv</li>
    
    <li>m_steps</li>
    
    <li><a href='../module/parallel.html'>parallel</a></li>
    
    <li>m_spin</li>
    
    <li>m_rmaxh</li>
    
    <li><a href='../module/m_mixing.html'>m_mixing</a></li>
    
    <li><a href='../module/m_mixing_scf.html'>m_mixing_scf</a></li>
    
    <li>m_normalize_dm</li>
    
    <li>m_eo</li>
    
    <li>m_gamma</li>
    
    <li>files</li>
    
    <li>m_mpi_utils</li>
    
    <li>m_mpi_utils</li>
    
    <li>domain_decom</li>
    
    <li>ldau_specs</li>
    
    <li>fdf</li>
    
    <li><a href='../module/sys.html'>sys</a></li>
    
    <li>m_sparse</li>
    
    <li>ts_kpoint_scf_m</li>
    
    <li>m_ts_charge</li>
    
    <li>m_ts_options</li>
    
    <li>m_ts_options</li>
    
    <li>m_ts_options</li>
    
    <li>m_ts_electype</li>
    
    <li>m_ts_global_vars</li>
    
    <li><a href='../module/sys.html'>sys</a></li>
    
    <li>m_ts_io</li>
    
    <li>m_ts_sparse</li>
    
    <li>m_ts_tri_init</li>
    
    <li>files</li>
    
    <li>m_chess</li>
    
    <li>iodm_netcdf</li>
    
    <li>iodmhs_netcdf</li>
    
    <li>class_Sparsity</li>
    
    <li>class_dSpData1D</li>
    
    <li>class_dSpData2D</li>
    
    <li>class_zSpData2D</li>
    
    <li>class_dData2D</li>
    
    <li>m_test_io</li>
    
    <li>siesta_dicts</li>
    
  </ul>
      </li>
      
      
      
      <li class="list-group-item">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~state_init~~UsesGraph Pages: 1 -->
<svg id="procstate_initUsesGraph" width="462pt" height="2376pt"
 viewBox="0.00 0.00 462.00 2376.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~state_init~~UsesGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 2372)">
<title>proc~~state_init~~UsesGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-2372 458,-2372 458,4 -4,4"/>
<!-- proc~state_init -->
<g id="proc~~state_init~~UsesGraph_node1" class="node"><title>proc~state_init</title>
<polygon fill="none" stroke="black" points="454,-1196 399,-1196 399,-1172 454,-1172 454,-1196"/>
<text text-anchor="middle" x="426.5" y="-1181.6" font-family="Helvetica,sans-Serif" font-size="10.50">state_init</text>
</g>
<!-- m_sparse -->
<g id="proc~~state_init~~UsesGraph_node2" class="node"><title>m_sparse</title>
<polygon fill="#337ab7" stroke="#337ab7" points="337.5,-2368 277.5,-2368 277.5,-2344 337.5,-2344 337.5,-2368"/>
<text text-anchor="middle" x="307.5" y="-2353.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_sparse</text>
</g>
<!-- proc~state_init&#45;&gt;m_sparse -->
<g id="proc~~state_init~~UsesGraph_edge1" class="edge"><title>proc~state_init&#45;&gt;m_sparse</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.629,-1196.15C426.772,-1313.17 433.533,-2237.98 363,-2335 358.954,-2340.57 353.223,-2344.66 346.986,-2347.66"/>
<polygon fill="#000000" stroke="#000000" points="345.652,-2344.43 337.621,-2351.34 348.209,-2350.94 345.652,-2344.43"/>
</g>
<!-- m_os -->
<g id="proc~~state_init~~UsesGraph_node3" class="node"><title>m_os</title>
<polygon fill="#337ab7" stroke="#337ab7" points="334.5,-2326 280.5,-2326 280.5,-2302 334.5,-2302 334.5,-2326"/>
<text text-anchor="middle" x="307.5" y="-2311.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_os</text>
</g>
<!-- proc~state_init&#45;&gt;m_os -->
<g id="proc~~state_init~~UsesGraph_edge2" class="edge"><title>proc~state_init&#45;&gt;m_os</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.602,-1196.06C426.468,-1310.32 430.992,-2199.68 363,-2293 358.443,-2299.25 351.76,-2303.65 344.624,-2306.73"/>
<polygon fill="#000000" stroke="#000000" points="343.052,-2303.57 334.768,-2310.18 345.363,-2310.18 343.052,-2303.57"/>
</g>
<!-- m_test_io -->
<g id="proc~~state_init~~UsesGraph_node4" class="node"><title>m_test_io</title>
<polygon fill="#337ab7" stroke="#337ab7" points="337,-2284 278,-2284 278,-2260 337,-2260 337,-2284"/>
<text text-anchor="middle" x="307.5" y="-2269.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_test_io</text>
</g>
<!-- proc~state_init&#45;&gt;m_test_io -->
<g id="proc~~state_init~~UsesGraph_edge4" class="edge"><title>proc~state_init&#45;&gt;m_test_io</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.575,-1196.31C426.159,-1309.11 428.388,-2161.46 363,-2251 358.862,-2256.67 352.978,-2260.8 346.595,-2263.83"/>
<polygon fill="#000000" stroke="#000000" points="345.11,-2260.65 337.032,-2267.5 347.621,-2267.18 345.11,-2260.65"/>
</g>
<!-- ts_kpoint_scf_m -->
<g id="proc~~state_init~~UsesGraph_node5" class="node"><title>ts_kpoint_scf_m</title>
<polygon fill="#337ab7" stroke="#337ab7" points="352.5,-2242 262.5,-2242 262.5,-2218 352.5,-2218 352.5,-2242"/>
<text text-anchor="middle" x="307.5" y="-2227.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ts_kpoint_scf_m</text>
</g>
<!-- proc~state_init&#45;&gt;ts_kpoint_scf_m -->
<g id="proc~~state_init~~UsesGraph_edge5" class="edge"><title>proc~state_init&#45;&gt;ts_kpoint_scf_m</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.543,-1196.17C425.832,-1305.91 425.86,-2123.14 363,-2209 362.208,-2210.08 361.353,-2211.11 360.443,-2212.08"/>
<polygon fill="#000000" stroke="#000000" points="358.056,-2209.51 352.534,-2218.55 362.49,-2214.93 358.056,-2209.51"/>
</g>
<!-- ldau_specs -->
<g id="proc~~state_init~~UsesGraph_node6" class="node"><title>ldau_specs</title>
<polygon fill="#337ab7" stroke="#337ab7" points="341,-2200 274,-2200 274,-2176 341,-2176 341,-2200"/>
<text text-anchor="middle" x="307.5" y="-2185.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ldau_specs</text>
</g>
<!-- proc~state_init&#45;&gt;ldau_specs -->
<g id="proc~~state_init~~UsesGraph_edge29" class="edge"><title>proc~state_init&#45;&gt;ldau_specs</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.51,-1196C425.496,-1302.56 423.338,-2084.81 363,-2167 359.662,-2171.55 355.202,-2175.11 350.264,-2177.9"/>
<polygon fill="#000000" stroke="#000000" points="348.639,-2174.79 341.001,-2182.14 351.551,-2181.16 348.639,-2174.79"/>
</g>
<!-- siesta_dicts -->
<g id="proc~~state_init~~UsesGraph_node7" class="node"><title>siesta_dicts</title>
<polygon fill="#337ab7" stroke="#337ab7" points="341.5,-2158 273.5,-2158 273.5,-2134 341.5,-2134 341.5,-2158"/>
<text text-anchor="middle" x="307.5" y="-2143.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_dicts</text>
</g>
<!-- proc~state_init&#45;&gt;siesta_dicts -->
<g id="proc~~state_init~~UsesGraph_edge16" class="edge"><title>proc~state_init&#45;&gt;siesta_dicts</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.473,-1196.14C425.142,-1300.64 420.76,-2046.55 363,-2125 359.813,-2129.33 355.608,-2132.77 350.944,-2135.49"/>
<polygon fill="#000000" stroke="#000000" points="349.112,-2132.49 341.557,-2139.92 352.095,-2138.82 349.112,-2132.49"/>
</g>
<!-- m_ts_options -->
<g id="proc~~state_init~~UsesGraph_node8" class="node"><title>m_ts_options</title>
<polygon fill="#337ab7" stroke="#337ab7" points="345.5,-2116 269.5,-2116 269.5,-2092 345.5,-2092 345.5,-2116"/>
<text text-anchor="middle" x="307.5" y="-2101.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_options</text>
</g>
<!-- proc~state_init&#45;&gt;m_ts_options -->
<g id="proc~~state_init~~UsesGraph_edge8" class="edge"><title>proc~state_init&#45;&gt;m_ts_options</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.433,-1196.24C424.77,-1298.44 418.193,-2008.28 363,-2083 360.696,-2086.12 357.863,-2088.78 354.712,-2091.04"/>
<polygon fill="#000000" stroke="#000000" points="352.714,-2088.15 345.769,-2096.15 356.188,-2094.23 352.714,-2088.15"/>
</g>
<!-- class_dData2D -->
<g id="proc~~state_init~~UsesGraph_node9" class="node"><title>class_dData2D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="350,-2074 265,-2074 265,-2050 350,-2050 350,-2074"/>
<text text-anchor="middle" x="307.5" y="-2059.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_dData2D</text>
</g>
<!-- proc~state_init&#45;&gt;class_dData2D -->
<g id="proc~~state_init~~UsesGraph_edge9" class="edge"><title>proc~state_init&#45;&gt;class_dData2D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.388,-1196.29C424.38,-1295.95 415.637,-1969.99 363,-2041 361.626,-2042.85 360.066,-2044.54 358.364,-2046.08"/>
<polygon fill="#000000" stroke="#000000" points="356.257,-2043.29 350.125,-2051.93 360.307,-2049 356.257,-2043.29"/>
</g>
<!-- m_supercell -->
<g id="proc~~state_init~~UsesGraph_node10" class="node"><title>m_supercell</title>
<polygon fill="#337ab7" stroke="#337ab7" points="342.5,-2032 272.5,-2032 272.5,-2008 342.5,-2008 342.5,-2032"/>
<text text-anchor="middle" x="307.5" y="-2017.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_supercell</text>
</g>
<!-- proc~state_init&#45;&gt;m_supercell -->
<g id="proc~~state_init~~UsesGraph_edge10" class="edge"><title>proc~state_init&#45;&gt;m_supercell</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.339,-1196.29C423.972,-1293.18 413.091,-1931.69 363,-1999 360.017,-2003.01 356.162,-2006.25 351.883,-2008.88"/>
<polygon fill="#000000" stroke="#000000" points="350.06,-2005.87 342.644,-2013.44 353.16,-2012.15 350.06,-2005.87"/>
</g>
<!-- m_proximity_check -->
<g id="proc~~state_init~~UsesGraph_node11" class="node"><title>m_proximity_check</title>
<polygon fill="#337ab7" stroke="#337ab7" points="359.5,-1990 255.5,-1990 255.5,-1966 359.5,-1966 359.5,-1990"/>
<text text-anchor="middle" x="307.5" y="-1975.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_proximity_check</text>
</g>
<!-- proc~state_init&#45;&gt;m_proximity_check -->
<g id="proc~~state_init~~UsesGraph_edge11" class="edge"><title>proc~state_init&#45;&gt;m_proximity_check</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.286,-1196.25C423.547,-1290.12 410.557,-1893.37 363,-1957 362.429,-1957.76 361.826,-1958.5 361.195,-1959.21"/>
<polygon fill="#000000" stroke="#000000" points="358.79,-1956.66 353.482,-1965.83 363.35,-1961.97 358.79,-1956.66"/>
</g>
<!-- module~parallel -->
<g id="proc~~state_init~~UsesGraph_node12" class="node"><title>module~parallel</title>
<g id="a_proc~~state_init~~UsesGraph_node12"><a xlink:href=".././module/parallel.html" xlink:title="parallel">
<polygon fill="#337ab7" stroke="#337ab7" points="334.5,-1948 280.5,-1948 280.5,-1924 334.5,-1924 334.5,-1948"/>
<text text-anchor="middle" x="307.5" y="-1933.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel</text>
</a>
</g>
</g>
<!-- proc~state_init&#45;&gt;module~parallel -->
<g id="proc~~state_init~~UsesGraph_edge12" class="edge"><title>proc~state_init&#45;&gt;module~parallel</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.228,-1196.16C423.103,-1286.78 408.033,-1855.04 363,-1915 358.353,-1921.19 351.634,-1925.55 344.49,-1928.63"/>
<polygon fill="#000000" stroke="#000000" points="342.921,-1925.47 334.642,-1932.08 345.236,-1932.08 342.921,-1925.47"/>
</g>
<!-- m_overlap -->
<g id="proc~~state_init~~UsesGraph_node13" class="node"><title>m_overlap</title>
<polygon fill="#337ab7" stroke="#337ab7" points="339,-1906 276,-1906 276,-1882 339,-1882 339,-1906"/>
<text text-anchor="middle" x="307.5" y="-1891.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_overlap</text>
</g>
<!-- proc~state_init&#45;&gt;m_overlap -->
<g id="proc~~state_init~~UsesGraph_edge45" class="edge"><title>proc~state_init&#45;&gt;m_overlap</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.166,-1196.01C422.643,-1283.16 405.521,-1816.69 363,-1873 359.281,-1877.92 354.251,-1881.69 348.742,-1884.58"/>
<polygon fill="#000000" stroke="#000000" points="347.001,-1881.52 339.167,-1888.65 349.739,-1887.96 347.001,-1881.52"/>
</g>
<!-- m_energies -->
<g id="proc~~state_init~~UsesGraph_node14" class="node"><title>m_energies</title>
<polygon fill="#337ab7" stroke="#337ab7" points="342,-1864 273,-1864 273,-1840 342,-1840 342,-1864"/>
<text text-anchor="middle" x="307.5" y="-1849.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_energies</text>
</g>
<!-- proc~state_init&#45;&gt;m_energies -->
<g id="proc~~state_init~~UsesGraph_edge14" class="edge"><title>proc~state_init&#45;&gt;m_energies</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.089,-1196.08C422.124,-1280.33 402.977,-1778.38 363,-1831 359.86,-1835.13 355.797,-1838.45 351.306,-1841.12"/>
<polygon fill="#000000" stroke="#000000" points="349.752,-1837.98 342.27,-1845.48 352.797,-1844.29 349.752,-1837.98"/>
</g>
<!-- module~sys -->
<g id="proc~~state_init~~UsesGraph_node15" class="node"><title>module~sys</title>
<g id="a_proc~~state_init~~UsesGraph_node15"><a xlink:href=".././module/sys.html" xlink:title="sys">
<polygon fill="#337ab7" stroke="#337ab7" points="334.5,-1822 280.5,-1822 280.5,-1798 334.5,-1798 334.5,-1822"/>
<text text-anchor="middle" x="307.5" y="-1807.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sys</text>
</a>
</g>
</g>
<!-- proc~state_init&#45;&gt;module~sys -->
<g id="proc~~state_init~~UsesGraph_edge15" class="edge"><title>proc~state_init&#45;&gt;module~sys</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.004,-1196.06C421.579,-1277.07 400.45,-1740.04 363,-1789 358.299,-1795.15 351.557,-1799.49 344.41,-1802.57"/>
<polygon fill="#000000" stroke="#000000" points="342.842,-1799.41 334.565,-1806.02 345.16,-1806.02 342.842,-1799.41"/>
</g>
<!-- domain_decom -->
<g id="proc~~state_init~~UsesGraph_node16" class="node"><title>domain_decom</title>
<polygon fill="#337ab7" stroke="#337ab7" points="350.5,-1780 264.5,-1780 264.5,-1756 350.5,-1756 350.5,-1780"/>
<text text-anchor="middle" x="307.5" y="-1765.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">domain_decom</text>
</g>
<!-- proc~state_init&#45;&gt;domain_decom -->
<g id="proc~~state_init~~UsesGraph_edge25" class="edge"><title>proc~state_init&#45;&gt;domain_decom</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M424.899,-1196.22C420.96,-1274.31 397.902,-1701.73 363,-1747 361.746,-1748.63 360.35,-1750.13 358.841,-1751.51"/>
<polygon fill="#000000" stroke="#000000" points="356.577,-1748.83 350.503,-1757.51 360.665,-1754.51 356.577,-1748.83"/>
</g>
<!-- kpoint_scf_m -->
<g id="proc~~state_init~~UsesGraph_node17" class="node"><title>kpoint_scf_m</title>
<polygon fill="#337ab7" stroke="#337ab7" points="345.5,-1738 269.5,-1738 269.5,-1714 345.5,-1714 345.5,-1738"/>
<text text-anchor="middle" x="307.5" y="-1723.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">kpoint_scf_m</text>
</g>
<!-- proc~state_init&#45;&gt;kpoint_scf_m -->
<g id="proc~~state_init~~UsesGraph_edge17" class="edge"><title>proc~state_init&#45;&gt;kpoint_scf_m</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.682,-1196.01C426.513,-1266.12 427.472,-1622.13 363,-1705 360.618,-1708.06 357.732,-1710.68 354.544,-1712.91"/>
<polygon fill="#000000" stroke="#000000" points="352.54,-1710.02 345.544,-1717.98 355.975,-1716.12 352.54,-1710.02"/>
</g>
<!-- atomlist -->
<g id="proc~~state_init~~UsesGraph_node18" class="node"><title>atomlist</title>
<polygon fill="#337ab7" stroke="#337ab7" points="334.5,-1696 280.5,-1696 280.5,-1672 334.5,-1672 334.5,-1696"/>
<text text-anchor="middle" x="307.5" y="-1681.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">atomlist</text>
</g>
<!-- proc~state_init&#45;&gt;atomlist -->
<g id="proc~~state_init~~UsesGraph_edge53" class="edge"><title>proc~state_init&#45;&gt;atomlist</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.542,-1196.34C425.532,-1263.79 422.357,-1587.52 363,-1663 358.26,-1669.03 351.564,-1673.33 344.482,-1676.39"/>
<polygon fill="#000000" stroke="#000000" points="342.985,-1673.21 334.733,-1679.86 345.327,-1679.81 342.985,-1673.21"/>
</g>
<!-- m_steps -->
<g id="proc~~state_init~~UsesGraph_node19" class="node"><title>m_steps</title>
<polygon fill="#337ab7" stroke="#337ab7" points="334.5,-1654 280.5,-1654 280.5,-1630 334.5,-1630 334.5,-1654"/>
<text text-anchor="middle" x="307.5" y="-1639.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_steps</text>
</g>
<!-- proc~state_init&#45;&gt;m_steps -->
<g id="proc~~state_init~~UsesGraph_edge19" class="edge"><title>proc~state_init&#45;&gt;m_steps</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.374,-1196.09C424.482,-1259.42 417.429,-1552.66 363,-1621 358.223,-1627 351.512,-1631.29 344.427,-1634.35"/>
<polygon fill="#000000" stroke="#000000" points="342.93,-1631.17 334.68,-1637.81 345.275,-1637.76 342.93,-1631.17"/>
</g>
<!-- m_ts_electype -->
<g id="proc~~state_init~~UsesGraph_node20" class="node"><title>m_ts_electype</title>
<polygon fill="#337ab7" stroke="#337ab7" points="348.5,-1612 266.5,-1612 266.5,-1588 348.5,-1588 348.5,-1612"/>
<text text-anchor="middle" x="307.5" y="-1597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_electype</text>
</g>
<!-- proc~state_init&#45;&gt;m_ts_electype -->
<g id="proc~~state_init~~UsesGraph_edge20" class="edge"><title>proc~state_init&#45;&gt;m_ts_electype</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.171,-1196.09C423.32,-1255.7 412.439,-1517.86 363,-1579 361.326,-1581.07 359.423,-1582.94 357.354,-1584.62"/>
<polygon fill="#000000" stroke="#000000" points="355.177,-1581.86 348.695,-1590.24 358.988,-1587.73 355.177,-1581.86"/>
</g>
<!-- m_normalize_dm -->
<g id="proc~~state_init~~UsesGraph_node21" class="node"><title>m_normalize_dm</title>
<polygon fill="#337ab7" stroke="#337ab7" points="355,-1570 260,-1570 260,-1546 355,-1546 355,-1570"/>
<text text-anchor="middle" x="307.5" y="-1555.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_normalize_dm</text>
</g>
<!-- proc~state_init&#45;&gt;m_normalize_dm -->
<g id="proc~~state_init~~UsesGraph_edge21" class="edge"><title>proc~state_init&#45;&gt;m_normalize_dm</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M424.912,-1196.27C421.998,-1252.26 407.422,-1483.08 363,-1537 362.275,-1537.88 361.508,-1538.72 360.704,-1539.53"/>
<polygon fill="#000000" stroke="#000000" points="358.316,-1536.96 352.627,-1545.9 362.648,-1542.46 358.316,-1536.96"/>
</g>
<!-- class_dSpData2D -->
<g id="proc~~state_init~~UsesGraph_node22" class="node"><title>class_dSpData2D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="356,-1528 259,-1528 259,-1504 356,-1504 356,-1528"/>
<text text-anchor="middle" x="307.5" y="-1513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_dSpData2D</text>
</g>
<!-- proc~state_init&#45;&gt;class_dSpData2D -->
<g id="proc~~state_init~~UsesGraph_edge22" class="edge"><title>proc~state_init&#45;&gt;class_dSpData2D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M424.599,-1196.18C420.551,-1247.81 402.501,-1448.17 363,-1495 362.154,-1496 361.255,-1496.96 360.309,-1497.87"/>
<polygon fill="#000000" stroke="#000000" points="358.112,-1495.14 352.283,-1503.99 362.357,-1500.71 358.112,-1495.14"/>
</g>
<!-- siesta_geom -->
<g id="proc~~state_init~~UsesGraph_node23" class="node"><title>siesta_geom</title>
<polygon fill="#337ab7" stroke="#337ab7" points="344,-1486 271,-1486 271,-1462 344,-1462 344,-1486"/>
<text text-anchor="middle" x="307.5" y="-1471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_geom</text>
</g>
<!-- proc~state_init&#45;&gt;siesta_geom -->
<g id="proc~~state_init~~UsesGraph_edge23" class="edge"><title>proc~state_init&#45;&gt;siesta_geom</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M424.193,-1196.1C418.89,-1243.14 397.603,-1413.2 363,-1453 360.193,-1456.23 356.832,-1458.96 353.174,-1461.28"/>
<polygon fill="#000000" stroke="#000000" points="351.465,-1458.22 344.225,-1465.96 354.708,-1464.43 351.465,-1458.22"/>
</g>
<!-- m_sparsity_handling -->
<g id="proc~~state_init~~UsesGraph_node24" class="node"><title>m_sparsity_handling</title>
<polygon fill="#337ab7" stroke="#337ab7" points="363,-1444 252,-1444 252,-1420 363,-1420 363,-1444"/>
<text text-anchor="middle" x="307.5" y="-1429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_sparsity_handling</text>
</g>
<!-- proc~state_init&#45;&gt;m_sparsity_handling -->
<g id="proc~~state_init~~UsesGraph_edge24" class="edge"><title>proc~state_init&#45;&gt;m_sparsity_handling</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.751,-1196.12C425.856,-1233.24 421.165,-1346.76 363,-1411 362.1,-1411.99 361.148,-1412.94 360.152,-1413.84"/>
<polygon fill="#000000" stroke="#000000" points="357.805,-1411.22 351.767,-1419.93 361.916,-1416.89 357.805,-1411.22"/>
</g>
<!-- m_ts_charge -->
<g id="proc~~state_init~~UsesGraph_node25" class="node"><title>m_ts_charge</title>
<polygon fill="#337ab7" stroke="#337ab7" points="345,-1402 270,-1402 270,-1378 345,-1378 345,-1402"/>
<text text-anchor="middle" x="307.5" y="-1387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_charge</text>
</g>
<!-- proc~state_init&#45;&gt;m_ts_charge -->
<g id="proc~~state_init~~UsesGraph_edge3" class="edge"><title>proc~state_init&#45;&gt;m_ts_charge</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M424.845,-1196.17C422.457,-1228.65 411.569,-1318.35 363,-1369 360.39,-1371.72 357.389,-1374.1 354.164,-1376.17"/>
<polygon fill="#000000" stroke="#000000" points="352.379,-1373.15 345.224,-1380.97 355.69,-1379.32 352.379,-1373.15"/>
</g>
<!-- m_iotdxv -->
<g id="proc~~state_init~~UsesGraph_node26" class="node"><title>m_iotdxv</title>
<polygon fill="#337ab7" stroke="#337ab7" points="335,-1360 280,-1360 280,-1336 335,-1336 335,-1360"/>
<text text-anchor="middle" x="307.5" y="-1345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_iotdxv</text>
</g>
<!-- proc~state_init&#45;&gt;m_iotdxv -->
<g id="proc~~state_init~~UsesGraph_edge26" class="edge"><title>proc~state_init&#45;&gt;m_iotdxv</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M423.457,-1196.16C418.277,-1223.33 402.155,-1289.54 363,-1327 357.88,-1331.9 351.495,-1335.69 344.917,-1338.61"/>
<polygon fill="#000000" stroke="#000000" points="343.359,-1335.45 335.265,-1342.29 345.856,-1341.99 343.359,-1335.45"/>
</g>
<!-- m_ts_tri_init -->
<g id="proc~~state_init~~UsesGraph_node27" class="node"><title>m_ts_tri_init</title>
<polygon fill="#337ab7" stroke="#337ab7" points="342.5,-1318 272.5,-1318 272.5,-1294 342.5,-1294 342.5,-1318"/>
<text text-anchor="middle" x="307.5" y="-1303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_tri_init</text>
</g>
<!-- proc~state_init&#45;&gt;m_ts_tri_init -->
<g id="proc~~state_init~~UsesGraph_edge27" class="edge"><title>proc~state_init&#45;&gt;m_ts_tri_init</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M420.278,-1196.14C411.21,-1215.99 390.824,-1255.63 363,-1280 359.156,-1283.37 354.799,-1286.4 350.265,-1289.09"/>
<polygon fill="#000000" stroke="#000000" points="348.553,-1286.04 341.414,-1293.87 351.877,-1292.2 348.553,-1286.04"/>
</g>
<!-- module~units -->
<g id="proc~~state_init~~UsesGraph_node28" class="node"><title>module~units</title>
<g id="a_proc~~state_init~~UsesGraph_node28"><a xlink:href=".././module/units.html" xlink:title="units">
<polygon fill="#337ab7" stroke="#337ab7" points="214,-1228 160,-1228 160,-1204 214,-1204 214,-1228"/>
<text text-anchor="middle" x="187" y="-1213.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">units</text>
</a>
</g>
</g>
<!-- proc~state_init&#45;&gt;module~units -->
<g id="proc~~state_init~~UsesGraph_edge36" class="edge"><title>proc~state_init&#45;&gt;module~units</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M417.987,-1196.08C407.727,-1211.29 387.747,-1236.69 363,-1247 317.46,-1265.97 300.084,-1258.03 252,-1247 239.622,-1244.16 226.858,-1238.6 216.016,-1232.96"/>
<polygon fill="#000000" stroke="#000000" points="217.495,-1229.78 207.042,-1228.05 214.136,-1235.92 217.495,-1229.78"/>
</g>
<!-- iodmhs_netcdf -->
<g id="proc~~state_init~~UsesGraph_node29" class="node"><title>iodmhs_netcdf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="348.5,-1238 266.5,-1238 266.5,-1214 348.5,-1214 348.5,-1238"/>
<text text-anchor="middle" x="307.5" y="-1223.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iodmhs_netcdf</text>
</g>
<!-- proc~state_init&#45;&gt;iodmhs_netcdf -->
<g id="proc~~state_init~~UsesGraph_edge28" class="edge"><title>proc~state_init&#45;&gt;iodmhs_netcdf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M398.951,-1193.53C384.992,-1198.54 367.533,-1204.81 351.687,-1210.5"/>
<polygon fill="#000000" stroke="#000000" points="350.303,-1207.27 342.074,-1213.95 352.669,-1213.86 350.303,-1207.27"/>
</g>
<!-- kpoint_t_m -->
<g id="proc~~state_init~~UsesGraph_node30" class="node"><title>kpoint_t_m</title>
<polygon fill="#337ab7" stroke="#337ab7" points="340,-1196 275,-1196 275,-1172 340,-1172 340,-1196"/>
<text text-anchor="middle" x="307.5" y="-1181.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">kpoint_t_m</text>
</g>
<!-- proc~state_init&#45;&gt;kpoint_t_m -->
<g id="proc~~state_init~~UsesGraph_edge31" class="edge"><title>proc~state_init&#45;&gt;kpoint_t_m</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M398.951,-1184C384.682,-1184 366.754,-1184 350.631,-1184"/>
<polygon fill="#000000" stroke="#000000" points="350.352,-1180.5 340.352,-1184 350.352,-1187.5 350.352,-1180.5"/>
</g>
<!-- m_mpi_utils -->
<g id="proc~~state_init~~UsesGraph_node31" class="node"><title>m_mpi_utils</title>
<polygon fill="#337ab7" stroke="#337ab7" points="342.5,-1154 272.5,-1154 272.5,-1130 342.5,-1130 342.5,-1154"/>
<text text-anchor="middle" x="307.5" y="-1139.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_mpi_utils</text>
</g>
<!-- proc~state_init&#45;&gt;m_mpi_utils -->
<g id="proc~~state_init~~UsesGraph_edge32" class="edge"><title>proc~state_init&#45;&gt;m_mpi_utils</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M398.951,-1174.47C384.992,-1169.46 367.533,-1163.19 351.687,-1157.5"/>
<polygon fill="#000000" stroke="#000000" points="352.669,-1154.14 342.074,-1154.05 350.303,-1160.73 352.669,-1154.14"/>
</g>
<!-- class_zSpData2D -->
<g id="proc~~state_init~~UsesGraph_node32" class="node"><title>class_zSpData2D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="356,-1112 259,-1112 259,-1088 356,-1088 356,-1112"/>
<text text-anchor="middle" x="307.5" y="-1097.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_zSpData2D</text>
</g>
<!-- proc~state_init&#45;&gt;class_zSpData2D -->
<g id="proc~~state_init~~UsesGraph_edge33" class="edge"><title>proc~state_init&#45;&gt;class_zSpData2D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M416.104,-1171.8C404.815,-1157.86 384.67,-1135.15 363,-1121 360.573,-1119.41 358.007,-1117.92 355.366,-1116.52"/>
<polygon fill="#000000" stroke="#000000" points="356.707,-1113.28 346.177,-1112.1 353.675,-1119.59 356.707,-1113.28"/>
</g>
<!-- files -->
<g id="proc~~state_init~~UsesGraph_node33" class="node"><title>files</title>
<polygon fill="#337ab7" stroke="#337ab7" points="334.5,-1070 280.5,-1070 280.5,-1046 334.5,-1046 334.5,-1070"/>
<text text-anchor="middle" x="307.5" y="-1055.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">files</text>
</g>
<!-- proc~state_init&#45;&gt;files -->
<g id="proc~~state_init~~UsesGraph_edge34" class="edge"><title>proc~state_init&#45;&gt;files</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M421.322,-1171.84C413.312,-1150.24 393.807,-1104.99 363,-1079 357.533,-1074.39 350.94,-1070.72 344.257,-1067.83"/>
<polygon fill="#000000" stroke="#000000" points="345.113,-1064.41 334.522,-1064.13 342.627,-1070.96 345.113,-1064.41"/>
</g>
<!-- m_pivot_methods -->
<g id="proc~~state_init~~UsesGraph_node34" class="node"><title>m_pivot_methods</title>
<polygon fill="#337ab7" stroke="#337ab7" points="356,-1028 259,-1028 259,-1004 356,-1004 356,-1028"/>
<text text-anchor="middle" x="307.5" y="-1013.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_pivot_methods</text>
</g>
<!-- proc~state_init&#45;&gt;m_pivot_methods -->
<g id="proc~~state_init~~UsesGraph_edge47" class="edge"><title>proc~state_init&#45;&gt;m_pivot_methods</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M423.635,-1171.92C418.753,-1144.26 403.083,-1075.73 363,-1037 361.747,-1035.79 360.416,-1034.65 359.024,-1033.57"/>
<polygon fill="#000000" stroke="#000000" points="360.794,-1030.54 350.493,-1028.07 357,-1036.43 360.794,-1030.54"/>
</g>
<!-- write_subs -->
<g id="proc~~state_init~~UsesGraph_node35" class="node"><title>write_subs</title>
<polygon fill="#337ab7" stroke="#337ab7" points="339.5,-986 275.5,-986 275.5,-962 339.5,-962 339.5,-986"/>
<text text-anchor="middle" x="307.5" y="-971.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_subs</text>
</g>
<!-- proc~state_init&#45;&gt;write_subs -->
<g id="proc~~state_init~~UsesGraph_edge7" class="edge"><title>proc~state_init&#45;&gt;write_subs</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M424.931,-1171.57C422.754,-1138.4 412.347,-1046.8 363,-995 359.066,-990.87 354.229,-987.542 349.077,-984.861"/>
<polygon fill="#000000" stroke="#000000" points="350.152,-981.511 339.588,-980.704 347.343,-987.923 350.152,-981.511"/>
</g>
<!-- module~siesta_options -->
<g id="proc~~state_init~~UsesGraph_node36" class="node"><title>module~siesta_options</title>
<g id="a_proc~~state_init~~UsesGraph_node36"><a xlink:href=".././module/siesta_options.html" xlink:title="siesta_options">
<polygon fill="#337ab7" stroke="#337ab7" points="348,-944 267,-944 267,-920 348,-920 348,-944"/>
<text text-anchor="middle" x="307.5" y="-929.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_options</text>
</a>
</g>
</g>
<!-- proc~state_init&#45;&gt;module~siesta_options -->
<g id="proc~~state_init~~UsesGraph_edge37" class="edge"><title>proc~state_init&#45;&gt;module~siesta_options</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.82,-1171.94C426.153,-1134.45 422.113,-1018.57 363,-953 361.218,-951.023 359.228,-949.231 357.092,-947.606"/>
<polygon fill="#000000" stroke="#000000" points="358.603,-944.424 348.258,-942.133 354.916,-950.375 358.603,-944.424"/>
</g>
<!-- class_Sparsity -->
<g id="proc~~state_init~~UsesGraph_node37" class="node"><title>class_Sparsity</title>
<polygon fill="#337ab7" stroke="#337ab7" points="348,-902 267,-902 267,-878 348,-878 348,-902"/>
<text text-anchor="middle" x="307.5" y="-887.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_Sparsity</text>
</g>
<!-- proc~state_init&#45;&gt;class_Sparsity -->
<g id="proc~~state_init~~UsesGraph_edge38" class="edge"><title>proc~state_init&#45;&gt;class_Sparsity</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M424.218,-1171.72C419.009,-1123.99 398.026,-951.419 363,-911 361.228,-908.955 359.233,-907.108 357.081,-905.44"/>
<polygon fill="#000000" stroke="#000000" points="358.476,-902.185 348.141,-899.855 354.767,-908.122 358.476,-902.185"/>
</g>
<!-- m_ts_global_vars -->
<g id="proc~~state_init~~UsesGraph_node38" class="node"><title>m_ts_global_vars</title>
<polygon fill="#337ab7" stroke="#337ab7" points="356,-860 259,-860 259,-836 356,-836 356,-860"/>
<text text-anchor="middle" x="307.5" y="-845.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_global_vars</text>
</g>
<!-- proc~state_init&#45;&gt;m_ts_global_vars -->
<g id="proc~~state_init~~UsesGraph_edge39" class="edge"><title>proc~state_init&#45;&gt;m_ts_global_vars</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M424.621,-1171.67C420.664,-1119.37 402.931,-916.462 363,-869 362.155,-867.996 361.257,-867.04 360.312,-866.13"/>
<polygon fill="#000000" stroke="#000000" points="362.363,-863.292 352.291,-860.004 358.115,-868.855 362.363,-863.292"/>
</g>
<!-- m_ts_io -->
<g id="proc~~state_init~~UsesGraph_node39" class="node"><title>m_ts_io</title>
<polygon fill="#337ab7" stroke="#337ab7" points="334.5,-818 280.5,-818 280.5,-794 334.5,-794 334.5,-818"/>
<text text-anchor="middle" x="307.5" y="-803.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_io</text>
</g>
<!-- proc~state_init&#45;&gt;m_ts_io -->
<g id="proc~~state_init~~UsesGraph_edge40" class="edge"><title>proc~state_init&#45;&gt;m_ts_io</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M424.95,-1171.97C422.168,-1116.02 407.958,-881.677 363,-827 358.13,-821.077 351.381,-816.821 344.288,-813.763"/>
<polygon fill="#000000" stroke="#000000" points="345.142,-810.352 334.548,-810.294 342.793,-816.946 345.142,-810.352"/>
</g>
<!-- m_chess -->
<g id="proc~~state_init~~UsesGraph_node40" class="node"><title>m_chess</title>
<polygon fill="#337ab7" stroke="#337ab7" points="335,-776 280,-776 280,-752 335,-752 335,-776"/>
<text text-anchor="middle" x="307.5" y="-761.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_chess</text>
</g>
<!-- proc~state_init&#45;&gt;m_chess -->
<g id="proc~~state_init~~UsesGraph_edge41" class="edge"><title>proc~state_init&#45;&gt;m_chess</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.189,-1171.79C423.421,-1111.58 412.88,-846.784 363,-785 358.271,-779.142 351.7,-774.915 344.754,-771.867"/>
<polygon fill="#000000" stroke="#000000" points="345.781,-768.516 335.187,-768.397 343.395,-775.097 345.781,-768.516"/>
</g>
<!-- m_ioxv -->
<g id="proc~~state_init~~UsesGraph_node41" class="node"><title>m_ioxv</title>
<polygon fill="#337ab7" stroke="#337ab7" points="334.5,-734 280.5,-734 280.5,-710 334.5,-710 334.5,-734"/>
<text text-anchor="middle" x="307.5" y="-719.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ioxv</text>
</g>
<!-- proc~state_init&#45;&gt;m_ioxv -->
<g id="proc~~state_init~~UsesGraph_edge49" class="edge"><title>proc~state_init&#45;&gt;m_ioxv</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.39,-1171.8C424.579,-1107.9 417.873,-811.993 363,-743 358.227,-736.998 351.517,-732.71 344.433,-729.647"/>
<polygon fill="#000000" stroke="#000000" points="345.28,-726.233 334.685,-726.182 342.936,-732.829 345.28,-726.233"/>
</g>
<!-- siesta_cml -->
<g id="proc~~state_init~~UsesGraph_node42" class="node"><title>siesta_cml</title>
<polygon fill="#337ab7" stroke="#337ab7" points="339,-692 276,-692 276,-668 339,-668 339,-692"/>
<text text-anchor="middle" x="307.5" y="-677.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_cml</text>
</g>
<!-- proc~state_init&#45;&gt;siesta_cml -->
<g id="proc~~state_init~~UsesGraph_edge42" class="edge"><title>proc~state_init&#45;&gt;siesta_cml</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.556,-1172C425.639,-1104.98 422.935,-777.3 363,-701 359.228,-696.198 354.215,-692.493 348.754,-689.635"/>
<polygon fill="#000000" stroke="#000000" points="349.849,-686.297 339.279,-685.58 347.095,-692.733 349.849,-686.297"/>
</g>
<!-- m_spin -->
<g id="proc~~state_init~~UsesGraph_node43" class="node"><title>m_spin</title>
<polygon fill="#337ab7" stroke="#337ab7" points="334.5,-650 280.5,-650 280.5,-626 334.5,-626 334.5,-650"/>
<text text-anchor="middle" x="307.5" y="-635.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_spin</text>
</g>
<!-- proc~state_init&#45;&gt;m_spin -->
<g id="proc~~state_init~~UsesGraph_edge43" class="edge"><title>proc~state_init&#45;&gt;m_spin</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.696,-1171.9C426.603,-1101.26 427.923,-742.523 363,-659 358.294,-652.946 351.612,-648.636 344.533,-645.568"/>
<polygon fill="#000000" stroke="#000000" points="345.376,-642.153 334.781,-642.107 343.034,-648.75 345.376,-642.153"/>
</g>
<!-- module~m_mixing -->
<g id="proc~~state_init~~UsesGraph_node44" class="node"><title>module~m_mixing</title>
<g id="a_proc~~state_init~~UsesGraph_node44"><a xlink:href=".././module/m_mixing.html" xlink:title="m_mixing">
<polygon fill="#337ab7" stroke="#337ab7" points="216,-544 158,-544 158,-520 216,-520 216,-544"/>
<text text-anchor="middle" x="187" y="-529.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_mixing</text>
</a>
</g>
</g>
<!-- proc~state_init&#45;&gt;module~m_mixing -->
<g id="proc~~state_init~~UsesGraph_edge44" class="edge"><title>proc~state_init&#45;&gt;module~m_mixing</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M424.939,-1171.93C421.207,-1093.86 399.027,-661.975 363,-617 330.4,-576.303 298.212,-603.154 252,-579 237.057,-571.189 221.783,-560.113 209.906,-550.675"/>
<polygon fill="#000000" stroke="#000000" points="211.875,-547.765 201.911,-544.162 207.454,-553.192 211.875,-547.765"/>
</g>
<!-- m_new_dm -->
<g id="proc~~state_init~~UsesGraph_node45" class="node"><title>m_new_dm</title>
<polygon fill="#337ab7" stroke="#337ab7" points="341.5,-570 273.5,-570 273.5,-546 341.5,-546 341.5,-570"/>
<text text-anchor="middle" x="307.5" y="-555.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_new_dm</text>
</g>
<!-- proc~state_init&#45;&gt;m_new_dm -->
<g id="proc~~state_init~~UsesGraph_edge13" class="edge"><title>proc~state_init&#45;&gt;m_new_dm</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M424.941,-1171.81C421.145,-1090.97 398.222,-633.891 363,-584 359.712,-579.343 355.363,-575.492 350.55,-572.313"/>
<polygon fill="#000000" stroke="#000000" points="351.958,-569.092 341.518,-567.291 348.557,-575.21 351.958,-569.092"/>
</g>
<!-- m_hsparse -->
<g id="proc~~state_init~~UsesGraph_node46" class="node"><title>m_hsparse</title>
<polygon fill="#337ab7" stroke="#337ab7" points="340.5,-528 274.5,-528 274.5,-504 340.5,-504 340.5,-528"/>
<text text-anchor="middle" x="307.5" y="-513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_hsparse</text>
</g>
<!-- proc~state_init&#45;&gt;m_hsparse -->
<g id="proc~~state_init~~UsesGraph_edge46" class="edge"><title>proc~state_init&#45;&gt;m_hsparse</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.089,-1171.92C422.124,-1087.67 402.977,-589.625 363,-537 359.55,-532.458 354.985,-528.898 349.961,-526.108"/>
<polygon fill="#000000" stroke="#000000" points="351.12,-522.792 340.565,-521.872 348.242,-529.173 351.12,-522.792"/>
</g>
<!-- class_dSpData1D -->
<g id="proc~~state_init~~UsesGraph_node47" class="node"><title>class_dSpData1D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="356,-486 259,-486 259,-462 356,-462 356,-486"/>
<text text-anchor="middle" x="307.5" y="-471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_dSpData1D</text>
</g>
<!-- proc~state_init&#45;&gt;class_dSpData1D -->
<g id="proc~~state_init~~UsesGraph_edge35" class="edge"><title>proc~state_init&#45;&gt;class_dSpData1D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.166,-1171.99C422.643,-1084.84 405.521,-551.314 363,-495 362.412,-494.221 361.791,-493.471 361.141,-492.749"/>
<polygon fill="#000000" stroke="#000000" points="363.088,-489.812 353.192,-486.027 358.568,-495.157 363.088,-489.812"/>
</g>
<!-- sparse_matrices -->
<g id="proc~~state_init~~UsesGraph_node48" class="node"><title>sparse_matrices</title>
<polygon fill="#337ab7" stroke="#337ab7" points="353,-444 262,-444 262,-420 353,-420 353,-444"/>
<text text-anchor="middle" x="307.5" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sparse_matrices</text>
</g>
<!-- proc~state_init&#45;&gt;sparse_matrices -->
<g id="proc~~state_init~~UsesGraph_edge52" class="edge"><title>proc~state_init&#45;&gt;sparse_matrices</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.228,-1171.84C423.103,-1081.22 408.033,-512.963 363,-453 362.414,-452.22 361.795,-451.468 361.146,-450.745"/>
<polygon fill="#000000" stroke="#000000" points="363.101,-447.813 353.211,-444.012 358.572,-453.151 363.101,-447.813"/>
</g>
<!-- alloc -->
<g id="proc~~state_init~~UsesGraph_node49" class="node"><title>alloc</title>
<polygon fill="#337ab7" stroke="#337ab7" points="334.5,-402 280.5,-402 280.5,-378 334.5,-378 334.5,-402"/>
<text text-anchor="middle" x="307.5" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">alloc</text>
</g>
<!-- proc~state_init&#45;&gt;alloc -->
<g id="proc~~state_init~~UsesGraph_edge48" class="edge"><title>proc~state_init&#45;&gt;alloc</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.286,-1171.75C423.547,-1077.88 410.557,-474.629 363,-411 358.367,-404.802 351.654,-400.433 344.512,-397.353"/>
<polygon fill="#000000" stroke="#000000" points="345.256,-393.906 334.662,-393.903 342.942,-400.512 345.256,-393.906"/>
</g>
<!-- m_gamma -->
<g id="proc~~state_init~~UsesGraph_node50" class="node"><title>m_gamma</title>
<polygon fill="#337ab7" stroke="#337ab7" points="339.5,-360 275.5,-360 275.5,-336 339.5,-336 339.5,-360"/>
<text text-anchor="middle" x="307.5" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_gamma</text>
</g>
<!-- proc~state_init&#45;&gt;m_gamma -->
<g id="proc~~state_init~~UsesGraph_edge30" class="edge"><title>proc~state_init&#45;&gt;m_gamma</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.339,-1171.71C423.972,-1074.82 413.091,-436.31 363,-369 359.355,-364.101 354.409,-360.346 348.975,-357.466"/>
<polygon fill="#000000" stroke="#000000" points="350.085,-354.133 339.516,-353.399 347.321,-360.564 350.085,-354.133"/>
</g>
<!-- fdf -->
<g id="proc~~state_init~~UsesGraph_node51" class="node"><title>fdf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="334.5,-318 280.5,-318 280.5,-294 334.5,-294 334.5,-318"/>
<text text-anchor="middle" x="307.5" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fdf</text>
</g>
<!-- proc~state_init&#45;&gt;fdf -->
<g id="proc~~state_init~~UsesGraph_edge50" class="edge"><title>proc~state_init&#45;&gt;fdf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.388,-1171.71C424.38,-1072.05 415.637,-398.007 363,-327 358.392,-320.784 351.688,-316.407 344.548,-313.327"/>
<polygon fill="#000000" stroke="#000000" points="345.291,-309.878 334.696,-309.877 342.977,-316.485 345.291,-309.878"/>
</g>
<!-- create_Sparsity_SC -->
<g id="proc~~state_init~~UsesGraph_node52" class="node"><title>create_Sparsity_SC</title>
<polygon fill="#337ab7" stroke="#337ab7" points="361,-276 254,-276 254,-252 361,-252 361,-276"/>
<text text-anchor="middle" x="307.5" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">create_Sparsity_SC</text>
</g>
<!-- proc~state_init&#45;&gt;create_Sparsity_SC -->
<g id="proc~~state_init~~UsesGraph_edge51" class="edge"><title>proc~state_init&#45;&gt;create_Sparsity_SC</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.433,-1171.76C424.77,-1069.56 418.193,-359.72 363,-285 362.433,-284.233 361.835,-283.494 361.207,-282.782"/>
<polygon fill="#000000" stroke="#000000" points="363.377,-280.031 353.523,-276.138 358.799,-285.326 363.377,-280.031"/>
</g>
<!-- m_eo -->
<g id="proc~~state_init~~UsesGraph_node53" class="node"><title>m_eo</title>
<polygon fill="#337ab7" stroke="#337ab7" points="334.5,-234 280.5,-234 280.5,-210 334.5,-210 334.5,-234"/>
<text text-anchor="middle" x="307.5" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_eo</text>
</g>
<!-- proc~state_init&#45;&gt;m_eo -->
<g id="proc~~state_init~~UsesGraph_edge6" class="edge"><title>proc~state_init&#45;&gt;m_eo</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.473,-1171.86C425.142,-1067.36 420.76,-321.448 363,-243 358.412,-236.769 351.716,-232.387 344.578,-229.305"/>
<polygon fill="#000000" stroke="#000000" points="345.319,-225.856 334.724,-225.856 343.007,-232.463 345.319,-225.856"/>
</g>
<!-- m_rmaxh -->
<g id="proc~~state_init~~UsesGraph_node54" class="node"><title>m_rmaxh</title>
<polygon fill="#337ab7" stroke="#337ab7" points="336.5,-192 278.5,-192 278.5,-168 336.5,-168 336.5,-192"/>
<text text-anchor="middle" x="307.5" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_rmaxh</text>
</g>
<!-- proc~state_init&#45;&gt;m_rmaxh -->
<g id="proc~~state_init~~UsesGraph_edge18" class="edge"><title>proc~state_init&#45;&gt;m_rmaxh</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.51,-1172C425.496,-1065.44 423.338,-283.192 363,-201 358.807,-195.289 352.843,-191.13 346.387,-188.103"/>
<polygon fill="#000000" stroke="#000000" points="347.315,-184.712 336.724,-184.428 344.827,-191.255 347.315,-184.712"/>
</g>
<!-- m_ts_sparse -->
<g id="proc~~state_init~~UsesGraph_node55" class="node"><title>m_ts_sparse</title>
<polygon fill="#337ab7" stroke="#337ab7" points="344.5,-150 270.5,-150 270.5,-126 344.5,-126 344.5,-150"/>
<text text-anchor="middle" x="307.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_sparse</text>
</g>
<!-- proc~state_init&#45;&gt;m_ts_sparse -->
<g id="proc~~state_init~~UsesGraph_edge54" class="edge"><title>proc~state_init&#45;&gt;m_ts_sparse</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.543,-1171.83C425.832,-1062.09 425.86,-244.861 363,-159 360.439,-155.502 357.214,-152.587 353.618,-150.158"/>
<polygon fill="#000000" stroke="#000000" points="355.15,-147.008 344.69,-145.324 351.818,-153.163 355.15,-147.008"/>
</g>
<!-- module~m_mixing_scf -->
<g id="proc~~state_init~~UsesGraph_node56" class="node"><title>module~m_mixing_scf</title>
<g id="a_proc~~state_init~~UsesGraph_node56"><a xlink:href=".././module/m_mixing_scf.html" xlink:title="m_mixing_scf">
<polygon fill="#337ab7" stroke="#337ab7" points="346.5,-108 268.5,-108 268.5,-84 346.5,-84 346.5,-108"/>
<text text-anchor="middle" x="307.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_mixing_scf</text>
</a>
</g>
</g>
<!-- proc~state_init&#45;&gt;module~m_mixing_scf -->
<g id="proc~~state_init~~UsesGraph_edge55" class="edge"><title>proc~state_init&#45;&gt;module~m_mixing_scf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.575,-1171.69C426.159,-1058.89 428.388,-206.538 363,-117 360.872,-114.087 358.284,-111.577 355.403,-109.416"/>
<polygon fill="#000000" stroke="#000000" points="357.033,-106.314 346.651,-104.201 353.45,-112.327 357.033,-106.314"/>
</g>
<!-- iodm_netcdf -->
<g id="proc~~state_init~~UsesGraph_node57" class="node"><title>iodm_netcdf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="343,-66 272,-66 272,-42 343,-42 343,-66"/>
<text text-anchor="middle" x="307.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iodm_netcdf</text>
</g>
<!-- proc~state_init&#45;&gt;iodm_netcdf -->
<g id="proc~~state_init~~UsesGraph_edge56" class="edge"><title>proc~state_init&#45;&gt;iodm_netcdf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.602,-1171.94C426.468,-1057.68 430.992,-168.321 363,-75 360.093,-71.0099 356.32,-67.7779 352.116,-65.16"/>
<polygon fill="#000000" stroke="#000000" points="353.53,-61.9534 343.021,-60.6027 350.394,-68.2117 353.53,-61.9534"/>
</g>
<!-- zmatrix -->
<g id="proc~~state_init~~UsesGraph_node58" class="node"><title>zmatrix</title>
<polygon fill="#337ab7" stroke="#337ab7" points="334.5,-24 280.5,-24 280.5,-0 334.5,-0 334.5,-24"/>
<text text-anchor="middle" x="307.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">zmatrix</text>
</g>
<!-- proc~state_init&#45;&gt;zmatrix -->
<g id="proc~~state_init~~UsesGraph_edge57" class="edge"><title>proc~state_init&#45;&gt;zmatrix</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.629,-1171.85C426.772,-1054.83 433.533,-130.018 363,-33 358.45,-26.7412 351.769,-22.3478 344.633,-19.2638"/>
<polygon fill="#000000" stroke="#000000" points="345.372,-15.8142 334.777,-15.8177 343.061,-22.422 345.372,-15.8142"/>
</g>
<!-- module~precision -->
<g id="proc~~state_init~~UsesGraph_node59" class="node"><title>module~precision</title>
<g id="a_proc~~state_init~~UsesGraph_node59"><a xlink:href=".././module/precision.html" xlink:title="precision">
<polygon fill="#337ab7" stroke="#337ab7" points="88.5,-685 33.5,-685 33.5,-661 88.5,-661 88.5,-685"/>
<text text-anchor="middle" x="61" y="-670.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">precision</text>
</a>
</g>
</g>
<!-- module~units&#45;&gt;module~precision -->
<g id="proc~~state_init~~UsesGraph_edge58" class="edge"><title>module~units&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M183.236,-1203.9C167.372,-1134.43 87.8672,-786.273 67.0145,-694.959"/>
<polygon fill="#000000" stroke="#000000" points="70.409,-694.102 64.7704,-685.132 63.5847,-695.66 70.409,-694.102"/>
</g>
<!-- module~m_mixing&#45;&gt;module~precision -->
<g id="proc~~state_init~~UsesGraph_edge59" class="edge"><title>module~m_mixing&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M175.428,-544.022C154.121,-568.249 105.827,-623.165 79.6537,-652.926"/>
<polygon fill="#000000" stroke="#000000" points="76.8746,-650.786 72.8989,-660.607 82.131,-655.409 76.8746,-650.786"/>
</g>
<!-- class_Fstack_dData1D -->
<g id="proc~~state_init~~UsesGraph_node60" class="node"><title>class_Fstack_dData1D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="122,-387 -7.10543e-15,-387 -7.10543e-15,-363 122,-363 122,-387"/>
<text text-anchor="middle" x="61" y="-372.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_Fstack_dData1D</text>
</g>
<!-- module~m_mixing&#45;&gt;class_Fstack_dData1D -->
<g id="proc~~state_init~~UsesGraph_edge60" class="edge"><title>module~m_mixing&#45;&gt;class_Fstack_dData1D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M176.476,-519.941C155.34,-493.18 104.317,-428.579 78.1177,-395.407"/>
<polygon fill="#000000" stroke="#000000" points="80.6724,-392.995 71.7276,-387.316 75.1791,-397.333 80.6724,-392.995"/>
</g>
<!-- class_dData1D -->
<g id="proc~~state_init~~UsesGraph_node61" class="node"><title>class_dData1D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="103.5,-544 18.5,-544 18.5,-520 103.5,-520 103.5,-544"/>
<text text-anchor="middle" x="61" y="-529.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_dData1D</text>
</g>
<!-- module~m_mixing&#45;&gt;class_dData1D -->
<g id="proc~~state_init~~UsesGraph_edge61" class="edge"><title>module~m_mixing&#45;&gt;class_dData1D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M157.862,-532C144.858,-532 128.985,-532 113.928,-532"/>
<polygon fill="#000000" stroke="#000000" points="113.678,-528.5 103.678,-532 113.678,-535.5 113.678,-528.5"/>
</g>
<!-- module~m_mixing_scf&#45;&gt;module~m_mixing -->
<g id="proc~~state_init~~UsesGraph_edge63" class="edge"><title>module~m_mixing_scf&#45;&gt;module~m_mixing</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M268.491,-104.654C262.198,-107.631 256.325,-111.63 252,-117 202.533,-178.421 190.966,-432.45 188.57,-509.648"/>
<polygon fill="#000000" stroke="#000000" points="185.07,-509.614 188.28,-519.711 192.067,-509.816 185.07,-509.614"/>
</g>
<!-- module~m_mixing_scf&#45;&gt;class_Fstack_dData1D -->
<g id="proc~~state_init~~UsesGraph_edge62" class="edge"><title>module~m_mixing_scf&#45;&gt;class_Fstack_dData1D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M268.367,-107.459C262.585,-110.091 256.917,-113.247 252,-117 163.056,-184.884 96.5853,-305.368 72.182,-353.888"/>
<polygon fill="#000000" stroke="#000000" points="69.045,-352.336 67.7437,-362.85 75.318,-355.442 69.045,-352.336"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="490pt" height="32pt"
 viewBox="0.00 0.00 489.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 485.5,-28 485.5,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node"><title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node"><title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="139.5,-24 72.5,-24 72.5,-0 139.5,-0 139.5,-24"/>
<text text-anchor="middle" x="106" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="222,-24 158,-24 158,-0 222,-0 222,-24"/>
<text text-anchor="middle" x="190" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="294,-24 240,-24 240,-0 294,-0 294,-24"/>
<text text-anchor="middle" x="267" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="366,-24 312,-24 312,-0 366,-0 366,-24"/>
<text text-anchor="middle" x="339" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="481.5,-24 384.5,-24 384.5,-0 481.5,-0 481.5,-24"/>
<text text-anchor="middle" x="433" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses.
    </p>
    </div></div></div></div>
      </li>
      
      </ul>
    </div>
    


    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-istep%7E2"></span>integer</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>istep</strong></td><td></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~state_init~~CallsGraph Pages: 1 -->
<svg id="procstate_initCallsGraph" width="427pt" height="2746pt"
 viewBox="0.00 0.00 427.00 2746.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~state_init~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 2742)">
<title>proc~~state_init~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-2742 423,-2742 423,4 -4,4"/>
<!-- proc~state_init -->
<g id="proc~~state_init~~CallsGraph_node1" class="node"><title>proc~state_init</title>
<polygon fill="none" stroke="black" points="55,-1389 0,-1389 0,-1365 55,-1365 55,-1389"/>
<text text-anchor="middle" x="27.5" y="-1374.6" font-family="Helvetica,sans-Serif" font-size="10.50">state_init</text>
</g>
<!-- volcel -->
<g id="proc~~state_init~~CallsGraph_node2" class="node"><title>volcel</title>
<polygon fill="#777777" stroke="#777777" points="181,-2738 127,-2738 127,-2714 181,-2714 181,-2738"/>
<text text-anchor="middle" x="154" y="-2723.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">volcel</text>
</g>
<!-- proc~state_init&#45;&gt;volcel -->
<g id="proc~~state_init~~CallsGraph_edge1" class="edge"><title>proc~state_init&#45;&gt;volcel</title>
<path fill="none" stroke="#000000" d="M28.6814,-1389.16C30.6686,-1519.22 49.1197,-2649.41 91,-2705 97.3081,-2713.37 107.121,-2718.44 117.093,-2721.49"/>
<polygon fill="#000000" stroke="#000000" points="116.449,-2724.94 126.995,-2723.93 118.119,-2718.14 116.449,-2724.94"/>
</g>
<!-- kpoint_delete -->
<g id="proc~~state_init~~CallsGraph_node3" class="node"><title>kpoint_delete</title>
<polygon fill="#777777" stroke="#777777" points="192,-2696 116,-2696 116,-2672 192,-2672 192,-2696"/>
<text text-anchor="middle" x="154" y="-2681.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">kpoint_delete</text>
</g>
<!-- proc~state_init&#45;&gt;kpoint_delete -->
<g id="proc~~state_init~~CallsGraph_edge43" class="edge"><title>proc~state_init&#45;&gt;kpoint_delete</title>
<path fill="none" stroke="#000000" d="M28.7009,-1389.17C30.8568,-1516.99 50.442,-2609.25 91,-2663 94.953,-2668.24 100.278,-2672.18 106.154,-2675.15"/>
<polygon fill="#000000" stroke="#000000" points="105.143,-2678.52 115.724,-2679.05 107.786,-2672.04 105.143,-2678.52"/>
</g>
<!-- mscell -->
<g id="proc~~state_init~~CallsGraph_node4" class="node"><title>mscell</title>
<polygon fill="#777777" stroke="#777777" points="181,-2654 127,-2654 127,-2630 181,-2630 181,-2654"/>
<text text-anchor="middle" x="154" y="-2639.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mscell</text>
</g>
<!-- proc~state_init&#45;&gt;mscell -->
<g id="proc~~state_init~~CallsGraph_edge3" class="edge"><title>proc~state_init&#45;&gt;mscell</title>
<path fill="none" stroke="#000000" d="M28.7212,-1389.16C31.0496,-1514.61 51.7617,-2569.08 91,-2621 97.2699,-2629.3 106.978,-2634.34 116.866,-2637.41"/>
<polygon fill="#000000" stroke="#000000" points="116.144,-2640.83 126.693,-2639.85 117.836,-2634.04 116.144,-2640.83"/>
</g>
<!-- escf -->
<g id="proc~~state_init~~CallsGraph_node5" class="node"><title>escf</title>
<polygon fill="#777777" stroke="#777777" points="181,-2612 127,-2612 127,-2588 181,-2588 181,-2612"/>
<text text-anchor="middle" x="154" y="-2597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">escf</text>
</g>
<!-- proc~state_init&#45;&gt;escf -->
<g id="proc~~state_init~~CallsGraph_edge4" class="edge"><title>proc~state_init&#45;&gt;escf</title>
<path fill="none" stroke="#000000" d="M28.7426,-1389.13C31.2472,-1512.08 53.0786,-2528.92 91,-2579 97.2772,-2587.29 106.988,-2592.34 116.875,-2595.4"/>
<polygon fill="#000000" stroke="#000000" points="116.152,-2598.83 126.701,-2597.85 117.844,-2592.03 116.152,-2598.83"/>
</g>
<!-- re_alloc -->
<g id="proc~~state_init~~CallsGraph_node6" class="node"><title>re_alloc</title>
<polygon fill="#777777" stroke="#777777" points="181,-2570 127,-2570 127,-2546 181,-2546 181,-2570"/>
<text text-anchor="middle" x="154" y="-2555.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">re_alloc</text>
</g>
<!-- proc~state_init&#45;&gt;re_alloc -->
<g id="proc~~state_init~~CallsGraph_edge5" class="edge"><title>proc~state_init&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M28.7649,-1389.08C31.4494,-1509.41 54.3927,-2488.75 91,-2537 97.285,-2545.28 106.998,-2550.33 116.885,-2553.39"/>
<polygon fill="#000000" stroke="#000000" points="116.16,-2556.82 126.71,-2555.84 117.853,-2550.03 116.16,-2556.82"/>
</g>
<!-- newddata2d -->
<g id="proc~~state_init~~CallsGraph_node7" class="node"><title>newddata2d</title>
<polygon fill="#777777" stroke="#777777" points="189.5,-2528 118.5,-2528 118.5,-2504 189.5,-2504 189.5,-2528"/>
<text text-anchor="middle" x="154" y="-2513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">newddata2d</text>
</g>
<!-- proc~state_init&#45;&gt;newddata2d -->
<g id="proc~~state_init~~CallsGraph_edge6" class="edge"><title>proc~state_init&#45;&gt;newddata2d</title>
<path fill="none" stroke="#000000" d="M28.3675,-1389.18C27.2162,-1504.53 20.5552,-2402.34 91,-2495 95.5394,-2500.97 101.859,-2505.26 108.74,-2508.33"/>
<polygon fill="#000000" stroke="#000000" points="107.761,-2511.7 118.355,-2511.82 110.147,-2505.12 107.761,-2511.7"/>
</g>
<!-- nsc -->
<g id="proc~~state_init~~CallsGraph_node8" class="node"><title>nsc</title>
<polygon fill="#777777" stroke="#777777" points="181,-2486 127,-2486 127,-2462 181,-2462 181,-2486"/>
<text text-anchor="middle" x="154" y="-2471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nsc</text>
</g>
<!-- proc~state_init&#45;&gt;nsc -->
<g id="proc~~state_init~~CallsGraph_edge7" class="edge"><title>proc~state_init&#45;&gt;nsc</title>
<path fill="none" stroke="#000000" d="M28.4396,-1389.34C27.9855,-1502.46 26.701,-2357.17 91,-2448 97.286,-2456.88 107.214,-2462.74 117.298,-2466.6"/>
<polygon fill="#000000" stroke="#000000" points="116.309,-2469.96 126.901,-2469.73 118.475,-2463.3 116.309,-2469.96"/>
</g>
<!-- proc~mixers_history_init -->
<g id="proc~~state_init~~CallsGraph_node9" class="node"><title>proc~mixers_history_init</title>
<g id="a_proc~~state_init~~CallsGraph_node9"><a xlink:href=".././proc/mixers_history_init.html" xlink:title="mixers_history_init">
<polygon fill="#d9534f" stroke="#d9534f" points="204.5,-2406 103.5,-2406 103.5,-2382 204.5,-2382 204.5,-2406"/>
<text text-anchor="middle" x="154" y="-2391.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mixers_history_init</text>
</a>
</g>
</g>
<!-- proc~state_init&#45;&gt;proc~mixers_history_init -->
<g id="proc~~state_init~~CallsGraph_edge8" class="edge"><title>proc~state_init&#45;&gt;proc~mixers_history_init</title>
<path fill="none" stroke="#000000" d="M28.4558,-1389.18C28.1668,-1497.3 28.1989,-2290.98 91,-2373 92.2436,-2374.62 93.6188,-2376.12 95.101,-2377.51"/>
<polygon fill="#000000" stroke="#000000" points="93.1561,-2380.42 103.289,-2383.52 97.2969,-2374.78 93.1561,-2380.42"/>
</g>
<!-- globalize_or -->
<g id="proc~~state_init~~CallsGraph_node10" class="node"><title>globalize_or</title>
<polygon fill="#777777" stroke="#777777" points="189,-2364 119,-2364 119,-2340 189,-2340 189,-2364"/>
<text text-anchor="middle" x="154" y="-2349.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">globalize_or</text>
</g>
<!-- proc~state_init&#45;&gt;globalize_or -->
<g id="proc~~state_init~~CallsGraph_edge9" class="edge"><title>proc~state_init&#45;&gt;globalize_or</title>
<path fill="none" stroke="#000000" d="M28.4915,-1389.32C28.5222,-1495.42 30.8549,-2252.67 91,-2331 95.6156,-2337.01 102.034,-2341.32 109.002,-2344.39"/>
<polygon fill="#000000" stroke="#000000" points="108.133,-2347.8 118.728,-2347.88 110.494,-2341.21 108.133,-2347.8"/>
</g>
<!-- iotdxv -->
<g id="proc~~state_init~~CallsGraph_node11" class="node"><title>iotdxv</title>
<polygon fill="#777777" stroke="#777777" points="181,-2322 127,-2322 127,-2298 181,-2298 181,-2322"/>
<text text-anchor="middle" x="154" y="-2307.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iotdxv</text>
</g>
<!-- proc~state_init&#45;&gt;iotdxv -->
<g id="proc~~state_init~~CallsGraph_edge10" class="edge"><title>proc~state_init&#45;&gt;iotdxv</title>
<path fill="none" stroke="#000000" d="M28.53,-1389.1C28.8866,-1491.74 33.4393,-2214.27 91,-2289 97.3453,-2297.24 107.075,-2302.27 116.96,-2305.34"/>
<polygon fill="#000000" stroke="#000000" points="116.226,-2308.76 126.776,-2307.79 117.924,-2301.97 116.226,-2308.76"/>
</g>
<!-- timer -->
<g id="proc~~state_init~~CallsGraph_node12" class="node"><title>timer</title>
<polygon fill="#777777" stroke="#777777" points="181,-2280 127,-2280 127,-2256 181,-2256 181,-2280"/>
<text text-anchor="middle" x="154" y="-2265.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">timer</text>
</g>
<!-- proc~state_init&#45;&gt;timer -->
<g id="proc~~state_init~~CallsGraph_edge54" class="edge"><title>proc~state_init&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M28.5728,-1389.17C29.2745,-1489.36 36.0759,-2175.93 91,-2247 97.3588,-2255.23 107.093,-2260.26 116.976,-2263.32"/>
<polygon fill="#000000" stroke="#000000" points="116.24,-2266.75 126.791,-2265.78 117.94,-2259.96 116.24,-2266.75"/>
</g>
<!-- time_io -->
<g id="proc~~state_init~~CallsGraph_node13" class="node"><title>time_io</title>
<polygon fill="#777777" stroke="#777777" points="181,-2238 127,-2238 127,-2214 181,-2214 181,-2238"/>
<text text-anchor="middle" x="154" y="-2223.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">time_io</text>
</g>
<!-- proc~state_init&#45;&gt;time_io -->
<g id="proc~~state_init~~CallsGraph_edge12" class="edge"><title>proc~state_init&#45;&gt;time_io</title>
<path fill="none" stroke="#000000" d="M28.6656,-1389.09C30.0857,-1485.77 41.3936,-2131.21 91,-2200 97.3635,-2208.82 107.313,-2214.67 117.392,-2218.54"/>
<polygon fill="#000000" stroke="#000000" points="116.392,-2221.89 126.984,-2221.67 118.565,-2215.24 116.392,-2221.89"/>
</g>
<!-- proc~check_cohp -->
<g id="proc~~state_init~~CallsGraph_node14" class="node"><title>proc~check_cohp</title>
<g id="a_proc~~state_init~~CallsGraph_node14"><a xlink:href=".././proc/check_cohp.html" xlink:title="check_cohp">
<polygon fill="#d9534f" stroke="#d9534f" points="189,-2158 119,-2158 119,-2134 189,-2134 189,-2158"/>
<text text-anchor="middle" x="154" y="-2143.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_cohp</text>
</a>
</g>
</g>
<!-- proc~state_init&#45;&gt;proc~check_cohp -->
<g id="proc~~state_init~~CallsGraph_edge15" class="edge"><title>proc~state_init&#45;&gt;proc~check_cohp</title>
<path fill="none" stroke="#000000" d="M28.769,-1389.05C30.8972,-1480.13 46.1248,-2058.3 91,-2120 95.7307,-2126.5 102.407,-2131.39 109.638,-2135.06"/>
<polygon fill="#000000" stroke="#000000" points="108.421,-2138.35 118.99,-2139.08 111.188,-2131.92 108.421,-2138.35"/>
</g>
<!-- delete -->
<g id="proc~~state_init~~CallsGraph_node15" class="node"><title>delete</title>
<polygon fill="#777777" stroke="#777777" points="310.5,-2447 256.5,-2447 256.5,-2423 310.5,-2423 310.5,-2447"/>
<text text-anchor="middle" x="283.5" y="-2432.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">delete</text>
</g>
<!-- proc~state_init&#45;&gt;delete -->
<g id="proc~~state_init~~CallsGraph_edge66" class="edge"><title>proc~state_init&#45;&gt;delete</title>
<path fill="none" stroke="#000000" d="M28.7882,-1389.25C31.5262,-1503.28 53.67,-2375.99 91,-2415 130.584,-2456.36 202.916,-2451.33 246.461,-2443.47"/>
<polygon fill="#000000" stroke="#000000" points="247.199,-2446.89 256.347,-2441.55 245.863,-2440.02 247.199,-2446.89"/>
</g>
<!-- file_exist -->
<g id="proc~~state_init~~CallsGraph_node16" class="node"><title>file_exist</title>
<polygon fill="#777777" stroke="#777777" points="181,-2040 127,-2040 127,-2016 181,-2016 181,-2040"/>
<text text-anchor="middle" x="154" y="-2025.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">file_exist</text>
</g>
<!-- proc~state_init&#45;&gt;file_exist -->
<g id="proc~~state_init~~CallsGraph_edge16" class="edge"><title>proc~state_init&#45;&gt;file_exist</title>
<path fill="none" stroke="#000000" d="M28.919,-1389.04C31.9045,-1471.98 50.9935,-1956.66 91,-2007 97.47,-2015.14 107.235,-2020.14 117.114,-2023.21"/>
<polygon fill="#000000" stroke="#000000" points="116.361,-2026.63 126.913,-2025.68 118.071,-2019.85 116.361,-2026.63"/>
</g>
<!-- listhptr -->
<g id="proc~~state_init~~CallsGraph_node17" class="node"><title>listhptr</title>
<polygon fill="#777777" stroke="#777777" points="181,-1998 127,-1998 127,-1974 181,-1974 181,-1998"/>
<text text-anchor="middle" x="154" y="-1983.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">listhptr</text>
</g>
<!-- proc~state_init&#45;&gt;listhptr -->
<g id="proc~~state_init~~CallsGraph_edge17" class="edge"><title>proc~state_init&#45;&gt;listhptr</title>
<path fill="none" stroke="#000000" d="M29.0179,-1389.26C32.511,-1469.52 53.6295,-1918.32 91,-1965 97.4985,-1973.12 107.272,-1978.12 117.149,-1981.19"/>
<polygon fill="#000000" stroke="#000000" points="116.391,-1984.6 126.944,-1983.66 118.105,-1977.82 116.391,-1984.6"/>
</g>
<!-- crtsparsity_sc -->
<g id="proc~~state_init~~CallsGraph_node18" class="node"><title>crtsparsity_sc</title>
<polygon fill="#777777" stroke="#777777" points="193,-1956 115,-1956 115,-1932 193,-1932 193,-1956"/>
<text text-anchor="middle" x="154" y="-1941.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">crtsparsity_sc</text>
</g>
<!-- proc~state_init&#45;&gt;crtsparsity_sc -->
<g id="proc~~state_init~~CallsGraph_edge18" class="edge"><title>proc~state_init&#45;&gt;crtsparsity_sc</title>
<path fill="none" stroke="#000000" d="M29.1285,-1389.36C33.1524,-1466.5 56.2427,-1879.94 91,-1923 94.8411,-1927.76 99.8069,-1931.44 105.255,-1934.3"/>
<polygon fill="#000000" stroke="#000000" points="104.194,-1937.65 114.765,-1938.36 106.942,-1931.21 104.194,-1937.65"/>
</g>
<!-- setup_kpoint_scf -->
<g id="proc~~state_init~~CallsGraph_node19" class="node"><title>setup_kpoint_scf</title>
<polygon fill="#777777" stroke="#777777" points="200.5,-1914 107.5,-1914 107.5,-1890 200.5,-1890 200.5,-1914"/>
<text text-anchor="middle" x="154" y="-1899.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_kpoint_scf</text>
</g>
<!-- proc~state_init&#45;&gt;setup_kpoint_scf -->
<g id="proc~~state_init~~CallsGraph_edge19" class="edge"><title>proc~state_init&#45;&gt;setup_kpoint_scf</title>
<path fill="none" stroke="#000000" d="M28.3209,-1389.11C27.5393,-1458.21 26.9442,-1802.4 91,-1881 93.1538,-1883.64 95.6543,-1885.95 98.3906,-1887.98"/>
<polygon fill="#000000" stroke="#000000" points="96.8124,-1891.11 107.196,-1893.22 100.391,-1885.09 96.8124,-1891.11"/>
</g>
<!-- proximity_check -->
<g id="proc~~state_init~~CallsGraph_node20" class="node"><title>proximity_check</title>
<polygon fill="#777777" stroke="#777777" points="198.5,-1872 109.5,-1872 109.5,-1848 198.5,-1848 198.5,-1872"/>
<text text-anchor="middle" x="154" y="-1857.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">proximity_check</text>
</g>
<!-- proc~state_init&#45;&gt;proximity_check -->
<g id="proc~~state_init~~CallsGraph_edge20" class="edge"><title>proc~state_init&#45;&gt;proximity_check</title>
<path fill="none" stroke="#000000" d="M28.4726,-1389.38C28.5704,-1455.6 32.1847,-1767.64 91,-1839 93.7241,-1842.31 96.9899,-1845.09 100.579,-1847.44"/>
<polygon fill="#000000" stroke="#000000" points="98.9664,-1850.55 109.436,-1852.17 102.263,-1844.37 98.9664,-1850.55"/>
</g>
<!-- siesta_write_positions -->
<g id="proc~~state_init~~CallsGraph_node21" class="node"><title>siesta_write_positions</title>
<polygon fill="#777777" stroke="#777777" points="212.5,-1830 95.5,-1830 95.5,-1806 212.5,-1806 212.5,-1830"/>
<text text-anchor="middle" x="154" y="-1815.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_write_positions</text>
</g>
<!-- proc~state_init&#45;&gt;siesta_write_positions -->
<g id="proc~~state_init~~CallsGraph_edge56" class="edge"><title>proc~state_init&#45;&gt;siesta_write_positions</title>
<path fill="none" stroke="#000000" d="M28.6524,-1389.06C29.6708,-1450.98 37.2374,-1732.65 91,-1797 91.7286,-1797.87 92.4949,-1798.71 93.2948,-1799.51"/>
<polygon fill="#000000" stroke="#000000" points="91.2763,-1802.38 101.293,-1805.83 95.6159,-1796.88 91.2763,-1802.38"/>
</g>
<!-- superc -->
<g id="proc~~state_init~~CallsGraph_node22" class="node"><title>superc</title>
<polygon fill="#777777" stroke="#777777" points="181,-1788 127,-1788 127,-1764 181,-1764 181,-1788"/>
<text text-anchor="middle" x="154" y="-1773.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">superc</text>
</g>
<!-- proc~state_init&#45;&gt;superc -->
<g id="proc~~state_init~~CallsGraph_edge22" class="edge"><title>proc~state_init&#45;&gt;superc</title>
<path fill="none" stroke="#000000" d="M28.8828,-1389.38C30.9379,-1448.08 42.4545,-1697.83 91,-1755 97.6758,-1762.86 107.41,-1767.79 117.195,-1770.87"/>
<polygon fill="#000000" stroke="#000000" points="116.327,-1774.26 126.886,-1773.38 118.083,-1767.49 116.327,-1774.26"/>
</g>
<!-- attach -->
<g id="proc~~state_init~~CallsGraph_node23" class="node"><title>attach</title>
<polygon fill="#777777" stroke="#777777" points="181,-1746 127,-1746 127,-1722 181,-1722 181,-1746"/>
<text text-anchor="middle" x="154" y="-1731.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">attach</text>
</g>
<!-- proc~state_init&#45;&gt;attach -->
<g id="proc~~state_init~~CallsGraph_edge23" class="edge"><title>proc~state_init&#45;&gt;attach</title>
<path fill="none" stroke="#000000" d="M29.1455,-1389.08C32.2681,-1443.2 47.4787,-1662.78 91,-1713 97.7543,-1720.79 107.511,-1725.7 117.293,-1728.79"/>
<polygon fill="#000000" stroke="#000000" points="116.414,-1732.18 126.973,-1731.31 118.178,-1725.4 116.414,-1732.18"/>
</g>
<!-- cmlendpropertylist -->
<g id="proc~~state_init~~CallsGraph_node24" class="node"><title>cmlendpropertylist</title>
<polygon fill="#777777" stroke="#777777" points="204,-1704 104,-1704 104,-1680 204,-1680 204,-1704"/>
<text text-anchor="middle" x="154" y="-1689.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cmlendpropertylist</text>
</g>
<!-- proc~state_init&#45;&gt;cmlendpropertylist -->
<g id="proc~~state_init~~CallsGraph_edge24" class="edge"><title>proc~state_init&#45;&gt;cmlendpropertylist</title>
<path fill="none" stroke="#000000" d="M29.507,-1389.23C33.8597,-1439.26 52.5966,-1627.81 91,-1671 92.3593,-1672.53 93.834,-1673.95 95.4012,-1675.26"/>
<polygon fill="#000000" stroke="#000000" points="93.6569,-1678.31 103.901,-1681.01 97.5796,-1672.51 93.6569,-1678.31"/>
</g>
<!-- newdspdata1d -->
<g id="proc~~state_init~~CallsGraph_node25" class="node"><title>newdspdata1d</title>
<polygon fill="#777777" stroke="#777777" points="195,-1662 113,-1662 113,-1638 195,-1638 195,-1662"/>
<text text-anchor="middle" x="154" y="-1647.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">newdspdata1d</text>
</g>
<!-- proc~state_init&#45;&gt;newdspdata1d -->
<g id="proc~~state_init~~CallsGraph_edge25" class="edge"><title>proc~state_init&#45;&gt;newdspdata1d</title>
<path fill="none" stroke="#000000" d="M29.9843,-1389.3C35.7024,-1434.8 57.6617,-1592.76 91,-1629 94.5631,-1632.87 98.8662,-1636.03 103.525,-1638.61"/>
<polygon fill="#000000" stroke="#000000" points="102.273,-1641.89 112.821,-1642.88 105.196,-1635.53 102.273,-1641.89"/>
</g>
<!-- ts_sparse_init -->
<g id="proc~~state_init~~CallsGraph_node26" class="node"><title>ts_sparse_init</title>
<polygon fill="#777777" stroke="#777777" points="193.5,-1620 114.5,-1620 114.5,-1596 193.5,-1596 193.5,-1620"/>
<text text-anchor="middle" x="154" y="-1605.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ts_sparse_init</text>
</g>
<!-- proc~state_init&#45;&gt;ts_sparse_init -->
<g id="proc~~state_init~~CallsGraph_edge27" class="edge"><title>proc~state_init&#45;&gt;ts_sparse_init</title>
<path fill="none" stroke="#000000" d="M28.4565,-1389.08C28.995,-1424.52 35.4469,-1529.33 91,-1587 94.9423,-1591.09 99.7098,-1594.39 104.83,-1597.04"/>
<polygon fill="#000000" stroke="#000000" points="103.757,-1600.39 114.324,-1601.15 106.541,-1593.97 103.757,-1600.39"/>
</g>
<!-- setup_dm_netcdf_file -->
<g id="proc~~state_init~~CallsGraph_node27" class="node"><title>setup_dm_netcdf_file</title>
<polygon fill="#777777" stroke="#777777" points="211.5,-1578 96.5,-1578 96.5,-1554 211.5,-1554 211.5,-1578"/>
<text text-anchor="middle" x="154" y="-1563.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_dm_netcdf_file</text>
</g>
<!-- proc~state_init&#45;&gt;setup_dm_netcdf_file -->
<g id="proc~~state_init~~CallsGraph_edge28" class="edge"><title>proc~state_init&#45;&gt;setup_dm_netcdf_file</title>
<path fill="none" stroke="#000000" d="M29.5034,-1389.06C32.6845,-1419.56 45.2278,-1500.56 91,-1545 92.2613,-1546.22 93.5966,-1547.38 94.9922,-1548.46"/>
<polygon fill="#000000" stroke="#000000" points="93.2497,-1551.5 103.552,-1553.98 97.041,-1545.62 93.2497,-1551.5"/>
</g>
<!-- sp_to_spglobal -->
<g id="proc~~state_init~~CallsGraph_node28" class="node"><title>sp_to_spglobal</title>
<polygon fill="#777777" stroke="#777777" points="196.5,-1536 111.5,-1536 111.5,-1512 196.5,-1512 196.5,-1536"/>
<text text-anchor="middle" x="154" y="-1521.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sp_to_spglobal</text>
</g>
<!-- proc~state_init&#45;&gt;sp_to_spglobal -->
<g id="proc~~state_init~~CallsGraph_edge26" class="edge"><title>proc~state_init&#45;&gt;sp_to_spglobal</title>
<path fill="none" stroke="#000000" d="M31.2528,-1389.33C37.4746,-1414.37 54.97,-1471.5 91,-1503 94.2725,-1505.86 97.9512,-1508.34 101.842,-1510.48"/>
<polygon fill="#000000" stroke="#000000" points="100.674,-1513.8 111.212,-1514.89 103.655,-1507.46 100.674,-1513.8"/>
</g>
<!-- proc~die -->
<g id="proc~~state_init~~CallsGraph_node29" class="node"><title>proc~die</title>
<g id="a_proc~~state_init~~CallsGraph_node29"><a xlink:href=".././proc/die.html" xlink:title="die">
<polygon fill="#d9534f" stroke="#d9534f" points="310.5,-2118 256.5,-2118 256.5,-2094 310.5,-2094 310.5,-2118"/>
<text text-anchor="middle" x="283.5" y="-2103.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">die</text>
</a>
</g>
</g>
<!-- proc~state_init&#45;&gt;proc~die -->
<g id="proc~~state_init~~CallsGraph_edge30" class="edge"><title>proc~state_init&#45;&gt;proc~die</title>
<path fill="none" stroke="#000000" d="M28.7134,-1389.24C30.3741,-1478.07 42.4865,-2021.64 91,-2074 130.156,-2116.26 202.382,-2116.35 246.071,-2111.75"/>
<polygon fill="#000000" stroke="#000000" points="246.745,-2115.19 256.261,-2110.54 245.917,-2108.24 246.745,-2115.19"/>
</g>
<!-- ioxv -->
<g id="proc~~state_init~~CallsGraph_node30" class="node"><title>ioxv</title>
<polygon fill="#777777" stroke="#777777" points="181,-1494 127,-1494 127,-1470 181,-1470 181,-1494"/>
<text text-anchor="middle" x="154" y="-1479.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ioxv</text>
</g>
<!-- proc~state_init&#45;&gt;ioxv -->
<g id="proc~~state_init~~CallsGraph_edge31" class="edge"><title>proc~state_init&#45;&gt;ioxv</title>
<path fill="none" stroke="#000000" d="M34.4413,-1389.12C43.9433,-1407.29 64.246,-1441.54 91,-1461 98.7617,-1466.65 108.15,-1470.85 117.247,-1473.95"/>
<polygon fill="#000000" stroke="#000000" points="116.326,-1477.33 126.912,-1476.9 118.369,-1470.64 116.326,-1477.33"/>
</g>
<!-- setup_ts_kpoint_scf -->
<g id="proc~~state_init~~CallsGraph_node31" class="node"><title>setup_ts_kpoint_scf</title>
<polygon fill="#777777" stroke="#777777" points="207.5,-1452 100.5,-1452 100.5,-1428 207.5,-1428 207.5,-1452"/>
<text text-anchor="middle" x="154" y="-1437.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_ts_kpoint_scf</text>
</g>
<!-- proc~state_init&#45;&gt;setup_ts_kpoint_scf -->
<g id="proc~~state_init~~CallsGraph_edge32" class="edge"><title>proc~state_init&#45;&gt;setup_ts_kpoint_scf</title>
<path fill="none" stroke="#000000" d="M44.2308,-1389.29C56.4584,-1398.41 74.1243,-1410.66 91,-1419 94.7822,-1420.87 98.7712,-1422.64 102.828,-1424.3"/>
<polygon fill="#000000" stroke="#000000" points="101.759,-1427.64 112.349,-1427.96 104.273,-1421.1 101.759,-1427.64"/>
</g>
<!-- init_val -->
<g id="proc~~state_init~~CallsGraph_node32" class="node"><title>init_val</title>
<polygon fill="#777777" stroke="#777777" points="181,-1410 127,-1410 127,-1386 181,-1386 181,-1410"/>
<text text-anchor="middle" x="154" y="-1395.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_val</text>
</g>
<!-- proc~state_init&#45;&gt;init_val -->
<g id="proc~~state_init~~CallsGraph_edge33" class="edge"><title>proc~state_init&#45;&gt;init_val</title>
<path fill="none" stroke="#000000" d="M55.2084,-1381.51C73.2181,-1384.54 97.1968,-1388.59 116.902,-1391.91"/>
<polygon fill="#000000" stroke="#000000" points="116.32,-1395.36 126.763,-1393.57 117.485,-1388.46 116.32,-1395.36"/>
</g>
<!-- newsparsity -->
<g id="proc~~state_init~~CallsGraph_node33" class="node"><title>newsparsity</title>
<polygon fill="#777777" stroke="#777777" points="188.5,-1368 119.5,-1368 119.5,-1344 188.5,-1344 188.5,-1368"/>
<text text-anchor="middle" x="154" y="-1353.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">newsparsity</text>
</g>
<!-- proc~state_init&#45;&gt;newsparsity -->
<g id="proc~~state_init~~CallsGraph_edge14" class="edge"><title>proc~state_init&#45;&gt;newsparsity</title>
<path fill="none" stroke="#000000" d="M55.2084,-1372.49C70.9301,-1369.84 91.2004,-1366.42 109.206,-1363.39"/>
<polygon fill="#000000" stroke="#000000" points="109.934,-1366.81 119.212,-1361.7 108.769,-1359.91 109.934,-1366.81"/>
</g>
<!-- setup_ordern_indexes -->
<g id="proc~~state_init~~CallsGraph_node34" class="node"><title>setup_ordern_indexes</title>
<polygon fill="#777777" stroke="#777777" points="213.5,-1326 94.5,-1326 94.5,-1302 213.5,-1302 213.5,-1326"/>
<text text-anchor="middle" x="154" y="-1311.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_ordern_indexes</text>
</g>
<!-- proc~state_init&#45;&gt;setup_ordern_indexes -->
<g id="proc~~state_init~~CallsGraph_edge35" class="edge"><title>proc~state_init&#45;&gt;setup_ordern_indexes</title>
<path fill="none" stroke="#000000" d="M44.2308,-1364.71C56.4584,-1355.59 74.1243,-1343.34 91,-1335 94.7822,-1333.13 98.7712,-1331.36 102.828,-1329.7"/>
<polygon fill="#000000" stroke="#000000" points="104.273,-1332.9 112.349,-1326.04 101.759,-1326.36 104.273,-1332.9"/>
</g>
<!-- setup_dmhs_netcdf_file -->
<g id="proc~~state_init~~CallsGraph_node35" class="node"><title>setup_dmhs_netcdf_file</title>
<polygon fill="#777777" stroke="#777777" points="217,-1284 91,-1284 91,-1260 217,-1260 217,-1284"/>
<text text-anchor="middle" x="154" y="-1269.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_dmhs_netcdf_file</text>
</g>
<!-- proc~state_init&#45;&gt;setup_dmhs_netcdf_file -->
<g id="proc~~state_init~~CallsGraph_edge13" class="edge"><title>proc~state_init&#45;&gt;setup_dmhs_netcdf_file</title>
<path fill="none" stroke="#000000" d="M34.4413,-1364.88C43.9433,-1346.71 64.246,-1312.46 91,-1293 93.0909,-1291.48 95.2997,-1290.06 97.5891,-1288.74"/>
<polygon fill="#000000" stroke="#000000" points="99.3861,-1291.76 106.739,-1284.13 96.2345,-1285.51 99.3861,-1291.76"/>
</g>
<!-- cmlstartpropertylist -->
<g id="proc~~state_init~~CallsGraph_node36" class="node"><title>cmlstartpropertylist</title>
<polygon fill="#777777" stroke="#777777" points="205.5,-1242 102.5,-1242 102.5,-1218 205.5,-1218 205.5,-1242"/>
<text text-anchor="middle" x="154" y="-1227.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cmlstartpropertylist</text>
</g>
<!-- proc~state_init&#45;&gt;cmlstartpropertylist -->
<g id="proc~~state_init~~CallsGraph_edge61" class="edge"><title>proc~state_init&#45;&gt;cmlstartpropertylist</title>
<path fill="none" stroke="#000000" d="M31.2528,-1364.67C37.4746,-1339.63 54.97,-1282.5 91,-1251 92.5079,-1249.68 94.1021,-1248.45 95.7634,-1247.29"/>
<polygon fill="#000000" stroke="#000000" points="97.7081,-1250.2 104.542,-1242.11 94.1512,-1244.17 97.7081,-1250.2"/>
</g>
<!-- newdspdata2d -->
<g id="proc~~state_init~~CallsGraph_node37" class="node"><title>newdspdata2d</title>
<polygon fill="#777777" stroke="#777777" points="195,-1200 113,-1200 113,-1176 195,-1176 195,-1200"/>
<text text-anchor="middle" x="154" y="-1185.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">newdspdata2d</text>
</g>
<!-- proc~state_init&#45;&gt;newdspdata2d -->
<g id="proc~~state_init~~CallsGraph_edge38" class="edge"><title>proc~state_init&#45;&gt;newdspdata2d</title>
<path fill="none" stroke="#000000" d="M29.5034,-1364.94C32.6845,-1334.44 45.2278,-1253.44 91,-1209 94.6769,-1205.43 98.9822,-1202.47 103.58,-1200.01"/>
<polygon fill="#000000" stroke="#000000" points="105.037,-1203.19 112.696,-1195.87 102.143,-1196.81 105.037,-1203.19"/>
</g>
<!-- new_dm -->
<g id="proc~~state_init~~CallsGraph_node38" class="node"><title>new_dm</title>
<polygon fill="#777777" stroke="#777777" points="181,-1158 127,-1158 127,-1134 181,-1134 181,-1158"/>
<text text-anchor="middle" x="154" y="-1143.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">new_dm</text>
</g>
<!-- proc~state_init&#45;&gt;new_dm -->
<g id="proc~~state_init~~CallsGraph_edge39" class="edge"><title>proc~state_init&#45;&gt;new_dm</title>
<path fill="none" stroke="#000000" d="M28.4565,-1364.92C28.995,-1329.48 35.4469,-1224.67 91,-1167 97.9638,-1159.77 107.502,-1155.03 117.01,-1151.92"/>
<polygon fill="#000000" stroke="#000000" points="118.079,-1155.26 126.797,-1149.24 116.228,-1148.51 118.079,-1155.26"/>
</g>
<!-- proc~message -->
<g id="proc~~state_init~~CallsGraph_node39" class="node"><title>proc~message</title>
<g id="a_proc~~state_init~~CallsGraph_node39"><a xlink:href=".././proc/message.html" xlink:title="message">
<polygon fill="#d9534f" stroke="#d9534f" points="311.5,-2198 255.5,-2198 255.5,-2174 311.5,-2174 311.5,-2198"/>
<text text-anchor="middle" x="283.5" y="-2183.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">message</text>
</a>
</g>
</g>
<!-- proc~state_init&#45;&gt;proc~message -->
<g id="proc~~state_init~~CallsGraph_edge40" class="edge"><title>proc~state_init&#45;&gt;proc~message</title>
<path fill="none" stroke="#000000" d="M28.5415,-1389.04C28.9839,-1483.92 34.0568,-2108.91 91,-2167 130.731,-2207.53 202.06,-2202.64 245.555,-2194.76"/>
<polygon fill="#000000" stroke="#000000" points="246.304,-2198.18 255.448,-2192.83 244.963,-2191.31 246.304,-2198.18"/>
</g>
<!-- madelung -->
<g id="proc~~state_init~~CallsGraph_node40" class="node"><title>madelung</title>
<polygon fill="#777777" stroke="#777777" points="184,-1116 124,-1116 124,-1092 184,-1092 184,-1116"/>
<text text-anchor="middle" x="154" y="-1101.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">madelung</text>
</g>
<!-- proc~state_init&#45;&gt;madelung -->
<g id="proc~~state_init~~CallsGraph_edge42" class="edge"><title>proc~state_init&#45;&gt;madelung</title>
<path fill="none" stroke="#000000" d="M29.9843,-1364.7C35.7024,-1319.2 57.6617,-1161.24 91,-1125 97.1489,-1118.32 105.501,-1113.76 114.082,-1110.65"/>
<polygon fill="#000000" stroke="#000000" points="115.204,-1113.97 123.762,-1107.72 113.177,-1107.27 115.204,-1113.97"/>
</g>
<!-- chess_init -->
<g id="proc~~state_init~~CallsGraph_node41" class="node"><title>chess_init</title>
<polygon fill="#777777" stroke="#777777" points="184,-1074 124,-1074 124,-1050 184,-1050 184,-1074"/>
<text text-anchor="middle" x="154" y="-1059.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">chess_init</text>
</g>
<!-- proc~state_init&#45;&gt;chess_init -->
<g id="proc~~state_init~~CallsGraph_edge62" class="edge"><title>proc~state_init&#45;&gt;chess_init</title>
<path fill="none" stroke="#000000" d="M29.507,-1364.77C33.8597,-1314.74 52.5966,-1126.19 91,-1083 97.0905,-1076.15 105.497,-1071.53 114.155,-1068.42"/>
<polygon fill="#000000" stroke="#000000" points="115.345,-1071.72 123.928,-1065.51 113.345,-1065.01 115.345,-1071.72"/>
</g>
<!-- exact_sc_ag -->
<g id="proc~~state_init~~CallsGraph_node42" class="node"><title>exact_sc_ag</title>
<polygon fill="#777777" stroke="#777777" points="190.5,-1032 117.5,-1032 117.5,-1008 190.5,-1008 190.5,-1032"/>
<text text-anchor="middle" x="154" y="-1017.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">exact_sc_ag</text>
</g>
<!-- proc~state_init&#45;&gt;exact_sc_ag -->
<g id="proc~~state_init~~CallsGraph_edge2" class="edge"><title>proc~state_init&#45;&gt;exact_sc_ag</title>
<path fill="none" stroke="#000000" d="M29.1455,-1364.92C32.2681,-1310.8 47.4787,-1091.22 91,-1041 95.5505,-1035.75 101.464,-1031.81 107.83,-1028.85"/>
<polygon fill="#000000" stroke="#000000" points="109.294,-1032.04 117.374,-1025.19 106.784,-1025.5 109.294,-1032.04"/>
</g>
<!-- normalize_dm -->
<g id="proc~~state_init~~CallsGraph_node43" class="node"><title>normalize_dm</title>
<polygon fill="#777777" stroke="#777777" points="194,-990 114,-990 114,-966 194,-966 194,-990"/>
<text text-anchor="middle" x="154" y="-975.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">normalize_dm</text>
</g>
<!-- proc~state_init&#45;&gt;normalize_dm -->
<g id="proc~~state_init~~CallsGraph_edge44" class="edge"><title>proc~state_init&#45;&gt;normalize_dm</title>
<path fill="none" stroke="#000000" d="M28.8828,-1364.62C30.9379,-1305.92 42.4545,-1056.17 91,-999 94.6781,-994.669 99.2846,-991.228 104.317,-988.496"/>
<polygon fill="#000000" stroke="#000000" points="106.016,-991.571 113.725,-984.303 103.166,-985.177 106.016,-991.571"/>
</g>
<!-- get_chess_parameter -->
<g id="proc~~state_init~~CallsGraph_node44" class="node"><title>get_chess_parameter</title>
<polygon fill="#777777" stroke="#777777" points="212.5,-948 95.5,-948 95.5,-924 212.5,-924 212.5,-948"/>
<text text-anchor="middle" x="154" y="-933.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_chess_parameter</text>
</g>
<!-- proc~state_init&#45;&gt;get_chess_parameter -->
<g id="proc~~state_init~~CallsGraph_edge45" class="edge"><title>proc~state_init&#45;&gt;get_chess_parameter</title>
<path fill="none" stroke="#000000" d="M28.6524,-1364.94C29.6708,-1303.02 37.2374,-1021.35 91,-957 91.7286,-956.128 92.4949,-955.292 93.2948,-954.49"/>
<polygon fill="#000000" stroke="#000000" points="95.6159,-957.117 101.293,-948.171 91.2763,-951.625 95.6159,-957.117"/>
</g>
<!-- numh -->
<g id="proc~~state_init~~CallsGraph_node45" class="node"><title>numh</title>
<polygon fill="#777777" stroke="#777777" points="181,-906 127,-906 127,-882 181,-882 181,-906"/>
<text text-anchor="middle" x="154" y="-891.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">numh</text>
</g>
<!-- proc~state_init&#45;&gt;numh -->
<g id="proc~~state_init~~CallsGraph_edge46" class="edge"><title>proc~state_init&#45;&gt;numh</title>
<path fill="none" stroke="#000000" d="M28.4726,-1364.62C28.5704,-1298.4 32.1847,-986.358 91,-915 97.5596,-907.042 107.26,-902.087 117.05,-899.006"/>
<polygon fill="#000000" stroke="#000000" points="117.944,-902.39 126.756,-896.508 116.199,-895.61 117.944,-902.39"/>
</g>
<!-- write_zmatrix -->
<g id="proc~~state_init~~CallsGraph_node46" class="node"><title>write_zmatrix</title>
<polygon fill="#777777" stroke="#777777" points="192,-864 116,-864 116,-840 192,-840 192,-864"/>
<text text-anchor="middle" x="154" y="-849.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_zmatrix</text>
</g>
<!-- proc~state_init&#45;&gt;write_zmatrix -->
<g id="proc~~state_init~~CallsGraph_edge58" class="edge"><title>proc~state_init&#45;&gt;write_zmatrix</title>
<path fill="none" stroke="#000000" d="M28.3209,-1364.89C27.5393,-1295.79 26.9442,-951.6 91,-873 95.099,-867.97 100.454,-864.14 106.3,-861.223"/>
<polygon fill="#000000" stroke="#000000" points="107.846,-864.372 115.781,-857.352 105.2,-857.892 107.846,-864.372"/>
</g>
<!-- hsparse -->
<g id="proc~~state_init~~CallsGraph_node47" class="node"><title>hsparse</title>
<polygon fill="#777777" stroke="#777777" points="181,-822 127,-822 127,-798 181,-798 181,-822"/>
<text text-anchor="middle" x="154" y="-807.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hsparse</text>
</g>
<!-- proc~state_init&#45;&gt;hsparse -->
<g id="proc~~state_init~~CallsGraph_edge47" class="edge"><title>proc~state_init&#45;&gt;hsparse</title>
<path fill="none" stroke="#000000" d="M29.1285,-1364.64C33.1524,-1287.5 56.2427,-874.061 91,-831 97.5312,-822.908 107.314,-817.918 117.19,-814.846"/>
<polygon fill="#000000" stroke="#000000" points="118.144,-818.215 126.98,-812.37 116.427,-811.429 118.144,-818.215"/>
</g>
<!-- dict_repopulate_md -->
<g id="proc~~state_init~~CallsGraph_node48" class="node"><title>dict_repopulate_md</title>
<polygon fill="#777777" stroke="#777777" points="207.5,-780 100.5,-780 100.5,-756 207.5,-756 207.5,-780"/>
<text text-anchor="middle" x="154" y="-765.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dict_repopulate_md</text>
</g>
<!-- proc~state_init&#45;&gt;dict_repopulate_md -->
<g id="proc~~state_init~~CallsGraph_edge36" class="edge"><title>proc~state_init&#45;&gt;dict_repopulate_md</title>
<path fill="none" stroke="#000000" d="M29.0179,-1364.74C32.511,-1284.48 53.6295,-835.683 91,-789 91.7102,-788.113 92.4596,-787.263 93.2439,-786.449"/>
<polygon fill="#000000" stroke="#000000" points="95.5772,-789.063 101.135,-780.043 91.1655,-783.628 95.5772,-789.063"/>
</g>
<!-- cmladdproperty -->
<g id="proc~~state_init~~CallsGraph_node49" class="node"><title>cmladdproperty</title>
<polygon fill="#777777" stroke="#777777" points="197.5,-738 110.5,-738 110.5,-714 197.5,-714 197.5,-738"/>
<text text-anchor="middle" x="154" y="-723.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cmladdproperty</text>
</g>
<!-- proc~state_init&#45;&gt;cmladdproperty -->
<g id="proc~~state_init~~CallsGraph_edge48" class="edge"><title>proc~state_init&#45;&gt;cmladdproperty</title>
<path fill="none" stroke="#000000" d="M28.919,-1364.96C31.9045,-1282.02 50.9935,-797.337 91,-747 93.8616,-743.4 97.3678,-740.413 101.243,-737.935"/>
<polygon fill="#000000" stroke="#000000" points="102.944,-740.996 110.211,-733.285 99.7219,-734.782 102.944,-740.996"/>
</g>
<!-- proc~bye -->
<g id="proc~~state_init~~CallsGraph_node50" class="node"><title>proc~bye</title>
<g id="a_proc~~state_init~~CallsGraph_node50"><a xlink:href=".././proc/bye.html" xlink:title="bye">
<polygon fill="#d9534f" stroke="#d9534f" points="310.5,-2053 256.5,-2053 256.5,-2029 310.5,-2029 310.5,-2053"/>
<text text-anchor="middle" x="283.5" y="-2038.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bye</text>
</a>
</g>
</g>
<!-- proc~state_init&#45;&gt;proc~bye -->
<g id="proc~~state_init~~CallsGraph_edge49" class="edge"><title>proc~state_init&#45;&gt;proc~bye</title>
<path fill="none" stroke="#000000" d="M28.6698,-1389.16C30.0075,-1476.24 40.1748,-2002.68 91,-2049 132.984,-2087.26 204.125,-2070.94 246.871,-2055.82"/>
<polygon fill="#000000" stroke="#000000" points="248.146,-2059.08 256.316,-2052.33 245.723,-2052.51 248.146,-2059.08"/>
</g>
<!-- outcoor -->
<g id="proc~~state_init~~CallsGraph_node51" class="node"><title>outcoor</title>
<polygon fill="#777777" stroke="#777777" points="181,-696 127,-696 127,-672 181,-672 181,-696"/>
<text text-anchor="middle" x="154" y="-681.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">outcoor</text>
</g>
<!-- proc~state_init&#45;&gt;outcoor -->
<g id="proc~~state_init~~CallsGraph_edge51" class="edge"><title>proc~state_init&#45;&gt;outcoor</title>
<path fill="none" stroke="#000000" d="M28.8395,-1364.99C31.3698,-1279.03 48.3805,-758.964 91,-705 97.445,-696.84 107.203,-691.83 117.083,-688.761"/>
<polygon fill="#000000" stroke="#000000" points="118.042,-692.129 126.885,-686.294 116.333,-685.341 118.042,-692.129"/>
</g>
<!-- globalize_sum -->
<g id="proc~~state_init~~CallsGraph_node52" class="node"><title>globalize_sum</title>
<polygon fill="#777777" stroke="#777777" points="194.5,-654 113.5,-654 113.5,-630 194.5,-630 194.5,-654"/>
<text text-anchor="middle" x="154" y="-639.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">globalize_sum</text>
</g>
<!-- proc~state_init&#45;&gt;globalize_sum -->
<g id="proc~~state_init~~CallsGraph_edge34" class="edge"><title>proc~state_init&#45;&gt;globalize_sum</title>
<path fill="none" stroke="#000000" d="M28.7744,-1364.82C30.8936,-1275.27 45.7986,-720.553 91,-663 94.5097,-658.531 99.0136,-655.007 103.989,-652.229"/>
<polygon fill="#000000" stroke="#000000" points="105.678,-655.306 113.343,-647.991 102.789,-648.93 105.678,-655.306"/>
</g>
<!-- xij_offset -->
<g id="proc~~state_init~~CallsGraph_node53" class="node"><title>xij_offset</title>
<polygon fill="#777777" stroke="#777777" points="181.5,-612 126.5,-612 126.5,-588 181.5,-588 181.5,-612"/>
<text text-anchor="middle" x="154" y="-597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xij_offset</text>
</g>
<!-- proc~state_init&#45;&gt;xij_offset -->
<g id="proc~~state_init~~CallsGraph_edge53" class="edge"><title>proc~state_init&#45;&gt;xij_offset</title>
<path fill="none" stroke="#000000" d="M28.7087,-1365C30.4083,-1273.06 43.1544,-682.224 91,-621 97.2325,-613.025 106.633,-608.057 116.242,-604.969"/>
<polygon fill="#000000" stroke="#000000" points="117.406,-608.283 126.207,-602.385 115.649,-601.507 117.406,-608.283"/>
</g>
<!-- fdf_get -->
<g id="proc~~state_init~~CallsGraph_node54" class="node"><title>fdf_get</title>
<polygon fill="#777777" stroke="#777777" points="181,-570 127,-570 127,-546 181,-546 181,-570"/>
<text text-anchor="middle" x="154" y="-555.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fdf_get</text>
</g>
<!-- proc~state_init&#45;&gt;fdf_get -->
<g id="proc~~state_init~~CallsGraph_edge11" class="edge"><title>proc~state_init&#45;&gt;fdf_get</title>
<path fill="none" stroke="#000000" d="M28.6545,-1364.94C29.9727,-1269.94 40.547,-643.849 91,-579 97.3853,-570.793 107.127,-565.77 117.009,-562.703"/>
<polygon fill="#000000" stroke="#000000" points="117.971,-566.07 126.82,-560.243 116.269,-559.28 117.971,-566.07"/>
</g>
<!-- newzspdata2d -->
<g id="proc~~state_init~~CallsGraph_node55" class="node"><title>newzspdata2d</title>
<polygon fill="#777777" stroke="#777777" points="195,-528 113,-528 113,-504 195,-504 195,-528"/>
<text text-anchor="middle" x="154" y="-513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">newzspdata2d</text>
</g>
<!-- proc~state_init&#45;&gt;newzspdata2d -->
<g id="proc~~state_init~~CallsGraph_edge55" class="edge"><title>proc~state_init&#45;&gt;newzspdata2d</title>
<path fill="none" stroke="#000000" d="M28.6047,-1364.94C29.5552,-1267.11 37.9284,-605.489 91,-537 94.437,-532.565 98.8545,-529.059 103.747,-526.289"/>
<polygon fill="#000000" stroke="#000000" points="105.33,-529.413 112.955,-522.057 102.407,-523.053 105.33,-529.413"/>
</g>
<!-- ts_tri_analyze -->
<g id="proc~~state_init~~CallsGraph_node56" class="node"><title>ts_tri_analyze</title>
<polygon fill="#777777" stroke="#777777" points="193.5,-486 114.5,-486 114.5,-462 193.5,-462 193.5,-486"/>
<text text-anchor="middle" x="154" y="-471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ts_tri_analyze</text>
</g>
<!-- proc~state_init&#45;&gt;ts_tri_analyze -->
<g id="proc~~state_init~~CallsGraph_edge21" class="edge"><title>proc~state_init&#45;&gt;ts_tri_analyze</title>
<path fill="none" stroke="#000000" d="M28.5593,-1364.98C29.1562,-1264.56 35.2986,-567.145 91,-495 94.6929,-490.217 99.5264,-486.515 104.867,-483.651"/>
<polygon fill="#000000" stroke="#000000" points="106.45,-486.779 114.223,-479.58 103.657,-480.361 106.45,-486.779"/>
</g>
<!-- val -->
<g id="proc~~state_init~~CallsGraph_node57" class="node"><title>val</title>
<polygon fill="#777777" stroke="#777777" points="181,-444 127,-444 127,-420 181,-420 181,-444"/>
<text text-anchor="middle" x="154" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">val</text>
</g>
<!-- proc~state_init&#45;&gt;val -->
<g id="proc~~state_init~~CallsGraph_edge50" class="edge"><title>proc~state_init&#45;&gt;val</title>
<path fill="none" stroke="#000000" d="M28.519,-1364.74C28.7839,-1260.75 32.719,-528.737 91,-453 97.3416,-444.759 107.07,-439.726 116.955,-436.661"/>
<polygon fill="#000000" stroke="#000000" points="117.92,-440.028 126.772,-434.206 116.222,-433.237 117.92,-440.028"/>
</g>
<!-- ucell -->
<g id="proc~~state_init~~CallsGraph_node58" class="node"><title>ucell</title>
<polygon fill="#777777" stroke="#777777" points="181,-402 127,-402 127,-378 181,-378 181,-402"/>
<text text-anchor="middle" x="154" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ucell</text>
</g>
<!-- proc~state_init&#45;&gt;ucell -->
<g id="proc~~state_init~~CallsGraph_edge29" class="edge"><title>proc~state_init&#45;&gt;ucell</title>
<path fill="none" stroke="#000000" d="M28.481,-1364.86C28.4172,-1258.7 30.0697,-490.42 91,-411 97.3295,-402.75 107.055,-397.714 116.94,-394.65"/>
<polygon fill="#000000" stroke="#000000" points="117.906,-398.016 126.759,-392.196 116.209,-391.225 117.906,-398.016"/>
</g>
<!-- kpoint_nullify -->
<g id="proc~~state_init~~CallsGraph_node59" class="node"><title>kpoint_nullify</title>
<polygon fill="#777777" stroke="#777777" points="191,-360 117,-360 117,-336 191,-336 191,-360"/>
<text text-anchor="middle" x="154" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">kpoint_nullify</text>
</g>
<!-- proc~state_init&#45;&gt;kpoint_nullify -->
<g id="proc~~state_init~~CallsGraph_edge57" class="edge"><title>proc~state_init&#45;&gt;kpoint_nullify</title>
<path fill="none" stroke="#000000" d="M28.4457,-1364.68C28.068,-1255.25 27.4761,-452.031 91,-369 95.222,-363.481 100.964,-359.401 107.259,-356.387"/>
<polygon fill="#000000" stroke="#000000" points="108.713,-359.576 116.764,-352.69 106.176,-353.052 108.713,-359.576"/>
</g>
<!-- write_debug -->
<g id="proc~~state_init~~CallsGraph_node60" class="node"><title>write_debug</title>
<polygon fill="#777777" stroke="#777777" points="189.5,-318 118.5,-318 118.5,-294 189.5,-294 189.5,-318"/>
<text text-anchor="middle" x="154" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_debug</text>
</g>
<!-- proc~state_init&#45;&gt;write_debug -->
<g id="proc~~state_init~~CallsGraph_edge60" class="edge"><title>proc~state_init&#45;&gt;write_debug</title>
<path fill="none" stroke="#000000" d="M28.4145,-1364.87C27.734,-1253.7 24.8076,-413.741 91,-327 95.5502,-321.037 101.875,-316.753 108.757,-313.679"/>
<polygon fill="#000000" stroke="#000000" points="110.165,-316.891 118.373,-310.192 107.779,-310.31 110.165,-316.891"/>
</g>
<!-- ts_write_tshs -->
<g id="proc~~state_init~~CallsGraph_node61" class="node"><title>ts_write_tshs</title>
<polygon fill="#777777" stroke="#777777" points="191.5,-276 116.5,-276 116.5,-252 191.5,-252 191.5,-276"/>
<text text-anchor="middle" x="154" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ts_write_tshs</text>
</g>
<!-- proc~state_init&#45;&gt;ts_write_tshs -->
<g id="proc~~state_init~~CallsGraph_edge37" class="edge"><title>proc~state_init&#45;&gt;ts_write_tshs</title>
<path fill="none" stroke="#000000" d="M28.3841,-1364.75C27.408,-1250.6 22.2002,-375.372 91,-285 95.1626,-279.532 100.818,-275.476 107.029,-272.469"/>
<polygon fill="#000000" stroke="#000000" points="108.394,-275.693 116.416,-268.773 105.829,-269.18 108.394,-275.693"/>
</g>
<!-- fname_tshs -->
<g id="proc~~state_init~~CallsGraph_node62" class="node"><title>fname_tshs</title>
<polygon fill="#777777" stroke="#777777" points="188,-234 120,-234 120,-210 188,-210 188,-234"/>
<text text-anchor="middle" x="154" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fname_tshs</text>
</g>
<!-- proc~state_init&#45;&gt;fname_tshs -->
<g id="proc~~state_init~~CallsGraph_edge41" class="edge"><title>proc~state_init&#45;&gt;fname_tshs</title>
<path fill="none" stroke="#000000" d="M28.3555,-1364.65C27.0914,-1247.65 19.5871,-337.01 91,-243 95.8819,-236.573 102.826,-232.096 110.313,-228.982"/>
<polygon fill="#000000" stroke="#000000" points="111.618,-232.235 119.973,-225.721 109.379,-225.603 111.618,-232.235"/>
</g>
<!-- nscold -->
<g id="proc~~state_init~~CallsGraph_node63" class="node"><title>nscold</title>
<polygon fill="#777777" stroke="#777777" points="181,-192 127,-192 127,-168 181,-168 181,-192"/>
<text text-anchor="middle" x="154" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nscold</text>
</g>
<!-- proc~state_init&#45;&gt;nscold -->
<g id="proc~~state_init~~CallsGraph_edge63" class="edge"><title>proc~state_init&#45;&gt;nscold</title>
<path fill="none" stroke="#000000" d="M28.7594,-1364.75C31.3897,-1242.77 53.9071,-249.93 91,-201 97.2819,-192.713 106.994,-187.668 116.881,-184.605"/>
<polygon fill="#000000" stroke="#000000" points="117.85,-187.97 126.707,-182.156 116.157,-181.178 117.85,-187.97"/>
</g>
<!-- isc_off -->
<g id="proc~~state_init~~CallsGraph_node64" class="node"><title>isc_off</title>
<polygon fill="#777777" stroke="#777777" points="181,-150 127,-150 127,-126 181,-126 181,-150"/>
<text text-anchor="middle" x="154" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">isc_off</text>
</g>
<!-- proc~state_init&#45;&gt;isc_off -->
<g id="proc~~state_init~~CallsGraph_edge64" class="edge"><title>proc~state_init&#45;&gt;isc_off</title>
<path fill="none" stroke="#000000" d="M28.7372,-1364.7C31.1883,-1240.12 52.5924,-209.76 91,-159 97.2744,-150.708 106.984,-145.66 116.872,-142.598"/>
<polygon fill="#000000" stroke="#000000" points="117.841,-145.963 126.698,-140.15 116.149,-139.171 117.841,-145.963"/>
</g>
<!-- overlap -->
<g id="proc~~state_init~~CallsGraph_node65" class="node"><title>overlap</title>
<polygon fill="#777777" stroke="#777777" points="181,-108 127,-108 127,-84 181,-84 181,-108"/>
<text text-anchor="middle" x="154" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">overlap</text>
</g>
<!-- proc~state_init&#45;&gt;overlap -->
<g id="proc~~state_init~~CallsGraph_edge59" class="edge"><title>proc~state_init&#45;&gt;overlap</title>
<path fill="none" stroke="#000000" d="M28.716,-1364.68C30.9916,-1237.62 51.275,-169.595 91,-117 97.2673,-108.702 106.975,-103.653 116.863,-100.591"/>
<polygon fill="#000000" stroke="#000000" points="117.833,-103.957 126.691,-98.1439 116.141,-97.1639 117.833,-103.957"/>
</g>
<!-- sporb_to_spatom -->
<g id="proc~~state_init~~CallsGraph_node66" class="node"><title>sporb_to_spatom</title>
<polygon fill="#777777" stroke="#777777" points="202,-66 106,-66 106,-42 202,-42 202,-66"/>
<text text-anchor="middle" x="154" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sporb_to_spatom</text>
</g>
<!-- proc~state_init&#45;&gt;sporb_to_spatom -->
<g id="proc~~state_init~~CallsGraph_edge52" class="edge"><title>proc~state_init&#45;&gt;sporb_to_spatom</title>
<path fill="none" stroke="#000000" d="M28.6958,-1364.67C30.7997,-1235.27 49.9548,-129.433 91,-75 92.8282,-72.5755 94.9501,-70.4284 97.2845,-68.5271"/>
<polygon fill="#000000" stroke="#000000" points="99.4101,-71.3214 105.922,-62.9643 95.6199,-65.4362 99.4101,-71.3214"/>
</g>
<!-- domaindecom -->
<g id="proc~~state_init~~CallsGraph_node67" class="node"><title>domaindecom</title>
<polygon fill="#777777" stroke="#777777" points="194,-24 114,-24 114,-0 194,-0 194,-24"/>
<text text-anchor="middle" x="154" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">domaindecom</text>
</g>
<!-- proc~state_init&#45;&gt;domaindecom -->
<g id="proc~~state_init~~CallsGraph_edge65" class="edge"><title>proc~state_init&#45;&gt;domaindecom</title>
<path fill="none" stroke="#000000" d="M28.6766,-1364.69C30.6124,-1233.07 48.6319,-89.2746 91,-33 94.5908,-28.2306 99.3185,-24.5344 104.565,-21.6716"/>
<polygon fill="#000000" stroke="#000000" points="106.046,-24.8437 113.777,-17.5985 103.215,-18.4417 106.046,-24.8437"/>
</g>
<!-- proc~mixers_history_init&#45;&gt;delete -->
<g id="proc~~state_init~~CallsGraph_edge69" class="edge"><title>proc~mixers_history_init&#45;&gt;delete</title>
<path fill="none" stroke="#000000" d="M192.565,-2406.08C209.475,-2411.52 229.362,-2417.91 246.129,-2423.3"/>
<polygon fill="#000000" stroke="#000000" points="245.52,-2426.78 256.111,-2426.51 247.663,-2420.12 245.52,-2426.78"/>
</g>
<!-- proc~current_itt -->
<g id="proc~~state_init~~CallsGraph_node72" class="node"><title>proc~current_itt</title>
<g id="a_proc~~state_init~~CallsGraph_node72"><a xlink:href=".././proc/current_itt.html" xlink:title="current_itt">
<polygon fill="#d94e8f" stroke="#d94e8f" points="314,-2405 253,-2405 253,-2381 314,-2381 314,-2405"/>
<text text-anchor="middle" x="283.5" y="-2390.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">current_itt</text>
</a>
</g>
</g>
<!-- proc~mixers_history_init&#45;&gt;proc~current_itt -->
<g id="proc~~state_init~~CallsGraph_edge68" class="edge"><title>proc~mixers_history_init&#45;&gt;proc~current_itt</title>
<path fill="none" stroke="#000000" d="M204.66,-2393.61C217.206,-2393.51 230.52,-2393.41 242.521,-2393.31"/>
<polygon fill="#000000" stroke="#000000" points="242.705,-2396.81 252.677,-2393.23 242.65,-2389.81 242.705,-2396.81"/>
</g>
<!-- new -->
<g id="proc~~state_init~~CallsGraph_node76" class="node"><title>new</title>
<polygon fill="#777777" stroke="#777777" points="310.5,-2363 256.5,-2363 256.5,-2339 310.5,-2339 310.5,-2363"/>
<text text-anchor="middle" x="283.5" y="-2348.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">new</text>
</g>
<!-- proc~mixers_history_init&#45;&gt;new -->
<g id="proc~~state_init~~CallsGraph_edge67" class="edge"><title>proc~mixers_history_init&#45;&gt;new</title>
<path fill="none" stroke="#000000" d="M190.855,-2381.91C208.218,-2376.05 229.02,-2369.04 246.413,-2363.17"/>
<polygon fill="#000000" stroke="#000000" points="247.852,-2366.38 256.209,-2359.87 245.615,-2359.75 247.852,-2366.38"/>
</g>
<!-- proc~check_cohp&#45;&gt;proc~message -->
<g id="proc~~state_init~~CallsGraph_edge70" class="edge"><title>proc~check_cohp&#45;&gt;proc~message</title>
<path fill="none" stroke="#000000" d="M189.168,-2156.72C206.433,-2162.14 227.418,-2168.72 245.113,-2174.27"/>
<polygon fill="#000000" stroke="#000000" points="244.51,-2177.75 255.099,-2177.4 246.605,-2171.07 244.51,-2177.75"/>
</g>
<!-- io_close -->
<g id="proc~~state_init~~CallsGraph_node68" class="node"><title>io_close</title>
<polygon fill="#777777" stroke="#777777" points="411.5,-2200 357.5,-2200 357.5,-2176 411.5,-2176 411.5,-2200"/>
<text text-anchor="middle" x="384.5" y="-2185.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">io_close</text>
</g>
<!-- proc~die&#45;&gt;io_close -->
<g id="proc~~state_init~~CallsGraph_edge71" class="edge"><title>proc~die&#45;&gt;io_close</title>
<path fill="none" stroke="#000000" d="M296.432,-2118.43C309.108,-2131.31 330.035,-2151.67 350,-2167 351.385,-2168.06 352.825,-2169.12 354.296,-2170.17"/>
<polygon fill="#000000" stroke="#000000" points="352.635,-2173.27 362.888,-2175.94 356.539,-2167.46 352.635,-2173.27"/>
</g>
<!-- cmlfinishfile -->
<g id="proc~~state_init~~CallsGraph_node69" class="node"><title>cmlfinishfile</title>
<polygon fill="#777777" stroke="#777777" points="418,-2032 351,-2032 351,-2008 418,-2008 418,-2032"/>
<text text-anchor="middle" x="384.5" y="-2017.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cmlfinishfile</text>
</g>
<!-- proc~die&#45;&gt;cmlfinishfile -->
<g id="proc~~state_init~~CallsGraph_edge72" class="edge"><title>proc~die&#45;&gt;cmlfinishfile</title>
<path fill="none" stroke="#000000" d="M295.37,-2093.68C307.811,-2079.95 329.167,-2057.53 350,-2041 351.331,-2039.94 352.717,-2038.9 354.137,-2037.86"/>
<polygon fill="#000000" stroke="#000000" points="356.168,-2040.72 362.459,-2032.19 352.225,-2034.93 356.168,-2040.72"/>
</g>
<!-- io_assign -->
<g id="proc~~state_init~~CallsGraph_node70" class="node"><title>io_assign</title>
<polygon fill="#777777" stroke="#777777" points="413.5,-2242 355.5,-2242 355.5,-2218 413.5,-2218 413.5,-2242"/>
<text text-anchor="middle" x="384.5" y="-2227.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">io_assign</text>
</g>
<!-- proc~die&#45;&gt;io_assign -->
<g id="proc~~state_init~~CallsGraph_edge73" class="edge"><title>proc~die&#45;&gt;io_assign</title>
<path fill="none" stroke="#000000" d="M290.083,-2118.33C299.896,-2138.98 321.888,-2181.07 350,-2209 350.931,-2209.93 351.91,-2210.83 352.925,-2211.71"/>
<polygon fill="#000000" stroke="#000000" points="351.11,-2214.73 361.193,-2217.98 355.34,-2209.15 351.11,-2214.73"/>
</g>
<!-- pxfabort -->
<g id="proc~~state_init~~CallsGraph_node71" class="node"><title>pxfabort</title>
<polygon fill="#777777" stroke="#777777" points="411.5,-2074 357.5,-2074 357.5,-2050 411.5,-2050 411.5,-2074"/>
<text text-anchor="middle" x="384.5" y="-2059.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pxfabort</text>
</g>
<!-- proc~die&#45;&gt;pxfabort -->
<g id="proc~~state_init~~CallsGraph_edge74" class="edge"><title>proc~die&#45;&gt;pxfabort</title>
<path fill="none" stroke="#000000" d="M310.511,-2094.44C322.015,-2089.33 335.723,-2083.23 348.137,-2077.72"/>
<polygon fill="#000000" stroke="#000000" points="349.602,-2080.9 357.319,-2073.64 346.759,-2074.5 349.602,-2080.9"/>
</g>
<!-- mpi_abort -->
<g id="proc~~state_init~~CallsGraph_node74" class="node"><title>mpi_abort</title>
<polygon fill="#777777" stroke="#777777" points="415,-2116 354,-2116 354,-2092 415,-2092 415,-2116"/>
<text text-anchor="middle" x="384.5" y="-2101.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_abort</text>
</g>
<!-- proc~die&#45;&gt;mpi_abort -->
<g id="proc~~state_init~~CallsGraph_edge75" class="edge"><title>proc~die&#45;&gt;mpi_abort</title>
<path fill="none" stroke="#000000" d="M310.511,-2105.47C320.687,-2105.27 332.587,-2105.03 343.79,-2104.8"/>
<polygon fill="#000000" stroke="#000000" points="343.886,-2108.3 353.814,-2104.6 343.745,-2101.3 343.886,-2108.3"/>
</g>
<!-- pxfflush -->
<g id="proc~~state_init~~CallsGraph_node75" class="node"><title>pxfflush</title>
<polygon fill="#777777" stroke="#777777" points="411.5,-2158 357.5,-2158 357.5,-2134 411.5,-2134 411.5,-2158"/>
<text text-anchor="middle" x="384.5" y="-2143.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pxfflush</text>
</g>
<!-- proc~die&#45;&gt;pxfflush -->
<g id="proc~~state_init~~CallsGraph_edge76" class="edge"><title>proc~die&#45;&gt;pxfflush</title>
<path fill="none" stroke="#000000" d="M310.511,-2116.51C321.903,-2121.11 335.455,-2126.59 347.771,-2131.56"/>
<polygon fill="#000000" stroke="#000000" points="346.736,-2134.92 357.319,-2135.42 349.358,-2128.43 346.736,-2134.92"/>
</g>
<!-- proc~message&#45;&gt;io_close -->
<g id="proc~~state_init~~CallsGraph_edge79" class="edge"><title>proc~message&#45;&gt;io_close</title>
<path fill="none" stroke="#000000" d="M311.552,-2186.55C322.533,-2186.77 335.385,-2187.03 347.164,-2187.27"/>
<polygon fill="#000000" stroke="#000000" points="347.096,-2190.77 357.165,-2187.47 347.238,-2183.77 347.096,-2190.77"/>
</g>
<!-- proc~message&#45;&gt;io_assign -->
<g id="proc~~state_init~~CallsGraph_edge77" class="edge"><title>proc~message&#45;&gt;io_assign</title>
<path fill="none" stroke="#000000" d="M311.552,-2198.02C322.575,-2202.92 335.481,-2208.66 347.296,-2213.91"/>
<polygon fill="#000000" stroke="#000000" points="345.921,-2217.13 356.481,-2217.99 348.764,-2210.73 345.921,-2217.13"/>
</g>
<!-- proc~message&#45;&gt;pxfflush -->
<g id="proc~~state_init~~CallsGraph_edge78" class="edge"><title>proc~message&#45;&gt;pxfflush</title>
<path fill="none" stroke="#000000" d="M311.552,-2175.07C322.755,-2170.54 335.905,-2165.23 347.876,-2160.39"/>
<polygon fill="#000000" stroke="#000000" points="349.204,-2163.63 357.165,-2156.64 346.582,-2157.14 349.204,-2163.63"/>
</g>
<!-- proc~bye&#45;&gt;cmlfinishfile -->
<g id="proc~~state_init~~CallsGraph_edge82" class="edge"><title>proc~bye&#45;&gt;cmlfinishfile</title>
<path fill="none" stroke="#000000" d="M310.511,-2035.48C319.889,-2033.49 330.73,-2031.19 341.141,-2028.99"/>
<polygon fill="#000000" stroke="#000000" points="341.873,-2032.41 350.929,-2026.91 340.421,-2025.56 341.873,-2032.41"/>
</g>
<!-- mpi_finalize -->
<g id="proc~~state_init~~CallsGraph_node73" class="node"><title>mpi_finalize</title>
<polygon fill="#777777" stroke="#777777" points="419,-1990 350,-1990 350,-1966 419,-1966 419,-1990"/>
<text text-anchor="middle" x="384.5" y="-1975.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_finalize</text>
</g>
<!-- proc~bye&#45;&gt;mpi_finalize -->
<g id="proc~~state_init~~CallsGraph_edge81" class="edge"><title>proc~bye&#45;&gt;mpi_finalize</title>
<path fill="none" stroke="#000000" d="M303.385,-2028.82C316.452,-2020.41 334.256,-2008.98 350,-1999 351.696,-1997.92 353.441,-1996.82 355.203,-1995.71"/>
<polygon fill="#000000" stroke="#000000" points="357.392,-1998.47 363.993,-1990.18 353.665,-1992.54 357.392,-1998.47"/>
</g>
<!-- proc~bye&#45;&gt;pxfflush -->
<g id="proc~~state_init~~CallsGraph_edge80" class="edge"><title>proc~bye&#45;&gt;pxfflush</title>
<path fill="none" stroke="#000000" d="M292.043,-2053.21C303.194,-2070.59 325.427,-2102.82 350,-2125 351.115,-2126.01 352.283,-2126.99 353.489,-2127.96"/>
<polygon fill="#000000" stroke="#000000" points="351.636,-2130.94 361.793,-2133.95 355.732,-2125.26 351.636,-2130.94"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,-0 209.5,-0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.5,-24 454.5,-24 454.5,-0 551.5,-0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~state_init~~CalledByGraph Pages: 1 -->
<svg id="procstate_initCalledByGraph" width="175pt" height="32pt"
 viewBox="0.00 0.00 175.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~state_init~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~state_init~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 171,-28 171,4 -4,4"/>
<!-- proc~state_init -->
<g id="proc~~state_init~~CalledByGraph_node1" class="node"><title>proc~state_init</title>
<polygon fill="none" stroke="black" points="167,-24 112,-24 112,-0 167,-0 167,-24"/>
<text text-anchor="middle" x="139.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">state_init</text>
</g>
<!-- proc~siesta_forces -->
<g id="proc~~state_init~~CalledByGraph_node2" class="node"><title>proc~siesta_forces</title>
<g id="a_proc~~state_init~~CalledByGraph_node2"><a xlink:href=".././proc/siesta_forces.html" xlink:title="siesta_forces">
<polygon fill="#d9534f" stroke="#d9534f" points="76,-24 0,-24 0,-0 76,-0 76,-24"/>
<text text-anchor="middle" x="38" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_forces</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;proc~state_init -->
<g id="proc~~state_init~~CalledByGraph_edge1" class="edge"><title>proc~siesta_forces&#45;&gt;proc~state_init</title>
<path fill="none" stroke="#000000" d="M76.0501,-12C84.4416,-12 93.3497,-12 101.73,-12"/>
<polygon fill="#000000" stroke="#000000" points="101.983,-15.5001 111.983,-12 101.983,-8.5001 101.983,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,-0 209.5,-0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.5,-24 454.5,-24 454.5,-0 551.5,-0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/state_init.html#src">state_init</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>      <span class="k">subroutine </span><span class="n">state_init</span><span class="p">(</span> <span class="n">istep</span> <span class="p">)</span>
      <span class="k">use </span><span class="n">kpoint_scf_m</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">setup_kpoint_scf</span><span class="p">,</span> <span class="n">kpoints_scf</span>
      <span class="k">use </span><span class="n">kpoint_t_m</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">kpoint_delete</span><span class="p">,</span> <span class="n">kpoint_nullify</span>

      <span class="k">use </span><span class="n">m_os</span><span class="p">,</span>              <span class="n">only</span><span class="p">:</span> <span class="n">file_exist</span>
      <span class="k">use </span><span class="n">m_new_dm</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">new_dm</span>
      <span class="k">use </span><span class="n">m_proximity_check</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">proximity_check</span>
      <span class="k">use </span><span class="n">siesta_options</span>
      <span class="k">use </span><span class="n">units</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">Ang</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">listhptr</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">Dold</span><span class="p">,</span> <span class="n">Dscf</span><span class="p">,</span> <span class="n">DM_2D</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">Eold</span><span class="p">,</span> <span class="n">Escf</span><span class="p">,</span> <span class="n">EDM_2D</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">Hold</span><span class="p">,</span> <span class="n">H</span>   <span class="p">,</span> <span class="n">H_2D</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">xijo</span><span class="p">,</span> <span class="n">xij_2D</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">S</span>   <span class="p">,</span> <span class="n">S_1D</span>

      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">H_kin_1D</span><span class="p">,</span> <span class="n">H_vkb_1D</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">H_ldau_2D</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">H_so_on_2D</span><span class="p">,</span> <span class="n">H_so_off_2D</span>

      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">sparse_pattern</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">block_dist</span><span class="p">,</span> <span class="n">single_dist</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">DM_history</span>


      <span class="k">use </span><span class="n">create_Sparsity_SC</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">crtSparsity_SC</span>
      <span class="k">use </span><span class="n">m_sparsity_handling</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">SpOrb_to_SpAtom</span>
      <span class="k">use </span><span class="n">m_sparsity_handling</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">Sp_to_Spglobal</span>
      <span class="k">use </span><span class="n">m_pivot_methods</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">sp2graphviz</span>

      <span class="k">use </span><span class="n">siesta_geom</span>
      <span class="k">use </span><span class="n">atomlist</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">iphorb</span><span class="p">,</span> <span class="n">iphkb</span><span class="p">,</span> <span class="n">indxua</span><span class="p">,</span>
     <span class="p">&amp;</span>                             <span class="n">rmaxo</span><span class="p">,</span> <span class="n">rmaxkb</span><span class="p">,</span> <span class="n">rmaxv</span><span class="p">,</span> <span class="n">rmaxldau</span><span class="p">,</span>
     <span class="p">&amp;</span>                             <span class="n">lastkb</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span> <span class="n">superc</span><span class="p">,</span> <span class="n">indxuo</span><span class="p">,</span>
     <span class="p">&amp;</span>                             <span class="n">no_u</span><span class="p">,</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">iza</span><span class="p">,</span> <span class="n">qtots</span>
      <span class="k">use </span><span class="n">alloc</span><span class="p">,</span>             <span class="n">only</span><span class="p">:</span> <span class="n">re_alloc</span><span class="p">,</span> <span class="n">de_alloc</span><span class="p">,</span> <span class="n">alloc_report</span>
      <span class="k">use </span><span class="n">m_hsparse</span><span class="p">,</span>         <span class="n">only</span><span class="p">:</span> <span class="n">hsparse</span>
      <span class="k">use </span><span class="n">m_overlap</span><span class="p">,</span>         <span class="n">only</span><span class="p">:</span> <span class="n">overlap</span>
      <span class="k">use </span><span class="n">m_supercell</span><span class="p">,</span>       <span class="n">only</span><span class="p">:</span> <span class="n">exact_sc_ag</span>
      <span class="k">use </span><span class="n">siesta_cml</span><span class="p">,</span>        <span class="n">only</span><span class="p">:</span> <span class="n">cml_p</span><span class="p">,</span> <span class="n">cmlStartStep</span><span class="p">,</span> <span class="n">mainXML</span>
      <span class="k">use </span><span class="n">siesta_cml</span><span class="p">,</span>        <span class="n">only</span><span class="p">:</span> <span class="n">cmlStartPropertyList</span>
      <span class="k">use </span><span class="n">siesta_cml</span><span class="p">,</span>        <span class="n">only</span><span class="p">:</span> <span class="n">cmlEndPropertyList</span>
      <span class="k">use </span><span class="n">siesta_cml</span><span class="p">,</span>        <span class="n">only</span><span class="p">:</span> <span class="n">cmlAddProperty</span>
      <span class="k">use </span><span class="n">zmatrix</span><span class="p">,</span>           <span class="n">only</span><span class="p">:</span> <span class="n">lUseZmatrix</span><span class="p">,</span> <span class="n">write_zmatrix</span>
      <span class="k">use </span><span class="n">m_energies</span><span class="p">,</span>        <span class="n">only</span><span class="p">:</span> <span class="n">Emad</span>
      <span class="k">use </span><span class="n">write_subs</span>
      <span class="k">use </span><span class="n">m_ioxv</span><span class="p">,</span>            <span class="n">only</span><span class="p">:</span> <span class="n">ioxv</span>
      <span class="k">use </span><span class="n">m_iotdxv</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">iotdxv</span>
      <span class="k">use </span><span class="n">m_steps</span>
      <span class="k">use </span><span class="n">parallel</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">IOnode</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">nodes</span><span class="p">,</span> <span class="n">BlockSize</span>
      <span class="k">use </span><span class="n">m_spin</span><span class="p">,</span>            <span class="n">only</span><span class="p">:</span> <span class="n">spin</span>
      <span class="k">use </span><span class="n">m_rmaxh</span>
      <span class="k">use </span><span class="n">m_mixing</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">mixers_history_init</span>
      <span class="k">use </span><span class="n">m_mixing_scf</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">scf_mixs</span><span class="p">,</span> <span class="n">scf_mix</span>

      <span class="k">use </span><span class="n">m_normalize_dm</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">normalize_dm</span>

      <span class="k">use </span><span class="n">m_eo</span>
      <span class="k">use </span><span class="n">m_gamma</span>
      <span class="k">use </span><span class="n">files</span><span class="p">,</span>             <span class="n">only</span><span class="p">:</span> <span class="n">slabel</span>
      <span class="k">use </span><span class="n">m_mpi_utils</span><span class="p">,</span>       <span class="n">only</span><span class="p">:</span> <span class="n">globalize_or</span>
      <span class="k">use </span><span class="n">m_mpi_utils</span><span class="p">,</span>       <span class="n">only</span><span class="p">:</span> <span class="n">globalize_sum</span>
      <span class="k">use </span><span class="n">domain_decom</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">domainDecom</span><span class="p">,</span> <span class="n">use_dd</span><span class="p">,</span> <span class="n">use_dd_perm</span>
      <span class="k">use </span><span class="n">ldau_specs</span><span class="p">,</span>        <span class="n">only</span><span class="p">:</span> <span class="n">switch_ldau</span><span class="p">,</span> <span class="n">ldau_init</span>
      <span class="k">use </span><span class="n">fdf</span><span class="p">,</span>               <span class="n">only</span><span class="p">:</span> <span class="n">fdf_get</span>
      <span class="k">use </span><span class="n">sys</span><span class="p">,</span>               <span class="n">only</span><span class="p">:</span> <span class="n">message</span><span class="p">,</span> <span class="n">die</span>
      <span class="k">use </span><span class="n">m_sparse</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">xij_offset</span>

      <span class="k">use </span><span class="n">ts_kpoint_scf_m</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">setup_ts_kpoint_scf</span><span class="p">,</span> <span class="n">ts_kpoints_scf</span>
      <span class="k">use </span><span class="n">m_ts_charge</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">TS_RHOCORR_METHOD</span><span class="p">,</span> <span class="n">TS_RHOCORR_FERMI</span>
      <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">BTD_method</span>
      <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">TS_Analyze</span>
      <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">N_Elec</span><span class="p">,</span> <span class="n">Elecs</span><span class="p">,</span> <span class="n">IsVolt</span>
      <span class="k">use </span><span class="n">m_ts_electype</span>
      <span class="k">use </span><span class="n">m_ts_global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">TSrun</span><span class="p">,</span> <span class="n">TSmode</span><span class="p">,</span> <span class="n">onlyS</span>
      <span class="k">use </span><span class="n">sys</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">bye</span>
      <span class="k">use </span><span class="n">m_ts_io</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">fname_TSHS</span><span class="p">,</span> <span class="n">ts_write_tshs</span>
      <span class="k">use </span><span class="n">m_ts_sparse</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">ts_sparse_init</span>
      <span class="k">use </span><span class="n">m_ts_tri_init</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">ts_tri_init</span><span class="p">,</span> <span class="n">ts_tri_analyze</span>
      <span class="k">use </span><span class="n">files</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">slabel</span><span class="p">,</span> <span class="n">label_length</span>
<span class="cp">#ifdef SIESTA__CHESS</span>
      <span class="k">use </span><span class="n">m_chess</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">CheSS_init</span><span class="p">,</span> <span class="n">get_CheSS_parameter</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef CDF</span>
      <span class="k">use </span><span class="n">iodm_netcdf</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">setup_dm_netcdf_file</span>
      <span class="k">use </span><span class="n">iodmhs_netcdf</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">setup_dmhs_netcdf_file</span>
<span class="cp">#endif</span>
      <span class="k">use </span><span class="n">class_Sparsity</span>
      <span class="k">use </span><span class="n">class_dSpData1D</span>
      <span class="k">use </span><span class="n">class_dSpData2D</span>
      <span class="k">use </span><span class="n">class_zSpData2D</span>
      <span class="k">use </span><span class="n">class_dData2D</span>
<span class="cp">#ifdef TEST_IO</span>
      <span class="k">use </span><span class="n">m_test_io</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef SIESTA__FLOOK</span>
      <span class="k">use </span><span class="n">siesta_dicts</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">dict_repopulate_MD</span>
<span class="cp">#endif</span>

      <span class="k">implicit none</span>

<span class="k">      </span><span class="kt">integer</span>            <span class="kd">::</span> <span class="n">istep</span><span class="p">,</span> <span class="n">nnz</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">veclen</span>      <span class="c">! Length of a unit-cell vector</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">rmax</span>
      <span class="kt">logical</span>            <span class="kd">::</span> <span class="n">cell_can_change</span>
      <span class="kt">integer</span>            <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iadispl</span><span class="p">,</span> <span class="n">ixdispl</span>
      <span class="kt">logical</span>            <span class="kd">::</span> <span class="n">auxchanged</span>   <span class="c">! Auxiliary supercell changed?</span>
      <span class="kt">logical</span>            <span class="kd">::</span> <span class="n">folding</span><span class="p">,</span> <span class="n">folding1</span>
      <span class="kt">logical</span>            <span class="kd">::</span> <span class="n">diag_folding</span><span class="p">,</span> <span class="n">diag_folding1</span>
      <span class="kt">logical</span>            <span class="kd">::</span> <span class="n">foundxv</span>  <span class="c">! dummy for call to ioxv</span>

      <span class="k">external</span>           <span class="kd">::</span>  <span class="n">madelung</span><span class="p">,</span> <span class="n">timer</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">external</span> <span class="kd">::</span> <span class="n">volcel</span>

      <span class="kt">integer</span>                       <span class="kd">::</span> <span class="n">ts_kscell_file</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>                      <span class="kd">::</span> <span class="n">ts_kdispl_file</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0</span>
      <span class="kt">logical</span>                       <span class="kd">::</span> <span class="n">ts_Gamma_file</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
      <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">label_length</span><span class="o">+</span><span class="mi">6</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fname</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>                      <span class="kd">::</span> <span class="n">dummyef</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">dummyqtot</span><span class="o">=</span><span class="mf">0.0</span>
<span class="cp">#ifdef SIESTA__CHESS</span>
      <span class="kt">integer</span> <span class="kd">::</span> <span class="n">maxnh_kernel</span><span class="p">,</span> <span class="n">maxnh_mult</span><span class="p">,</span> <span class="n">no_l_kernel</span><span class="p">,</span> <span class="n">no_l_mult</span>
      <span class="kt">integer</span><span class="p">,</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">allocatable</span> <span class="kd">::</span> <span class="n">listh_kernel</span><span class="p">,</span> <span class="n">listh_mult</span>
      <span class="kt">integer</span><span class="p">,</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">allocatable</span> <span class="kd">::</span> <span class="n">numh_kernel</span><span class="p">,</span> <span class="n">numh_mult</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">chess_value</span>
<span class="cp">#endif</span>
      <span class="k">type</span><span class="p">(</span><span class="n">Sparsity</span><span class="p">)</span> <span class="kd">::</span> <span class="n">g_Sp</span>
      
      <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">oname</span>

      <span class="k">type</span><span class="p">(</span><span class="n">dData2D</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tmp_2D</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dummy_qspin</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>

<span class="c">!------------------------------------------------------------------- BEGIN</span>
      <span class="k">call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;IterGeom&#39;</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span>
<span class="cp">#ifdef DEBUG</span>
      <span class="k">call </span><span class="n">write_debug</span><span class="p">(</span> <span class="s1">&#39;  PRE state_init&#39;</span> <span class="p">)</span>
<span class="cp">#endif</span>
      <span class="k">call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;state_init&#39;</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span>

      <span class="n">istp</span> <span class="o">=</span> <span class="n">istp</span> <span class="o">+</span> <span class="mi">1</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">IOnode</span><span class="p">)</span> <span class="k">then</span>
<span class="k">      write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,t22,a)&#39;</span><span class="p">)</span> <span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">,</span><span class="mi">36</span><span class="p">)</span>
      <span class="k">select case</span> <span class="p">(</span><span class="n">idyn</span><span class="p">)</span>
      <span class="k">case</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">nmove</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t25,a)&#39;</span><span class="p">)</span> <span class="s1">&#39;Single-point calculation&#39;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">cml_p</span><span class="p">)</span> <span class="k">call </span><span class="n">cmlStartStep</span><span class="p">(</span><span class="n">mainXML</span><span class="p">,</span> <span class="k">type</span><span class="o">=</span><span class="s1">&#39;Single-Point&#39;</span><span class="p">,</span>
     <span class="err">$</span>           <span class="nb">index</span><span class="o">=</span><span class="n">istp</span><span class="p">)</span>
         <span class="k">else</span>
<span class="k">            if</span> <span class="p">(</span><span class="n">broyden_optim</span><span class="p">)</span> <span class="k">then</span>
<span class="k">               write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t25,a,i6)&#39;</span><span class="p">)</span> <span class="s1">&#39;Begin Broyden opt. move = &#39;</span><span class="p">,</span>
     <span class="err">$</span>              <span class="n">istep</span>
            <span class="k">else if</span> <span class="p">(</span><span class="n">fire_optim</span><span class="p">)</span> <span class="k">then</span>
<span class="k">               write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t25,a,i6)&#39;</span><span class="p">)</span> <span class="s1">&#39;Begin FIRE opt. move = &#39;</span><span class="p">,</span>
     <span class="err">$</span>              <span class="n">istep</span>
            <span class="k">else</span>
<span class="k">               write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t25,a,i6)&#39;</span><span class="p">)</span> <span class="s1">&#39;Begin CG opt. move = &#39;</span><span class="p">,</span>
     <span class="err">$</span>              <span class="n">istep</span>
            <span class="k">end if</span>
<span class="k">            if</span> <span class="p">(</span><span class="n">cml_p</span><span class="p">)</span> <span class="k">call </span><span class="n">cmlStartStep</span><span class="p">(</span><span class="n">mainXML</span><span class="p">,</span> <span class="k">type</span><span class="o">=</span><span class="s1">&#39;Geom. Optim&#39;</span><span class="p">,</span>
     <span class="err">$</span>           <span class="nb">index</span><span class="o">=</span><span class="n">istp</span><span class="p">)</span>
         <span class="n">endif</span>
         
<span class="c">!        Print Z-matrix coordinates</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">lUseZmatrix</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            call </span><span class="n">write_Zmatrix</span><span class="p">()</span>
         <span class="n">endif</span>
      <span class="k">case</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">iquench</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t25,a,i6)&#39;</span><span class="p">)</span> <span class="s1">&#39;Begin MD quenched step = &#39;</span><span class="p">,</span>
     <span class="err">$</span>           <span class="n">istep</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">cml_p</span><span class="p">)</span> <span class="k">call </span><span class="n">cmlStartStep</span><span class="p">(</span><span class="n">mainXML</span><span class="p">,</span> <span class="k">type</span><span class="o">=</span><span class="s1">&#39;MD-quenched&#39;</span><span class="p">,</span>
     <span class="err">$</span>           <span class="nb">index</span><span class="o">=</span><span class="n">istep</span><span class="p">)</span>
         <span class="k">else</span>
<span class="k">            write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t25,a,i6)&#39;</span><span class="p">)</span> <span class="s1">&#39;Begin MD step = &#39;</span><span class="p">,</span>
     <span class="err">$</span>           <span class="n">istep</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">cml_p</span><span class="p">)</span> <span class="k">call </span><span class="n">cmlStartStep</span><span class="p">(</span><span class="n">mainXML</span><span class="p">,</span> <span class="k">type</span><span class="o">=</span><span class="s1">&#39;MD&#39;</span><span class="p">,</span>
     <span class="err">$</span>             <span class="nb">index</span><span class="o">=</span><span class="n">istep</span><span class="p">)</span>
         <span class="n">endif</span>
      <span class="k">case</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
         <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t25,a,i6)&#39;</span><span class="p">)</span> <span class="s1">&#39;Begin MD step = &#39;</span><span class="p">,</span> <span class="n">istep</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">cml_p</span><span class="p">)</span> <span class="k">call </span><span class="n">cmlStartStep</span><span class="p">(</span><span class="n">mainXML</span><span class="p">,</span> <span class="k">type</span><span class="o">=</span><span class="s1">&#39;MD&#39;</span><span class="p">,</span> <span class="nb">index</span><span class="o">=</span><span class="n">istep</span><span class="p">)</span>
      <span class="k">case</span> <span class="p">(</span><span class="mi">6</span><span class="p">)</span>
          <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t25,a,i6)&#39;</span><span class="p">)</span> <span class="s1">&#39;Begin FC step = &#39;</span><span class="p">,</span><span class="n">istep</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">cml_p</span><span class="p">)</span> <span class="k">call </span><span class="n">cmlStartStep</span><span class="p">(</span><span class="n">mainXML</span><span class="p">,</span> <span class="k">type</span><span class="o">=</span><span class="s1">&#39;FC&#39;</span><span class="p">,</span> <span class="nb">index</span><span class="o">=</span><span class="n">istep</span><span class="p">)</span>
          
          <span class="k">if</span> <span class="p">(</span><span class="n">istep</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t25,a)&#39;</span><span class="p">)</span> <span class="s1">&#39;Undisplaced coordinates&#39;</span>
         <span class="k">else</span>
<span class="k">            </span><span class="n">iadispl</span> <span class="o">=</span> <span class="p">(</span><span class="n">istep</span><span class="o">-</span><span class="nb">mod</span><span class="p">(</span><span class="n">istep</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">/</span><span class="mi">6</span><span class="o">+</span><span class="n">ia1</span>
            <span class="n">ix</span> <span class="o">=</span> <span class="nb">mod</span><span class="p">(</span><span class="n">istep</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
            <span class="n">ixdispl</span> <span class="o">=</span> <span class="p">(</span><span class="n">ix</span> <span class="o">-</span> <span class="nb">mod</span><span class="p">(</span><span class="n">ix</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
            <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t26,a,i0,/,t26,a,i1,a,f10.6,a)&#39;</span><span class="p">)</span> <span class="s1">&#39;displace atom &#39;</span><span class="p">,</span>
     <span class="p">&amp;</span>           <span class="n">iadispl</span><span class="p">,</span><span class="s1">&#39;in direction &#39;</span><span class="p">,</span><span class="n">ixdispl</span><span class="p">,</span><span class="s1">&#39; by&#39;</span><span class="p">,</span> <span class="n">dx</span><span class="o">/</span><span class="n">Ang</span><span class="p">,</span><span class="s1">&#39; Ang&#39;</span>
         <span class="n">endif</span>
         
      <span class="k">case</span> <span class="p">(</span><span class="mi">8</span><span class="p">)</span>
         <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t25,a,i6)&#39;</span><span class="p">)</span> <span class="s1">&#39;Begin Server step = &#39;</span><span class="p">,</span><span class="n">istep</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">cml_p</span><span class="p">)</span> <span class="k">call </span><span class="n">cmlStartStep</span><span class="p">(</span><span class="n">mainXML</span><span class="p">,</span> <span class="k">type</span><span class="o">=</span><span class="s1">&#39;FS&#39;</span><span class="p">,</span> <span class="nb">index</span><span class="o">=</span><span class="n">istep</span><span class="p">)</span>
         
      <span class="k">case</span> <span class="p">(</span><span class="mi">9</span><span class="p">)</span>
         <span class="k">if</span> <span class="p">(</span> <span class="n">istep</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t25,a,i7)&#39;</span><span class="p">)</span><span class="s1">&#39;Explicit coord. initialization&#39;</span>
         <span class="k">else</span>
<span class="k">            write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t25,a,i7)&#39;</span><span class="p">)</span><span class="s1">&#39;Explicit coord. step =&#39;</span><span class="p">,</span><span class="n">istep</span>
         <span class="k">end if</span>
<span class="k">         if</span> <span class="p">(</span><span class="n">cml_p</span><span class="p">)</span> <span class="k">call </span><span class="n">cmlStartStep</span><span class="p">(</span><span class="n">mainXML</span><span class="p">,</span> <span class="k">type</span><span class="o">=</span><span class="s1">&#39;ECS&#39;</span><span class="p">,</span> <span class="nb">index</span><span class="o">=</span><span class="n">istep</span><span class="p">)</span>
         
      <span class="k">case</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span>
         <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t25,a,i7)&#39;</span><span class="p">)</span><span class="s1">&#39;LUA coord. step =&#39;</span><span class="p">,</span><span class="n">istep</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">cml_p</span><span class="p">)</span> <span class="k">call </span><span class="n">cmlStartStep</span><span class="p">(</span><span class="n">mainXML</span><span class="p">,</span> <span class="k">type</span><span class="o">=</span><span class="s1">&#39;LUA&#39;</span><span class="p">,</span> <span class="nb">index</span><span class="o">=</span><span class="n">istep</span><span class="p">)</span>
         
      <span class="k">end select</span>
<span class="k">      </span>
<span class="k">      write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t22,a)&#39;</span><span class="p">)</span> <span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">,</span><span class="mi">36</span><span class="p">)</span>
      
<span class="c">!     Print atomic coordinates</span>
      <span class="k">call </span><span class="n">outcoor</span><span class="p">(</span> <span class="n">ucell</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">writec</span> <span class="p">)</span>

<span class="c">!     Save structural information in crystallographic format</span>
<span class="c">!     (in file SystemLabel.STRUCT_OUT),</span>
<span class="c">!     canonical Zmatrix (if applicable), and CML record</span>
      
      <span class="k">call </span><span class="n">siesta_write_positions</span><span class="p">(</span><span class="n">moved</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.)</span>
       
      <span class="n">endif</span> <span class="c">! IONode</span>

      <span class="c">! Write the XV file for single-point calculations, so that</span>
      <span class="c">! it is there at the end for those users who rely on it</span>
      <span class="k">call </span><span class="n">ioxv</span><span class="p">(</span> <span class="s1">&#39;write&#39;</span><span class="p">,</span> <span class="n">ucell</span><span class="p">,</span> <span class="n">vcell</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">isa</span><span class="p">,</span> <span class="n">iza</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">va</span><span class="p">,</span> 
     <span class="p">&amp;</span>           <span class="n">foundxv</span><span class="p">)</span>
      <span class="c">! Write TDXV file for TDDFT restart.</span>
      <span class="k">if</span><span class="p">(</span><span class="n">writetdwf</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">td_elec_dyn</span><span class="p">)</span> <span class="k">then</span>
<span class="k">      call </span><span class="n">iotdxv</span><span class="p">(</span><span class="s1">&#39;write&#39;</span><span class="p">,</span><span class="n">ucell</span><span class="p">,</span><span class="n">vcell</span><span class="p">,</span><span class="n">na_u</span><span class="p">,</span><span class="n">isa</span><span class="p">,</span><span class="n">iza</span><span class="p">,</span><span class="n">xa</span><span class="p">,</span><span class="n">va</span><span class="p">,</span><span class="n">foundxv</span><span class="p">)</span>
      <span class="k">end if</span>  

<span class="c">!     Actualize things if variable cell </span>
      <span class="n">auxchanged</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
      <span class="n">cell_can_change</span> <span class="o">=</span> <span class="p">(</span> <span class="n">varcel</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>
     <span class="p">&amp;</span>                    <span class="p">(</span><span class="n">idyn</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">8</span><span class="p">)</span>  <span class="c">! Force/stress evaluation</span>
     <span class="p">&amp;</span>                  <span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">change_kgrid_in_md</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         </span><span class="n">cell_can_change</span> <span class="o">=</span> <span class="n">cell_can_change</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>
     <span class="p">&amp;</span>                     <span class="p">(</span><span class="n">idyn</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">3</span><span class="p">)</span>   <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="c">! Parrinello-Rahman</span>
     <span class="p">&amp;</span>                     <span class="p">(</span><span class="n">idyn</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">4</span><span class="p">)</span>   <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="c">! Nose-Parrinello-Rahman</span>
     <span class="p">&amp;</span>                     <span class="p">(</span><span class="n">idyn</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">5</span><span class="p">)</span>        <span class="c">! Anneal</span>
      <span class="n">endif</span>

      <span class="k">if</span> <span class="p">(</span> <span class="n">cell_can_change</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>
     <span class="p">&amp;</span>     <span class="p">(</span><span class="n">istep</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">inicoor</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="nb">gamma</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>

<span class="c">!       Will print k-points also</span>
        <span class="k">call </span><span class="n">kpoint_delete</span><span class="p">(</span><span class="n">kpoints_scf</span><span class="p">)</span>
        <span class="k">call </span><span class="n">setup_kpoint_scf</span><span class="p">(</span> <span class="n">ucell</span> <span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span> <span class="n">TSmode</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">          call </span><span class="n">kpoint_delete</span><span class="p">(</span> <span class="n">ts_kpoints_scf</span> <span class="p">)</span>
        <span class="k">else</span>
<span class="k">          call </span><span class="n">kpoint_nullify</span><span class="p">(</span> <span class="n">ts_kpoints_scf</span> <span class="p">)</span>
        <span class="k">end if</span>
<span class="k">        call </span><span class="n">setup_ts_kpoint_scf</span><span class="p">(</span> <span class="n">ucell</span><span class="p">,</span> <span class="n">kpoints_scf</span> <span class="p">)</span>

        <span class="k">call </span><span class="n">re_alloc</span><span class="p">(</span> <span class="n">eo</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">spinor</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kpoints_scf</span><span class="p">%</span><span class="n">N</span><span class="p">,</span>
     <span class="p">&amp;</span>                 <span class="s1">&#39;eo&#39;</span><span class="p">,</span> <span class="s1">&#39;state_init&#39;</span><span class="p">)</span>
        <span class="k">call </span><span class="n">re_alloc</span><span class="p">(</span> <span class="n">qo</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">spinor</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kpoints_scf</span><span class="p">%</span><span class="n">N</span><span class="p">,</span> 
     <span class="p">&amp;</span>                 <span class="s1">&#39;qo&#39;</span><span class="p">,</span> <span class="s1">&#39;state_init&#39;</span> <span class="p">)</span>

<span class="c">!       Find required supercell</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">gamma</span><span class="p">)</span> <span class="k">then</span>
<span class="k">           </span><span class="n">nsc</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span>
<span class="k">           do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="mi">3</span>
              <span class="n">veclen</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="n">ucell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">ucell</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">ucell</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
              <span class="n">nsc</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">ceiling</span><span class="p">(</span> <span class="n">rmaxh</span> <span class="o">/</span> <span class="n">veclen</span> <span class="p">)</span>
           <span class="k">end do</span>
           <span class="c">! The above is kept for historical reasons,</span>
           <span class="c">! but a tight supercell can be found from the atom-graph info:</span>
           <span class="k">call </span><span class="n">exact_sc_ag</span><span class="p">(</span><span class="n">negl</span><span class="p">,</span><span class="n">ucell</span><span class="p">,</span><span class="n">na_u</span><span class="p">,</span><span class="n">isa</span><span class="p">,</span><span class="n">xa</span><span class="p">,</span><span class="n">nsc</span><span class="p">)</span>
        <span class="n">endif</span>

        <span class="n">mscell</span> <span class="o">=</span> <span class="mf">0.0_dp</span>
        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span>
           <span class="n">mscell</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">nsc</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
           <span class="k">if</span> <span class="p">(</span><span class="n">nsc</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">/=</span> <span class="n">nscold</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="n">auxchanged</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
           <span class="n">nscold</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">nsc</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">enddo</span>

<span class="c">!       Madelung correction for charged systems </span>
        <span class="k">if</span> <span class="p">(</span><span class="n">charnet</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mf">0.0_dp</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          call </span><span class="n">madelung</span><span class="p">(</span><span class="n">ucell</span><span class="p">,</span> <span class="nb">shape</span><span class="p">,</span> <span class="n">charnet</span><span class="p">,</span> <span class="n">Emad</span><span class="p">)</span>
        <span class="n">endif</span>

      <span class="n">endif</span>
<span class="c">!     End variable cell actualization</span>

<span class="c">!     Auxiliary supercell</span>
<span class="c">!     Do not move from here, as the coordinates might have changed</span>
<span class="c">!     even if not the unit cell</span>
      <span class="k">call </span><span class="n">superc</span><span class="p">(</span><span class="n">ucell</span><span class="p">,</span> <span class="n">scell</span><span class="p">,</span> <span class="n">nsc</span><span class="p">)</span>
<span class="cp">#ifdef SIESTA__FLOOK</span>
      <span class="k">call </span><span class="n">dict_repopulate_MD</span><span class="p">()</span>
<span class="cp">#endif</span>

<span class="c">!     Print unit cell and compute cell volume</span>
<span class="c">!     Possible BUG: </span>
<span class="c">!     Note that this volume is later used in write_subs and the md output</span>
<span class="c">!     routines, even if the cell later changes.</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">IOnode</span><span class="p">)</span> <span class="k">call </span><span class="n">outcell</span><span class="p">(</span><span class="n">ucell</span><span class="p">)</span>
      <span class="n">volume_of_some_cell</span> <span class="o">=</span> <span class="n">volcel</span><span class="p">(</span><span class="n">ucell</span><span class="p">)</span>

<span class="c">!     Use largest possible range in program, except hsparse...</span>
<span class="c">!     2 * rmaxv: Vna overlap</span>
<span class="c">!     rmaxo + rmaxkb: Non-local KB action</span>
<span class="c">!     2 * (rmaxo + rmaxldau): Interaction through LDAU projector</span>
<span class="c">!     2.0_dp * (rmaxo+rmaxkb) : Orbital interaction through KB projectors</span>
      <span class="n">rmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span> <span class="mf">2._dp</span><span class="o">*</span><span class="n">rmaxv</span><span class="p">,</span> <span class="mf">2._dp</span><span class="o">*</span><span class="p">(</span><span class="n">rmaxo</span><span class="o">+</span><span class="n">rmaxldau</span><span class="p">),</span> <span class="n">rmaxo</span><span class="o">+</span><span class="n">rmaxkb</span><span class="p">)</span>

      <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">negl</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">        </span><span class="n">rmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">rmax</span><span class="p">,</span> <span class="mf">2.0_dp</span> <span class="o">*</span> <span class="p">(</span><span class="n">rmaxo</span><span class="o">+</span><span class="n">rmaxkb</span><span class="p">)</span> <span class="p">)</span>
      <span class="n">endif</span>

<span class="c">!     Check if any two atoms are unreasonably close</span>
      <span class="k">call </span><span class="n">proximity_check</span><span class="p">(</span><span class="n">rmax</span><span class="p">)</span>

      <span class="c">! Clear history of mixing parameters</span>
      <span class="k">call </span><span class="n">mixers_history_init</span><span class="p">(</span> <span class="n">scf_mixs</span> <span class="p">)</span>
      <span class="n">scf_mix</span> <span class="o">=&gt;</span> <span class="n">scf_mixs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

      <span class="c">! Ensure sparsity pattern is empty</span>
      <span class="k">call </span><span class="n">delete</span><span class="p">(</span><span class="n">sparse_pattern</span><span class="p">)</span>
      <span class="c">! sadly deleting the sparse pattern does not necessarily</span>
      <span class="c">! mean that the arrays are de-associated.</span>
      <span class="c">! Remember that the reference counter could (in MD)</span>
      <span class="c">! be higher than 1, hence we need to create &quot;fake&quot;</span>
      <span class="c">! containers and let the new&lt;class&gt; delete the old</span>
      <span class="c">! sparsity pattern</span>

      <span class="k">nullify</span><span class="p">(</span><span class="n">numh</span><span class="p">,</span><span class="n">listhptr</span><span class="p">,</span><span class="n">listh</span><span class="p">)</span>
      <span class="k">allocate</span><span class="p">(</span><span class="n">numh</span><span class="p">(</span><span class="n">no_l</span><span class="p">),</span><span class="n">listhptr</span><span class="p">(</span><span class="n">no_l</span><span class="p">))</span>
      <span class="c">! We do not need to allocate listh</span>
      <span class="c">! that will be allocated in hsparse</span>

<span class="cp">#ifdef SIESTA__CHESS</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">isolve</span> <span class="o">==</span> <span class="n">SOLVE_CHESS</span><span class="p">)</span> <span class="k">then</span>
<span class="c">!         Calculate a sparsity pattern with some buffers... Only required</span>
<span class="c">!         for CheSS</span>
          <span class="n">chess_value</span> <span class="o">=</span> <span class="n">get_chess_parameter</span><span class="p">(</span><span class="s1">&#39;chess_buffer_kernel&#39;</span><span class="p">)</span>
          <span class="k">call </span><span class="n">hsparse</span><span class="p">(</span> <span class="n">negl</span><span class="p">,</span> <span class="n">scell</span><span class="p">,</span> <span class="n">nsc</span><span class="p">,</span> <span class="n">na_s</span><span class="p">,</span> <span class="n">isa</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span>
     <span class="p">&amp;</span>              <span class="n">lastkb</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span> <span class="n">iphKB</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="nb">gamma</span><span class="p">,</span> 
     <span class="p">&amp;</span>              <span class="n">set_xijo</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.,</span> <span class="n">folding</span><span class="o">=</span><span class="n">folding1</span><span class="p">,</span>
     <span class="err">$</span>              <span class="n">diagonal_folding</span><span class="o">=</span><span class="n">diag_folding1</span><span class="p">,</span>
     <span class="err">$</span>              <span class="n">buffer</span><span class="o">=</span><span class="n">chess_value</span><span class="p">)</span>
          <span class="n">maxnh_kernel</span> <span class="o">=</span> <span class="n">maxnh</span>
          <span class="n">no_l_kernel</span> <span class="o">=</span> <span class="n">no_l</span>
          <span class="k">allocate</span><span class="p">(</span><span class="n">listh_kernel</span><span class="p">(</span><span class="n">maxnh_kernel</span><span class="p">))</span>
          <span class="k">allocate</span><span class="p">(</span><span class="n">numh_kernel</span><span class="p">(</span><span class="n">no_l_kernel</span><span class="p">))</span>
          <span class="n">listh_kernel</span> <span class="o">=</span> <span class="n">listh</span>
          <span class="n">numh_kernel</span> <span class="o">=</span> <span class="n">numh</span>
    
          <span class="n">chess_value</span> <span class="o">=</span> <span class="n">get_chess_parameter</span><span class="p">(</span><span class="s1">&#39;chess_buffer_mult&#39;</span><span class="p">)</span>
          <span class="k">call </span><span class="n">hsparse</span><span class="p">(</span> <span class="n">negl</span><span class="p">,</span> <span class="n">scell</span><span class="p">,</span> <span class="n">nsc</span><span class="p">,</span> <span class="n">na_s</span><span class="p">,</span> <span class="n">isa</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span>
     <span class="p">&amp;</span>                  <span class="n">lastkb</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span> <span class="n">iphKB</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="nb">gamma</span><span class="p">,</span>
     <span class="p">&amp;</span>                  <span class="n">set_xijo</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.,</span> <span class="n">folding</span><span class="o">=</span><span class="n">folding1</span><span class="p">,</span>
     <span class="err">$</span>                  <span class="n">diagonal_folding</span><span class="o">=</span><span class="n">diag_folding1</span><span class="p">,</span>
     <span class="err">$</span>                  <span class="n">buffer</span><span class="o">=</span><span class="n">chess_value</span><span class="p">)</span>
          <span class="n">maxnh_mult</span> <span class="o">=</span> <span class="n">maxnh</span>
          <span class="n">no_l_mult</span> <span class="o">=</span> <span class="n">no_l</span>
          <span class="k">allocate</span><span class="p">(</span><span class="n">listh_mult</span><span class="p">(</span><span class="n">maxnh_mult</span><span class="p">))</span>
          <span class="k">allocate</span><span class="p">(</span><span class="n">numh_mult</span><span class="p">(</span><span class="n">no_l_mult</span><span class="p">))</span>
          <span class="n">listh_mult</span> <span class="o">=</span> <span class="n">listh</span>
          <span class="n">numh_mult</span> <span class="o">=</span> <span class="n">numh</span>
      <span class="k">end if</span>
<span class="cp">#endif /* CHESS */</span>

<span class="c">!     List of nonzero Hamiltonian matrix elements</span>
<span class="c">!     and, if applicable,  vectors between orbital centers</span>

<span class="c">!     Listh and xijo are allocated inside hsparse</span>
<span class="c">!     Note: We always generate xijo now, for COOP and other</span>
<span class="c">!           analyses.</span>
      <span class="k">call </span><span class="n">delete</span><span class="p">(</span><span class="n">xij_2D</span><span class="p">)</span> <span class="c">! as xijo will be reallocated</span>
      <span class="k">nullify</span><span class="p">(</span><span class="n">xijo</span><span class="p">)</span>
      <span class="k">call </span><span class="n">hsparse</span><span class="p">(</span> <span class="n">negl</span><span class="p">,</span> <span class="n">scell</span><span class="p">,</span> <span class="n">nsc</span><span class="p">,</span> <span class="n">na_s</span><span class="p">,</span> <span class="n">isa</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span>
     <span class="p">&amp;</span>              <span class="n">lastkb</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span> <span class="n">iphKB</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="nb">gamma</span><span class="p">,</span>
     <span class="err">$</span>              <span class="n">set_xijo</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.,</span> <span class="n">folding</span><span class="o">=</span><span class="n">folding1</span><span class="p">,</span>
     <span class="err">$</span>              <span class="n">diagonal_folding</span><span class="o">=</span><span class="n">diag_folding1</span><span class="p">,</span>
     <span class="err">$</span>              <span class="n">debug_folding</span><span class="o">=</span><span class="n">fdf_get</span><span class="p">(</span><span class="s1">&#39;debug-folding&#39;</span><span class="p">,.</span><span class="n">false</span><span class="p">.))</span>
<span class="c">!</span>
      <span class="k">call </span><span class="n">globalize_or</span><span class="p">(</span><span class="n">diag_folding1</span><span class="p">,</span><span class="n">diag_folding</span><span class="p">)</span>
      <span class="k">call </span><span class="n">globalize_or</span><span class="p">(</span><span class="n">folding1</span><span class="p">,</span><span class="n">folding</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">diag_folding</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="nb">gamma</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">message</span><span class="p">(</span><span class="s2">&quot;WARNING&quot;</span><span class="p">,</span><span class="s2">&quot;Gamma-point calculation &quot;</span> <span class="o">//</span>
     <span class="err">$</span>         <span class="s2">&quot;with interaction between periodic images&quot;</span><span class="p">)</span>
         <span class="k">call </span><span class="n">message</span><span class="p">(</span><span class="s2">&quot;WARNING&quot;</span><span class="p">,</span>
     <span class="err">$</span>           <span class="s2">&quot;Some features might not work optimally:&quot;</span><span class="p">)</span>
         <span class="k">call </span><span class="n">message</span><span class="p">(</span><span class="s2">&quot;WARNING&quot;</span><span class="p">,</span>
     <span class="err">$</span>           <span class="s2">&quot;e.g. DM initialization from atomic data&quot;</span><span class="p">)</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">harrisfun</span><span class="p">)</span> <span class="k">call </span><span class="n">die</span><span class="p">(</span><span class="s2">&quot;Harris functional run needs &quot;</span> <span class="o">//</span>
     <span class="err">$</span>                              <span class="s2">&quot;&#39;force-aux-cell T&#39;&quot;</span><span class="p">)</span>

      <span class="k">else if</span> <span class="p">(</span><span class="n">folding</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         if</span> <span class="p">(</span><span class="nb">gamma</span><span class="p">)</span> <span class="k">then</span>
<span class="k">               call </span><span class="n">message</span><span class="p">(</span><span class="s2">&quot;INFO&quot;</span><span class="p">,</span><span class="s2">&quot;Gamma-point calculation &quot;</span> <span class="o">//</span>
     <span class="err">$</span>                      <span class="s2">&quot;with multiply-connected orbital pairs&quot;</span><span class="p">)</span>
               <span class="k">call </span><span class="n">message</span><span class="p">(</span><span class="s2">&quot;INFO&quot;</span><span class="p">,</span>
     <span class="err">$</span>              <span class="s2">&quot;Folding of H and S implicitly performed&quot;</span><span class="p">)</span>
               <span class="k">call </span><span class="n">check_cohp</span><span class="p">()</span>
         <span class="k">else</span>
<span class="k">            write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s2">&quot;(a,/,a)&quot;</span><span class="p">)</span> <span class="s2">&quot;Non Gamma-point calculation &quot;</span> <span class="o">//</span>
     <span class="err">$</span>           <span class="s2">&quot;with multiply-connected orbital pairs &quot;</span> <span class="o">//</span>
     <span class="err">$</span>           <span class="s2">&quot;in auxiliary supercell.&quot;</span><span class="p">,</span>
     <span class="err">$</span>           <span class="s2">&quot;Possible internal error. &quot;</span> <span class="o">//</span>
     <span class="err">$</span>           <span class="s2">&quot;Use &#39;debug-folding T&#39; to debug.&quot;</span>
            <span class="k">call </span><span class="n">die</span><span class="p">(</span><span class="s2">&quot;Inadequate auxiliary supercell&quot;</span><span class="p">)</span>
         <span class="n">endif</span>
      <span class="n">endif</span>
<span class="c">!</span>
      <span class="k">call </span><span class="n">globalize_sum</span><span class="p">(</span><span class="n">maxnh</span><span class="p">,</span><span class="n">nnz</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">cml_p</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">cmlStartPropertyList</span><span class="p">(</span><span class="n">mainXML</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Orbital info&#39;</span><span class="p">)</span>
         <span class="k">call </span><span class="n">cmlAddProperty</span><span class="p">(</span><span class="n">xf</span><span class="o">=</span><span class="n">mainXML</span><span class="p">,</span> <span class="k">value</span><span class="o">=</span><span class="n">no_u</span><span class="p">,</span>
     <span class="err">$</span>        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Number of orbitals in unit cell&#39;</span><span class="p">,</span>
     <span class="err">$</span>        <span class="n">dictref</span><span class="o">=</span><span class="s1">&#39;siesta:no_u&#39;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;cmlUnits:countable&quot;</span><span class="p">)</span>
         <span class="k">call </span><span class="n">cmlAddProperty</span><span class="p">(</span><span class="n">xf</span><span class="o">=</span><span class="n">mainXML</span><span class="p">,</span> <span class="k">value</span><span class="o">=</span><span class="n">nnz</span><span class="p">,</span>
     <span class="err">$</span>        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Number of non-zeros&#39;</span><span class="p">,</span>
     <span class="err">$</span>        <span class="n">dictref</span><span class="o">=</span><span class="s1">&#39;siesta:nnz&#39;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;cmlUnits:countable&quot;</span><span class="p">)</span>
         <span class="k">call </span><span class="n">cmlEndPropertyList</span><span class="p">(</span><span class="n">mainXML</span><span class="p">)</span>
      <span class="n">endif</span>
      <span class="c">!</span>
<span class="cp">#ifdef SIESTA__CHESS</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">isolve</span> <span class="o">==</span> <span class="n">SOLVE_CHESS</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          call </span><span class="n">CheSS_init</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">nodes</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">maxnh_kernel</span><span class="p">,</span> <span class="n">maxnh_mult</span><span class="p">,</span> 
     <span class="p">&amp;</span>         <span class="n">no_u</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">no_l_kernel</span><span class="p">,</span> <span class="n">no_l_mult</span><span class="p">,</span> <span class="n">BlockSize</span><span class="p">,</span> 
     <span class="p">&amp;</span>         <span class="n">spin</span><span class="p">%</span><span class="n">spinor</span><span class="p">,</span> <span class="n">qtots</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">listh_kernel</span><span class="p">,</span> <span class="n">listh_mult</span><span class="p">,</span> 
     <span class="p">&amp;</span>         <span class="n">numh</span><span class="p">,</span> <span class="n">numh_kernel</span><span class="p">,</span> <span class="n">numh_mult</span><span class="p">)</span>
          <span class="k">deallocate</span><span class="p">(</span><span class="n">listh_kernel</span><span class="p">)</span>
          <span class="k">deallocate</span><span class="p">(</span><span class="n">numh_kernel</span><span class="p">)</span>
          <span class="k">deallocate</span><span class="p">(</span><span class="n">listh_mult</span><span class="p">)</span>
          <span class="k">deallocate</span><span class="p">(</span><span class="n">numh_mult</span><span class="p">)</span>
      <span class="k">end if</span>
<span class="cp">#endif /* CHESS */</span>
      <span class="c">!</span>
      <span class="c">! If using domain decomposition, redistribute orbitals</span>
      <span class="c">! for this geometry, based on the hsparse info. </span>
      <span class="c">! The first time round, the initial distribution is a</span>
      <span class="c">! simple block one (given by preSetOrbitLimits).</span>
      <span class="c">!</span>
      <span class="c">! Any DM, etc, read from file will be redistributed according</span>
      <span class="c">! to the new pattern. </span>
      <span class="c">! Inherited DMs from a previous geometry cannot be used if the</span>
      <span class="c">! orbital distribution changes. For now, we avoid changing the</span>
      <span class="c">! distribution (the variable use_dd_perm is .true. if domain</span>
      <span class="c">! decomposition is in effect). Names should be changed...</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">use_dd</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">use_dd_perm</span><span class="p">))</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">domainDecom</span><span class="p">(</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">maxnh</span> <span class="p">)</span>  <span class="c">! maxnh intent(in) here</span>
         <span class="n">maxnh</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">numh</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">no_l</span><span class="p">))</span>
         <span class="c">! We still need to re-create Julian Gale&#39;s</span>
         <span class="c">! indexing for O(N) in parallel.</span>
         <span class="k">print</span> <span class="s2">&quot;(a5,i3,a20,3i8)&quot;</span><span class="p">,</span>
     <span class="err">$</span>         <span class="s2">&quot;Node: &quot;</span><span class="p">,</span> <span class="n">Node</span><span class="p">,</span> <span class="s2">&quot;no_u, no_l, maxnh: &quot;</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">maxnh</span>
         <span class="k">call </span><span class="n">setup_ordern_indexes</span><span class="p">(</span><span class="n">no_l</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">Nodes</span><span class="p">)</span>
      <span class="n">endif</span>

      <span class="c">! I would like to skip this alloc/move/dealloc/attach</span>
      <span class="c">! by allowing sparsity to have pointer targets.</span>
      <span class="c">! However, this poses a problem with intel compilers,</span>
      <span class="c">! as it apparently errors out when de-allocating a target pointer</span>
      <span class="k">write</span><span class="p">(</span><span class="n">oname</span><span class="p">,</span><span class="s2">&quot;(a,i0)&quot;</span><span class="p">)</span> <span class="s2">&quot;sparsity for geom step &quot;</span><span class="p">,</span> <span class="n">istep</span>
      <span class="k">call </span><span class="n">newSparsity</span><span class="p">(</span><span class="n">sparse_pattern</span><span class="p">,</span><span class="n">no_l</span><span class="p">,</span><span class="n">no_u</span><span class="p">,</span><span class="n">maxnh</span><span class="p">,</span>
     <span class="p">&amp;</span>     <span class="n">numh</span><span class="p">,</span><span class="n">listhptr</span><span class="p">,</span><span class="n">listh</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="n">oname</span><span class="p">)</span>
      <span class="k">deallocate</span><span class="p">(</span><span class="n">numh</span><span class="p">,</span><span class="n">listhptr</span><span class="p">,</span><span class="n">listh</span><span class="p">)</span>
      <span class="k">call </span><span class="n">attach</span><span class="p">(</span><span class="n">sparse_pattern</span><span class="p">,</span> 
     <span class="p">&amp;</span>     <span class="n">n_col</span> <span class="o">=</span> <span class="n">numh</span><span class="p">,</span> <span class="n">list_ptr</span> <span class="o">=</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">list_col</span> <span class="o">=</span> <span class="n">listh</span> <span class="p">)</span>

      <span class="c">! In case the user requests to create the connectivity graph</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">write_GRAPHVIZ</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">then</span>
         <span class="c">! first create the unit-cell sparsity pattern</span>
         <span class="k">call </span><span class="n">crtSparsity_SC</span><span class="p">(</span><span class="n">sparse_pattern</span><span class="p">,</span> <span class="n">g_Sp</span><span class="p">,</span> <span class="n">UC</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
         <span class="c">! next move to global sparsity pattern</span>
         <span class="k">call </span><span class="n">Sp_to_Spglobal</span><span class="p">(</span><span class="n">block_dist</span><span class="p">,</span> <span class="n">g_Sp</span><span class="p">,</span> <span class="n">g_Sp</span><span class="p">)</span>
         <span class="k">if</span> <span class="p">(</span> <span class="n">IONode</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            if</span> <span class="p">(</span> <span class="n">write_GRAPHVIZ</span> <span class="o">/=</span> <span class="mi">2</span> <span class="p">)</span>
     <span class="p">&amp;</span>           <span class="k">call </span><span class="n">sp2graphviz</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.ORB.gv&#39;</span><span class="p">,</span> <span class="n">g_Sp</span><span class="p">)</span>
            <span class="c">! Convert to atomic </span>
            <span class="k">if</span> <span class="p">(</span> <span class="n">write_GRAPHVIZ</span> <span class="o">/=</span> <span class="mi">1</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">               call </span><span class="n">SpOrb_to_SpAtom</span><span class="p">(</span><span class="n">single_dist</span><span class="p">,</span><span class="n">g_Sp</span><span class="p">,</span><span class="n">na_u</span><span class="p">,</span><span class="n">lasto</span><span class="p">,</span><span class="n">g_Sp</span><span class="p">)</span>
               <span class="k">call </span><span class="n">sp2graphviz</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.ATOM.gv&#39;</span><span class="p">,</span> <span class="n">g_Sp</span><span class="p">)</span>
            <span class="k">end if</span>
<span class="k">         end if</span>
<span class="k">         call </span><span class="n">delete</span><span class="p">(</span><span class="n">g_Sp</span><span class="p">)</span>
      <span class="k">end if</span>

             
      <span class="c">! Copy over xijo array (we can first do it here... :( )</span>
      <span class="k">call </span><span class="n">newdData2D</span><span class="p">(</span><span class="n">tmp_2D</span><span class="p">,</span><span class="n">xijo</span><span class="p">,</span><span class="s1">&#39;xijo&#39;</span><span class="p">)</span>
      <span class="k">deallocate</span><span class="p">(</span><span class="n">xijo</span><span class="p">)</span>
      <span class="k">write</span><span class="p">(</span><span class="n">oname</span><span class="p">,</span><span class="s2">&quot;(a,i0)&quot;</span><span class="p">)</span> <span class="s2">&quot;xijo at geom step &quot;</span><span class="p">,</span> <span class="n">istep</span>
      <span class="k">call </span><span class="n">newdSpData2D</span><span class="p">(</span><span class="n">sparse_pattern</span><span class="p">,</span><span class="n">tmp_2D</span><span class="p">,</span><span class="n">block_dist</span><span class="p">,</span><span class="n">xij_2D</span><span class="p">,</span> 
     <span class="p">&amp;</span>     <span class="n">name</span><span class="o">=</span><span class="n">oname</span><span class="p">)</span>
      <span class="k">call </span><span class="n">delete</span><span class="p">(</span><span class="n">tmp_2D</span><span class="p">)</span> <span class="c">! decrement container...</span>
      <span class="n">xijo</span> <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">xij_2D</span><span class="p">)</span>

      <span class="c">! Calculate the super-cell offsets...</span>
      <span class="k">if</span> <span class="p">(</span> <span class="nb">Gamma</span> <span class="p">)</span> <span class="k">then</span>
         <span class="c">! Here we create the super-cell offsets</span>
         <span class="k">call </span><span class="n">re_alloc</span><span class="p">(</span><span class="n">isc_off</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">isc_off</span><span class="p">(:,:)</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="k">else</span>
<span class="k">         call </span><span class="n">xij_offset</span><span class="p">(</span><span class="n">ucell</span><span class="p">,</span><span class="n">nsc</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span><span class="n">xa</span><span class="p">,</span><span class="n">lasto</span><span class="p">,</span> 
     <span class="p">&amp;</span>        <span class="n">xij_2D</span><span class="p">,</span> <span class="n">isc_off</span><span class="p">,</span>
     <span class="p">&amp;</span>        <span class="n">Bcast</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
      <span class="k">end if</span>

      
      <span class="c">! When the user requests to only do an analyzation, we can call</span>
      <span class="c">! appropriate routines and quit</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">TS_Analyze</span> <span class="p">)</span> <span class="k">then</span>

         <span class="c">! Force the creation of the full sparsity pattern</span>
         <span class="k">call </span><span class="n">ts_sparse_init</span><span class="p">(</span><span class="n">slabel</span><span class="p">,</span><span class="n">IsVolt</span><span class="p">,</span> <span class="n">N_Elec</span><span class="p">,</span> <span class="n">Elecs</span><span class="p">,</span> 
     <span class="p">&amp;</span>        <span class="n">ucell</span><span class="p">,</span> <span class="n">nsc</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span> <span class="n">block_dist</span><span class="p">,</span> <span class="n">sparse_pattern</span><span class="p">,</span> 
     <span class="p">&amp;</span>        <span class="nb">Gamma</span><span class="p">,</span> <span class="n">isc_off</span><span class="p">)</span>

         <span class="c">! create the tri-diagonal matrix</span>
         <span class="k">call </span><span class="n">ts_tri_analyze</span><span class="p">(</span> <span class="n">block_dist</span><span class="p">,</span> <span class="n">sparse_pattern</span> <span class="p">,</span> <span class="n">N_Elec</span><span class="p">,</span>
     <span class="p">&amp;</span>        <span class="n">Elecs</span><span class="p">,</span> <span class="n">ucell</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span> <span class="n">nsc</span><span class="p">,</span> <span class="n">isc_off</span><span class="p">,</span>
     <span class="p">&amp;</span>        <span class="n">BTD_method</span> <span class="p">)</span>

         <span class="c">! Print-out timers</span>
         <span class="k">call </span><span class="n">timer</span><span class="p">(</span><span class="s1">&#39;TS-rgn2tri&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>

         <span class="c">! Bye also waits for all processors</span>
         <span class="k">call </span><span class="n">bye</span><span class="p">(</span><span class="s1">&#39;transiesta analyzation performed&#39;</span><span class="p">)</span>
         
      <span class="k">end if</span>


<span class="k">      write</span><span class="p">(</span><span class="n">oname</span><span class="p">,</span><span class="s2">&quot;(a,i0)&quot;</span><span class="p">)</span> <span class="s2">&quot;EDM at geom step &quot;</span><span class="p">,</span> <span class="n">istep</span>
      <span class="k">call </span><span class="n">newdSpData2D</span><span class="p">(</span><span class="n">sparse_pattern</span><span class="p">,</span><span class="n">spin</span><span class="p">%</span><span class="n">EDM</span><span class="p">,</span><span class="n">block_dist</span><span class="p">,</span><span class="n">EDM_2D</span><span class="p">,</span>
     <span class="p">&amp;</span>     <span class="n">name</span><span class="o">=</span><span class="n">oname</span><span class="p">)</span>
      <span class="c">!if (ionode) call print_type(EDM_2D)</span>
      <span class="n">Escf</span> <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">EDM_2D</span><span class="p">)</span>

      <span class="k">call </span><span class="n">re_alloc</span><span class="p">(</span><span class="n">Dold</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">maxnh</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">spin</span><span class="p">%</span><span class="n">DM</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Dold&#39;</span><span class="p">,</span>
     <span class="p">.</span>     <span class="n">routine</span><span class="o">=</span><span class="s1">&#39;sparseMat&#39;</span><span class="p">,</span><span class="n">copy</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span><span class="n">shrink</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
      <span class="k">call </span><span class="n">re_alloc</span><span class="p">(</span><span class="n">Hold</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">maxnh</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Hold&#39;</span><span class="p">,</span>
     <span class="p">.</span>     <span class="n">routine</span><span class="o">=</span><span class="s1">&#39;sparseMat&#39;</span><span class="p">,</span><span class="n">copy</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span><span class="n">shrink</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">converge_EDM</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">re_alloc</span><span class="p">(</span><span class="n">Eold</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">maxnh</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">spin</span><span class="p">%</span><span class="n">EDM</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Eold&#39;</span><span class="p">,</span>
     <span class="p">.</span>     <span class="n">routine</span><span class="o">=</span><span class="s1">&#39;sparseMat&#39;</span><span class="p">,</span><span class="n">copy</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span><span class="n">shrink</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
      <span class="k">end if</span>

<span class="c">!     Allocate/reallocate storage associated with Hamiltonian/Overlap matrix</span>
      <span class="k">write</span><span class="p">(</span><span class="n">oname</span><span class="p">,</span><span class="s2">&quot;(a,i0)&quot;</span><span class="p">)</span> <span class="s2">&quot;H at geom step &quot;</span><span class="p">,</span> <span class="n">istep</span>
      <span class="k">call </span><span class="n">newdSpData2D</span><span class="p">(</span><span class="n">sparse_pattern</span><span class="p">,</span><span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span><span class="n">block_dist</span><span class="p">,</span><span class="n">H_2D</span><span class="p">,</span>
     <span class="p">&amp;</span>                  <span class="n">name</span><span class="o">=</span><span class="n">oname</span><span class="p">)</span>
      <span class="c">!if (ionode) call print_type(H_2D)</span>
      <span class="n">H</span> <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">H_2D</span><span class="p">)</span>

      <span class="k">write</span><span class="p">(</span><span class="n">oname</span><span class="p">,</span><span class="s2">&quot;(a,i0)&quot;</span><span class="p">)</span> <span class="s2">&quot;H_vkb at geom step &quot;</span><span class="p">,</span> <span class="n">istep</span>
      <span class="k">call </span><span class="n">newdSpData1D</span><span class="p">(</span><span class="n">sparse_pattern</span><span class="p">,</span><span class="n">block_dist</span><span class="p">,</span><span class="n">H_vkb_1D</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="n">oname</span><span class="p">)</span>
      <span class="c">!if (ionode) call print_type(H_vkb_1D)</span>

      <span class="k">write</span><span class="p">(</span><span class="n">oname</span><span class="p">,</span><span class="s2">&quot;(a,i0)&quot;</span><span class="p">)</span> <span class="s2">&quot;H_kin at geom step &quot;</span><span class="p">,</span> <span class="n">istep</span>
      <span class="k">call </span><span class="n">newdSpData1D</span><span class="p">(</span><span class="n">sparse_pattern</span><span class="p">,</span><span class="n">block_dist</span><span class="p">,</span><span class="n">H_kin_1D</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="n">oname</span><span class="p">)</span>
      <span class="c">!if (ionode) call print_type(H_kin_1D)</span>

      <span class="k">if</span> <span class="p">(</span> <span class="n">switch_ldau</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">         write</span><span class="p">(</span><span class="n">oname</span><span class="p">,</span><span class="s2">&quot;(a,i0)&quot;</span><span class="p">)</span> <span class="s2">&quot;H_ldau at geom step &quot;</span><span class="p">,</span> <span class="n">istep</span>
         <span class="k">call </span><span class="n">newdSpData2D</span><span class="p">(</span><span class="n">sparse_pattern</span><span class="p">,</span><span class="n">spin</span><span class="p">%</span><span class="n">spinor</span><span class="p">,</span>
     <span class="p">&amp;</span>        <span class="n">block_dist</span><span class="p">,</span><span class="n">H_ldau_2D</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="n">oname</span><span class="p">)</span>
         
         <span class="c">! Initialize to 0, LDA+U may re-calculate</span>
         <span class="c">!   this matrix sporadically doing the SCF.</span>
         <span class="c">! Hence initialization MUST be performed upon</span>
         <span class="c">! re-allocation.</span>
         <span class="k">call </span><span class="n">init_val</span><span class="p">(</span><span class="n">H_ldau_2D</span><span class="p">)</span>
         <span class="k">if</span> <span class="p">(</span> <span class="n">inicoor</span> <span class="o">/=</span> <span class="n">istep</span> <span class="p">)</span> <span class="k">then</span>
            <span class="c">! Force initialization of the LDA+U</span>
            <span class="c">! when changing geometry</span>
            <span class="c">! For the first geometry this is controlled</span>
            <span class="c">! by the user via an fdf-key</span>
            <span class="n">ldau_init</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
         <span class="k">end if</span>
<span class="k">      end if</span>
<span class="k">      </span>
<span class="k">      if</span> <span class="p">(</span> <span class="n">spin</span><span class="p">%</span><span class="n">SO_onsite</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="n">oname</span><span class="p">,</span><span class="s2">&quot;(a,i0)&quot;</span><span class="p">)</span> <span class="s2">&quot;H_so (onsite) at geom step &quot;</span><span class="p">,</span> <span class="n">istep</span>
        <span class="k">call </span><span class="n">newdSpData2D</span><span class="p">(</span><span class="n">sparse_pattern</span><span class="p">,</span><span class="n">spin</span><span class="p">%</span><span class="n">H</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span>
     <span class="p">&amp;</span>      <span class="n">block_dist</span><span class="p">,</span><span class="n">H_so_on_2D</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="n">oname</span><span class="p">)</span>
      <span class="k">else if</span> <span class="p">(</span> <span class="n">spin</span><span class="p">%</span><span class="n">SO_offsite</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="n">oname</span><span class="p">,</span><span class="s2">&quot;(a,i0)&quot;</span><span class="p">)</span> <span class="s2">&quot;H_so (offsite) at geom step &quot;</span><span class="p">,</span> <span class="n">istep</span>
        <span class="k">call </span><span class="n">newzSpData2D</span><span class="p">(</span><span class="n">sparse_pattern</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span>
     <span class="p">&amp;</span>      <span class="n">block_dist</span><span class="p">,</span><span class="n">H_so_off_2D</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="n">oname</span><span class="p">)</span>
      <span class="n">endif</span>

      <span class="k">write</span><span class="p">(</span><span class="n">oname</span><span class="p">,</span><span class="s2">&quot;(a,i0)&quot;</span><span class="p">)</span> <span class="s2">&quot;S at geom step &quot;</span><span class="p">,</span> <span class="n">istep</span>
      <span class="k">call </span><span class="n">newdSpData1D</span><span class="p">(</span><span class="n">sparse_pattern</span><span class="p">,</span><span class="n">block_dist</span><span class="p">,</span><span class="n">S_1D</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="n">oname</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">ionode</span><span class="p">)</span> <span class="k">call </span><span class="n">print_type</span><span class="p">(</span><span class="n">S_1D</span><span class="p">)</span>
      <span class="n">S</span> <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">S_1D</span><span class="p">)</span>

<span class="c">!     Find overlap matrix </span>
      <span class="k">call </span><span class="n">overlap</span><span class="p">(</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">na_s</span><span class="p">,</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">scell</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">indxua</span><span class="p">,</span> <span class="n">rmaxo</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span>
     <span class="p">&amp;</span>              <span class="n">lasto</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span> <span class="n">isa</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">S</span> <span class="p">)</span>


<span class="c">!</span>
<span class="c">!     Here we could also read a Hamiltonian, either to proceed to</span>
<span class="c">!     the analysis section (with nscf=0) or to start a mix-H scf cycle.</span>
<span class="c">!</span>
<span class="c">!     Initialize density matrix</span>
      <span class="c">! The resizing of Dscf is done inside new_dm</span>
      <span class="k">call </span><span class="n">new_DM</span><span class="p">(</span><span class="n">auxchanged</span><span class="p">,</span> <span class="n">DM_history</span><span class="p">,</span> <span class="n">DM_2D</span><span class="p">,</span> <span class="n">EDM_2D</span><span class="p">)</span>

      <span class="n">Dscf</span> <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">DM_2D</span><span class="p">)</span>
      <span class="n">Escf</span> <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">EDM_2D</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">spin</span><span class="p">%</span><span class="n">H</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">call </span><span class="n">print_spin</span><span class="p">(</span><span class="n">dummy_qspin</span><span class="p">)</span>

      <span class="c">! Initialize energy-density matrix to zero for first call to overfsm</span>
      <span class="c">! Only part of Escf is updated in TS, so if it is put as zero here</span>
      <span class="c">! a continuation run gives bad forces.</span>
      <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">TSrun</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">normalize_DM</span><span class="p">(</span> <span class="n">first</span><span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span> <span class="p">)</span>
<span class="c">!$OMP parallel workshare default(shared)</span>
         <span class="n">Escf</span><span class="p">(:,:)</span> <span class="o">=</span> <span class="mf">0.0_dp</span>
<span class="c">!$OMP end parallel workshare</span>
      <span class="k">end if</span>

<span class="cp">#ifdef TEST_IO</span>
      <span class="c">! We test the io-performance here</span>
      <span class="k">call </span><span class="n">time_io</span><span class="p">(</span><span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span><span class="n">H_2D</span><span class="p">)</span>
<span class="cp">#endif</span>

<span class="c">!     If onlyS, Save overlap matrix and exit</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">onlyS</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">         </span><span class="n">fname</span> <span class="o">=</span> <span class="n">fname_TSHS</span><span class="p">(</span><span class="n">slabel</span><span class="p">,</span> <span class="n">onlyS</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span> <span class="p">)</span>
         <span class="c">! We include H as S, well-knowing that we only write one of</span>
         <span class="c">! them, there is no need to allocate space for no reason!</span>
         <span class="k">call </span><span class="n">ts_write_tshs</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> 
     <span class="p">&amp;</span>        <span class="p">.</span><span class="n">true</span><span class="p">.,</span> <span class="nb">Gamma</span><span class="p">,</span> <span class="n">ts_Gamma_file</span><span class="p">,</span>
     <span class="p">&amp;</span>        <span class="n">ucell</span><span class="p">,</span> <span class="n">nsc</span><span class="p">,</span> <span class="n">isc_off</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span>
     <span class="p">&amp;</span>        <span class="n">ts_kscell_file</span><span class="p">,</span> <span class="n">ts_kdispl_file</span><span class="p">,</span>
     <span class="p">&amp;</span>        <span class="n">xa</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span> 
     <span class="p">&amp;</span>        <span class="n">H_2D</span><span class="p">,</span> <span class="n">S_1D</span><span class="p">,</span> <span class="n">indxuo</span><span class="p">,</span> 
     <span class="p">&amp;</span>        <span class="n">dummyEf</span><span class="p">,</span> <span class="n">dummyQtot</span><span class="p">,</span> <span class="n">Temp</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
         <span class="k">call </span><span class="n">bye</span><span class="p">(</span> <span class="s1">&#39;Save overlap matrix and exit&#39;</span> <span class="p">)</span> <span class="c">! Exit siesta</span>
         
      <span class="n">endif</span> 

      <span class="c">! In case the user is requesting a Fermi-correction</span>
      <span class="c">! we need to delete the TS_FERMI file after each iteration</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">TSmode</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">TS_RHOCORR_METHOD</span> <span class="o">==</span> <span class="n">TS_RHOCORR_FERMI</span>
     <span class="p">&amp;</span>     <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">IONode</span> <span class="p">)</span> <span class="k">then</span>
          <span class="c">! Delete the TS_FERMI file (enables</span>
          <span class="c">! reading it in and improve on the convergence)</span>
          <span class="k">if</span> <span class="p">(</span> <span class="n">file_exist</span><span class="p">(</span><span class="s1">&#39;TS_FERMI&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">             </span><span class="n">i</span> <span class="o">=</span> <span class="mi">23455</span> <span class="c">! this should just not be used any were...</span>
             <span class="c">! Delete the file...</span>
             <span class="k">open</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">i</span><span class="p">,</span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;TS_FERMI&#39;</span><span class="p">)</span>
             <span class="k">close</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">status</span><span class="o">=</span><span class="s1">&#39;delete&#39;</span><span class="p">)</span>
          <span class="k">end if</span>
<span class="k">       end if</span>
      
<span class="cp">#ifdef CDF</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">writedm_cdf</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">setup_dm_netcdf_file</span><span class="p">(</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span>
     <span class="p">&amp;</span>                              <span class="n">no_s</span><span class="p">,</span> <span class="n">indxuo</span><span class="p">,</span>
     <span class="p">&amp;</span>                              <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">)</span>
      <span class="n">endif</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">writedm_cdf_history</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">setup_dm_netcdf_file</span><span class="p">(</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span>
     <span class="p">&amp;</span>                              <span class="n">no_s</span><span class="p">,</span> <span class="n">indxuo</span><span class="p">,</span>
     <span class="p">&amp;</span>                              <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span>
     <span class="p">&amp;</span>                              <span class="n">istep</span><span class="p">)</span>
      <span class="n">endif</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">writedmhs_cdf</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">setup_dmhs_netcdf_file</span><span class="p">(</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span>
     <span class="p">&amp;</span>                              <span class="n">no_s</span><span class="p">,</span> <span class="n">indxuo</span><span class="p">,</span>
     <span class="p">&amp;</span>                              <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span>
     <span class="p">&amp;</span>                              <span class="n">s</span><span class="p">)</span>
      <span class="n">endif</span>
      <span class="k">if</span><span class="p">(</span><span class="n">writedmhs_cdf_history</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">setup_dmhs_netcdf_file</span><span class="p">(</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span>
     <span class="p">&amp;</span>                              <span class="n">no_s</span><span class="p">,</span> <span class="n">indxuo</span><span class="p">,</span>
     <span class="p">&amp;</span>                              <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span>
     <span class="p">&amp;</span>                              <span class="n">s</span><span class="p">,</span>
     <span class="p">&amp;</span>                              <span class="n">istep</span><span class="p">)</span>
      <span class="n">endif</span>
<span class="cp">#endif</span>
      <span class="k">call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;state_init&#39;</span><span class="p">,</span> <span class="mi">2</span> <span class="p">)</span>

      <span class="k">END subroutine </span><span class="n">state_init</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2018 <a rel="license" href="http://www.gnu.org/licenses/old-licenses/fdl-1.2.en.html">GNU Free Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> SIESTA was developed by SIESTA Group</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>