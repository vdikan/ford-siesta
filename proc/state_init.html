<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	 
	 <meta name="description" content="A first-principles materials simulation code using Density Functional Theory.">
    
    <meta name="author" content="SIESTA Group" >
    <link rel="icon" href="../favicon.png">

    <title>state_init &ndash; SIESTA</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">SIESTA <small>trunk-674--vdikan-ford-681</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
				
            <li><a href='../page/index.html'>Program Overview</a></li>
	    
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
		 aria-expanded="false">Contents <span class="caret"></span></a>
	      <ul class="dropdown-menu">
              
            <li><a href="../lists/files.html">Source Files</a></li>
				
				
            <li><a href="../lists/modules.html">Modules</a></li>
				
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
				
								
            <li><a href="../lists/types.html">Derived Types</a></li>
				
				
            </ul>
            </li>

<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>state_init
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
	  data-placement="bottom" data-html="true"
	  title="11.8% of total for procedures.">349 statements</a>
     </li> 
     
     
    <li><i class="fa fa-code"></i><a href="../src/state_init.F"> Source File</a></li>
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
     <li><a href='../sourcefile/state_init.f.html'>state_init.F</a></li>
  
     <li><a href='../module/m_state_init.html'>m_state_init</a></li>
  
     <li class="active">state_init</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  




















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/state_init.html#src">state_init</a>
  </div>
</div>


  <hr>
  

<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allprocs-0">All Procedures</a></h3></div>
  <div id="allprocs-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../proc/compute_dm.html">compute_dm</a>
      
      <a class="list-group-item" href="../interface/compute_max_diff.html">compute_max_diff</a>
      
      <a class="list-group-item" href="../proc/compute_max_diff_1d.html">compute_max_diff_1d</a>
      
      <a class="list-group-item" href="../proc/compute_max_diff_2d.html">compute_max_diff_2d</a>
      
      <a class="list-group-item" href="../proc/current_itt.html">current_itt</a>
      
      <a class="list-group-item" href="../proc/getstackval.html">getstackval</a>
      
      <a class="list-group-item" href="../proc/inverse.html">inverse</a>
      
      <a class="list-group-item" href="../proc/is_next.html">is_next</a>
      
      <a class="list-group-item" href="../proc/mix_method.html">mix_method</a>
      
      <a class="list-group-item" href="../proc/mix_method_variant.html">mix_method_variant</a>
      
      <a class="list-group-item" href="../proc/mixer_init.html">mixer_init</a>
      
      <a class="list-group-item" href="../proc/mixers_history_init.html">mixers_history_init</a>
      
      <a class="list-group-item" href="../proc/mixers_init.html">mixers_init</a>
      
      <a class="list-group-item" href="../proc/mixers_print.html">mixers_print</a>
      
      <a class="list-group-item" href="../proc/mixers_print_block.html">mixers_print_block</a>
      
      <a class="list-group-item" href="../proc/mixers_reset.html">mixers_reset</a>
      
      <a class="list-group-item" href="../proc/mixers_scf_history_init.html">mixers_scf_history_init</a>
      
      <a class="list-group-item" href="../proc/mixers_scf_init.html">mixers_scf_init</a>
      
      <a class="list-group-item" href="../proc/mixers_scf_print.html">mixers_scf_print</a>
      
      <a class="list-group-item" href="../proc/mixers_scf_print_block.html">mixers_scf_print_block</a>
      
      <a class="list-group-item" href="../proc/mixers_scf_reset.html">mixers_scf_reset</a>
      
      <a class="list-group-item" href="../interface/mixing.html">mixing</a>
      
      <a class="list-group-item" href="../proc/mixing_1d.html">mixing_1d</a>
      
      <a class="list-group-item" href="../proc/mixing_2d.html">mixing_2d</a>
      
      <a class="list-group-item" href="../proc/mixing_calc_next.html">mixing_calc_next</a>
      
      <a class="list-group-item" href="../proc/mixing_coeff.html">mixing_coeff</a>
      
      <a class="list-group-item" href="../proc/mixing_finalize.html">mixing_finalize</a>
      
      <a class="list-group-item" href="../proc/mixing_init.html">mixing_init</a>
      
      <a class="list-group-item" href="../proc/mixing_ncoeff.html">mixing_ncoeff</a>
      
      <a class="list-group-item" href="../proc/mixing_scf_converged.html">mixing_scf_converged</a>
      
      <a class="list-group-item" href="../proc/mixing_step.html">mixing_step</a>
      
      <a class="list-group-item" href="../proc/norm.html">norm</a>
      
      <a class="list-group-item" href="../proc/push_diff.html">push_diff</a>
      
      <a class="list-group-item" href="../proc/push_f.html">push_F</a>
      
      <a class="list-group-item" href="../proc/push_stack_data.html">push_stack_data</a>
      
      <a class="list-group-item" href="../proc/setup_h0.html">setup_H0</a>
      
      <a class="list-group-item" href="../proc/setup_hamiltonian.html">setup_hamiltonian</a>
      
      <a class="list-group-item" href="../proc/siesta_analysis.html">siesta_analysis</a>
      
      <a class="list-group-item" href="../proc/siesta_forces.html">siesta_forces</a>
      
      <a class="list-group-item" href="../proc/stack_check.html">stack_check</a>
      
      <a class="list-group-item" href="../proc/state_analysis.html">state_analysis</a>
      
      <a class="list-group-item" href="../proc/state_init.html">state_init</a>
      
      <a class="list-group-item" href="../proc/svd.html">svd</a>
      
      <a class="list-group-item" href="../proc/update_f.html">update_F</a>
      
    </div>
  </div>
</div>


</div>  

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine state_init(istep)
    
    
	 
</h2>
    
  
    <div class="panel panel-default">
      <div class="panel-heading">
	<h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
      
      <li class="list-group-item">
	<ul class="list-inline">
	  
	  <li>Kpoint_grid</li>
	  
	  <li>m_os</li>
	  
	  <li>m_new_dm</li>
	  
	  <li>m_proximity_check</li>
	  
	  <li>siesta_options</li>
	  
	  <li>units</li>
	  
	  <li>sparse_matrices</li>
	  
	  <li>sparse_matrices</li>
	  
	  <li>sparse_matrices</li>
	  
	  <li>sparse_matrices</li>
	  
	  <li>sparse_matrices</li>
	  
	  <li>sparse_matrices</li>
	  
	  <li>sparse_matrices</li>
	  
	  <li>sparse_matrices</li>
	  
	  <li>sparse_matrices</li>
	  
	  <li>sparse_matrices</li>
	  
	  <li>sparse_matrices</li>
	  
	  <li>create_Sparsity_SC</li>
	  
	  <li>m_sparsity_handling</li>
	  
	  <li>m_sparsity_handling</li>
	  
	  <li>m_pivot_methods</li>
	  
	  <li>siesta_geom</li>
	  
	  <li>atomlist</li>
	  
	  <li>alloc</li>
	  
	  <li>m_hsparse</li>
	  
	  <li>m_overlap</li>
	  
	  <li>m_supercell</li>
	  
	  <li>siesta_cml</li>
	  
	  <li>zmatrix</li>
	  
	  <li>m_energies</li>
	  
	  <li>write_subs</li>
	  
	  <li>m_ioxv</li>
	  
	  <li>m_iotdxv</li>
	  
	  <li>m_steps</li>
	  
	  <li>parallel</li>
	  
	  <li>m_spin</li>
	  
	  <li>m_rmaxh</li>
	  
	  <li><a href='../module/m_mixing.html'>m_mixing</a></li>
	  
	  <li><a href='../module/m_mixing_scf.html'>m_mixing_scf</a></li>
	  
	  <li>m_normalize_dm</li>
	  
	  <li>m_eo</li>
	  
	  <li>m_gamma</li>
	  
	  <li>files</li>
	  
	  <li>m_mpi_utils</li>
	  
	  <li>m_mpi_utils</li>
	  
	  <li>domain_decom</li>
	  
	  <li>ldau_specs</li>
	  
	  <li>m_sparse</li>
	  
	  <li>m_ts_kpoints</li>
	  
	  <li>m_ts_charge</li>
	  
	  <li>m_ts_options</li>
	  
	  <li>m_ts_options</li>
	  
	  <li>m_ts_options</li>
	  
	  <li>m_ts_electype</li>
	  
	  <li>m_ts_global_vars</li>
	  
	  <li>sys</li>
	  
	  <li>m_ts_io</li>
	  
	  <li>m_ts_sparse</li>
	  
	  <li>m_ts_tri_init</li>
	  
	  <li>files</li>
	  
	  <li>m_chess</li>
	  
	  <li>iodm_netcdf</li>
	  
	  <li>iodmhs_netcdf</li>
	  
	  <li>class_Sparsity</li>
	  
	  <li>class_dSpData1D</li>
	  
	  <li>class_dSpData2D</li>
	  
	  <li>class_dData2D</li>
	  
	  <li>m_test_io</li>
	  
	  <li>siesta_dicts</li>
	  
	</ul>
      </li>
      
      
      
      <li class="list-group-item">
	<div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~state_init~~UsesGraph Pages: 1 -->
<svg id="procstate_initUsesGraph" width="462pt" height="2254pt"
 viewBox="0.00 0.00 462.00 2254.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~state_init~~UsesGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 2250)">
<title>proc~~state_init~~UsesGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-2250 458,-2250 458,4 -4,4"/>
<!-- proc~state_init -->
<g id="proc~~state_init~~UsesGraph_node1" class="node"><title>proc~state_init</title>
<polygon fill="none" stroke="black" points="454,-1137 399,-1137 399,-1113 454,-1113 454,-1137"/>
<text text-anchor="middle" x="426.5" y="-1122.6" font-family="Helvetica,sans-Serif" font-size="10.50">state_init</text>
</g>
<!-- class_dSpData2D -->
<g id="proc~~state_init~~UsesGraph_node2" class="node"><title>class_dSpData2D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="356,-2246 259,-2246 259,-2222 356,-2222 356,-2246"/>
<text text-anchor="middle" x="307.5" y="-2231.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_dSpData2D</text>
</g>
<!-- proc~state_init&#45;&gt;class_dSpData2D -->
<g id="proc~~state_init~~UsesGraph_edge3" class="edge"><title>proc~state_init&#45;&gt;class_dSpData2D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.589,-1137.19C426.316,-1250.75 429.689,-2121.57 363,-2213 362.438,-2213.77 361.844,-2214.51 361.22,-2215.23"/>
<polygon fill="#000000" stroke="#000000" points="358.809,-2212.69 353.567,-2221.89 363.407,-2217.96 358.809,-2212.69"/>
</g>
<!-- m_ts_options -->
<g id="proc~~state_init~~UsesGraph_node3" class="node"><title>m_ts_options</title>
<polygon fill="#337ab7" stroke="#337ab7" points="345.5,-2204 269.5,-2204 269.5,-2180 345.5,-2180 345.5,-2204"/>
<text text-anchor="middle" x="307.5" y="-2189.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_options</text>
</g>
<!-- proc~state_init&#45;&gt;m_ts_options -->
<g id="proc~~state_init~~UsesGraph_edge1" class="edge"><title>proc~state_init&#45;&gt;m_ts_options</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.559,-1137.06C425.996,-1247.66 427.157,-2083.26 363,-2171 360.611,-2174.27 357.641,-2177.03 354.331,-2179.36"/>
<polygon fill="#000000" stroke="#000000" points="352.532,-2176.35 345.535,-2184.31 355.966,-2182.45 352.532,-2176.35"/>
</g>
<!-- m_rmaxh -->
<g id="proc~~state_init~~UsesGraph_node4" class="node"><title>m_rmaxh</title>
<polygon fill="#337ab7" stroke="#337ab7" points="336.5,-2162 278.5,-2162 278.5,-2138 336.5,-2138 336.5,-2162"/>
<text text-anchor="middle" x="307.5" y="-2147.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_rmaxh</text>
</g>
<!-- proc~state_init&#45;&gt;m_rmaxh -->
<g id="proc~~state_init~~UsesGraph_edge2" class="edge"><title>proc~state_init&#45;&gt;m_rmaxh</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.527,-1137.26C425.664,-1246.09 424.566,-2045.02 363,-2129 358.811,-2134.71 352.848,-2138.87 346.393,-2141.9"/>
<polygon fill="#000000" stroke="#000000" points="344.833,-2138.75 336.73,-2145.58 347.321,-2145.29 344.833,-2138.75"/>
</g>
<!-- m_normalize_dm -->
<g id="proc~~state_init~~UsesGraph_node5" class="node"><title>m_normalize_dm</title>
<polygon fill="#337ab7" stroke="#337ab7" points="355,-2120 260,-2120 260,-2096 355,-2096 355,-2120"/>
<text text-anchor="middle" x="307.5" y="-2105.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_normalize_dm</text>
</g>
<!-- proc~state_init&#45;&gt;m_normalize_dm -->
<g id="proc~~state_init~~UsesGraph_edge4" class="edge"><title>proc~state_init&#45;&gt;m_normalize_dm</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.492,-1137.07C425.322,-1242.64 422.047,-2006.68 363,-2087 362.435,-2087.77 361.838,-2088.51 361.212,-2089.22"/>
<polygon fill="#000000" stroke="#000000" points="358.803,-2086.68 353.54,-2095.87 363.388,-2091.97 358.803,-2086.68"/>
</g>
<!-- m_supercell -->
<g id="proc~~state_init~~UsesGraph_node6" class="node"><title>m_supercell</title>
<polygon fill="#337ab7" stroke="#337ab7" points="342.5,-2078 272.5,-2078 272.5,-2054 342.5,-2054 342.5,-2078"/>
<text text-anchor="middle" x="307.5" y="-2063.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_supercell</text>
</g>
<!-- proc~state_init&#45;&gt;m_supercell -->
<g id="proc~~state_init~~UsesGraph_edge5" class="edge"><title>proc~state_init&#45;&gt;m_supercell</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.453,-1137.19C424.959,-1240.58 419.475,-1968.42 363,-2045 360.034,-2049.02 356.191,-2052.27 351.917,-2054.9"/>
<polygon fill="#000000" stroke="#000000" points="350.095,-2051.9 342.685,-2059.47 353.2,-2058.17 350.095,-2051.9"/>
</g>
<!-- units -->
<g id="proc~~state_init~~UsesGraph_node7" class="node"><title>units</title>
<polygon fill="#337ab7" stroke="#337ab7" points="334.5,-2036 280.5,-2036 280.5,-2012 334.5,-2012 334.5,-2036"/>
<text text-anchor="middle" x="307.5" y="-2021.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">units</text>
</g>
<!-- proc~state_init&#45;&gt;units -->
<g id="proc~~state_init~~UsesGraph_edge6" class="edge"><title>proc~state_init&#45;&gt;units</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.361,-1137.17C424.119,-1237.29 413.782,-1923.54 363,-1998 358.348,-2004.82 351.401,-2009.9 344.011,-2013.68"/>
<polygon fill="#000000" stroke="#000000" points="342.332,-2010.59 334.553,-2017.78 345.12,-2017.01 342.332,-2010.59"/>
</g>
<!-- module~m_mixing -->
<g id="proc~~state_init~~UsesGraph_node8" class="node"><title>module~m_mixing</title>
<g id="a_proc~~state_init~~UsesGraph_node8"><a xlink:href=".././module/m_mixing.html" xlink:title="m_mixing">
<polygon fill="#337ab7" stroke="#337ab7" points="216,-738 158,-738 158,-714 216,-714 216,-738"/>
<text text-anchor="middle" x="187" y="-723.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_mixing</text>
</a>
</g>
</g>
<!-- proc~state_init&#45;&gt;module~m_mixing -->
<g id="proc~~state_init~~UsesGraph_edge7" class="edge"><title>proc~state_init&#45;&gt;module~m_mixing</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.568,-1137.22C425.993,-1236.31 426.5,-1906.05 363,-1965 326.845,-1998.56 287.772,-1998.97 252,-1965 206.1,-1921.41 190.528,-912.866 188.292,-748.539"/>
<polygon fill="#000000" stroke="#000000" points="191.787,-748.144 188.154,-738.191 184.788,-748.237 191.787,-748.144"/>
</g>
<!-- siesta_cml -->
<g id="proc~~state_init~~UsesGraph_node9" class="node"><title>siesta_cml</title>
<polygon fill="#337ab7" stroke="#337ab7" points="339,-1956 276,-1956 276,-1932 339,-1932 339,-1956"/>
<text text-anchor="middle" x="307.5" y="-1941.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_cml</text>
</g>
<!-- proc~state_init&#45;&gt;siesta_cml -->
<g id="proc~~state_init~~UsesGraph_edge8" class="edge"><title>proc~state_init&#45;&gt;siesta_cml</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.322,-1137.04C423.822,-1231.9 412.106,-1857.13 363,-1923 359.312,-1927.95 354.297,-1931.73 348.795,-1934.62"/>
<polygon fill="#000000" stroke="#000000" points="347.055,-1931.56 339.223,-1938.69 349.795,-1938 347.055,-1931.56"/>
</g>
<!-- write_subs -->
<g id="proc~~state_init~~UsesGraph_node10" class="node"><title>write_subs</title>
<polygon fill="#337ab7" stroke="#337ab7" points="339.5,-1914 275.5,-1914 275.5,-1890 339.5,-1890 339.5,-1914"/>
<text text-anchor="middle" x="307.5" y="-1899.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_subs</text>
</g>
<!-- proc~state_init&#45;&gt;write_subs -->
<g id="proc~~state_init~~UsesGraph_edge9" class="edge"><title>proc~state_init&#45;&gt;write_subs</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.262,-1137.28C423.364,-1230.04 409.525,-1818.87 363,-1881 359.379,-1885.84 354.492,-1889.56 349.123,-1892.42"/>
<polygon fill="#000000" stroke="#000000" points="347.553,-1889.29 339.774,-1896.48 350.34,-1895.71 347.553,-1889.29"/>
</g>
<!-- ldau_specs -->
<g id="proc~~state_init~~UsesGraph_node11" class="node"><title>ldau_specs</title>
<polygon fill="#337ab7" stroke="#337ab7" points="341,-1872 274,-1872 274,-1848 341,-1848 341,-1872"/>
<text text-anchor="middle" x="307.5" y="-1857.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ldau_specs</text>
</g>
<!-- proc~state_init&#45;&gt;ldau_specs -->
<g id="proc~~state_init~~UsesGraph_edge12" class="edge"><title>proc~state_init&#45;&gt;ldau_specs</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.202,-1137.16C422.913,-1226.58 407.006,-1780.53 363,-1839 359.646,-1843.46 355.218,-1846.97 350.332,-1849.73"/>
<polygon fill="#000000" stroke="#000000" points="348.794,-1846.59 341.175,-1853.95 351.722,-1852.95 348.794,-1846.59"/>
</g>
<!-- m_eo -->
<g id="proc~~state_init~~UsesGraph_node12" class="node"><title>m_eo</title>
<polygon fill="#337ab7" stroke="#337ab7" points="334.5,-1830 280.5,-1830 280.5,-1806 334.5,-1806 334.5,-1830"/>
<text text-anchor="middle" x="307.5" y="-1815.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_eo</text>
</g>
<!-- proc~state_init&#45;&gt;m_eo -->
<g id="proc~~state_init~~UsesGraph_edge10" class="edge"><title>proc~state_init&#45;&gt;m_eo</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.129,-1137.26C422.406,-1223.94 404.454,-1742.23 363,-1797 358.33,-1803.17 351.602,-1807.53 344.456,-1810.61"/>
<polygon fill="#000000" stroke="#000000" points="342.888,-1807.45 334.609,-1814.06 345.204,-1814.05 342.888,-1807.45"/>
</g>
<!-- m_energies -->
<g id="proc~~state_init~~UsesGraph_node13" class="node"><title>m_energies</title>
<polygon fill="#337ab7" stroke="#337ab7" points="342,-1788 273,-1788 273,-1764 342,-1764 342,-1788"/>
<text text-anchor="middle" x="307.5" y="-1773.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_energies</text>
</g>
<!-- proc~state_init&#45;&gt;m_energies -->
<g id="proc~~state_init~~UsesGraph_edge11" class="edge"><title>proc~state_init&#45;&gt;m_energies</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.058,-1137.03C421.916,-1219.84 401.961,-1703.85 363,-1755 359.855,-1759.13 355.789,-1762.45 351.295,-1765.11"/>
<polygon fill="#000000" stroke="#000000" points="349.741,-1761.98 342.258,-1769.48 352.785,-1768.28 349.741,-1761.98"/>
</g>
<!-- m_ts_kpoints -->
<g id="proc~~state_init~~UsesGraph_node14" class="node"><title>m_ts_kpoints</title>
<polygon fill="#337ab7" stroke="#337ab7" points="345.5,-1746 269.5,-1746 269.5,-1722 345.5,-1722 345.5,-1746"/>
<text text-anchor="middle" x="307.5" y="-1731.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_kpoints</text>
</g>
<!-- proc~state_init&#45;&gt;m_ts_kpoints -->
<g id="proc~~state_init~~UsesGraph_edge13" class="edge"><title>proc~state_init&#45;&gt;m_ts_kpoints</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M424.959,-1137.24C421.315,-1217.39 399.401,-1665.56 363,-1713 360.639,-1716.08 357.767,-1718.7 354.589,-1720.95"/>
<polygon fill="#000000" stroke="#000000" points="352.586,-1718.06 345.604,-1726.03 356.032,-1724.15 352.586,-1718.06"/>
</g>
<!-- m_ts_sparse -->
<g id="proc~~state_init~~UsesGraph_node15" class="node"><title>m_ts_sparse</title>
<polygon fill="#337ab7" stroke="#337ab7" points="344.5,-1704 270.5,-1704 270.5,-1680 344.5,-1680 344.5,-1704"/>
<text text-anchor="middle" x="307.5" y="-1689.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_sparse</text>
</g>
<!-- proc~state_init&#45;&gt;m_ts_sparse -->
<g id="proc~~state_init~~UsesGraph_edge15" class="edge"><title>proc~state_init&#45;&gt;m_ts_sparse</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.758,-1137.11C427.06,-1209.41 430.434,-1583.84 363,-1671 360.382,-1674.38 357.147,-1677.22 353.57,-1679.6"/>
<polygon fill="#000000" stroke="#000000" points="351.869,-1676.54 344.729,-1684.37 355.192,-1682.71 351.869,-1676.54"/>
</g>
<!-- m_ts_charge -->
<g id="proc~~state_init~~UsesGraph_node16" class="node"><title>m_ts_charge</title>
<polygon fill="#337ab7" stroke="#337ab7" points="345,-1662 270,-1662 270,-1638 345,-1638 345,-1662"/>
<text text-anchor="middle" x="307.5" y="-1647.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_charge</text>
</g>
<!-- proc~state_init&#45;&gt;m_ts_charge -->
<g id="proc~~state_init~~UsesGraph_edge14" class="edge"><title>proc~state_init&#45;&gt;m_ts_charge</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.629,-1137.07C426.129,-1205.95 425.423,-1549.1 363,-1629 360.508,-1632.19 357.468,-1634.9 354.111,-1637.19"/>
<polygon fill="#000000" stroke="#000000" points="352.305,-1634.19 345.247,-1642.09 355.692,-1640.32 352.305,-1634.19"/>
</g>
<!-- iodmhs_netcdf -->
<g id="proc~~state_init~~UsesGraph_node17" class="node"><title>iodmhs_netcdf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="348.5,-1620 266.5,-1620 266.5,-1596 348.5,-1596 348.5,-1620"/>
<text text-anchor="middle" x="307.5" y="-1605.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iodmhs_netcdf</text>
</g>
<!-- proc~state_init&#45;&gt;iodmhs_netcdf -->
<g id="proc~~state_init~~UsesGraph_edge16" class="edge"><title>proc~state_init&#45;&gt;iodmhs_netcdf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.476,-1137.34C425.111,-1203.34 420.333,-1514.45 363,-1587 361.322,-1589.12 359.402,-1591.03 357.308,-1592.75"/>
<polygon fill="#000000" stroke="#000000" points="354.997,-1590.08 348.516,-1598.46 358.809,-1595.95 354.997,-1590.08"/>
</g>
<!-- m_hsparse -->
<g id="proc~~state_init~~UsesGraph_node18" class="node"><title>m_hsparse</title>
<polygon fill="#337ab7" stroke="#337ab7" points="340.5,-1578 274.5,-1578 274.5,-1554 340.5,-1554 340.5,-1578"/>
<text text-anchor="middle" x="307.5" y="-1563.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_hsparse</text>
</g>
<!-- proc~state_init&#45;&gt;m_hsparse -->
<g id="proc~~state_init~~UsesGraph_edge17" class="edge"><title>proc~state_init&#45;&gt;m_hsparse</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.298,-1137.02C424.031,-1198.74 415.425,-1479.55 363,-1545 359.474,-1549.4 354.907,-1552.88 349.918,-1555.63"/>
<polygon fill="#000000" stroke="#000000" points="348.285,-1552.53 340.616,-1559.84 351.17,-1558.91 348.285,-1552.53"/>
</g>
<!-- siesta_dicts -->
<g id="proc~~state_init~~UsesGraph_node19" class="node"><title>siesta_dicts</title>
<polygon fill="#337ab7" stroke="#337ab7" points="341.5,-1536 273.5,-1536 273.5,-1512 341.5,-1512 341.5,-1536"/>
<text text-anchor="middle" x="307.5" y="-1521.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_dicts</text>
</g>
<!-- proc~state_init&#45;&gt;siesta_dicts -->
<g id="proc~~state_init~~UsesGraph_edge18" class="edge"><title>proc~state_init&#45;&gt;siesta_dicts</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.067,-1137.34C422.779,-1195.85 410.357,-1444.85 363,-1503 359.683,-1507.07 355.478,-1510.36 350.879,-1513.01"/>
<polygon fill="#000000" stroke="#000000" points="349.225,-1509.92 341.68,-1517.35 352.216,-1516.24 349.225,-1509.92"/>
</g>
<!-- sparse_matrices -->
<g id="proc~~state_init~~UsesGraph_node20" class="node"><title>sparse_matrices</title>
<polygon fill="#337ab7" stroke="#337ab7" points="353,-1494 262,-1494 262,-1470 353,-1470 353,-1494"/>
<text text-anchor="middle" x="307.5" y="-1479.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sparse_matrices</text>
</g>
<!-- proc~state_init&#45;&gt;sparse_matrices -->
<g id="proc~~state_init~~UsesGraph_edge19" class="edge"><title>proc~state_init&#45;&gt;sparse_matrices</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M424.806,-1137.04C421.471,-1190.97 405.477,-1409.89 363,-1461 362.271,-1461.88 361.501,-1462.72 360.694,-1463.52"/>
<polygon fill="#000000" stroke="#000000" points="358.308,-1460.95 352.596,-1469.87 362.626,-1466.46 358.308,-1460.95"/>
</g>
<!-- m_sparsity_handling -->
<g id="proc~~state_init~~UsesGraph_node21" class="node"><title>m_sparsity_handling</title>
<polygon fill="#337ab7" stroke="#337ab7" points="363,-1452 252,-1452 252,-1428 363,-1428 363,-1452"/>
<text text-anchor="middle" x="307.5" y="-1437.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_sparsity_handling</text>
</g>
<!-- proc~state_init&#45;&gt;m_sparsity_handling -->
<g id="proc~~state_init~~UsesGraph_edge20" class="edge"><title>proc~state_init&#45;&gt;m_sparsity_handling</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M424.444,-1137.18C419.898,-1187.05 400.506,-1375.03 363,-1419 362.149,-1420 361.244,-1420.95 360.294,-1421.85"/>
<polygon fill="#000000" stroke="#000000" points="358.1,-1419.13 352.243,-1427.95 362.327,-1424.71 358.1,-1419.13"/>
</g>
<!-- m_os -->
<g id="proc~~state_init~~UsesGraph_node22" class="node"><title>m_os</title>
<polygon fill="#337ab7" stroke="#337ab7" points="334.5,-1410 280.5,-1410 280.5,-1386 334.5,-1386 334.5,-1410"/>
<text text-anchor="middle" x="307.5" y="-1395.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_os</text>
</g>
<!-- proc~state_init&#45;&gt;m_os -->
<g id="proc~~state_init~~UsesGraph_edge21" class="edge"><title>proc~state_init&#45;&gt;m_os</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M426.149,-1137C427.621,-1176.58 426.976,-1304.51 363,-1377 357.972,-1382.7 351.218,-1386.86 344.179,-1389.89"/>
<polygon fill="#000000" stroke="#000000" points="342.755,-1386.69 334.539,-1393.38 345.133,-1393.27 342.755,-1386.69"/>
</g>
<!-- siesta_options -->
<g id="proc~~state_init~~UsesGraph_node23" class="node"><title>siesta_options</title>
<polygon fill="#337ab7" stroke="#337ab7" points="348,-1368 267,-1368 267,-1344 348,-1344 348,-1368"/>
<text text-anchor="middle" x="307.5" y="-1353.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_options</text>
</g>
<!-- proc~state_init&#45;&gt;siesta_options -->
<g id="proc~~state_init~~UsesGraph_edge22" class="edge"><title>proc~state_init&#45;&gt;siesta_options</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.424,-1137.22C424.544,-1172.61 417.224,-1276.34 363,-1335 361.193,-1336.95 359.184,-1338.73 357.033,-1340.34"/>
<polygon fill="#000000" stroke="#000000" points="354.858,-1337.57 348.16,-1345.78 358.515,-1343.54 354.858,-1337.57"/>
</g>
<!-- alloc -->
<g id="proc~~state_init~~UsesGraph_node24" class="node"><title>alloc</title>
<polygon fill="#337ab7" stroke="#337ab7" points="334.5,-1326 280.5,-1326 280.5,-1302 334.5,-1302 334.5,-1326"/>
<text text-anchor="middle" x="307.5" y="-1311.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">alloc</text>
</g>
<!-- proc~state_init&#45;&gt;alloc -->
<g id="proc~~state_init~~UsesGraph_edge23" class="edge"><title>proc~state_init&#45;&gt;alloc</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M424.335,-1137.39C420.818,-1167.98 407.628,-1247.85 363,-1293 357.756,-1298.31 351.026,-1302.3 344.097,-1305.29"/>
<polygon fill="#000000" stroke="#000000" points="342.811,-1302.03 334.645,-1308.78 345.238,-1308.6 342.811,-1302.03"/>
</g>
<!-- m_pivot_methods -->
<g id="proc~~state_init~~UsesGraph_node25" class="node"><title>m_pivot_methods</title>
<polygon fill="#337ab7" stroke="#337ab7" points="356,-1284 259,-1284 259,-1260 356,-1260 356,-1284"/>
<text text-anchor="middle" x="307.5" y="-1269.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_pivot_methods</text>
</g>
<!-- proc~state_init&#45;&gt;m_pivot_methods -->
<g id="proc~~state_init~~UsesGraph_edge24" class="edge"><title>proc~state_init&#45;&gt;m_pivot_methods</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M422.639,-1137.21C416.218,-1162.03 398.373,-1218.76 363,-1251 361.686,-1252.2 360.297,-1253.33 358.848,-1254.4"/>
<polygon fill="#000000" stroke="#000000" points="356.677,-1251.63 350.02,-1259.87 360.364,-1257.58 356.677,-1251.63"/>
</g>
<!-- m_ts_electype -->
<g id="proc~~state_init~~UsesGraph_node26" class="node"><title>m_ts_electype</title>
<polygon fill="#337ab7" stroke="#337ab7" points="348.5,-1242 266.5,-1242 266.5,-1218 348.5,-1218 348.5,-1242"/>
<text text-anchor="middle" x="307.5" y="-1227.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_electype</text>
</g>
<!-- proc~state_init&#45;&gt;m_ts_electype -->
<g id="proc~~state_init~~UsesGraph_edge25" class="edge"><title>proc~state_init&#45;&gt;m_ts_electype</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M419.297,-1137.28C409.596,-1155.35 389.203,-1189.1 363,-1209 360.986,-1210.53 358.847,-1211.96 356.627,-1213.3"/>
<polygon fill="#000000" stroke="#000000" points="354.952,-1210.22 347.753,-1218 358.228,-1216.41 354.952,-1210.22"/>
</g>
<!-- domain_decom -->
<g id="proc~~state_init~~UsesGraph_node27" class="node"><title>domain_decom</title>
<polygon fill="#337ab7" stroke="#337ab7" points="350.5,-1200 264.5,-1200 264.5,-1176 350.5,-1176 350.5,-1200"/>
<text text-anchor="middle" x="307.5" y="-1185.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">domain_decom</text>
</g>
<!-- proc~state_init&#45;&gt;domain_decom -->
<g id="proc~~state_init~~UsesGraph_edge26" class="edge"><title>proc~state_init&#45;&gt;domain_decom</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M409.668,-1137.09C397.388,-1146.11 379.7,-1158.31 363,-1167 359.703,-1168.72 356.232,-1170.37 352.706,-1171.95"/>
<polygon fill="#000000" stroke="#000000" points="351.163,-1168.8 343.321,-1175.92 353.894,-1175.24 351.163,-1168.8"/>
</g>
<!-- iodm_netcdf -->
<g id="proc~~state_init~~UsesGraph_node28" class="node"><title>iodm_netcdf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="343,-1158 272,-1158 272,-1134 343,-1134 343,-1158"/>
<text text-anchor="middle" x="307.5" y="-1143.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iodm_netcdf</text>
</g>
<!-- proc~state_init&#45;&gt;iodm_netcdf -->
<g id="proc~~state_init~~UsesGraph_edge27" class="edge"><title>proc~state_init&#45;&gt;iodm_netcdf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M398.951,-1129.77C385.456,-1132.19 368.689,-1135.2 353.27,-1137.96"/>
<polygon fill="#000000" stroke="#000000" points="352.605,-1134.53 343.381,-1139.74 353.842,-1141.42 352.605,-1134.53"/>
</g>
<!-- files -->
<g id="proc~~state_init~~UsesGraph_node29" class="node"><title>files</title>
<polygon fill="#337ab7" stroke="#337ab7" points="334.5,-1116 280.5,-1116 280.5,-1092 334.5,-1092 334.5,-1116"/>
<text text-anchor="middle" x="307.5" y="-1101.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">files</text>
</g>
<!-- proc~state_init&#45;&gt;files -->
<g id="proc~~state_init~~UsesGraph_edge28" class="edge"><title>proc~state_init&#45;&gt;files</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M398.951,-1120.23C382.832,-1117.34 362.044,-1113.61 344.463,-1110.45"/>
<polygon fill="#000000" stroke="#000000" points="345.002,-1107 334.541,-1108.67 343.765,-1113.89 345.002,-1107"/>
</g>
<!-- m_ioxv -->
<g id="proc~~state_init~~UsesGraph_node30" class="node"><title>m_ioxv</title>
<polygon fill="#337ab7" stroke="#337ab7" points="334.5,-1074 280.5,-1074 280.5,-1050 334.5,-1050 334.5,-1074"/>
<text text-anchor="middle" x="307.5" y="-1059.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ioxv</text>
</g>
<!-- proc~state_init&#45;&gt;m_ioxv -->
<g id="proc~~state_init~~UsesGraph_edge29" class="edge"><title>proc~state_init&#45;&gt;m_ioxv</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M409.668,-1112.91C397.388,-1103.89 379.7,-1091.69 363,-1083 357.097,-1079.93 350.639,-1077.05 344.298,-1074.47"/>
<polygon fill="#000000" stroke="#000000" points="345.117,-1071.04 334.528,-1070.68 342.582,-1077.56 345.117,-1071.04"/>
</g>
<!-- m_ts_tri_init -->
<g id="proc~~state_init~~UsesGraph_node31" class="node"><title>m_ts_tri_init</title>
<polygon fill="#337ab7" stroke="#337ab7" points="342.5,-1032 272.5,-1032 272.5,-1008 342.5,-1008 342.5,-1032"/>
<text text-anchor="middle" x="307.5" y="-1017.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_tri_init</text>
</g>
<!-- proc~state_init&#45;&gt;m_ts_tri_init -->
<g id="proc~~state_init~~UsesGraph_edge30" class="edge"><title>proc~state_init&#45;&gt;m_ts_tri_init</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M419.297,-1112.72C409.596,-1094.65 389.203,-1060.9 363,-1041 359.593,-1038.41 355.829,-1036.11 351.918,-1034.06"/>
<polygon fill="#000000" stroke="#000000" points="353.169,-1030.79 342.624,-1029.75 350.223,-1037.14 353.169,-1030.79"/>
</g>
<!-- class_dData2D -->
<g id="proc~~state_init~~UsesGraph_node32" class="node"><title>class_dData2D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="350,-990 265,-990 265,-966 350,-966 350,-990"/>
<text text-anchor="middle" x="307.5" y="-975.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_dData2D</text>
</g>
<!-- proc~state_init&#45;&gt;class_dData2D -->
<g id="proc~~state_init~~UsesGraph_edge31" class="edge"><title>proc~state_init&#45;&gt;class_dData2D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M422.639,-1112.79C416.218,-1087.97 398.373,-1031.24 363,-999 361.686,-997.803 360.297,-996.671 358.848,-995.601"/>
<polygon fill="#000000" stroke="#000000" points="360.364,-992.423 350.02,-990.131 356.677,-998.373 360.364,-992.423"/>
</g>
<!-- m_ts_global_vars -->
<g id="proc~~state_init~~UsesGraph_node33" class="node"><title>m_ts_global_vars</title>
<polygon fill="#337ab7" stroke="#337ab7" points="356,-948 259,-948 259,-924 356,-924 356,-948"/>
<text text-anchor="middle" x="307.5" y="-933.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_global_vars</text>
</g>
<!-- proc~state_init&#45;&gt;m_ts_global_vars -->
<g id="proc~~state_init~~UsesGraph_edge33" class="edge"><title>proc~state_init&#45;&gt;m_ts_global_vars</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M424.335,-1112.61C420.818,-1082.02 407.628,-1002.15 363,-957 361.908,-955.896 360.753,-954.848 359.544,-953.855"/>
<polygon fill="#000000" stroke="#000000" points="361.174,-950.734 350.923,-948.055 357.266,-956.541 361.174,-950.734"/>
</g>
<!-- m_sparse -->
<g id="proc~~state_init~~UsesGraph_node34" class="node"><title>m_sparse</title>
<polygon fill="#337ab7" stroke="#337ab7" points="337.5,-906 277.5,-906 277.5,-882 337.5,-882 337.5,-906"/>
<text text-anchor="middle" x="307.5" y="-891.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_sparse</text>
</g>
<!-- proc~state_init&#45;&gt;m_sparse -->
<g id="proc~~state_init~~UsesGraph_edge34" class="edge"><title>proc~state_init&#45;&gt;m_sparse</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.424,-1112.78C424.544,-1077.39 417.224,-973.658 363,-915 358.618,-910.26 353.046,-906.579 347.146,-903.723"/>
<polygon fill="#000000" stroke="#000000" points="348.31,-900.418 337.729,-899.881 345.666,-906.9 348.31,-900.418"/>
</g>
<!-- sys -->
<g id="proc~~state_init~~UsesGraph_node35" class="node"><title>sys</title>
<polygon fill="#337ab7" stroke="#337ab7" points="334.5,-864 280.5,-864 280.5,-840 334.5,-840 334.5,-864"/>
<text text-anchor="middle" x="307.5" y="-849.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sys</text>
</g>
<!-- proc~state_init&#45;&gt;sys -->
<g id="proc~~state_init~~UsesGraph_edge35" class="edge"><title>proc~state_init&#45;&gt;sys</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M426.149,-1113C427.621,-1073.42 426.976,-945.494 363,-873 357.972,-867.303 351.218,-863.141 344.179,-860.105"/>
<polygon fill="#000000" stroke="#000000" points="345.133,-856.729 334.539,-856.623 342.755,-863.312 345.133,-856.729"/>
</g>
<!-- m_steps -->
<g id="proc~~state_init~~UsesGraph_node36" class="node"><title>m_steps</title>
<polygon fill="#337ab7" stroke="#337ab7" points="334.5,-822 280.5,-822 280.5,-798 334.5,-798 334.5,-822"/>
<text text-anchor="middle" x="307.5" y="-807.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_steps</text>
</g>
<!-- proc~state_init&#45;&gt;m_steps -->
<g id="proc~~state_init~~UsesGraph_edge36" class="edge"><title>proc~state_init&#45;&gt;m_steps</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M424.444,-1112.82C419.898,-1062.95 400.506,-874.969 363,-831 358.069,-825.219 351.354,-821.023 344.324,-817.979"/>
<polygon fill="#000000" stroke="#000000" points="345.272,-814.601 334.678,-814.503 342.899,-821.186 345.272,-814.601"/>
</g>
<!-- atomlist -->
<g id="proc~~state_init~~UsesGraph_node37" class="node"><title>atomlist</title>
<polygon fill="#337ab7" stroke="#337ab7" points="334.5,-780 280.5,-780 280.5,-756 334.5,-756 334.5,-780"/>
<text text-anchor="middle" x="307.5" y="-765.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">atomlist</text>
</g>
<!-- proc~state_init&#45;&gt;atomlist -->
<g id="proc~~state_init~~UsesGraph_edge37" class="edge"><title>proc~state_init&#45;&gt;atomlist</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M424.806,-1112.96C421.471,-1059.03 405.477,-840.106 363,-789 358.098,-783.103 351.337,-778.857 344.242,-775.802"/>
<polygon fill="#000000" stroke="#000000" points="345.098,-772.391 334.503,-772.33 342.747,-778.985 345.098,-772.391"/>
</g>
<!-- parallel -->
<g id="proc~~state_init~~UsesGraph_node38" class="node"><title>parallel</title>
<polygon fill="#337ab7" stroke="#337ab7" points="334.5,-738 280.5,-738 280.5,-714 334.5,-714 334.5,-738"/>
<text text-anchor="middle" x="307.5" y="-723.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel</text>
</g>
<!-- proc~state_init&#45;&gt;parallel -->
<g id="proc~~state_init~~UsesGraph_edge38" class="edge"><title>proc~state_init&#45;&gt;parallel</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.067,-1112.66C422.779,-1054.15 410.357,-805.153 363,-747 358.158,-741.054 351.42,-736.788 344.33,-733.729"/>
<polygon fill="#000000" stroke="#000000" points="345.182,-730.317 334.588,-730.261 342.835,-736.912 345.182,-730.317"/>
</g>
<!-- module~m_mixing_scf -->
<g id="proc~~state_init~~UsesGraph_node39" class="node"><title>module~m_mixing_scf</title>
<g id="a_proc~~state_init~~UsesGraph_node39"><a xlink:href=".././module/m_mixing_scf.html" xlink:title="m_mixing_scf">
<polygon fill="#337ab7" stroke="#337ab7" points="346.5,-696 268.5,-696 268.5,-672 346.5,-672 346.5,-696"/>
<text text-anchor="middle" x="307.5" y="-681.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_mixing_scf</text>
</a>
</g>
</g>
<!-- proc~state_init&#45;&gt;module~m_mixing_scf -->
<g id="proc~~state_init~~UsesGraph_edge39" class="edge"><title>proc~state_init&#45;&gt;module~m_mixing_scf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.298,-1112.98C424.031,-1051.26 415.425,-770.448 363,-705 360.777,-702.225 358.141,-699.816 355.246,-697.726"/>
<polygon fill="#000000" stroke="#000000" points="356.933,-694.657 346.532,-692.635 353.402,-700.702 356.933,-694.657"/>
</g>
<!-- Kpoint_grid -->
<g id="proc~~state_init~~UsesGraph_node40" class="node"><title>Kpoint_grid</title>
<polygon fill="#337ab7" stroke="#337ab7" points="341,-654 274,-654 274,-630 341,-630 341,-654"/>
<text text-anchor="middle" x="307.5" y="-639.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Kpoint_grid</text>
</g>
<!-- proc~state_init&#45;&gt;Kpoint_grid -->
<g id="proc~~state_init~~UsesGraph_edge40" class="edge"><title>proc~state_init&#45;&gt;Kpoint_grid</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.476,-1112.66C425.111,-1046.66 420.333,-735.555 363,-663 359.667,-658.782 355.377,-655.411 350.67,-652.716"/>
<polygon fill="#000000" stroke="#000000" points="351.787,-649.375 341.244,-648.323 348.83,-655.72 351.787,-649.375"/>
</g>
<!-- class_dSpData1D -->
<g id="proc~~state_init~~UsesGraph_node41" class="node"><title>class_dSpData1D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="356,-612 259,-612 259,-588 356,-588 356,-612"/>
<text text-anchor="middle" x="307.5" y="-597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_dSpData1D</text>
</g>
<!-- proc~state_init&#45;&gt;class_dSpData1D -->
<g id="proc~~state_init~~UsesGraph_edge41" class="edge"><title>proc~state_init&#45;&gt;class_dSpData1D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.629,-1112.93C426.129,-1044.05 425.423,-700.903 363,-621 362.313,-620.121 361.585,-619.279 360.82,-618.472"/>
<polygon fill="#000000" stroke="#000000" points="363.024,-615.753 353.072,-612.119 358.586,-621.166 363.024,-615.753"/>
</g>
<!-- m_new_dm -->
<g id="proc~~state_init~~UsesGraph_node42" class="node"><title>m_new_dm</title>
<polygon fill="#337ab7" stroke="#337ab7" points="341.5,-570 273.5,-570 273.5,-546 341.5,-546 341.5,-570"/>
<text text-anchor="middle" x="307.5" y="-555.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_new_dm</text>
</g>
<!-- proc~state_init&#45;&gt;m_new_dm -->
<g id="proc~~state_init~~UsesGraph_edge42" class="edge"><title>proc~state_init&#45;&gt;m_new_dm</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.758,-1112.89C427.06,-1040.59 430.434,-666.159 363,-579 359.748,-574.797 355.544,-571.435 350.913,-568.745"/>
<polygon fill="#000000" stroke="#000000" points="352.158,-565.463 341.621,-564.358 349.17,-571.793 352.158,-565.463"/>
</g>
<!-- m_test_io -->
<g id="proc~~state_init~~UsesGraph_node43" class="node"><title>m_test_io</title>
<polygon fill="#337ab7" stroke="#337ab7" points="337,-528 278,-528 278,-504 337,-504 337,-528"/>
<text text-anchor="middle" x="307.5" y="-513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_test_io</text>
</g>
<!-- proc~state_init&#45;&gt;m_test_io -->
<g id="proc~~state_init~~UsesGraph_edge43" class="edge"><title>proc~state_init&#45;&gt;m_test_io</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M424.959,-1112.76C421.315,-1032.61 399.401,-584.443 363,-537 358.77,-531.487 352.899,-527.42 346.569,-524.421"/>
<polygon fill="#000000" stroke="#000000" points="347.692,-521.103 337.104,-520.747 345.159,-527.629 347.692,-521.103"/>
</g>
<!-- m_mpi_utils -->
<g id="proc~~state_init~~UsesGraph_node44" class="node"><title>m_mpi_utils</title>
<polygon fill="#337ab7" stroke="#337ab7" points="342.5,-486 272.5,-486 272.5,-462 342.5,-462 342.5,-486"/>
<text text-anchor="middle" x="307.5" y="-471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_mpi_utils</text>
</g>
<!-- proc~state_init&#45;&gt;m_mpi_utils -->
<g id="proc~~state_init~~UsesGraph_edge44" class="edge"><title>proc~state_init&#45;&gt;m_mpi_utils</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.058,-1112.97C421.916,-1030.16 401.961,-546.15 363,-495 359.972,-491.025 356.09,-487.802 351.796,-485.189"/>
<polygon fill="#000000" stroke="#000000" points="353.059,-481.91 342.541,-480.636 349.969,-488.191 353.059,-481.91"/>
</g>
<!-- m_chess -->
<g id="proc~~state_init~~UsesGraph_node45" class="node"><title>m_chess</title>
<polygon fill="#337ab7" stroke="#337ab7" points="335,-444 280,-444 280,-420 335,-420 335,-444"/>
<text text-anchor="middle" x="307.5" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_chess</text>
</g>
<!-- proc~state_init&#45;&gt;m_chess -->
<g id="proc~~state_init~~UsesGraph_edge45" class="edge"><title>proc~state_init&#45;&gt;m_chess</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.129,-1112.74C422.406,-1026.06 404.454,-507.772 363,-453 358.414,-446.941 351.843,-442.63 344.842,-439.562"/>
<polygon fill="#000000" stroke="#000000" points="345.769,-436.177 335.175,-436.103 343.411,-442.768 345.769,-436.177"/>
</g>
<!-- zmatrix -->
<g id="proc~~state_init~~UsesGraph_node46" class="node"><title>zmatrix</title>
<polygon fill="#337ab7" stroke="#337ab7" points="334.5,-402 280.5,-402 280.5,-378 334.5,-378 334.5,-402"/>
<text text-anchor="middle" x="307.5" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">zmatrix</text>
</g>
<!-- proc~state_init&#45;&gt;zmatrix -->
<g id="proc~~state_init~~UsesGraph_edge46" class="edge"><title>proc~state_init&#45;&gt;zmatrix</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.202,-1112.84C422.913,-1023.42 407.006,-469.472 363,-411 358.347,-404.817 351.625,-400.455 344.481,-397.376"/>
<polygon fill="#000000" stroke="#000000" points="345.228,-393.929 334.633,-393.924 342.912,-400.535 345.228,-393.929"/>
</g>
<!-- class_Sparsity -->
<g id="proc~~state_init~~UsesGraph_node47" class="node"><title>class_Sparsity</title>
<polygon fill="#337ab7" stroke="#337ab7" points="348,-360 267,-360 267,-336 348,-336 348,-360"/>
<text text-anchor="middle" x="307.5" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_Sparsity</text>
</g>
<!-- proc~state_init&#45;&gt;class_Sparsity -->
<g id="proc~~state_init~~UsesGraph_edge47" class="edge"><title>proc~state_init&#45;&gt;class_Sparsity</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.262,-1112.72C423.364,-1019.96 409.525,-431.131 363,-369 361.205,-366.603 359.099,-364.48 356.778,-362.599"/>
<polygon fill="#000000" stroke="#000000" points="358.5,-359.546 348.194,-357.092 354.72,-365.437 358.5,-359.546"/>
</g>
<!-- m_gamma -->
<g id="proc~~state_init~~UsesGraph_node48" class="node"><title>m_gamma</title>
<polygon fill="#337ab7" stroke="#337ab7" points="339.5,-318 275.5,-318 275.5,-294 339.5,-294 339.5,-318"/>
<text text-anchor="middle" x="307.5" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_gamma</text>
</g>
<!-- proc~state_init&#45;&gt;m_gamma -->
<g id="proc~~state_init~~UsesGraph_edge48" class="edge"><title>proc~state_init&#45;&gt;m_gamma</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.322,-1112.96C423.822,-1018.1 412.106,-392.874 363,-327 359.351,-322.104 354.402,-318.35 348.968,-315.471"/>
<polygon fill="#000000" stroke="#000000" points="350.078,-312.138 339.508,-311.405 347.313,-318.569 350.078,-312.138"/>
</g>
<!-- m_overlap -->
<g id="proc~~state_init~~UsesGraph_node49" class="node"><title>m_overlap</title>
<polygon fill="#337ab7" stroke="#337ab7" points="339,-276 276,-276 276,-252 339,-252 339,-276"/>
<text text-anchor="middle" x="307.5" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_overlap</text>
</g>
<!-- proc~state_init&#45;&gt;m_overlap -->
<g id="proc~~state_init~~UsesGraph_edge49" class="edge"><title>proc~state_init&#45;&gt;m_overlap</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.372,-1112.96C424.234,-1015.27 414.649,-354.568 363,-285 359.321,-280.045 354.312,-276.259 348.812,-273.367"/>
<polygon fill="#000000" stroke="#000000" points="349.813,-269.989 339.241,-269.293 347.072,-276.43 349.813,-269.989"/>
</g>
<!-- m_proximity_check -->
<g id="proc~~state_init~~UsesGraph_node50" class="node"><title>m_proximity_check</title>
<polygon fill="#337ab7" stroke="#337ab7" points="359.5,-234 255.5,-234 255.5,-210 359.5,-210 359.5,-234"/>
<text text-anchor="middle" x="307.5" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_proximity_check</text>
</g>
<!-- proc~state_init&#45;&gt;m_proximity_check -->
<g id="proc~~state_init~~UsesGraph_edge32" class="edge"><title>proc~state_init&#45;&gt;m_proximity_check</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.417,-1113C424.627,-1012.72 417.203,-316.277 363,-243 362.433,-242.233 361.834,-241.494 361.206,-240.783"/>
<polygon fill="#000000" stroke="#000000" points="363.374,-238.03 353.519,-234.142 358.798,-243.327 363.374,-238.03"/>
</g>
<!-- siesta_geom -->
<g id="proc~~state_init~~UsesGraph_node51" class="node"><title>siesta_geom</title>
<polygon fill="#337ab7" stroke="#337ab7" points="344,-192 271,-192 271,-168 344,-168 344,-192"/>
<text text-anchor="middle" x="307.5" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_geom</text>
</g>
<!-- proc~state_init&#45;&gt;siesta_geom -->
<g id="proc~~state_init~~UsesGraph_edge50" class="edge"><title>proc~state_init&#45;&gt;siesta_geom</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.457,-1112.75C424.992,-1008.92 419.708,-277.922 363,-201 360.287,-197.32 356.838,-194.284 352.998,-191.781"/>
<polygon fill="#000000" stroke="#000000" points="354.578,-188.657 344.098,-187.106 351.323,-194.855 354.578,-188.657"/>
</g>
<!-- m_spin -->
<g id="proc~~state_init~~UsesGraph_node52" class="node"><title>m_spin</title>
<polygon fill="#337ab7" stroke="#337ab7" points="334.5,-150 280.5,-150 280.5,-126 334.5,-126 334.5,-150"/>
<text text-anchor="middle" x="307.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_spin</text>
</g>
<!-- proc~state_init&#45;&gt;m_spin -->
<g id="proc~~state_init~~UsesGraph_edge51" class="edge"><title>proc~state_init&#45;&gt;m_spin</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.495,-1112.88C425.354,-1006.87 422.281,-239.658 363,-159 358.417,-152.765 351.724,-148.381 344.585,-145.299"/>
<polygon fill="#000000" stroke="#000000" points="345.326,-141.85 334.732,-141.851 343.014,-148.457 345.326,-141.85"/>
</g>
<!-- create_Sparsity_SC -->
<g id="proc~~state_init~~UsesGraph_node53" class="node"><title>create_Sparsity_SC</title>
<polygon fill="#337ab7" stroke="#337ab7" points="361,-108 254,-108 254,-84 361,-84 361,-108"/>
<text text-anchor="middle" x="307.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">create_Sparsity_SC</text>
</g>
<!-- proc~state_init&#45;&gt;create_Sparsity_SC -->
<g id="proc~~state_init~~UsesGraph_edge52" class="edge"><title>proc~state_init&#45;&gt;create_Sparsity_SC</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.53,-1112.69C425.696,-1003.43 424.8,-201.322 363,-117 362.436,-116.231 361.84,-115.49 361.215,-114.776"/>
<polygon fill="#000000" stroke="#000000" points="363.395,-112.033 353.551,-108.118 358.805,-117.318 363.395,-112.033"/>
</g>
<!-- m_ts_io -->
<g id="proc~~state_init~~UsesGraph_node54" class="node"><title>m_ts_io</title>
<polygon fill="#337ab7" stroke="#337ab7" points="334.5,-66 280.5,-66 280.5,-42 334.5,-42 334.5,-66"/>
<text text-anchor="middle" x="307.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_io</text>
</g>
<!-- proc~state_init&#45;&gt;m_ts_io -->
<g id="proc~~state_init~~UsesGraph_edge53" class="edge"><title>proc~state_init&#45;&gt;m_ts_io</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.562,-1112.89C426.027,-1001.88 427.391,-163.086 363,-75 358.433,-68.7531 351.747,-64.3644 344.609,-61.2813"/>
<polygon fill="#000000" stroke="#000000" points="345.349,-57.8321 334.754,-57.8343 343.038,-64.4396 345.349,-57.8321"/>
</g>
<!-- m_iotdxv -->
<g id="proc~~state_init~~UsesGraph_node55" class="node"><title>m_iotdxv</title>
<polygon fill="#337ab7" stroke="#337ab7" points="335,-24 280,-24 280,-0 335,-0 335,-24"/>
<text text-anchor="middle" x="307.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_iotdxv</text>
</g>
<!-- proc~state_init&#45;&gt;m_iotdxv -->
<g id="proc~~state_init~~UsesGraph_edge54" class="edge"><title>proc~state_init&#45;&gt;m_iotdxv</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.592,-1112.77C426.346,-998.785 429.923,-124.77 363,-33 358.482,-26.8042 351.877,-22.4364 344.813,-19.3573"/>
<polygon fill="#000000" stroke="#000000" points="345.642,-15.9384 335.047,-15.9065 343.31,-22.5384 345.642,-15.9384"/>
</g>
<!-- class_dData1D -->
<g id="proc~~state_init~~UsesGraph_node56" class="node"><title>class_dData1D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="103.5,-780 18.5,-780 18.5,-756 103.5,-756 103.5,-780"/>
<text text-anchor="middle" x="61" y="-765.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_dData1D</text>
</g>
<!-- module~m_mixing&#45;&gt;class_dData1D -->
<g id="proc~~state_init~~UsesGraph_edge55" class="edge"><title>module~m_mixing&#45;&gt;class_dData1D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M157.862,-735.53C142.929,-740.588 124.216,-746.927 107.296,-752.658"/>
<polygon fill="#000000" stroke="#000000" points="105.931,-749.425 97.5827,-755.948 108.177,-756.055 105.931,-749.425"/>
</g>
<!-- class_Fstack_dData1D -->
<g id="proc~~state_init~~UsesGraph_node57" class="node"><title>class_Fstack_dData1D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="122,-696 -7.10543e-15,-696 -7.10543e-15,-672 122,-672 122,-696"/>
<text text-anchor="middle" x="61" y="-681.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_Fstack_dData1D</text>
</g>
<!-- module~m_mixing&#45;&gt;class_Fstack_dData1D -->
<g id="proc~~state_init~~UsesGraph_edge56" class="edge"><title>module~m_mixing&#45;&gt;class_Fstack_dData1D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M157.862,-716.47C142.929,-711.412 124.216,-705.073 107.296,-699.342"/>
<polygon fill="#000000" stroke="#000000" points="108.177,-695.945 97.5827,-696.052 105.931,-702.575 108.177,-695.945"/>
</g>
<!-- precision -->
<g id="proc~~state_init~~UsesGraph_node58" class="node"><title>precision</title>
<polygon fill="#337ab7" stroke="#337ab7" points="88.5,-738 33.5,-738 33.5,-714 88.5,-714 88.5,-738"/>
<text text-anchor="middle" x="61" y="-723.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">precision</text>
</g>
<!-- module~m_mixing&#45;&gt;precision -->
<g id="proc~~state_init~~UsesGraph_edge57" class="edge"><title>module~m_mixing&#45;&gt;precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M157.862,-726C140.378,-726 117.711,-726 98.8085,-726"/>
<polygon fill="#000000" stroke="#000000" points="98.7511,-722.5 88.7511,-726 98.7511,-729.5 98.7511,-722.5"/>
</g>
<!-- module~m_mixing_scf&#45;&gt;module~m_mixing -->
<g id="proc~~state_init~~UsesGraph_edge59" class="edge"><title>module~m_mixing_scf&#45;&gt;module~m_mixing</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M272.543,-696.036C257.956,-701.205 240.852,-707.268 225.858,-712.582"/>
<polygon fill="#000000" stroke="#000000" points="224.614,-709.309 216.358,-715.949 226.953,-715.907 224.614,-709.309"/>
</g>
<!-- module~m_mixing_scf&#45;&gt;class_Fstack_dData1D -->
<g id="proc~~state_init~~UsesGraph_edge58" class="edge"><title>module~m_mixing_scf&#45;&gt;class_Fstack_dData1D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M268.297,-684C232.038,-684 176.66,-684 132.406,-684"/>
<polygon fill="#000000" stroke="#000000" points="132.281,-680.5 122.281,-684 132.281,-687.5 132.281,-680.5"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="490pt" height="32pt"
 viewBox="0.00 0.00 489.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 485.5,-28 485.5,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node"><title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node"><title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="139.5,-24 72.5,-24 72.5,-0 139.5,-0 139.5,-24"/>
<text text-anchor="middle" x="106" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="222,-24 158,-24 158,-0 222,-0 222,-24"/>
<text text-anchor="middle" x="190" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="294,-24 240,-24 240,-0 294,-0 294,-24"/>
<text text-anchor="middle" x="267" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="366,-24 312,-24 312,-0 366,-0 366,-24"/>
<text text-anchor="middle" x="339" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="481.5,-24 384.5,-24 384.5,-0 481.5,-0 481.5,-24"/>
<text text-anchor="middle" x="433" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses.
    </p>
    </div></div></div></div>
      </li>
      
      </ul>
    </div>
    


    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-istep%7E2"></span>integer</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>istep</strong></td><td></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
	<h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
	<div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~state_init~~CallsGraph Pages: 1 -->
<svg id="procstate_initCallsGraph" width="322pt" height="2254pt"
 viewBox="0.00 0.00 322.00 2254.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~state_init~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 2250)">
<title>proc~~state_init~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-2250 318,-2250 318,4 -4,4"/>
<!-- proc~state_init -->
<g id="proc~~state_init~~CallsGraph_node1" class="node"><title>proc~state_init</title>
<polygon fill="none" stroke="black" points="55,-1137 0,-1137 0,-1113 55,-1113 55,-1137"/>
<text text-anchor="middle" x="27.5" y="-1122.6" font-family="Helvetica,sans-Serif" font-size="10.50">state_init</text>
</g>
<!-- nscold -->
<g id="proc~~state_init~~CallsGraph_node2" class="node"><title>nscold</title>
<polygon fill="#777777" stroke="#777777" points="181,-2246 127,-2246 127,-2222 181,-2222 181,-2246"/>
<text text-anchor="middle" x="154" y="-2231.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nscold</text>
</g>
<!-- proc~state_init&#45;&gt;nscold -->
<g id="proc~~state_init~~CallsGraph_edge1" class="edge"><title>proc~state_init&#45;&gt;nscold</title>
<path fill="none" stroke="#000000" d="M28.3872,-1137.21C27.4397,-1250.94 22.4419,-2122.97 91,-2213 97.2997,-2221.27 107.017,-2226.32 116.903,-2229.38"/>
<polygon fill="#000000" stroke="#000000" points="116.176,-2232.8 126.726,-2231.83 117.871,-2226.01 116.176,-2232.8"/>
</g>
<!-- xij_offset -->
<g id="proc~~state_init~~CallsGraph_node3" class="node"><title>xij_offset</title>
<polygon fill="#777777" stroke="#777777" points="181.5,-2204 126.5,-2204 126.5,-2180 181.5,-2180 181.5,-2204"/>
<text text-anchor="middle" x="154" y="-2189.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xij_offset</text>
</g>
<!-- proc~state_init&#45;&gt;xij_offset -->
<g id="proc~~state_init~~CallsGraph_edge2" class="edge"><title>proc~state_init&#45;&gt;xij_offset</title>
<path fill="none" stroke="#000000" d="M28.4177,-1137.08C27.7661,-1247.83 25.0491,-2084.6 91,-2171 97.2575,-2179.2 106.87,-2184.22 116.672,-2187.29"/>
<polygon fill="#000000" stroke="#000000" points="115.867,-2190.7 126.42,-2189.76 117.583,-2183.91 115.867,-2190.7"/>
</g>
<!-- new_dm -->
<g id="proc~~state_init~~CallsGraph_node4" class="node"><title>new_dm</title>
<polygon fill="#777777" stroke="#777777" points="181,-2162 127,-2162 127,-2138 181,-2138 181,-2162"/>
<text text-anchor="middle" x="154" y="-2147.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">new_dm</text>
</g>
<!-- proc~state_init&#45;&gt;new_dm -->
<g id="proc~~state_init~~CallsGraph_edge3" class="edge"><title>proc~state_init&#45;&gt;new_dm</title>
<path fill="none" stroke="#000000" d="M28.4491,-1137.27C28.1009,-1246.27 27.7171,-2046.3 91,-2129 97.3195,-2137.26 107.042,-2142.3 116.928,-2145.36"/>
<polygon fill="#000000" stroke="#000000" points="116.198,-2148.78 126.748,-2147.81 117.894,-2141.99 116.198,-2148.78"/>
</g>
<!-- volcel -->
<g id="proc~~state_init~~CallsGraph_node5" class="node"><title>volcel</title>
<polygon fill="#777777" stroke="#777777" points="181,-2120 127,-2120 127,-2096 181,-2096 181,-2120"/>
<text text-anchor="middle" x="154" y="-2105.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">volcel</text>
</g>
<!-- proc~state_init&#45;&gt;volcel -->
<g id="proc~~state_init~~CallsGraph_edge5" class="edge"><title>proc~state_init&#45;&gt;volcel</title>
<path fill="none" stroke="#000000" d="M28.4844,-1137.09C28.4506,-1242.81 30.3104,-2007.92 91,-2087 97.3306,-2095.25 107.056,-2100.28 116.942,-2103.35"/>
<polygon fill="#000000" stroke="#000000" points="116.21,-2106.77 126.76,-2105.8 117.907,-2099.98 116.21,-2106.77"/>
</g>
<!-- file_exist -->
<g id="proc~~state_init~~CallsGraph_node6" class="node"><title>file_exist</title>
<polygon fill="#777777" stroke="#777777" points="181,-2078 127,-2078 127,-2054 181,-2054 181,-2078"/>
<text text-anchor="middle" x="154" y="-2063.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">file_exist</text>
</g>
<!-- proc~state_init&#45;&gt;file_exist -->
<g id="proc~~state_init~~CallsGraph_edge6" class="edge"><title>proc~state_init&#45;&gt;file_exist</title>
<path fill="none" stroke="#000000" d="M28.5227,-1137.21C28.8181,-1240.75 32.9591,-1969.6 91,-2045 97.3428,-2053.24 107.072,-2058.27 116.957,-2061.34"/>
<polygon fill="#000000" stroke="#000000" points="116.223,-2064.76 126.773,-2063.79 117.921,-2057.97 116.223,-2064.76"/>
</g>
<!-- ts_write_tshs -->
<g id="proc~~state_init~~CallsGraph_node7" class="node"><title>ts_write_tshs</title>
<polygon fill="#777777" stroke="#777777" points="191.5,-2036 116.5,-2036 116.5,-2012 191.5,-2012 191.5,-2036"/>
<text text-anchor="middle" x="154" y="-2021.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ts_write_tshs</text>
</g>
<!-- proc~state_init&#45;&gt;ts_write_tshs -->
<g id="proc~~state_init~~CallsGraph_edge7" class="edge"><title>proc~state_init&#45;&gt;ts_write_tshs</title>
<path fill="none" stroke="#000000" d="M28.5651,-1137.29C29.2043,-1238.4 35.5968,-1931.26 91,-2003 95.2005,-2008.44 100.876,-2012.48 107.095,-2015.48"/>
<polygon fill="#000000" stroke="#000000" points="105.9,-2018.77 116.487,-2019.17 108.461,-2012.26 105.9,-2018.77"/>
</g>
<!-- setup_dm_netcdf_file -->
<g id="proc~~state_init~~CallsGraph_node8" class="node"><title>setup_dm_netcdf_file</title>
<polygon fill="#777777" stroke="#777777" points="211.5,-1994 96.5,-1994 96.5,-1970 211.5,-1970 211.5,-1994"/>
<text text-anchor="middle" x="154" y="-1979.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_dm_netcdf_file</text>
</g>
<!-- proc~state_init&#45;&gt;setup_dm_netcdf_file -->
<g id="proc~~state_init~~CallsGraph_edge8" class="edge"><title>proc~state_init&#45;&gt;setup_dm_netcdf_file</title>
<path fill="none" stroke="#000000" d="M28.6087,-1137.01C29.5908,-1234.37 38.1676,-1892.84 91,-1961 91.594,-1961.77 92.2173,-1962.5 92.8672,-1963.22"/>
<polygon fill="#000000" stroke="#000000" points="90.8351,-1966.08 100.732,-1969.86 95.3541,-1960.74 90.8351,-1966.08"/>
</g>
<!-- fname_tshs -->
<g id="proc~~state_init~~CallsGraph_node9" class="node"><title>fname_tshs</title>
<polygon fill="#777777" stroke="#777777" points="188,-1952 120,-1952 120,-1928 188,-1928 188,-1952"/>
<text text-anchor="middle" x="154" y="-1937.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fname_tshs</text>
</g>
<!-- proc~state_init&#45;&gt;fname_tshs -->
<g id="proc~~state_init~~CallsGraph_edge9" class="edge"><title>proc~state_init&#45;&gt;fname_tshs</title>
<path fill="none" stroke="#000000" d="M28.6629,-1137.3C30.0318,-1232.84 40.8388,-1854.55 91,-1919 95.908,-1925.31 102.797,-1929.73 110.209,-1932.84"/>
<polygon fill="#000000" stroke="#000000" points="109.172,-1936.18 119.766,-1936.1 111.435,-1929.56 109.172,-1936.18"/>
</g>
<!-- setup_dmhs_netcdf_file -->
<g id="proc~~state_init~~CallsGraph_node10" class="node"><title>setup_dmhs_netcdf_file</title>
<polygon fill="#777777" stroke="#777777" points="217,-1910 91,-1910 91,-1886 217,-1886 217,-1910"/>
<text text-anchor="middle" x="154" y="-1895.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_dmhs_netcdf_file</text>
</g>
<!-- proc~state_init&#45;&gt;setup_dmhs_netcdf_file -->
<g id="proc~~state_init~~CallsGraph_edge10" class="edge"><title>proc~state_init&#45;&gt;setup_dmhs_netcdf_file</title>
<path fill="none" stroke="#000000" d="M28.7186,-1137.23C30.473,-1229.64 43.443,-1816.17 91,-1877 91.5972,-1877.76 92.2234,-1878.5 92.8761,-1879.21"/>
<polygon fill="#000000" stroke="#000000" points="90.8562,-1882.08 100.763,-1885.84 95.3608,-1876.73 90.8562,-1882.08"/>
</g>
<!-- proximity_check -->
<g id="proc~~state_init~~CallsGraph_node11" class="node"><title>proximity_check</title>
<polygon fill="#777777" stroke="#777777" points="198.5,-1868 109.5,-1868 109.5,-1844 198.5,-1844 198.5,-1868"/>
<text text-anchor="middle" x="154" y="-1853.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">proximity_check</text>
</g>
<!-- proc~state_init&#45;&gt;proximity_check -->
<g id="proc~~state_init~~CallsGraph_edge53" class="edge"><title>proc~state_init&#45;&gt;proximity_check</title>
<path fill="none" stroke="#000000" d="M28.7791,-1137.11C30.9321,-1226.16 46.0359,-1777.78 91,-1835 93.6463,-1838.37 96.8571,-1841.2 100.409,-1843.58"/>
<polygon fill="#000000" stroke="#000000" points="98.7511,-1846.66 109.21,-1848.35 102.088,-1840.51 98.7511,-1846.66"/>
</g>
<!-- hsparse -->
<g id="proc~~state_init~~CallsGraph_node12" class="node"><title>hsparse</title>
<polygon fill="#777777" stroke="#777777" points="181,-1826 127,-1826 127,-1802 181,-1802 181,-1826"/>
<text text-anchor="middle" x="154" y="-1811.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hsparse</text>
</g>
<!-- proc~state_init&#45;&gt;hsparse -->
<g id="proc~~state_init~~CallsGraph_edge11" class="edge"><title>proc~state_init&#45;&gt;hsparse</title>
<path fill="none" stroke="#000000" d="M28.8526,-1137.21C31.4458,-1223.49 48.6623,-1739.42 91,-1793 97.4472,-1801.16 107.206,-1806.17 117.086,-1809.24"/>
<polygon fill="#000000" stroke="#000000" points="116.336,-1812.66 126.888,-1811.7 118.044,-1805.87 116.336,-1812.66"/>
</g>
<!-- newddata2d -->
<g id="proc~~state_init~~CallsGraph_node13" class="node"><title>newddata2d</title>
<polygon fill="#777777" stroke="#777777" points="189.5,-1784 118.5,-1784 118.5,-1760 189.5,-1760 189.5,-1784"/>
<text text-anchor="middle" x="154" y="-1769.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">newddata2d</text>
</g>
<!-- proc~state_init&#45;&gt;newddata2d -->
<g id="proc~~state_init~~CallsGraph_edge12" class="edge"><title>proc~state_init&#45;&gt;newddata2d</title>
<path fill="none" stroke="#000000" d="M28.934,-1137.23C31.9863,-1220.4 51.2719,-1701.05 91,-1751 95.6201,-1756.81 101.918,-1761.02 108.738,-1764.07"/>
<polygon fill="#000000" stroke="#000000" points="107.657,-1767.4 118.251,-1767.56 110.064,-1760.83 107.657,-1767.4"/>
</g>
<!-- crtsparsity_sc -->
<g id="proc~~state_init~~CallsGraph_node14" class="node"><title>crtsparsity_sc</title>
<polygon fill="#777777" stroke="#777777" points="193,-1742 115,-1742 115,-1718 193,-1718 193,-1742"/>
<text text-anchor="middle" x="154" y="-1727.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">crtsparsity_sc</text>
</g>
<!-- proc~state_init&#45;&gt;crtsparsity_sc -->
<g id="proc~~state_init~~CallsGraph_edge13" class="edge"><title>proc~state_init&#45;&gt;crtsparsity_sc</title>
<path fill="none" stroke="#000000" d="M29.0236,-1137.17C32.5531,-1216.89 53.8642,-1662.64 91,-1709 94.8236,-1713.77 99.7792,-1717.47 105.222,-1720.33"/>
<polygon fill="#000000" stroke="#000000" points="104.157,-1723.68 114.728,-1724.39 106.909,-1717.24 104.157,-1723.68"/>
</g>
<!-- newdspdata1d -->
<g id="proc~~state_init~~CallsGraph_node15" class="node"><title>newdspdata1d</title>
<polygon fill="#777777" stroke="#777777" points="195,-1700 113,-1700 113,-1676 195,-1676 195,-1700"/>
<text text-anchor="middle" x="154" y="-1685.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">newdspdata1d</text>
</g>
<!-- proc~state_init&#45;&gt;newdspdata1d -->
<g id="proc~~state_init~~CallsGraph_edge14" class="edge"><title>proc~state_init&#45;&gt;newdspdata1d</title>
<path fill="none" stroke="#000000" d="M28.2048,-1137.06C26.6833,-1209.07 22.2501,-1581.9 91,-1667 94.4815,-1671.31 98.8855,-1674.74 103.734,-1677.47"/>
<polygon fill="#000000" stroke="#000000" points="102.292,-1680.66 112.839,-1681.66 105.22,-1674.3 102.292,-1680.66"/>
</g>
<!-- newdspdata2d -->
<g id="proc~~state_init~~CallsGraph_node16" class="node"><title>newdspdata2d</title>
<polygon fill="#777777" stroke="#777777" points="195,-1658 113,-1658 113,-1634 195,-1634 195,-1658"/>
<text text-anchor="middle" x="154" y="-1643.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">newdspdata2d</text>
</g>
<!-- proc~state_init&#45;&gt;newdspdata2d -->
<g id="proc~~state_init~~CallsGraph_edge15" class="edge"><title>proc~state_init&#45;&gt;newdspdata2d</title>
<path fill="none" stroke="#000000" d="M28.3352,-1137.01C27.6333,-1205.57 27.4068,-1547.05 91,-1625 94.5021,-1629.29 98.9187,-1632.71 103.775,-1635.44"/>
<polygon fill="#000000" stroke="#000000" points="102.339,-1638.63 112.887,-1639.62 105.262,-1632.27 102.339,-1638.63"/>
</g>
<!-- normalize_dm -->
<g id="proc~~state_init~~CallsGraph_node17" class="node"><title>normalize_dm</title>
<polygon fill="#777777" stroke="#777777" points="194,-1616 114,-1616 114,-1592 194,-1592 194,-1616"/>
<text text-anchor="middle" x="154" y="-1601.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">normalize_dm</text>
</g>
<!-- proc~state_init&#45;&gt;normalize_dm -->
<g id="proc~~state_init~~CallsGraph_edge16" class="edge"><title>proc~state_init&#45;&gt;normalize_dm</title>
<path fill="none" stroke="#000000" d="M28.4885,-1137.27C28.669,-1202.92 32.6437,-1512.28 91,-1583 94.6618,-1587.44 99.3,-1590.94 104.385,-1593.71"/>
<polygon fill="#000000" stroke="#000000" points="103.347,-1597.07 113.907,-1597.93 106.185,-1590.68 103.347,-1597.07"/>
</g>
<!-- listhptr -->
<g id="proc~~state_init~~CallsGraph_node18" class="node"><title>listhptr</title>
<polygon fill="#777777" stroke="#777777" points="181,-1574 127,-1574 127,-1550 181,-1550 181,-1574"/>
<text text-anchor="middle" x="154" y="-1559.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">listhptr</text>
</g>
<!-- proc~state_init&#45;&gt;listhptr -->
<g id="proc~~state_init~~CallsGraph_edge17" class="edge"><title>proc~state_init&#45;&gt;listhptr</title>
<path fill="none" stroke="#000000" d="M28.6767,-1137.36C29.8074,-1199.51 37.8108,-1477.42 91,-1541 97.6177,-1548.91 107.335,-1553.85 117.122,-1556.93"/>
<polygon fill="#000000" stroke="#000000" points="116.263,-1560.33 126.821,-1559.44 118.014,-1553.55 116.263,-1560.33"/>
</g>
<!-- timer -->
<g id="proc~~state_init~~CallsGraph_node19" class="node"><title>timer</title>
<polygon fill="#777777" stroke="#777777" points="181,-1532 127,-1532 127,-1508 181,-1508 181,-1532"/>
<text text-anchor="middle" x="154" y="-1517.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">timer</text>
</g>
<!-- proc~state_init&#45;&gt;timer -->
<g id="proc~~state_init~~CallsGraph_edge18" class="edge"><title>proc~state_init&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M28.9021,-1137.25C31.0455,-1195.34 42.9058,-1442.46 91,-1499 97.6826,-1506.86 107.419,-1511.78 117.203,-1514.87"/>
<polygon fill="#000000" stroke="#000000" points="116.335,-1518.26 126.893,-1517.38 118.091,-1511.48 116.335,-1518.26"/>
</g>
<!-- setup_ordern_indexes -->
<g id="proc~~state_init~~CallsGraph_node20" class="node"><title>setup_ordern_indexes</title>
<polygon fill="#777777" stroke="#777777" points="213.5,-1490 94.5,-1490 94.5,-1466 213.5,-1466 213.5,-1490"/>
<text text-anchor="middle" x="154" y="-1475.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_ordern_indexes</text>
</g>
<!-- proc~state_init&#45;&gt;setup_ordern_indexes -->
<g id="proc~~state_init~~CallsGraph_edge19" class="edge"><title>proc~state_init&#45;&gt;setup_ordern_indexes</title>
<path fill="none" stroke="#000000" d="M29.1881,-1137.3C32.4494,-1191.38 48.0218,-1407.52 91,-1457 91.8593,-1457.99 92.767,-1458.93 93.717,-1459.83"/>
<polygon fill="#000000" stroke="#000000" points="91.6393,-1462.65 101.727,-1465.89 95.8612,-1457.06 91.6393,-1462.65"/>
</g>
<!-- setup_kpoint_grid -->
<g id="proc~~state_init~~CallsGraph_node21" class="node"><title>setup_kpoint_grid</title>
<polygon fill="#777777" stroke="#777777" points="202.5,-1448 105.5,-1448 105.5,-1424 202.5,-1424 202.5,-1448"/>
<text text-anchor="middle" x="154" y="-1433.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_kpoint_grid</text>
</g>
<!-- proc~state_init&#45;&gt;setup_kpoint_grid -->
<g id="proc~~state_init~~CallsGraph_edge20" class="edge"><title>proc~state_init&#45;&gt;setup_kpoint_grid</title>
<path fill="none" stroke="#000000" d="M29.5309,-1137.06C33.9783,-1186.42 53.0366,-1372.43 91,-1415 92.7539,-1416.97 94.6986,-1418.75 96.7854,-1420.37"/>
<polygon fill="#000000" stroke="#000000" points="95.1063,-1423.44 105.434,-1425.81 98.8345,-1417.52 95.1063,-1423.44"/>
</g>
<!-- setup_ts_kpoint_grid -->
<g id="proc~~state_init~~CallsGraph_node22" class="node"><title>setup_ts_kpoint_grid</title>
<polygon fill="#777777" stroke="#777777" points="210,-1406 98,-1406 98,-1382 210,-1382 210,-1406"/>
<text text-anchor="middle" x="154" y="-1391.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_ts_kpoint_grid</text>
</g>
<!-- proc~state_init&#45;&gt;setup_ts_kpoint_grid -->
<g id="proc~~state_init~~CallsGraph_edge21" class="edge"><title>proc~state_init&#45;&gt;setup_ts_kpoint_grid</title>
<path fill="none" stroke="#000000" d="M30.0121,-1137.11C35.8287,-1181.89 58.0929,-1337.36 91,-1373 91.9107,-1373.99 92.8693,-1374.93 93.8696,-1375.82"/>
<polygon fill="#000000" stroke="#000000" points="92.0883,-1378.85 102.247,-1381.86 96.1822,-1373.17 92.0883,-1378.85"/>
</g>
<!-- nsc -->
<g id="proc~~state_init~~CallsGraph_node23" class="node"><title>nsc</title>
<polygon fill="#777777" stroke="#777777" points="181,-1364 127,-1364 127,-1340 181,-1340 181,-1364"/>
<text text-anchor="middle" x="154" y="-1349.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nsc</text>
</g>
<!-- proc~state_init&#45;&gt;nsc -->
<g id="proc~~state_init~~CallsGraph_edge22" class="edge"><title>proc~state_init&#45;&gt;nsc</title>
<path fill="none" stroke="#000000" d="M28.8525,-1137.12C30.4823,-1171.27 39.636,-1269.47 91,-1326 98.0057,-1333.71 107.662,-1339.2 117.27,-1343.09"/>
<polygon fill="#000000" stroke="#000000" points="116.167,-1346.41 126.761,-1346.46 118.511,-1339.82 116.167,-1346.41"/>
</g>
<!-- delete -->
<g id="proc~~state_init~~CallsGraph_node24" class="node"><title>delete</title>
<polygon fill="#777777" stroke="#777777" points="310.5,-905 256.5,-905 256.5,-881 310.5,-881 310.5,-905"/>
<text text-anchor="middle" x="283.5" y="-890.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">delete</text>
</g>
<!-- proc~state_init&#45;&gt;delete -->
<g id="proc~~state_init~~CallsGraph_edge23" class="edge"><title>proc~state_init&#45;&gt;delete</title>
<path fill="none" stroke="#000000" d="M28.6787,-1137.07C29.8858,-1169.08 38.1014,-1256.24 91,-1293 136.986,-1324.96 174.322,-1329.26 217,-1293 275.015,-1243.71 281.753,-992.022 282.448,-915.257"/>
<polygon fill="#000000" stroke="#000000" points="285.948,-915.268 282.512,-905.245 278.948,-915.223 285.948,-915.268"/>
</g>
<!-- domaindecom -->
<g id="proc~~state_init~~CallsGraph_node25" class="node"><title>domaindecom</title>
<polygon fill="#777777" stroke="#777777" points="194,-1284 114,-1284 114,-1260 194,-1260 194,-1284"/>
<text text-anchor="middle" x="154" y="-1269.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">domaindecom</text>
</g>
<!-- proc~state_init&#45;&gt;domaindecom -->
<g id="proc~~state_init~~CallsGraph_edge24" class="edge"><title>proc~state_init&#45;&gt;domaindecom</title>
<path fill="none" stroke="#000000" d="M31.2528,-1137.33C37.4746,-1162.37 54.97,-1219.5 91,-1251 94.9623,-1254.46 99.5201,-1257.36 104.328,-1259.79"/>
<polygon fill="#000000" stroke="#000000" points="103.225,-1263.12 113.792,-1263.89 106.007,-1256.7 103.225,-1263.12"/>
</g>
<!-- write_debug -->
<g id="proc~~state_init~~CallsGraph_node26" class="node"><title>write_debug</title>
<polygon fill="#777777" stroke="#777777" points="189.5,-1242 118.5,-1242 118.5,-1218 189.5,-1218 189.5,-1242"/>
<text text-anchor="middle" x="154" y="-1227.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_debug</text>
</g>
<!-- proc~state_init&#45;&gt;write_debug -->
<g id="proc~~state_init~~CallsGraph_edge25" class="edge"><title>proc~state_init&#45;&gt;write_debug</title>
<path fill="none" stroke="#000000" d="M34.4413,-1137.12C43.9433,-1155.29 64.246,-1189.54 91,-1209 96.3076,-1212.86 102.376,-1216.05 108.591,-1218.67"/>
<polygon fill="#000000" stroke="#000000" points="107.799,-1222.11 118.391,-1222.34 110.253,-1215.55 107.799,-1222.11"/>
</g>
<!-- get_chess_parameter -->
<g id="proc~~state_init~~CallsGraph_node27" class="node"><title>get_chess_parameter</title>
<polygon fill="#777777" stroke="#777777" points="212.5,-1200 95.5,-1200 95.5,-1176 212.5,-1176 212.5,-1200"/>
<text text-anchor="middle" x="154" y="-1185.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_chess_parameter</text>
</g>
<!-- proc~state_init&#45;&gt;get_chess_parameter -->
<g id="proc~~state_init~~CallsGraph_edge26" class="edge"><title>proc~state_init&#45;&gt;get_chess_parameter</title>
<path fill="none" stroke="#000000" d="M44.2308,-1137.29C56.4584,-1146.41 74.1243,-1158.66 91,-1167 94.7822,-1168.87 98.7712,-1170.64 102.828,-1172.3"/>
<polygon fill="#000000" stroke="#000000" points="101.759,-1175.64 112.349,-1175.96 104.273,-1169.1 101.759,-1175.64"/>
</g>
<!-- siesta_write_positions -->
<g id="proc~~state_init~~CallsGraph_node28" class="node"><title>siesta_write_positions</title>
<polygon fill="#777777" stroke="#777777" points="212.5,-1158 95.5,-1158 95.5,-1134 212.5,-1134 212.5,-1158"/>
<text text-anchor="middle" x="154" y="-1143.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_write_positions</text>
</g>
<!-- proc~state_init&#45;&gt;siesta_write_positions -->
<g id="proc~~state_init~~CallsGraph_edge27" class="edge"><title>proc~state_init&#45;&gt;siesta_write_positions</title>
<path fill="none" stroke="#000000" d="M55.2084,-1129.51C64.2345,-1131.03 74.7598,-1132.8 85.4951,-1134.61"/>
<polygon fill="#000000" stroke="#000000" points="84.9332,-1138.07 95.3761,-1136.28 86.0975,-1131.17 84.9332,-1138.07"/>
</g>
<!-- numh -->
<g id="proc~~state_init~~CallsGraph_node29" class="node"><title>numh</title>
<polygon fill="#777777" stroke="#777777" points="181,-1116 127,-1116 127,-1092 181,-1092 181,-1116"/>
<text text-anchor="middle" x="154" y="-1101.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">numh</text>
</g>
<!-- proc~state_init&#45;&gt;numh -->
<g id="proc~~state_init~~CallsGraph_edge28" class="edge"><title>proc~state_init&#45;&gt;numh</title>
<path fill="none" stroke="#000000" d="M55.2084,-1120.49C73.2181,-1117.46 97.1968,-1113.41 116.902,-1110.09"/>
<polygon fill="#000000" stroke="#000000" points="117.485,-1113.54 126.763,-1108.43 116.32,-1106.64 117.485,-1113.54"/>
</g>
<!-- val -->
<g id="proc~~state_init~~CallsGraph_node30" class="node"><title>val</title>
<polygon fill="#777777" stroke="#777777" points="181,-1074 127,-1074 127,-1050 181,-1050 181,-1074"/>
<text text-anchor="middle" x="154" y="-1059.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">val</text>
</g>
<!-- proc~state_init&#45;&gt;val -->
<g id="proc~~state_init~~CallsGraph_edge29" class="edge"><title>proc~state_init&#45;&gt;val</title>
<path fill="none" stroke="#000000" d="M44.2308,-1112.71C56.4584,-1103.59 74.1243,-1091.34 91,-1083 99.2162,-1078.94 108.409,-1075.35 117.147,-1072.34"/>
<polygon fill="#000000" stroke="#000000" points="118.331,-1075.64 126.744,-1069.2 116.151,-1068.99 118.331,-1075.64"/>
</g>
<!-- overlap -->
<g id="proc~~state_init~~CallsGraph_node31" class="node"><title>overlap</title>
<polygon fill="#777777" stroke="#777777" points="181,-1032 127,-1032 127,-1008 181,-1008 181,-1032"/>
<text text-anchor="middle" x="154" y="-1017.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">overlap</text>
</g>
<!-- proc~state_init&#45;&gt;overlap -->
<g id="proc~~state_init~~CallsGraph_edge30" class="edge"><title>proc~state_init&#45;&gt;overlap</title>
<path fill="none" stroke="#000000" d="M34.4413,-1112.88C43.9433,-1094.71 64.246,-1060.46 91,-1041 98.7617,-1035.35 108.15,-1031.15 117.247,-1028.05"/>
<polygon fill="#000000" stroke="#000000" points="118.369,-1031.36 126.912,-1025.1 116.326,-1024.67 118.369,-1031.36"/>
</g>
<!-- madelung -->
<g id="proc~~state_init~~CallsGraph_node32" class="node"><title>madelung</title>
<polygon fill="#777777" stroke="#777777" points="184,-990 124,-990 124,-966 184,-966 184,-990"/>
<text text-anchor="middle" x="154" y="-975.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">madelung</text>
</g>
<!-- proc~state_init&#45;&gt;madelung -->
<g id="proc~~state_init~~CallsGraph_edge31" class="edge"><title>proc~state_init&#45;&gt;madelung</title>
<path fill="none" stroke="#000000" d="M31.2528,-1112.67C37.4746,-1087.63 54.97,-1030.5 91,-999 97.5797,-993.247 105.802,-989.055 114.085,-986.006"/>
<polygon fill="#000000" stroke="#000000" points="115.279,-989.299 123.743,-982.926 113.152,-982.63 115.279,-989.299"/>
</g>
<!-- escf -->
<g id="proc~~state_init~~CallsGraph_node33" class="node"><title>escf</title>
<polygon fill="#777777" stroke="#777777" points="181,-948 127,-948 127,-924 181,-924 181,-948"/>
<text text-anchor="middle" x="154" y="-933.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">escf</text>
</g>
<!-- proc~state_init&#45;&gt;escf -->
<g id="proc~~state_init~~CallsGraph_edge32" class="edge"><title>proc~state_init&#45;&gt;escf</title>
<path fill="none" stroke="#000000" d="M29.5034,-1112.94C32.6845,-1082.44 45.2278,-1001.44 91,-957 98.1411,-950.067 107.652,-945.42 117.076,-942.306"/>
<polygon fill="#000000" stroke="#000000" points="118.082,-945.659 126.762,-939.585 116.188,-938.92 118.082,-945.659"/>
</g>
<!-- ts_tri_analyze -->
<g id="proc~~state_init~~CallsGraph_node34" class="node"><title>ts_tri_analyze</title>
<polygon fill="#777777" stroke="#777777" points="193.5,-906 114.5,-906 114.5,-882 193.5,-882 193.5,-906"/>
<text text-anchor="middle" x="154" y="-891.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ts_tri_analyze</text>
</g>
<!-- proc~state_init&#45;&gt;ts_tri_analyze -->
<g id="proc~~state_init~~CallsGraph_edge33" class="edge"><title>proc~state_init&#45;&gt;ts_tri_analyze</title>
<path fill="none" stroke="#000000" d="M28.4565,-1112.92C28.995,-1077.48 35.4469,-972.666 91,-915 94.9423,-910.908 99.7098,-907.613 104.83,-904.96"/>
<polygon fill="#000000" stroke="#000000" points="106.541,-908.033 114.324,-900.845 103.757,-901.611 106.541,-908.033"/>
</g>
<!-- dict_repopulate_md -->
<g id="proc~~state_init~~CallsGraph_node35" class="node"><title>dict_repopulate_md</title>
<polygon fill="#777777" stroke="#777777" points="207.5,-864 100.5,-864 100.5,-840 207.5,-840 207.5,-864"/>
<text text-anchor="middle" x="154" y="-849.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dict_repopulate_md</text>
</g>
<!-- proc~state_init&#45;&gt;dict_repopulate_md -->
<g id="proc~~state_init~~CallsGraph_edge34" class="edge"><title>proc~state_init&#45;&gt;dict_repopulate_md</title>
<path fill="none" stroke="#000000" d="M29.9843,-1112.7C35.7024,-1067.2 57.6617,-909.244 91,-873 91.9088,-872.012 92.8658,-871.07 93.8645,-870.173"/>
<polygon fill="#000000" stroke="#000000" points="96.1782,-872.819 102.233,-864.125 92.0779,-867.146 96.1782,-872.819"/>
</g>
<!-- attach -->
<g id="proc~~state_init~~CallsGraph_node36" class="node"><title>attach</title>
<polygon fill="#777777" stroke="#777777" points="181,-822 127,-822 127,-798 181,-798 181,-822"/>
<text text-anchor="middle" x="154" y="-807.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">attach</text>
</g>
<!-- proc~state_init&#45;&gt;attach -->
<g id="proc~~state_init~~CallsGraph_edge35" class="edge"><title>proc~state_init&#45;&gt;attach</title>
<path fill="none" stroke="#000000" d="M29.507,-1112.77C33.8597,-1062.74 52.5966,-874.187 91,-831 97.7259,-823.436 107.276,-818.594 116.871,-815.494"/>
<polygon fill="#000000" stroke="#000000" points="118.01,-818.813 126.77,-812.855 116.206,-812.05 118.01,-818.813"/>
</g>
<!-- globalize_or -->
<g id="proc~~state_init~~CallsGraph_node37" class="node"><title>globalize_or</title>
<polygon fill="#777777" stroke="#777777" points="189,-780 119,-780 119,-756 189,-756 189,-780"/>
<text text-anchor="middle" x="154" y="-765.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">globalize_or</text>
</g>
<!-- proc~state_init&#45;&gt;globalize_or -->
<g id="proc~~state_init~~CallsGraph_edge36" class="edge"><title>proc~state_init&#45;&gt;globalize_or</title>
<path fill="none" stroke="#000000" d="M29.1455,-1112.92C32.2681,-1058.8 47.4787,-839.22 91,-789 95.9122,-783.332 102.413,-779.19 109.356,-776.165"/>
<polygon fill="#000000" stroke="#000000" points="110.769,-779.376 118.99,-772.694 108.396,-772.791 110.769,-779.376"/>
</g>
<!-- ucell -->
<g id="proc~~state_init~~CallsGraph_node38" class="node"><title>ucell</title>
<polygon fill="#777777" stroke="#777777" points="181,-738 127,-738 127,-714 181,-714 181,-738"/>
<text text-anchor="middle" x="154" y="-723.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ucell</text>
</g>
<!-- proc~state_init&#45;&gt;ucell -->
<g id="proc~~state_init~~CallsGraph_edge52" class="edge"><title>proc~state_init&#45;&gt;ucell</title>
<path fill="none" stroke="#000000" d="M28.8828,-1112.62C30.9379,-1053.92 42.4545,-804.165 91,-747 97.6758,-739.139 107.41,-734.212 117.195,-731.127"/>
<polygon fill="#000000" stroke="#000000" points="118.083,-734.513 126.886,-728.616 116.327,-727.737 118.083,-734.513"/>
</g>
<!-- outcoor -->
<g id="proc~~state_init~~CallsGraph_node39" class="node"><title>outcoor</title>
<polygon fill="#777777" stroke="#777777" points="181,-696 127,-696 127,-672 181,-672 181,-696"/>
<text text-anchor="middle" x="154" y="-681.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">outcoor</text>
</g>
<!-- proc~state_init&#45;&gt;outcoor -->
<g id="proc~~state_init~~CallsGraph_edge37" class="edge"><title>proc~state_init&#45;&gt;outcoor</title>
<path fill="none" stroke="#000000" d="M28.6524,-1112.94C29.6708,-1051.02 37.2374,-769.354 91,-705 97.6122,-697.085 107.328,-692.143 117.115,-689.06"/>
<polygon fill="#000000" stroke="#000000" points="118.007,-692.445 126.815,-686.556 116.257,-685.667 118.007,-692.445"/>
</g>
<!-- chess_init -->
<g id="proc~~state_init~~CallsGraph_node40" class="node"><title>chess_init</title>
<polygon fill="#777777" stroke="#777777" points="184,-654 124,-654 124,-630 184,-630 184,-654"/>
<text text-anchor="middle" x="154" y="-639.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">chess_init</text>
</g>
<!-- proc~state_init&#45;&gt;chess_init -->
<g id="proc~~state_init~~CallsGraph_edge38" class="edge"><title>proc~state_init&#45;&gt;chess_init</title>
<path fill="none" stroke="#000000" d="M28.4726,-1112.62C28.5704,-1046.4 32.1847,-734.358 91,-663 96.8819,-655.864 105.289,-651.142 114.022,-648.022"/>
<polygon fill="#000000" stroke="#000000" points="115.285,-651.299 123.902,-645.135 113.322,-644.58 115.285,-651.299"/>
</g>
<!-- ioxv -->
<g id="proc~~state_init~~CallsGraph_node41" class="node"><title>ioxv</title>
<polygon fill="#777777" stroke="#777777" points="181,-612 127,-612 127,-588 181,-588 181,-612"/>
<text text-anchor="middle" x="154" y="-597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ioxv</text>
</g>
<!-- proc~state_init&#45;&gt;ioxv -->
<g id="proc~~state_init~~CallsGraph_edge39" class="edge"><title>proc~state_init&#45;&gt;ioxv</title>
<path fill="none" stroke="#000000" d="M28.3209,-1112.89C27.5393,-1043.79 26.9442,-699.6 91,-621 97.5154,-613.005 107.203,-608.04 116.994,-604.96"/>
<polygon fill="#000000" stroke="#000000" points="117.891,-608.344 126.707,-602.467 116.151,-601.564 117.891,-608.344"/>
</g>
<!-- re_alloc -->
<g id="proc~~state_init~~CallsGraph_node42" class="node"><title>re_alloc</title>
<polygon fill="#777777" stroke="#777777" points="181,-570 127,-570 127,-546 181,-546 181,-570"/>
<text text-anchor="middle" x="154" y="-555.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">re_alloc</text>
</g>
<!-- proc~state_init&#45;&gt;re_alloc -->
<g id="proc~~state_init~~CallsGraph_edge40" class="edge"><title>proc~state_init&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M29.1285,-1112.64C33.1524,-1035.5 56.2427,-622.061 91,-579 97.5312,-570.908 107.314,-565.918 117.19,-562.846"/>
<polygon fill="#000000" stroke="#000000" points="118.144,-566.215 126.98,-560.37 116.427,-559.429 118.144,-566.215"/>
</g>
<!-- mscell -->
<g id="proc~~state_init~~CallsGraph_node43" class="node"><title>mscell</title>
<polygon fill="#777777" stroke="#777777" points="181,-528 127,-528 127,-504 181,-504 181,-528"/>
<text text-anchor="middle" x="154" y="-513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mscell</text>
</g>
<!-- proc~state_init&#45;&gt;mscell -->
<g id="proc~~state_init~~CallsGraph_edge41" class="edge"><title>proc~state_init&#45;&gt;mscell</title>
<path fill="none" stroke="#000000" d="M29.0179,-1112.74C32.511,-1032.48 53.6295,-583.683 91,-537 97.4985,-528.882 107.272,-523.884 117.149,-520.814"/>
<polygon fill="#000000" stroke="#000000" points="118.105,-524.182 126.944,-518.341 116.391,-517.395 118.105,-524.182"/>
</g>
<!-- sp_to_spglobal -->
<g id="proc~~state_init~~CallsGraph_node44" class="node"><title>sp_to_spglobal</title>
<polygon fill="#777777" stroke="#777777" points="196.5,-486 111.5,-486 111.5,-462 196.5,-462 196.5,-486"/>
<text text-anchor="middle" x="154" y="-471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sp_to_spglobal</text>
</g>
<!-- proc~state_init&#45;&gt;sp_to_spglobal -->
<g id="proc~~state_init~~CallsGraph_edge42" class="edge"><title>proc~state_init&#45;&gt;sp_to_spglobal</title>
<path fill="none" stroke="#000000" d="M28.919,-1112.96C31.9045,-1030.02 50.9935,-545.337 91,-495 94.1068,-491.091 97.9736,-487.905 102.248,-485.309"/>
<polygon fill="#000000" stroke="#000000" points="104.053,-488.322 111.481,-480.768 100.963,-482.041 104.053,-488.322"/>
</g>
<!-- newsparsity -->
<g id="proc~~state_init~~CallsGraph_node45" class="node"><title>newsparsity</title>
<polygon fill="#777777" stroke="#777777" points="188.5,-444 119.5,-444 119.5,-420 188.5,-420 188.5,-444"/>
<text text-anchor="middle" x="154" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">newsparsity</text>
</g>
<!-- proc~state_init&#45;&gt;newsparsity -->
<g id="proc~~state_init~~CallsGraph_edge44" class="edge"><title>proc~state_init&#45;&gt;newsparsity</title>
<path fill="none" stroke="#000000" d="M28.8395,-1112.99C31.3698,-1027.03 48.3805,-506.964 91,-453 95.7457,-446.991 102.288,-442.691 109.352,-439.615"/>
<polygon fill="#000000" stroke="#000000" points="110.929,-442.77 119.189,-436.136 108.595,-436.171 110.929,-442.77"/>
</g>
<!-- proc~mixers_history_init -->
<g id="proc~~state_init~~CallsGraph_node46" class="node"><title>proc~mixers_history_init</title>
<g id="a_proc~~state_init~~CallsGraph_node46"><a xlink:href=".././proc/mixers_history_init.html" xlink:title="mixers_history_init">
<polygon fill="#d9534f" stroke="#d9534f" points="204.5,-402 103.5,-402 103.5,-378 204.5,-378 204.5,-402"/>
<text text-anchor="middle" x="154" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mixers_history_init</text>
</a>
</g>
</g>
<!-- proc~state_init&#45;&gt;proc~mixers_history_init -->
<g id="proc~~state_init~~CallsGraph_edge45" class="edge"><title>proc~state_init&#45;&gt;proc~mixers_history_init</title>
<path fill="none" stroke="#000000" d="M28.7744,-1112.82C30.8936,-1023.27 45.7986,-468.553 91,-411 92.2635,-409.391 93.6558,-407.905 95.1526,-406.532"/>
<polygon fill="#000000" stroke="#000000" points="97.3463,-409.265 103.395,-400.566 93.2417,-403.594 97.3463,-409.265"/>
</g>
<!-- write_zmatrix -->
<g id="proc~~state_init~~CallsGraph_node47" class="node"><title>write_zmatrix</title>
<polygon fill="#777777" stroke="#777777" points="192,-360 116,-360 116,-336 192,-336 192,-360"/>
<text text-anchor="middle" x="154" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_zmatrix</text>
</g>
<!-- proc~state_init&#45;&gt;write_zmatrix -->
<g id="proc~~state_init~~CallsGraph_edge46" class="edge"><title>proc~state_init&#45;&gt;write_zmatrix</title>
<path fill="none" stroke="#000000" d="M28.7087,-1113C30.4083,-1021.06 43.1544,-430.224 91,-369 95.0413,-363.829 100.414,-359.922 106.313,-356.972"/>
<polygon fill="#000000" stroke="#000000" points="107.949,-360.085 115.898,-353.081 105.316,-353.6 107.949,-360.085"/>
</g>
<!-- init_val -->
<g id="proc~~state_init~~CallsGraph_node48" class="node"><title>init_val</title>
<polygon fill="#777777" stroke="#777777" points="181,-318 127,-318 127,-294 181,-294 181,-318"/>
<text text-anchor="middle" x="154" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_val</text>
</g>
<!-- proc~state_init&#45;&gt;init_val -->
<g id="proc~~state_init~~CallsGraph_edge47" class="edge"><title>proc~state_init&#45;&gt;init_val</title>
<path fill="none" stroke="#000000" d="M28.6545,-1112.94C29.9727,-1017.94 40.547,-391.849 91,-327 97.3853,-318.793 107.127,-313.77 117.009,-310.703"/>
<polygon fill="#000000" stroke="#000000" points="117.971,-314.07 126.82,-308.243 116.269,-307.28 117.971,-314.07"/>
</g>
<!-- iotdxv -->
<g id="proc~~state_init~~CallsGraph_node49" class="node"><title>iotdxv</title>
<polygon fill="#777777" stroke="#777777" points="181,-276 127,-276 127,-252 181,-252 181,-276"/>
<text text-anchor="middle" x="154" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iotdxv</text>
</g>
<!-- proc~state_init&#45;&gt;iotdxv -->
<g id="proc~~state_init~~CallsGraph_edge48" class="edge"><title>proc~state_init&#45;&gt;iotdxv</title>
<path fill="none" stroke="#000000" d="M28.6047,-1112.94C29.5552,-1015.11 37.9284,-353.489 91,-285 97.3693,-276.78 107.106,-271.754 116.989,-268.688"/>
<polygon fill="#000000" stroke="#000000" points="117.953,-272.055 126.802,-266.229 116.252,-265.264 117.953,-272.055"/>
</g>
<!-- isc_off -->
<g id="proc~~state_init~~CallsGraph_node50" class="node"><title>isc_off</title>
<polygon fill="#777777" stroke="#777777" points="181,-234 127,-234 127,-210 181,-210 181,-234"/>
<text text-anchor="middle" x="154" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">isc_off</text>
</g>
<!-- proc~state_init&#45;&gt;isc_off -->
<g id="proc~~state_init~~CallsGraph_edge49" class="edge"><title>proc~state_init&#45;&gt;isc_off</title>
<path fill="none" stroke="#000000" d="M28.5593,-1112.98C29.1562,-1012.56 35.2986,-315.145 91,-243 97.3548,-234.769 107.087,-229.739 116.971,-226.674"/>
<polygon fill="#000000" stroke="#000000" points="117.936,-230.041 126.786,-224.217 116.236,-223.25 117.936,-230.041"/>
</g>
<!-- time_io -->
<g id="proc~~state_init~~CallsGraph_node51" class="node"><title>time_io</title>
<polygon fill="#777777" stroke="#777777" points="181,-192 127,-192 127,-168 181,-168 181,-192"/>
<text text-anchor="middle" x="154" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">time_io</text>
</g>
<!-- proc~state_init&#45;&gt;time_io -->
<g id="proc~~state_init~~CallsGraph_edge50" class="edge"><title>proc~state_init&#45;&gt;time_io</title>
<path fill="none" stroke="#000000" d="M28.519,-1112.74C28.7839,-1008.75 32.719,-276.737 91,-201 97.3416,-192.759 107.07,-187.726 116.955,-184.661"/>
<polygon fill="#000000" stroke="#000000" points="117.92,-188.028 126.772,-182.206 116.222,-181.237 117.92,-188.028"/>
</g>
<!-- superc -->
<g id="proc~~state_init~~CallsGraph_node52" class="node"><title>superc</title>
<polygon fill="#777777" stroke="#777777" points="181,-150 127,-150 127,-126 181,-126 181,-150"/>
<text text-anchor="middle" x="154" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">superc</text>
</g>
<!-- proc~state_init&#45;&gt;superc -->
<g id="proc~~state_init~~CallsGraph_edge51" class="edge"><title>proc~state_init&#45;&gt;superc</title>
<path fill="none" stroke="#000000" d="M28.481,-1112.86C28.4172,-1006.7 30.0697,-238.42 91,-159 97.3295,-150.75 107.055,-145.714 116.94,-142.65"/>
<polygon fill="#000000" stroke="#000000" points="117.906,-146.016 126.759,-140.196 116.209,-139.225 117.906,-146.016"/>
</g>
<!-- bye -->
<g id="proc~~state_init~~CallsGraph_node53" class="node"><title>bye</title>
<polygon fill="#777777" stroke="#777777" points="181,-108 127,-108 127,-84 181,-84 181,-108"/>
<text text-anchor="middle" x="154" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bye</text>
</g>
<!-- proc~state_init&#45;&gt;bye -->
<g id="proc~~state_init~~CallsGraph_edge4" class="edge"><title>proc~state_init&#45;&gt;bye</title>
<path fill="none" stroke="#000000" d="M28.4457,-1112.68C28.068,-1003.25 27.4761,-200.031 91,-117 97.3185,-108.741 107.041,-103.703 116.926,-100.639"/>
<polygon fill="#000000" stroke="#000000" points="117.893,-104.005 126.747,-98.1865 116.197,-97.214 117.893,-104.005"/>
</g>
<!-- sporb_to_spatom -->
<g id="proc~~state_init~~CallsGraph_node54" class="node"><title>sporb_to_spatom</title>
<polygon fill="#777777" stroke="#777777" points="202,-66 106,-66 106,-42 202,-42 202,-66"/>
<text text-anchor="middle" x="154" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sporb_to_spatom</text>
</g>
<!-- proc~state_init&#45;&gt;sporb_to_spatom -->
<g id="proc~~state_init~~CallsGraph_edge43" class="edge"><title>proc~state_init&#45;&gt;sporb_to_spatom</title>
<path fill="none" stroke="#000000" d="M28.4145,-1112.87C27.734,-1001.7 24.8076,-161.741 91,-75 92.8421,-72.5861 94.975,-70.4473 97.318,-68.5525"/>
<polygon fill="#000000" stroke="#000000" points="99.4444,-71.3469 105.976,-63.0051 95.6679,-65.453 99.4444,-71.3469"/>
</g>
<!-- ts_sparse_init -->
<g id="proc~~state_init~~CallsGraph_node55" class="node"><title>ts_sparse_init</title>
<polygon fill="#777777" stroke="#777777" points="193.5,-24 114.5,-24 114.5,-0 193.5,-0 193.5,-24"/>
<text text-anchor="middle" x="154" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ts_sparse_init</text>
</g>
<!-- proc~state_init&#45;&gt;ts_sparse_init -->
<g id="proc~~state_init~~CallsGraph_edge54" class="edge"><title>proc~state_init&#45;&gt;ts_sparse_init</title>
<path fill="none" stroke="#000000" d="M28.3841,-1112.75C27.408,-998.602 22.2002,-123.372 91,-33 94.7044,-28.1341 99.591,-24.3859 104.999,-21.5006"/>
<polygon fill="#000000" stroke="#000000" points="106.679,-24.5878 114.476,-17.4145 103.908,-18.1598 106.679,-24.5878"/>
</g>
<!-- proc~mixers_history_init&#45;&gt;delete -->
<g id="proc~~state_init~~CallsGraph_edge55" class="edge"><title>proc~mixers_history_init&#45;&gt;delete</title>
<path fill="none" stroke="#000000" d="M204.702,-400.897C209.361,-403.564 213.602,-406.879 217,-411 276.008,-482.548 281.977,-786.126 282.482,-870.921"/>
<polygon fill="#000000" stroke="#000000" points="278.983,-870.992 282.522,-880.978 285.983,-870.964 278.983,-870.992"/>
</g>
<!-- proc~current_itt -->
<g id="proc~~state_init~~CallsGraph_node56" class="node"><title>proc~current_itt</title>
<g id="a_proc~~state_init~~CallsGraph_node56"><a xlink:href=".././proc/current_itt.html" xlink:title="current_itt">
<polygon fill="#d94e8f" stroke="#d94e8f" points="314,-423 253,-423 253,-399 314,-399 314,-423"/>
<text text-anchor="middle" x="283.5" y="-408.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">current_itt</text>
</a>
</g>
</g>
<!-- proc~mixers_history_init&#45;&gt;proc~current_itt -->
<g id="proc~~state_init~~CallsGraph_edge56" class="edge"><title>proc~mixers_history_init&#45;&gt;proc~current_itt</title>
<path fill="none" stroke="#000000" d="M204.66,-398.179C217.206,-400.246 230.52,-402.439 242.521,-404.415"/>
<polygon fill="#000000" stroke="#000000" points="242.241,-407.916 252.677,-406.088 243.379,-401.009 242.241,-407.916"/>
</g>
<!-- new -->
<g id="proc~~state_init~~CallsGraph_node57" class="node"><title>new</title>
<polygon fill="#777777" stroke="#777777" points="310.5,-381 256.5,-381 256.5,-357 310.5,-357 310.5,-381"/>
<text text-anchor="middle" x="283.5" y="-366.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">new</text>
</g>
<!-- proc~mixers_history_init&#45;&gt;new -->
<g id="proc~~state_init~~CallsGraph_edge57" class="edge"><title>proc~mixers_history_init&#45;&gt;new</title>
<path fill="none" stroke="#000000" d="M204.66,-381.821C218.563,-379.531 233.408,-377.086 246.366,-374.951"/>
<polygon fill="#000000" stroke="#000000" points="247.001,-378.394 256.299,-373.315 245.863,-371.487 247.001,-378.394"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,-0 209.5,-0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.5,-24 454.5,-24 454.5,-0 551.5,-0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
	<h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
	<div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~state_init~~CalledByGraph Pages: 1 -->
<svg id="procstate_initCalledByGraph" width="175pt" height="32pt"
 viewBox="0.00 0.00 175.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~state_init~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~state_init~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 171,-28 171,4 -4,4"/>
<!-- proc~state_init -->
<g id="proc~~state_init~~CalledByGraph_node1" class="node"><title>proc~state_init</title>
<polygon fill="none" stroke="black" points="167,-24 112,-24 112,-0 167,-0 167,-24"/>
<text text-anchor="middle" x="139.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">state_init</text>
</g>
<!-- proc~siesta_forces -->
<g id="proc~~state_init~~CalledByGraph_node2" class="node"><title>proc~siesta_forces</title>
<g id="a_proc~~state_init~~CalledByGraph_node2"><a xlink:href=".././proc/siesta_forces.html" xlink:title="siesta_forces">
<polygon fill="#d9534f" stroke="#d9534f" points="76,-24 0,-24 0,-0 76,-0 76,-24"/>
<text text-anchor="middle" x="38" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_forces</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;proc~state_init -->
<g id="proc~~state_init~~CalledByGraph_edge1" class="edge"><title>proc~siesta_forces&#45;&gt;proc~state_init</title>
<path fill="none" stroke="#000000" d="M76.0501,-12C84.4416,-12 93.3497,-12 101.73,-12"/>
<polygon fill="#000000" stroke="#000000" points="101.983,-15.5001 111.983,-12 101.983,-8.5001 101.983,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,-0 209.5,-0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.5,-24 454.5,-24 454.5,-0 551.5,-0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      




















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/state_init.html#src">state_init</a>
  </div>
</div>


    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>      <span class="k">subroutine </span><span class="n">state_init</span><span class="p">(</span> <span class="n">istep</span> <span class="p">)</span>
      <span class="k">use </span><span class="n">Kpoint_grid</span><span class="p">,</span>       <span class="n">only</span><span class="p">:</span> <span class="n">setup_Kpoint_grid</span><span class="p">,</span> <span class="n">nkpnt</span>
      <span class="k">use </span><span class="n">m_os</span><span class="p">,</span>              <span class="n">only</span><span class="p">:</span> <span class="n">file_exist</span>
      <span class="k">use </span><span class="n">m_new_dm</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">new_dm</span>
      <span class="k">use </span><span class="n">m_proximity_check</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">proximity_check</span>
      <span class="k">use </span><span class="n">siesta_options</span>
      <span class="k">use </span><span class="n">units</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">Ang</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">listhptr</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">Dold</span><span class="p">,</span> <span class="n">Dscf</span><span class="p">,</span> <span class="n">DM_2D</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">Eold</span><span class="p">,</span> <span class="n">Escf</span><span class="p">,</span> <span class="n">EDM_2D</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">Hold</span><span class="p">,</span> <span class="n">H</span>   <span class="p">,</span> <span class="n">H_2D</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">xijo</span><span class="p">,</span> <span class="n">xij_2D</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">S</span>   <span class="p">,</span> <span class="n">S_1D</span>

      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">H_kin_1D</span><span class="p">,</span> <span class="n">H_vkb_1D</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">H_ldau_2D</span><span class="p">,</span> <span class="n">H_so_2D</span>

      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">sparse_pattern</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">block_dist</span><span class="p">,</span> <span class="n">single_dist</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">DM_history</span>


      <span class="k">use </span><span class="n">create_Sparsity_SC</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">crtSparsity_SC</span>
      <span class="k">use </span><span class="n">m_sparsity_handling</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">SpOrb_to_SpAtom</span>
      <span class="k">use </span><span class="n">m_sparsity_handling</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">Sp_to_Spglobal</span>
      <span class="k">use </span><span class="n">m_pivot_methods</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">sp2graphviz</span>

      <span class="k">use </span><span class="n">siesta_geom</span>
      <span class="k">use </span><span class="n">atomlist</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">iphorb</span><span class="p">,</span> <span class="n">iphkb</span><span class="p">,</span> <span class="n">indxua</span><span class="p">,</span>
     <span class="p">&amp;</span>                             <span class="n">rmaxo</span><span class="p">,</span> <span class="n">rmaxkb</span><span class="p">,</span> <span class="n">rmaxv</span><span class="p">,</span> <span class="n">rmaxldau</span><span class="p">,</span>
     <span class="p">&amp;</span>                             <span class="n">lastkb</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span> <span class="n">superc</span><span class="p">,</span> <span class="n">indxuo</span><span class="p">,</span>
     <span class="p">&amp;</span>                             <span class="n">no_u</span><span class="p">,</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">iza</span><span class="p">,</span> <span class="n">qtots</span>
      <span class="k">use </span><span class="n">alloc</span><span class="p">,</span>             <span class="n">only</span><span class="p">:</span> <span class="n">re_alloc</span><span class="p">,</span> <span class="n">de_alloc</span><span class="p">,</span> <span class="n">alloc_report</span>
      <span class="k">use </span><span class="n">m_hsparse</span><span class="p">,</span>         <span class="n">only</span><span class="p">:</span> <span class="n">hsparse</span>
      <span class="k">use </span><span class="n">m_overlap</span><span class="p">,</span>         <span class="n">only</span><span class="p">:</span> <span class="n">overlap</span>
      <span class="k">use </span><span class="n">m_supercell</span><span class="p">,</span>       <span class="n">only</span><span class="p">:</span> <span class="n">exact_sc_ag</span>
      <span class="k">use </span><span class="n">siesta_cml</span><span class="p">,</span>        <span class="n">only</span><span class="p">:</span> <span class="n">cml_p</span><span class="p">,</span> <span class="n">cmlStartStep</span><span class="p">,</span> <span class="n">mainXML</span>
      <span class="k">use </span><span class="n">zmatrix</span><span class="p">,</span>           <span class="n">only</span><span class="p">:</span> <span class="n">lUseZmatrix</span><span class="p">,</span> <span class="n">write_zmatrix</span>
      <span class="k">use </span><span class="n">m_energies</span><span class="p">,</span>        <span class="n">only</span><span class="p">:</span> <span class="n">Emad</span>
      <span class="k">use </span><span class="n">write_subs</span>
      <span class="k">use </span><span class="n">m_ioxv</span><span class="p">,</span>            <span class="n">only</span><span class="p">:</span> <span class="n">ioxv</span>
      <span class="k">use </span><span class="n">m_iotdxv</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">iotdxv</span>
      <span class="k">use </span><span class="n">m_steps</span>
      <span class="k">use </span><span class="n">parallel</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">IOnode</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">nodes</span><span class="p">,</span> <span class="n">BlockSize</span>
      <span class="k">use </span><span class="n">m_spin</span><span class="p">,</span>            <span class="n">only</span><span class="p">:</span> <span class="n">spin</span>
      <span class="k">use </span><span class="n">m_rmaxh</span>
      <span class="k">use </span><span class="n">m_mixing</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">mixers_history_init</span>
      <span class="k">use </span><span class="n">m_mixing_scf</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">scf_mixs</span><span class="p">,</span> <span class="n">scf_mix</span>

      <span class="k">use </span><span class="n">m_normalize_dm</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">normalize_dm</span>

      <span class="k">use </span><span class="n">m_eo</span>
      <span class="k">use </span><span class="n">m_gamma</span>
      <span class="k">use </span><span class="n">files</span><span class="p">,</span>             <span class="n">only</span><span class="p">:</span> <span class="n">slabel</span>
      <span class="k">use </span><span class="n">m_mpi_utils</span><span class="p">,</span>       <span class="n">only</span><span class="p">:</span> <span class="n">globalize_or</span>
      <span class="k">use </span><span class="n">m_mpi_utils</span><span class="p">,</span>       <span class="n">only</span><span class="p">:</span> <span class="n">globalize_max</span>
      <span class="k">use </span><span class="n">domain_decom</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">domainDecom</span><span class="p">,</span> <span class="n">use_dd</span><span class="p">,</span> <span class="n">use_dd_perm</span>
      <span class="k">use </span><span class="n">ldau_specs</span><span class="p">,</span>        <span class="n">only</span><span class="p">:</span> <span class="n">switch_ldau</span><span class="p">,</span> <span class="n">ldau_init</span>

      <span class="k">use </span><span class="n">m_sparse</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">xij_offset</span>

      <span class="k">use </span><span class="n">m_ts_kpoints</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">setup_ts_kpoint_grid</span>
      <span class="k">use </span><span class="n">m_ts_charge</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">TS_RHOCORR_METHOD</span><span class="p">,</span> <span class="n">TS_RHOCORR_FERMI</span>
      <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">BTD_method</span>
      <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">TS_Analyze</span>
      <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">N_Elec</span><span class="p">,</span> <span class="n">Elecs</span><span class="p">,</span> <span class="n">IsVolt</span>
      <span class="k">use </span><span class="n">m_ts_electype</span>
      <span class="k">use </span><span class="n">m_ts_global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">TSrun</span><span class="p">,</span> <span class="n">TSmode</span><span class="p">,</span> <span class="n">onlyS</span>
      <span class="k">use </span><span class="n">sys</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">bye</span>
      <span class="k">use </span><span class="n">m_ts_io</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">fname_TSHS</span><span class="p">,</span> <span class="n">ts_write_tshs</span>
      <span class="k">use </span><span class="n">m_ts_sparse</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">ts_sparse_init</span>
      <span class="k">use </span><span class="n">m_ts_tri_init</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">ts_tri_init</span><span class="p">,</span> <span class="n">ts_tri_analyze</span>
      <span class="k">use </span><span class="n">files</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">slabel</span><span class="p">,</span> <span class="n">label_length</span>
<span class="cp">#ifdef SIESTA__CHESS</span>
      <span class="k">use </span><span class="n">m_chess</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">CheSS_init</span><span class="p">,</span> <span class="n">get_CheSS_parameter</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef CDF</span>
      <span class="k">use </span><span class="n">iodm_netcdf</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">setup_dm_netcdf_file</span>
      <span class="k">use </span><span class="n">iodmhs_netcdf</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">setup_dmhs_netcdf_file</span>
<span class="cp">#endif</span>
      <span class="k">use </span><span class="n">class_Sparsity</span>
      <span class="k">use </span><span class="n">class_dSpData1D</span>
      <span class="k">use </span><span class="n">class_dSpData2D</span>
      <span class="k">use </span><span class="n">class_dData2D</span>
<span class="cp">#ifdef TEST_IO</span>
      <span class="k">use </span><span class="n">m_test_io</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef SIESTA__FLOOK</span>
      <span class="k">use </span><span class="n">siesta_dicts</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">dict_repopulate_MD</span>
<span class="cp">#endif</span>

      <span class="k">implicit none</span>

<span class="k">      </span><span class="kt">integer</span>            <span class="kd">::</span> <span class="n">istep</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">veclen</span>      <span class="c">! Length of a unit-cell vector</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">rmax</span>
      <span class="kt">logical</span>            <span class="kd">::</span> <span class="n">cell_can_change</span>
      <span class="kt">integer</span>            <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iadispl</span><span class="p">,</span> <span class="n">ixdispl</span>
      <span class="kt">logical</span>            <span class="kd">::</span> <span class="n">auxchanged</span>   <span class="c">! Auxiliary supercell changed?</span>
      <span class="kt">logical</span>            <span class="kd">::</span> <span class="n">folding</span><span class="p">,</span> <span class="n">folding1</span>
      <span class="kt">logical</span>            <span class="kd">::</span> <span class="n">foundxv</span>  <span class="c">! dummy for call to ioxv</span>
      <span class="k">external</span>           <span class="kd">::</span>  <span class="n">madelung</span><span class="p">,</span> <span class="n">timer</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">external</span> <span class="kd">::</span> <span class="n">volcel</span>

      <span class="kt">integer</span>                       <span class="kd">::</span> <span class="n">ts_kscell_file</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>                      <span class="kd">::</span> <span class="n">ts_kdispl_file</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0</span>
      <span class="kt">logical</span>                       <span class="kd">::</span> <span class="n">ts_Gamma_file</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
      <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">label_length</span><span class="o">+</span><span class="mi">6</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fname</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>                      <span class="kd">::</span> <span class="n">dummyef</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">dummyqtot</span><span class="o">=</span><span class="mf">0.0</span>
<span class="cp">#ifdef SIESTA__CHESS</span>
      <span class="kt">integer</span> <span class="kd">::</span> <span class="n">maxnh_kernel</span><span class="p">,</span> <span class="n">maxnh_mult</span><span class="p">,</span> <span class="n">no_l_kernel</span><span class="p">,</span> <span class="n">no_l_mult</span>
      <span class="kt">integer</span><span class="p">,</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">allocatable</span> <span class="kd">::</span> <span class="n">listh_kernel</span><span class="p">,</span> <span class="n">listh_mult</span>
      <span class="kt">integer</span><span class="p">,</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">allocatable</span> <span class="kd">::</span> <span class="n">numh_kernel</span><span class="p">,</span> <span class="n">numh_mult</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">chess_value</span>
<span class="cp">#endif</span>
      <span class="k">type</span><span class="p">(</span><span class="n">Sparsity</span><span class="p">)</span> <span class="kd">::</span> <span class="n">g_Sp</span>
      
      <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">oname</span>

      <span class="k">type</span><span class="p">(</span><span class="n">dData2D</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tmp_2D</span>


<span class="c">!------------------------------------------------------------------- BEGIN</span>
      <span class="k">call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;IterGeom&#39;</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span>
<span class="cp">#ifdef DEBUG</span>
      <span class="k">call </span><span class="n">write_debug</span><span class="p">(</span> <span class="s1">&#39;  PRE state_init&#39;</span> <span class="p">)</span>
<span class="cp">#endif</span>
      <span class="k">call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;state_init&#39;</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span>

      <span class="n">istp</span> <span class="o">=</span> <span class="n">istp</span> <span class="o">+</span> <span class="mi">1</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">IOnode</span><span class="p">)</span> <span class="k">then</span>
<span class="k">      write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,t22,a)&#39;</span><span class="p">)</span> <span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">,</span><span class="mi">36</span><span class="p">)</span>
      <span class="k">select case</span> <span class="p">(</span><span class="n">idyn</span><span class="p">)</span>
      <span class="k">case</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">nmove</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t25,a)&#39;</span><span class="p">)</span> <span class="s1">&#39;Single-point calculation&#39;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">cml_p</span><span class="p">)</span> <span class="k">call </span><span class="n">cmlStartStep</span><span class="p">(</span><span class="n">mainXML</span><span class="p">,</span> <span class="k">type</span><span class="o">=</span><span class="s1">&#39;Single-Point&#39;</span><span class="p">,</span>
     <span class="err">$</span>           <span class="nb">index</span><span class="o">=</span><span class="n">istp</span><span class="p">)</span>
         <span class="k">else</span>
<span class="k">            if</span> <span class="p">(</span><span class="n">broyden_optim</span><span class="p">)</span> <span class="k">then</span>
<span class="k">               write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t25,a,i6)&#39;</span><span class="p">)</span> <span class="s1">&#39;Begin Broyden opt. move = &#39;</span><span class="p">,</span>
     <span class="err">$</span>              <span class="n">istep</span>
            <span class="k">else if</span> <span class="p">(</span><span class="n">fire_optim</span><span class="p">)</span> <span class="k">then</span>
<span class="k">               write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t25,a,i6)&#39;</span><span class="p">)</span> <span class="s1">&#39;Begin FIRE opt. move = &#39;</span><span class="p">,</span>
     <span class="err">$</span>              <span class="n">istep</span>
            <span class="k">else</span>
<span class="k">               write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t25,a,i6)&#39;</span><span class="p">)</span> <span class="s1">&#39;Begin CG opt. move = &#39;</span><span class="p">,</span>
     <span class="err">$</span>              <span class="n">istep</span>
            <span class="k">end if</span>
<span class="k">            if</span> <span class="p">(</span><span class="n">cml_p</span><span class="p">)</span> <span class="k">call </span><span class="n">cmlStartStep</span><span class="p">(</span><span class="n">mainXML</span><span class="p">,</span> <span class="k">type</span><span class="o">=</span><span class="s1">&#39;Geom. Optim&#39;</span><span class="p">,</span>
     <span class="err">$</span>           <span class="nb">index</span><span class="o">=</span><span class="n">istp</span><span class="p">)</span>
         <span class="n">endif</span>
         
<span class="c">!        Print Z-matrix coordinates</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">lUseZmatrix</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            call </span><span class="n">write_Zmatrix</span><span class="p">()</span>
         <span class="n">endif</span>
      <span class="k">case</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">iquench</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t25,a,i6)&#39;</span><span class="p">)</span> <span class="s1">&#39;Begin MD quenched step = &#39;</span><span class="p">,</span>
     <span class="err">$</span>           <span class="n">istep</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">cml_p</span><span class="p">)</span> <span class="k">call </span><span class="n">cmlStartStep</span><span class="p">(</span><span class="n">mainXML</span><span class="p">,</span> <span class="k">type</span><span class="o">=</span><span class="s1">&#39;MD-quenched&#39;</span><span class="p">,</span>
     <span class="err">$</span>           <span class="nb">index</span><span class="o">=</span><span class="n">istep</span><span class="p">)</span>
         <span class="k">else</span>
<span class="k">            write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t25,a,i6)&#39;</span><span class="p">)</span> <span class="s1">&#39;Begin MD step = &#39;</span><span class="p">,</span>
     <span class="err">$</span>           <span class="n">istep</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">cml_p</span><span class="p">)</span> <span class="k">call </span><span class="n">cmlStartStep</span><span class="p">(</span><span class="n">mainXML</span><span class="p">,</span> <span class="k">type</span><span class="o">=</span><span class="s1">&#39;MD&#39;</span><span class="p">,</span>
     <span class="err">$</span>             <span class="nb">index</span><span class="o">=</span><span class="n">istep</span><span class="p">)</span>
         <span class="n">endif</span>
      <span class="k">case</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
         <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t25,a,i6)&#39;</span><span class="p">)</span> <span class="s1">&#39;Begin MD step = &#39;</span><span class="p">,</span> <span class="n">istep</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">cml_p</span><span class="p">)</span> <span class="k">call </span><span class="n">cmlStartStep</span><span class="p">(</span><span class="n">mainXML</span><span class="p">,</span> <span class="k">type</span><span class="o">=</span><span class="s1">&#39;MD&#39;</span><span class="p">,</span> <span class="nb">index</span><span class="o">=</span><span class="n">istep</span><span class="p">)</span>
      <span class="k">case</span> <span class="p">(</span><span class="mi">6</span><span class="p">)</span>
          <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t25,a,i6)&#39;</span><span class="p">)</span> <span class="s1">&#39;Begin FC step = &#39;</span><span class="p">,</span><span class="n">istep</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">cml_p</span><span class="p">)</span> <span class="k">call </span><span class="n">cmlStartStep</span><span class="p">(</span><span class="n">mainXML</span><span class="p">,</span> <span class="k">type</span><span class="o">=</span><span class="s1">&#39;FC&#39;</span><span class="p">,</span> <span class="nb">index</span><span class="o">=</span><span class="n">istep</span><span class="p">)</span>
          
          <span class="k">if</span> <span class="p">(</span><span class="n">istep</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t25,a)&#39;</span><span class="p">)</span> <span class="s1">&#39;Undisplaced coordinates&#39;</span>
         <span class="k">else</span>
<span class="k">            </span><span class="n">iadispl</span> <span class="o">=</span> <span class="p">(</span><span class="n">istep</span><span class="o">-</span><span class="nb">mod</span><span class="p">(</span><span class="n">istep</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">/</span><span class="mi">6</span><span class="o">+</span><span class="n">ia1</span>
            <span class="n">ix</span> <span class="o">=</span> <span class="nb">mod</span><span class="p">(</span><span class="n">istep</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
            <span class="n">ixdispl</span> <span class="o">=</span> <span class="p">(</span><span class="n">ix</span> <span class="o">-</span> <span class="nb">mod</span><span class="p">(</span><span class="n">ix</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
            <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t26,a,i0,/,t26,a,i1,a,f10.6,a)&#39;</span><span class="p">)</span> <span class="s1">&#39;displace atom &#39;</span><span class="p">,</span>
     <span class="p">&amp;</span>           <span class="n">iadispl</span><span class="p">,</span><span class="s1">&#39;in direction &#39;</span><span class="p">,</span><span class="n">ixdispl</span><span class="p">,</span><span class="s1">&#39; by&#39;</span><span class="p">,</span> <span class="n">dx</span><span class="o">/</span><span class="n">Ang</span><span class="p">,</span><span class="s1">&#39; Ang&#39;</span>
         <span class="n">endif</span>
         
      <span class="k">case</span> <span class="p">(</span><span class="mi">8</span><span class="p">)</span>
         <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t25,a,i6)&#39;</span><span class="p">)</span> <span class="s1">&#39;Begin Server step = &#39;</span><span class="p">,</span><span class="n">istep</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">cml_p</span><span class="p">)</span> <span class="k">call </span><span class="n">cmlStartStep</span><span class="p">(</span><span class="n">mainXML</span><span class="p">,</span> <span class="k">type</span><span class="o">=</span><span class="s1">&#39;FS&#39;</span><span class="p">,</span> <span class="nb">index</span><span class="o">=</span><span class="n">istep</span><span class="p">)</span>
         
      <span class="k">case</span> <span class="p">(</span><span class="mi">9</span><span class="p">)</span>
         <span class="k">if</span> <span class="p">(</span> <span class="n">istep</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t25,a,i7)&#39;</span><span class="p">)</span><span class="s1">&#39;Explicit coord. initialization&#39;</span>
         <span class="k">else</span>
<span class="k">            write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t25,a,i7)&#39;</span><span class="p">)</span><span class="s1">&#39;Explicit coord. step =&#39;</span><span class="p">,</span><span class="n">istep</span>
         <span class="k">end if</span>
<span class="k">         if</span> <span class="p">(</span><span class="n">cml_p</span><span class="p">)</span> <span class="k">call </span><span class="n">cmlStartStep</span><span class="p">(</span><span class="n">mainXML</span><span class="p">,</span> <span class="k">type</span><span class="o">=</span><span class="s1">&#39;ECS&#39;</span><span class="p">,</span> <span class="nb">index</span><span class="o">=</span><span class="n">istep</span><span class="p">)</span>
         
      <span class="k">case</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span>
         <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t25,a,i7)&#39;</span><span class="p">)</span><span class="s1">&#39;LUA coord. step =&#39;</span><span class="p">,</span><span class="n">istep</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">cml_p</span><span class="p">)</span> <span class="k">call </span><span class="n">cmlStartStep</span><span class="p">(</span><span class="n">mainXML</span><span class="p">,</span> <span class="k">type</span><span class="o">=</span><span class="s1">&#39;LUA&#39;</span><span class="p">,</span> <span class="nb">index</span><span class="o">=</span><span class="n">istep</span><span class="p">)</span>
         
      <span class="k">end select</span>
<span class="k">      </span>
<span class="k">      write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(t22,a)&#39;</span><span class="p">)</span> <span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">,</span><span class="mi">36</span><span class="p">)</span>
      
<span class="c">!     Print atomic coordinates</span>
      <span class="k">call </span><span class="n">outcoor</span><span class="p">(</span> <span class="n">ucell</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">writec</span> <span class="p">)</span>

<span class="c">!     Save structural information in crystallographic format</span>
<span class="c">!     (in file SystemLabel.STRUCT_OUT),</span>
<span class="c">!     canonical Zmatrix (if applicable), and CML record</span>
      
      <span class="k">call </span><span class="n">siesta_write_positions</span><span class="p">(</span><span class="n">moved</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.)</span>
       
      <span class="n">endif</span> <span class="c">! IONode</span>

      <span class="c">! Write the XV file for single-point calculations, so that</span>
      <span class="c">! it is there at the end for those users who rely on it</span>
      <span class="k">call </span><span class="n">ioxv</span><span class="p">(</span> <span class="s1">&#39;write&#39;</span><span class="p">,</span> <span class="n">ucell</span><span class="p">,</span> <span class="n">vcell</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">isa</span><span class="p">,</span> <span class="n">iza</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">va</span><span class="p">,</span> 
     <span class="p">&amp;</span>           <span class="n">foundxv</span><span class="p">)</span>
      <span class="c">! Write TDXV file for TDDFT restart.</span>
      <span class="k">if</span><span class="p">(</span><span class="n">writetdwf</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">td_elec_dyn</span><span class="p">)</span> <span class="k">then</span>
<span class="k">      call </span><span class="n">iotdxv</span><span class="p">(</span><span class="s1">&#39;write&#39;</span><span class="p">,</span><span class="n">ucell</span><span class="p">,</span><span class="n">vcell</span><span class="p">,</span><span class="n">na_u</span><span class="p">,</span><span class="n">isa</span><span class="p">,</span><span class="n">iza</span><span class="p">,</span><span class="n">xa</span><span class="p">,</span><span class="n">va</span><span class="p">,</span><span class="n">foundxv</span><span class="p">)</span>
      <span class="k">end if</span>  

<span class="c">!     Actualize things if variable cell </span>
      <span class="n">auxchanged</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
      <span class="n">cell_can_change</span> <span class="o">=</span> <span class="p">(</span> <span class="n">varcel</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>
     <span class="p">&amp;</span>                    <span class="p">(</span><span class="n">idyn</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">8</span><span class="p">)</span>  <span class="c">! Force/stress evaluation</span>
     <span class="p">&amp;</span>                  <span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">change_kgrid_in_md</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         </span><span class="n">cell_can_change</span> <span class="o">=</span> <span class="n">cell_can_change</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>
     <span class="p">&amp;</span>                     <span class="p">(</span><span class="n">idyn</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">3</span><span class="p">)</span>   <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="c">! Parrinello-Rahman</span>
     <span class="p">&amp;</span>                     <span class="p">(</span><span class="n">idyn</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">4</span><span class="p">)</span>   <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="c">! Nose-Parrinello-Rahman</span>
     <span class="p">&amp;</span>                     <span class="p">(</span><span class="n">idyn</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">5</span><span class="p">)</span>        <span class="c">! Anneal</span>
      <span class="n">endif</span>

      <span class="k">if</span> <span class="p">(</span> <span class="n">cell_can_change</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>
     <span class="p">&amp;</span>     <span class="p">(</span><span class="n">istep</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">inicoor</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="nb">gamma</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>

<span class="c">!       Will print k-points also</span>
        <span class="k">call </span><span class="n">setup_Kpoint_grid</span><span class="p">(</span> <span class="n">ucell</span> <span class="p">)</span>

        <span class="k">call </span><span class="n">setup_ts_kpoint_grid</span><span class="p">(</span> <span class="n">ucell</span> <span class="p">)</span>

        <span class="k">call </span><span class="n">re_alloc</span><span class="p">(</span> <span class="n">eo</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">spinor</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nkpnt</span><span class="p">,</span> <span class="s1">&#39;eo&#39;</span><span class="p">,</span>
     <span class="p">&amp;</span>                 <span class="s1">&#39;state_init&#39;</span><span class="p">)</span>
        <span class="k">call </span><span class="n">re_alloc</span><span class="p">(</span> <span class="n">qo</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">spinor</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nkpnt</span><span class="p">,</span> <span class="s1">&#39;qo&#39;</span><span class="p">,</span>
     <span class="p">&amp;</span>                 <span class="s1">&#39;state_init&#39;</span> <span class="p">)</span>

<span class="c">!       Find required supercell</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">gamma</span><span class="p">)</span> <span class="k">then</span>
<span class="k">           </span><span class="n">nsc</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else if</span> <span class="p">(</span><span class="n">fixauxcell</span><span class="p">)</span> <span class="k">then</span>
<span class="k">           </span><span class="n">nsc</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">nscold</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span>
        <span class="k">else</span>
<span class="k">           do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="mi">3</span>
              <span class="n">veclen</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="n">ucell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">ucell</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">ucell</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
              <span class="n">nsc</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">ceiling</span><span class="p">(</span> <span class="n">rmaxh</span> <span class="o">/</span> <span class="n">veclen</span> <span class="p">)</span>
           <span class="k">end do</span>
<span class="k">           if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">naiveauxcell</span> <span class="p">)</span>
     <span class="p">&amp;</span>          <span class="k">call </span><span class="n">exact_sc_ag</span><span class="p">(</span><span class="n">negl</span><span class="p">,</span><span class="n">ucell</span><span class="p">,</span><span class="n">na_u</span><span class="p">,</span><span class="n">isa</span><span class="p">,</span><span class="n">xa</span><span class="p">,</span><span class="n">nsc</span><span class="p">)</span>
        <span class="n">endif</span>

        <span class="n">mscell</span> <span class="o">=</span> <span class="mf">0.0_dp</span>
        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span>
           <span class="n">mscell</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">nsc</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
           <span class="k">if</span> <span class="p">(</span><span class="n">nsc</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">/=</span> <span class="n">nscold</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="n">auxchanged</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
           <span class="n">nscold</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">nsc</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">enddo</span>

<span class="c">!       Madelung correction for charged systems </span>
        <span class="k">if</span> <span class="p">(</span><span class="n">charnet</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mf">0.0_dp</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          call </span><span class="n">madelung</span><span class="p">(</span><span class="n">ucell</span><span class="p">,</span> <span class="nb">shape</span><span class="p">,</span> <span class="n">charnet</span><span class="p">,</span> <span class="n">Emad</span><span class="p">)</span>
        <span class="n">endif</span>

      <span class="n">endif</span>
<span class="c">!     End variable cell actualization</span>

<span class="c">!     Auxiliary supercell</span>
<span class="c">!     Do not move from here, as the coordinates might have changed</span>
<span class="c">!     even if not the unit cell</span>
      <span class="k">call </span><span class="n">superc</span><span class="p">(</span><span class="n">ucell</span><span class="p">,</span> <span class="n">scell</span><span class="p">,</span> <span class="n">nsc</span><span class="p">)</span>
<span class="cp">#ifdef SIESTA__FLOOK</span>
      <span class="k">call </span><span class="n">dict_repopulate_MD</span><span class="p">()</span>
<span class="cp">#endif</span>

<span class="c">!     Print unit cell and compute cell volume</span>
<span class="c">!     Possible BUG: </span>
<span class="c">!     Note that this volume is later used in write_subs and the md output</span>
<span class="c">!     routines, even if the cell later changes.</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">IOnode</span><span class="p">)</span> <span class="k">call </span><span class="n">outcell</span><span class="p">(</span><span class="n">ucell</span><span class="p">)</span>
      <span class="n">volume_of_some_cell</span> <span class="o">=</span> <span class="n">volcel</span><span class="p">(</span><span class="n">ucell</span><span class="p">)</span>

<span class="c">!     Use largest possible range in program, except hsparse...</span>
<span class="c">!     2 * rmaxv: Vna overlap</span>
<span class="c">!     rmaxo + rmaxkb: Non-local KB action</span>
<span class="c">!     2 * (rmaxo + rmaxldau): Interaction through LDAU projector</span>
<span class="c">!     2.0_dp * (rmaxo+rmaxkb) : Orbital interaction through KB projectors</span>
      <span class="n">rmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span> <span class="mf">2._dp</span><span class="o">*</span><span class="n">rmaxv</span><span class="p">,</span> <span class="mf">2._dp</span><span class="o">*</span><span class="p">(</span><span class="n">rmaxo</span><span class="o">+</span><span class="n">rmaxldau</span><span class="p">),</span> <span class="n">rmaxo</span><span class="o">+</span><span class="n">rmaxkb</span><span class="p">)</span>

      <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">negl</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">        </span><span class="n">rmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">rmax</span><span class="p">,</span> <span class="mf">2.0_dp</span> <span class="o">*</span> <span class="p">(</span><span class="n">rmaxo</span><span class="o">+</span><span class="n">rmaxkb</span><span class="p">)</span> <span class="p">)</span>
      <span class="n">endif</span>

<span class="c">!     Check if any two atoms are unreasonably close</span>
      <span class="k">call </span><span class="n">proximity_check</span><span class="p">(</span><span class="n">rmax</span><span class="p">)</span>

      <span class="c">! Clear history of mixing parameters</span>
      <span class="k">call </span><span class="n">mixers_history_init</span><span class="p">(</span> <span class="n">scf_mixs</span> <span class="p">)</span>
      <span class="n">scf_mix</span> <span class="o">=&gt;</span> <span class="n">scf_mixs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

      <span class="c">! Ensure sparsity pattern is empty</span>
      <span class="k">call </span><span class="n">delete</span><span class="p">(</span><span class="n">sparse_pattern</span><span class="p">)</span>
      <span class="c">! sadly deleting the sparse pattern does not necessarily</span>
      <span class="c">! mean that the arrays are de-associated.</span>
      <span class="c">! Remember that the reference counter could (in MD)</span>
      <span class="c">! be higher than 1, hence we need to create &quot;fake&quot;</span>
      <span class="c">! containers and let the new&lt;class&gt; delete the old</span>
      <span class="c">! sparsity pattern</span>
      <span class="k">nullify</span><span class="p">(</span><span class="n">numh</span><span class="p">,</span><span class="n">listhptr</span><span class="p">,</span><span class="n">listh</span><span class="p">)</span>
      <span class="k">allocate</span><span class="p">(</span><span class="n">numh</span><span class="p">(</span><span class="n">no_l</span><span class="p">),</span><span class="n">listhptr</span><span class="p">(</span><span class="n">no_l</span><span class="p">))</span>
      <span class="c">! We do not need to allocate listh</span>
      <span class="c">! that will be allocated in hsparse</span>

<span class="cp">#ifdef SIESTA__CHESS</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">isolve</span> <span class="o">==</span> <span class="n">SOLVE_CHESS</span><span class="p">)</span> <span class="k">then</span>
<span class="c">!         Calculate a sparsity pattern with some buffers... Only required</span>
<span class="c">!         for CheSS</span>
          <span class="n">chess_value</span> <span class="o">=</span> <span class="n">get_chess_parameter</span><span class="p">(</span><span class="s1">&#39;chess_buffer_kernel&#39;</span><span class="p">)</span>
          <span class="k">call </span><span class="n">hsparse</span><span class="p">(</span> <span class="n">negl</span><span class="p">,</span> <span class="n">scell</span><span class="p">,</span> <span class="n">nsc</span><span class="p">,</span> <span class="n">na_s</span><span class="p">,</span> <span class="n">isa</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span>
     <span class="p">&amp;</span>              <span class="n">lastkb</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span> <span class="n">iphKB</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="nb">gamma</span><span class="p">,</span> 
     <span class="p">&amp;</span>              <span class="n">set_xijo</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.,</span> <span class="n">folding</span><span class="o">=</span><span class="n">folding1</span><span class="p">,</span>
     <span class="err">$</span>              <span class="n">buffer</span><span class="o">=</span><span class="n">chess_value</span><span class="p">)</span>
          <span class="n">maxnh_kernel</span> <span class="o">=</span> <span class="n">maxnh</span>
          <span class="n">no_l_kernel</span> <span class="o">=</span> <span class="n">no_l</span>
          <span class="k">allocate</span><span class="p">(</span><span class="n">listh_kernel</span><span class="p">(</span><span class="n">maxnh_kernel</span><span class="p">))</span>
          <span class="k">allocate</span><span class="p">(</span><span class="n">numh_kernel</span><span class="p">(</span><span class="n">no_l_kernel</span><span class="p">))</span>
          <span class="n">listh_kernel</span> <span class="o">=</span> <span class="n">listh</span>
          <span class="n">numh_kernel</span> <span class="o">=</span> <span class="n">numh</span>
    
          <span class="n">chess_value</span> <span class="o">=</span> <span class="n">get_chess_parameter</span><span class="p">(</span><span class="s1">&#39;chess_buffer_mult&#39;</span><span class="p">)</span>
          <span class="k">call </span><span class="n">hsparse</span><span class="p">(</span> <span class="n">negl</span><span class="p">,</span> <span class="n">scell</span><span class="p">,</span> <span class="n">nsc</span><span class="p">,</span> <span class="n">na_s</span><span class="p">,</span> <span class="n">isa</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span>
     <span class="p">&amp;</span>                  <span class="n">lastkb</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span> <span class="n">iphKB</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="nb">gamma</span><span class="p">,</span>
     <span class="p">&amp;</span>                  <span class="n">set_xijo</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.,</span> <span class="n">folding</span><span class="o">=</span><span class="n">folding1</span><span class="p">,</span>
     <span class="err">$</span>                  <span class="n">buffer</span><span class="o">=</span><span class="n">chess_value</span><span class="p">)</span>
          <span class="n">maxnh_mult</span> <span class="o">=</span> <span class="n">maxnh</span>
          <span class="n">no_l_mult</span> <span class="o">=</span> <span class="n">no_l</span>
          <span class="k">allocate</span><span class="p">(</span><span class="n">listh_mult</span><span class="p">(</span><span class="n">maxnh_mult</span><span class="p">))</span>
          <span class="k">allocate</span><span class="p">(</span><span class="n">numh_mult</span><span class="p">(</span><span class="n">no_l_mult</span><span class="p">))</span>
          <span class="n">listh_mult</span> <span class="o">=</span> <span class="n">listh</span>
          <span class="n">numh_mult</span> <span class="o">=</span> <span class="n">numh</span>
      <span class="k">end if</span>
<span class="cp">#endif /* CHESS */</span>

<span class="c">!     List of nonzero Hamiltonian matrix elements</span>
<span class="c">!     and, if applicable,  vectors between orbital centers</span>

<span class="c">!     Listh and xijo are allocated inside hsparse</span>
<span class="c">!     Note: We always generate xijo now, for COOP and other</span>
<span class="c">!           analyses.</span>
      <span class="k">call </span><span class="n">delete</span><span class="p">(</span><span class="n">xij_2D</span><span class="p">)</span> <span class="c">! as xijo will be reallocated</span>
      <span class="k">nullify</span><span class="p">(</span><span class="n">xijo</span><span class="p">)</span>
      <span class="k">call </span><span class="n">hsparse</span><span class="p">(</span> <span class="n">negl</span><span class="p">,</span> <span class="n">scell</span><span class="p">,</span> <span class="n">nsc</span><span class="p">,</span> <span class="n">na_s</span><span class="p">,</span> <span class="n">isa</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span>
     <span class="p">&amp;</span>              <span class="n">lastkb</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span> <span class="n">iphKB</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="nb">gamma</span><span class="p">,</span>
     <span class="err">$</span>              <span class="n">set_xijo</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.,</span> <span class="n">folding</span><span class="o">=</span><span class="n">folding1</span><span class="p">)</span>
<span class="c">!</span>
<span class="cp">#ifdef SIESTA__CHESS</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">isolve</span> <span class="o">==</span> <span class="n">SOLVE_CHESS</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          call </span><span class="n">CheSS_init</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">nodes</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">maxnh_kernel</span><span class="p">,</span> <span class="n">maxnh_mult</span><span class="p">,</span> 
     <span class="p">&amp;</span>         <span class="n">no_u</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">no_l_kernel</span><span class="p">,</span> <span class="n">no_l_mult</span><span class="p">,</span> <span class="n">BlockSize</span><span class="p">,</span> 
     <span class="p">&amp;</span>         <span class="n">spin</span><span class="p">%</span><span class="n">spinor</span><span class="p">,</span> <span class="n">qtots</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">listh_kernel</span><span class="p">,</span> <span class="n">listh_mult</span><span class="p">,</span> 
     <span class="p">&amp;</span>         <span class="n">numh</span><span class="p">,</span> <span class="n">numh_kernel</span><span class="p">,</span> <span class="n">numh_mult</span><span class="p">)</span>
          <span class="k">deallocate</span><span class="p">(</span><span class="n">listh_kernel</span><span class="p">)</span>
          <span class="k">deallocate</span><span class="p">(</span><span class="n">numh_kernel</span><span class="p">)</span>
          <span class="k">deallocate</span><span class="p">(</span><span class="n">listh_mult</span><span class="p">)</span>
          <span class="k">deallocate</span><span class="p">(</span><span class="n">numh_mult</span><span class="p">)</span>
      <span class="k">end if</span>
<span class="cp">#endif /* CHESS */</span>
      <span class="k">call </span><span class="n">globalize_or</span><span class="p">(</span><span class="n">folding1</span><span class="p">,</span><span class="n">folding</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">folding</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         if</span> <span class="p">(</span><span class="n">IOnode</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            print</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;Folding of H and S is implicitly performed&quot;</span>
         <span class="n">endif</span>
      <span class="n">endif</span>
      <span class="c">!</span>
      <span class="c">! If using domain decomposition, redistribute orbitals</span>
      <span class="c">! for this geometry, based on the hsparse info. </span>
      <span class="c">! The first time round, the initial distribution is a</span>
      <span class="c">! simple block one (given by preSetOrbitLimits).</span>
      <span class="c">!</span>
      <span class="c">! Any DM, etc, read from file will be redistributed according</span>
      <span class="c">! to the new pattern. </span>
      <span class="c">! Inherited DMs from a previous geometry cannot be used if the</span>
      <span class="c">! orbital distribution changes. For now, we avoid changing the</span>
      <span class="c">! distribution (the variable use_dd_perm is .true. if domain</span>
      <span class="c">! decomposition is in effect). Names should be changed...</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">use_dd</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">use_dd_perm</span><span class="p">))</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">domainDecom</span><span class="p">(</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">maxnh</span> <span class="p">)</span>  <span class="c">! maxnh intent(in) here</span>
         <span class="n">maxnh</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">numh</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">no_l</span><span class="p">))</span>
         <span class="c">! We still need to re-create Julian Gale&#39;s</span>
         <span class="c">! indexing for O(N) in parallel.</span>
         <span class="k">print</span> <span class="s2">&quot;(a5,i3,a20,3i8)&quot;</span><span class="p">,</span>
     <span class="err">$</span>         <span class="s2">&quot;Node: &quot;</span><span class="p">,</span> <span class="n">Node</span><span class="p">,</span> <span class="s2">&quot;no_u, no_l, maxnh: &quot;</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">maxnh</span>
         <span class="k">call </span><span class="n">setup_ordern_indexes</span><span class="p">(</span><span class="n">no_l</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">Nodes</span><span class="p">)</span>
      <span class="n">endif</span>

      <span class="c">! I would like to skip this alloc/move/dealloc/attach</span>
      <span class="c">! by allowing sparsity to have pointer targets.</span>
      <span class="c">! However, this poses a problem with intel compilers,</span>
      <span class="c">! as it apparently errors out when de-allocating a target pointer</span>
      <span class="k">write</span><span class="p">(</span><span class="n">oname</span><span class="p">,</span><span class="s2">&quot;(a,i0)&quot;</span><span class="p">)</span> <span class="s2">&quot;sparsity for geom step &quot;</span><span class="p">,</span> <span class="n">istep</span>
      <span class="k">call </span><span class="n">newSparsity</span><span class="p">(</span><span class="n">sparse_pattern</span><span class="p">,</span><span class="n">no_l</span><span class="p">,</span><span class="n">no_u</span><span class="p">,</span><span class="n">maxnh</span><span class="p">,</span>
     <span class="p">&amp;</span>     <span class="n">numh</span><span class="p">,</span><span class="n">listhptr</span><span class="p">,</span><span class="n">listh</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="n">oname</span><span class="p">)</span>
      <span class="k">deallocate</span><span class="p">(</span><span class="n">numh</span><span class="p">,</span><span class="n">listhptr</span><span class="p">,</span><span class="n">listh</span><span class="p">)</span>
      <span class="k">call </span><span class="n">attach</span><span class="p">(</span><span class="n">sparse_pattern</span><span class="p">,</span> 
     <span class="p">&amp;</span>     <span class="n">n_col</span> <span class="o">=</span> <span class="n">numh</span><span class="p">,</span> <span class="n">list_ptr</span> <span class="o">=</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">list_col</span> <span class="o">=</span> <span class="n">listh</span> <span class="p">)</span>

      <span class="c">! In case the user requests to create the connectivity graph</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">write_GRAPHVIZ</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">then</span>
         <span class="c">! first create the unit-cell sparsity pattern</span>
         <span class="k">call </span><span class="n">crtSparsity_SC</span><span class="p">(</span><span class="n">sparse_pattern</span><span class="p">,</span> <span class="n">g_Sp</span><span class="p">,</span> <span class="n">UC</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
         <span class="c">! next move to global sparsity pattern</span>
         <span class="k">call </span><span class="n">Sp_to_Spglobal</span><span class="p">(</span><span class="n">block_dist</span><span class="p">,</span> <span class="n">g_Sp</span><span class="p">,</span> <span class="n">g_Sp</span><span class="p">)</span>
         <span class="k">if</span> <span class="p">(</span> <span class="n">IONode</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            if</span> <span class="p">(</span> <span class="n">write_GRAPHVIZ</span> <span class="o">/=</span> <span class="mi">2</span> <span class="p">)</span>
     <span class="p">&amp;</span>           <span class="k">call </span><span class="n">sp2graphviz</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.ORB.gv&#39;</span><span class="p">,</span> <span class="n">g_Sp</span><span class="p">)</span>
            <span class="c">! Convert to atomic </span>
            <span class="k">if</span> <span class="p">(</span> <span class="n">write_GRAPHVIZ</span> <span class="o">/=</span> <span class="mi">1</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">               call </span><span class="n">SpOrb_to_SpAtom</span><span class="p">(</span><span class="n">single_dist</span><span class="p">,</span><span class="n">g_Sp</span><span class="p">,</span><span class="n">na_u</span><span class="p">,</span><span class="n">lasto</span><span class="p">,</span><span class="n">g_Sp</span><span class="p">)</span>
               <span class="k">call </span><span class="n">sp2graphviz</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.ATOM.gv&#39;</span><span class="p">,</span> <span class="n">g_Sp</span><span class="p">)</span>
            <span class="k">end if</span>
<span class="k">         end if</span>
<span class="k">         call </span><span class="n">delete</span><span class="p">(</span><span class="n">g_Sp</span><span class="p">)</span>
      <span class="k">end if</span>

             
      <span class="c">! Copy over xijo array (we can first do it here... :( )</span>
      <span class="k">call </span><span class="n">newdData2D</span><span class="p">(</span><span class="n">tmp_2D</span><span class="p">,</span><span class="n">xijo</span><span class="p">,</span><span class="s1">&#39;xijo&#39;</span><span class="p">)</span>
      <span class="k">deallocate</span><span class="p">(</span><span class="n">xijo</span><span class="p">)</span>
      <span class="k">write</span><span class="p">(</span><span class="n">oname</span><span class="p">,</span><span class="s2">&quot;(a,i0)&quot;</span><span class="p">)</span> <span class="s2">&quot;xijo at geom step &quot;</span><span class="p">,</span> <span class="n">istep</span>
      <span class="k">call </span><span class="n">newdSpData2D</span><span class="p">(</span><span class="n">sparse_pattern</span><span class="p">,</span><span class="n">tmp_2D</span><span class="p">,</span><span class="n">block_dist</span><span class="p">,</span><span class="n">xij_2D</span><span class="p">,</span> 
     <span class="p">&amp;</span>     <span class="n">name</span><span class="o">=</span><span class="n">oname</span><span class="p">)</span>
      <span class="k">call </span><span class="n">delete</span><span class="p">(</span><span class="n">tmp_2D</span><span class="p">)</span> <span class="c">! decrement container...</span>
      <span class="n">xijo</span> <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">xij_2D</span><span class="p">)</span>

      <span class="c">! Calculate the super-cell offsets...</span>
      <span class="k">if</span> <span class="p">(</span> <span class="nb">Gamma</span> <span class="p">)</span> <span class="k">then</span>
         <span class="c">! Here we create the super-cell offsets</span>
         <span class="k">call </span><span class="n">re_alloc</span><span class="p">(</span><span class="n">isc_off</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">isc_off</span><span class="p">(:,:)</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="k">else</span>
<span class="k">         call </span><span class="n">xij_offset</span><span class="p">(</span><span class="n">ucell</span><span class="p">,</span><span class="n">nsc</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span><span class="n">xa</span><span class="p">,</span><span class="n">lasto</span><span class="p">,</span> 
     <span class="p">&amp;</span>        <span class="n">xij_2D</span><span class="p">,</span> <span class="n">isc_off</span><span class="p">,</span>
     <span class="p">&amp;</span>        <span class="n">Bcast</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
      <span class="k">end if</span>

      
      <span class="c">! When the user requests to only do an analyzation, we can call</span>
      <span class="c">! appropriate routines and quit</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">TS_Analyze</span> <span class="p">)</span> <span class="k">then</span>

         <span class="c">! Force the creation of the full sparsity pattern</span>
         <span class="k">call </span><span class="n">ts_sparse_init</span><span class="p">(</span><span class="n">slabel</span><span class="p">,</span><span class="n">IsVolt</span><span class="p">,</span> <span class="n">N_Elec</span><span class="p">,</span> <span class="n">Elecs</span><span class="p">,</span> 
     <span class="p">&amp;</span>        <span class="n">ucell</span><span class="p">,</span> <span class="n">nsc</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span> <span class="n">block_dist</span><span class="p">,</span> <span class="n">sparse_pattern</span><span class="p">,</span> 
     <span class="p">&amp;</span>        <span class="nb">Gamma</span><span class="p">,</span> <span class="n">isc_off</span><span class="p">)</span>

         <span class="c">! create the tri-diagonal matrix</span>
         <span class="k">call </span><span class="n">ts_tri_analyze</span><span class="p">(</span> <span class="n">block_dist</span><span class="p">,</span> <span class="n">sparse_pattern</span> <span class="p">,</span> <span class="n">N_Elec</span><span class="p">,</span>
     <span class="p">&amp;</span>        <span class="n">Elecs</span><span class="p">,</span> <span class="n">ucell</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span> <span class="n">nsc</span><span class="p">,</span> <span class="n">isc_off</span><span class="p">,</span>
     <span class="p">&amp;</span>        <span class="n">BTD_method</span> <span class="p">)</span>

         <span class="c">! Print-out timers</span>
         <span class="k">call </span><span class="n">timer</span><span class="p">(</span><span class="s1">&#39;TS-rgn2tri&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>

         <span class="c">! Bye also waits for all processors</span>
         <span class="k">call </span><span class="n">bye</span><span class="p">(</span><span class="s1">&#39;transiesta analyzation performed&#39;</span><span class="p">)</span>
         
      <span class="k">end if</span>


<span class="k">      write</span><span class="p">(</span><span class="n">oname</span><span class="p">,</span><span class="s2">&quot;(a,i0)&quot;</span><span class="p">)</span> <span class="s2">&quot;EDM at geom step &quot;</span><span class="p">,</span> <span class="n">istep</span>
      <span class="k">call </span><span class="n">newdSpData2D</span><span class="p">(</span><span class="n">sparse_pattern</span><span class="p">,</span><span class="n">spin</span><span class="p">%</span><span class="n">EDM</span><span class="p">,</span><span class="n">block_dist</span><span class="p">,</span><span class="n">EDM_2D</span><span class="p">,</span>
     <span class="p">&amp;</span>     <span class="n">name</span><span class="o">=</span><span class="n">oname</span><span class="p">)</span>
      <span class="c">!if (ionode) call print_type(EDM_2D)</span>
      <span class="n">Escf</span> <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">EDM_2D</span><span class="p">)</span>

      <span class="k">call </span><span class="n">re_alloc</span><span class="p">(</span><span class="n">Dold</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">maxnh</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">spin</span><span class="p">%</span><span class="n">DM</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Dold&#39;</span><span class="p">,</span>
     <span class="p">.</span>     <span class="n">routine</span><span class="o">=</span><span class="s1">&#39;sparseMat&#39;</span><span class="p">,</span><span class="n">copy</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span><span class="n">shrink</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
      <span class="k">call </span><span class="n">re_alloc</span><span class="p">(</span><span class="n">Hold</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">maxnh</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Hold&#39;</span><span class="p">,</span>
     <span class="p">.</span>     <span class="n">routine</span><span class="o">=</span><span class="s1">&#39;sparseMat&#39;</span><span class="p">,</span><span class="n">copy</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span><span class="n">shrink</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">converge_EDM</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">re_alloc</span><span class="p">(</span><span class="n">Eold</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">maxnh</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">spin</span><span class="p">%</span><span class="n">EDM</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Eold&#39;</span><span class="p">,</span>
     <span class="p">.</span>     <span class="n">routine</span><span class="o">=</span><span class="s1">&#39;sparseMat&#39;</span><span class="p">,</span><span class="n">copy</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span><span class="n">shrink</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
      <span class="k">end if</span>

<span class="c">!     Allocate/reallocate storage associated with Hamiltonian/Overlap matrix</span>
      <span class="k">write</span><span class="p">(</span><span class="n">oname</span><span class="p">,</span><span class="s2">&quot;(a,i0)&quot;</span><span class="p">)</span> <span class="s2">&quot;H at geom step &quot;</span><span class="p">,</span> <span class="n">istep</span>
      <span class="k">call </span><span class="n">newdSpData2D</span><span class="p">(</span><span class="n">sparse_pattern</span><span class="p">,</span><span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span><span class="n">block_dist</span><span class="p">,</span><span class="n">H_2D</span><span class="p">,</span>
     <span class="p">&amp;</span>                  <span class="n">name</span><span class="o">=</span><span class="n">oname</span><span class="p">)</span>
      <span class="c">!if (ionode) call print_type(H_2D)</span>
      <span class="n">H</span> <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">H_2D</span><span class="p">)</span>

      <span class="k">write</span><span class="p">(</span><span class="n">oname</span><span class="p">,</span><span class="s2">&quot;(a,i0)&quot;</span><span class="p">)</span> <span class="s2">&quot;H_vkb at geom step &quot;</span><span class="p">,</span> <span class="n">istep</span>
      <span class="k">call </span><span class="n">newdSpData1D</span><span class="p">(</span><span class="n">sparse_pattern</span><span class="p">,</span><span class="n">block_dist</span><span class="p">,</span><span class="n">H_vkb_1D</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="n">oname</span><span class="p">)</span>
      <span class="c">!if (ionode) call print_type(H_vkb_1D)</span>

      <span class="k">write</span><span class="p">(</span><span class="n">oname</span><span class="p">,</span><span class="s2">&quot;(a,i0)&quot;</span><span class="p">)</span> <span class="s2">&quot;H_kin at geom step &quot;</span><span class="p">,</span> <span class="n">istep</span>
      <span class="k">call </span><span class="n">newdSpData1D</span><span class="p">(</span><span class="n">sparse_pattern</span><span class="p">,</span><span class="n">block_dist</span><span class="p">,</span><span class="n">H_kin_1D</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="n">oname</span><span class="p">)</span>
      <span class="c">!if (ionode) call print_type(H_kin_1D)</span>

      <span class="k">if</span> <span class="p">(</span> <span class="n">switch_ldau</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">         write</span><span class="p">(</span><span class="n">oname</span><span class="p">,</span><span class="s2">&quot;(a,i0)&quot;</span><span class="p">)</span> <span class="s2">&quot;H_ldau at geom step &quot;</span><span class="p">,</span> <span class="n">istep</span>
         <span class="k">call </span><span class="n">newdSpData2D</span><span class="p">(</span><span class="n">sparse_pattern</span><span class="p">,</span><span class="n">spin</span><span class="p">%</span><span class="n">spinor</span><span class="p">,</span>
     <span class="p">&amp;</span>        <span class="n">block_dist</span><span class="p">,</span><span class="n">H_ldau_2D</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="n">oname</span><span class="p">)</span>
         
         <span class="c">! Initialize to 0, LDA+U may re-calculate</span>
         <span class="c">!   this matrix sporadically doing the SCF.</span>
         <span class="c">! Hence initialization MUST be performed upon</span>
         <span class="c">! re-allocation.</span>
         <span class="k">call </span><span class="n">init_val</span><span class="p">(</span><span class="n">H_ldau_2D</span><span class="p">)</span>
         <span class="k">if</span> <span class="p">(</span> <span class="n">inicoor</span> <span class="o">/=</span> <span class="n">istep</span> <span class="p">)</span> <span class="k">then</span>
            <span class="c">! Force initialization of the LDA+U</span>
            <span class="c">! when changing geometry</span>
            <span class="c">! For the first geometry this is controlled</span>
            <span class="c">! by the user via an fdf-key</span>
            <span class="n">ldau_init</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
         <span class="k">end if</span>
<span class="k">      end if</span>
<span class="k">      </span>
<span class="k">      if</span> <span class="p">(</span> <span class="n">spin</span><span class="p">%</span><span class="n">SO</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">         write</span><span class="p">(</span><span class="n">oname</span><span class="p">,</span><span class="s2">&quot;(a,i0)&quot;</span><span class="p">)</span> <span class="s2">&quot;H_so at geom step &quot;</span><span class="p">,</span> <span class="n">istep</span>
         <span class="k">call </span><span class="n">newdSpData2D</span><span class="p">(</span><span class="n">sparse_pattern</span><span class="p">,</span><span class="n">spin</span><span class="p">%</span><span class="n">H</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span>
     <span class="p">&amp;</span>        <span class="n">block_dist</span><span class="p">,</span><span class="n">H_so_2D</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="n">oname</span><span class="p">)</span>
      <span class="k">end if</span>

<span class="k">      write</span><span class="p">(</span><span class="n">oname</span><span class="p">,</span><span class="s2">&quot;(a,i0)&quot;</span><span class="p">)</span> <span class="s2">&quot;S at geom step &quot;</span><span class="p">,</span> <span class="n">istep</span>
      <span class="k">call </span><span class="n">newdSpData1D</span><span class="p">(</span><span class="n">sparse_pattern</span><span class="p">,</span><span class="n">block_dist</span><span class="p">,</span><span class="n">S_1D</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="n">oname</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">ionode</span><span class="p">)</span> <span class="k">call </span><span class="n">print_type</span><span class="p">(</span><span class="n">S_1D</span><span class="p">)</span>
      <span class="n">S</span> <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">S_1D</span><span class="p">)</span>

<span class="c">!     Find overlap matrix </span>
      <span class="k">call </span><span class="n">overlap</span><span class="p">(</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">na_s</span><span class="p">,</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">scell</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">indxua</span><span class="p">,</span> <span class="n">rmaxo</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span>
     <span class="p">&amp;</span>              <span class="n">lasto</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span> <span class="n">isa</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">S</span> <span class="p">)</span>


<span class="c">!</span>
<span class="c">!     Here we could also read a Hamiltonian, either to proceed to</span>
<span class="c">!     the analysis section (with nscf=0) or to start a mix-H scf cycle.</span>
<span class="c">!</span>
<span class="c">!     Initialize density matrix</span>
      <span class="c">! The resizing of Dscf is done inside new_dm</span>
      <span class="k">call </span><span class="n">new_DM</span><span class="p">(</span><span class="n">auxchanged</span><span class="p">,</span> <span class="n">DM_history</span><span class="p">,</span> <span class="n">DM_2D</span><span class="p">,</span> <span class="n">EDM_2D</span><span class="p">)</span>
      <span class="n">Dscf</span> <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">DM_2D</span><span class="p">)</span>
      <span class="n">Escf</span> <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">EDM_2D</span><span class="p">)</span>

      <span class="c">! Initialize energy-density matrix to zero for first call to overfsm</span>
      <span class="c">! Only part of Escf is updated in TS, so if it is put as zero here</span>
      <span class="c">! a continuation run gives bad forces.</span>
      <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">TSrun</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">normalize_DM</span><span class="p">(</span> <span class="n">first</span><span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span> <span class="p">)</span>
<span class="c">!$OMP parallel workshare default(shared)</span>
         <span class="n">Escf</span><span class="p">(:,:)</span> <span class="o">=</span> <span class="mf">0.0_dp</span>
<span class="c">!$OMP end parallel workshare</span>
      <span class="k">end if</span>

<span class="cp">#ifdef TEST_IO</span>
      <span class="c">! We test the io-performance here</span>
      <span class="k">call </span><span class="n">time_io</span><span class="p">(</span><span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span><span class="n">H_2D</span><span class="p">)</span>
<span class="cp">#endif</span>

<span class="c">!     If onlyS, Save overlap matrix and exit</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">onlyS</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">         </span><span class="n">fname</span> <span class="o">=</span> <span class="n">fname_TSHS</span><span class="p">(</span><span class="n">slabel</span><span class="p">,</span> <span class="n">onlyS</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span> <span class="p">)</span>
         <span class="c">! We include H as S, well-knowing that we only write one of</span>
         <span class="c">! them, there is no need to allocate space for no reason!</span>
         <span class="k">call </span><span class="n">ts_write_tshs</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> 
     <span class="p">&amp;</span>        <span class="p">.</span><span class="n">true</span><span class="p">.,</span> <span class="nb">Gamma</span><span class="p">,</span> <span class="n">ts_Gamma_file</span><span class="p">,</span>
     <span class="p">&amp;</span>        <span class="n">ucell</span><span class="p">,</span> <span class="n">nsc</span><span class="p">,</span> <span class="n">isc_off</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span>
     <span class="p">&amp;</span>        <span class="n">ts_kscell_file</span><span class="p">,</span> <span class="n">ts_kdispl_file</span><span class="p">,</span>
     <span class="p">&amp;</span>        <span class="n">xa</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span> 
     <span class="p">&amp;</span>        <span class="n">H_2D</span><span class="p">,</span> <span class="n">S_1D</span><span class="p">,</span> <span class="n">indxuo</span><span class="p">,</span> 
     <span class="p">&amp;</span>        <span class="n">dummyEf</span><span class="p">,</span> <span class="n">dummyQtot</span><span class="p">,</span> <span class="n">Temp</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
         <span class="k">call </span><span class="n">bye</span><span class="p">(</span> <span class="s1">&#39;Save overlap matrix and exit&#39;</span> <span class="p">)</span> <span class="c">! Exit siesta</span>
         
      <span class="n">endif</span> 

      <span class="c">! In case the user is requesting a Fermi-correction</span>
      <span class="c">! we need to delete the TS_FERMI file after each iteration</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">TSmode</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">TS_RHOCORR_METHOD</span> <span class="o">==</span> <span class="n">TS_RHOCORR_FERMI</span>
     <span class="p">&amp;</span>     <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">IONode</span> <span class="p">)</span> <span class="k">then</span>
          <span class="c">! Delete the TS_FERMI file (enables</span>
          <span class="c">! reading it in and improve on the convergence)</span>
          <span class="k">if</span> <span class="p">(</span> <span class="n">file_exist</span><span class="p">(</span><span class="s1">&#39;TS_FERMI&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">             </span><span class="n">i</span> <span class="o">=</span> <span class="mi">23455</span> <span class="c">! this should just not be used any were...</span>
             <span class="c">! Delete the file...</span>
             <span class="k">open</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">i</span><span class="p">,</span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;TS_FERMI&#39;</span><span class="p">)</span>
             <span class="k">close</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">status</span><span class="o">=</span><span class="s1">&#39;delete&#39;</span><span class="p">)</span>
          <span class="k">end if</span>
<span class="k">       end if</span>
      
<span class="cp">#ifdef CDF</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">writedm_cdf</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">setup_dm_netcdf_file</span><span class="p">(</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span>
     <span class="p">&amp;</span>                              <span class="n">no_s</span><span class="p">,</span> <span class="n">indxuo</span><span class="p">,</span>
     <span class="p">&amp;</span>                              <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">)</span>
      <span class="n">endif</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">writedm_cdf_history</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">setup_dm_netcdf_file</span><span class="p">(</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span>
     <span class="p">&amp;</span>                              <span class="n">no_s</span><span class="p">,</span> <span class="n">indxuo</span><span class="p">,</span>
     <span class="p">&amp;</span>                              <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span>
     <span class="p">&amp;</span>                              <span class="n">istep</span><span class="p">)</span>
      <span class="n">endif</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">writedmhs_cdf</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">setup_dmhs_netcdf_file</span><span class="p">(</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span>
     <span class="p">&amp;</span>                              <span class="n">no_s</span><span class="p">,</span> <span class="n">indxuo</span><span class="p">,</span>
     <span class="p">&amp;</span>                              <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span>
     <span class="p">&amp;</span>                              <span class="n">s</span><span class="p">)</span>
      <span class="n">endif</span>
      <span class="k">if</span><span class="p">(</span><span class="n">writedmhs_cdf_history</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">setup_dmhs_netcdf_file</span><span class="p">(</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span>
     <span class="p">&amp;</span>                              <span class="n">no_s</span><span class="p">,</span> <span class="n">indxuo</span><span class="p">,</span>
     <span class="p">&amp;</span>                              <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span>
     <span class="p">&amp;</span>                              <span class="n">s</span><span class="p">,</span>
     <span class="p">&amp;</span>                              <span class="n">istep</span><span class="p">)</span>
      <span class="n">endif</span>
<span class="cp">#endif</span>
      <span class="k">call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;state_init&#39;</span><span class="p">,</span> <span class="mi">2</span> <span class="p">)</span>

      <span class="k">END subroutine </span><span class="n">state_init</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>

  <section class="visible-xs visible-sm hidden-md">
    <hr>
    

<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allprocs-1">All Procedures</a></h3></div>
  <div id="allprocs-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../proc/compute_dm.html">compute_dm</a>
      
      <a class="list-group-item" href="../interface/compute_max_diff.html">compute_max_diff</a>
      
      <a class="list-group-item" href="../proc/compute_max_diff_1d.html">compute_max_diff_1d</a>
      
      <a class="list-group-item" href="../proc/compute_max_diff_2d.html">compute_max_diff_2d</a>
      
      <a class="list-group-item" href="../proc/current_itt.html">current_itt</a>
      
      <a class="list-group-item" href="../proc/getstackval.html">getstackval</a>
      
      <a class="list-group-item" href="../proc/inverse.html">inverse</a>
      
      <a class="list-group-item" href="../proc/is_next.html">is_next</a>
      
      <a class="list-group-item" href="../proc/mix_method.html">mix_method</a>
      
      <a class="list-group-item" href="../proc/mix_method_variant.html">mix_method_variant</a>
      
      <a class="list-group-item" href="../proc/mixer_init.html">mixer_init</a>
      
      <a class="list-group-item" href="../proc/mixers_history_init.html">mixers_history_init</a>
      
      <a class="list-group-item" href="../proc/mixers_init.html">mixers_init</a>
      
      <a class="list-group-item" href="../proc/mixers_print.html">mixers_print</a>
      
      <a class="list-group-item" href="../proc/mixers_print_block.html">mixers_print_block</a>
      
      <a class="list-group-item" href="../proc/mixers_reset.html">mixers_reset</a>
      
      <a class="list-group-item" href="../proc/mixers_scf_history_init.html">mixers_scf_history_init</a>
      
      <a class="list-group-item" href="../proc/mixers_scf_init.html">mixers_scf_init</a>
      
      <a class="list-group-item" href="../proc/mixers_scf_print.html">mixers_scf_print</a>
      
      <a class="list-group-item" href="../proc/mixers_scf_print_block.html">mixers_scf_print_block</a>
      
      <a class="list-group-item" href="../proc/mixers_scf_reset.html">mixers_scf_reset</a>
      
      <a class="list-group-item" href="../interface/mixing.html">mixing</a>
      
      <a class="list-group-item" href="../proc/mixing_1d.html">mixing_1d</a>
      
      <a class="list-group-item" href="../proc/mixing_2d.html">mixing_2d</a>
      
      <a class="list-group-item" href="../proc/mixing_calc_next.html">mixing_calc_next</a>
      
      <a class="list-group-item" href="../proc/mixing_coeff.html">mixing_coeff</a>
      
      <a class="list-group-item" href="../proc/mixing_finalize.html">mixing_finalize</a>
      
      <a class="list-group-item" href="../proc/mixing_init.html">mixing_init</a>
      
      <a class="list-group-item" href="../proc/mixing_ncoeff.html">mixing_ncoeff</a>
      
      <a class="list-group-item" href="../proc/mixing_scf_converged.html">mixing_scf_converged</a>
      
      <a class="list-group-item" href="../proc/mixing_step.html">mixing_step</a>
      
      <a class="list-group-item" href="../proc/norm.html">norm</a>
      
      <a class="list-group-item" href="../proc/push_diff.html">push_diff</a>
      
      <a class="list-group-item" href="../proc/push_f.html">push_F</a>
      
      <a class="list-group-item" href="../proc/push_stack_data.html">push_stack_data</a>
      
      <a class="list-group-item" href="../proc/setup_h0.html">setup_H0</a>
      
      <a class="list-group-item" href="../proc/setup_hamiltonian.html">setup_hamiltonian</a>
      
      <a class="list-group-item" href="../proc/siesta_analysis.html">siesta_analysis</a>
      
      <a class="list-group-item" href="../proc/siesta_forces.html">siesta_forces</a>
      
      <a class="list-group-item" href="../proc/stack_check.html">stack_check</a>
      
      <a class="list-group-item" href="../proc/state_analysis.html">state_analysis</a>
      
      <a class="list-group-item" href="../proc/state_init.html">state_init</a>
      
      <a class="list-group-item" href="../proc/svd.html">svd</a>
      
      <a class="list-group-item" href="../proc/update_f.html">update_F</a>
      
    </div>
  </div>
</div>


  </section>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2018 <a rel="license" href="http://www.gnu.org/licenses/old-licenses/fdl-1.2.en.html">GNU Free Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> SIESTA was developed by SIESTA Group</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>