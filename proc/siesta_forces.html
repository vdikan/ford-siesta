<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	 
	 <meta name="description" content="A first-principles materials simulation code using Density Functional Theory.">
    
    <meta name="author" content="SIESTA Group" >
    <link rel="icon" href="../favicon.png">

    <title>siesta_forces &ndash; SIESTA</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">SIESTA <small>trunk-674--vdikan-ford-681</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
				
            <li><a href='../page/index.html'>Program Overview</a></li>
	    
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
		 aria-expanded="false">Contents <span class="caret"></span></a>
	      <ul class="dropdown-menu">
              
            <li><a href="../lists/files.html">Source Files</a></li>
				
				
            <li><a href="../lists/modules.html">Modules</a></li>
				
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
				
								
            <li><a href="../lists/types.html">Derived Types</a></li>
				
				
            </ul>
            </li>

<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>siesta_forces
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
	  data-placement="bottom" data-html="true"
	  title="12.5% of total for procedures.">369 statements</a>
     </li> 
     
     
    <li><i class="fa fa-code"></i><a href="../src/siesta_forces.F90"> Source File</a></li>
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
     <li><a href='../sourcefile/siesta_forces.f90.html'>siesta_forces.F90</a></li>
  
     <li><a href='../module/m_siesta_forces.html'>m_siesta_forces</a></li>
  
     <li class="active">siesta_forces</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  




















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/siesta_forces.html#src">siesta_forces</a>
  </div>
</div>


  <hr>
  

<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allprocs-0">All Procedures</a></h3></div>
  <div id="allprocs-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../proc/compute_dm.html">compute_dm</a>
      
      <a class="list-group-item" href="../interface/compute_max_diff.html">compute_max_diff</a>
      
      <a class="list-group-item" href="../proc/compute_max_diff_1d.html">compute_max_diff_1d</a>
      
      <a class="list-group-item" href="../proc/compute_max_diff_2d.html">compute_max_diff_2d</a>
      
      <a class="list-group-item" href="../proc/current_itt.html">current_itt</a>
      
      <a class="list-group-item" href="../proc/getstackval.html">getstackval</a>
      
      <a class="list-group-item" href="../proc/inverse.html">inverse</a>
      
      <a class="list-group-item" href="../proc/is_next.html">is_next</a>
      
      <a class="list-group-item" href="../proc/mix_method.html">mix_method</a>
      
      <a class="list-group-item" href="../proc/mix_method_variant.html">mix_method_variant</a>
      
      <a class="list-group-item" href="../proc/mixer_init.html">mixer_init</a>
      
      <a class="list-group-item" href="../proc/mixers_history_init.html">mixers_history_init</a>
      
      <a class="list-group-item" href="../proc/mixers_init.html">mixers_init</a>
      
      <a class="list-group-item" href="../proc/mixers_print.html">mixers_print</a>
      
      <a class="list-group-item" href="../proc/mixers_print_block.html">mixers_print_block</a>
      
      <a class="list-group-item" href="../proc/mixers_reset.html">mixers_reset</a>
      
      <a class="list-group-item" href="../proc/mixers_scf_history_init.html">mixers_scf_history_init</a>
      
      <a class="list-group-item" href="../proc/mixers_scf_init.html">mixers_scf_init</a>
      
      <a class="list-group-item" href="../proc/mixers_scf_print.html">mixers_scf_print</a>
      
      <a class="list-group-item" href="../proc/mixers_scf_print_block.html">mixers_scf_print_block</a>
      
      <a class="list-group-item" href="../proc/mixers_scf_reset.html">mixers_scf_reset</a>
      
      <a class="list-group-item" href="../interface/mixing.html">mixing</a>
      
      <a class="list-group-item" href="../proc/mixing_1d.html">mixing_1d</a>
      
      <a class="list-group-item" href="../proc/mixing_2d.html">mixing_2d</a>
      
      <a class="list-group-item" href="../proc/mixing_calc_next.html">mixing_calc_next</a>
      
      <a class="list-group-item" href="../proc/mixing_coeff.html">mixing_coeff</a>
      
      <a class="list-group-item" href="../proc/mixing_finalize.html">mixing_finalize</a>
      
      <a class="list-group-item" href="../proc/mixing_init.html">mixing_init</a>
      
      <a class="list-group-item" href="../proc/mixing_ncoeff.html">mixing_ncoeff</a>
      
      <a class="list-group-item" href="../proc/mixing_scf_converged.html">mixing_scf_converged</a>
      
      <a class="list-group-item" href="../proc/mixing_step.html">mixing_step</a>
      
      <a class="list-group-item" href="../proc/norm.html">norm</a>
      
      <a class="list-group-item" href="../proc/push_diff.html">push_diff</a>
      
      <a class="list-group-item" href="../proc/push_f.html">push_F</a>
      
      <a class="list-group-item" href="../proc/push_stack_data.html">push_stack_data</a>
      
      <a class="list-group-item" href="../proc/setup_h0.html">setup_H0</a>
      
      <a class="list-group-item" href="../proc/setup_hamiltonian.html">setup_hamiltonian</a>
      
      <a class="list-group-item" href="../proc/siesta_analysis.html">siesta_analysis</a>
      
      <a class="list-group-item" href="../proc/siesta_forces.html">siesta_forces</a>
      
      <a class="list-group-item" href="../proc/stack_check.html">stack_check</a>
      
      <a class="list-group-item" href="../proc/state_analysis.html">state_analysis</a>
      
      <a class="list-group-item" href="../proc/state_init.html">state_init</a>
      
      <a class="list-group-item" href="../proc/svd.html">svd</a>
      
      <a class="list-group-item" href="../proc/update_f.html">update_F</a>
      
    </div>
  </div>
</div>


</div>  

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine siesta_forces(istep)
    
    
	 
</h2>
    
  
    <div class="panel panel-default">
      <div class="panel-heading">
	<h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
      
      <li class="list-group-item">
	<ul class="list-inline">
	  
	  <li>units</li>
	  
	  <li>precision</li>
	  
	  <li>sys</li>
	  
	  <li>files</li>
	  
	  <li>siesta_cml</li>
	  
	  <li><a href='../module/m_state_init.html'>m_state_init</a></li>
	  
	  <li><a href='../module/m_setup_hamiltonian.html'>m_setup_hamiltonian</a></li>
	  
	  <li><a href='../module/m_setup_h0.html'>m_setup_H0</a></li>
	  
	  <li><a href='../module/m_compute_dm.html'>m_compute_dm</a></li>
	  
	  <li><a href='../module/m_compute_max_diff.html'>m_compute_max_diff</a></li>
	  
	  <li>m_scfconvergence_test</li>
	  
	  <li>m_post_scf_work</li>
	  
	  <li>m_mixer</li>
	  
	  <li><a href='../module/m_mixing_scf.html'>m_mixing_scf</a></li>
	  
	  <li><a href='../module/m_mixing_scf.html'>m_mixing_scf</a></li>
	  
	  <li><a href='../module/m_mixing_scf.html'>m_mixing_scf</a></li>
	  
	  <li>m_rhog</li>
	  
	  <li>siesta_options</li>
	  
	  <li>parallel</li>
	  
	  <li><a href='../module/m_state_analysis.html'>m_state_analysis</a></li>
	  
	  <li>m_steps</li>
	  
	  <li>m_spin</li>
	  
	  <li>sparse_matrices</li>
	  
	  <li>sparse_matrices</li>
	  
	  <li>m_convergence</li>
	  
	  <li>m_convergence</li>
	  
	  <li>siesta_geom</li>
	  
	  <li>m_energies</li>
	  
	  <li>m_forces</li>
	  
	  <li>m_stress</li>
	  
	  <li>siesta_master</li>
	  
	  <li>siesta_master</li>
	  
	  <li>m_save_density_matrix</li>
	  
	  <li>m_iodm_old</li>
	  
	  <li>atomlist</li>
	  
	  <li>m_dm_charge</li>
	  
	  <li>m_pexsi_solver</li>
	  
	  <li>write_subs</li>
	  
	  <li>write_subs</li>
	  
	  <li>m_compute_energies</li>
	  
	  <li>m_mpi_utils</li>
	  
	  <li>fdf</li>
	  
	  <li>m_check_walltime</li>
	  
	  <li>m_energies</li>
	  
	  <li>m_ts_options</li>
	  
	  <li>m_ts_method</li>
	  
	  <li>m_ts_global_vars</li>
	  
	  <li>siesta_geom</li>
	  
	  <li>sparse_matrices</li>
	  
	  <li>sparse_matrices</li>
	  
	  <li>m_ts_charge</li>
	  
	  <li>m_ts_charge</li>
	  
	  <li>m_ts_charge</li>
	  
	  <li>m_ts_charge</li>
	  
	  <li>m_transiesta</li>
	  
	  <li>kpoint_grid</li>
	  
	  <li>m_energies</li>
	  
	  <li>m_initwf</li>
	  
	</ul>
      </li>
      
      
      
      <li class="list-group-item">
	<div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~siesta_forces~~UsesGraph Pages: 1 -->
<svg id="procsiesta_forcesUsesGraph" width="555pt" height="1826pt"
 viewBox="0.00 0.00 555.00 1826.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~siesta_forces~~UsesGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 1822)">
<title>proc~~siesta_forces~~UsesGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1822 551,-1822 551,4 -4,4"/>
<!-- proc~siesta_forces -->
<g id="proc~~siesta_forces~~UsesGraph_node1" class="node"><title>proc~siesta_forces</title>
<polygon fill="none" stroke="black" points="547,-927 471,-927 471,-903 547,-903 547,-927"/>
<text text-anchor="middle" x="509" y="-912.6" font-family="Helvetica,sans-Serif" font-size="10.50">siesta_forces</text>
</g>
<!-- m_pexsi_solver -->
<g id="proc~~siesta_forces~~UsesGraph_node2" class="node"><title>m_pexsi_solver</title>
<polygon fill="#337ab7" stroke="#337ab7" points="415.5,-1818 328.5,-1818 328.5,-1794 415.5,-1794 415.5,-1818"/>
<text text-anchor="middle" x="372" y="-1803.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_pexsi_solver</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_pexsi_solver -->
<g id="proc~~siesta_forces~~UsesGraph_edge1" class="edge"><title>proc~siesta_forces&#45;&gt;m_pexsi_solver</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.774,-927.178C505.814,-1027.4 490.401,-1714.2 435,-1785 432.125,-1788.67 428.579,-1791.71 424.649,-1794.22"/>
<polygon fill="#000000" stroke="#000000" points="422.835,-1791.21 415.548,-1798.91 426.041,-1797.44 422.835,-1791.21"/>
</g>
<!-- m_scfconvergence_test -->
<g id="proc~~siesta_forces~~UsesGraph_node3" class="node"><title>m_scfconvergence_test</title>
<polygon fill="#337ab7" stroke="#337ab7" points="435,-1776 309,-1776 309,-1752 435,-1752 435,-1776"/>
<text text-anchor="middle" x="372" y="-1761.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_scfconvergence_test</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_scfconvergence_test -->
<g id="proc~~siesta_forces~~UsesGraph_edge2" class="edge"><title>proc~siesta_forces&#45;&gt;m_scfconvergence_test</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.719,-927.202C505.371,-1024.74 487.777,-1675.84 435,-1743 434.401,-1743.76 433.773,-1744.5 433.119,-1745.21"/>
<polygon fill="#000000" stroke="#000000" points="430.635,-1742.72 425.218,-1751.83 435.131,-1748.09 430.635,-1742.72"/>
</g>
<!-- m_ts_options -->
<g id="proc~~siesta_forces~~UsesGraph_node4" class="node"><title>m_ts_options</title>
<polygon fill="#337ab7" stroke="#337ab7" points="410,-1734 334,-1734 334,-1710 410,-1710 410,-1734"/>
<text text-anchor="middle" x="372" y="-1719.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_options</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_ts_options -->
<g id="proc~~siesta_forces~~UsesGraph_edge3" class="edge"><title>proc~siesta_forces&#45;&gt;m_ts_options</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.614,-927.07C504.517,-1020.85 482.611,-1631.17 435,-1696 430.915,-1701.56 425.41,-1705.94 419.358,-1709.39"/>
<polygon fill="#000000" stroke="#000000" points="417.692,-1706.31 410.203,-1713.8 420.731,-1712.61 417.692,-1706.31"/>
</g>
<!-- precision -->
<g id="proc~~siesta_forces~~UsesGraph_node5" class="node"><title>precision</title>
<polygon fill="#337ab7" stroke="#337ab7" points="88.5,-1030 33.5,-1030 33.5,-1006 88.5,-1006 88.5,-1030"/>
<text text-anchor="middle" x="61" y="-1015.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">precision</text>
</g>
<!-- proc~siesta_forces&#45;&gt;precision -->
<g id="proc~~siesta_forces~~UsesGraph_edge4" class="edge"><title>proc~siesta_forces&#45;&gt;precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.777,-927.036C505.948,-1019.23 492.017,-1611.28 435,-1663 331.927,-1756.5 224.248,-1639.38 158,-1517 68.1068,-1350.93 61.4235,-1113.72 61.6471,-1040.43"/>
<polygon fill="#000000" stroke="#000000" points="65.1494,-1040.14 61.7306,-1030.11 58.1497,-1040.08 65.1494,-1040.14"/>
</g>
<!-- units -->
<g id="proc~~siesta_forces~~UsesGraph_node6" class="node"><title>units</title>
<polygon fill="#337ab7" stroke="#337ab7" points="399,-1654 345,-1654 345,-1630 399,-1630 399,-1654"/>
<text text-anchor="middle" x="372" y="-1639.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">units</text>
</g>
<!-- proc~siesta_forces&#45;&gt;units -->
<g id="proc~~siesta_forces~~UsesGraph_edge5" class="edge"><title>proc~siesta_forces&#45;&gt;units</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.53,-927.047C503.974,-1015.63 480.209,-1564.36 435,-1621 428.513,-1629.13 418.743,-1634.13 408.865,-1637.2"/>
<polygon fill="#000000" stroke="#000000" points="407.909,-1633.83 399.069,-1639.67 409.621,-1640.62 407.909,-1633.83"/>
</g>
<!-- module~m_state_analysis -->
<g id="proc~~siesta_forces~~UsesGraph_node7" class="node"><title>module~m_state_analysis</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node7"><a xlink:href=".././module/m_state_analysis.html" xlink:title="m_state_analysis">
<polygon fill="#337ab7" stroke="#337ab7" points="419.5,-1612 324.5,-1612 324.5,-1588 419.5,-1588 419.5,-1612"/>
<text text-anchor="middle" x="372" y="-1597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_state_analysis</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;module~m_state_analysis -->
<g id="proc~~siesta_forces~~UsesGraph_edge6" class="edge"><title>proc~siesta_forces&#45;&gt;module~m_state_analysis</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.443,-927.142C503.406,-1012.95 477.585,-1526 435,-1579 433.098,-1581.37 430.918,-1583.47 428.538,-1585.33"/>
<polygon fill="#000000" stroke="#000000" points="426.409,-1582.54 419.793,-1590.81 430.125,-1588.47 426.409,-1582.54"/>
</g>
<!-- m_iodm_old -->
<g id="proc~~siesta_forces~~UsesGraph_node8" class="node"><title>m_iodm_old</title>
<polygon fill="#337ab7" stroke="#337ab7" points="407.5,-1570 336.5,-1570 336.5,-1546 407.5,-1546 407.5,-1570"/>
<text text-anchor="middle" x="372" y="-1555.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_iodm_old</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_iodm_old -->
<g id="proc~~siesta_forces~~UsesGraph_edge7" class="edge"><title>proc~siesta_forces&#45;&gt;m_iodm_old</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M508.273,-927.026C509.803,-1004.99 514.613,-1438.65 435,-1537 430.33,-1542.77 424.007,-1546.96 417.179,-1550.01"/>
<polygon fill="#000000" stroke="#000000" points="415.852,-1546.76 407.662,-1553.49 418.256,-1553.34 415.852,-1546.76"/>
</g>
<!-- m_spin -->
<g id="proc~~siesta_forces~~UsesGraph_node9" class="node"><title>m_spin</title>
<polygon fill="#337ab7" stroke="#337ab7" points="399,-1528 345,-1528 345,-1504 399,-1504 399,-1528"/>
<text text-anchor="middle" x="372" y="-1513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_spin</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_spin -->
<g id="proc~~siesta_forces~~UsesGraph_edge41" class="edge"><title>proc~siesta_forces&#45;&gt;m_spin</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M508.164,-927.42C508.917,-1003.29 509.296,-1404 435,-1495 428.477,-1502.99 418.788,-1507.95 408.997,-1511.03"/>
<polygon fill="#000000" stroke="#000000" points="408.1,-1507.65 399.285,-1513.53 409.841,-1514.43 408.1,-1507.65"/>
</g>
<!-- siesta_cml -->
<g id="proc~~siesta_forces~~UsesGraph_node10" class="node"><title>siesta_cml</title>
<polygon fill="#337ab7" stroke="#337ab7" points="403.5,-1486 340.5,-1486 340.5,-1462 403.5,-1462 403.5,-1486"/>
<text text-anchor="middle" x="372" y="-1471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_cml</text>
</g>
<!-- proc~siesta_forces&#45;&gt;siesta_cml -->
<g id="proc~~siesta_forces~~UsesGraph_edge8" class="edge"><title>proc~siesta_forces&#45;&gt;siesta_cml</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M508.029,-927.456C507.949,-1000.14 504.11,-1369.19 435,-1453 429.44,-1459.74 421.625,-1464.33 413.412,-1467.45"/>
<polygon fill="#000000" stroke="#000000" points="412.205,-1464.16 403.698,-1470.47 414.287,-1470.84 412.205,-1464.16"/>
</g>
<!-- m_forces -->
<g id="proc~~siesta_forces~~UsesGraph_node11" class="node"><title>m_forces</title>
<polygon fill="#337ab7" stroke="#337ab7" points="400.5,-1444 343.5,-1444 343.5,-1420 400.5,-1420 400.5,-1444"/>
<text text-anchor="middle" x="372" y="-1429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_forces</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_forces -->
<g id="proc~~siesta_forces~~UsesGraph_edge9" class="edge"><title>proc~siesta_forces&#45;&gt;m_forces</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.766,-927.185C506.232,-995.225 495.683,-1327.92 435,-1406 428.78,-1414 419.647,-1419.57 410.291,-1423.43"/>
<polygon fill="#000000" stroke="#000000" points="408.835,-1420.23 400.575,-1426.87 411.169,-1426.83 408.835,-1420.23"/>
</g>
<!-- write_subs -->
<g id="proc~~siesta_forces~~UsesGraph_node12" class="node"><title>write_subs</title>
<polygon fill="#337ab7" stroke="#337ab7" points="247.5,-1508 183.5,-1508 183.5,-1484 247.5,-1484 247.5,-1508"/>
<text text-anchor="middle" x="215.5" y="-1493.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_subs</text>
</g>
<!-- proc~siesta_forces&#45;&gt;write_subs -->
<g id="proc~~siesta_forces~~UsesGraph_edge10" class="edge"><title>proc~siesta_forces&#45;&gt;write_subs</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.749,-927.321C506.161,-993.228 495.517,-1303.72 435,-1373 396.521,-1417.05 359.817,-1382.04 309,-1411 278.825,-1428.2 250.397,-1456.89 233.22,-1476.12"/>
<polygon fill="#000000" stroke="#000000" points="230.521,-1473.89 226.574,-1483.73 235.791,-1478.5 230.521,-1473.89"/>
</g>
<!-- m_energies -->
<g id="proc~~siesta_forces~~UsesGraph_node13" class="node"><title>m_energies</title>
<polygon fill="#337ab7" stroke="#337ab7" points="406.5,-1364 337.5,-1364 337.5,-1340 406.5,-1340 406.5,-1364"/>
<text text-anchor="middle" x="372" y="-1349.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_energies</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_energies -->
<g id="proc~~siesta_forces~~UsesGraph_edge11" class="edge"><title>proc~siesta_forces&#45;&gt;m_energies</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.488,-927.374C504.674,-989.6 489.183,-1267.83 435,-1331 430.066,-1336.75 423.495,-1340.93 416.475,-1343.97"/>
<polygon fill="#000000" stroke="#000000" points="414.979,-1340.79 406.736,-1347.44 417.331,-1347.38 414.979,-1340.79"/>
</g>
<!-- m_ts_charge -->
<g id="proc~~siesta_forces~~UsesGraph_node14" class="node"><title>m_ts_charge</title>
<polygon fill="#337ab7" stroke="#337ab7" points="409.5,-1322 334.5,-1322 334.5,-1298 409.5,-1298 409.5,-1322"/>
<text text-anchor="middle" x="372" y="-1307.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_charge</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_ts_charge -->
<g id="proc~~siesta_forces~~UsesGraph_edge12" class="edge"><title>proc~siesta_forces&#45;&gt;m_ts_charge</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.229,-927.27C503.341,-985.428 484.099,-1232.85 435,-1289 430.68,-1293.94 425.154,-1297.72 419.186,-1300.61"/>
<polygon fill="#000000" stroke="#000000" points="417.538,-1297.5 409.553,-1304.47 420.138,-1304 417.538,-1297.5"/>
</g>
<!-- m_convergence -->
<g id="proc~~siesta_forces~~UsesGraph_node15" class="node"><title>m_convergence</title>
<polygon fill="#337ab7" stroke="#337ab7" points="416.5,-1280 327.5,-1280 327.5,-1256 416.5,-1256 416.5,-1280"/>
<text text-anchor="middle" x="372" y="-1265.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_convergence</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_convergence -->
<g id="proc~~siesta_forces~~UsesGraph_edge13" class="edge"><title>proc~siesta_forces&#45;&gt;m_convergence</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M506.896,-927.319C501.812,-981.472 478.996,-1197.87 435,-1247 432.305,-1250.01 429.163,-1252.59 425.75,-1254.8"/>
<polygon fill="#000000" stroke="#000000" points="423.987,-1251.77 416.809,-1259.56 427.28,-1257.95 423.987,-1251.77"/>
</g>
<!-- sparse_matrices -->
<g id="proc~~siesta_forces~~UsesGraph_node16" class="node"><title>sparse_matrices</title>
<polygon fill="#337ab7" stroke="#337ab7" points="417.5,-1238 326.5,-1238 326.5,-1214 417.5,-1214 417.5,-1238"/>
<text text-anchor="middle" x="372" y="-1223.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sparse_matrices</text>
</g>
<!-- proc~siesta_forces&#45;&gt;sparse_matrices -->
<g id="proc~~siesta_forces~~UsesGraph_edge14" class="edge"><title>proc~siesta_forces&#45;&gt;sparse_matrices</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M506.505,-927.079C500.162,-976.509 474,-1162.75 435,-1205 432.461,-1207.75 429.549,-1210.14 426.402,-1212.22"/>
<polygon fill="#000000" stroke="#000000" points="424.715,-1209.15 417.618,-1217.02 428.072,-1215.29 424.715,-1209.15"/>
</g>
<!-- m_compute_energies -->
<g id="proc~~siesta_forces~~UsesGraph_node17" class="node"><title>m_compute_energies</title>
<polygon fill="#337ab7" stroke="#337ab7" points="430,-1196 314,-1196 314,-1172 430,-1172 430,-1196"/>
<text text-anchor="middle" x="372" y="-1181.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_compute_energies</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_compute_energies -->
<g id="proc~~siesta_forces~~UsesGraph_edge15" class="edge"><title>proc~siesta_forces&#45;&gt;m_compute_energies</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M508.123,-927.242C507.843,-966.97 501.533,-1093.73 435,-1163 433.942,-1164.1 432.825,-1165.14 431.656,-1166.13"/>
<polygon fill="#000000" stroke="#000000" points="429.549,-1163.34 423.31,-1171.9 433.527,-1169.1 429.549,-1163.34"/>
</g>
<!-- m_transiesta -->
<g id="proc~~siesta_forces~~UsesGraph_node18" class="node"><title>m_transiesta</title>
<polygon fill="#337ab7" stroke="#337ab7" points="409,-1154 335,-1154 335,-1130 409,-1130 409,-1154"/>
<text text-anchor="middle" x="372" y="-1139.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_transiesta</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_transiesta -->
<g id="proc~~siesta_forces~~UsesGraph_edge16" class="edge"><title>proc~siesta_forces&#45;&gt;m_transiesta</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.272,-927.144C504.512,-962.274 491.735,-1065.05 435,-1121 430.38,-1125.56 424.737,-1129.12 418.757,-1131.92"/>
<polygon fill="#000000" stroke="#000000" points="417.194,-1128.77 409.181,-1135.7 419.767,-1135.28 417.194,-1128.77"/>
</g>
<!-- module~m_compute_dm -->
<g id="proc~~siesta_forces~~UsesGraph_node19" class="node"><title>module~m_compute_dm</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node19"><a xlink:href=".././module/m_compute_dm.html" xlink:title="m_compute_dm">
<polygon fill="#337ab7" stroke="#337ab7" points="417,-1112 327,-1112 327,-1088 417,-1088 417,-1112"/>
<text text-anchor="middle" x="372" y="-1097.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_compute_dm</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;module~m_compute_dm -->
<g id="proc~~siesta_forces~~UsesGraph_edge18" class="edge"><title>proc~siesta_forces&#45;&gt;module~m_compute_dm</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M506.003,-927.249C500.441,-957.456 481.98,-1036.16 435,-1079 432.359,-1081.41 429.43,-1083.54 426.326,-1085.43"/>
<polygon fill="#000000" stroke="#000000" points="424.483,-1082.44 417.2,-1090.14 427.692,-1088.67 424.483,-1082.44"/>
</g>
<!-- siesta_options -->
<g id="proc~~siesta_forces~~UsesGraph_node20" class="node"><title>siesta_options</title>
<polygon fill="#337ab7" stroke="#337ab7" points="412.5,-1070 331.5,-1070 331.5,-1046 412.5,-1046 412.5,-1070"/>
<text text-anchor="middle" x="372" y="-1055.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_options</text>
</g>
<!-- proc~siesta_forces&#45;&gt;siesta_options -->
<g id="proc~~siesta_forces~~UsesGraph_edge19" class="edge"><title>proc~siesta_forces&#45;&gt;siesta_options</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M503.307,-927.329C493.812,-950.762 470.192,-1002.05 435,-1032 430.833,-1035.55 426.113,-1038.66 421.183,-1041.39"/>
<polygon fill="#000000" stroke="#000000" points="419.543,-1038.3 412.155,-1045.89 422.666,-1044.57 419.543,-1038.3"/>
</g>
<!-- module~m_compute_max_diff -->
<g id="proc~~siesta_forces~~UsesGraph_node21" class="node"><title>module~m_compute_max_diff</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node21"><a xlink:href=".././module/m_compute_max_diff.html" xlink:title="m_compute_max_diff">
<polygon fill="#337ab7" stroke="#337ab7" points="273,-1030 158,-1030 158,-1006 273,-1006 273,-1030"/>
<text text-anchor="middle" x="215.5" y="-1015.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_compute_max_diff</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;module~m_compute_max_diff -->
<g id="proc~~siesta_forces~~UsesGraph_edge20" class="edge"><title>proc~siesta_forces&#45;&gt;module~m_compute_max_diff</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M501.619,-927.057C490.79,-946.135 466.851,-982.779 435,-999 388.156,-1022.86 328.29,-1026.51 283.071,-1024.81"/>
<polygon fill="#000000" stroke="#000000" points="283.228,-1021.31 273.074,-1024.34 282.898,-1028.3 283.228,-1021.31"/>
</g>
<!-- module~m_setup_h0 -->
<g id="proc~~siesta_forces~~UsesGraph_node22" class="node"><title>module~m_setup_h0</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node22"><a xlink:href=".././module/m_setup_h0.html" xlink:title="m_setup_H0">
<polygon fill="#337ab7" stroke="#337ab7" points="408.5,-990 335.5,-990 335.5,-966 408.5,-966 408.5,-990"/>
<text text-anchor="middle" x="372" y="-975.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_setup_H0</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;module~m_setup_h0 -->
<g id="proc~~siesta_forces~~UsesGraph_edge21" class="edge"><title>proc~siesta_forces&#45;&gt;module~m_setup_h0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M489.326,-927.105C474.887,-936.126 454.188,-948.331 435,-957 429.626,-959.428 423.883,-961.734 418.142,-963.869"/>
<polygon fill="#000000" stroke="#000000" points="416.79,-960.635 408.546,-967.29 419.141,-967.228 416.79,-960.635"/>
</g>
<!-- m_rhog -->
<g id="proc~~siesta_forces~~UsesGraph_node23" class="node"><title>m_rhog</title>
<polygon fill="#337ab7" stroke="#337ab7" points="399,-948 345,-948 345,-924 399,-924 399,-948"/>
<text text-anchor="middle" x="372" y="-933.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_rhog</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_rhog -->
<g id="proc~~siesta_forces~~UsesGraph_edge22" class="edge"><title>proc~siesta_forces&#45;&gt;m_rhog</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M470.753,-920.794C451.525,-923.785 428.167,-927.419 409.106,-930.384"/>
<polygon fill="#000000" stroke="#000000" points="408.355,-926.958 399.012,-931.954 409.431,-933.875 408.355,-926.958"/>
</g>
<!-- m_stress -->
<g id="proc~~siesta_forces~~UsesGraph_node24" class="node"><title>m_stress</title>
<polygon fill="#337ab7" stroke="#337ab7" points="400,-906 344,-906 344,-882 400,-882 400,-906"/>
<text text-anchor="middle" x="372" y="-891.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_stress</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_stress -->
<g id="proc~~siesta_forces~~UsesGraph_edge23" class="edge"><title>proc~siesta_forces&#45;&gt;m_stress</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M470.753,-909.206C451.92,-906.276 429.125,-902.731 410.286,-899.8"/>
<polygon fill="#000000" stroke="#000000" points="410.697,-896.322 400.277,-898.243 409.621,-903.239 410.697,-896.322"/>
</g>
<!-- files -->
<g id="proc~~siesta_forces~~UsesGraph_node25" class="node"><title>files</title>
<polygon fill="#337ab7" stroke="#337ab7" points="399,-864 345,-864 345,-840 399,-840 399,-864"/>
<text text-anchor="middle" x="372" y="-849.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">files</text>
</g>
<!-- proc~siesta_forces&#45;&gt;files -->
<g id="proc~~siesta_forces~~UsesGraph_edge24" class="edge"><title>proc~siesta_forces&#45;&gt;files</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M489.326,-902.895C474.887,-893.874 454.188,-881.669 435,-873 426.648,-869.226 417.404,-865.746 408.661,-862.749"/>
<polygon fill="#000000" stroke="#000000" points="409.668,-859.396 399.075,-859.581 407.472,-866.043 409.668,-859.396"/>
</g>
<!-- m_ts_method -->
<g id="proc~~siesta_forces~~UsesGraph_node26" class="node"><title>m_ts_method</title>
<polygon fill="#337ab7" stroke="#337ab7" points="411,-822 333,-822 333,-798 411,-798 411,-822"/>
<text text-anchor="middle" x="372" y="-807.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_method</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_ts_method -->
<g id="proc~~siesta_forces~~UsesGraph_edge25" class="edge"><title>proc~siesta_forces&#45;&gt;m_ts_method</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M500.547,-902.912C488.778,-884.783 464.2,-850.592 435,-831 430.629,-828.068 425.811,-825.509 420.85,-823.285"/>
<polygon fill="#000000" stroke="#000000" points="421.798,-819.893 411.214,-819.409 419.186,-826.388 421.798,-819.893"/>
</g>
<!-- m_ts_global_vars -->
<g id="proc~~siesta_forces~~UsesGraph_node27" class="node"><title>m_ts_global_vars</title>
<polygon fill="#337ab7" stroke="#337ab7" points="420.5,-780 323.5,-780 323.5,-756 420.5,-756 420.5,-780"/>
<text text-anchor="middle" x="372" y="-765.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_global_vars</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_ts_global_vars -->
<g id="proc~~siesta_forces~~UsesGraph_edge26" class="edge"><title>proc~siesta_forces&#45;&gt;m_ts_global_vars</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M504.168,-902.654C495.762,-877.574 473.338,-820.393 435,-789 433.25,-787.567 431.397,-786.229 429.468,-784.982"/>
<polygon fill="#000000" stroke="#000000" points="431.047,-781.855 420.604,-780.066 427.652,-787.977 431.047,-781.855"/>
</g>
<!-- m_post_scf_work -->
<g id="proc~~siesta_forces~~UsesGraph_node28" class="node"><title>m_post_scf_work</title>
<polygon fill="#337ab7" stroke="#337ab7" points="420,-738 324,-738 324,-714 420,-714 420,-738"/>
<text text-anchor="middle" x="372" y="-723.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_post_scf_work</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_post_scf_work -->
<g id="proc~~siesta_forces~~UsesGraph_edge27" class="edge"><title>proc~siesta_forces&#45;&gt;m_post_scf_work</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M506.175,-902.909C500.928,-872.316 482.978,-791.138 435,-747 433.097,-745.25 431.043,-743.644 428.879,-742.172"/>
<polygon fill="#000000" stroke="#000000" points="430.496,-739.065 420.08,-737.131 427.016,-745.139 430.496,-739.065"/>
</g>
<!-- sys -->
<g id="proc~~siesta_forces~~UsesGraph_node29" class="node"><title>sys</title>
<polygon fill="#337ab7" stroke="#337ab7" points="399,-696 345,-696 345,-672 399,-672 399,-696"/>
<text text-anchor="middle" x="372" y="-681.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sys</text>
</g>
<!-- proc~siesta_forces&#45;&gt;sys -->
<g id="proc~~siesta_forces~~UsesGraph_edge28" class="edge"><title>proc~siesta_forces&#45;&gt;sys</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.368,-902.88C504.86,-867.326 492.681,-762.223 435,-705 427.874,-697.931 418.286,-693.24 408.782,-690.128"/>
<polygon fill="#000000" stroke="#000000" points="409.587,-686.719 399.015,-687.422 407.718,-693.465 409.587,-686.719"/>
</g>
<!-- m_steps -->
<g id="proc~~siesta_forces~~UsesGraph_node30" class="node"><title>m_steps</title>
<polygon fill="#337ab7" stroke="#337ab7" points="399,-654 345,-654 345,-630 399,-630 399,-654"/>
<text text-anchor="middle" x="372" y="-639.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_steps</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_steps -->
<g id="proc~~siesta_forces~~UsesGraph_edge29" class="edge"><title>proc~siesta_forces&#45;&gt;m_steps</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M508.191,-902.847C508.144,-862.812 502.527,-733.61 435,-663 428.063,-655.746 418.533,-650.998 409.024,-647.89"/>
<polygon fill="#000000" stroke="#000000" points="409.803,-644.474 399.233,-645.208 407.954,-651.225 409.803,-644.474"/>
</g>
<!-- m_mixer -->
<g id="proc~~siesta_forces~~UsesGraph_node31" class="node"><title>m_mixer</title>
<polygon fill="#337ab7" stroke="#337ab7" points="399,-612 345,-612 345,-588 399,-588 399,-612"/>
<text text-anchor="middle" x="372" y="-597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_mixer</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_mixer -->
<g id="proc~~siesta_forces~~UsesGraph_edge30" class="edge"><title>proc~siesta_forces&#45;&gt;m_mixer</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M506.529,-902.756C500.28,-852.65 474.437,-663.863 435,-621 428.147,-613.552 418.558,-608.744 408.966,-605.641"/>
<polygon fill="#000000" stroke="#000000" points="409.65,-602.201 399.084,-602.986 407.834,-608.961 409.65,-602.201"/>
</g>
<!-- parallel -->
<g id="proc~~siesta_forces~~UsesGraph_node32" class="node"><title>parallel</title>
<polygon fill="#337ab7" stroke="#337ab7" points="399,-570 345,-570 345,-546 399,-546 399,-570"/>
<text text-anchor="middle" x="372" y="-555.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel</text>
</g>
<!-- proc~siesta_forces&#45;&gt;parallel -->
<g id="proc~~siesta_forces~~UsesGraph_edge31" class="edge"><title>proc~siesta_forces&#45;&gt;parallel</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M506.951,-902.9C502.025,-848.715 479.539,-628.862 435,-579 428.257,-571.451 418.702,-566.613 409.107,-563.514"/>
<polygon fill="#000000" stroke="#000000" points="409.775,-560.069 399.21,-560.872 407.969,-566.833 409.775,-560.069"/>
</g>
<!-- module~m_mixing_scf -->
<g id="proc~~siesta_forces~~UsesGraph_node33" class="node"><title>module~m_mixing_scf</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node33"><a xlink:href=".././module/m_mixing_scf.html" xlink:title="m_mixing_scf">
<polygon fill="#337ab7" stroke="#337ab7" points="411,-528 333,-528 333,-504 411,-504 411,-528"/>
<text text-anchor="middle" x="372" y="-513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_mixing_scf</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;module~m_mixing_scf -->
<g id="proc~~siesta_forces~~UsesGraph_edge32" class="edge"><title>proc~siesta_forces&#45;&gt;module~m_mixing_scf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.273,-902.988C503.532,-844.935 484.659,-593.906 435,-537 431.027,-532.447 426.03,-528.879 420.605,-526.084"/>
<polygon fill="#000000" stroke="#000000" points="421.749,-522.768 411.177,-522.072 419.008,-529.209 421.749,-522.768"/>
</g>
<!-- atomlist -->
<g id="proc~~siesta_forces~~UsesGraph_node34" class="node"><title>atomlist</title>
<polygon fill="#337ab7" stroke="#337ab7" points="399,-486 345,-486 345,-462 399,-462 399,-486"/>
<text text-anchor="middle" x="372" y="-471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">atomlist</text>
</g>
<!-- proc~siesta_forces&#45;&gt;atomlist -->
<g id="proc~~siesta_forces~~UsesGraph_edge33" class="edge"><title>proc~siesta_forces&#45;&gt;atomlist</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.523,-902.92C504.843,-840.928 489.757,-558.945 435,-495 428.292,-487.166 418.548,-482.248 408.765,-479.162"/>
<polygon fill="#000000" stroke="#000000" points="409.637,-475.772 399.079,-476.647 407.878,-482.548 409.637,-475.772"/>
</g>
<!-- m_dm_charge -->
<g id="proc~~siesta_forces~~UsesGraph_node35" class="node"><title>m_dm_charge</title>
<polygon fill="#337ab7" stroke="#337ab7" points="413,-444 331,-444 331,-420 413,-420 413,-444"/>
<text text-anchor="middle" x="372" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_dm_charge</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_dm_charge -->
<g id="proc~~siesta_forces~~UsesGraph_edge34" class="edge"><title>proc~siesta_forces&#45;&gt;m_dm_charge</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.724,-902.607C506.006,-836.312 494.8,-523.93 435,-453 431.563,-448.923 427.303,-445.635 422.637,-442.984"/>
<polygon fill="#000000" stroke="#000000" points="423.817,-439.673 413.274,-438.631 420.866,-446.02 423.817,-439.673"/>
</g>
<!-- kpoint_grid -->
<g id="proc~~siesta_forces~~UsesGraph_node36" class="node"><title>kpoint_grid</title>
<polygon fill="#337ab7" stroke="#337ab7" points="404.5,-402 339.5,-402 339.5,-378 404.5,-378 404.5,-402"/>
<text text-anchor="middle" x="372" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">kpoint_grid</text>
</g>
<!-- proc~siesta_forces&#45;&gt;kpoint_grid -->
<g id="proc~~siesta_forces~~UsesGraph_edge35" class="edge"><title>proc~siesta_forces&#45;&gt;kpoint_grid</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.906,-902.878C507.135,-833.699 500.035,-489.155 435,-411 429.625,-404.541 422.183,-400.061 414.317,-396.956"/>
<polygon fill="#000000" stroke="#000000" points="415.213,-393.567 404.621,-393.81 413.052,-400.226 415.213,-393.567"/>
</g>
<!-- m_initwf -->
<g id="proc~~siesta_forces~~UsesGraph_node37" class="node"><title>m_initwf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="399,-360 345,-360 345,-336 399,-336 399,-360"/>
<text text-anchor="middle" x="372" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_initwf</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_initwf -->
<g id="proc~~siesta_forces~~UsesGraph_edge36" class="edge"><title>proc~siesta_forces&#45;&gt;m_initwf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M508.056,-902.836C508.147,-830.225 505.189,-454.292 435,-369 428.447,-361.036 418.748,-356.08 408.958,-352.999"/>
<polygon fill="#000000" stroke="#000000" points="409.807,-349.604 399.251,-350.502 408.063,-356.383 409.807,-349.604"/>
</g>
<!-- module~m_setup_hamiltonian -->
<g id="proc~~siesta_forces~~UsesGraph_node38" class="node"><title>module~m_setup_hamiltonian</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node38"><a xlink:href=".././module/m_setup_hamiltonian.html" xlink:title="m_setup_hamiltonian">
<polygon fill="#337ab7" stroke="#337ab7" points="429.5,-318 314.5,-318 314.5,-294 429.5,-294 429.5,-318"/>
<text text-anchor="middle" x="372" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_setup_hamiltonian</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;module~m_setup_hamiltonian -->
<g id="proc~~siesta_forces~~UsesGraph_edge37" class="edge"><title>proc~siesta_forces&#45;&gt;module~m_setup_hamiltonian</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M508.183,-902.904C509.09,-827.261 510.389,-419.494 435,-327 434.282,-326.119 433.525,-325.275 432.735,-324.466"/>
<polygon fill="#000000" stroke="#000000" points="434.788,-321.626 424.798,-318.097 430.406,-327.085 434.788,-321.626"/>
</g>
<!-- m_mpi_utils -->
<g id="proc~~siesta_forces~~UsesGraph_node39" class="node"><title>m_mpi_utils</title>
<polygon fill="#337ab7" stroke="#337ab7" points="407,-276 337,-276 337,-252 407,-252 407,-276"/>
<text text-anchor="middle" x="372" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_mpi_utils</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_mpi_utils -->
<g id="proc~~siesta_forces~~UsesGraph_edge38" class="edge"><title>proc~siesta_forces&#45;&gt;m_mpi_utils</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.372,-902.951C502.952,-819.981 475.491,-335.094 435,-285 430.236,-279.106 423.746,-274.858 416.754,-271.798"/>
<polygon fill="#000000" stroke="#000000" points="417.617,-268.389 407.022,-268.318 415.26,-274.981 417.617,-268.389"/>
</g>
<!-- m_save_density_matrix -->
<g id="proc~~siesta_forces~~UsesGraph_node40" class="node"><title>m_save_density_matrix</title>
<polygon fill="#337ab7" stroke="#337ab7" points="434.5,-234 309.5,-234 309.5,-210 434.5,-210 434.5,-234"/>
<text text-anchor="middle" x="372" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_save_density_matrix</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_save_density_matrix -->
<g id="proc~~siesta_forces~~UsesGraph_edge39" class="edge"><title>proc~siesta_forces&#45;&gt;m_save_density_matrix</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.466,-902.988C503.54,-816.986 478.103,-296.716 435,-243 434.289,-242.114 433.538,-241.264 432.753,-240.451"/>
<polygon fill="#000000" stroke="#000000" points="434.828,-237.628 424.856,-234.05 430.421,-243.066 434.828,-237.628"/>
</g>
<!-- siesta_geom -->
<g id="proc~~siesta_forces~~UsesGraph_node41" class="node"><title>siesta_geom</title>
<polygon fill="#337ab7" stroke="#337ab7" points="408.5,-192 335.5,-192 335.5,-168 408.5,-168 408.5,-192"/>
<text text-anchor="middle" x="372" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_geom</text>
</g>
<!-- proc~siesta_forces&#45;&gt;siesta_geom -->
<g id="proc~~siesta_forces~~UsesGraph_edge40" class="edge"><title>proc~siesta_forces&#45;&gt;siesta_geom</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.539,-902.817C504.051,-813.234 480.683,-258.302 435,-201 430.621,-195.507 424.742,-191.443 418.343,-188.437"/>
<polygon fill="#000000" stroke="#000000" points="419.299,-185.055 408.709,-184.747 416.796,-191.592 419.299,-185.055"/>
</g>
<!-- fdf -->
<g id="proc~~siesta_forces~~UsesGraph_node42" class="node"><title>fdf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="399,-150 345,-150 345,-126 399,-126 399,-150"/>
<text text-anchor="middle" x="372" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fdf</text>
</g>
<!-- proc~siesta_forces&#45;&gt;fdf -->
<g id="proc~~siesta_forces~~UsesGraph_edge17" class="edge"><title>proc~siesta_forces&#45;&gt;fdf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.618,-902.995C504.59,-811.016 483.326,-219.968 435,-159 428.541,-150.851 418.778,-145.844 408.899,-142.775"/>
<polygon fill="#000000" stroke="#000000" points="409.651,-139.355 399.099,-140.307 407.941,-146.143 409.651,-139.355"/>
</g>
<!-- module~m_state_init -->
<g id="proc~~siesta_forces~~UsesGraph_node43" class="node"><title>module~m_state_init</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node43"><a xlink:href=".././module/m_state_init.html" xlink:title="m_state_init">
<polygon fill="#337ab7" stroke="#337ab7" points="407,-108 337,-108 337,-84 407,-84 407,-108"/>
<text text-anchor="middle" x="372" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_state_init</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;module~m_state_init -->
<g id="proc~~siesta_forces~~UsesGraph_edge42" class="edge"><title>proc~siesta_forces&#45;&gt;module~m_state_init</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.68,-902.939C505.062,-807.9 485.932,-181.589 435,-117 430.307,-111.049 423.852,-106.773 416.871,-103.704"/>
<polygon fill="#000000" stroke="#000000" points="417.737,-100.296 407.142,-100.222 415.378,-106.887 417.737,-100.296"/>
</g>
<!-- siesta_master -->
<g id="proc~~siesta_forces~~UsesGraph_node44" class="node"><title>siesta_master</title>
<polygon fill="#337ab7" stroke="#337ab7" points="411.5,-66 332.5,-66 332.5,-42 411.5,-42 411.5,-66"/>
<text text-anchor="middle" x="372" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_master</text>
</g>
<!-- proc~siesta_forces&#45;&gt;siesta_master -->
<g id="proc~~siesta_forces~~UsesGraph_edge43" class="edge"><title>proc~siesta_forces&#45;&gt;siesta_master</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.738,-902.933C505.515,-805.067 488.549,-143.227 435,-75 431.269,-70.2465 426.413,-66.5617 421.061,-63.7067"/>
<polygon fill="#000000" stroke="#000000" points="422.262,-60.4127 411.695,-59.6432 419.476,-66.8343 422.262,-60.4127"/>
</g>
<!-- m_check_walltime -->
<g id="proc~~siesta_forces~~UsesGraph_node45" class="node"><title>m_check_walltime</title>
<polygon fill="#337ab7" stroke="#337ab7" points="422,-24 322,-24 322,-0 422,-0 422,-24"/>
<text text-anchor="middle" x="372" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_check_walltime</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_check_walltime -->
<g id="proc~~siesta_forces~~UsesGraph_edge44" class="edge"><title>proc~siesta_forces&#45;&gt;m_check_walltime</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.792,-902.974C505.95,-802.518 491.178,-104.88 435,-33 433.578,-31.1812 431.992,-29.5188 430.276,-27.9994"/>
<polygon fill="#000000" stroke="#000000" points="432.227,-25.0926 422.031,-22.2126 428.206,-30.8223 432.227,-25.0926"/>
</g>
<!-- module~m_state_analysis&#45;&gt;write_subs -->
<g id="proc~~siesta_forces~~UsesGraph_edge45" class="edge"><title>module~m_state_analysis&#45;&gt;write_subs</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M327.973,-1587.97C321.42,-1585.42 314.887,-1582.44 309,-1579 279.63,-1561.83 251.35,-1534.33 233.959,-1515.73"/>
<polygon fill="#000000" stroke="#000000" points="236.322,-1513.13 226.984,-1508.12 231.161,-1517.86 236.322,-1513.13"/>
</g>
<!-- module~m_compute_max_diff&#45;&gt;precision -->
<g id="proc~~siesta_forces~~UsesGraph_edge46" class="edge"><title>module~m_compute_max_diff&#45;&gt;precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M157.715,-1018C138.079,-1018 116.597,-1018 98.9688,-1018"/>
<polygon fill="#000000" stroke="#000000" points="98.5417,-1014.5 88.5417,-1018 98.5417,-1021.5 98.5417,-1014.5"/>
</g>
<!-- class_Fstack_dData1D -->
<g id="proc~~siesta_forces~~UsesGraph_node46" class="node"><title>class_Fstack_dData1D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="122,-528 -7.10543e-15,-528 -7.10543e-15,-504 122,-504 122,-528"/>
<text text-anchor="middle" x="61" y="-513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_Fstack_dData1D</text>
</g>
<!-- module~m_mixing_scf&#45;&gt;class_Fstack_dData1D -->
<g id="proc~~siesta_forces~~UsesGraph_edge47" class="edge"><title>module~m_mixing_scf&#45;&gt;class_Fstack_dData1D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M332.801,-516C282.86,-516 194.44,-516 132.252,-516"/>
<polygon fill="#000000" stroke="#000000" points="132.121,-512.5 122.121,-516 132.121,-519.5 132.121,-512.5"/>
</g>
<!-- module~m_mixing -->
<g id="proc~~siesta_forces~~UsesGraph_node47" class="node"><title>module~m_mixing</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node47"><a xlink:href=".././module/m_mixing.html" xlink:title="m_mixing">
<polygon fill="#337ab7" stroke="#337ab7" points="244.5,-569 186.5,-569 186.5,-545 244.5,-545 244.5,-569"/>
<text text-anchor="middle" x="215.5" y="-554.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_mixing</text>
</a>
</g>
</g>
<!-- module~m_mixing_scf&#45;&gt;module~m_mixing -->
<g id="proc~~siesta_forces~~UsesGraph_edge48" class="edge"><title>module~m_mixing_scf&#45;&gt;module~m_mixing</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M332.809,-526.135C308.883,-532.484 278.174,-540.634 254.319,-546.964"/>
<polygon fill="#000000" stroke="#000000" points="253.322,-543.607 244.554,-549.555 255.118,-550.373 253.322,-543.607"/>
</g>
<!-- module~m_mixing&#45;&gt;precision -->
<g id="proc~~siesta_forces~~UsesGraph_edge51" class="edge"><title>module~m_mixing&#45;&gt;precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M210.421,-569.331C189.704,-631.956 96.0782,-914.983 69.2217,-996.169"/>
<polygon fill="#000000" stroke="#000000" points="65.8386,-995.252 66.0208,-1005.85 72.4844,-997.451 65.8386,-995.252"/>
</g>
<!-- module~m_mixing&#45;&gt;class_Fstack_dData1D -->
<g id="proc~~siesta_forces~~UsesGraph_edge50" class="edge"><title>module~m_mixing&#45;&gt;class_Fstack_dData1D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M186.173,-549.384C166.653,-544.136 140.085,-536.993 116.533,-530.661"/>
<polygon fill="#000000" stroke="#000000" points="117.219,-527.222 106.653,-528.005 115.402,-533.981 117.219,-527.222"/>
</g>
<!-- class_dData1D -->
<g id="proc~~siesta_forces~~UsesGraph_node48" class="node"><title>class_dData1D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="103.5,-570 18.5,-570 18.5,-546 103.5,-546 103.5,-570"/>
<text text-anchor="middle" x="61" y="-555.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_dData1D</text>
</g>
<!-- module~m_mixing&#45;&gt;class_dData1D -->
<g id="proc~~siesta_forces~~UsesGraph_edge49" class="edge"><title>module~m_mixing&#45;&gt;class_dData1D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M186.173,-557.186C165.899,-557.319 138.023,-557.501 113.819,-557.66"/>
<polygon fill="#000000" stroke="#000000" points="113.68,-554.161 103.704,-557.727 113.726,-561.161 113.68,-554.161"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="490pt" height="32pt"
 viewBox="0.00 0.00 489.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 485.5,-28 485.5,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node"><title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node"><title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="139.5,-24 72.5,-24 72.5,-0 139.5,-0 139.5,-24"/>
<text text-anchor="middle" x="106" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="222,-24 158,-24 158,-0 222,-0 222,-24"/>
<text text-anchor="middle" x="190" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="294,-24 240,-24 240,-0 294,-0 294,-24"/>
<text text-anchor="middle" x="267" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="366,-24 312,-24 312,-0 366,-0 366,-24"/>
<text text-anchor="middle" x="339" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="481.5,-24 384.5,-24 384.5,-0 481.5,-0 481.5,-24"/>
<text text-anchor="middle" x="433" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses.
    </p>
    </div></div></div></div>
      </li>
      
      </ul>
    </div>
    


    
    <p>This subroutine represents central SIESTA operation logic.</p>
<p>Initialization tasks for a given geometry:
<pre></p>
<p>if ( SIESTA_worker )  then
call state_init( istep )
end if
</pre>
<p>This call computes the <strong>non-scf</strong> part of <script type="math/tex"> H </script> and initializes the
  real-space grid structures:
<pre></p>
<p>if ( SIESTA_worker ) call setup_H0(G2max)
</pre><div class="alert alert-success" role="alert"><h4>Todo</h4><p>It might be better to split the two,
  putting the grid initialization into <strong>state_init (link!)</strong> and moving the
  calculation of <script type="math/tex"> H_0 </script> to the body of the loop, done <code>if first_scf=.true.</code>
  This would suit <em>analysis</em> runs in which <strong>nscf = 0</strong>
</p></div>
<p>
<p>The dHmax variable only has meaning for Hamiltonian
  mixing, or when requiring the Hamiltonian to be converged.</p>
<h1>SCF loop</h1>
<p>The current structure of the loop tries to reproduce the
  historical Siesta usage. It should be made more clear.</p>
<p>Two changes:</p>
<ol>
<li>The number of scf iterations performed is exactly
     equal to the number specified (i.e., the "forces"
     phase is not counted as a final scf step)</li>
<li>At the change to a TranSiesta GF run the variable "first_scf"
     is implicitly reset to "true".</li>
</ol>
<h2>Start of SCF cycle</h2>
<p>Conditions of exit:</p>
<ul>
<li>At the top, to catch a non-positive nscf and # of iterations</li>
<li>At the bottom, based on convergence</li>
</ul>
<p><pre></p>
<p>iscf = 0
do while ( iscf &lt; nscf )
</pre>
<p>Note implications for TranSiesta when mixing <script type="math/tex">H</script>.
  Now <script type="math/tex">H</script> will be recomputed instead of simply being
  inherited, however, this is required as if
  we have bias calculations as the electric
  field across the junction needs to be present.</p>
<p>Exit if converged:
<pre></p>
<p>if ( SCFconverged ) exit
</pre>
<p><strong>end of SCF cycle</strong></p>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-istep%7E3"></span>integer,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>istep</strong></td><td></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
	<h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
	<div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~siesta_forces~~CallsGraph Pages: 1 -->
<svg id="procsiesta_forcesCallsGraph" width="525pt" height="4268pt"
 viewBox="0.00 0.00 525.00 4267.74" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~siesta_forces~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 4263.74)">
<title>proc~~siesta_forces~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-4263.74 521,-4263.74 521,4 -4,4"/>
<!-- proc~siesta_forces -->
<g id="proc~~siesta_forces~~CallsGraph_node1" class="node"><title>proc~siesta_forces</title>
<polygon fill="none" stroke="black" points="76,-1095 0,-1095 0,-1071 76,-1071 76,-1095"/>
<text text-anchor="middle" x="38" y="-1080.6" font-family="Helvetica,sans-Serif" font-size="10.50">siesta_forces</text>
</g>
<!-- proc~state_init -->
<g id="proc~~siesta_forces~~CallsGraph_node2" class="node"><title>proc~state_init</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node2"><a xlink:href=".././proc/state_init.html" xlink:title="state_init">
<polygon fill="#d9534f" stroke="#d9534f" points="200,-1284 145,-1284 145,-1260 200,-1260 200,-1284"/>
<text text-anchor="middle" x="172.5" y="-1269.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">state_init</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;proc~state_init -->
<g id="proc~~siesta_forces~~CallsGraph_edge1" class="edge"><title>proc~siesta_forces&#45;&gt;proc~state_init</title>
<path fill="none" stroke="#000000" d="M40.8584,-1095.05C46.1846,-1125.56 64.3034,-1206.56 112,-1251 118.452,-1257.01 126.729,-1261.32 135.046,-1264.4"/>
<polygon fill="#000000" stroke="#000000" points="134.131,-1267.78 144.721,-1267.48 136.255,-1261.11 134.131,-1267.78"/>
</g>
<!-- check_walltime -->
<g id="proc~~siesta_forces~~CallsGraph_node3" class="node"><title>check_walltime</title>
<polygon fill="#777777" stroke="#777777" points="215,-1200 130,-1200 130,-1176 215,-1176 215,-1200"/>
<text text-anchor="middle" x="172.5" y="-1185.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_walltime</text>
</g>
<!-- proc~siesta_forces&#45;&gt;check_walltime -->
<g id="proc~~siesta_forces~~CallsGraph_edge2" class="edge"><title>proc~siesta_forces&#45;&gt;check_walltime</title>
<path fill="none" stroke="#000000" d="M46.4843,-1095.04C58.2944,-1113.11 82.9249,-1147.22 112,-1167 114.717,-1168.85 117.615,-1170.55 120.613,-1172.12"/>
<polygon fill="#000000" stroke="#000000" points="119.288,-1175.36 129.83,-1176.42 122.249,-1169.02 119.288,-1175.36"/>
</g>
<!-- fdf_get -->
<g id="proc~~siesta_forces~~CallsGraph_node4" class="node"><title>fdf_get</title>
<polygon fill="#777777" stroke="#777777" points="199.5,-1158 145.5,-1158 145.5,-1134 199.5,-1134 199.5,-1158"/>
<text text-anchor="middle" x="172.5" y="-1143.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fdf_get</text>
</g>
<!-- proc~siesta_forces&#45;&gt;fdf_get -->
<g id="proc~~siesta_forces~~CallsGraph_edge3" class="edge"><title>proc~siesta_forces&#45;&gt;fdf_get</title>
<path fill="none" stroke="#000000" d="M57.7058,-1095.04C72.1617,-1104.02 92.8678,-1116.21 112,-1125 119.572,-1128.48 127.898,-1131.74 135.861,-1134.62"/>
<polygon fill="#000000" stroke="#000000" points="134.724,-1137.93 145.319,-1137.91 137.027,-1131.32 134.724,-1137.93"/>
</g>
<!-- dm_charge -->
<g id="proc~~siesta_forces~~CallsGraph_node5" class="node"><title>dm_charge</title>
<polygon fill="#777777" stroke="#777777" points="206,-1116 139,-1116 139,-1092 206,-1092 206,-1116"/>
<text text-anchor="middle" x="172.5" y="-1101.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dm_charge</text>
</g>
<!-- proc~siesta_forces&#45;&gt;dm_charge -->
<g id="proc~~siesta_forces~~CallsGraph_edge4" class="edge"><title>proc~siesta_forces&#45;&gt;dm_charge</title>
<path fill="none" stroke="#000000" d="M76.2612,-1088.91C92.4884,-1091.48 111.606,-1094.51 128.438,-1097.18"/>
<polygon fill="#000000" stroke="#000000" points="128.152,-1100.67 138.577,-1098.78 129.248,-1093.76 128.152,-1100.67"/>
</g>
<!-- compute_energies -->
<g id="proc~~siesta_forces~~CallsGraph_node6" class="node"><title>compute_energies</title>
<polygon fill="#777777" stroke="#777777" points="223,-1074 122,-1074 122,-1050 223,-1050 223,-1074"/>
<text text-anchor="middle" x="172.5" y="-1059.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_energies</text>
</g>
<!-- proc~siesta_forces&#45;&gt;compute_energies -->
<g id="proc~~siesta_forces~~CallsGraph_edge5" class="edge"><title>proc~siesta_forces&#45;&gt;compute_energies</title>
<path fill="none" stroke="#000000" d="M76.2612,-1077.09C87.2644,-1075.35 99.5964,-1073.4 111.644,-1071.49"/>
<polygon fill="#000000" stroke="#000000" points="112.332,-1074.92 121.661,-1069.9 111.236,-1068.01 112.332,-1074.92"/>
</g>
<!-- scfconvergence_test -->
<g id="proc~~siesta_forces~~CallsGraph_node7" class="node"><title>scfconvergence_test</title>
<polygon fill="#777777" stroke="#777777" points="228,-1032 117,-1032 117,-1008 228,-1008 228,-1032"/>
<text text-anchor="middle" x="172.5" y="-1017.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">scfconvergence_test</text>
</g>
<!-- proc~siesta_forces&#45;&gt;scfconvergence_test -->
<g id="proc~~siesta_forces~~CallsGraph_edge6" class="edge"><title>proc~siesta_forces&#45;&gt;scfconvergence_test</title>
<path fill="none" stroke="#000000" d="M57.7058,-1070.96C72.1617,-1061.98 92.8678,-1049.79 112,-1041 116.028,-1039.15 120.27,-1037.36 124.557,-1035.66"/>
<polygon fill="#000000" stroke="#000000" points="125.849,-1038.91 133.948,-1032.08 123.357,-1032.37 125.849,-1038.91"/>
</g>
<!-- timer -->
<g id="proc~~siesta_forces~~CallsGraph_node8" class="node"><title>timer</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-2918 317.5,-2918 317.5,-2894 371.5,-2894 371.5,-2918"/>
<text text-anchor="middle" x="344.5" y="-2903.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">timer</text>
</g>
<!-- proc~siesta_forces&#45;&gt;timer -->
<g id="proc~~siesta_forces~~CallsGraph_edge7" class="edge"><title>proc~siesta_forces&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M39.1659,-1095.02C40.8648,-1213.01 56.1998,-2165.59 112,-2444 152.885,-2647.99 117.022,-2742.92 269,-2885 279.404,-2894.73 293.962,-2900 307.452,-2902.84"/>
<polygon fill="#000000" stroke="#000000" points="307.023,-2906.32 317.473,-2904.57 308.215,-2899.42 307.023,-2906.32"/>
</g>
<!-- interface~compute_max_diff -->
<g id="proc~~siesta_forces~~CallsGraph_node9" class="node"><title>interface~compute_max_diff</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node9"><a xlink:href=".././interface/compute_max_diff.html" xlink:title="compute_max_diff">
<polygon fill="#a7506f" stroke="#a7506f" points="222.5,-4174 122.5,-4174 122.5,-4150 222.5,-4150 222.5,-4174"/>
<text text-anchor="middle" x="172.5" y="-4159.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_max_diff</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;interface~compute_max_diff -->
<g id="proc~~siesta_forces~~CallsGraph_edge8" class="edge"><title>proc~siesta_forces&#45;&gt;interface~compute_max_diff</title>
<path fill="none" stroke="#000000" d="M39.0442,-1095.18C39.7172,-1269.53 48.764,-3266.12 112,-3851 123.864,-3960.73 153.715,-4089.63 166.043,-4140.14"/>
<polygon fill="#000000" stroke="#000000" points="162.67,-4141.08 168.46,-4149.95 169.467,-4139.41 162.67,-4141.08"/>
</g>
<!-- transiesta -->
<g id="proc~~siesta_forces~~CallsGraph_node10" class="node"><title>transiesta</title>
<polygon fill="#777777" stroke="#777777" points="374,-3716 315,-3716 315,-3692 374,-3692 374,-3716"/>
<text text-anchor="middle" x="344.5" y="-3701.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">transiesta</text>
</g>
<!-- proc~siesta_forces&#45;&gt;transiesta -->
<g id="proc~~siesta_forces~~CallsGraph_edge9" class="edge"><title>proc~siesta_forces&#45;&gt;transiesta</title>
<path fill="none" stroke="#000000" d="M38.9338,-1095.02C38.042,-1266.94 29.7046,-3228.26 112,-3468 150.415,-3579.91 171.843,-3615.47 269,-3683 279.517,-3690.31 292.53,-3695.09 304.722,-3698.21"/>
<polygon fill="#000000" stroke="#000000" points="304.173,-3701.67 314.698,-3700.45 305.712,-3694.84 304.173,-3701.67"/>
</g>
<!-- proc~mixing_scf_converged -->
<g id="proc~~siesta_forces~~CallsGraph_node11" class="node"><title>proc~mixing_scf_converged</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node11"><a xlink:href=".././proc/mixing_scf_converged.html" xlink:title="mixing_scf_converged">
<polygon fill="#d9534f" stroke="#d9534f" points="232,-952 113,-952 113,-928 232,-928 232,-952"/>
<text text-anchor="middle" x="172.5" y="-937.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mixing_scf_converged</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;proc~mixing_scf_converged -->
<g id="proc~~siesta_forces~~CallsGraph_edge10" class="edge"><title>proc~siesta_forces&#45;&gt;proc~mixing_scf_converged</title>
<path fill="none" stroke="#000000" d="M43.7339,-1070.72C53.2979,-1047.37 77.032,-996.206 112,-966 116.003,-962.542 120.537,-959.479 125.274,-956.781"/>
<polygon fill="#000000" stroke="#000000" points="127.238,-959.707 134.545,-952.036 124.049,-953.476 127.238,-959.707"/>
</g>
<!-- reset -->
<g id="proc~~siesta_forces~~CallsGraph_node12" class="node"><title>reset</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-24 317.5,-24 317.5,-0 371.5,-0 371.5,-24"/>
<text text-anchor="middle" x="344.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reset</text>
</g>
<!-- proc~siesta_forces&#45;&gt;reset -->
<g id="proc~~siesta_forces~~CallsGraph_edge11" class="edge"><title>proc~siesta_forces&#45;&gt;reset</title>
<path fill="none" stroke="#000000" d="M46.3987,-1070.83C58.0969,-1052.59 82.5833,-1018.27 112,-999 159.155,-968.118 198.769,-1005.78 233,-961 295.665,-879.018 205.131,-114.047 269,-33 278.102,-21.4493 293.037,-15.9365 307.154,-13.4102"/>
<polygon fill="#000000" stroke="#000000" points="307.752,-16.8613 317.194,-12.0549 306.816,-9.92425 307.752,-16.8613"/>
</g>
<!-- proc~state_analysis -->
<g id="proc~~siesta_forces~~CallsGraph_node13" class="node"><title>proc~state_analysis</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node13"><a xlink:href=".././proc/state_analysis.html" xlink:title="state_analysis">
<polygon fill="#d9534f" stroke="#d9534f" points="212.5,-2435 132.5,-2435 132.5,-2411 212.5,-2411 212.5,-2435"/>
<text text-anchor="middle" x="172.5" y="-2420.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">state_analysis</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;proc~state_analysis -->
<g id="proc~~siesta_forces~~CallsGraph_edge13" class="edge"><title>proc~siesta_forces&#45;&gt;proc~state_analysis</title>
<path fill="none" stroke="#000000" d="M40.2271,-1095.41C52.4945,-1219.47 152.95,-2235.4 169.265,-2400.4"/>
<polygon fill="#000000" stroke="#000000" points="165.825,-2401.17 170.292,-2410.78 172.791,-2400.48 165.825,-2401.17"/>
</g>
<!-- post_scf_work -->
<g id="proc~~siesta_forces~~CallsGraph_node14" class="node"><title>post_scf_work</title>
<polygon fill="#777777" stroke="#777777" points="213,-910 132,-910 132,-886 213,-886 213,-910"/>
<text text-anchor="middle" x="172.5" y="-895.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">post_scf_work</text>
</g>
<!-- proc~siesta_forces&#45;&gt;post_scf_work -->
<g id="proc~~siesta_forces~~CallsGraph_edge12" class="edge"><title>proc~siesta_forces&#45;&gt;post_scf_work</title>
<path fill="none" stroke="#000000" d="M41.0309,-1070.79C46.6695,-1040.66 65.2929,-962.134 112,-919 115.169,-916.074 118.77,-913.551 122.597,-911.376"/>
<polygon fill="#000000" stroke="#000000" points="124.355,-914.414 131.835,-906.909 121.308,-908.112 124.355,-914.414"/>
</g>
<!-- mix_rhog -->
<g id="proc~~siesta_forces~~CallsGraph_node15" class="node"><title>mix_rhog</title>
<polygon fill="#777777" stroke="#777777" points="201,-868 144,-868 144,-844 201,-844 201,-868"/>
<text text-anchor="middle" x="172.5" y="-853.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mix_rhog</text>
</g>
<!-- proc~siesta_forces&#45;&gt;mix_rhog -->
<g id="proc~~siesta_forces~~CallsGraph_edge14" class="edge"><title>proc~siesta_forces&#45;&gt;mix_rhog</title>
<path fill="none" stroke="#000000" d="M39.763,-1070.89C42.6164,-1035.86 55.6217,-933.307 112,-877 118.128,-870.88 126.146,-866.537 134.302,-863.457"/>
<polygon fill="#000000" stroke="#000000" points="135.387,-866.785 143.835,-860.391 133.244,-860.121 135.387,-866.785"/>
</g>
<!-- die -->
<g id="proc~~siesta_forces~~CallsGraph_node16" class="node"><title>die</title>
<polygon fill="#777777" stroke="#777777" points="513.5,-4195 459.5,-4195 459.5,-4171 513.5,-4171 513.5,-4195"/>
<text text-anchor="middle" x="486.5" y="-4180.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">die</text>
</g>
<!-- proc~siesta_forces&#45;&gt;die -->
<g id="proc~~siesta_forces~~CallsGraph_edge15" class="edge"><title>proc~siesta_forces&#45;&gt;die</title>
<path fill="none" stroke="#000000" d="M39.0823,-1095.22C40.5119,-1303.97 60.7259,-4117.81 112,-4183 197.41,-4291.59 287.421,-4263.86 420,-4225 435.856,-4220.35 451.512,-4210.56 463.541,-4201.6"/>
<polygon fill="#000000" stroke="#000000" points="465.876,-4204.21 471.609,-4195.3 461.571,-4198.69 465.876,-4204.21"/>
</g>
<!-- save_density_matrix -->
<g id="proc~~siesta_forces~~CallsGraph_node17" class="node"><title>save_density_matrix</title>
<polygon fill="#777777" stroke="#777777" points="227.5,-826 117.5,-826 117.5,-802 227.5,-802 227.5,-826"/>
<text text-anchor="middle" x="172.5" y="-811.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_density_matrix</text>
</g>
<!-- proc~siesta_forces&#45;&gt;save_density_matrix -->
<g id="proc~~siesta_forces~~CallsGraph_edge16" class="edge"><title>proc~siesta_forces&#45;&gt;save_density_matrix</title>
<path fill="none" stroke="#000000" d="M38.9131,-1070.79C39.3019,-1031.17 45.9083,-904.692 112,-835 113.036,-833.907 114.133,-832.871 115.281,-831.889"/>
<polygon fill="#000000" stroke="#000000" points="117.296,-834.751 123.492,-826.157 113.289,-829.011 117.296,-834.751"/>
</g>
<!-- mixer -->
<g id="proc~~siesta_forces~~CallsGraph_node18" class="node"><title>mixer</title>
<polygon fill="#777777" stroke="#777777" points="199.5,-784 145.5,-784 145.5,-760 199.5,-760 199.5,-784"/>
<text text-anchor="middle" x="172.5" y="-769.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mixer</text>
</g>
<!-- proc~siesta_forces&#45;&gt;mixer -->
<g id="proc~~siesta_forces~~CallsGraph_edge17" class="edge"><title>proc~siesta_forces&#45;&gt;mixer</title>
<path fill="none" stroke="#000000" d="M40.5098,-1070.93C46.9109,-1021.56 73.2694,-835.498 112,-793 118.219,-786.176 126.792,-781.569 135.495,-778.459"/>
<polygon fill="#000000" stroke="#000000" points="136.677,-781.759 145.258,-775.546 134.675,-775.052 136.677,-781.759"/>
</g>
<!-- proc~compute_dm -->
<g id="proc~~siesta_forces~~CallsGraph_node19" class="node"><title>proc~compute_dm</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node19"><a xlink:href=".././proc/compute_dm.html" xlink:title="compute_dm">
<polygon fill="#d9534f" stroke="#d9534f" points="210,-3296 135,-3296 135,-3272 210,-3272 210,-3296"/>
<text text-anchor="middle" x="172.5" y="-3281.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_dm</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;proc~compute_dm -->
<g id="proc~~siesta_forces~~CallsGraph_edge18" class="edge"><title>proc~siesta_forces&#45;&gt;proc~compute_dm</title>
<path fill="none" stroke="#000000" d="M39.3014,-1095.17C42.0531,-1204.22 63.8263,-2024.49 112,-2688 128.292,-2912.39 159.545,-3183.21 168.834,-3261.7"/>
<polygon fill="#000000" stroke="#000000" points="165.385,-3262.33 170.04,-3271.85 172.336,-3261.51 165.385,-3262.33"/>
</g>
<!-- initwf -->
<g id="proc~~siesta_forces~~CallsGraph_node20" class="node"><title>initwf</title>
<polygon fill="#777777" stroke="#777777" points="199.5,-742 145.5,-742 145.5,-718 199.5,-718 199.5,-742"/>
<text text-anchor="middle" x="172.5" y="-727.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">initwf</text>
</g>
<!-- proc~siesta_forces&#45;&gt;initwf -->
<g id="proc~~siesta_forces~~CallsGraph_edge19" class="edge"><title>proc~siesta_forces&#45;&gt;initwf</title>
<path fill="none" stroke="#000000" d="M40.1188,-1070.69C45.2672,-1016.6 68.317,-800.409 112,-751 118.168,-744.024 126.8,-739.365 135.581,-736.254"/>
<polygon fill="#000000" stroke="#000000" points="136.826,-739.536 145.433,-733.358 134.852,-732.82 136.826,-739.536"/>
</g>
<!-- compute_charge_diff -->
<g id="proc~~siesta_forces~~CallsGraph_node21" class="node"><title>compute_charge_diff</title>
<polygon fill="#777777" stroke="#777777" points="229,-700 116,-700 116,-676 229,-676 229,-700"/>
<text text-anchor="middle" x="172.5" y="-685.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_charge_diff</text>
</g>
<!-- proc~siesta_forces&#45;&gt;compute_charge_diff -->
<g id="proc~~siesta_forces~~CallsGraph_edge20" class="edge"><title>proc~siesta_forces&#45;&gt;compute_charge_diff</title>
<path fill="none" stroke="#000000" d="M39.7861,-1070.74C43.7442,-1012.65 63.2587,-765.463 112,-709 112.866,-707.997 113.782,-707.042 114.743,-706.133"/>
<polygon fill="#000000" stroke="#000000" points="116.982,-708.828 122.865,-700.016 112.771,-703.237 116.982,-708.828"/>
</g>
<!-- write_spmatrix -->
<g id="proc~~siesta_forces~~CallsGraph_node22" class="node"><title>write_spmatrix</title>
<polygon fill="#777777" stroke="#777777" points="213.5,-658 131.5,-658 131.5,-634 213.5,-634 213.5,-658"/>
<text text-anchor="middle" x="172.5" y="-643.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_spmatrix</text>
</g>
<!-- proc~siesta_forces&#45;&gt;write_spmatrix -->
<g id="proc~~siesta_forces~~CallsGraph_edge21" class="edge"><title>proc~siesta_forces&#45;&gt;write_spmatrix</title>
<path fill="none" stroke="#000000" d="M39.5277,-1070.64C42.4176,-1008.48 58.2193,-730.514 112,-667 114.947,-663.52 118.508,-660.617 122.406,-658.194"/>
<polygon fill="#000000" stroke="#000000" points="124.053,-661.284 131.371,-653.622 120.873,-655.048 124.053,-661.284"/>
</g>
<!-- proc~mixers_scf_history_init -->
<g id="proc~~siesta_forces~~CallsGraph_node23" class="node"><title>proc~mixers_scf_history_init</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node23"><a xlink:href=".././proc/mixers_scf_history_init.html" xlink:title="mixers_scf_history_init">
<polygon fill="#d9534f" stroke="#d9534f" points="233,-1242 112,-1242 112,-1218 233,-1218 233,-1242"/>
<text text-anchor="middle" x="172.5" y="-1227.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mixers_scf_history_init</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;proc~mixers_scf_history_init -->
<g id="proc~~siesta_forces~~CallsGraph_edge22" class="edge"><title>proc~siesta_forces&#45;&gt;proc~mixers_scf_history_init</title>
<path fill="none" stroke="#000000" d="M42.8655,-1095.31C51.3318,-1120.31 73.8626,-1177.36 112,-1209 113.581,-1210.31 115.249,-1211.54 116.984,-1212.7"/>
<polygon fill="#000000" stroke="#000000" points="115.688,-1215.99 126.112,-1217.88 119.144,-1209.9 115.688,-1215.99"/>
</g>
<!-- set_tolerance -->
<g id="proc~~siesta_forces~~CallsGraph_node24" class="node"><title>set_tolerance</title>
<polygon fill="#777777" stroke="#777777" points="211,-616 134,-616 134,-592 211,-592 211,-616"/>
<text text-anchor="middle" x="172.5" y="-601.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_tolerance</text>
</g>
<!-- proc~siesta_forces&#45;&gt;set_tolerance -->
<g id="proc~~siesta_forces~~CallsGraph_edge23" class="edge"><title>proc~siesta_forces&#45;&gt;set_tolerance</title>
<path fill="none" stroke="#000000" d="M39.3073,-1070.73C41.1881,-1005.07 53.1055,-695.667 112,-625 115.419,-620.898 119.693,-617.596 124.374,-614.939"/>
<polygon fill="#000000" stroke="#000000" points="126.159,-617.969 133.756,-610.584 123.212,-611.62 126.159,-617.969"/>
</g>
<!-- message -->
<g id="proc~~siesta_forces~~CallsGraph_node25" class="node"><title>message</title>
<polygon fill="#777777" stroke="#777777" points="200.5,-574 144.5,-574 144.5,-550 200.5,-550 200.5,-574"/>
<text text-anchor="middle" x="172.5" y="-559.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">message</text>
</g>
<!-- proc~siesta_forces&#45;&gt;message -->
<g id="proc~~siesta_forces~~CallsGraph_edge24" class="edge"><title>proc~siesta_forces&#45;&gt;message</title>
<path fill="none" stroke="#000000" d="M39.1231,-1070.99C40.0589,-1002.42 47.9202,-660.92 112,-583 117.763,-575.992 126.026,-571.321 134.567,-568.207"/>
<polygon fill="#000000" stroke="#000000" points="135.639,-571.54 144.21,-565.313 133.626,-564.835 135.639,-571.54"/>
</g>
<!-- proc~setup_hamiltonian -->
<g id="proc~~siesta_forces~~CallsGraph_node26" class="node"><title>proc~setup_hamiltonian</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node26"><a xlink:href=".././proc/setup_hamiltonian.html" xlink:title="setup_hamiltonian">
<polygon fill="#d9534f" stroke="#d9534f" points="222.5,-3842 122.5,-3842 122.5,-3818 222.5,-3818 222.5,-3842"/>
<text text-anchor="middle" x="172.5" y="-3827.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_hamiltonian</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;proc~setup_hamiltonian -->
<g id="proc~~siesta_forces~~CallsGraph_edge25" class="edge"><title>proc~siesta_forces&#45;&gt;proc~setup_hamiltonian</title>
<path fill="none" stroke="#000000" d="M39.0021,-1095.1C39.0766,-1276.7 41.4448,-3444.64 112,-3716 121.094,-3750.98 142.477,-3787.3 156.972,-3809.28"/>
<polygon fill="#000000" stroke="#000000" points="154.212,-3811.45 162.707,-3817.78 160.014,-3807.53 154.212,-3811.45"/>
</g>
<!-- bye -->
<g id="proc~~siesta_forces~~CallsGraph_node27" class="node"><title>bye</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-3674 317.5,-3674 317.5,-3650 371.5,-3650 371.5,-3674"/>
<text text-anchor="middle" x="344.5" y="-3659.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bye</text>
</g>
<!-- proc~siesta_forces&#45;&gt;bye -->
<g id="proc~~siesta_forces~~CallsGraph_edge26" class="edge"><title>proc~siesta_forces&#45;&gt;bye</title>
<path fill="none" stroke="#000000" d="M39.1004,-1095.16C40.5103,-1261.25 57.1275,-3075.79 112,-3305 150.376,-3465.3 143.379,-3534.28 269,-3641 279.691,-3650.08 294.051,-3655.25 307.31,-3658.18"/>
<polygon fill="#000000" stroke="#000000" points="306.683,-3661.63 317.155,-3660.02 307.967,-3654.75 306.683,-3661.63"/>
</g>
<!-- proc~state_init&#45;&gt;timer -->
<g id="proc~~siesta_forces~~CallsGraph_edge44" class="edge"><title>proc~state_init&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M174.134,-1284.38C181.749,-1432.93 255.659,-2868.42 269,-2885 278.22,-2896.46 293.171,-2901.96 307.27,-2904.5"/>
<polygon fill="#000000" stroke="#000000" points="306.908,-2907.98 317.29,-2905.87 307.857,-2901.05 306.908,-2907.98"/>
</g>
<!-- proc~state_init&#45;&gt;bye -->
<g id="proc~~siesta_forces~~CallsGraph_edge30" class="edge"><title>proc~state_init&#45;&gt;bye</title>
<path fill="none" stroke="#000000" d="M174.255,-1284.25C179.77,-1374.11 214.157,-1940.72 233,-2402 235.811,-2470.8 226.641,-3586.71 269,-3641 278.046,-3652.59 292.973,-3658.11 307.099,-3660.63"/>
<polygon fill="#000000" stroke="#000000" points="306.771,-3664.12 317.148,-3661.98 307.702,-3657.18 306.771,-3664.12"/>
</g>
<!-- nscold -->
<g id="proc~~siesta_forces~~CallsGraph_node29" class="node"><title>nscold</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-444 317.5,-444 317.5,-420 371.5,-420 371.5,-444"/>
<text text-anchor="middle" x="344.5" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nscold</text>
</g>
<!-- proc~state_init&#45;&gt;nscold -->
<g id="proc~~siesta_forces~~CallsGraph_edge27" class="edge"><title>proc~state_init&#45;&gt;nscold</title>
<path fill="none" stroke="#000000" d="M200.015,-1269.32C212.055,-1266.65 225.298,-1261.38 233,-1251 285.884,-1179.72 213.844,-522.538 269,-453 278.139,-441.478 293.079,-435.969 307.19,-433.438"/>
<polygon fill="#000000" stroke="#000000" points="307.785,-436.89 317.224,-432.078 306.844,-429.953 307.785,-436.89"/>
</g>
<!-- new_dm -->
<g id="proc~~siesta_forces~~CallsGraph_node31" class="node"><title>new_dm</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-402 317.5,-402 317.5,-378 371.5,-378 371.5,-402"/>
<text text-anchor="middle" x="344.5" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">new_dm</text>
</g>
<!-- proc~state_init&#45;&gt;new_dm -->
<g id="proc~~siesta_forces~~CallsGraph_edge29" class="edge"><title>proc~state_init&#45;&gt;new_dm</title>
<path fill="none" stroke="#000000" d="M200.025,-1269.33C212.068,-1266.66 225.31,-1261.39 233,-1251 288.577,-1175.91 211.029,-484.256 269,-411 278.126,-399.468 293.064,-393.958 307.177,-391.428"/>
<polygon fill="#000000" stroke="#000000" points="307.773,-394.88 317.213,-390.07 306.834,-387.943 307.773,-394.88"/>
</g>
<!-- ts_write_tshs -->
<g id="proc~~siesta_forces~~CallsGraph_node33" class="node"><title>ts_write_tshs</title>
<polygon fill="#777777" stroke="#777777" points="382,-360 307,-360 307,-336 382,-336 382,-360"/>
<text text-anchor="middle" x="344.5" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ts_write_tshs</text>
</g>
<!-- proc~state_init&#45;&gt;ts_write_tshs -->
<g id="proc~~siesta_forces~~CallsGraph_edge33" class="edge"><title>proc~state_init&#45;&gt;ts_write_tshs</title>
<path fill="none" stroke="#000000" d="M200.035,-1269.34C212.079,-1266.67 225.321,-1261.4 233,-1251 291.27,-1172.1 208.214,-445.975 269,-369 275.95,-360.199 286.286,-354.904 297.061,-351.765"/>
<polygon fill="#000000" stroke="#000000" points="298.052,-355.128 306.996,-349.45 296.463,-348.311 298.052,-355.128"/>
</g>
<!-- hsparse -->
<g id="proc~~siesta_forces~~CallsGraph_node34" class="node"><title>hsparse</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-318 317.5,-318 317.5,-294 371.5,-294 371.5,-318"/>
<text text-anchor="middle" x="344.5" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hsparse</text>
</g>
<!-- proc~state_init&#45;&gt;hsparse -->
<g id="proc~~siesta_forces~~CallsGraph_edge37" class="edge"><title>proc~state_init&#45;&gt;hsparse</title>
<path fill="none" stroke="#000000" d="M200.043,-1269.34C212.089,-1266.68 225.33,-1261.4 233,-1251 293.964,-1168.3 205.399,-407.693 269,-327 278.103,-315.45 293.038,-309.937 307.155,-307.411"/>
<polygon fill="#000000" stroke="#000000" points="307.753,-310.862 317.195,-306.055 306.817,-303.925 307.753,-310.862"/>
</g>
<!-- get_chess_parameter -->
<g id="proc~~siesta_forces~~CallsGraph_node37" class="node"><title>get_chess_parameter</title>
<polygon fill="#777777" stroke="#777777" points="403,-276 286,-276 286,-252 403,-252 403,-276"/>
<text text-anchor="middle" x="344.5" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_chess_parameter</text>
</g>
<!-- proc~state_init&#45;&gt;get_chess_parameter -->
<g id="proc~~siesta_forces~~CallsGraph_edge52" class="edge"><title>proc~state_init&#45;&gt;get_chess_parameter</title>
<path fill="none" stroke="#000000" d="M200.051,-1269.35C212.099,-1266.69 225.339,-1261.41 233,-1251 296.658,-1164.49 202.584,-369.412 269,-285 271.384,-281.97 274.169,-279.356 277.235,-277.102"/>
<polygon fill="#000000" stroke="#000000" points="279.117,-280.055 285.927,-271.939 275.542,-274.037 279.117,-280.055"/>
</g>
<!-- siesta_write_positions -->
<g id="proc~~siesta_forces~~CallsGraph_node38" class="node"><title>siesta_write_positions</title>
<polygon fill="#777777" stroke="#777777" points="403,-234 286,-234 286,-210 403,-210 403,-234"/>
<text text-anchor="middle" x="344.5" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_write_positions</text>
</g>
<!-- proc~state_init&#45;&gt;siesta_write_positions -->
<g id="proc~~siesta_forces~~CallsGraph_edge53" class="edge"><title>proc~state_init&#45;&gt;siesta_write_positions</title>
<path fill="none" stroke="#000000" d="M200.058,-1269.35C212.108,-1266.69 225.347,-1261.42 233,-1251 299.352,-1160.68 199.768,-331.13 269,-243 271.381,-239.968 274.165,-237.353 277.23,-235.097"/>
<polygon fill="#000000" stroke="#000000" points="279.112,-238.051 285.919,-229.932 275.535,-232.033 279.112,-238.051"/>
</g>
<!-- numh -->
<g id="proc~~siesta_forces~~CallsGraph_node39" class="node"><title>numh</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-192 317.5,-192 317.5,-168 371.5,-168 371.5,-192"/>
<text text-anchor="middle" x="344.5" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">numh</text>
</g>
<!-- proc~state_init&#45;&gt;numh -->
<g id="proc~~siesta_forces~~CallsGraph_edge54" class="edge"><title>proc~state_init&#45;&gt;numh</title>
<path fill="none" stroke="#000000" d="M200.064,-1269.36C212.116,-1266.7 225.354,-1261.42 233,-1251 302.046,-1156.87 196.953,-292.849 269,-201 278.076,-189.429 293.007,-183.913 307.129,-181.39"/>
<polygon fill="#000000" stroke="#000000" points="307.729,-184.841 317.173,-180.038 306.795,-177.903 307.729,-184.841"/>
</g>
<!-- madelung -->
<g id="proc~~siesta_forces~~CallsGraph_node40" class="node"><title>madelung</title>
<polygon fill="#777777" stroke="#777777" points="374.5,-150 314.5,-150 314.5,-126 374.5,-126 374.5,-150"/>
<text text-anchor="middle" x="344.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">madelung</text>
</g>
<!-- proc~state_init&#45;&gt;madelung -->
<g id="proc~~siesta_forces~~CallsGraph_edge57" class="edge"><title>proc~state_init&#45;&gt;madelung</title>
<path fill="none" stroke="#000000" d="M200.07,-1269.36C212.123,-1266.7 225.361,-1261.43 233,-1251 304.74,-1153.07 194.137,-254.569 269,-159 277.453,-148.21 290.996,-142.684 304.233,-139.941"/>
<polygon fill="#000000" stroke="#000000" points="304.884,-143.381 314.205,-138.344 303.778,-136.469 304.884,-143.381"/>
</g>
<!-- escf -->
<g id="proc~~siesta_forces~~CallsGraph_node41" class="node"><title>escf</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-2792 317.5,-2792 317.5,-2768 371.5,-2768 371.5,-2792"/>
<text text-anchor="middle" x="344.5" y="-2777.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">escf</text>
</g>
<!-- proc~state_init&#45;&gt;escf -->
<g id="proc~~siesta_forces~~CallsGraph_edge58" class="edge"><title>proc~state_init&#45;&gt;escf</title>
<path fill="none" stroke="#000000" d="M174.084,-1284.15C180.837,-1424.18 244.369,-2728.55 269,-2759 278.248,-2770.43 293.204,-2775.93 307.298,-2778.48"/>
<polygon fill="#000000" stroke="#000000" points="306.931,-2781.96 317.314,-2779.85 307.882,-2775.02 306.931,-2781.96"/>
</g>
<!-- dict_repopulate_md -->
<g id="proc~~siesta_forces~~CallsGraph_node42" class="node"><title>dict_repopulate_md</title>
<polygon fill="#777777" stroke="#777777" points="398,-108 291,-108 291,-84 398,-84 398,-108"/>
<text text-anchor="middle" x="344.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dict_repopulate_md</text>
</g>
<!-- proc~state_init&#45;&gt;dict_repopulate_md -->
<g id="proc~~siesta_forces~~CallsGraph_edge60" class="edge"><title>proc~state_init&#45;&gt;dict_repopulate_md</title>
<path fill="none" stroke="#000000" d="M200.076,-1269.37C212.13,-1266.71 225.368,-1261.43 233,-1251 307.435,-1149.26 191.321,-216.288 269,-117 272.467,-112.568 276.794,-109.024 281.605,-106.196"/>
<polygon fill="#000000" stroke="#000000" points="283.198,-109.314 290.71,-101.842 280.178,-102.999 283.198,-109.314"/>
</g>
<!-- init_val -->
<g id="proc~~siesta_forces~~CallsGraph_node46" class="node"><title>init_val</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-1952 317.5,-1952 317.5,-1928 371.5,-1928 371.5,-1952"/>
<text text-anchor="middle" x="344.5" y="-1937.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_val</text>
</g>
<!-- proc~state_init&#45;&gt;init_val -->
<g id="proc~~siesta_forces~~CallsGraph_edge73" class="edge"><title>proc~state_init&#45;&gt;init_val</title>
<path fill="none" stroke="#000000" d="M173.557,-1284.06C174.178,-1364.21 181.555,-1819.56 269,-1919 278.546,-1929.86 293.226,-1935.3 307.038,-1937.96"/>
<polygon fill="#000000" stroke="#000000" points="306.925,-1941.48 317.332,-1939.49 307.957,-1934.55 306.925,-1941.48"/>
</g>
<!-- ucell -->
<g id="proc~~siesta_forces~~CallsGraph_node47" class="node"><title>ucell</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-1910 317.5,-1910 317.5,-1886 371.5,-1886 371.5,-1910"/>
<text text-anchor="middle" x="344.5" y="-1895.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ucell</text>
</g>
<!-- proc~state_init&#45;&gt;ucell -->
<g id="proc~~siesta_forces~~CallsGraph_edge78" class="edge"><title>proc~state_init&#45;&gt;ucell</title>
<path fill="none" stroke="#000000" d="M173.691,-1284.02C175.157,-1361.01 186.906,-1784.58 269,-1877 278.601,-1887.81 293.288,-1893.24 307.092,-1895.91"/>
<polygon fill="#000000" stroke="#000000" points="306.969,-1899.43 317.377,-1897.45 308.007,-1892.51 306.969,-1899.43"/>
</g>
<!-- xij_offset -->
<g id="proc~~siesta_forces~~CallsGraph_node48" class="node"><title>xij_offset</title>
<polygon fill="#777777" stroke="#777777" points="372,-1868 317,-1868 317,-1844 372,-1844 372,-1868"/>
<text text-anchor="middle" x="344.5" y="-1853.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xij_offset</text>
</g>
<!-- proc~state_init&#45;&gt;xij_offset -->
<g id="proc~~siesta_forces~~CallsGraph_edge28" class="edge"><title>proc~state_init&#45;&gt;xij_offset</title>
<path fill="none" stroke="#000000" d="M173.849,-1284.14C176.224,-1358.27 192.3,-1749.64 269,-1835 278.519,-1845.59 292.926,-1851.01 306.541,-1853.73"/>
<polygon fill="#000000" stroke="#000000" points="306.284,-1857.23 316.705,-1855.32 307.366,-1850.32 306.284,-1857.23"/>
</g>
<!-- volcel -->
<g id="proc~~siesta_forces~~CallsGraph_node49" class="node"><title>volcel</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-2036 317.5,-2036 317.5,-2012 371.5,-2012 371.5,-2036"/>
<text text-anchor="middle" x="344.5" y="-2021.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">volcel</text>
</g>
<!-- proc~state_init&#45;&gt;volcel -->
<g id="proc~~siesta_forces~~CallsGraph_edge31" class="edge"><title>proc~state_init&#45;&gt;volcel</title>
<path fill="none" stroke="#000000" d="M173.331,-1284.2C172.38,-1370.56 170.844,-1889.49 269,-2003 278.548,-2014.04 293.408,-2019.49 307.353,-2022.11"/>
<polygon fill="#000000" stroke="#000000" points="306.855,-2025.58 317.255,-2023.56 307.865,-2018.65 306.855,-2025.58"/>
</g>
<!-- setup_dm_netcdf_file -->
<g id="proc~~siesta_forces~~CallsGraph_node50" class="node"><title>setup_dm_netcdf_file</title>
<polygon fill="#777777" stroke="#777777" points="402,-1826 287,-1826 287,-1802 402,-1802 402,-1826"/>
<text text-anchor="middle" x="344.5" y="-1811.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_dm_netcdf_file</text>
</g>
<!-- proc~state_init&#45;&gt;setup_dm_netcdf_file -->
<g id="proc~~siesta_forces~~CallsGraph_edge34" class="edge"><title>proc~state_init&#45;&gt;setup_dm_netcdf_file</title>
<path fill="none" stroke="#000000" d="M174.03,-1284.15C177.362,-1355.01 197.642,-1714.64 269,-1793 271.596,-1795.85 274.545,-1798.33 277.736,-1800.47"/>
<polygon fill="#000000" stroke="#000000" points="276.23,-1803.64 286.672,-1805.43 279.625,-1797.52 276.23,-1803.64"/>
</g>
<!-- setup_dmhs_netcdf_file -->
<g id="proc~~siesta_forces~~CallsGraph_node51" class="node"><title>setup_dmhs_netcdf_file</title>
<polygon fill="#777777" stroke="#777777" points="407.5,-1784 281.5,-1784 281.5,-1760 407.5,-1760 407.5,-1784"/>
<text text-anchor="middle" x="344.5" y="-1769.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_dmhs_netcdf_file</text>
</g>
<!-- proc~state_init&#45;&gt;setup_dmhs_netcdf_file -->
<g id="proc~~siesta_forces~~CallsGraph_edge36" class="edge"><title>proc~state_init&#45;&gt;setup_dmhs_netcdf_file</title>
<path fill="none" stroke="#000000" d="M174.234,-1284.04C178.569,-1351.25 202.929,-1679.57 269,-1751 270.223,-1752.32 271.523,-1753.56 272.887,-1754.73"/>
<polygon fill="#000000" stroke="#000000" points="271.124,-1757.77 281.331,-1760.61 275.123,-1752.02 271.124,-1757.77"/>
</g>
<!-- newddata2d -->
<g id="proc~~siesta_forces~~CallsGraph_node53" class="node"><title>newddata2d</title>
<polygon fill="#777777" stroke="#777777" points="380,-1742 309,-1742 309,-1718 380,-1718 380,-1742"/>
<text text-anchor="middle" x="344.5" y="-1727.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">newddata2d</text>
</g>
<!-- proc~state_init&#45;&gt;newddata2d -->
<g id="proc~~siesta_forces~~CallsGraph_edge38" class="edge"><title>proc~state_init&#45;&gt;newddata2d</title>
<path fill="none" stroke="#000000" d="M174.499,-1284.23C179.968,-1348.27 208.292,-1644.56 269,-1709 276.831,-1717.31 287.673,-1722.42 298.664,-1725.53"/>
<polygon fill="#000000" stroke="#000000" points="298.184,-1729.02 308.717,-1727.87 299.768,-1722.2 298.184,-1729.02"/>
</g>
<!-- normalize_dm -->
<g id="proc~~siesta_forces~~CallsGraph_node60" class="node"><title>normalize_dm</title>
<polygon fill="#777777" stroke="#777777" points="384.5,-2750 304.5,-2750 304.5,-2726 384.5,-2726 384.5,-2750"/>
<text text-anchor="middle" x="344.5" y="-2735.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">normalize_dm</text>
</g>
<!-- proc~state_init&#45;&gt;normalize_dm -->
<g id="proc~~siesta_forces~~CallsGraph_edge42" class="edge"><title>proc~state_init&#45;&gt;normalize_dm</title>
<path fill="none" stroke="#000000" d="M174.111,-1284.23C181.041,-1422.49 245.059,-2687.46 269,-2717 275.472,-2724.99 284.729,-2730.08 294.528,-2733.29"/>
<polygon fill="#000000" stroke="#000000" points="293.862,-2736.73 304.425,-2735.91 295.654,-2729.96 293.862,-2736.73"/>
</g>
<!-- setup_kpoint_grid -->
<g id="proc~~siesta_forces~~CallsGraph_node61" class="node"><title>setup_kpoint_grid</title>
<polygon fill="#777777" stroke="#777777" points="393,-1700 296,-1700 296,-1676 393,-1676 393,-1700"/>
<text text-anchor="middle" x="344.5" y="-1685.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_kpoint_grid</text>
</g>
<!-- proc~state_init&#45;&gt;setup_kpoint_grid -->
<g id="proc~~siesta_forces~~CallsGraph_edge46" class="edge"><title>proc~state_init&#45;&gt;setup_kpoint_grid</title>
<path fill="none" stroke="#000000" d="M174.804,-1284.23C181.467,-1344.53 213.572,-1609.45 269,-1667 273.823,-1672.01 279.739,-1675.85 286.109,-1678.79"/>
<polygon fill="#000000" stroke="#000000" points="285.104,-1682.15 295.694,-1682.49 287.624,-1675.62 285.104,-1682.15"/>
</g>
<!-- val -->
<g id="proc~~siesta_forces~~CallsGraph_node63" class="node"><title>val</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-3128 317.5,-3128 317.5,-3104 371.5,-3104 371.5,-3128"/>
<text text-anchor="middle" x="344.5" y="-3113.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">val</text>
</g>
<!-- proc~state_init&#45;&gt;val -->
<g id="proc~~siesta_forces~~CallsGraph_edge55" class="edge"><title>proc~state_init&#45;&gt;val</title>
<path fill="none" stroke="#000000" d="M174.149,-1284.26C178.905,-1374.15 208.887,-1940.97 233,-2402 237.027,-2479 220.88,-3034.76 269,-3095 278.178,-3106.49 293.124,-3111.99 307.229,-3114.53"/>
<polygon fill="#000000" stroke="#000000" points="306.875,-3118.01 317.256,-3115.9 307.82,-3111.08 306.875,-3118.01"/>
</g>
<!-- attach -->
<g id="proc~~siesta_forces~~CallsGraph_node66" class="node"><title>attach</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-1658 317.5,-1658 317.5,-1634 371.5,-1634 371.5,-1658"/>
<text text-anchor="middle" x="344.5" y="-1643.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">attach</text>
</g>
<!-- proc~state_init&#45;&gt;attach -->
<g id="proc~~siesta_forces~~CallsGraph_edge61" class="edge"><title>proc~state_init&#45;&gt;attach</title>
<path fill="none" stroke="#000000" d="M175.152,-1284.04C183.062,-1340.02 218.762,-1574.23 269,-1625 279.093,-1635.2 293.728,-1640.54 307.36,-1643.31"/>
<polygon fill="#000000" stroke="#000000" points="307.064,-1646.81 317.497,-1644.96 308.189,-1639.9 307.064,-1646.81"/>
</g>
<!-- mscell -->
<g id="proc~~siesta_forces~~CallsGraph_node67" class="node"><title>mscell</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-1616 317.5,-1616 317.5,-1592 371.5,-1592 371.5,-1616"/>
<text text-anchor="middle" x="344.5" y="-1601.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mscell</text>
</g>
<!-- proc~state_init&#45;&gt;mscell -->
<g id="proc~~siesta_forces~~CallsGraph_edge67" class="edge"><title>proc~state_init&#45;&gt;mscell</title>
<path fill="none" stroke="#000000" d="M173.605,-1284.15C174.661,-1329.48 184.458,-1490.6 269,-1578 279.094,-1588.44 293.599,-1594.69 307.133,-1598.43"/>
<polygon fill="#000000" stroke="#000000" points="306.665,-1601.92 317.204,-1600.83 308.289,-1595.11 306.665,-1601.92"/>
</g>
<!-- proc~mixers_history_init -->
<g id="proc~~siesta_forces~~CallsGraph_node68" class="node"><title>proc~mixers_history_init</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node68"><a xlink:href=".././proc/mixers_history_init.html" xlink:title="mixers_history_init">
<polygon fill="#d9534f" stroke="#d9534f" points="395,-66 294,-66 294,-42 395,-42 395,-66"/>
<text text-anchor="middle" x="344.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mixers_history_init</text>
</a>
</g>
</g>
<!-- proc~state_init&#45;&gt;proc~mixers_history_init -->
<g id="proc~~siesta_forces~~CallsGraph_edge71" class="edge"><title>proc~state_init&#45;&gt;proc~mixers_history_init</title>
<path fill="none" stroke="#000000" d="M200.081,-1269.37C212.136,-1266.71 225.374,-1261.44 233,-1251 310.129,-1145.45 188.506,-178.007 269,-75 273.073,-69.7885 278.333,-65.8046 284.174,-62.7691"/>
<polygon fill="#000000" stroke="#000000" points="285.885,-65.8461 293.743,-58.7393 283.169,-59.3948 285.885,-65.8461"/>
</g>
<!-- iotdxv -->
<g id="proc~~siesta_forces~~CallsGraph_node70" class="node"><title>iotdxv</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-1536 317.5,-1536 317.5,-1512 371.5,-1512 371.5,-1536"/>
<text text-anchor="middle" x="344.5" y="-1521.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iotdxv</text>
</g>
<!-- proc~state_init&#45;&gt;iotdxv -->
<g id="proc~~siesta_forces~~CallsGraph_edge74" class="edge"><title>proc~state_init&#45;&gt;iotdxv</title>
<path fill="none" stroke="#000000" d="M174.831,-1284.16C179.682,-1322.45 199.921,-1441.58 269,-1503 279.564,-1512.39 294.024,-1517.61 307.396,-1520.5"/>
<polygon fill="#000000" stroke="#000000" points="306.864,-1523.96 317.326,-1522.29 308.104,-1517.07 306.864,-1523.96"/>
</g>
<!-- isc_off -->
<g id="proc~~siesta_forces~~CallsGraph_node71" class="node"><title>isc_off</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-1494 317.5,-1494 317.5,-1470 371.5,-1470 371.5,-1494"/>
<text text-anchor="middle" x="344.5" y="-1479.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">isc_off</text>
</g>
<!-- proc~state_init&#45;&gt;isc_off -->
<g id="proc~~siesta_forces~~CallsGraph_edge75" class="edge"><title>proc~state_init&#45;&gt;isc_off</title>
<path fill="none" stroke="#000000" d="M176.087,-1284.32C183.818,-1318 209.968,-1412.39 269,-1461 279.723,-1469.83 293.933,-1474.95 307.066,-1477.92"/>
<polygon fill="#000000" stroke="#000000" points="306.801,-1481.43 317.28,-1479.87 308.113,-1474.56 306.801,-1481.43"/>
</g>
<!-- time_io -->
<g id="proc~~siesta_forces~~CallsGraph_node73" class="node"><title>time_io</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-1452 317.5,-1452 317.5,-1428 371.5,-1428 371.5,-1452"/>
<text text-anchor="middle" x="344.5" y="-1437.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">time_io</text>
</g>
<!-- proc~state_init&#45;&gt;time_io -->
<g id="proc~~siesta_forces~~CallsGraph_edge76" class="edge"><title>proc~state_init&#45;&gt;time_io</title>
<path fill="none" stroke="#000000" d="M178.009,-1284.42C188.961,-1312.79 219.742,-1382.73 269,-1419 280.1,-1427.17 294.266,-1432.17 307.259,-1435.22"/>
<polygon fill="#000000" stroke="#000000" points="306.849,-1438.71 317.346,-1437.27 308.246,-1431.85 306.849,-1438.71"/>
</g>
<!-- superc -->
<g id="proc~~siesta_forces~~CallsGraph_node75" class="node"><title>superc</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-1410 317.5,-1410 317.5,-1386 371.5,-1386 371.5,-1410"/>
<text text-anchor="middle" x="344.5" y="-1395.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">superc</text>
</g>
<!-- proc~state_init&#45;&gt;superc -->
<g id="proc~~siesta_forces~~CallsGraph_edge77" class="edge"><title>proc~state_init&#45;&gt;superc</title>
<path fill="none" stroke="#000000" d="M181.101,-1284.08C195.511,-1305.98 228.968,-1352.25 269,-1377 280.544,-1384.14 294.576,-1388.91 307.335,-1392.08"/>
<polygon fill="#000000" stroke="#000000" points="306.7,-1395.52 317.223,-1394.28 308.226,-1388.69 306.7,-1395.52"/>
</g>
<!-- newdspdata1d -->
<g id="proc~~siesta_forces~~CallsGraph_node77" class="node"><title>newdspdata1d</title>
<polygon fill="#777777" stroke="#777777" points="385.5,-1368 303.5,-1368 303.5,-1344 385.5,-1344 385.5,-1368"/>
<text text-anchor="middle" x="344.5" y="-1353.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">newdspdata1d</text>
</g>
<!-- proc~state_init&#45;&gt;newdspdata1d -->
<g id="proc~~siesta_forces~~CallsGraph_edge40" class="edge"><title>proc~state_init&#45;&gt;newdspdata1d</title>
<path fill="none" stroke="#000000" d="M188.515,-1284.05C206.632,-1298.05 238.473,-1321.04 269,-1335 276.73,-1338.54 285.187,-1341.61 293.542,-1344.22"/>
<polygon fill="#000000" stroke="#000000" points="292.67,-1347.62 303.252,-1347.09 294.653,-1340.9 292.67,-1347.62"/>
</g>
<!-- setup_ordern_indexes -->
<g id="proc~~siesta_forces~~CallsGraph_node79" class="node"><title>setup_ordern_indexes</title>
<polygon fill="#777777" stroke="#777777" points="404,-1326 285,-1326 285,-1302 404,-1302 404,-1326"/>
<text text-anchor="middle" x="344.5" y="-1311.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_ordern_indexes</text>
</g>
<!-- proc~state_init&#45;&gt;setup_ordern_indexes -->
<g id="proc~~siesta_forces~~CallsGraph_edge45" class="edge"><title>proc~state_init&#45;&gt;setup_ordern_indexes</title>
<path fill="none" stroke="#000000" d="M200.062,-1278.56C222.7,-1284.16 256.057,-1292.4 284.907,-1299.52"/>
<polygon fill="#000000" stroke="#000000" points="284.351,-1302.99 294.899,-1301.99 286.03,-1296.2 284.351,-1302.99"/>
</g>
<!-- delete -->
<g id="proc~~siesta_forces~~CallsGraph_node80" class="node"><title>delete</title>
<polygon fill="#777777" stroke="#777777" points="513.5,-853 459.5,-853 459.5,-829 513.5,-829 513.5,-853"/>
<text text-anchor="middle" x="486.5" y="-838.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">delete</text>
</g>
<!-- proc~state_init&#45;&gt;delete -->
<g id="proc~~siesta_forces~~CallsGraph_edge49" class="edge"><title>proc~state_init&#45;&gt;delete</title>
<path fill="none" stroke="#000000" d="M173.287,-1284.07C173.245,-1328.23 179.73,-1481.65 269,-1545 323.731,-1583.84 370.396,-1590.2 420,-1545 471.64,-1497.94 483.235,-977.784 485.168,-863.23"/>
<polygon fill="#000000" stroke="#000000" points="488.669,-863.223 485.33,-853.167 481.67,-863.11 488.669,-863.223"/>
</g>
<!-- ts_tri_analyze -->
<g id="proc~~siesta_forces~~CallsGraph_node83" class="node"><title>ts_tri_analyze</title>
<polygon fill="#777777" stroke="#777777" points="384,-1284 305,-1284 305,-1260 384,-1260 384,-1284"/>
<text text-anchor="middle" x="344.5" y="-1269.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ts_tri_analyze</text>
</g>
<!-- proc~state_init&#45;&gt;ts_tri_analyze -->
<g id="proc~~siesta_forces~~CallsGraph_edge59" class="edge"><title>proc~state_init&#45;&gt;ts_tri_analyze</title>
<path fill="none" stroke="#000000" d="M200.062,-1272C225.316,-1272 263.909,-1272 294.704,-1272"/>
<polygon fill="#000000" stroke="#000000" points="294.818,-1275.5 304.818,-1272 294.818,-1268.5 294.818,-1275.5"/>
</g>
<!-- globalize_or -->
<g id="proc~~siesta_forces~~CallsGraph_node85" class="node"><title>globalize_or</title>
<polygon fill="#777777" stroke="#777777" points="379.5,-1242 309.5,-1242 309.5,-1218 379.5,-1218 379.5,-1242"/>
<text text-anchor="middle" x="344.5" y="-1227.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">globalize_or</text>
</g>
<!-- proc~state_init&#45;&gt;globalize_or -->
<g id="proc~~siesta_forces~~CallsGraph_edge62" class="edge"><title>proc~state_init&#45;&gt;globalize_or</title>
<path fill="none" stroke="#000000" d="M200.062,-1265.44C226.606,-1258.88 267.885,-1248.68 299.357,-1240.91"/>
<polygon fill="#000000" stroke="#000000" points="300.332,-1244.27 309.2,-1238.47 298.653,-1237.47 300.332,-1244.27"/>
</g>
<!-- re_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_node89" class="node"><title>re_alloc</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-3086 317.5,-3086 317.5,-3062 371.5,-3062 371.5,-3086"/>
<text text-anchor="middle" x="344.5" y="-3071.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">re_alloc</text>
</g>
<!-- proc~state_init&#45;&gt;re_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge66" class="edge"><title>proc~state_init&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M174.148,-1284.31C182.419,-1441.45 267.16,-3050.7 269,-3053 278.188,-3064.48 293.135,-3069.99 307.238,-3072.52"/>
<polygon fill="#000000" stroke="#000000" points="306.883,-3076.01 317.264,-3073.89 307.828,-3069.07 306.883,-3076.01"/>
</g>
<!-- domaindecom -->
<g id="proc~~siesta_forces~~CallsGraph_node93" class="node"><title>domaindecom</title>
<polygon fill="#777777" stroke="#777777" points="384.5,-1200 304.5,-1200 304.5,-1176 384.5,-1176 384.5,-1200"/>
<text text-anchor="middle" x="344.5" y="-1185.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">domaindecom</text>
</g>
<!-- proc~state_init&#45;&gt;domaindecom -->
<g id="proc~~siesta_forces~~CallsGraph_edge50" class="edge"><title>proc~state_init&#45;&gt;domaindecom</title>
<path fill="none" stroke="#000000" d="M200.082,-1265.86C210.901,-1262.56 223.15,-1257.75 233,-1251 253.281,-1237.1 248.281,-1222.24 269,-1209 276.734,-1204.06 285.644,-1200.26 294.552,-1197.35"/>
<polygon fill="#000000" stroke="#000000" points="295.557,-1200.7 304.162,-1194.52 293.58,-1193.98 295.557,-1200.7"/>
</g>
<!-- proximity_check -->
<g id="proc~~siesta_forces~~CallsGraph_node95" class="node"><title>proximity_check</title>
<polygon fill="#777777" stroke="#777777" points="389,-1158 300,-1158 300,-1134 389,-1134 389,-1158"/>
<text text-anchor="middle" x="344.5" y="-1143.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">proximity_check</text>
</g>
<!-- proc~state_init&#45;&gt;proximity_check -->
<g id="proc~~siesta_forces~~CallsGraph_edge79" class="edge"><title>proc~state_init&#45;&gt;proximity_check</title>
<path fill="none" stroke="#000000" d="M200.299,-1267.5C211.537,-1264.45 224.045,-1259.39 233,-1251 262.647,-1223.24 238.472,-1193.79 269,-1167 275.103,-1161.64 282.476,-1157.65 290.18,-1154.66"/>
<polygon fill="#000000" stroke="#000000" points="291.291,-1157.98 299.677,-1151.51 289.083,-1151.34 291.291,-1157.98"/>
</g>
<!-- sporb_to_spatom -->
<g id="proc~~siesta_forces~~CallsGraph_node96" class="node"><title>sporb_to_spatom</title>
<polygon fill="#777777" stroke="#777777" points="392.5,-1116 296.5,-1116 296.5,-1092 392.5,-1092 392.5,-1116"/>
<text text-anchor="middle" x="344.5" y="-1101.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sporb_to_spatom</text>
</g>
<!-- proc~state_init&#45;&gt;sporb_to_spatom -->
<g id="proc~~siesta_forces~~CallsGraph_edge69" class="edge"><title>proc~state_init&#45;&gt;sporb_to_spatom</title>
<path fill="none" stroke="#000000" d="M200.213,-1268.18C211.708,-1265.25 224.443,-1260.1 233,-1251 272.908,-1208.58 227.744,-1166.11 269,-1125 273.989,-1120.03 280.057,-1116.21 286.553,-1113.29"/>
<polygon fill="#000000" stroke="#000000" points="288.183,-1116.41 296.303,-1109.61 285.711,-1109.87 288.183,-1116.41"/>
</g>
<!-- ts_sparse_init -->
<g id="proc~~siesta_forces~~CallsGraph_node97" class="node"><title>ts_sparse_init</title>
<polygon fill="#777777" stroke="#777777" points="384,-1074 305,-1074 305,-1050 384,-1050 384,-1074"/>
<text text-anchor="middle" x="344.5" y="-1059.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ts_sparse_init</text>
</g>
<!-- proc~state_init&#45;&gt;ts_sparse_init -->
<g id="proc~~siesta_forces~~CallsGraph_edge80" class="edge"><title>proc~state_init&#45;&gt;ts_sparse_init</title>
<path fill="none" stroke="#000000" d="M200.196,-1268.52C211.829,-1265.66 224.681,-1260.46 233,-1251 283.426,-1193.66 216.75,-1138.69 269,-1083 275.965,-1075.58 285.331,-1070.71 295.068,-1067.53"/>
<polygon fill="#000000" stroke="#000000" points="296.111,-1070.88 304.852,-1064.89 294.285,-1064.12 296.111,-1070.88"/>
</g>
<!-- file_exist -->
<g id="proc~~siesta_forces~~CallsGraph_node99" class="node"><title>file_exist</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-1032 317.5,-1032 317.5,-1008 371.5,-1008 371.5,-1032"/>
<text text-anchor="middle" x="344.5" y="-1017.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">file_exist</text>
</g>
<!-- proc~state_init&#45;&gt;file_exist -->
<g id="proc~~siesta_forces~~CallsGraph_edge32" class="edge"><title>proc~state_init&#45;&gt;file_exist</title>
<path fill="none" stroke="#000000" d="M200.071,-1268.74C211.823,-1265.94 224.808,-1260.71 233,-1251 294.05,-1178.61 205.646,-1111.38 269,-1041 278.672,-1030.26 293.371,-1024.83 307.164,-1022.16"/>
<polygon fill="#000000" stroke="#000000" points="308.073,-1025.56 317.437,-1020.6 307.026,-1018.64 308.073,-1025.56"/>
</g>
<!-- fname_tshs -->
<g id="proc~~siesta_forces~~CallsGraph_node100" class="node"><title>fname_tshs</title>
<polygon fill="#777777" stroke="#777777" points="378.5,-990 310.5,-990 310.5,-966 378.5,-966 378.5,-990"/>
<text text-anchor="middle" x="344.5" y="-975.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fname_tshs</text>
</g>
<!-- proc~state_init&#45;&gt;fname_tshs -->
<g id="proc~~siesta_forces~~CallsGraph_edge35" class="edge"><title>proc~state_init&#45;&gt;fname_tshs</title>
<path fill="none" stroke="#000000" d="M200.193,-1268.84C211.972,-1266.06 224.944,-1260.83 233,-1251 304.728,-1163.51 194.487,-1084.13 269,-999 277.021,-989.836 288.699,-984.529 300.44,-981.496"/>
<polygon fill="#000000" stroke="#000000" points="301.166,-984.92 310.238,-979.448 299.734,-978.068 301.166,-984.92"/>
</g>
<!-- crtsparsity_sc -->
<g id="proc~~siesta_forces~~CallsGraph_node101" class="node"><title>crtsparsity_sc</title>
<polygon fill="#777777" stroke="#777777" points="383.5,-948 305.5,-948 305.5,-924 383.5,-924 383.5,-948"/>
<text text-anchor="middle" x="344.5" y="-933.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">crtsparsity_sc</text>
</g>
<!-- proc~state_init&#45;&gt;crtsparsity_sc -->
<g id="proc~~siesta_forces~~CallsGraph_edge39" class="edge"><title>proc~state_init&#45;&gt;crtsparsity_sc</title>
<path fill="none" stroke="#000000" d="M200.282,-1268.92C212.08,-1266.15 225.043,-1260.91 233,-1251 315.435,-1148.36 183.296,-1056.92 269,-957 275.829,-949.038 285.419,-943.979 295.452,-940.793"/>
<polygon fill="#000000" stroke="#000000" points="296.333,-944.181 305.132,-938.279 294.573,-937.406 296.333,-944.181"/>
</g>
<!-- newdspdata2d -->
<g id="proc~~siesta_forces~~CallsGraph_node104" class="node"><title>newdspdata2d</title>
<polygon fill="#777777" stroke="#777777" points="385.5,-906 303.5,-906 303.5,-882 385.5,-882 385.5,-906"/>
<text text-anchor="middle" x="344.5" y="-891.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">newdspdata2d</text>
</g>
<!-- proc~state_init&#45;&gt;newdspdata2d -->
<g id="proc~~siesta_forces~~CallsGraph_edge41" class="edge"><title>proc~state_init&#45;&gt;newdspdata2d</title>
<path fill="none" stroke="#000000" d="M200.044,-1269.04C211.938,-1266.3 225.05,-1261.05 233,-1251 326.161,-1133.2 172.087,-1029.74 269,-915 275.371,-907.457 284.223,-902.514 293.605,-899.3"/>
<polygon fill="#000000" stroke="#000000" points="294.803,-902.599 303.494,-896.54 292.921,-895.857 294.803,-902.599"/>
</g>
<!-- listhptr -->
<g id="proc~~siesta_forces~~CallsGraph_node105" class="node"><title>listhptr</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-864 317.5,-864 317.5,-840 371.5,-840 371.5,-864"/>
<text text-anchor="middle" x="344.5" y="-849.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">listhptr</text>
</g>
<!-- proc~state_init&#45;&gt;listhptr -->
<g id="proc~~siesta_forces~~CallsGraph_edge43" class="edge"><title>proc~state_init&#45;&gt;listhptr</title>
<path fill="none" stroke="#000000" d="M200.097,-1269.08C212.003,-1266.35 225.109,-1261.1 233,-1251 284.95,-1184.51 214.932,-937.781 269,-873 278.423,-861.709 293.405,-856.234 307.47,-853.666"/>
<polygon fill="#000000" stroke="#000000" points="308.039,-857.121 317.457,-852.268 307.068,-850.188 308.039,-857.121"/>
</g>
<!-- setup_ts_kpoint_grid -->
<g id="proc~~siesta_forces~~CallsGraph_node108" class="node"><title>setup_ts_kpoint_grid</title>
<polygon fill="#777777" stroke="#777777" points="400.5,-822 288.5,-822 288.5,-798 400.5,-798 400.5,-822"/>
<text text-anchor="middle" x="344.5" y="-807.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_ts_kpoint_grid</text>
</g>
<!-- proc~state_init&#45;&gt;setup_ts_kpoint_grid -->
<g id="proc~~siesta_forces~~CallsGraph_edge47" class="edge"><title>proc~state_init&#45;&gt;setup_ts_kpoint_grid</title>
<path fill="none" stroke="#000000" d="M200.139,-1269.12C212.055,-1266.39 225.157,-1261.14 233,-1251 290.323,-1176.91 209.316,-903.201 269,-831 271.97,-827.407 275.503,-824.403 279.391,-821.893"/>
<polygon fill="#000000" stroke="#000000" points="281.176,-824.909 288.393,-817.152 277.914,-818.715 281.176,-824.909"/>
</g>
<!-- nsc -->
<g id="proc~~siesta_forces~~CallsGraph_node110" class="node"><title>nsc</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-780 317.5,-780 317.5,-756 371.5,-756 371.5,-780"/>
<text text-anchor="middle" x="344.5" y="-765.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nsc</text>
</g>
<!-- proc~state_init&#45;&gt;nsc -->
<g id="proc~~siesta_forces~~CallsGraph_edge48" class="edge"><title>proc~state_init&#45;&gt;nsc</title>
<path fill="none" stroke="#000000" d="M200.174,-1269.14C212.098,-1266.43 225.196,-1261.17 233,-1251 295.7,-1169.31 203.697,-868.624 269,-789 278.326,-777.629 293.293,-772.142 307.374,-769.587"/>
<polygon fill="#000000" stroke="#000000" points="307.952,-773.04 317.377,-768.202 306.992,-766.106 307.952,-773.04"/>
</g>
<!-- write_debug -->
<g id="proc~~siesta_forces~~CallsGraph_node111" class="node"><title>write_debug</title>
<polygon fill="#777777" stroke="#777777" points="380,-1994 309,-1994 309,-1970 380,-1970 380,-1994"/>
<text text-anchor="middle" x="344.5" y="-1979.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_debug</text>
</g>
<!-- proc~state_init&#45;&gt;write_debug -->
<g id="proc~~siesta_forces~~CallsGraph_edge51" class="edge"><title>proc~state_init&#45;&gt;write_debug</title>
<path fill="none" stroke="#000000" d="M173.438,-1284.03C173.253,-1367.03 176.166,-1854.49 269,-1961 276.648,-1969.78 287.651,-1975.02 298.862,-1978.11"/>
<polygon fill="#000000" stroke="#000000" points="298.165,-1981.54 308.689,-1980.31 299.695,-1974.71 298.165,-1981.54"/>
</g>
<!-- overlap -->
<g id="proc~~siesta_forces~~CallsGraph_node112" class="node"><title>overlap</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-738 317.5,-738 317.5,-714 371.5,-714 371.5,-738"/>
<text text-anchor="middle" x="344.5" y="-723.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">overlap</text>
</g>
<!-- proc~state_init&#45;&gt;overlap -->
<g id="proc~~siesta_forces~~CallsGraph_edge56" class="edge"><title>proc~state_init&#45;&gt;overlap</title>
<path fill="none" stroke="#000000" d="M200.203,-1269.16C212.133,-1266.45 225.229,-1261.19 233,-1251 301.079,-1161.71 198.075,-834.05 269,-747 278.289,-735.599 293.251,-730.108 307.338,-727.557"/>
<polygon fill="#000000" stroke="#000000" points="307.919,-731.01 317.347,-726.177 306.963,-724.076 307.919,-731.01"/>
</g>
<!-- outcoor -->
<g id="proc~~siesta_forces~~CallsGraph_node114" class="node"><title>outcoor</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-696 317.5,-696 317.5,-672 371.5,-672 371.5,-696"/>
<text text-anchor="middle" x="344.5" y="-681.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">outcoor</text>
</g>
<!-- proc~state_init&#45;&gt;outcoor -->
<g id="proc~~siesta_forces~~CallsGraph_edge63" class="edge"><title>proc~state_init&#45;&gt;outcoor</title>
<path fill="none" stroke="#000000" d="M200.227,-1269.18C212.164,-1266.48 225.257,-1261.21 233,-1251 306.46,-1154.1 192.452,-799.478 269,-705 278.258,-693.574 293.215,-688.079 307.307,-685.532"/>
<polygon fill="#000000" stroke="#000000" points="307.891,-688.985 317.322,-684.157 306.938,-682.05 307.891,-688.985"/>
</g>
<!-- chess_init -->
<g id="proc~~siesta_forces~~CallsGraph_node115" class="node"><title>chess_init</title>
<polygon fill="#777777" stroke="#777777" points="374.5,-654 314.5,-654 314.5,-630 374.5,-630 374.5,-654"/>
<text text-anchor="middle" x="344.5" y="-639.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">chess_init</text>
</g>
<!-- proc~state_init&#45;&gt;chess_init -->
<g id="proc~~siesta_forces~~CallsGraph_edge64" class="edge"><title>proc~state_init&#45;&gt;chess_init</title>
<path fill="none" stroke="#000000" d="M200.249,-1269.2C212.19,-1266.5 225.281,-1261.23 233,-1251 311.842,-1146.49 186.827,-764.908 269,-663 277.604,-652.33 291.178,-646.829 304.397,-644.071"/>
<polygon fill="#000000" stroke="#000000" points="305.037,-647.513 314.348,-642.458 303.916,-640.604 305.037,-647.513"/>
</g>
<!-- ioxv -->
<g id="proc~~siesta_forces~~CallsGraph_node117" class="node"><title>ioxv</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-612 317.5,-612 317.5,-588 371.5,-588 371.5,-612"/>
<text text-anchor="middle" x="344.5" y="-597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ioxv</text>
</g>
<!-- proc~state_init&#45;&gt;ioxv -->
<g id="proc~~siesta_forces~~CallsGraph_edge65" class="edge"><title>proc~state_init&#45;&gt;ioxv</title>
<path fill="none" stroke="#000000" d="M200.267,-1269.21C212.212,-1266.51 225.302,-1261.25 233,-1251 317.226,-1138.88 181.201,-730.34 269,-621 278.208,-609.533 293.158,-604.032 307.258,-601.493"/>
<polygon fill="#000000" stroke="#000000" points="307.846,-604.945 317.28,-600.124 306.899,-598.009 307.846,-604.945"/>
</g>
<!-- sp_to_spglobal -->
<g id="proc~~siesta_forces~~CallsGraph_node118" class="node"><title>sp_to_spglobal</title>
<polygon fill="#777777" stroke="#777777" points="387,-570 302,-570 302,-546 387,-546 387,-570"/>
<text text-anchor="middle" x="344.5" y="-555.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sp_to_spglobal</text>
</g>
<!-- proc~state_init&#45;&gt;sp_to_spglobal -->
<g id="proc~~siesta_forces~~CallsGraph_edge68" class="edge"><title>proc~state_init&#45;&gt;sp_to_spglobal</title>
<path fill="none" stroke="#000000" d="M200.283,-1269.23C212.232,-1266.53 225.32,-1261.26 233,-1251 322.61,-1131.27 175.574,-695.773 269,-579 274.857,-571.679 283.055,-566.789 291.882,-563.549"/>
<polygon fill="#000000" stroke="#000000" points="293.045,-566.854 301.627,-560.642 291.044,-560.146 293.045,-566.854"/>
</g>
<!-- newsparsity -->
<g id="proc~~siesta_forces~~CallsGraph_node119" class="node"><title>newsparsity</title>
<polygon fill="#777777" stroke="#777777" points="379,-528 310,-528 310,-504 379,-504 379,-528"/>
<text text-anchor="middle" x="344.5" y="-513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">newsparsity</text>
</g>
<!-- proc~state_init&#45;&gt;newsparsity -->
<g id="proc~~siesta_forces~~CallsGraph_edge70" class="edge"><title>proc~state_init&#45;&gt;newsparsity</title>
<path fill="none" stroke="#000000" d="M200.297,-1269.24C212.25,-1266.54 225.336,-1261.27 233,-1251 327.995,-1123.66 169.946,-661.207 269,-537 276.593,-527.479 288.147,-522.067 299.905,-519.048"/>
<polygon fill="#000000" stroke="#000000" points="300.65,-522.468 309.747,-517.038 299.249,-515.61 300.65,-522.468"/>
</g>
<!-- write_zmatrix -->
<g id="proc~~siesta_forces~~CallsGraph_node121" class="node"><title>write_zmatrix</title>
<polygon fill="#777777" stroke="#777777" points="382.5,-486 306.5,-486 306.5,-462 382.5,-462 382.5,-486"/>
<text text-anchor="middle" x="344.5" y="-471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_zmatrix</text>
</g>
<!-- proc~state_init&#45;&gt;write_zmatrix -->
<g id="proc~~siesta_forces~~CallsGraph_edge72" class="edge"><title>proc~state_init&#45;&gt;write_zmatrix</title>
<path fill="none" stroke="#000000" d="M200.004,-1269.31C212.041,-1266.64 225.285,-1261.37 233,-1251 333.381,-1116.05 164.317,-626.642 269,-495 275.852,-486.384 285.948,-481.131 296.509,-477.972"/>
<polygon fill="#000000" stroke="#000000" points="297.358,-481.368 306.26,-475.623 295.719,-474.563 297.358,-481.368"/>
</g>
<!-- proc~compute_max_diff_2d -->
<g id="proc~~siesta_forces~~CallsGraph_node76" class="node"><title>proc~compute_max_diff_2d</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node76"><a xlink:href=".././proc/compute_max_diff_2d.html" xlink:title="compute_max_diff_2d">
<polygon fill="#d9534f" stroke="#d9534f" points="403.5,-4174 285.5,-4174 285.5,-4150 403.5,-4150 403.5,-4174"/>
<text text-anchor="middle" x="344.5" y="-4159.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_max_diff_2d</text>
</a>
</g>
</g>
<!-- interface~compute_max_diff&#45;&gt;proc~compute_max_diff_2d -->
<g id="proc~~siesta_forces~~CallsGraph_edge82" class="edge"><title>interface~compute_max_diff&#45;&gt;proc~compute_max_diff_2d</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M222.671,-4162C239.066,-4162 257.637,-4162 275.215,-4162"/>
<polygon fill="#000000" stroke="#000000" points="275.427,-4165.5 285.427,-4162 275.427,-4158.5 275.427,-4165.5"/>
</g>
<!-- proc~compute_max_diff_1d -->
<g id="proc~~siesta_forces~~CallsGraph_node94" class="node"><title>proc~compute_max_diff_1d</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node94"><a xlink:href=".././proc/compute_max_diff_1d.html" xlink:title="compute_max_diff_1d">
<polygon fill="#d9534f" stroke="#d9534f" points="403.5,-4216 285.5,-4216 285.5,-4192 403.5,-4192 403.5,-4216"/>
<text text-anchor="middle" x="344.5" y="-4201.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_max_diff_1d</text>
</a>
</g>
</g>
<!-- interface~compute_max_diff&#45;&gt;proc~compute_max_diff_1d -->
<g id="proc~~siesta_forces~~CallsGraph_edge81" class="edge"><title>interface~compute_max_diff&#45;&gt;proc~compute_max_diff_1d</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M222.215,-4174.04C241.777,-4178.87 264.495,-4184.48 284.945,-4189.53"/>
<polygon fill="#000000" stroke="#000000" points="284.23,-4192.96 294.778,-4191.96 285.909,-4186.17 284.23,-4192.96"/>
</g>
<!-- proc~mixing_scf_converged&#45;&gt;reset -->
<g id="proc~~siesta_forces~~CallsGraph_edge83" class="edge"><title>proc~mixing_scf_converged&#45;&gt;reset</title>
<path fill="none" stroke="#000000" d="M223.537,-927.906C227.155,-925.461 230.397,-922.525 233,-919 291.527,-839.742 207.946,-110.329 269,-33 278.113,-21.4577 293.049,-15.9461 307.165,-13.4184"/>
<polygon fill="#000000" stroke="#000000" points="307.762,-16.8697 317.203,-12.0617 306.824,-9.93273 307.762,-16.8697"/>
</g>
<!-- proc~state_analysis&#45;&gt;timer -->
<g id="proc~~siesta_forces~~CallsGraph_edge90" class="edge"><title>proc~state_analysis&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M176.979,-2435.25C186.8,-2470.14 215.184,-2573.14 233,-2660 243.175,-2709.6 235.333,-2847.18 269,-2885 278.612,-2895.8 293.302,-2901.23 307.104,-2903.9"/>
<polygon fill="#000000" stroke="#000000" points="306.978,-2907.42 317.387,-2905.44 308.018,-2900.5 306.978,-2907.42"/>
</g>
<!-- moments -->
<g id="proc~~siesta_forces~~CallsGraph_node28" class="node"><title>moments</title>
<polygon fill="#777777" stroke="#777777" points="373,-3002 316,-3002 316,-2978 373,-2978 373,-3002"/>
<text text-anchor="middle" x="344.5" y="-2987.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">moments</text>
</g>
<!-- proc~state_analysis&#45;&gt;moments -->
<g id="proc~~siesta_forces~~CallsGraph_edge84" class="edge"><title>proc~state_analysis&#45;&gt;moments</title>
<path fill="none" stroke="#000000" d="M173.923,-2435.24C176.691,-2508.32 194.499,-2886.52 269,-2969 278.403,-2979.41 292.525,-2984.82 305.954,-2987.58"/>
<polygon fill="#000000" stroke="#000000" points="305.567,-2991.06 315.999,-2989.21 306.69,-2984.15 305.567,-2991.06"/>
</g>
<!-- cartesianforce_to_zmatforce -->
<g id="proc~~siesta_forces~~CallsGraph_node36" class="node"><title>cartesianforce_to_zmatforce</title>
<polygon fill="#777777" stroke="#777777" points="418.5,-2456 270.5,-2456 270.5,-2432 418.5,-2432 418.5,-2456"/>
<text text-anchor="middle" x="344.5" y="-2441.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cartesianforce_to_zmatforce</text>
</g>
<!-- proc~state_analysis&#45;&gt;cartesianforce_to_zmatforce -->
<g id="proc~~siesta_forces~~CallsGraph_edge93" class="edge"><title>proc~state_analysis&#45;&gt;cartesianforce_to_zmatforce</title>
<path fill="none" stroke="#000000" d="M212.501,-2427.82C226.708,-2429.57 243.367,-2431.63 259.953,-2433.68"/>
<polygon fill="#000000" stroke="#000000" points="259.894,-2437.2 270.247,-2434.95 260.752,-2430.25 259.894,-2437.2"/>
</g>
<!-- update_freee -->
<g id="proc~~siesta_forces~~CallsGraph_node44" class="node"><title>update_freee</title>
<polygon fill="#777777" stroke="#777777" points="382.5,-2414 306.5,-2414 306.5,-2390 382.5,-2390 382.5,-2414"/>
<text text-anchor="middle" x="344.5" y="-2399.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_freee</text>
</g>
<!-- proc~state_analysis&#45;&gt;update_freee -->
<g id="proc~~siesta_forces~~CallsGraph_edge102" class="edge"><title>proc~state_analysis&#45;&gt;update_freee</title>
<path fill="none" stroke="#000000" d="M212.501,-2418.18C237.425,-2415.1 269.899,-2411.09 296.278,-2407.83"/>
<polygon fill="#000000" stroke="#000000" points="296.934,-2411.28 306.429,-2406.58 296.075,-2404.33 296.934,-2411.28"/>
</g>
<!-- remove_intramol_pressure -->
<g id="proc~~siesta_forces~~CallsGraph_node45" class="node"><title>remove_intramol_pressure</title>
<polygon fill="#777777" stroke="#777777" points="415,-2288 274,-2288 274,-2264 415,-2264 415,-2288"/>
<text text-anchor="middle" x="344.5" y="-2273.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">remove_intramol_pressure</text>
</g>
<!-- proc~state_analysis&#45;&gt;remove_intramol_pressure -->
<g id="proc~~siesta_forces~~CallsGraph_edge104" class="edge"><title>proc~state_analysis&#45;&gt;remove_intramol_pressure</title>
<path fill="none" stroke="#000000" d="M179.261,-2410.86C191.855,-2385.66 224.326,-2327.46 269,-2297 271.528,-2295.28 274.195,-2293.69 276.957,-2292.24"/>
<polygon fill="#000000" stroke="#000000" points="278.448,-2295.41 286.045,-2288.02 275.501,-2289.06 278.448,-2295.41"/>
</g>
<!-- proc~state_analysis&#45;&gt;volcel -->
<g id="proc~~siesta_forces~~CallsGraph_edge85" class="edge"><title>proc~state_analysis&#45;&gt;volcel</title>
<path fill="none" stroke="#000000" d="M174.93,-2410.9C182.069,-2352.44 215.659,-2099.82 269,-2045 279.007,-2034.72 293.628,-2029.36 307.272,-2026.6"/>
<polygon fill="#000000" stroke="#000000" points="308.107,-2030.02 317.423,-2024.97 306.994,-2023.1 308.107,-2030.02"/>
</g>
<!-- kin_stress -->
<g id="proc~~siesta_forces~~CallsGraph_node52" class="node"><title>kin_stress</title>
<polygon fill="#777777" stroke="#777777" points="375,-2246 314,-2246 314,-2222 375,-2222 375,-2246"/>
<text text-anchor="middle" x="344.5" y="-2231.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">kin_stress</text>
</g>
<!-- proc~state_analysis&#45;&gt;kin_stress -->
<g id="proc~~siesta_forces~~CallsGraph_edge86" class="edge"><title>proc~state_analysis&#45;&gt;kin_stress</title>
<path fill="none" stroke="#000000" d="M176.913,-2410.7C186.185,-2379.62 214.85,-2297.4 269,-2255 279.002,-2247.17 291.775,-2242.26 303.91,-2239.18"/>
<polygon fill="#000000" stroke="#000000" points="304.857,-2242.55 313.878,-2237 303.361,-2235.71 304.857,-2242.55"/>
</g>
<!-- siesta_write_forces -->
<g id="proc~~siesta_forces~~CallsGraph_node56" class="node"><title>siesta_write_forces</title>
<polygon fill="#777777" stroke="#777777" points="396.5,-2372 292.5,-2372 292.5,-2348 396.5,-2348 396.5,-2372"/>
<text text-anchor="middle" x="344.5" y="-2357.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_write_forces</text>
</g>
<!-- proc~state_analysis&#45;&gt;siesta_write_forces -->
<g id="proc~~siesta_forces~~CallsGraph_edge87" class="edge"><title>proc~state_analysis&#45;&gt;siesta_write_forces</title>
<path fill="none" stroke="#000000" d="M198.247,-2410.98C217.303,-2402 244.451,-2389.81 269,-2381 274.893,-2378.89 281.109,-2376.84 287.335,-2374.92"/>
<polygon fill="#000000" stroke="#000000" points="288.507,-2378.22 297.082,-2372 286.498,-2371.52 288.507,-2378.22"/>
</g>
<!-- cmlendmodule -->
<g id="proc~~siesta_forces~~CallsGraph_node57" class="node"><title>cmlendmodule</title>
<polygon fill="#777777" stroke="#777777" points="385.5,-2330 303.5,-2330 303.5,-2306 385.5,-2306 385.5,-2330"/>
<text text-anchor="middle" x="344.5" y="-2315.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cmlendmodule</text>
</g>
<!-- proc~state_analysis&#45;&gt;cmlendmodule -->
<g id="proc~~siesta_forces~~CallsGraph_edge88" class="edge"><title>proc~state_analysis&#45;&gt;cmlendmodule</title>
<path fill="none" stroke="#000000" d="M183.976,-2410.81C200.321,-2392.56 233.696,-2358.2 269,-2339 276.552,-2334.89 284.981,-2331.53 293.378,-2328.79"/>
<polygon fill="#000000" stroke="#000000" points="294.592,-2332.08 303.166,-2325.86 292.582,-2325.37 294.592,-2332.08"/>
</g>
<!-- cmlstartmodule -->
<g id="proc~~siesta_forces~~CallsGraph_node64" class="node"><title>cmlstartmodule</title>
<polygon fill="#777777" stroke="#777777" points="387,-2204 302,-2204 302,-2180 387,-2180 387,-2204"/>
<text text-anchor="middle" x="344.5" y="-2189.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cmlstartmodule</text>
</g>
<!-- proc~state_analysis&#45;&gt;cmlstartmodule -->
<g id="proc~~siesta_forces~~CallsGraph_edge96" class="edge"><title>proc~state_analysis&#45;&gt;cmlstartmodule</title>
<path fill="none" stroke="#000000" d="M175.371,-2410.92C181.58,-2375.01 204.878,-2268.04 269,-2213 275.596,-2207.34 283.615,-2203.2 291.917,-2200.17"/>
<polygon fill="#000000" stroke="#000000" points="293.226,-2203.43 301.725,-2197.1 291.136,-2196.75 293.226,-2203.43"/>
</g>
<!-- update_freeeharris -->
<g id="proc~~siesta_forces~~CallsGraph_node65" class="node"><title>update_freeeharris</title>
<polygon fill="#777777" stroke="#777777" points="396,-2162 293,-2162 293,-2138 396,-2138 396,-2162"/>
<text text-anchor="middle" x="344.5" y="-2147.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_freeeharris</text>
</g>
<!-- proc~state_analysis&#45;&gt;update_freeeharris -->
<g id="proc~~siesta_forces~~CallsGraph_edge97" class="edge"><title>proc~state_analysis&#45;&gt;update_freeeharris</title>
<path fill="none" stroke="#000000" d="M174.357,-2410.91C177.882,-2370.51 194.829,-2238.95 269,-2171 273.211,-2167.14 278.077,-2163.99 283.265,-2161.41"/>
<polygon fill="#000000" stroke="#000000" points="285.022,-2164.46 292.878,-2157.36 282.304,-2158.01 285.022,-2164.46"/>
</g>
<!-- fixed -->
<g id="proc~~siesta_forces~~CallsGraph_node69" class="node"><title>fixed</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-2120 317.5,-2120 317.5,-2096 371.5,-2096 371.5,-2120"/>
<text text-anchor="middle" x="344.5" y="-2105.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fixed</text>
</g>
<!-- proc~state_analysis&#45;&gt;fixed -->
<g id="proc~~siesta_forces~~CallsGraph_edge103" class="edge"><title>proc~state_analysis&#45;&gt;fixed</title>
<path fill="none" stroke="#000000" d="M173.613,-2410.85C174.71,-2366.27 184.662,-2210.08 269,-2129 279.267,-2119.13 293.802,-2113.83 307.311,-2111.01"/>
<polygon fill="#000000" stroke="#000000" points="308.082,-2114.43 317.354,-2109.31 306.909,-2107.53 308.082,-2114.43"/>
</g>
<!-- cmladdproperty -->
<g id="proc~~siesta_forces~~CallsGraph_node82" class="node"><title>cmladdproperty</title>
<polygon fill="#777777" stroke="#777777" points="388,-2078 301,-2078 301,-2054 388,-2054 388,-2078"/>
<text text-anchor="middle" x="344.5" y="-2063.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cmladdproperty</text>
</g>
<!-- proc~state_analysis&#45;&gt;cmladdproperty -->
<g id="proc~~siesta_forces~~CallsGraph_edge95" class="edge"><title>proc~state_analysis&#45;&gt;cmladdproperty</title>
<path fill="none" stroke="#000000" d="M173.039,-2410.86C171.897,-2362.47 174.343,-2181.45 269,-2087 275.153,-2080.86 282.954,-2076.48 291.176,-2073.37"/>
<polygon fill="#000000" stroke="#000000" points="292.478,-2076.63 300.949,-2070.26 290.358,-2069.96 292.478,-2076.63"/>
</g>
<!-- eggbox -->
<g id="proc~~siesta_forces~~CallsGraph_node87" class="node"><title>eggbox</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-2876 317.5,-2876 317.5,-2852 371.5,-2852 371.5,-2876"/>
<text text-anchor="middle" x="344.5" y="-2861.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">eggbox</text>
</g>
<!-- proc~state_analysis&#45;&gt;eggbox -->
<g id="proc~~siesta_forces~~CallsGraph_edge100" class="edge"><title>proc~state_analysis&#45;&gt;eggbox</title>
<path fill="none" stroke="#000000" d="M176.823,-2435.28C186.234,-2470.26 213.642,-2573.48 233,-2660 251.098,-2740.89 212.793,-2782.08 269,-2843 278.73,-2853.55 293.305,-2858.95 306.99,-2861.66"/>
<polygon fill="#000000" stroke="#000000" points="306.766,-2865.17 317.186,-2863.26 307.846,-2858.25 306.766,-2865.17"/>
</g>
<!-- wallclock -->
<g id="proc~~siesta_forces~~CallsGraph_node88" class="node"><title>wallclock</title>
<polygon fill="#777777" stroke="#777777" points="372,-2834 317,-2834 317,-2810 372,-2810 372,-2834"/>
<text text-anchor="middle" x="344.5" y="-2819.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">wallclock</text>
</g>
<!-- proc~state_analysis&#45;&gt;wallclock -->
<g id="proc~~siesta_forces~~CallsGraph_edge101" class="edge"><title>proc~state_analysis&#45;&gt;wallclock</title>
<path fill="none" stroke="#000000" d="M176.54,-2435.12C192.735,-2499.66 268.157,-2800.13 269,-2801 278.858,-2811.13 293.192,-2816.48 306.661,-2819.27"/>
<polygon fill="#000000" stroke="#000000" points="306.264,-2822.75 316.703,-2820.94 307.412,-2815.85 306.264,-2822.75"/>
</g>
<!-- print_spin -->
<g id="proc~~siesta_forces~~CallsGraph_node92" class="node"><title>print_spin</title>
<polygon fill="#777777" stroke="#777777" points="374,-2708 315,-2708 315,-2684 374,-2684 374,-2708"/>
<text text-anchor="middle" x="344.5" y="-2693.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_spin</text>
</g>
<!-- proc~state_analysis&#45;&gt;print_spin -->
<g id="proc~~siesta_forces~~CallsGraph_edge106" class="edge"><title>proc~state_analysis&#45;&gt;print_spin</title>
<path fill="none" stroke="#000000" d="M174.357,-2435.09C177.882,-2475.49 194.829,-2607.05 269,-2675 278.773,-2683.95 292.074,-2689.12 304.735,-2692.1"/>
<polygon fill="#000000" stroke="#000000" points="304.184,-2695.56 314.671,-2694.04 305.529,-2688.69 304.184,-2695.56"/>
</g>
<!-- amass -->
<g id="proc~~siesta_forces~~CallsGraph_node102" class="node"><title>amass</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-2666 317.5,-2666 317.5,-2642 371.5,-2642 371.5,-2666"/>
<text text-anchor="middle" x="344.5" y="-2651.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">amass</text>
</g>
<!-- proc~state_analysis&#45;&gt;amass -->
<g id="proc~~siesta_forces~~CallsGraph_edge89" class="edge"><title>proc~state_analysis&#45;&gt;amass</title>
<path fill="none" stroke="#000000" d="M175.371,-2435.08C181.58,-2470.99 204.878,-2577.96 269,-2633 279.725,-2642.21 294.215,-2647.39 307.564,-2650.31"/>
<polygon fill="#000000" stroke="#000000" points="307.002,-2653.76 317.469,-2652.12 308.264,-2646.88 307.002,-2653.76"/>
</g>
<!-- va -->
<g id="proc~~siesta_forces~~CallsGraph_node106" class="node"><title>va</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-2540 317.5,-2540 317.5,-2516 371.5,-2516 371.5,-2540"/>
<text text-anchor="middle" x="344.5" y="-2525.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">va</text>
</g>
<!-- proc~state_analysis&#45;&gt;va -->
<g id="proc~~siesta_forces~~CallsGraph_edge91" class="edge"><title>proc~state_analysis&#45;&gt;va</title>
<path fill="none" stroke="#000000" d="M183.976,-2435.19C200.321,-2453.44 233.696,-2487.8 269,-2507 280.83,-2513.43 294.814,-2518.05 307.453,-2521.28"/>
<polygon fill="#000000" stroke="#000000" points="306.698,-2524.7 317.234,-2523.59 308.304,-2517.89 306.698,-2524.7"/>
</g>
<!-- siesta_write_stress_pressure -->
<g id="proc~~siesta_forces~~CallsGraph_node109" class="node"><title>siesta_write_stress_pressure</title>
<polygon fill="#777777" stroke="#777777" points="420,-2498 269,-2498 269,-2474 420,-2474 420,-2498"/>
<text text-anchor="middle" x="344.5" y="-2483.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_write_stress_pressure</text>
</g>
<!-- proc~state_analysis&#45;&gt;siesta_write_stress_pressure -->
<g id="proc~~siesta_forces~~CallsGraph_edge92" class="edge"><title>proc~state_analysis&#45;&gt;siesta_write_stress_pressure</title>
<path fill="none" stroke="#000000" d="M198.247,-2435.02C217.303,-2444 244.451,-2456.19 269,-2465 274.893,-2467.11 281.109,-2469.16 287.335,-2471.08"/>
<polygon fill="#000000" stroke="#000000" points="286.498,-2474.48 297.082,-2474 288.507,-2467.78 286.498,-2474.48"/>
</g>
<!-- proc~state_analysis&#45;&gt;write_debug -->
<g id="proc~~siesta_forces~~CallsGraph_edge94" class="edge"><title>proc~state_analysis&#45;&gt;write_debug</title>
<path fill="none" stroke="#000000" d="M174.609,-2410.84C180.535,-2348.42 210.412,-2064.67 269,-2003 276.866,-1994.72 287.72,-1989.62 298.711,-1986.51"/>
<polygon fill="#000000" stroke="#000000" points="299.814,-1989.85 308.761,-1984.17 298.228,-1983.03 299.814,-1989.85"/>
</g>
<!-- mulliken -->
<g id="proc~~siesta_forces~~CallsGraph_node113" class="node"><title>mulliken</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-2960 317.5,-2960 317.5,-2936 371.5,-2936 371.5,-2960"/>
<text text-anchor="middle" x="344.5" y="-2945.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mulliken</text>
</g>
<!-- proc~state_analysis&#45;&gt;mulliken -->
<g id="proc~~siesta_forces~~CallsGraph_edge98" class="edge"><title>proc~state_analysis&#45;&gt;mulliken</title>
<path fill="none" stroke="#000000" d="M174.114,-2435.2C177.861,-2504.84 199.817,-2851.48 269,-2927 278.693,-2937.58 293.262,-2942.99 306.952,-2945.7"/>
<polygon fill="#000000" stroke="#000000" points="306.736,-2949.21 317.155,-2947.28 307.812,-2942.29 306.736,-2949.21"/>
</g>
<!-- slua_call -->
<g id="proc~~siesta_forces~~CallsGraph_node116" class="node"><title>slua_call</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-2624 317.5,-2624 317.5,-2600 371.5,-2600 371.5,-2624"/>
<text text-anchor="middle" x="344.5" y="-2609.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">slua_call</text>
</g>
<!-- proc~state_analysis&#45;&gt;slua_call -->
<g id="proc~~siesta_forces~~CallsGraph_edge99" class="edge"><title>proc~state_analysis&#45;&gt;slua_call</title>
<path fill="none" stroke="#000000" d="M176.913,-2435.3C186.185,-2466.38 214.85,-2548.6 269,-2591 279.936,-2599.56 294.187,-2604.64 307.293,-2607.64"/>
<polygon fill="#000000" stroke="#000000" points="306.987,-2611.15 317.473,-2609.63 308.331,-2604.28 306.987,-2611.15"/>
</g>
<!-- born_charge -->
<g id="proc~~siesta_forces~~CallsGraph_node123" class="node"><title>born_charge</title>
<polygon fill="#777777" stroke="#777777" points="381,-2582 308,-2582 308,-2558 381,-2558 381,-2582"/>
<text text-anchor="middle" x="344.5" y="-2567.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">born_charge</text>
</g>
<!-- proc~state_analysis&#45;&gt;born_charge -->
<g id="proc~~siesta_forces~~CallsGraph_edge105" class="edge"><title>proc~state_analysis&#45;&gt;born_charge</title>
<path fill="none" stroke="#000000" d="M179.261,-2435.14C191.855,-2460.34 224.326,-2518.54 269,-2549 277.577,-2554.85 287.761,-2559.08 297.802,-2562.14"/>
<polygon fill="#000000" stroke="#000000" points="297.163,-2565.59 307.73,-2564.82 298.989,-2558.83 297.163,-2565.59"/>
</g>
<!-- proc~compute_dm&#45;&gt;timer -->
<g id="proc~~siesta_forces~~CallsGraph_edge113" class="edge"><title>proc~compute_dm&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M175.132,-3271.82C182.951,-3215.22 218.304,-2978.38 269,-2927 279.078,-2916.79 293.711,-2911.44 307.345,-2908.68"/>
<polygon fill="#000000" stroke="#000000" points="308.175,-2912.09 317.484,-2907.03 307.053,-2905.18 308.175,-2912.09"/>
</g>
<!-- proc~compute_dm&#45;&gt;transiesta -->
<g id="proc~~siesta_forces~~CallsGraph_edge115" class="edge"><title>proc~compute_dm&#45;&gt;transiesta</title>
<path fill="none" stroke="#000000" d="M174.786,-3296.36C181.36,-3357.25 213.108,-3624.84 269,-3683 278.331,-3692.71 291.772,-3698.04 304.676,-3700.92"/>
<polygon fill="#000000" stroke="#000000" points="304.359,-3704.42 314.821,-3702.75 305.601,-3697.53 304.359,-3704.42"/>
</g>
<!-- proc~compute_dm&#45;&gt;bye -->
<g id="proc~~siesta_forces~~CallsGraph_edge128" class="edge"><title>proc~compute_dm&#45;&gt;bye</title>
<path fill="none" stroke="#000000" d="M177.592,-3296.23C187.749,-3326.81 214.618,-3409.17 233,-3479 251.777,-3550.33 218.329,-3587.4 269,-3641 278.858,-3651.43 293.454,-3656.81 307.12,-3659.54"/>
<polygon fill="#000000" stroke="#000000" points="306.871,-3663.05 317.296,-3661.15 307.967,-3656.13 306.871,-3663.05"/>
</g>
<!-- proc~compute_dm&#45;&gt;moments -->
<g id="proc~~siesta_forces~~CallsGraph_edge107" class="edge"><title>proc~compute_dm&#45;&gt;moments</title>
<path fill="none" stroke="#000000" d="M173.962,-3271.83C176.255,-3229.23 189.794,-3085.46 269,-3011 278.889,-3001.7 292.571,-2996.47 305.514,-2993.55"/>
<polygon fill="#000000" stroke="#000000" points="306.458,-2996.93 315.649,-2991.66 305.178,-2990.05 306.458,-2996.93"/>
</g>
<!-- compute_ebs_shift -->
<g id="proc~~siesta_forces~~CallsGraph_node35" class="node"><title>compute_ebs_shift</title>
<polygon fill="#777777" stroke="#777777" points="396,-3338 293,-3338 293,-3314 396,-3314 396,-3338"/>
<text text-anchor="middle" x="344.5" y="-3323.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_ebs_shift</text>
</g>
<!-- proc~compute_dm&#45;&gt;compute_ebs_shift -->
<g id="proc~~siesta_forces~~CallsGraph_edge111" class="edge"><title>proc~compute_dm&#45;&gt;compute_ebs_shift</title>
<path fill="none" stroke="#000000" d="M210.387,-3293.11C232.102,-3298.48 260.063,-3305.39 284.748,-3311.48"/>
<polygon fill="#000000" stroke="#000000" points="284.193,-3314.95 294.74,-3313.95 285.872,-3308.16 284.193,-3314.95"/>
</g>
<!-- proc~compute_dm&#45;&gt;escf -->
<g id="proc~~siesta_forces~~CallsGraph_edge119" class="edge"><title>proc~compute_dm&#45;&gt;escf</title>
<path fill="none" stroke="#000000" d="M174.219,-3271.86C178.471,-3204.1 202.456,-2873.06 269,-2801 278.735,-2790.46 293.311,-2785.06 306.995,-2782.34"/>
<polygon fill="#000000" stroke="#000000" points="307.851,-2785.75 317.191,-2780.75 306.77,-2778.83 307.851,-2785.75"/>
</g>
<!-- ordern -->
<g id="proc~~siesta_forces~~CallsGraph_node43" class="node"><title>ordern</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-3296 317.5,-3296 317.5,-3272 371.5,-3272 371.5,-3296"/>
<text text-anchor="middle" x="344.5" y="-3281.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ordern</text>
</g>
<!-- proc~compute_dm&#45;&gt;ordern -->
<g id="proc~~siesta_forces~~CallsGraph_edge121" class="edge"><title>proc~compute_dm&#45;&gt;ordern</title>
<path fill="none" stroke="#000000" d="M210.387,-3284C239.049,-3284 278.593,-3284 307.124,-3284"/>
<polygon fill="#000000" stroke="#000000" points="307.474,-3287.5 317.474,-3284 307.474,-3280.5 307.474,-3287.5"/>
</g>
<!-- write_orb_indx -->
<g id="proc~~siesta_forces~~CallsGraph_node58" class="node"><title>write_orb_indx</title>
<polygon fill="#777777" stroke="#777777" points="385.5,-3254 303.5,-3254 303.5,-3230 385.5,-3230 385.5,-3254"/>
<text text-anchor="middle" x="344.5" y="-3239.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_orb_indx</text>
</g>
<!-- proc~compute_dm&#45;&gt;write_orb_indx -->
<g id="proc~~siesta_forces~~CallsGraph_edge108" class="edge"><title>proc~compute_dm&#45;&gt;write_orb_indx</title>
<path fill="none" stroke="#000000" d="M210.387,-3274.89C234.719,-3268.88 266.894,-3260.93 293.516,-3254.35"/>
<polygon fill="#000000" stroke="#000000" points="294.551,-3257.7 303.419,-3251.9 292.872,-3250.9 294.551,-3257.7"/>
</g>
<!-- dminim -->
<g id="proc~~siesta_forces~~CallsGraph_node59" class="node"><title>dminim</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-3212 317.5,-3212 317.5,-3188 371.5,-3188 371.5,-3212"/>
<text text-anchor="middle" x="344.5" y="-3197.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dminim</text>
</g>
<!-- proc~compute_dm&#45;&gt;dminim -->
<g id="proc~~siesta_forces~~CallsGraph_edge110" class="edge"><title>proc~compute_dm&#45;&gt;dminim</title>
<path fill="none" stroke="#000000" d="M188.515,-3271.95C206.632,-3257.95 238.473,-3234.96 269,-3221 281.03,-3215.5 294.823,-3211.12 307.246,-3207.82"/>
<polygon fill="#000000" stroke="#000000" points="308.443,-3211.13 317.289,-3205.3 306.738,-3204.34 308.443,-3211.13"/>
</g>
<!-- proc~compute_dm&#45;&gt;normalize_dm -->
<g id="proc~~siesta_forces~~CallsGraph_edge112" class="edge"><title>proc~compute_dm&#45;&gt;normalize_dm</title>
<path fill="none" stroke="#000000" d="M174.016,-3271.76C177.267,-3200.36 197.165,-2837.99 269,-2759 275.781,-2751.54 284.983,-2746.65 294.606,-2743.47"/>
<polygon fill="#000000" stroke="#000000" points="295.573,-2746.83 304.294,-2740.82 293.725,-2740.08 295.573,-2746.83"/>
</g>
<!-- pexsi_solver -->
<g id="proc~~siesta_forces~~CallsGraph_node62" class="node"><title>pexsi_solver</title>
<polygon fill="#777777" stroke="#777777" points="380.5,-3170 308.5,-3170 308.5,-3146 380.5,-3146 380.5,-3170"/>
<text text-anchor="middle" x="344.5" y="-3155.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pexsi_solver</text>
</g>
<!-- proc~compute_dm&#45;&gt;pexsi_solver -->
<g id="proc~~siesta_forces~~CallsGraph_edge116" class="edge"><title>proc~compute_dm&#45;&gt;pexsi_solver</title>
<path fill="none" stroke="#000000" d="M181.101,-3271.92C195.511,-3250.02 228.968,-3203.75 269,-3179 278.008,-3173.43 288.531,-3169.3 298.782,-3166.25"/>
<polygon fill="#000000" stroke="#000000" points="299.72,-3169.62 308.468,-3163.65 297.902,-3162.86 299.72,-3169.62"/>
</g>
<!-- proc~compute_dm&#45;&gt;val -->
<g id="proc~~siesta_forces~~CallsGraph_edge118" class="edge"><title>proc~compute_dm&#45;&gt;val</title>
<path fill="none" stroke="#000000" d="M178.009,-3271.58C188.961,-3243.21 219.742,-3173.27 269,-3137 280.1,-3128.83 294.266,-3123.83 307.259,-3120.78"/>
<polygon fill="#000000" stroke="#000000" points="308.246,-3124.15 317.346,-3118.73 306.849,-3117.29 308.246,-3124.15"/>
</g>
<!-- write_dmh_netcdf -->
<g id="proc~~siesta_forces~~CallsGraph_node72" class="node"><title>write_dmh_netcdf</title>
<polygon fill="#777777" stroke="#777777" points="393,-3044 296,-3044 296,-3020 393,-3020 393,-3044"/>
<text text-anchor="middle" x="344.5" y="-3029.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_dmh_netcdf</text>
</g>
<!-- proc~compute_dm&#45;&gt;write_dmh_netcdf -->
<g id="proc~~siesta_forces~~CallsGraph_edge127" class="edge"><title>proc~compute_dm&#45;&gt;write_dmh_netcdf</title>
<path fill="none" stroke="#000000" d="M174.831,-3271.84C179.682,-3233.55 199.921,-3114.42 269,-3053 274.061,-3048.5 280.015,-3044.96 286.316,-3042.17"/>
<polygon fill="#000000" stroke="#000000" points="287.62,-3045.42 295.732,-3038.61 285.141,-3038.87 287.62,-3045.42"/>
</g>
<!-- chess_wrapper -->
<g id="proc~~siesta_forces~~CallsGraph_node81" class="node"><title>chess_wrapper</title>
<polygon fill="#777777" stroke="#777777" points="387,-3632 302,-3632 302,-3608 387,-3608 387,-3632"/>
<text text-anchor="middle" x="344.5" y="-3617.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">chess_wrapper</text>
</g>
<!-- proc~compute_dm&#45;&gt;chess_wrapper -->
<g id="proc~~siesta_forces~~CallsGraph_edge117" class="edge"><title>proc~compute_dm&#45;&gt;chess_wrapper</title>
<path fill="none" stroke="#000000" d="M177.279,-3296.31C186.722,-3327.1 212.089,-3409.89 233,-3479 249.125,-3532.3 229.3,-3559.96 269,-3599 275.404,-3605.3 283.544,-3609.74 292.075,-3612.86"/>
<polygon fill="#000000" stroke="#000000" points="291.215,-3616.26 301.802,-3615.86 293.276,-3609.57 291.215,-3616.26"/>
</g>
<!-- dscf -->
<g id="proc~~siesta_forces~~CallsGraph_node84" class="node"><title>dscf</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-3758 317.5,-3758 317.5,-3734 371.5,-3734 371.5,-3758"/>
<text text-anchor="middle" x="344.5" y="-3743.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dscf</text>
</g>
<!-- proc~compute_dm&#45;&gt;dscf -->
<g id="proc~~siesta_forces~~CallsGraph_edge122" class="edge"><title>proc~compute_dm&#45;&gt;dscf</title>
<path fill="none" stroke="#000000" d="M174.482,-3296.34C179.866,-3360.96 207.823,-3659.94 269,-3725 278.83,-3735.45 293.421,-3740.84 307.092,-3743.57"/>
<polygon fill="#000000" stroke="#000000" points="306.848,-3747.07 317.272,-3745.18 307.94,-3740.16 306.848,-3747.07"/>
</g>
<!-- zminim -->
<g id="proc~~siesta_forces~~CallsGraph_node86" class="node"><title>zminim</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-3590 317.5,-3590 317.5,-3566 371.5,-3566 371.5,-3590"/>
<text text-anchor="middle" x="344.5" y="-3575.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">zminim</text>
</g>
<!-- proc~compute_dm&#45;&gt;zminim -->
<g id="proc~~siesta_forces~~CallsGraph_edge123" class="edge"><title>proc~compute_dm&#45;&gt;zminim</title>
<path fill="none" stroke="#000000" d="M177.032,-3296.16C191.789,-3346.63 248.696,-3537.91 269,-3557 279.377,-3566.76 293.931,-3572.03 307.425,-3574.87"/>
<polygon fill="#000000" stroke="#000000" points="307.001,-3578.35 317.45,-3576.59 308.189,-3571.45 307.001,-3578.35"/>
</g>
<!-- diagon -->
<g id="proc~~siesta_forces~~CallsGraph_node90" class="node"><title>diagon</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-3548 317.5,-3548 317.5,-3524 371.5,-3524 371.5,-3548"/>
<text text-anchor="middle" x="344.5" y="-3533.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">diagon</text>
</g>
<!-- proc~compute_dm&#45;&gt;diagon -->
<g id="proc~~siesta_forces~~CallsGraph_edge125" class="edge"><title>proc~compute_dm&#45;&gt;diagon</title>
<path fill="none" stroke="#000000" d="M174.831,-3296.16C179.682,-3334.45 199.921,-3453.58 269,-3515 279.564,-3524.39 294.024,-3529.61 307.396,-3532.5"/>
<polygon fill="#000000" stroke="#000000" points="306.864,-3535.96 317.326,-3534.29 308.104,-3529.07 306.864,-3535.96"/>
</g>
<!-- dold -->
<g id="proc~~siesta_forces~~CallsGraph_node103" class="node"><title>dold</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-3506 317.5,-3506 317.5,-3482 371.5,-3482 371.5,-3506"/>
<text text-anchor="middle" x="344.5" y="-3491.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dold</text>
</g>
<!-- proc~compute_dm&#45;&gt;dold -->
<g id="proc~~siesta_forces~~CallsGraph_edge109" class="edge"><title>proc~compute_dm&#45;&gt;dold</title>
<path fill="none" stroke="#000000" d="M176.087,-3296.32C183.818,-3330 209.968,-3424.39 269,-3473 279.723,-3481.83 293.933,-3486.95 307.066,-3489.92"/>
<polygon fill="#000000" stroke="#000000" points="306.801,-3493.43 317.28,-3491.87 308.113,-3486.56 306.801,-3493.43"/>
</g>
<!-- write_hs_formatted -->
<g id="proc~~siesta_forces~~CallsGraph_node107" class="node"><title>write_hs_formatted</title>
<polygon fill="#777777" stroke="#777777" points="396.5,-3464 292.5,-3464 292.5,-3440 396.5,-3440 396.5,-3464"/>
<text text-anchor="middle" x="344.5" y="-3449.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_hs_formatted</text>
</g>
<!-- proc~compute_dm&#45;&gt;write_hs_formatted -->
<g id="proc~~siesta_forces~~CallsGraph_edge114" class="edge"><title>proc~compute_dm&#45;&gt;write_hs_formatted</title>
<path fill="none" stroke="#000000" d="M178.009,-3296.42C188.961,-3324.79 219.742,-3394.73 269,-3431 273.22,-3434.11 277.884,-3436.76 282.757,-3439.01"/>
<polygon fill="#000000" stroke="#000000" points="281.745,-3442.38 292.327,-3442.89 284.372,-3435.89 281.745,-3442.38"/>
</g>
<!-- proc~compute_dm&#45;&gt;mulliken -->
<g id="proc~~siesta_forces~~CallsGraph_edge120" class="edge"><title>proc~compute_dm&#45;&gt;mulliken</title>
<path fill="none" stroke="#000000" d="M173.309,-3271.97C173.252,-3225.62 179.439,-3056.82 269,-2969 279.169,-2959.03 293.687,-2953.71 307.21,-2950.91"/>
<polygon fill="#000000" stroke="#000000" points="307.988,-2954.33 317.269,-2949.22 306.827,-2947.43 307.988,-2954.33"/>
</g>
<!-- mpi_bcast -->
<g id="proc~~siesta_forces~~CallsGraph_node120" class="node"><title>mpi_bcast</title>
<polygon fill="#777777" stroke="#777777" points="375,-3422 314,-3422 314,-3398 375,-3398 375,-3422"/>
<text text-anchor="middle" x="344.5" y="-3407.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_bcast</text>
</g>
<!-- proc~compute_dm&#45;&gt;mpi_bcast -->
<g id="proc~~siesta_forces~~CallsGraph_edge124" class="edge"><title>proc~compute_dm&#45;&gt;mpi_bcast</title>
<path fill="none" stroke="#000000" d="M181.101,-3296.08C195.511,-3317.98 228.968,-3364.25 269,-3389 279.432,-3395.45 291.894,-3399.97 303.613,-3403.12"/>
<polygon fill="#000000" stroke="#000000" points="303.109,-3406.59 313.651,-3405.54 304.753,-3399.79 303.109,-3406.59"/>
</g>
<!-- eold -->
<g id="proc~~siesta_forces~~CallsGraph_node122" class="node"><title>eold</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-3380 317.5,-3380 317.5,-3356 371.5,-3356 371.5,-3380"/>
<text text-anchor="middle" x="344.5" y="-3365.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">eold</text>
</g>
<!-- proc~compute_dm&#45;&gt;eold -->
<g id="proc~~siesta_forces~~CallsGraph_edge126" class="edge"><title>proc~compute_dm&#45;&gt;eold</title>
<path fill="none" stroke="#000000" d="M188.515,-3296.05C206.632,-3310.05 238.473,-3333.04 269,-3347 281.03,-3352.5 294.823,-3356.88 307.246,-3360.18"/>
<polygon fill="#000000" stroke="#000000" points="306.738,-3363.66 317.289,-3362.7 308.443,-3356.87 306.738,-3363.66"/>
</g>
<!-- proc~mixers_scf_history_init&#45;&gt;proc~mixers_history_init -->
<g id="proc~~siesta_forces~~CallsGraph_edge129" class="edge"><title>proc~mixers_scf_history_init&#45;&gt;proc~mixers_history_init</title>
<path fill="none" stroke="#000000" d="M223.57,-1217.93C227.181,-1215.48 230.413,-1212.54 233,-1209 307.435,-1107.26 191.321,-174.288 269,-75 273.075,-69.7908 278.338,-65.8084 284.18,-62.7736"/>
<polygon fill="#000000" stroke="#000000" points="285.891,-65.8505 293.75,-58.7445 283.175,-59.399 285.891,-65.8505"/>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;timer -->
<g id="proc~~siesta_forces~~CallsGraph_edge132" class="edge"><title>proc~setup_hamiltonian&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M174.964,-3817.8C181.853,-3760.27 211.594,-3510.28 233,-3305 241.751,-3221.07 214.932,-2991.78 269,-2927 278.423,-2915.71 293.405,-2910.23 307.47,-2907.67"/>
<polygon fill="#000000" stroke="#000000" points="308.039,-2911.12 317.457,-2906.27 307.068,-2904.19 308.039,-2911.12"/>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;die -->
<g id="proc~~siesta_forces~~CallsGraph_edge135" class="edge"><title>proc~setup_hamiltonian&#45;&gt;die</title>
<path fill="none" stroke="#000000" d="M173.888,-3842.25C175.933,-3885.12 188.752,-4029.67 269,-4103 320.086,-4149.68 356.487,-4113.52 420,-4141 434.523,-4147.28 449.469,-4156.61 461.411,-4164.88"/>
<polygon fill="#000000" stroke="#000000" points="459.725,-4167.98 469.9,-4170.93 463.788,-4162.28 459.725,-4167.98"/>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;bye -->
<g id="proc~~siesta_forces~~CallsGraph_edge142" class="edge"><title>proc~setup_hamiltonian&#45;&gt;bye</title>
<path fill="none" stroke="#000000" d="M178.009,-3817.58C188.961,-3789.21 219.742,-3719.27 269,-3683 280.1,-3674.83 294.266,-3669.83 307.259,-3666.78"/>
<polygon fill="#000000" stroke="#000000" points="308.246,-3670.15 317.346,-3664.73 306.849,-3663.29 308.246,-3670.15"/>
</g>
<!-- hold -->
<g id="proc~~siesta_forces~~CallsGraph_node30" class="node"><title>hold</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-4052 317.5,-4052 317.5,-4028 371.5,-4028 371.5,-4052"/>
<text text-anchor="middle" x="344.5" y="-4037.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hold</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;hold -->
<g id="proc~~siesta_forces~~CallsGraph_edge131" class="edge"><title>proc~setup_hamiltonian&#45;&gt;hold</title>
<path fill="none" stroke="#000000" d="M176.087,-3842.32C183.818,-3876 209.968,-3970.39 269,-4019 279.723,-4027.83 293.933,-4032.95 307.066,-4035.92"/>
<polygon fill="#000000" stroke="#000000" points="306.801,-4039.43 317.28,-4037.87 308.113,-4032.56 306.801,-4039.43"/>
</g>
<!-- h -->
<g id="proc~~siesta_forces~~CallsGraph_node32" class="node"><title>h</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-4010 317.5,-4010 317.5,-3986 371.5,-3986 371.5,-4010"/>
<text text-anchor="middle" x="344.5" y="-3995.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">h</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;h -->
<g id="proc~~siesta_forces~~CallsGraph_edge134" class="edge"><title>proc~setup_hamiltonian&#45;&gt;h</title>
<path fill="none" stroke="#000000" d="M178.009,-3842.42C188.961,-3870.79 219.742,-3940.73 269,-3977 280.1,-3985.17 294.266,-3990.17 307.259,-3993.22"/>
<polygon fill="#000000" stroke="#000000" points="306.849,-3996.71 317.346,-3995.27 308.246,-3989.85 306.849,-3996.71"/>
</g>
<!-- write_hsx -->
<g id="proc~~siesta_forces~~CallsGraph_node54" class="node"><title>write_hsx</title>
<polygon fill="#777777" stroke="#777777" points="373.5,-3968 315.5,-3968 315.5,-3944 373.5,-3944 373.5,-3968"/>
<text text-anchor="middle" x="344.5" y="-3953.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_hsx</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;write_hsx -->
<g id="proc~~siesta_forces~~CallsGraph_edge139" class="edge"><title>proc~setup_hamiltonian&#45;&gt;write_hsx</title>
<path fill="none" stroke="#000000" d="M181.101,-3842.08C195.511,-3863.98 228.968,-3910.25 269,-3935 279.983,-3941.79 293.218,-3946.44 305.467,-3949.6"/>
<polygon fill="#000000" stroke="#000000" points="304.92,-3953.07 315.452,-3951.92 306.504,-3946.25 304.92,-3953.07"/>
</g>
<!-- globalize_sum -->
<g id="proc~~siesta_forces~~CallsGraph_node55" class="node"><title>globalize_sum</title>
<polygon fill="#777777" stroke="#777777" points="385,-3926 304,-3926 304,-3902 385,-3902 385,-3926"/>
<text text-anchor="middle" x="344.5" y="-3911.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">globalize_sum</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;globalize_sum -->
<g id="proc~~siesta_forces~~CallsGraph_edge140" class="edge"><title>proc~setup_hamiltonian&#45;&gt;globalize_sum</title>
<path fill="none" stroke="#000000" d="M188.515,-3842.05C206.632,-3856.05 238.473,-3879.04 269,-3893 276.817,-3896.58 285.38,-3899.68 293.826,-3902.31"/>
<polygon fill="#000000" stroke="#000000" points="293.056,-3905.74 303.638,-3905.2 295.032,-3899.02 293.056,-3905.74"/>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;val -->
<g id="proc~~siesta_forces~~CallsGraph_edge130" class="edge"><title>proc~setup_hamiltonian&#45;&gt;val</title>
<path fill="none" stroke="#000000" d="M174.787,-3817.9C184.422,-3727.77 245.52,-3163.96 269,-3137 278.587,-3125.99 293.453,-3120.54 307.391,-3117.92"/>
<polygon fill="#000000" stroke="#000000" points="307.901,-3121.38 317.288,-3116.47 306.886,-3114.46 307.901,-3121.38"/>
</g>
<!-- hubbard_term -->
<g id="proc~~siesta_forces~~CallsGraph_node74" class="node"><title>hubbard_term</title>
<polygon fill="#777777" stroke="#777777" points="384.5,-3884 304.5,-3884 304.5,-3860 384.5,-3860 384.5,-3884"/>
<text text-anchor="middle" x="344.5" y="-3869.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hubbard_term</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;hubbard_term -->
<g id="proc~~siesta_forces~~CallsGraph_edge141" class="edge"><title>proc~setup_hamiltonian&#45;&gt;hubbard_term</title>
<path fill="none" stroke="#000000" d="M222.215,-3842.04C244.949,-3847.65 271.947,-3854.32 294.693,-3859.94"/>
<polygon fill="#000000" stroke="#000000" points="293.936,-3863.36 304.484,-3862.36 295.615,-3856.56 293.936,-3863.36"/>
</g>
<!-- de_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_node78" class="node"><title>de_alloc</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-3842 317.5,-3842 317.5,-3818 371.5,-3818 371.5,-3842"/>
<text text-anchor="middle" x="344.5" y="-3827.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">de_alloc</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;de_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge136" class="edge"><title>proc~setup_hamiltonian&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M222.671,-3830C249.613,-3830 282.434,-3830 307.066,-3830"/>
<polygon fill="#000000" stroke="#000000" points="307.08,-3833.5 317.08,-3830 307.08,-3826.5 307.08,-3833.5"/>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;dscf -->
<g id="proc~~siesta_forces~~CallsGraph_edge137" class="edge"><title>proc~setup_hamiltonian&#45;&gt;dscf</title>
<path fill="none" stroke="#000000" d="M188.515,-3817.95C206.632,-3803.95 238.473,-3780.96 269,-3767 281.03,-3761.5 294.823,-3757.12 307.246,-3753.82"/>
<polygon fill="#000000" stroke="#000000" points="308.443,-3757.13 317.289,-3751.3 306.738,-3750.34 308.443,-3757.13"/>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;re_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge143" class="edge"><title>proc~setup_hamiltonian&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M174.896,-3817.81C185.75,-3723.18 256.577,-3109.38 269,-3095 278.545,-3083.95 293.404,-3078.5 307.349,-3075.88"/>
<polygon fill="#000000" stroke="#000000" points="307.862,-3079.35 317.252,-3074.44 306.852,-3072.42 307.862,-3079.35"/>
</g>
<!-- dhscf -->
<g id="proc~~siesta_forces~~CallsGraph_node91" class="node"><title>dhscf</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-3800 317.5,-3800 317.5,-3776 371.5,-3776 371.5,-3800"/>
<text text-anchor="middle" x="344.5" y="-3785.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dhscf</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;dhscf -->
<g id="proc~~siesta_forces~~CallsGraph_edge138" class="edge"><title>proc~setup_hamiltonian&#45;&gt;dhscf</title>
<path fill="none" stroke="#000000" d="M222.215,-3817.96C249.465,-3811.23 282.84,-3802.99 307.676,-3796.85"/>
<polygon fill="#000000" stroke="#000000" points="308.549,-3800.24 317.417,-3794.44 306.87,-3793.44 308.549,-3800.24"/>
</g>
<!-- update_e0 -->
<g id="proc~~siesta_forces~~CallsGraph_node98" class="node"><title>update_e0</title>
<polygon fill="#777777" stroke="#777777" points="376.5,-4094 312.5,-4094 312.5,-4070 376.5,-4070 376.5,-4094"/>
<text text-anchor="middle" x="344.5" y="-4079.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_e0</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;update_e0 -->
<g id="proc~~siesta_forces~~CallsGraph_edge133" class="edge"><title>proc~setup_hamiltonian&#45;&gt;update_e0</title>
<path fill="none" stroke="#000000" d="M174.831,-3842.16C179.682,-3880.45 199.921,-3999.58 269,-4061 278.258,-4069.23 290.509,-4074.26 302.397,-4077.32"/>
<polygon fill="#000000" stroke="#000000" points="301.709,-4080.75 312.224,-4079.46 303.197,-4073.91 301.709,-4080.75"/>
</g>
<!-- proc~mixers_history_init&#45;&gt;delete -->
<g id="proc~~siesta_forces~~CallsGraph_edge144" class="edge"><title>proc~mixers_history_init&#45;&gt;delete</title>
<path fill="none" stroke="#000000" d="M395.318,-59.1277C404.767,-62.3465 413.665,-67.3349 420,-75 468.599,-133.804 482.634,-698.513 485.08,-818.613"/>
<polygon fill="#000000" stroke="#000000" points="481.585,-818.887 485.282,-828.816 488.584,-818.749 481.585,-818.887"/>
</g>
<!-- proc~current_itt -->
<g id="proc~~siesta_forces~~CallsGraph_node124" class="node"><title>proc~current_itt</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node124"><a xlink:href=".././proc/current_itt.html" xlink:title="current_itt">
<polygon fill="#d94e8f" stroke="#d94e8f" points="517,-87 456,-87 456,-63 517,-63 517,-87"/>
<text text-anchor="middle" x="486.5" y="-72.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">current_itt</text>
</a>
</g>
</g>
<!-- proc~mixers_history_init&#45;&gt;proc~current_itt -->
<g id="proc~~siesta_forces~~CallsGraph_edge145" class="edge"><title>proc~mixers_history_init&#45;&gt;proc~current_itt</title>
<path fill="none" stroke="#000000" d="M395.253,-61.4629C411.887,-63.958 430.189,-66.7034 445.939,-69.0658"/>
<polygon fill="#000000" stroke="#000000" points="445.468,-72.5343 455.876,-70.5565 446.506,-65.6117 445.468,-72.5343"/>
</g>
<!-- new -->
<g id="proc~~siesta_forces~~CallsGraph_node125" class="node"><title>new</title>
<polygon fill="#777777" stroke="#777777" points="513.5,-45 459.5,-45 459.5,-21 513.5,-21 513.5,-45"/>
<text text-anchor="middle" x="486.5" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">new</text>
</g>
<!-- proc~mixers_history_init&#45;&gt;new -->
<g id="proc~~siesta_forces~~CallsGraph_edge146" class="edge"><title>proc~mixers_history_init&#45;&gt;new</title>
<path fill="none" stroke="#000000" d="M395.253,-46.5371C413.047,-43.8679 432.751,-40.9123 449.196,-38.4456"/>
<polygon fill="#000000" stroke="#000000" points="450.11,-41.8478 459.48,-36.903 449.071,-34.9252 450.11,-41.8478"/>
</g>
<!-- proc~compute_max_diff_2d&#45;&gt;die -->
<g id="proc~~siesta_forces~~CallsGraph_edge147" class="edge"><title>proc~compute_max_diff_2d&#45;&gt;die</title>
<path fill="none" stroke="#000000" d="M403.656,-4170.72C419.102,-4173.04 435.34,-4175.48 449.243,-4177.56"/>
<polygon fill="#000000" stroke="#000000" points="448.96,-4181.06 459.368,-4179.08 449.998,-4174.14 448.96,-4181.06"/>
</g>
<!-- proc~compute_max_diff_1d&#45;&gt;die -->
<g id="proc~~siesta_forces~~CallsGraph_edge148" class="edge"><title>proc~compute_max_diff_1d&#45;&gt;die</title>
<path fill="none" stroke="#000000" d="M403.656,-4195.28C419.102,-4192.96 435.34,-4190.52 449.243,-4188.44"/>
<polygon fill="#000000" stroke="#000000" points="449.998,-4191.86 459.368,-4186.92 448.96,-4184.94 449.998,-4191.86"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,-0 209.5,-0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.5,-24 454.5,-24 454.5,-0 551.5,-0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      




















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/siesta_forces.html#src">siesta_forces</a>
  </div>
</div>


    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>  <span class="k">subroutine </span><span class="n">siesta_forces</span><span class="p">(</span><span class="n">istep</span><span class="p">)</span>
  <span class="c">!! This subroutine represents central SIESTA operation logic.</span>

<span class="cp">#ifdef MPI</span>
    <span class="k">use </span><span class="n">mpi_siesta</span>
<span class="cp">#endif</span>
    <span class="k">use </span><span class="n">units</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">eV</span><span class="p">,</span> <span class="n">Ang</span>
    <span class="k">use </span><span class="nb">precision</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">dp</span>
    <span class="k">use </span><span class="n">sys</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">bye</span>

    <span class="k">use </span><span class="n">files</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">slabel</span>
    <span class="k">use </span><span class="n">siesta_cml</span>
<span class="cp">#ifdef SIESTA__FLOOK</span>
    <span class="k">use </span><span class="n">flook_siesta</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">slua_call</span>
    <span class="k">use </span><span class="n">flook_siesta</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">LUA_INIT_MD</span><span class="p">,</span> <span class="n">LUA_SCF_LOOP</span>
    <span class="k">use </span><span class="n">siesta_dicts</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">dict_variable_add</span>
    <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">ts_scf_mixs</span>
    <span class="k">use </span><span class="n">variable</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">cunpack</span>
<span class="cp">#ifndef NCDF_4</span>
    <span class="k">use </span><span class="n">dictionary</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="k">assign</span>
<span class="cp">#endif</span>
    <span class="k">use </span><span class="n">m_mixing</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">mixers_history_init</span>
<span class="cp">#endif</span>
    <span class="k">use </span><span class="n">m_state_init</span>
    <span class="k">use </span><span class="n">m_setup_hamiltonian</span>
    <span class="k">use </span><span class="n">m_setup_H0</span>
    <span class="k">use </span><span class="n">m_compute_dm</span>
    <span class="k">use </span><span class="n">m_compute_max_diff</span>
    <span class="k">use </span><span class="n">m_scfconvergence_test</span>
    <span class="k">use </span><span class="n">m_post_scf_work</span>
    <span class="k">use </span><span class="n">m_mixer</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">mixer</span>
    <span class="k">use </span><span class="n">m_mixing_scf</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">mixing_scf_converged</span>
    <span class="k">use </span><span class="n">m_mixing_scf</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">mixers_scf_history_init</span>
    <span class="k">use </span><span class="n">m_mixing_scf</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">scf_mixs</span><span class="p">,</span> <span class="n">scf_mix</span>

    <span class="k">use </span><span class="n">m_rhog</span><span class="p">,</span>                <span class="n">only</span><span class="p">:</span> <span class="n">mix_rhog</span><span class="p">,</span> <span class="n">compute_charge_diff</span>
    <span class="k">use </span><span class="n">siesta_options</span>
    <span class="k">use </span><span class="n">parallel</span><span class="p">,</span>     <span class="n">only</span> <span class="p">:</span> <span class="n">IOnode</span><span class="p">,</span> <span class="n">SIESTA_worker</span>
    <span class="k">use </span><span class="n">m_state_analysis</span>
    <span class="k">use </span><span class="n">m_steps</span>
    <span class="k">use </span><span class="n">m_spin</span><span class="p">,</span>                <span class="n">only</span><span class="p">:</span> <span class="n">spin</span>
    <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">DM_2D</span><span class="p">,</span> <span class="n">S_1D</span>
    <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">H</span><span class="p">,</span> <span class="n">Hold</span><span class="p">,</span> <span class="n">Dold</span><span class="p">,</span> <span class="n">Dscf</span><span class="p">,</span> <span class="n">Eold</span><span class="p">,</span> <span class="n">Escf</span><span class="p">,</span> <span class="n">maxnh</span>
    <span class="k">use </span><span class="n">m_convergence</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">converger_t</span>
    <span class="k">use </span><span class="n">m_convergence</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">reset</span><span class="p">,</span> <span class="n">set_tolerance</span>
    <span class="k">use </span><span class="n">siesta_geom</span><span class="p">,</span>   <span class="n">only</span><span class="p">:</span> <span class="n">na_u</span>           <span class="c">! Number of atoms in unit cell</span>
    <span class="k">use </span><span class="n">m_energies</span><span class="p">,</span>    <span class="n">only</span><span class="p">:</span> <span class="n">Etot</span>           <span class="c">! Total energy</span>
    <span class="k">use </span><span class="n">m_forces</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">fa</span><span class="p">,</span> <span class="n">cfa</span>        <span class="c">! Forces and constrained forces</span>
    <span class="k">use </span><span class="n">m_stress</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">cstress</span>        <span class="c">! Constrained stress tensor</span>
    <span class="k">use </span><span class="n">siesta_master</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">forcesToMaster</span> <span class="c">! Send forces to master prog</span>
    <span class="k">use </span><span class="n">siesta_master</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">siesta_server</span>  <span class="c">! Is siesta a server?</span>
    <span class="k">use </span><span class="n">m_save_density_matrix</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">save_density_matrix</span>
    <span class="k">use </span><span class="n">m_iodm_old</span><span class="p">,</span>    <span class="n">only</span><span class="p">:</span> <span class="n">write_spmatrix</span>

    <span class="k">use </span><span class="n">atomlist</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span> <span class="n">Qtot</span>
    <span class="k">use </span><span class="n">m_dm_charge</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">dm_charge</span>

    <span class="k">use </span><span class="n">m_pexsi_solver</span><span class="p">,</span>        <span class="n">only</span><span class="p">:</span> <span class="n">prevDmax</span>
    <span class="k">use </span><span class="n">write_subs</span><span class="p">,</span>            <span class="n">only</span><span class="p">:</span> <span class="n">siesta_write_forces</span>
    <span class="k">use </span><span class="n">write_subs</span><span class="p">,</span>            <span class="n">only</span><span class="p">:</span> <span class="n">siesta_write_stress_pressure</span>

<span class="cp">#ifdef NCDF_4</span>
    <span class="k">use </span><span class="n">dictionary</span>
    <span class="k">use </span><span class="n">m_ncdf_siesta</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">cdf_init_file</span><span class="p">,</span> <span class="n">cdf_save_settings</span>
    <span class="k">use </span><span class="n">m_ncdf_siesta</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">cdf_save_state</span><span class="p">,</span> <span class="n">cdf_save_basis</span>
<span class="cp">#endif</span>
    <span class="k">use </span><span class="n">m_compute_energies</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">compute_energies</span>

    <span class="k">use </span><span class="n">m_mpi_utils</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">broadcast</span>
    <span class="k">use </span><span class="n">fdf</span>
<span class="cp">#ifdef SIESTA__PEXSI</span>
    <span class="k">use </span><span class="n">m_pexsi</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">pexsi_finalize_scfloop</span>
<span class="cp">#endif</span>
    <span class="k">use </span><span class="n">m_check_walltime</span>

    <span class="k">use </span><span class="n">m_energies</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">DE_NEGF</span>
    <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">N_Elec</span>
    <span class="k">use </span><span class="n">m_ts_method</span>
    <span class="k">use </span><span class="n">m_ts_global_vars</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">TSmode</span><span class="p">,</span> <span class="n">TSinit</span><span class="p">,</span> <span class="n">TSrun</span>
    <span class="k">use </span><span class="n">siesta_geom</span><span class="p">,</span>           <span class="n">only</span><span class="p">:</span> <span class="n">nsc</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">ucell</span><span class="p">,</span> <span class="n">isc_off</span>
    <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span>       <span class="n">only</span><span class="p">:</span> <span class="n">sparse_pattern</span><span class="p">,</span> <span class="n">block_dist</span>
    <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span>       <span class="n">only</span><span class="p">:</span> <span class="n">S</span>
    <span class="k">use </span><span class="n">m_ts_charge</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">ts_get_charges</span>
    <span class="k">use </span><span class="n">m_ts_charge</span><span class="p">,</span>           <span class="n">only</span><span class="p">:</span> <span class="n">TS_RHOCORR_METHOD</span>
    <span class="k">use </span><span class="n">m_ts_charge</span><span class="p">,</span>           <span class="n">only</span><span class="p">:</span> <span class="n">TS_RHOCORR_FERMI</span>
    <span class="k">use </span><span class="n">m_ts_charge</span><span class="p">,</span>           <span class="n">only</span><span class="p">:</span> <span class="n">TS_RHOCORR_FERMI_TOLERANCE</span>
    <span class="k">use </span><span class="n">m_transiesta</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">transiesta</span>
    <span class="k">use </span><span class="n">kpoint_grid</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">gamma_scf</span>
    <span class="k">use </span><span class="n">m_energies</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">Ef</span>

    <span class="k">use </span><span class="n">m_initwf</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">initwf</span>

    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">istep</span>

    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iscf</span>
    <span class="kt">logical</span> <span class="kd">::</span> <span class="n">first_scf</span><span class="p">,</span> <span class="n">SCFconverged</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dDmax</span> <span class="c">! Max. change in DM elements</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dHmax</span> <span class="c">! Max. change in H elements</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dEmax</span> <span class="c">! Max. change in EDM elements</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">drhog</span> <span class="c">! Max. change in rho(G) (experimental)</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">G2max</span> <span class="c">! actually used meshcutoff</span>
    <span class="k">type</span><span class="p">(</span><span class="n">converger_t</span><span class="p">)</span> <span class="kd">::</span>  <span class="n">conv_harris</span><span class="p">,</span> <span class="n">conv_freeE</span>

    <span class="c">! For initwf</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">istpp</span>

<span class="cp">#ifdef SIESTA__FLOOK</span>
    <span class="c">! len=24 from m_mixing.F90</span>
    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">next_mixer</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nnext_mixer</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">imix</span>
<span class="cp">#endif</span>

    <span class="kt">logical</span>               <span class="kd">::</span> <span class="n">time_is_up</span>
    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">tmp_str</span>

    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Qcur</span>
<span class="cp">#ifdef NCDF_4</span>
    <span class="k">type</span><span class="p">(</span><span class="n">dict</span><span class="p">)</span> <span class="kd">::</span> <span class="n">d_sav</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef MPI</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">MPIerror</span>
<span class="cp">#endif</span>

    <span class="k">external</span> <span class="kd">::</span> <span class="n">die</span><span class="p">,</span> <span class="n">message</span>

<span class="cp">#ifdef DEBUG</span>
    <span class="k">call </span><span class="n">write_debug</span><span class="p">(</span> <span class="s1">&#39;    PRE siesta_forces&#39;</span> <span class="p">)</span>
<span class="cp">#endif</span>

<span class="cp">#ifdef SIESTA__PEXSI</span>
    <span class="c">! Broadcast relevant things for program logic</span>
    <span class="c">! These were set in read_options, called only by &quot;SIESTA_workers&quot;.</span>
    <span class="k">call </span><span class="n">broadcast</span><span class="p">(</span><span class="n">nscf</span><span class="p">,</span> <span class="n">comm</span><span class="o">=</span><span class="n">true_MPI_Comm_World</span><span class="p">)</span>
<span class="cp">#endif</span>

    <span class="c">!! Initialization tasks for a given geometry:</span>
    <span class="c">!!@code</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">SIESTA_worker</span> <span class="p">)</span>  <span class="k">then</span>
<span class="k">       call </span><span class="n">state_init</span><span class="p">(</span> <span class="n">istep</span> <span class="p">)</span>
    <span class="k">end if</span>
    <span class="c">!!@endcode</span>

<span class="cp">#ifdef SIESTA__PEXSI</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ionode</span><span class="p">)</span> <span class="k">call </span><span class="n">memory_snapshot</span><span class="p">(</span><span class="s2">&quot;after state_init&quot;</span><span class="p">)</span>
<span class="cp">#endif</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">fdf_get</span><span class="p">(</span><span class="s2">&quot;Sonly&quot;</span><span class="p">,.</span><span class="n">false</span><span class="p">.)</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">       if</span> <span class="p">(</span> <span class="n">SIESTA_worker</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">          call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="mi">2</span> <span class="p">)</span>
          <span class="k">call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="mi">3</span> <span class="p">)</span>
       <span class="k">end if</span>
<span class="k">       call </span><span class="n">bye</span><span class="p">(</span><span class="s2">&quot;S only&quot;</span><span class="p">)</span>
    <span class="k">end if</span>

<span class="k">    </span><span class="n">Qcur</span> <span class="o">=</span> <span class="n">Qtot</span>
    
<span class="cp">#ifdef SIESTA__FLOOK</span>
    <span class="c">! Add the iscf constant to the list of variables</span>
    <span class="c">! that are available only in this part of the routine.</span>
    <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.iteration&#39;</span><span class="p">,</span><span class="n">iscf</span><span class="p">)</span>
    <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.converged&#39;</span><span class="p">,</span><span class="n">SCFconverged</span><span class="p">)</span>
    <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.charge&#39;</span><span class="p">,</span><span class="n">Qcur</span><span class="p">)</span>
    <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.dD&#39;</span><span class="p">,</span><span class="n">dDmax</span><span class="p">)</span>
    <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.dH&#39;</span><span class="p">,</span><span class="n">dHmax</span><span class="p">)</span>
    <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.dE&#39;</span><span class="p">,</span><span class="n">dEmax</span><span class="p">)</span>
    <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.drhoG&#39;</span><span class="p">,</span><span class="n">drhog</span><span class="p">)</span>
    <span class="c">! We have to set the meshcutoff here</span>
    <span class="c">! because the asked and required ones are not</span>
    <span class="c">! necessarily the same</span>
    <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;Mesh.Cutoff.Minimum&#39;</span><span class="p">,</span><span class="n">G2cut</span><span class="p">)</span>
    <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;Mesh.Cutoff.Used&#39;</span><span class="p">,</span><span class="n">G2max</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">mix_charge</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">      call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Weight&#39;</span><span class="p">,</span> <span class="n">wmix</span><span class="p">)</span>
    <span class="k">else</span>
<span class="k">      call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Weight&#39;</span><span class="p">,</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">w</span><span class="p">)</span>
      <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Restart&#39;</span><span class="p">,</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">restart</span><span class="p">)</span>
      <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Iterations&#39;</span><span class="p">,</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">n_itt</span><span class="p">)</span>
      
      <span class="c">! Just to populate the table in the dictionary</span>
      <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Switch&#39;</span><span class="p">,</span><span class="n">next_mixer</span><span class="p">)</span>
    <span class="k">end if</span>

    <span class="c">! Initialize to no switch</span>
    <span class="n">next_mixer</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
<span class="cp">#endif</span>

    <span class="c">!* This call computes the **non-scf** part of \( H \) and initializes the</span>
    <span class="c">!  real-space grid structures:</span>
    <span class="c">!!@code</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">SIESTA_worker</span> <span class="p">)</span> <span class="k">call </span><span class="n">setup_H0</span><span class="p">(</span><span class="n">G2max</span><span class="p">)</span>
    <span class="c">!!@endcode</span>
    <span class="c">!!@todo</span>
    <span class="c">!* It might be better to split the two,</span>
    <span class="c">!  putting the grid initialization into **state_init (link!)** and moving the</span>
    <span class="c">!  calculation of \( H_0 \) to the body of the loop, done `if first_scf=.true.`</span>
    <span class="c">!  This would suit _analysis_ runs in which **nscf = 0**</span>
    <span class="c">!!@endtodo</span>

<span class="cp">#ifdef SIESTA__PEXSI</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ionode</span><span class="p">)</span> <span class="k">call </span><span class="n">memory_snapshot</span><span class="p">(</span><span class="s2">&quot;after setup_H0&quot;</span><span class="p">)</span>
<span class="cp">#endif</span>

<span class="cp">#ifdef SIESTA__FLOOK</span>
    <span class="c">! Communicate with lua, just before entering the SCF loop</span>
    <span class="c">! This is mainly to be able to communicate</span>
    <span class="c">! mesh-related quantities (g2max)</span>
    <span class="k">call </span><span class="n">slua_call</span><span class="p">(</span><span class="n">LUA</span><span class="p">,</span> <span class="n">LUA_INIT_MD</span><span class="p">)</span>
<span class="cp">#endif</span>

<span class="cp">#ifdef NCDF_4</span>
    <span class="c">! Initialize the NC file</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">write_cdf</span> <span class="p">)</span> <span class="k">then</span>

       <span class="c">! Initialize the file...</span>
       <span class="k">call </span><span class="n">cdf_init_file</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.nc&#39;</span><span class="p">,</span><span class="n">is_MD</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.)</span>
<span class="cp">#ifdef MPI</span>
       <span class="k">call </span><span class="n">MPI_Barrier</span><span class="p">(</span><span class="n">MPI_Comm_World</span><span class="p">,</span><span class="n">MPIerror</span><span class="p">)</span>
<span class="cp">#endif</span>

       <span class="c">! Save the settings</span>
       <span class="k">call </span><span class="n">cdf_save_settings</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.nc&#39;</span><span class="p">)</span>
<span class="cp">#ifdef MPI</span>
       <span class="k">call </span><span class="n">MPI_Barrier</span><span class="p">(</span><span class="n">MPI_Comm_World</span><span class="p">,</span><span class="n">MPIerror</span><span class="p">)</span>
<span class="cp">#endif</span>
       
       <span class="n">d_sav</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;sp&#39;</span><span class="p">.</span><span class="n">kv</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">.</span><span class="n">kv</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">d_sav</span> <span class="o">=</span> <span class="n">d_sav</span><span class="o">//</span><span class="p">(</span><span class="s1">&#39;nsc&#39;</span><span class="p">.</span><span class="n">kv</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="p">(</span><span class="s1">&#39;xij&#39;</span><span class="p">.</span><span class="n">kv</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">d_sav</span> <span class="o">=</span> <span class="n">d_sav</span><span class="o">//</span><span class="p">(</span><span class="s1">&#39;xa&#39;</span><span class="p">.</span><span class="n">kv</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="p">(</span><span class="s1">&#39;cell&#39;</span><span class="p">.</span><span class="n">kv</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">d_sav</span> <span class="o">=</span> <span class="n">d_sav</span><span class="o">//</span><span class="p">(</span><span class="s1">&#39;isc_off&#39;</span><span class="p">.</span><span class="n">kv</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span>
       <span class="k">call </span><span class="n">cdf_save_state</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.nc&#39;</span><span class="p">,</span><span class="n">d_sav</span><span class="p">)</span>
       <span class="k">call </span><span class="n">delete</span><span class="p">(</span><span class="n">d_sav</span><span class="p">)</span>

       <span class="c">! Save the basis set</span>
       <span class="k">call </span><span class="n">cdf_save_basis</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.nc&#39;</span><span class="p">)</span>

    <span class="k">end if</span>
<span class="cp">#endif</span>

    <span class="c">!* The dHmax variable only has meaning for Hamiltonian</span>
    <span class="c">!  mixing, or when requiring the Hamiltonian to be converged.</span>
    <span class="n">dDmax</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1._dp</span>
    <span class="n">dHmax</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1._dp</span>
    <span class="n">dEmax</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1._dp</span>
    <span class="n">drhog</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1._dp</span>

    <span class="c">! Setup convergence criteria:</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">SIESTA_worker</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">       if</span> <span class="p">(</span> <span class="n">converge_Eharr</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">          call </span><span class="n">reset</span><span class="p">(</span><span class="n">conv_harris</span><span class="p">)</span>
          <span class="k">call </span><span class="n">set_tolerance</span><span class="p">(</span><span class="n">conv_harris</span><span class="p">,</span><span class="n">tolerance_Eharr</span><span class="p">)</span>
       <span class="k">end if</span>
<span class="k">       if</span> <span class="p">(</span> <span class="n">converge_FreeE</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">          call </span><span class="n">reset</span><span class="p">(</span><span class="n">conv_FreeE</span><span class="p">)</span>
          <span class="k">call </span><span class="n">set_tolerance</span><span class="p">(</span><span class="n">conv_FreeE</span><span class="p">,</span><span class="n">tolerance_FreeE</span><span class="p">)</span>
       <span class="k">end if</span>
<span class="k">    end if</span>

    <span class="c">!!# SCF loop</span>
    <span class="c">!* The current structure of the loop tries to reproduce the</span>
    <span class="c">!  historical Siesta usage. It should be made more clear.</span>

    <span class="c">!* Two changes:</span>
    <span class="c">!</span>
    <span class="c">!  1. The number of scf iterations performed is exactly</span>
    <span class="c">!     equal to the number specified (i.e., the &quot;forces&quot;</span>
    <span class="c">!     phase is not counted as a final scf step)</span>
    <span class="c">!  2. At the change to a TranSiesta GF run the variable &quot;first_scf&quot;</span>
    <span class="c">!     is implicitly reset to &quot;true&quot;.</span>
    <span class="c">!</span>

    <span class="c">!!## Start of SCF cycle</span>
    <span class="c">!</span>
    <span class="c">!* Conditions of exit:</span>
    <span class="c">!</span>
    <span class="c">!  * At the top, to catch a non-positive nscf and # of iterations</span>
    <span class="c">!  * At the bottom, based on convergence</span>
    <span class="c">!</span>
    <span class="c">!!@code</span>
    <span class="n">iscf</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">do while</span> <span class="p">(</span> <span class="n">iscf</span> <span class="o">&lt;</span> <span class="n">nscf</span> <span class="p">)</span>
    <span class="c">!!@endcode</span>

       <span class="n">iscf</span> <span class="o">=</span> <span class="n">iscf</span> <span class="o">+</span> <span class="mi">1</span>

       <span class="c">!* Note implications for TranSiesta when mixing \(H\).</span>
       <span class="c">!  Now \(H\) will be recomputed instead of simply being</span>
       <span class="c">!  inherited, however, this is required as if</span>
       <span class="c">!  we have bias calculations as the electric</span>
       <span class="c">!  field across the junction needs to be present.</span>

       <span class="n">first_scf</span> <span class="o">=</span> <span class="p">(</span><span class="n">iscf</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>

       <span class="k">if</span> <span class="p">(</span> <span class="n">SIESTA_worker</span> <span class="p">)</span> <span class="k">then</span>

          <span class="c">! Check whether we are short of time to continue</span>
          <span class="k">call </span><span class="n">check_walltime</span><span class="p">(</span><span class="n">time_is_up</span><span class="p">)</span>
          <span class="k">if</span> <span class="p">(</span> <span class="n">time_is_up</span> <span class="p">)</span> <span class="k">then</span>
             <span class="c">! Save DM/H if we were not saving it...</span>
             <span class="c">! Do any other bookeeping not done by &quot;die&quot;</span>
             <span class="k">call </span><span class="n">message</span><span class="p">(</span><span class="s1">&#39;WARNING&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
                  <span class="s1">&#39;SCF_NOT_CONV: SCF did not converge&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
                  <span class="s1">&#39; before wall time exhaustion&#39;</span><span class="p">)</span>
             <span class="k">write</span><span class="p">(</span><span class="n">tmp_str</span><span class="p">,</span><span class="s2">&quot;(2(i5,tr1),f12.6)&quot;</span><span class="p">)</span> <span class="n">istep</span><span class="p">,</span> <span class="n">iscf</span><span class="p">,</span> <span class="n">prevDmax</span>
             <span class="k">call </span><span class="n">message</span><span class="p">(</span><span class="s1">&#39; (info)&#39;</span><span class="p">,</span><span class="s2">&quot;Geom step, scf iteration, dmax:&quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">tmp_str</span><span class="p">))</span>

             <span class="k">call </span><span class="n">die</span><span class="p">(</span><span class="s2">&quot;OUT_OF_TIME: Time is up.&quot;</span><span class="p">)</span>

          <span class="k">end if</span>

<span class="k">          call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;IterSCF&#39;</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">cml_p</span><span class="p">)</span> <span class="p">&amp;</span>
               <span class="k">call </span><span class="n">cmlStartStep</span><span class="p">(</span> <span class="n">xf</span><span class="o">=</span><span class="n">mainXML</span><span class="p">,</span> <span class="k">type</span><span class="o">=</span><span class="s1">&#39;SCF&#39;</span><span class="p">,</span> <span class="nb">index</span><span class="o">=</span><span class="n">iscf</span> <span class="p">)</span>

          <span class="k">if</span> <span class="p">(</span> <span class="n">mixH</span> <span class="p">)</span> <span class="k">then</span>

<span class="k">             if</span> <span class="p">(</span> <span class="n">first_scf</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">                if</span> <span class="p">(</span><span class="n">fdf_get</span><span class="p">(</span><span class="s2">&quot;Read-H-from-file&quot;</span><span class="p">,.</span><span class="n">false</span><span class="p">.))</span> <span class="k">then</span>
<span class="k">                   call </span><span class="n">get_H_from_file</span><span class="p">()</span>
                <span class="k">else</span>
<span class="k">                   call </span><span class="n">setup_hamiltonian</span><span class="p">(</span> <span class="n">iscf</span> <span class="p">)</span>
                <span class="k">end if</span>
<span class="k">             end if</span>

<span class="k">             call </span><span class="n">compute_DM</span><span class="p">(</span> <span class="n">iscf</span> <span class="p">)</span>

             <span class="c">! Maybe set Dold to zero if reading charge or H...</span>
             <span class="k">call </span><span class="n">compute_max_diff</span><span class="p">(</span><span class="n">Dold</span><span class="p">,</span> <span class="n">Dscf</span><span class="p">,</span> <span class="n">dDmax</span><span class="p">)</span>
             <span class="k">if</span> <span class="p">(</span> <span class="n">converge_EDM</span> <span class="p">)</span> <span class="p">&amp;</span>
                  <span class="k">call </span><span class="n">compute_max_diff</span><span class="p">(</span><span class="n">Eold</span><span class="p">,</span> <span class="n">Escf</span><span class="p">,</span> <span class="n">dEmax</span><span class="p">)</span>
             <span class="k">call </span><span class="n">setup_hamiltonian</span><span class="p">(</span> <span class="n">iscf</span> <span class="p">)</span>
             <span class="k">call </span><span class="n">compute_max_diff</span><span class="p">(</span><span class="n">Hold</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">dHmax</span><span class="p">)</span>

          <span class="k">else</span>

<span class="k">             call </span><span class="n">setup_hamiltonian</span><span class="p">(</span> <span class="n">iscf</span> <span class="p">)</span>
             <span class="k">call </span><span class="n">compute_max_diff</span><span class="p">(</span><span class="n">Hold</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">dHmax</span><span class="p">)</span>

             <span class="k">call </span><span class="n">compute_DM</span><span class="p">(</span> <span class="n">iscf</span> <span class="p">)</span>

             <span class="k">call </span><span class="n">compute_max_diff</span><span class="p">(</span><span class="n">Dold</span><span class="p">,</span> <span class="n">Dscf</span><span class="p">,</span> <span class="n">dDmax</span><span class="p">)</span>
             <span class="k">if</span> <span class="p">(</span> <span class="n">converge_EDM</span> <span class="p">)</span> <span class="p">&amp;</span>
                  <span class="k">call </span><span class="n">compute_max_diff</span><span class="p">(</span><span class="n">Eold</span><span class="p">,</span> <span class="n">Escf</span><span class="p">,</span> <span class="n">dEmax</span><span class="p">)</span>

          <span class="k">end if</span>

          <span class="c">! This iteration has completed calculating the new DM</span>

          <span class="k">call </span><span class="n">compute_energies</span><span class="p">(</span> <span class="n">iscf</span> <span class="p">)</span>
          <span class="k">if</span> <span class="p">(</span> <span class="n">mix_charge</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">             call </span><span class="n">compute_charge_diff</span><span class="p">(</span> <span class="n">drhog</span> <span class="p">)</span>
          <span class="k">end if</span>

          <span class="c">! Note: For DM and H convergence checks. At this point:</span>
          <span class="c">! If mixing the DM:</span>
          <span class="c">!        Dscf=DM_out, Dold=DM_in(mixed), H=H_in, Hold=H_in(prev step)</span>
          <span class="c">!        dDmax=maxdiff(DM_out,DM_in)</span>
          <span class="c">!        dHmax=maxdiff(H_in - H_in(prev step))</span>
          <span class="c">! If mixing the Hamiltonian:</span>
          <span class="c">!        Dscf=DM_out, Dold=DM_in, H=H_(DM_out), Hold=H_in(mixed)</span>
          <span class="c">!        dDmax=maxdiff(DM_out,DM_in)</span>
          <span class="c">!        dHmax=maxdiff(H(DM_out),H_in)</span>
          <span class="k">call </span><span class="n">scfconvergence_test</span><span class="p">(</span> <span class="n">first_scf</span><span class="p">,</span> <span class="n">iscf</span><span class="p">,</span> <span class="p">&amp;</span>
               <span class="n">dDmax</span><span class="p">,</span> <span class="n">dHmax</span><span class="p">,</span> <span class="n">dEmax</span><span class="p">,</span> <span class="p">&amp;</span>
               <span class="n">conv_harris</span><span class="p">,</span> <span class="n">conv_freeE</span><span class="p">,</span> <span class="p">&amp;</span>
               <span class="n">SCFconverged</span> <span class="p">)</span>

          <span class="c">! ** Check this heuristic</span>
          <span class="k">if</span> <span class="p">(</span> <span class="n">mixH</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">             </span><span class="n">prevDmax</span> <span class="o">=</span> <span class="n">dHmax</span>
          <span class="k">else</span>
<span class="k">             </span><span class="n">prevDmax</span> <span class="o">=</span> <span class="n">dDmax</span>
          <span class="k">end if</span>

          <span class="c">! Calculate current charge based on the density matrix</span>
          <span class="k">call </span><span class="n">dm_charge</span><span class="p">(</span><span class="n">spin</span><span class="p">,</span> <span class="n">DM_2D</span><span class="p">,</span> <span class="n">S_1D</span><span class="p">,</span> <span class="n">Qcur</span><span class="p">)</span>


          <span class="c">! Check whether we should step to the next mixer</span>
          <span class="k">call </span><span class="n">mixing_scf_converged</span><span class="p">(</span> <span class="n">SCFconverged</span> <span class="p">)</span>

          <span class="k">if</span> <span class="p">(</span> <span class="n">SCFconverged</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">iscf</span> <span class="o">&lt;</span> <span class="n">min_nscf</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">             </span><span class="n">SCFconverged</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
             <span class="k">if</span> <span class="p">(</span> <span class="n">IONode</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">                write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s2">&quot;(a,i0)&quot;</span><span class="p">)</span> <span class="p">&amp;</span>
                     <span class="s2">&quot;SCF cycle continued for minimum number of iterations: &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">min_nscf</span>
             <span class="k">end if</span>
<span class="k">          end if</span>

          <span class="c">! In case the user has requested a Fermi-level correction</span>
          <span class="c">! Then we start by correcting the fermi-level</span>
          <span class="k">if</span> <span class="p">(</span> <span class="n">TSrun</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">SCFconverged</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
               <span class="n">TS_RHOCORR_METHOD</span> <span class="o">==</span> <span class="n">TS_RHOCORR_FERMI</span> <span class="p">)</span> <span class="k">then</span>

<span class="k">             if</span> <span class="p">(</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Qcur</span> <span class="o">-</span> <span class="n">Qtot</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">TS_RHOCORR_FERMI_TOLERANCE</span> <span class="p">)</span> <span class="k">then</span>

                <span class="c">! Call transiesta with fermi-correct</span>
                <span class="k">call </span><span class="n">transiesta</span><span class="p">(</span><span class="n">iscf</span><span class="p">,</span><span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">block_dist</span><span class="p">,</span> <span class="n">sparse_pattern</span><span class="p">,</span> <span class="n">Gamma_Scf</span><span class="p">,</span> <span class="n">ucell</span><span class="p">,</span> <span class="n">nsc</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">isc_off</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">Dscf</span><span class="p">,</span> <span class="n">Escf</span><span class="p">,</span> <span class="n">Ef</span><span class="p">,</span> <span class="n">Qtot</span><span class="p">,</span> <span class="p">.</span><span class="n">true</span><span class="p">.,</span> <span class="n">DE_NEGF</span><span class="p">)</span>

                <span class="c">! We will not have not converged as we have just</span>
                <span class="c">! changed the Fermi-level</span>
                <span class="n">SCFconverged</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>

             <span class="k">end if</span>

<span class="k">          end if</span>

<span class="k">          if</span> <span class="p">(</span> <span class="n">monitor_forces_in_scf</span> <span class="p">)</span> <span class="k">call </span><span class="n">compute_forces</span><span class="p">()</span>

          <span class="c">! Mix_after_convergence preserves the old behavior of</span>
          <span class="c">! the program.</span>
          <span class="k">if</span> <span class="p">(</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SCFconverged</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">mix_after_convergence</span><span class="p">)</span> <span class="k">then</span>

             <span class="c">! Mix for next step</span>
             <span class="k">if</span> <span class="p">(</span> <span class="n">mix_charge</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">                call </span><span class="n">mix_rhog</span><span class="p">(</span> <span class="n">iscf</span> <span class="p">)</span>
             <span class="k">else</span>
<span class="k">                call </span><span class="n">mixer</span><span class="p">(</span> <span class="n">iscf</span> <span class="p">)</span>
             <span class="k">end if</span>

             <span class="c">! Save for possible restarts</span>
             <span class="k">if</span> <span class="p">(</span> <span class="n">mixH</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">                call </span><span class="n">write_spmatrix</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="k">file</span><span class="o">=</span><span class="s2">&quot;H_MIXED&quot;</span><span class="p">,</span><span class="n">when</span><span class="o">=</span><span class="n">writeH</span><span class="p">)</span>
                <span class="k">call </span><span class="n">save_density_matrix</span><span class="p">(</span><span class="k">file</span><span class="o">=</span><span class="s2">&quot;DM_OUT&quot;</span><span class="p">,</span><span class="n">when</span><span class="o">=</span><span class="n">writeDM</span><span class="p">)</span>
             <span class="k">else</span>
<span class="k">                call </span><span class="n">save_density_matrix</span><span class="p">(</span><span class="k">file</span><span class="o">=</span><span class="s2">&quot;DM_MIXED&quot;</span><span class="p">,</span><span class="n">when</span><span class="o">=</span><span class="n">writeDM</span><span class="p">)</span>
                <span class="k">call </span><span class="n">write_spmatrix</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="k">file</span><span class="o">=</span><span class="s2">&quot;H_DMGEN&quot;</span><span class="p">,</span><span class="n">when</span><span class="o">=</span><span class="n">writeH</span><span class="p">)</span>
             <span class="k">end if</span>
<span class="k">          end if</span>

<span class="k">          call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;IterSCF&#39;</span><span class="p">,</span> <span class="mi">2</span> <span class="p">)</span>
          <span class="k">call </span><span class="n">print_timings</span><span class="p">(</span> <span class="n">first_scf</span><span class="p">,</span> <span class="n">istep</span> <span class="o">==</span> <span class="n">inicoor</span> <span class="p">)</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">cml_p</span><span class="p">)</span> <span class="k">call </span><span class="n">cmlEndStep</span><span class="p">(</span><span class="n">mainXML</span><span class="p">)</span>

<span class="cp">#ifdef SIESTA__FLOOK</span>
          <span class="c">! Communicate with lua</span>
          <span class="k">call </span><span class="n">slua_call</span><span class="p">(</span><span class="n">LUA</span><span class="p">,</span> <span class="n">LUA_SCF_LOOP</span><span class="p">)</span>

          <span class="c">! Retrieve an easy character string</span>
          <span class="n">nnext_mixer</span> <span class="o">=</span> <span class="n">cunpack</span><span class="p">(</span><span class="n">next_mixer</span><span class="p">)</span>
          <span class="k">if</span> <span class="p">(</span> <span class="nb">len_trim</span><span class="p">(</span><span class="n">nnext_mixer</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">mix_charge</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">             if</span> <span class="p">(</span> <span class="n">TSrun</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">                do </span><span class="n">imix</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">ts_scf_mixs</span><span class="p">)</span>
                   <span class="k">if</span> <span class="p">(</span> <span class="n">ts_scf_mixs</span><span class="p">(</span><span class="n">imix</span><span class="p">)%</span><span class="n">name</span> <span class="o">==</span> <span class="n">nnext_mixer</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">                      call </span><span class="n">mixers_history_init</span><span class="p">(</span><span class="n">ts_scf_mixs</span><span class="p">)</span>
                      <span class="n">scf_mix</span> <span class="o">=&gt;</span> <span class="n">ts_scf_mixs</span><span class="p">(</span><span class="n">imix</span><span class="p">)</span>
                      <span class="k">exit</span>
<span class="k">                   end if</span>
<span class="k">                end do</span>
<span class="k">             else</span>
<span class="k">                do </span><span class="n">imix</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">scf_mixs</span><span class="p">)</span>
                   <span class="k">if</span> <span class="p">(</span> <span class="n">scf_mixs</span><span class="p">(</span><span class="n">imix</span><span class="p">)%</span><span class="n">name</span> <span class="o">==</span> <span class="n">nnext_mixer</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">                      call </span><span class="n">mixers_history_init</span><span class="p">(</span><span class="n">scf_mixs</span><span class="p">)</span>
                      <span class="n">scf_mix</span> <span class="o">=&gt;</span> <span class="n">scf_mixs</span><span class="p">(</span><span class="n">imix</span><span class="p">)</span>
                      <span class="k">exit</span>
<span class="k">                   end if</span>
<span class="k">                end do</span>
<span class="k">             end if</span>

             <span class="c">! Check that we indeed have changed the mixer</span>
             <span class="k">if</span> <span class="p">(</span> <span class="n">IONode</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">scf_mix</span><span class="p">%</span><span class="n">name</span> <span class="o">/=</span> <span class="n">nnext_mixer</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">                write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(2a)&#39;</span><span class="p">)</span> <span class="s1">&#39;siesta-lua: WARNING: trying to change &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="s1">&#39;to a non-existing mixer! Not changing anything!&#39;</span>

             <span class="k">else if</span> <span class="p">(</span> <span class="n">IONode</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">                write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(2a)&#39;</span><span class="p">)</span> <span class="s1">&#39;siesta-lua: Switching mixer method to: &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="nb">trim</span><span class="p">(</span><span class="n">nnext_mixer</span><span class="p">)</span>

             <span class="k">end if</span>
             <span class="c">! Reset for next loop</span>
             <span class="n">next_mixer</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>

             <span class="c">! Update the references</span>
             <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Weight&#39;</span><span class="p">,</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">w</span><span class="p">)</span>
             <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Restart&#39;</span><span class="p">,</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">restart</span><span class="p">)</span>
             <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Iterations&#39;</span><span class="p">,</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">n_itt</span><span class="p">)</span>

          <span class="k">end if</span>
<span class="cp">#endif</span>

          <span class="c">! ... except that we might continue for TranSiesta</span>
          <span class="k">if</span> <span class="p">(</span> <span class="n">SCFconverged</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">             call </span><span class="n">transiesta_switch</span><span class="p">()</span>
             <span class="c">! might reset SCFconverged and iscf</span>
          <span class="k">end if</span>

<span class="k">       else</span>

          <span class="c">! non-siesta worker</span>
          <span class="k">call </span><span class="n">compute_DM</span><span class="p">(</span> <span class="n">iscf</span> <span class="p">)</span>

       <span class="k">end if</span>

<span class="cp">#ifdef SIESTA__PEXSI</span>
       <span class="k">call </span><span class="n">broadcast</span><span class="p">(</span><span class="n">iscf</span><span class="p">,</span> <span class="n">comm</span><span class="o">=</span><span class="n">true_MPI_Comm_World</span><span class="p">)</span>
       <span class="k">call </span><span class="n">broadcast</span><span class="p">(</span><span class="n">SCFconverged</span><span class="p">,</span> <span class="n">comm</span><span class="o">=</span><span class="n">true_MPI_Comm_World</span><span class="p">)</span>
<span class="cp">#endif</span>

       <span class="c">!! Exit if converged:</span>
       <span class="c">!!@code</span>
       <span class="k">if</span> <span class="p">(</span> <span class="n">SCFconverged</span> <span class="p">)</span> <span class="k">exit</span>
       <span class="c">!!@endcode</span>

    <span class="k">end do</span>
    <span class="c">!! **end of SCF cycle**</span>

<span class="cp">#ifdef SIESTA__PEXSI</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">isolve</span> <span class="o">==</span> <span class="n">SOLVE_PEXSI</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">       call </span><span class="n">pexsi_finalize_scfloop</span><span class="p">()</span>
    <span class="k">end if</span>
<span class="cp">#endif</span>

    <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SIESTA_worker</span> <span class="p">)</span> <span class="k">return</span>

<span class="k">    call </span><span class="n">end_of_cycle_save_operations</span><span class="p">()</span>

    <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SCFconverged</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">       if</span> <span class="p">(</span> <span class="n">SCFMustConverge</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">          call </span><span class="n">message</span><span class="p">(</span><span class="s1">&#39;FATAL&#39;</span><span class="p">,</span><span class="s1">&#39;SCF_NOT_CONV: SCF did not converge&#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
               <span class="s1">&#39; in maximum number of steps (required).&#39;</span><span class="p">)</span>
          <span class="k">write</span><span class="p">(</span><span class="n">tmp_str</span><span class="p">,</span><span class="s2">&quot;(2(i5,tr1),f12.6)&quot;</span><span class="p">)</span> <span class="n">istep</span><span class="p">,</span> <span class="n">iscf</span><span class="p">,</span> <span class="n">prevDmax</span>
          <span class="k">call </span><span class="n">message</span><span class="p">(</span><span class="s1">&#39; (info)&#39;</span><span class="p">,</span><span class="s2">&quot;Geom step, scf iteration, dmax:&quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">tmp_str</span><span class="p">))</span>
          <span class="k">call </span><span class="n">die</span><span class="p">(</span><span class="s1">&#39;ABNORMAL_TERMINATION&#39;</span><span class="p">)</span>
       <span class="k">else if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">harrisfun</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">          call </span><span class="n">message</span><span class="p">(</span><span class="s1">&#39;WARNING&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
               <span class="s1">&#39;SCF_NOT_CONV: SCF did not converge  in maximum number of steps.&#39;</span><span class="p">)</span>
          <span class="k">write</span><span class="p">(</span><span class="n">tmp_str</span><span class="p">,</span><span class="s2">&quot;(2(i5,tr1),f12.6)&quot;</span><span class="p">)</span> <span class="n">istep</span><span class="p">,</span> <span class="n">iscf</span><span class="p">,</span> <span class="n">prevDmax</span>
          <span class="k">call </span><span class="n">message</span><span class="p">(</span><span class="s1">&#39; (info)&#39;</span><span class="p">,</span><span class="s2">&quot;Geom step, scf iteration, dmax:&quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">tmp_str</span><span class="p">))</span>
       <span class="k">end if</span>
<span class="k">    end if</span>

    <span class="c">! To write the initial wavefunctions to be used in a</span>
    <span class="c">! consequent TDDFT run.</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">writetdwf</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">       </span><span class="n">istpp</span> <span class="o">=</span> <span class="mi">0</span>
       <span class="k">call </span><span class="n">initwf</span><span class="p">(</span><span class="n">istpp</span><span class="p">,</span><span class="n">totime</span><span class="p">)</span>
    <span class="k">end if</span>
<span class="k">    </span>
<span class="k">    if</span> <span class="p">(</span> <span class="n">TSmode</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">TSinit</span><span class="p">.</span><span class="nb">and</span><span class="p">.(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SCFConverged</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
       <span class="c">! Signal that the DM hasn&#39;t converged, so we cannot</span>
       <span class="c">! continue to the transiesta routines</span>
       <span class="k">call </span><span class="n">die</span><span class="p">(</span><span class="s1">&#39;ABNORMAL_TERMINATION&#39;</span><span class="p">)</span>
    <span class="k">end if</span>
    
    <span class="c">! Clean-up here to limit memory usage</span>
    <span class="k">call </span><span class="n">mixers_scf_history_init</span><span class="p">(</span> <span class="p">)</span>
    
    <span class="c">! End of standard SCF loop.</span>
    <span class="c">! Do one more pass to compute forces and stresses</span>
    
    <span class="c">! Note that this call will no longer overwrite H while computing the</span>
    <span class="c">! final energies, forces and stresses...</span>
    
    <span class="k">if</span> <span class="p">(</span> <span class="n">fdf_get</span><span class="p">(</span><span class="s2">&quot;compute-forces&quot;</span><span class="p">,.</span><span class="n">true</span><span class="p">.)</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">       call </span><span class="n">post_scf_work</span><span class="p">(</span> <span class="n">istep</span><span class="p">,</span> <span class="n">iscf</span> <span class="p">,</span> <span class="n">SCFconverged</span> <span class="p">)</span>
<span class="cp">#ifdef SIESTA__PEXSI</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">ionode</span><span class="p">)</span> <span class="k">call </span><span class="n">memory_snapshot</span><span class="p">(</span><span class="s2">&quot;after post_scf_work&quot;</span><span class="p">)</span>
<span class="cp">#endif</span>
    <span class="k">end if</span>
    
    <span class="c">! ... so H at this point is the latest generator of the DM, except</span>
    <span class="c">! if mixing H beyond self-consistency or terminating the scf loop</span>
    <span class="c">! without convergence while mixing H</span>
    
    <span class="k">call </span><span class="n">state_analysis</span><span class="p">(</span> <span class="n">istep</span> <span class="p">)</span>
<span class="cp">#ifdef SIESTA__PEXSI</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ionode</span><span class="p">)</span> <span class="k">call </span><span class="n">memory_snapshot</span><span class="p">(</span><span class="s2">&quot;after state_analysis&quot;</span><span class="p">)</span>
<span class="cp">#endif</span>

    <span class="c">! If siesta is running as a subroutine, send forces to master program</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">siesta_server</span><span class="p">)</span> <span class="p">&amp;</span>
         <span class="k">call </span><span class="n">forcesToMaster</span><span class="p">(</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">Etot</span><span class="p">,</span> <span class="n">cfa</span><span class="p">,</span> <span class="n">cstress</span> <span class="p">)</span>

<span class="cp">#ifdef DEBUG</span>
    <span class="k">call </span><span class="n">write_debug</span><span class="p">(</span> <span class="s1">&#39;    POS siesta_forces&#39;</span> <span class="p">)</span>
<span class="cp">#endif</span>
    
  <span class="k">contains</span>

    <span class="c">! Read the Hamiltonian from a file</span>
    <span class="k">subroutine </span><span class="n">get_H_from_file</span><span class="p">()</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">listhptr</span>
      <span class="k">use </span><span class="n">atomlist</span><span class="p">,</span>        <span class="n">only</span><span class="p">:</span> <span class="n">no_l</span>
      <span class="k">use </span><span class="n">m_spin</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">nspin</span>
      <span class="k">use </span><span class="n">m_iodm_old</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">read_spmatrix</span>

      <span class="kt">logical</span> <span class="kd">::</span> <span class="n">found</span>

      <span class="k">call </span><span class="n">read_spmatrix</span><span class="p">(</span><span class="n">maxnh</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">nspin</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="p">&amp;</span>
           <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">userfile</span><span class="o">=</span><span class="s2">&quot;H_IN&quot;</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">found</span><span class="p">)</span> <span class="k">call </span><span class="n">die</span><span class="p">(</span><span class="s2">&quot;Could not find H_IN&quot;</span><span class="p">)</span>

    <span class="k">end subroutine </span><span class="n">get_H_from_file</span>

    <span class="c">! Computes forces and stresses with the current DM_out</span>
    <span class="k">subroutine </span><span class="n">compute_forces</span><span class="p">()</span>

      <span class="k">use </span><span class="n">siesta_options</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">recompute_H_after_scf</span>
      <span class="k">use </span><span class="n">m_final_H_f_stress</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">final_H_f_stress</span>
      <span class="k">use </span><span class="n">write_subs</span>

      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">fa_old</span><span class="p">(:,:),</span> <span class="n">Hsave</span><span class="p">(:,:)</span>

      <span class="k">allocate</span><span class="p">(</span><span class="n">fa_old</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">fa</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">fa</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)))</span>
      <span class="n">fa_old</span><span class="p">(:,:)</span> <span class="o">=</span> <span class="n">fa</span><span class="p">(:,:)</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">recompute_H_after_scf</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">         allocate</span><span class="p">(</span><span class="n">Hsave</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)))</span>
         <span class="n">Hsave</span><span class="p">(:,:)</span> <span class="o">=</span> <span class="n">H</span><span class="p">(:,:)</span>
      <span class="k">end if</span>
<span class="k">      call </span><span class="n">final_H_f_stress</span><span class="p">(</span> <span class="n">istep</span> <span class="p">,</span> <span class="n">iscf</span> <span class="p">,</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">recompute_H_after_scf</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">         </span><span class="n">H</span><span class="p">(:,:)</span> <span class="o">=</span> <span class="n">Hsave</span><span class="p">(:,:)</span>
         <span class="k">deallocate</span><span class="p">(</span><span class="n">Hsave</span><span class="p">)</span>
      <span class="k">end if</span>
<span class="k">      if</span> <span class="p">(</span><span class="n">ionode</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         print</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;Max diff in force (eV/Ang): &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
              <span class="nb">maxval</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">fa</span><span class="o">-</span><span class="n">fa_old</span><span class="p">))</span><span class="o">*</span><span class="n">Ang</span><span class="o">/</span><span class="n">eV</span>
         <span class="k">call </span><span class="n">siesta_write_forces</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
         <span class="k">call </span><span class="n">siesta_write_stress_pressure</span><span class="p">()</span>
      <span class="n">endif</span>
      <span class="k">deallocate</span><span class="p">(</span><span class="n">fa_old</span><span class="p">)</span>

    <span class="k">end subroutine </span><span class="n">compute_forces</span>

    <span class="c">! Print out timings of the first SCF loop only</span>
    <span class="k">subroutine </span><span class="n">print_timings</span><span class="p">(</span><span class="n">first_scf</span><span class="p">,</span> <span class="n">first_md</span><span class="p">)</span>
      <span class="k">use </span><span class="n">timer_options</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">use_tree_timer</span>
      <span class="k">use </span><span class="n">m_ts_global_vars</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">TSrun</span>
      <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">first_scf</span><span class="p">,</span> <span class="n">first_md</span>
      <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="kd">::</span> <span class="n">routine</span>

      <span class="c">! If this is not the first iteration,</span>
      <span class="c">! we immediately return.</span>
      <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">first_scf</span> <span class="p">)</span> <span class="k">return</span>
<span class="k">      if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">first_md</span> <span class="p">)</span> <span class="k">return</span>

<span class="k">      </span><span class="n">routine</span> <span class="o">=</span> <span class="s1">&#39;IterSCF&#39;</span>

      <span class="k">if</span> <span class="p">(</span> <span class="n">TSrun</span> <span class="p">)</span> <span class="k">then</span>
         <span class="c">! with Green function generation</span>
         <span class="c">! The tree-timer requires direct</span>
         <span class="c">! children of the routine to be</span>
         <span class="c">! queried.</span>
         <span class="c">! This is not obeyed in the TS case... :(</span>
         <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">use_tree_timer</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            </span><span class="n">routine</span> <span class="o">=</span> <span class="s1">&#39;TS&#39;</span>
         <span class="k">end if</span>
<span class="k">      </span><span class="n">endif</span>
      <span class="k">call </span><span class="n">timer</span><span class="p">(</span> <span class="n">routine</span><span class="p">,</span> <span class="mi">3</span> <span class="p">)</span>

    <span class="k">end subroutine </span><span class="n">print_timings</span>

    <span class="c">! Depending on various conditions, save the DMin</span>
    <span class="c">! or the DMout, and possibly keep a copy of H</span>

    <span class="c">! NOTE: Only if the scf cycle converged before exit it</span>
    <span class="c">! is guaranteed that the DM is &quot;pure out&quot; and that</span>
    <span class="c">! we can recover the right H if mixing H.</span>
    <span class="c">!</span>
    <span class="k">subroutine </span><span class="n">end_of_cycle_save_operations</span><span class="p">()</span>

      <span class="kt">logical</span> <span class="kd">::</span> <span class="n">DM_write</span><span class="p">,</span> <span class="n">H_write</span>

      <span class="c">! Depending on the option we should overwrite the</span>
      <span class="c">! Hamiltonian</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">mixH</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">mix_after_convergence</span> <span class="p">)</span> <span class="k">then</span>
         <span class="c">! Make sure that we keep the H actually used</span>
         <span class="c">! to generate the last DM, if needed.</span>
         <span class="n">H</span> <span class="o">=</span> <span class="n">Hold</span>
      <span class="k">end if</span>

<span class="k">      </span><span class="n">DM_write</span> <span class="o">=</span> <span class="n">write_DM_at_end_of_cycle</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
           <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">writeDM</span>
      <span class="n">H_write</span> <span class="o">=</span> <span class="n">write_H_at_end_of_cycle</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
           <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">writeH</span>

      <span class="k">if</span> <span class="p">(</span> <span class="n">mix_after_convergence</span> <span class="p">)</span> <span class="k">then</span>
         <span class="c">! If we have been saving them, there is no point in doing</span>
         <span class="c">! it one more time</span>
         <span class="k">if</span> <span class="p">(</span> <span class="n">mixH</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            call </span><span class="n">save_density_matrix</span><span class="p">(</span><span class="k">file</span><span class="o">=</span><span class="s2">&quot;DM_OUT&quot;</span><span class="p">,</span> <span class="n">when</span><span class="o">=</span><span class="n">DM_write</span><span class="p">)</span>
            <span class="k">call </span><span class="n">write_spmatrix</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="k">file</span><span class="o">=</span><span class="s2">&quot;H_MIXED&quot;</span><span class="p">,</span> <span class="n">when</span><span class="o">=</span><span class="n">H_write</span><span class="p">)</span>
         <span class="k">else</span>
<span class="k">            call </span><span class="n">save_density_matrix</span><span class="p">(</span><span class="k">file</span><span class="o">=</span><span class="s2">&quot;DM_MIXED&quot;</span><span class="p">,</span> <span class="n">when</span><span class="o">=</span><span class="n">DM_write</span><span class="p">)</span>
            <span class="k">call </span><span class="n">write_spmatrix</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="k">file</span><span class="o">=</span><span class="s2">&quot;H_DMGEN&quot;</span><span class="p">,</span> <span class="n">when</span><span class="o">=</span><span class="n">H_write</span><span class="p">)</span>
         <span class="k">end if</span>
<span class="k">      else</span>
<span class="k">         call </span><span class="n">save_density_matrix</span><span class="p">(</span><span class="k">file</span><span class="o">=</span><span class="s2">&quot;DM_OUT&quot;</span><span class="p">,</span> <span class="n">when</span><span class="o">=</span><span class="n">DM_write</span><span class="p">)</span>
         <span class="k">call </span><span class="n">write_spmatrix</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="k">file</span><span class="o">=</span><span class="s2">&quot;H_DMGEN&quot;</span><span class="p">,</span> <span class="n">when</span><span class="o">=</span><span class="n">H_write</span><span class="p">)</span>
      <span class="k">end if</span>

<span class="k">    end subroutine </span><span class="n">end_of_cycle_save_operations</span>

    <span class="k">subroutine </span><span class="n">transiesta_switch</span><span class="p">()</span>

      <span class="k">use </span><span class="nb">precision</span><span class="p">,</span>             <span class="n">only</span><span class="p">:</span> <span class="n">dp</span>
      <span class="k">use </span><span class="n">parallel</span><span class="p">,</span>              <span class="n">only</span><span class="p">:</span> <span class="n">IONode</span>
      <span class="k">use </span><span class="n">class_dSpData2D</span>
      <span class="k">use </span><span class="n">class_Fstack_dData1D</span>
      <span class="k">use </span><span class="n">densematrix</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">resetDenseMatrix</span>

      <span class="k">use </span><span class="n">siesta_options</span><span class="p">,</span>        <span class="n">only</span><span class="p">:</span> <span class="n">fire_mix</span><span class="p">,</span> <span class="n">broyden_maxit</span>
      <span class="k">use </span><span class="n">siesta_options</span><span class="p">,</span>        <span class="n">only</span><span class="p">:</span> <span class="n">dDtol</span><span class="p">,</span> <span class="n">dHtol</span>

      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">DM_2D</span><span class="p">,</span> <span class="n">EDM_2D</span>
      <span class="k">use </span><span class="n">atomlist</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">lasto</span>
      <span class="k">use </span><span class="n">siesta_geom</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">nsc</span><span class="p">,</span> <span class="n">isc_off</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">ucell</span>
      <span class="k">use </span><span class="n">m_energies</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">Ef</span>
      <span class="k">use </span><span class="n">m_mixing</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">mixers_history_init</span>
      <span class="k">use </span><span class="n">m_mixing_scf</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">scf_mix</span><span class="p">,</span> <span class="n">scf_mixs</span>
      <span class="k">use </span><span class="n">m_rhog</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">resetRhoG</span>

      <span class="k">use </span><span class="n">m_ts_global_vars</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">TSinit</span><span class="p">,</span> <span class="n">TSrun</span>
      <span class="k">use </span><span class="n">m_ts_global_vars</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">ts_print_transiesta</span>
      <span class="k">use </span><span class="n">m_ts_method</span>
      <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">N_Elec</span><span class="p">,</span> <span class="n">Elecs</span>
      <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">DM_bulk</span>
      <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">val_swap</span>
      <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">ts_Dtol</span><span class="p">,</span> <span class="n">ts_Htol</span>
      <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">ts_hist_keep</span>
      <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">ts_siesta_stop</span>
      <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">ts_scf_mixs</span>
      <span class="k">use </span><span class="n">m_ts_electype</span>

      <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iEl</span><span class="p">,</span> <span class="n">na_a</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">allowed_a</span><span class="p">(:)</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">DM</span><span class="p">(:,:),</span> <span class="n">EDM</span><span class="p">(:,:)</span>

      <span class="c">! We are done with the initial diagon run</span>
      <span class="c">! Now we start the TRANSIESTA (Green functions) run</span>
      <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">TSmode</span> <span class="p">)</span> <span class="k">return</span>
<span class="k">      if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">TSinit</span> <span class="p">)</span> <span class="k">return</span>

      <span class="c">! whether we are in siesta initialization step</span>
      <span class="n">TSinit</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
      <span class="c">! whether transiesta is running</span>
      <span class="n">TSrun</span>  <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>

      <span class="c">! If transiesta should stop immediately</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">ts_siesta_stop</span> <span class="p">)</span> <span class="k">then</span>

<span class="k">         if</span> <span class="p">(</span> <span class="n">IONode</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(a)&#39;</span><span class="p">)</span> <span class="s1">&#39;ts: Stopping transiesta (user option)!&#39;</span>
         <span class="k">end if</span>

<span class="k">         return</span>

<span class="k">      end if</span>

      <span class="c">! Reduce memory requirements</span>
      <span class="k">call </span><span class="n">resetDenseMatrix</span><span class="p">()</span>

      <span class="c">! Signal to continue...</span>
      <span class="c">! These two variables are from the top-level</span>
      <span class="c">! routine (siesta_forces)</span>
      <span class="n">SCFconverged</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
      <span class="n">iscf</span> <span class="o">=</span> <span class="mi">0</span>

      <span class="c">! DANGER (when/if going back to the DIAGON run, we should</span>
      <span class="c">! re-instantiate the original mixing value)</span>
      <span class="k">call </span><span class="n">val_swap</span><span class="p">(</span><span class="n">dDtol</span><span class="p">,</span> <span class="n">ts_Dtol</span><span class="p">)</span>
      <span class="k">call </span><span class="n">val_swap</span><span class="p">(</span><span class="n">dHtol</span><span class="p">,</span> <span class="n">ts_Htol</span><span class="p">)</span>

      <span class="c">! Clean up mixing history</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">mix_charge</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">resetRhoG</span><span class="p">(.</span><span class="n">true</span><span class="p">.)</span>
      <span class="k">else</span>
<span class="k">        if</span> <span class="p">(</span> <span class="nb">associated</span><span class="p">(</span><span class="n">ts_scf_mixs</span><span class="p">,</span> <span class="k">target</span><span class="o">=</span><span class="n">scf_mixs</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">          do </span><span class="n">iel</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">stack</span><span class="p">)</span>
            <span class="k">call </span><span class="n">reset</span><span class="p">(</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">stack</span><span class="p">(</span><span class="n">iel</span><span class="p">),</span> <span class="o">-</span><span class="n">ts_hist_keep</span><span class="p">)</span>
            <span class="c">! Reset iteration count as certain</span>
            <span class="c">! mixing schemes require this for consistency</span>
            <span class="n">scf_mix</span><span class="p">%</span><span class="n">cur_itt</span> <span class="o">=</span> <span class="n">n_items</span><span class="p">(</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">stack</span><span class="p">(</span><span class="n">iel</span><span class="p">))</span>
          <span class="k">end do</span>
<span class="k">        else</span>
<span class="k">          call </span><span class="n">mixers_history_init</span><span class="p">(</span><span class="n">scf_mixs</span><span class="p">)</span>
        <span class="k">end if</span>
<span class="k">      end if</span>
      
      <span class="c">! Transfer scf_mixing to the transiesta mixing routine</span>
      <span class="n">scf_mix</span> <span class="o">=&gt;</span> <span class="n">ts_scf_mixs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="cp">#ifdef SIESTA__FLOOK</span>
      <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">mix_charge</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Weight&#39;</span><span class="p">,</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">w</span><span class="p">)</span>
         <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Restart&#39;</span><span class="p">,</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">restart</span><span class="p">)</span>
         <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Iterations&#39;</span><span class="p">,</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">n_itt</span><span class="p">)</span>
      <span class="k">end if</span>
<span class="cp">#endif</span>

      <span class="k">call </span><span class="n">ts_print_transiesta</span><span class="p">()</span>

      <span class="c">! In case of transiesta and DM_bulk.</span>
      <span class="c">! In case we ask for initialization of the DM in bulk</span>
      <span class="c">! we read in the DM files from the electrodes and</span>
      <span class="c">! initialize the bulk to those values</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">DM_bulk</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">then</span>

<span class="k">         if</span> <span class="p">(</span> <span class="n">IONode</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(/,2a)&#39;</span><span class="p">)</span> <span class="s1">&#39;transiesta: &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
                 <span class="s1">&#39;Initializing bulk DM in electrodes.&#39;</span>
         <span class="k">end if</span>

<span class="k">         </span><span class="n">na_a</span> <span class="o">=</span> <span class="mi">0</span>
         <span class="k">do </span><span class="n">iEl</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">na_u</span>
            <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">a_isDev</span><span class="p">(</span><span class="n">iEl</span><span class="p">)</span> <span class="p">)</span> <span class="n">na_a</span> <span class="o">=</span> <span class="n">na_a</span> <span class="o">+</span> <span class="mi">1</span>
         <span class="k">end do</span>
<span class="k">         allocate</span><span class="p">(</span><span class="n">allowed_a</span><span class="p">(</span><span class="n">na_a</span><span class="p">))</span>
         <span class="n">na_a</span> <span class="o">=</span> <span class="mi">0</span>
         <span class="k">do </span><span class="n">iEl</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">na_u</span>
            <span class="c">! We allow the buffer atoms as well (this will even out the</span>
            <span class="c">! potential around the back of the electrode)</span>
            <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">a_isDev</span><span class="p">(</span><span class="n">iEl</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">               </span><span class="n">na_a</span> <span class="o">=</span> <span class="n">na_a</span> <span class="o">+</span> <span class="mi">1</span>
               <span class="n">allowed_a</span><span class="p">(</span><span class="n">na_a</span><span class="p">)</span> <span class="o">=</span> <span class="n">iEl</span>
            <span class="k">end if</span>
<span class="k">         end do</span>

<span class="k">         do </span><span class="n">iEl</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">N_Elec</span>

            <span class="k">if</span> <span class="p">(</span> <span class="n">IONode</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">               write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(/,2a)&#39;</span><span class="p">)</span> <span class="s1">&#39;transiesta: &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
                    <span class="s1">&#39;Reading in electrode TSDE for &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
                    <span class="nb">trim</span><span class="p">(</span><span class="n">Elecs</span><span class="p">(</span><span class="n">iEl</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
            <span class="k">end if</span>

            <span class="c">! Copy over the DM in the lead</span>
            <span class="c">! Notice that the EDM matrix that is copied over</span>
            <span class="c">! will be equivalent at Ef == 0</span>
            <span class="k">call </span><span class="n">copy_DM</span><span class="p">(</span><span class="n">Elecs</span><span class="p">(</span><span class="n">iEl</span><span class="p">),</span><span class="n">na_u</span><span class="p">,</span><span class="n">xa</span><span class="p">,</span><span class="n">lasto</span><span class="p">,</span><span class="n">nsc</span><span class="p">,</span><span class="n">isc_off</span><span class="p">,</span> <span class="p">&amp;</span>
                 <span class="n">ucell</span><span class="p">,</span> <span class="n">DM_2D</span><span class="p">,</span> <span class="n">EDM_2D</span><span class="p">,</span> <span class="n">na_a</span><span class="p">,</span> <span class="n">allowed_a</span><span class="p">)</span>

         <span class="k">end do</span>

         <span class="c">! Clean-up</span>
         <span class="k">deallocate</span><span class="p">(</span><span class="n">allowed_a</span><span class="p">)</span>

         <span class="k">if</span> <span class="p">(</span> <span class="n">IONode</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="c">! new-line</span>
         <span class="k">end if</span>

         <span class="c">! The electrode EDM is aligned at Ef == 0</span>
         <span class="c">! We need to align the energy matrix</span>
         <span class="n">DM</span>  <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">DM_2D</span><span class="p">)</span>
         <span class="n">EDM</span> <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">EDM_2D</span><span class="p">)</span>
         <span class="n">iEl</span> <span class="o">=</span>  <span class="n">size</span><span class="p">(</span><span class="n">DM</span><span class="p">)</span>
         <span class="k">call </span><span class="n">daxpy</span><span class="p">(</span><span class="n">iEl</span><span class="p">,</span><span class="n">Ef</span><span class="p">,</span><span class="n">DM</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">EDM</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>

      <span class="k">end if</span>

<span class="k">    end subroutine </span><span class="n">transiesta_switch</span>

  <span class="k">end subroutine </span><span class="n">siesta_forces</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>

  <section class="visible-xs visible-sm hidden-md">
    <hr>
    

<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allprocs-1">All Procedures</a></h3></div>
  <div id="allprocs-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../proc/compute_dm.html">compute_dm</a>
      
      <a class="list-group-item" href="../interface/compute_max_diff.html">compute_max_diff</a>
      
      <a class="list-group-item" href="../proc/compute_max_diff_1d.html">compute_max_diff_1d</a>
      
      <a class="list-group-item" href="../proc/compute_max_diff_2d.html">compute_max_diff_2d</a>
      
      <a class="list-group-item" href="../proc/current_itt.html">current_itt</a>
      
      <a class="list-group-item" href="../proc/getstackval.html">getstackval</a>
      
      <a class="list-group-item" href="../proc/inverse.html">inverse</a>
      
      <a class="list-group-item" href="../proc/is_next.html">is_next</a>
      
      <a class="list-group-item" href="../proc/mix_method.html">mix_method</a>
      
      <a class="list-group-item" href="../proc/mix_method_variant.html">mix_method_variant</a>
      
      <a class="list-group-item" href="../proc/mixer_init.html">mixer_init</a>
      
      <a class="list-group-item" href="../proc/mixers_history_init.html">mixers_history_init</a>
      
      <a class="list-group-item" href="../proc/mixers_init.html">mixers_init</a>
      
      <a class="list-group-item" href="../proc/mixers_print.html">mixers_print</a>
      
      <a class="list-group-item" href="../proc/mixers_print_block.html">mixers_print_block</a>
      
      <a class="list-group-item" href="../proc/mixers_reset.html">mixers_reset</a>
      
      <a class="list-group-item" href="../proc/mixers_scf_history_init.html">mixers_scf_history_init</a>
      
      <a class="list-group-item" href="../proc/mixers_scf_init.html">mixers_scf_init</a>
      
      <a class="list-group-item" href="../proc/mixers_scf_print.html">mixers_scf_print</a>
      
      <a class="list-group-item" href="../proc/mixers_scf_print_block.html">mixers_scf_print_block</a>
      
      <a class="list-group-item" href="../proc/mixers_scf_reset.html">mixers_scf_reset</a>
      
      <a class="list-group-item" href="../interface/mixing.html">mixing</a>
      
      <a class="list-group-item" href="../proc/mixing_1d.html">mixing_1d</a>
      
      <a class="list-group-item" href="../proc/mixing_2d.html">mixing_2d</a>
      
      <a class="list-group-item" href="../proc/mixing_calc_next.html">mixing_calc_next</a>
      
      <a class="list-group-item" href="../proc/mixing_coeff.html">mixing_coeff</a>
      
      <a class="list-group-item" href="../proc/mixing_finalize.html">mixing_finalize</a>
      
      <a class="list-group-item" href="../proc/mixing_init.html">mixing_init</a>
      
      <a class="list-group-item" href="../proc/mixing_ncoeff.html">mixing_ncoeff</a>
      
      <a class="list-group-item" href="../proc/mixing_scf_converged.html">mixing_scf_converged</a>
      
      <a class="list-group-item" href="../proc/mixing_step.html">mixing_step</a>
      
      <a class="list-group-item" href="../proc/norm.html">norm</a>
      
      <a class="list-group-item" href="../proc/push_diff.html">push_diff</a>
      
      <a class="list-group-item" href="../proc/push_f.html">push_F</a>
      
      <a class="list-group-item" href="../proc/push_stack_data.html">push_stack_data</a>
      
      <a class="list-group-item" href="../proc/setup_h0.html">setup_H0</a>
      
      <a class="list-group-item" href="../proc/setup_hamiltonian.html">setup_hamiltonian</a>
      
      <a class="list-group-item" href="../proc/siesta_analysis.html">siesta_analysis</a>
      
      <a class="list-group-item" href="../proc/siesta_forces.html">siesta_forces</a>
      
      <a class="list-group-item" href="../proc/stack_check.html">stack_check</a>
      
      <a class="list-group-item" href="../proc/state_analysis.html">state_analysis</a>
      
      <a class="list-group-item" href="../proc/state_init.html">state_init</a>
      
      <a class="list-group-item" href="../proc/svd.html">svd</a>
      
      <a class="list-group-item" href="../proc/update_f.html">update_F</a>
      
    </div>
  </div>
</div>


  </section>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2018 <a rel="license" href="http://www.gnu.org/licenses/old-licenses/fdl-1.2.en.html">GNU Free Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> SIESTA was developed by SIESTA Group</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>