<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="A first-principles materials simulation code using Density Functional Theory.">
    
    <meta name="author" content="SIESTA Group" >
    <link rel="icon" href="../favicon.png">

    <title>siesta_forces &ndash; SIESTA</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">SIESTA <small>trunk-700--vdikan-edens-711-ford-681</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>Program Overview</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>siesta_forces
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 4.0% of total for procedures.">375 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/siesta_forces.F90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/siesta_forces.f90.html'>siesta_forces.F90</a></li>
    
     <li><a href='../module/m_siesta_forces.html'>m_siesta_forces</a></li>
    
  
     <li class="active">siesta_forces</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/siesta_forces.html#src">siesta_forces</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine siesta_forces(istep)
    
    
   
</h2>
    
  
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
      
      <li class="list-group-item">
  <ul class="list-inline">
    
    <li><a href='../module/units.html'>units</a></li>
    
    <li><a href='../module/precision.html'>precision</a></li>
    
    <li><a href='../module/sys.html'>sys</a></li>
    
    <li>files</li>
    
    <li>siesta_cml</li>
    
    <li><a href='../module/m_state_init.html'>m_state_init</a></li>
    
    <li><a href='../module/m_setup_hamiltonian.html'>m_setup_hamiltonian</a></li>
    
    <li><a href='../module/m_setup_h0.html'>m_setup_H0</a></li>
    
    <li><a href='../module/m_compute_dm.html'>m_compute_dm</a></li>
    
    <li><a href='../module/m_compute_max_diff.html'>m_compute_max_diff</a></li>
    
    <li>m_scfconvergence_test</li>
    
    <li>m_post_scf_work</li>
    
    <li>m_mixer</li>
    
    <li><a href='../module/m_mixing_scf.html'>m_mixing_scf</a></li>
    
    <li><a href='../module/m_mixing_scf.html'>m_mixing_scf</a></li>
    
    <li><a href='../module/m_mixing_scf.html'>m_mixing_scf</a></li>
    
    <li><a href='../module/m_rhog.html'>m_rhog</a></li>
    
    <li><a href='../module/siesta_options.html'>siesta_options</a></li>
    
    <li><a href='../module/parallel.html'>parallel</a></li>
    
    <li><a href='../module/m_state_analysis.html'>m_state_analysis</a></li>
    
    <li>m_steps</li>
    
    <li>m_spin</li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>m_convergence</li>
    
    <li>m_convergence</li>
    
    <li>siesta_geom</li>
    
    <li>m_energies</li>
    
    <li>m_forces</li>
    
    <li>m_stress</li>
    
    <li>siesta_master</li>
    
    <li>siesta_master</li>
    
    <li>m_save_density_matrix</li>
    
    <li>m_iodm_old</li>
    
    <li>atomlist</li>
    
    <li>m_dm_charge</li>
    
    <li>m_pexsi_solver</li>
    
    <li>write_subs</li>
    
    <li>write_subs</li>
    
    <li><a href='../module/m_compute_energies.html'>m_compute_energies</a></li>
    
    <li>m_mpi_utils</li>
    
    <li>fdf</li>
    
    <li>m_check_walltime</li>
    
    <li>m_energies</li>
    
    <li>m_ts_options</li>
    
    <li>m_ts_method</li>
    
    <li>m_ts_global_vars</li>
    
    <li>siesta_geom</li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>m_ts_charge</li>
    
    <li>m_ts_charge</li>
    
    <li>m_ts_charge</li>
    
    <li>m_ts_charge</li>
    
    <li>m_transiesta</li>
    
    <li>kpoint_scf_m</li>
    
    <li>m_energies</li>
    
    <li>m_initwf</li>
    
  </ul>
      </li>
      
      
      
      <li class="list-group-item">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~siesta_forces~~UsesGraph Pages: 1 -->
<svg id="procsiesta_forcesUsesGraph" width="587pt" height="1818pt"
 viewBox="0.00 0.00 587.00 1818.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~siesta_forces~~UsesGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 1814)">
<title>proc~~siesta_forces~~UsesGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1814 583,-1814 583,4 -4,4"/>
<!-- proc~siesta_forces -->
<g id="proc~~siesta_forces~~UsesGraph_node1" class="node"><title>proc~siesta_forces</title>
<polygon fill="none" stroke="black" points="579,-919 503,-919 503,-895 579,-895 579,-919"/>
<text text-anchor="middle" x="541" y="-904.6" font-family="Helvetica,sans-Serif" font-size="10.50">siesta_forces</text>
</g>
<!-- m_check_walltime -->
<g id="proc~~siesta_forces~~UsesGraph_node2" class="node"><title>m_check_walltime</title>
<polygon fill="#337ab7" stroke="#337ab7" points="454,-1810 354,-1810 354,-1786 454,-1786 454,-1810"/>
<text text-anchor="middle" x="404" y="-1795.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_check_walltime</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_check_walltime -->
<g id="proc~~siesta_forces~~UsesGraph_edge1" class="edge"><title>proc~siesta_forces&#45;&gt;m_check_walltime</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.729,-919.078C537.401,-1018.48 519.587,-1699.72 467,-1772 464.738,-1775.11 462.032,-1777.85 459.034,-1780.26"/>
<polygon fill="#000000" stroke="#000000" points="456.91,-1777.47 450.517,-1785.92 460.783,-1783.3 456.91,-1777.47"/>
</g>
<!-- m_spin -->
<g id="proc~~siesta_forces~~UsesGraph_node3" class="node"><title>m_spin</title>
<polygon fill="#337ab7" stroke="#337ab7" points="258.5,-586 204.5,-586 204.5,-562 258.5,-562 258.5,-586"/>
<text text-anchor="middle" x="231.5" y="-571.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_spin</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_spin -->
<g id="proc~~siesta_forces~~UsesGraph_edge33" class="edge"><title>proc~siesta_forces&#45;&gt;m_spin</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M536.379,-894.931C528.233,-869.858 506.059,-811.9 467,-781 421.128,-744.71 387.688,-778.234 341,-743 289.073,-703.812 255.203,-631.974 240.653,-595.896"/>
<polygon fill="#000000" stroke="#000000" points="243.811,-594.362 236.91,-586.323 237.292,-596.911 243.811,-594.362"/>
</g>
<!-- write_subs -->
<g id="proc~~siesta_forces~~UsesGraph_node4" class="node"><title>write_subs</title>
<polygon fill="#337ab7" stroke="#337ab7" points="263.5,-1750 199.5,-1750 199.5,-1726 263.5,-1726 263.5,-1750"/>
<text text-anchor="middle" x="231.5" y="-1735.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_subs</text>
</g>
<!-- proc~siesta_forces&#45;&gt;write_subs -->
<g id="proc~~siesta_forces~~UsesGraph_edge11" class="edge"><title>proc~siesta_forces&#45;&gt;write_subs</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.9,-919.11C538.969,-1017.3 530.348,-1680.97 467,-1739 414.826,-1786.8 325.411,-1769.23 273.369,-1753.03"/>
<polygon fill="#000000" stroke="#000000" points="274.384,-1749.68 263.792,-1749.93 272.229,-1756.34 274.384,-1749.68"/>
</g>
<!-- m_ts_options -->
<g id="proc~~siesta_forces~~UsesGraph_node5" class="node"><title>m_ts_options</title>
<polygon fill="#337ab7" stroke="#337ab7" points="442,-1688 366,-1688 366,-1664 442,-1664 442,-1688"/>
<text text-anchor="middle" x="404" y="-1673.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_options</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_ts_options -->
<g id="proc~~siesta_forces~~UsesGraph_edge4" class="edge"><title>proc~siesta_forces&#45;&gt;m_ts_options</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.599,-919.17C536.47,-1011.13 514.799,-1594.76 467,-1655 462.921,-1660.14 457.527,-1664.03 451.619,-1666.97"/>
<polygon fill="#000000" stroke="#000000" points="449.981,-1663.86 442.027,-1670.86 452.609,-1670.35 449.981,-1663.86"/>
</g>
<!-- siesta_cml -->
<g id="proc~~siesta_forces~~UsesGraph_node6" class="node"><title>siesta_cml</title>
<polygon fill="#337ab7" stroke="#337ab7" points="435.5,-1646 372.5,-1646 372.5,-1622 435.5,-1622 435.5,-1646"/>
<text text-anchor="middle" x="404" y="-1631.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_cml</text>
</g>
<!-- proc~siesta_forces&#45;&gt;siesta_cml -->
<g id="proc~~siesta_forces~~UsesGraph_edge5" class="edge"><title>proc~siesta_forces&#45;&gt;siesta_cml</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.53,-919.047C535.974,-1007.63 512.209,-1556.36 467,-1613 461.497,-1619.89 453.63,-1624.54 445.34,-1627.66"/>
<polygon fill="#000000" stroke="#000000" points="444.061,-1624.4 435.529,-1630.68 446.116,-1631.09 444.061,-1624.4"/>
</g>
<!-- module~parallel -->
<g id="proc~~siesta_forces~~UsesGraph_node7" class="node"><title>module~parallel</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node7"><a xlink:href=".././module/parallel.html" xlink:title="parallel">
<polygon fill="#337ab7" stroke="#337ab7" points="431,-1604 377,-1604 377,-1580 431,-1580 431,-1604"/>
<text text-anchor="middle" x="404" y="-1589.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;module~parallel -->
<g id="proc~~siesta_forces~~UsesGraph_edge6" class="edge"><title>proc~siesta_forces&#45;&gt;module~parallel</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.443,-919.142C535.406,-1004.95 509.585,-1518 467,-1571 460.487,-1579.11 450.709,-1584.1 440.832,-1587.17"/>
<polygon fill="#000000" stroke="#000000" points="439.878,-1583.8 431.04,-1589.65 441.593,-1590.59 439.878,-1583.8"/>
</g>
<!-- m_energies -->
<g id="proc~~siesta_forces~~UsesGraph_node8" class="node"><title>m_energies</title>
<polygon fill="#337ab7" stroke="#337ab7" points="438.5,-1562 369.5,-1562 369.5,-1538 438.5,-1538 438.5,-1562"/>
<text text-anchor="middle" x="404" y="-1547.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_energies</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_energies -->
<g id="proc~~siesta_forces~~UsesGraph_edge7" class="edge"><title>proc~siesta_forces&#45;&gt;m_energies</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M540.273,-919.026C541.803,-996.986 546.613,-1430.65 467,-1529 462.182,-1534.95 455.606,-1539.22 448.531,-1542.29"/>
<polygon fill="#000000" stroke="#000000" points="446.953,-1539.14 438.691,-1545.77 449.286,-1545.74 446.953,-1539.14"/>
</g>
<!-- m_dm_charge -->
<g id="proc~~siesta_forces~~UsesGraph_node9" class="node"><title>m_dm_charge</title>
<polygon fill="#337ab7" stroke="#337ab7" points="445,-1520 363,-1520 363,-1496 445,-1496 445,-1520"/>
<text text-anchor="middle" x="404" y="-1505.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_dm_charge</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_dm_charge -->
<g id="proc~~siesta_forces~~UsesGraph_edge26" class="edge"><title>proc~siesta_forces&#45;&gt;m_dm_charge</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M540.164,-919.42C540.917,-995.286 541.296,-1396 467,-1487 463.496,-1491.29 459.078,-1494.71 454.222,-1497.43"/>
<polygon fill="#000000" stroke="#000000" points="452.735,-1494.26 445.109,-1501.62 455.657,-1500.62 452.735,-1494.26"/>
</g>
<!-- module~m_setup_h0 -->
<g id="proc~~siesta_forces~~UsesGraph_node10" class="node"><title>module~m_setup_h0</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node10"><a xlink:href=".././module/m_setup_h0.html" xlink:title="m_setup_H0">
<polygon fill="#337ab7" stroke="#337ab7" points="440.5,-1478 367.5,-1478 367.5,-1454 440.5,-1454 440.5,-1478"/>
<text text-anchor="middle" x="404" y="-1463.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_setup_H0</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;module~m_setup_h0 -->
<g id="proc~~siesta_forces~~UsesGraph_edge8" class="edge"><title>proc~siesta_forces&#45;&gt;module~m_setup_h0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M540.029,-919.456C539.949,-992.144 536.11,-1361.19 467,-1445 462.531,-1450.42 456.605,-1454.45 450.187,-1457.44"/>
<polygon fill="#000000" stroke="#000000" points="448.638,-1454.28 440.544,-1461.12 451.135,-1460.82 448.638,-1454.28"/>
</g>
<!-- module~sys -->
<g id="proc~~siesta_forces~~UsesGraph_node11" class="node"><title>module~sys</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node11"><a xlink:href=".././module/sys.html" xlink:title="sys">
<polygon fill="#337ab7" stroke="#337ab7" points="431,-1436 377,-1436 377,-1412 431,-1412 431,-1436"/>
<text text-anchor="middle" x="404" y="-1421.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sys</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;module~sys -->
<g id="proc~~siesta_forces~~UsesGraph_edge9" class="edge"><title>proc~siesta_forces&#45;&gt;module~sys</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.872,-919.379C538.913,-988.493 530.973,-1326.3 467,-1403 460.394,-1410.92 450.68,-1415.86 440.893,-1418.95"/>
<polygon fill="#000000" stroke="#000000" points="440.001,-1415.56 431.192,-1421.45 441.75,-1422.34 440.001,-1415.56"/>
</g>
<!-- kpoint_scf_m -->
<g id="proc~~siesta_forces~~UsesGraph_node12" class="node"><title>kpoint_scf_m</title>
<polygon fill="#337ab7" stroke="#337ab7" points="442,-1394 366,-1394 366,-1370 442,-1370 442,-1394"/>
<text text-anchor="middle" x="404" y="-1379.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">kpoint_scf_m</text>
</g>
<!-- proc~siesta_forces&#45;&gt;kpoint_scf_m -->
<g id="proc~~siesta_forces~~UsesGraph_edge10" class="edge"><title>proc~siesta_forces&#45;&gt;kpoint_scf_m</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.571,-919.401C537.095,-984.379 522.728,-1285.29 467,-1356 462.777,-1361.36 457.25,-1365.63 451.235,-1369.02"/>
<polygon fill="#000000" stroke="#000000" points="449.653,-1365.9 442.167,-1373.39 452.695,-1372.2 449.653,-1365.9"/>
</g>
<!-- module~m_state_analysis -->
<g id="proc~~siesta_forces~~UsesGraph_node13" class="node"><title>module~m_state_analysis</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node13"><a xlink:href=".././module/m_state_analysis.html" xlink:title="m_state_analysis">
<polygon fill="#337ab7" stroke="#337ab7" points="451.5,-1730 356.5,-1730 356.5,-1706 451.5,-1706 451.5,-1730"/>
<text text-anchor="middle" x="404" y="-1715.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_state_analysis</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;module~m_state_analysis -->
<g id="proc~~siesta_forces~~UsesGraph_edge12" class="edge"><title>proc~siesta_forces&#45;&gt;module~m_state_analysis</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.664,-919.24C536.948,-1014.34 517.402,-1633.14 467,-1697 465.086,-1699.43 462.879,-1701.57 460.463,-1703.47"/>
<polygon fill="#000000" stroke="#000000" points="458.193,-1700.76 451.566,-1709.03 461.901,-1706.7 458.193,-1700.76"/>
</g>
<!-- m_steps -->
<g id="proc~~siesta_forces~~UsesGraph_node14" class="node"><title>m_steps</title>
<polygon fill="#337ab7" stroke="#337ab7" points="431,-1314 377,-1314 377,-1290 431,-1290 431,-1314"/>
<text text-anchor="middle" x="404" y="-1299.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_steps</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_steps -->
<g id="proc~~siesta_forces~~UsesGraph_edge13" class="edge"><title>proc~siesta_forces&#45;&gt;m_steps</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.229,-919.27C535.341,-977.428 516.099,-1224.85 467,-1281 460.337,-1288.62 450.807,-1293.48 441.21,-1296.58"/>
<polygon fill="#000000" stroke="#000000" points="440.068,-1293.26 431.302,-1299.21 441.865,-1300.02 440.068,-1293.26"/>
</g>
<!-- m_mixer -->
<g id="proc~~siesta_forces~~UsesGraph_node15" class="node"><title>m_mixer</title>
<polygon fill="#337ab7" stroke="#337ab7" points="431,-1272 377,-1272 377,-1248 431,-1248 431,-1272"/>
<text text-anchor="middle" x="404" y="-1257.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_mixer</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_mixer -->
<g id="proc~~siesta_forces~~UsesGraph_edge14" class="edge"><title>proc~siesta_forces&#45;&gt;m_mixer</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M538.786,-919.062C533.232,-972.098 508.711,-1184.14 467,-1234 460.259,-1242.06 450.595,-1247.66 440.896,-1251.54"/>
<polygon fill="#000000" stroke="#000000" points="439.592,-1248.29 431.293,-1254.88 441.888,-1254.9 439.592,-1248.29"/>
</g>
<!-- module~m_compute_max_diff -->
<g id="proc~~siesta_forces~~UsesGraph_node16" class="node"><title>module~m_compute_max_diff</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node16"><a xlink:href=".././module/m_compute_max_diff.html" xlink:title="m_compute_max_diff">
<polygon fill="#337ab7" stroke="#337ab7" points="289,-169 174,-169 174,-145 289,-145 289,-169"/>
<text text-anchor="middle" x="231.5" y="-154.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_compute_max_diff</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;module~m_compute_max_diff -->
<g id="proc~~siesta_forces~~UsesGraph_edge15" class="edge"><title>proc~siesta_forces&#45;&gt;module~m_compute_max_diff</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.905,-894.832C539.013,-796.169 530.638,-129.324 467,-71 425.716,-33.1635 389.246,-42.5693 341,-71 312.549,-87.7659 330.813,-115.403 305,-136 302.939,-137.645 300.753,-139.161 298.476,-140.558"/>
<polygon fill="#000000" stroke="#000000" points="296.528,-137.628 289.307,-145.38 299.787,-143.823 296.528,-137.628"/>
</g>
<!-- siesta_geom -->
<g id="proc~~siesta_forces~~UsesGraph_node17" class="node"><title>siesta_geom</title>
<polygon fill="#337ab7" stroke="#337ab7" points="440.5,-1192 367.5,-1192 367.5,-1168 440.5,-1168 440.5,-1192"/>
<text text-anchor="middle" x="404" y="-1177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_geom</text>
</g>
<!-- proc~siesta_forces&#45;&gt;siesta_geom -->
<g id="proc~~siesta_forces~~UsesGraph_edge16" class="edge"><title>proc~siesta_forces&#45;&gt;siesta_geom</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M540.191,-919.153C540.144,-959.188 534.527,-1088.39 467,-1159 462.303,-1163.91 456.418,-1167.67 450.155,-1170.56"/>
<polygon fill="#000000" stroke="#000000" points="448.863,-1167.3 440.805,-1174.18 451.394,-1173.83 448.863,-1167.3"/>
</g>
<!-- module~m_state_init -->
<g id="proc~~siesta_forces~~UsesGraph_node18" class="node"><title>module~m_state_init</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node18"><a xlink:href=".././module/m_state_init.html" xlink:title="m_state_init">
<polygon fill="#337ab7" stroke="#337ab7" points="439,-1150 369,-1150 369,-1126 439,-1126 439,-1150"/>
<text text-anchor="middle" x="404" y="-1135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_state_init</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;module~m_state_init -->
<g id="proc~~siesta_forces~~UsesGraph_edge17" class="edge"><title>proc~siesta_forces&#45;&gt;module~m_state_init</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.368,-919.12C536.86,-954.674 524.681,-1059.78 467,-1117 461.959,-1122 455.685,-1125.81 449.08,-1128.72"/>
<polygon fill="#000000" stroke="#000000" points="447.431,-1125.59 439.272,-1132.35 449.865,-1132.16 447.431,-1125.59"/>
</g>
<!-- m_ts_method -->
<g id="proc~~siesta_forces~~UsesGraph_node19" class="node"><title>m_ts_method</title>
<polygon fill="#337ab7" stroke="#337ab7" points="443,-1108 365,-1108 365,-1084 443,-1084 443,-1108"/>
<text text-anchor="middle" x="404" y="-1093.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_method</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_ts_method -->
<g id="proc~~siesta_forces~~UsesGraph_edge18" class="edge"><title>proc~siesta_forces&#45;&gt;m_ts_method</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M538.175,-919.091C532.928,-949.684 514.978,-1030.86 467,-1075 462.818,-1078.85 457.905,-1081.99 452.705,-1084.56"/>
<polygon fill="#000000" stroke="#000000" points="450.988,-1081.49 443.133,-1088.6 453.707,-1087.94 450.988,-1081.49"/>
</g>
<!-- m_ts_charge -->
<g id="proc~~siesta_forces~~UsesGraph_node20" class="node"><title>m_ts_charge</title>
<polygon fill="#337ab7" stroke="#337ab7" points="441.5,-1066 366.5,-1066 366.5,-1042 441.5,-1042 441.5,-1066"/>
<text text-anchor="middle" x="404" y="-1051.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_charge</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_ts_charge -->
<g id="proc~~siesta_forces~~UsesGraph_edge19" class="edge"><title>proc~siesta_forces&#45;&gt;m_ts_charge</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M536.168,-919.346C527.762,-944.426 505.338,-1001.61 467,-1033 462.325,-1036.83 456.917,-1039.97 451.282,-1042.55"/>
<polygon fill="#000000" stroke="#000000" points="449.67,-1039.43 441.676,-1046.38 452.261,-1045.93 449.67,-1039.43"/>
</g>
<!-- m_save_density_matrix -->
<g id="proc~~siesta_forces~~UsesGraph_node21" class="node"><title>m_save_density_matrix</title>
<polygon fill="#337ab7" stroke="#337ab7" points="466.5,-1024 341.5,-1024 341.5,-1000 466.5,-1000 466.5,-1024"/>
<text text-anchor="middle" x="404" y="-1009.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_save_density_matrix</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_save_density_matrix -->
<g id="proc~~siesta_forces~~UsesGraph_edge20" class="edge"><title>proc~siesta_forces&#45;&gt;m_save_density_matrix</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M532.547,-919.088C520.778,-937.217 496.2,-971.408 467,-991 464.567,-992.632 461.995,-994.149 459.337,-995.557"/>
<polygon fill="#000000" stroke="#000000" points="457.601,-992.505 450.045,-999.932 460.583,-998.839 457.601,-992.505"/>
</g>
<!-- m_stress -->
<g id="proc~~siesta_forces~~UsesGraph_node22" class="node"><title>m_stress</title>
<polygon fill="#337ab7" stroke="#337ab7" points="432,-982 376,-982 376,-958 432,-958 432,-982"/>
<text text-anchor="middle" x="404" y="-967.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_stress</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_stress -->
<g id="proc~~siesta_forces~~UsesGraph_edge21" class="edge"><title>proc~siesta_forces&#45;&gt;m_stress</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M521.326,-919.105C506.887,-928.126 486.188,-940.331 467,-949 459.035,-952.598 450.26,-955.93 441.881,-958.83"/>
<polygon fill="#000000" stroke="#000000" points="440.677,-955.542 432.298,-962.027 442.892,-962.183 440.677,-955.542"/>
</g>
<!-- module~m_compute_energies -->
<g id="proc~~siesta_forces~~UsesGraph_node23" class="node"><title>module~m_compute_energies</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node23"><a xlink:href=".././module/m_compute_energies.html" xlink:title="m_compute_energies">
<polygon fill="#337ab7" stroke="#337ab7" points="462,-940 346,-940 346,-916 462,-916 462,-940"/>
<text text-anchor="middle" x="404" y="-925.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_compute_energies</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;module~m_compute_energies -->
<g id="proc~~siesta_forces~~UsesGraph_edge22" class="edge"><title>proc~siesta_forces&#45;&gt;module~m_compute_energies</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M502.753,-912.794C493.231,-914.275 482.696,-915.914 472.172,-917.551"/>
<polygon fill="#000000" stroke="#000000" points="471.462,-914.119 462.118,-919.115 472.538,-921.036 471.462,-914.119"/>
</g>
<!-- m_mpi_utils -->
<g id="proc~~siesta_forces~~UsesGraph_node24" class="node"><title>m_mpi_utils</title>
<polygon fill="#337ab7" stroke="#337ab7" points="439,-898 369,-898 369,-874 439,-874 439,-898"/>
<text text-anchor="middle" x="404" y="-883.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_mpi_utils</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_mpi_utils -->
<g id="proc~~siesta_forces~~UsesGraph_edge23" class="edge"><title>proc~siesta_forces&#45;&gt;m_mpi_utils</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M502.753,-901.206C486.182,-898.628 466.544,-895.573 449.232,-892.881"/>
<polygon fill="#000000" stroke="#000000" points="449.768,-889.422 439.349,-891.343 448.692,-896.339 449.768,-889.422"/>
</g>
<!-- files -->
<g id="proc~~siesta_forces~~UsesGraph_node25" class="node"><title>files</title>
<polygon fill="#337ab7" stroke="#337ab7" points="431,-856 377,-856 377,-832 431,-832 431,-856"/>
<text text-anchor="middle" x="404" y="-841.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">files</text>
</g>
<!-- proc~siesta_forces&#45;&gt;files -->
<g id="proc~~siesta_forces~~UsesGraph_edge24" class="edge"><title>proc~siesta_forces&#45;&gt;files</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M521.326,-894.895C506.887,-885.874 486.188,-873.669 467,-865 458.648,-861.226 449.404,-857.746 440.661,-854.749"/>
<polygon fill="#000000" stroke="#000000" points="441.668,-851.396 431.075,-851.581 439.472,-858.043 441.668,-851.396"/>
</g>
<!-- m_pexsi_solver -->
<g id="proc~~siesta_forces~~UsesGraph_node26" class="node"><title>m_pexsi_solver</title>
<polygon fill="#337ab7" stroke="#337ab7" points="447.5,-814 360.5,-814 360.5,-790 447.5,-790 447.5,-814"/>
<text text-anchor="middle" x="404" y="-799.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_pexsi_solver</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_pexsi_solver -->
<g id="proc~~siesta_forces~~UsesGraph_edge25" class="edge"><title>proc~siesta_forces&#45;&gt;m_pexsi_solver</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M532.547,-894.912C520.778,-876.783 496.2,-842.592 467,-823 463.892,-820.914 460.557,-819.018 457.105,-817.296"/>
<polygon fill="#000000" stroke="#000000" points="458.33,-814.01 447.771,-813.138 455.481,-820.405 458.33,-814.01"/>
</g>
<!-- module~units -->
<g id="proc~~siesta_forces~~UsesGraph_node27" class="node"><title>module~units</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node27"><a xlink:href=".././module/units.html" xlink:title="units">
<polygon fill="#337ab7" stroke="#337ab7" points="258.5,-1313 204.5,-1313 204.5,-1289 258.5,-1289 258.5,-1313"/>
<text text-anchor="middle" x="231.5" y="-1298.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">units</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;module~units -->
<g id="proc~~siesta_forces~~UsesGraph_edge3" class="edge"><title>proc~siesta_forces&#45;&gt;module~units</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.862,-919.325C538.872,-982.526 530.872,-1269.36 467,-1323 409.902,-1370.95 315.172,-1339.43 265.387,-1317.32"/>
<polygon fill="#000000" stroke="#000000" points="266.603,-1314.03 256.054,-1313.05 263.691,-1320.4 266.603,-1314.03"/>
</g>
<!-- module~siesta_options -->
<g id="proc~~siesta_forces~~UsesGraph_node28" class="node"><title>module~siesta_options</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node28"><a xlink:href=".././module/siesta_options.html" xlink:title="siesta_options">
<polygon fill="#337ab7" stroke="#337ab7" points="444.5,-734 363.5,-734 363.5,-710 444.5,-710 444.5,-734"/>
<text text-anchor="middle" x="404" y="-719.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_options</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;module~siesta_options -->
<g id="proc~~siesta_forces~~UsesGraph_edge27" class="edge"><title>proc~siesta_forces&#45;&gt;module~siesta_options</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M537.608,-894.889C531.254,-865.729 511.321,-790.868 467,-748 463.067,-744.196 458.496,-740.914 453.652,-738.089"/>
<polygon fill="#000000" stroke="#000000" points="455.21,-734.954 444.717,-733.486 452.004,-741.177 455.21,-734.954"/>
</g>
<!-- m_convergence -->
<g id="proc~~siesta_forces~~UsesGraph_node29" class="node"><title>m_convergence</title>
<polygon fill="#337ab7" stroke="#337ab7" points="448.5,-692 359.5,-692 359.5,-668 448.5,-668 448.5,-692"/>
<text text-anchor="middle" x="404" y="-677.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_convergence</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_convergence -->
<g id="proc~~siesta_forces~~UsesGraph_edge28" class="edge"><title>proc~siesta_forces&#45;&gt;m_convergence</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.272,-894.856C536.512,-859.726 523.735,-756.947 467,-701 464.168,-698.207 460.951,-695.785 457.508,-693.686"/>
<polygon fill="#000000" stroke="#000000" points="459.068,-690.552 448.573,-689.101 455.872,-696.78 459.068,-690.552"/>
</g>
<!-- m_ts_global_vars -->
<g id="proc~~siesta_forces~~UsesGraph_node30" class="node"><title>m_ts_global_vars</title>
<polygon fill="#337ab7" stroke="#337ab7" points="452.5,-650 355.5,-650 355.5,-626 452.5,-626 452.5,-650"/>
<text text-anchor="middle" x="404" y="-635.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_global_vars</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_ts_global_vars -->
<g id="proc~~siesta_forces~~UsesGraph_edge29" class="edge"><title>proc~siesta_forces&#45;&gt;m_ts_global_vars</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M540.123,-894.758C539.843,-855.03 533.533,-728.271 467,-659 465.209,-657.135 463.247,-655.436 461.158,-653.888"/>
<polygon fill="#000000" stroke="#000000" points="462.923,-650.865 452.566,-648.633 459.271,-656.837 462.923,-650.865"/>
</g>
<!-- m_post_scf_work -->
<g id="proc~~siesta_forces~~UsesGraph_node31" class="node"><title>m_post_scf_work</title>
<polygon fill="#337ab7" stroke="#337ab7" points="452,-608 356,-608 356,-584 452,-584 452,-608"/>
<text text-anchor="middle" x="404" y="-593.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_post_scf_work</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_post_scf_work -->
<g id="proc~~siesta_forces~~UsesGraph_edge30" class="edge"><title>proc~siesta_forces&#45;&gt;m_post_scf_work</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M538.505,-894.921C532.162,-845.491 506,-659.251 467,-617 465.179,-615.027 463.166,-613.24 461.012,-611.62"/>
<polygon fill="#000000" stroke="#000000" points="462.468,-608.408 452.113,-606.168 458.812,-614.376 462.468,-608.408"/>
</g>
<!-- m_forces -->
<g id="proc~~siesta_forces~~UsesGraph_node32" class="node"><title>m_forces</title>
<polygon fill="#337ab7" stroke="#337ab7" points="432.5,-566 375.5,-566 375.5,-542 432.5,-542 432.5,-566"/>
<text text-anchor="middle" x="404" y="-551.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_forces</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_forces -->
<g id="proc~~siesta_forces~~UsesGraph_edge31" class="edge"><title>proc~siesta_forces&#45;&gt;m_forces</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M538.896,-894.681C533.812,-840.528 510.996,-624.13 467,-575 460.597,-567.85 451.671,-563.132 442.584,-560.02"/>
<polygon fill="#000000" stroke="#000000" points="443.348,-556.598 432.772,-557.234 441.435,-563.332 443.348,-556.598"/>
</g>
<!-- m_scfconvergence_test -->
<g id="proc~~siesta_forces~~UsesGraph_node33" class="node"><title>m_scfconvergence_test</title>
<polygon fill="#337ab7" stroke="#337ab7" points="467,-524 341,-524 341,-500 467,-500 467,-524"/>
<text text-anchor="middle" x="404" y="-509.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_scfconvergence_test</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_scfconvergence_test -->
<g id="proc~~siesta_forces~~UsesGraph_edge32" class="edge"><title>proc~siesta_forces&#45;&gt;m_scfconvergence_test</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.229,-894.73C535.341,-836.572 516.099,-589.152 467,-533 466.137,-532.013 465.227,-531.073 464.274,-530.177"/>
<polygon fill="#000000" stroke="#000000" points="466.342,-527.353 456.248,-524.134 462.132,-532.945 466.342,-527.353"/>
</g>
<!-- m_transiesta -->
<g id="proc~~siesta_forces~~UsesGraph_node34" class="node"><title>m_transiesta</title>
<polygon fill="#337ab7" stroke="#337ab7" points="441,-482 367,-482 367,-458 441,-458 441,-482"/>
<text text-anchor="middle" x="404" y="-467.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_transiesta</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_transiesta -->
<g id="proc~~siesta_forces~~UsesGraph_edge2" class="edge"><title>proc~siesta_forces&#45;&gt;m_transiesta</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.488,-894.626C536.674,-832.4 521.183,-554.171 467,-491 462.576,-485.842 456.836,-481.948 450.636,-479.008"/>
<polygon fill="#000000" stroke="#000000" points="451.91,-475.749 441.323,-475.349 449.35,-482.264 451.91,-475.749"/>
</g>
<!-- module~m_setup_hamiltonian -->
<g id="proc~~siesta_forces~~UsesGraph_node35" class="node"><title>module~m_setup_hamiltonian</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node35"><a xlink:href=".././module/m_setup_hamiltonian.html" xlink:title="m_setup_hamiltonian">
<polygon fill="#337ab7" stroke="#337ab7" points="461.5,-440 346.5,-440 346.5,-416 461.5,-416 461.5,-440"/>
<text text-anchor="middle" x="404" y="-425.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_setup_hamiltonian</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;module~m_setup_hamiltonian -->
<g id="proc~~siesta_forces~~UsesGraph_edge34" class="edge"><title>proc~siesta_forces&#45;&gt;module~m_setup_hamiltonian</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.708,-894.714C537.908,-828.988 526.342,-519.291 467,-449 466.155,-447.999 465.26,-447.045 464.321,-446.137"/>
<polygon fill="#000000" stroke="#000000" points="466.438,-443.349 456.378,-440.023 462.168,-448.896 466.438,-443.349"/>
</g>
<!-- siesta_master -->
<g id="proc~~siesta_forces~~UsesGraph_node36" class="node"><title>siesta_master</title>
<polygon fill="#337ab7" stroke="#337ab7" points="443.5,-398 364.5,-398 364.5,-374 443.5,-374 443.5,-398"/>
<text text-anchor="middle" x="404" y="-383.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_master</text>
</g>
<!-- proc~siesta_forces&#45;&gt;siesta_master -->
<g id="proc~~siesta_forces~~UsesGraph_edge35" class="edge"><title>proc~siesta_forces&#45;&gt;siesta_master</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.892,-894.974C539.041,-826.339 531.574,-484.511 467,-407 463.179,-402.413 458.315,-398.825 452.998,-396.018"/>
<polygon fill="#000000" stroke="#000000" points="454.292,-392.764 443.725,-391.993 451.505,-399.185 454.292,-392.764"/>
</g>
<!-- m_iodm_old -->
<g id="proc~~siesta_forces~~UsesGraph_node37" class="node"><title>m_iodm_old</title>
<polygon fill="#337ab7" stroke="#337ab7" points="439.5,-356 368.5,-356 368.5,-332 439.5,-332 439.5,-356"/>
<text text-anchor="middle" x="404" y="-341.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_iodm_old</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_iodm_old -->
<g id="proc~~siesta_forces~~UsesGraph_edge36" class="edge"><title>proc~siesta_forces&#45;&gt;m_iodm_old</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M540.042,-894.924C540.056,-822.842 536.724,-449.644 467,-365 462.281,-359.271 455.934,-355.098 449.097,-352.061"/>
<polygon fill="#000000" stroke="#000000" points="450.172,-348.727 439.578,-348.583 447.769,-355.302 450.172,-348.727"/>
</g>
<!-- module~precision -->
<g id="proc~~siesta_forces~~UsesGraph_node38" class="node"><title>module~precision</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node38"><a xlink:href=".././module/precision.html" xlink:title="precision">
<polygon fill="#337ab7" stroke="#337ab7" points="88.5,-210 33.5,-210 33.5,-186 88.5,-186 88.5,-210"/>
<text text-anchor="middle" x="61" y="-195.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">precision</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;module~precision -->
<g id="proc~~siesta_forces~~UsesGraph_edge37" class="edge"><title>proc~siesta_forces&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M538.912,-919.277C534.112,-970.355 512.984,-1165.04 467,-1201 422.888,-1235.5 385.959,-1234.39 341,-1201 173.044,-1076.27 80.7044,-356.968 64.5636,-220.388"/>
<polygon fill="#000000" stroke="#000000" points="68.0192,-219.803 63.383,-210.277 61.0664,-220.615 68.0192,-219.803"/>
</g>
<!-- module~m_compute_dm -->
<g id="proc~~siesta_forces~~UsesGraph_node39" class="node"><title>module~m_compute_dm</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node39"><a xlink:href=".././module/m_compute_dm.html" xlink:title="m_compute_dm">
<polygon fill="#337ab7" stroke="#337ab7" points="449,-272 359,-272 359,-248 449,-248 449,-272"/>
<text text-anchor="middle" x="404" y="-257.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_compute_dm</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;module~m_compute_dm -->
<g id="proc~~siesta_forces~~UsesGraph_edge38" class="edge"><title>proc~siesta_forces&#45;&gt;module~m_compute_dm</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M540.285,-894.897C541.888,-816.439 547.082,-379.999 467,-281 464.459,-277.859 461.429,-275.186 458.094,-272.91"/>
<polygon fill="#000000" stroke="#000000" points="459.725,-269.813 449.28,-268.035 456.337,-275.938 459.725,-269.813"/>
</g>
<!-- fdf -->
<g id="proc~~siesta_forces~~UsesGraph_node40" class="node"><title>fdf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="431,-230 377,-230 377,-206 431,-206 431,-230"/>
<text text-anchor="middle" x="404" y="-215.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fdf</text>
</g>
<!-- proc~siesta_forces&#45;&gt;fdf -->
<g id="proc~~siesta_forces~~UsesGraph_edge39" class="edge"><title>proc~siesta_forces&#45;&gt;fdf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.448,-894.785C535.446,-808.466 509.821,-292.33 467,-239 460.49,-230.892 450.712,-225.897 440.836,-222.826"/>
<polygon fill="#000000" stroke="#000000" points="441.596,-219.408 431.043,-220.351 439.881,-226.194 441.596,-219.408"/>
</g>
<!-- m_initwf -->
<g id="proc~~siesta_forces~~UsesGraph_node41" class="node"><title>m_initwf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="431,-188 377,-188 377,-164 431,-164 431,-188"/>
<text text-anchor="middle" x="404" y="-173.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_initwf</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_initwf -->
<g id="proc~~siesta_forces~~UsesGraph_edge40" class="edge"><title>proc~siesta_forces&#45;&gt;m_initwf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.535,-894.885C536.013,-805.802 512.446,-253.971 467,-197 460.515,-188.871 450.746,-183.87 440.868,-180.8"/>
<polygon fill="#000000" stroke="#000000" points="441.624,-177.381 431.071,-178.329 439.912,-184.168 441.624,-177.381"/>
</g>
<!-- sparse_matrices -->
<g id="proc~~siesta_forces~~UsesGraph_node42" class="node"><title>sparse_matrices</title>
<polygon fill="#337ab7" stroke="#337ab7" points="449.5,-146 358.5,-146 358.5,-122 449.5,-122 449.5,-146"/>
<text text-anchor="middle" x="404" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sparse_matrices</text>
</g>
<!-- proc~siesta_forces&#45;&gt;sparse_matrices -->
<g id="proc~~siesta_forces~~UsesGraph_edge41" class="edge"><title>proc~siesta_forces&#45;&gt;sparse_matrices</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.604,-894.765C536.508,-802.319 515.037,-215.572 467,-155 464.599,-151.973 461.742,-149.379 458.593,-147.157"/>
<polygon fill="#000000" stroke="#000000" points="460.111,-143.994 449.686,-142.102 456.655,-150.082 460.111,-143.994"/>
</g>
<!-- atomlist -->
<g id="proc~~siesta_forces~~UsesGraph_node43" class="node"><title>atomlist</title>
<polygon fill="#337ab7" stroke="#337ab7" points="431,-104 377,-104 377,-80 431,-80 431,-104"/>
<text text-anchor="middle" x="404" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">atomlist</text>
</g>
<!-- proc~siesta_forces&#45;&gt;atomlist -->
<g id="proc~~siesta_forces~~UsesGraph_edge42" class="edge"><title>proc~siesta_forces&#45;&gt;atomlist</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.676,-895C537.025,-800.435 517.693,-177.257 467,-113 460.559,-104.836 450.802,-99.8254 440.922,-96.7567"/>
<polygon fill="#000000" stroke="#000000" points="441.671,-93.3362 431.119,-94.2906 439.963,-100.125 441.671,-93.3362"/>
</g>
<!-- module~m_rhog -->
<g id="proc~~siesta_forces~~UsesGraph_node44" class="node"><title>module~m_rhog</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node44"><a xlink:href=".././module/m_rhog.html" xlink:title="m_rhog">
<polygon fill="#337ab7" stroke="#337ab7" points="431,-314 377,-314 377,-290 431,-290 431,-314"/>
<text text-anchor="middle" x="404" y="-299.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_rhog</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;module~m_rhog -->
<g id="proc~~siesta_forces~~UsesGraph_edge43" class="edge"><title>proc~siesta_forces&#45;&gt;module~m_rhog</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M540.171,-894.986C541.002,-819.853 541.923,-414.843 467,-323 460.481,-315.008 450.792,-310.044 441.001,-306.964"/>
<polygon fill="#000000" stroke="#000000" points="441.845,-303.568 431.289,-304.471 440.104,-310.348 441.845,-303.568"/>
</g>
<!-- module~m_mixing_scf -->
<g id="proc~~siesta_forces~~UsesGraph_node45" class="node"><title>module~m_mixing_scf</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node45"><a xlink:href=".././module/m_mixing_scf.html" xlink:title="m_mixing_scf">
<polygon fill="#337ab7" stroke="#337ab7" points="443,-24 365,-24 365,-0 443,-0 443,-24"/>
<text text-anchor="middle" x="404" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_mixing_scf</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;module~m_mixing_scf -->
<g id="proc~~siesta_forces~~UsesGraph_edge44" class="edge"><title>proc~siesta_forces&#45;&gt;module~m_mixing_scf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.733,-894.867C537.435,-795.005 519.815,-110.625 467,-38 463.171,-32.7343 458.067,-28.529 452.425,-25.1718"/>
<polygon fill="#000000" stroke="#000000" points="453.732,-21.912 443.223,-20.564 450.597,-28.1711 453.732,-21.912"/>
</g>
<!-- module~m_state_analysis&#45;&gt;write_subs -->
<g id="proc~~siesta_forces~~UsesGraph_edge45" class="edge"><title>module~m_state_analysis&#45;&gt;write_subs</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M356.41,-1723.47C330.615,-1726.49 298.828,-1730.22 273.908,-1733.14"/>
<polygon fill="#000000" stroke="#000000" points="273.21,-1729.7 263.686,-1734.34 274.025,-1736.65 273.21,-1729.7"/>
</g>
<!-- module~m_compute_max_diff&#45;&gt;module~precision -->
<g id="proc~~siesta_forces~~UsesGraph_edge46" class="edge"><title>module~m_compute_max_diff&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M180.856,-169.08C154.524,-175.487 122.733,-183.222 98.6577,-189.08"/>
<polygon fill="#000000" stroke="#000000" points="97.7397,-185.701 88.8507,-191.467 99.3947,-192.503 97.7397,-185.701"/>
</g>
<!-- module~units&#45;&gt;module~precision -->
<g id="proc~~siesta_forces~~UsesGraph_edge47" class="edge"><title>module~units&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M210.708,-1288.84C193.547,-1277.1 169.684,-1257.67 158,-1234 65.634,-1046.91 61.795,-353.825 61.9254,-220.329"/>
<polygon fill="#000000" stroke="#000000" points="65.4257,-220.116 61.9448,-210.109 58.4257,-220.102 65.4257,-220.116"/>
</g>
<!-- module~m_rhog&#45;&gt;m_spin -->
<g id="proc~~siesta_forces~~UsesGraph_edge50" class="edge"><title>module~m_rhog&#45;&gt;m_spin</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M376.971,-305.805C364.804,-308.74 350.861,-313.911 341,-323 271.535,-387.027 244.504,-503.181 235.91,-551.733"/>
<polygon fill="#000000" stroke="#000000" points="232.426,-551.35 234.226,-561.791 239.33,-552.506 232.426,-551.35"/>
</g>
<!-- module~m_rhog&#45;&gt;module~precision -->
<g id="proc~~siesta_forces~~UsesGraph_edge48" class="edge"><title>module~m_rhog&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M230.5,-198C187.595,-181.792 134.044,-185.436 98.9786,-190.696"/>
<polygon fill="#000000" stroke="#000000" points="98.0324,-187.304 88.722,-192.36 99.1534,-194.213 98.0324,-187.304"/>
</g>
<!-- class_Fstack_Pair_dData1D -->
<g id="proc~~siesta_forces~~UsesGraph_node48" class="node"><title>class_Fstack_Pair_dData1D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="305,-335 158,-335 158,-311 305,-311 305,-335"/>
<text text-anchor="middle" x="231.5" y="-320.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_Fstack_Pair_dData1D</text>
</g>
<!-- module~m_rhog&#45;&gt;class_Fstack_Pair_dData1D -->
<g id="proc~~siesta_forces~~UsesGraph_edge51" class="edge"><title>module~m_rhog&#45;&gt;class_Fstack_Pair_dData1D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M376.733,-305.235C360.127,-307.281 337.664,-310.047 315.414,-312.788"/>
<polygon fill="#000000" stroke="#000000" points="314.725,-309.346 305.228,-314.042 315.58,-316.294 314.725,-309.346"/>
</g>
<!-- class_dData1D -->
<g id="proc~~siesta_forces~~UsesGraph_node49" class="node"><title>class_dData1D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="103.5,-148 18.5,-148 18.5,-124 103.5,-124 103.5,-148"/>
<text text-anchor="middle" x="61" y="-133.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_dData1D</text>
</g>
<!-- module~m_rhog&#45;&gt;class_dData1D -->
<g id="proc~~siesta_forces~~UsesGraph_edge52" class="edge"><title>module~m_rhog&#45;&gt;class_dData1D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M376.879,-295.225C365.503,-291.756 352.232,-286.988 341,-281 287.424,-252.437 289.296,-219.456 232.5,-198"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M230.5,-198C199.231,-186.187 189.504,-189.172 158,-178 137.168,-170.612 114.486,-160.777 96.402,-152.481"/>
<polygon fill="#000000" stroke="#000000" points="97.4136,-149.091 86.8695,-148.055 94.4661,-155.441 97.4136,-149.091"/>
</g>
<!-- class_Pair_dData1D -->
<g id="proc~~siesta_forces~~UsesGraph_node50" class="node"><title>class_Pair_dData1D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="286,-293 177,-293 177,-269 286,-269 286,-293"/>
<text text-anchor="middle" x="231.5" y="-278.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_Pair_dData1D</text>
</g>
<!-- module~m_rhog&#45;&gt;class_Pair_dData1D -->
<g id="proc~~siesta_forces~~UsesGraph_edge49" class="edge"><title>module~m_rhog&#45;&gt;class_Pair_dData1D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M376.733,-298.765C355.352,-296.131 324.262,-292.302 296.417,-288.872"/>
<polygon fill="#000000" stroke="#000000" points="296.682,-285.379 286.329,-287.63 295.826,-292.326 296.682,-285.379"/>
</g>
<!-- module~m_mixing -->
<g id="proc~~siesta_forces~~UsesGraph_node46" class="node"><title>module~m_mixing</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node46"><a xlink:href=".././module/m_mixing.html" xlink:title="m_mixing">
<polygon fill="#337ab7" stroke="#337ab7" points="260.5,-127 202.5,-127 202.5,-103 260.5,-103 260.5,-127"/>
<text text-anchor="middle" x="231.5" y="-112.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_mixing</text>
</a>
</g>
</g>
<!-- module~m_mixing_scf&#45;&gt;module~m_mixing -->
<g id="proc~~siesta_forces~~UsesGraph_edge54" class="edge"><title>module~m_mixing_scf&#45;&gt;module~m_mixing</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M370.504,-24.0507C360.803,-28.0649 350.285,-32.8414 341,-38 309.767,-55.3532 276.664,-79.8491 255.354,-96.5198"/>
<polygon fill="#000000" stroke="#000000" points="252.927,-93.9774 247.254,-102.926 257.269,-99.4681 252.927,-93.9774"/>
</g>
<!-- class_Fstack_dData1D -->
<g id="proc~~siesta_forces~~UsesGraph_node47" class="node"><title>class_Fstack_dData1D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="122,-66 -7.10543e-15,-66 -7.10543e-15,-42 122,-42 122,-66"/>
<text text-anchor="middle" x="61" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_Fstack_dData1D</text>
</g>
<!-- module~m_mixing_scf&#45;&gt;class_Fstack_dData1D -->
<g id="proc~~siesta_forces~~UsesGraph_edge53" class="edge"><title>module~m_mixing_scf&#45;&gt;class_Fstack_dData1D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M364.876,-16.6957C308.721,-23.6121 202.821,-36.6555 132.324,-45.3383"/>
<polygon fill="#000000" stroke="#000000" points="131.688,-41.8902 122.19,-46.5865 132.543,-48.8377 131.688,-41.8902"/>
</g>
<!-- module~m_mixing&#45;&gt;module~precision -->
<g id="proc~~siesta_forces~~UsesGraph_edge55" class="edge"><title>module~m_mixing&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M202.276,-121.137C188.573,-124.624 172.07,-129.586 158,-136 143.913,-142.421 111.324,-164.055 88.0272,-179.967"/>
<polygon fill="#000000" stroke="#000000" points="85.8766,-177.198 79.6113,-185.742 89.8371,-182.97 85.8766,-177.198"/>
</g>
<!-- module~m_mixing&#45;&gt;class_Fstack_dData1D -->
<g id="proc~~siesta_forces~~UsesGraph_edge56" class="edge"><title>module~m_mixing&#45;&gt;class_Fstack_dData1D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M202.297,-104.79C175.667,-95.1496 135.366,-80.5598 104.78,-69.4871"/>
<polygon fill="#000000" stroke="#000000" points="105.814,-66.1394 95.2202,-66.0263 103.432,-72.7214 105.814,-66.1394"/>
</g>
<!-- module~m_mixing&#45;&gt;class_dData1D -->
<g id="proc~~siesta_forces~~UsesGraph_edge57" class="edge"><title>module~m_mixing&#45;&gt;class_dData1D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M202.297,-118.515C178.161,-121.523 142.793,-125.931 113.608,-129.568"/>
<polygon fill="#000000" stroke="#000000" points="113.061,-126.109 103.571,-130.819 113.927,-133.055 113.061,-126.109"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="490pt" height="32pt"
 viewBox="0.00 0.00 489.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 485.5,-28 485.5,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node"><title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node"><title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="139.5,-24 72.5,-24 72.5,-0 139.5,-0 139.5,-24"/>
<text text-anchor="middle" x="106" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="222,-24 158,-24 158,-0 222,-0 222,-24"/>
<text text-anchor="middle" x="190" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="294,-24 240,-24 240,-0 294,-0 294,-24"/>
<text text-anchor="middle" x="267" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="366,-24 312,-24 312,-0 366,-0 366,-24"/>
<text text-anchor="middle" x="339" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="481.5,-24 384.5,-24 384.5,-0 481.5,-0 481.5,-24"/>
<text text-anchor="middle" x="433" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses.
    </p>
    </div></div></div></div>
      </li>
      
      </ul>
    </div>
    


    
    <p>This subroutine represents central SIESTA operation logic.</p>
<p></p><div class="alert alert-success" role="alert"><h4>Todo</h4><p>It might be better to split the two,
  putting the grid initialization into <strong>state_init (link!)</strong> and moving the
  calculation of <script type="math/tex"> H_0 </script> to the body of the loop, done <code>if first_scf=.true.</code>
  This would suit <em>analysis</em> runs in which <strong>nscf = 0</strong>
</p></div>
<p>
<p>The dHmax variable only has meaning for Hamiltonian
  mixing, or when requiring the Hamiltonian to be converged.</p>
<h1>SCF loop</h1>
<p>The current structure of the loop tries to reproduce the
  historical Siesta usage. It should be made more clear.</p>
<p>Two changes:</p>
<ol>
<li>The number of scf iterations performed is exactly
     equal to the number specified (i.e., the "forces"
     phase is not counted as a final scf step)</li>
<li>At the change to a TranSiesta GF run the variable "first_scf"
     is implicitly reset to "true".</li>
</ol>
<h2>Start of SCF cycle</h2>
<p>Conditions of exit:</p>
<ul>
<li>At the top, to catch a non-positive nscf and # of iterations</li>
<li>At the bottom, based on convergence</li>
</ul>
<p>Note implications for TranSiesta when mixing <script type="math/tex">H</script>.
  Now <script type="math/tex">H</script> will be recomputed instead of simply being
  inherited, however, this is required as if
  we have bias calculations as the electric
  field across the junction needs to be present.</p>
<p><strong>end of SCF cycle</strong></p>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-istep"></span>integer,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>istep</strong></td><td></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~siesta_forces~~CallsGraph Pages: 1 -->
<svg id="procsiesta_forcesCallsGraph" width="641pt" height="3634pt"
 viewBox="0.00 0.00 641.00 3633.72" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~siesta_forces~~CallsGraph" class="graph" transform="scale(0.596279 0.596279) rotate(0) translate(4 6090)">
<title>proc~~siesta_forces~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-6090 1071,-6090 1071,4 -4,4"/>
<!-- proc~siesta_forces -->
<g id="proc~~siesta_forces~~CallsGraph_node1" class="node"><title>proc~siesta_forces</title>
<polygon fill="none" stroke="black" points="76,-1904 0,-1904 0,-1880 76,-1880 76,-1904"/>
<text text-anchor="middle" x="38" y="-1889.6" font-family="Helvetica,sans-Serif" font-size="10.50">siesta_forces</text>
</g>
<!-- proc~state_init -->
<g id="proc~~siesta_forces~~CallsGraph_node2" class="node"><title>proc~state_init</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node2"><a xlink:href=".././proc/state_init.html" xlink:title="state_init">
<polygon fill="#d9534f" stroke="#d9534f" points="355.5,-1548 300.5,-1548 300.5,-1524 355.5,-1524 355.5,-1548"/>
<text text-anchor="middle" x="328" y="-1533.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">state_init</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;proc~state_init -->
<g id="proc~~siesta_forces~~CallsGraph_edge1" class="edge"><title>proc~siesta_forces&#45;&gt;proc~state_init</title>
<path fill="none" stroke="#000000" d="M43.1876,-1904.34C51.8179,-1927.55 74.0251,-1977.15 112,-1997 159.66,-2021.91 191.347,-2031.02 233,-1997 302.326,-1940.38 321.845,-1642.84 326.027,-1558.38"/>
<polygon fill="#000000" stroke="#000000" points="329.526,-1558.48 326.501,-1548.33 322.534,-1558.15 329.526,-1558.48"/>
</g>
<!-- scfconvergence_test -->
<g id="proc~~siesta_forces~~CallsGraph_node3" class="node"><title>scfconvergence_test</title>
<polygon fill="#777777" stroke="#777777" points="228,-1946 117,-1946 117,-1922 228,-1922 228,-1946"/>
<text text-anchor="middle" x="172.5" y="-1931.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">scfconvergence_test</text>
</g>
<!-- proc~siesta_forces&#45;&gt;scfconvergence_test -->
<g id="proc~~siesta_forces~~CallsGraph_edge2" class="edge"><title>proc~siesta_forces&#45;&gt;scfconvergence_test</title>
<path fill="none" stroke="#000000" d="M76.2612,-1903.81C91.0939,-1908.51 108.341,-1913.98 124.051,-1918.96"/>
<polygon fill="#000000" stroke="#000000" points="123.009,-1922.3 133.599,-1921.99 125.124,-1915.63 123.009,-1922.3"/>
</g>
<!-- set_tolerance -->
<g id="proc~~siesta_forces~~CallsGraph_node4" class="node"><title>set_tolerance</title>
<polygon fill="#777777" stroke="#777777" points="211,-1904 134,-1904 134,-1880 211,-1880 211,-1904"/>
<text text-anchor="middle" x="172.5" y="-1889.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_tolerance</text>
</g>
<!-- proc~siesta_forces&#45;&gt;set_tolerance -->
<g id="proc~~siesta_forces~~CallsGraph_edge10" class="edge"><title>proc~siesta_forces&#45;&gt;set_tolerance</title>
<path fill="none" stroke="#000000" d="M76.2612,-1892C90.8141,-1892 107.691,-1892 123.16,-1892"/>
<polygon fill="#000000" stroke="#000000" points="123.599,-1895.5 133.599,-1892 123.599,-1888.5 123.599,-1895.5"/>
</g>
<!-- fdf_get -->
<g id="proc~~siesta_forces~~CallsGraph_node5" class="node"><title>fdf_get</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-6002 471.5,-6002 471.5,-5978 525.5,-5978 525.5,-6002"/>
<text text-anchor="middle" x="498.5" y="-5987.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fdf_get</text>
</g>
<!-- proc~siesta_forces&#45;&gt;fdf_get -->
<g id="proc~~siesta_forces~~CallsGraph_edge18" class="edge"><title>proc~siesta_forces&#45;&gt;fdf_get</title>
<path fill="none" stroke="#000000" d="M39.0188,-1904.35C39.4094,-2145.11 46.4518,-5826.13 112,-5912 154.251,-5967.35 373.876,-5984.02 461.423,-5988.5"/>
<polygon fill="#000000" stroke="#000000" points="461.265,-5992 471.424,-5988.99 461.606,-5985.01 461.265,-5992"/>
</g>
<!-- message -->
<g id="proc~~siesta_forces~~CallsGraph_node6" class="node"><title>message</title>
<polygon fill="#777777" stroke="#777777" points="200.5,-1862 144.5,-1862 144.5,-1838 200.5,-1838 200.5,-1862"/>
<text text-anchor="middle" x="172.5" y="-1847.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">message</text>
</g>
<!-- proc~siesta_forces&#45;&gt;message -->
<g id="proc~~siesta_forces~~CallsGraph_edge5" class="edge"><title>proc~siesta_forces&#45;&gt;message</title>
<path fill="none" stroke="#000000" d="M76.2612,-1880.19C94.4738,-1874.42 116.327,-1867.49 134.504,-1861.73"/>
<polygon fill="#000000" stroke="#000000" points="135.703,-1865.02 144.178,-1858.66 133.588,-1858.35 135.703,-1865.02"/>
</g>
<!-- proc~mixers_scf_history_init -->
<g id="proc~~siesta_forces~~CallsGraph_node7" class="node"><title>proc~mixers_scf_history_init</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node7"><a xlink:href=".././proc/mixers_scf_history_init.html" xlink:title="mixers_scf_history_init">
<polygon fill="#d9534f" stroke="#d9534f" points="233,-1988 112,-1988 112,-1964 233,-1964 233,-1988"/>
<text text-anchor="middle" x="172.5" y="-1973.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mixers_scf_history_init</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;proc~mixers_scf_history_init -->
<g id="proc~~siesta_forces~~CallsGraph_edge11" class="edge"><title>proc~siesta_forces&#45;&gt;proc~mixers_scf_history_init</title>
<path fill="none" stroke="#000000" d="M50.3237,-1904.21C63.8364,-1918.17 87.6725,-1940.89 112,-1955 115.029,-1956.76 118.23,-1958.4 121.512,-1959.94"/>
<polygon fill="#000000" stroke="#000000" points="120.331,-1963.24 130.901,-1963.97 123.093,-1956.81 120.331,-1963.24"/>
</g>
<!-- interface~compute_max_diff -->
<g id="proc~~siesta_forces~~CallsGraph_node8" class="node"><title>interface~compute_max_diff</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node8"><a xlink:href=".././interface/compute_max_diff.html" xlink:title="compute_max_diff">
<polygon fill="#a7506f" stroke="#a7506f" points="222.5,-1782 122.5,-1782 122.5,-1758 222.5,-1758 222.5,-1782"/>
<text text-anchor="middle" x="172.5" y="-1767.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_max_diff</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;interface~compute_max_diff -->
<g id="proc~~siesta_forces~~CallsGraph_edge7" class="edge"><title>proc~siesta_forces&#45;&gt;interface~compute_max_diff</title>
<path fill="none" stroke="#000000" d="M45.5224,-1879.79C56.7215,-1859.84 81.3855,-1820.07 112,-1796 116.431,-1792.52 121.401,-1789.4 126.53,-1786.64"/>
<polygon fill="#000000" stroke="#000000" points="128.42,-1789.62 135.853,-1782.07 125.334,-1783.33 128.42,-1789.62"/>
</g>
<!-- write_spmatrix -->
<g id="proc~~siesta_forces~~CallsGraph_node9" class="node"><title>write_spmatrix</title>
<polygon fill="#777777" stroke="#777777" points="213.5,-1740 131.5,-1740 131.5,-1716 213.5,-1716 213.5,-1740"/>
<text text-anchor="middle" x="172.5" y="-1725.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_spmatrix</text>
</g>
<!-- proc~siesta_forces&#45;&gt;write_spmatrix -->
<g id="proc~~siesta_forces~~CallsGraph_edge8" class="edge"><title>proc~siesta_forces&#45;&gt;write_spmatrix</title>
<path fill="none" stroke="#000000" d="M41.9295,-1879.74C49.0925,-1852.35 70.0529,-1785.72 112,-1749 115.065,-1746.32 118.495,-1743.97 122.12,-1741.92"/>
<polygon fill="#000000" stroke="#000000" points="123.961,-1744.92 131.432,-1737.4 120.907,-1738.62 123.961,-1744.92"/>
</g>
<!-- proc~bye -->
<g id="proc~~siesta_forces~~CallsGraph_node10" class="node"><title>proc~bye</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node10"><a xlink:href=".././proc/bye.html" xlink:title="bye">
<polygon fill="#d9534f" stroke="#d9534f" points="525.5,-3516 471.5,-3516 471.5,-3492 525.5,-3492 525.5,-3516"/>
<text text-anchor="middle" x="498.5" y="-3501.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bye</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;proc~bye -->
<g id="proc~~siesta_forces~~CallsGraph_edge9" class="edge"><title>proc~siesta_forces&#45;&gt;proc~bye</title>
<path fill="none" stroke="#000000" d="M40.3203,-1904.26C46.3256,-1958.95 72.4852,-2185.98 112,-2369 220.031,-2869.37 72.4916,-3104.92 423,-3478 433.114,-3488.77 447.925,-3495.07 461.682,-3498.77"/>
<polygon fill="#000000" stroke="#000000" points="460.899,-3502.18 471.431,-3501.03 462.478,-3495.36 460.899,-3502.18"/>
</g>
<!-- save_density_matrix -->
<g id="proc~~siesta_forces~~CallsGraph_node11" class="node"><title>save_density_matrix</title>
<polygon fill="#777777" stroke="#777777" points="227.5,-1698 117.5,-1698 117.5,-1674 227.5,-1674 227.5,-1698"/>
<text text-anchor="middle" x="172.5" y="-1683.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_density_matrix</text>
</g>
<!-- proc~siesta_forces&#45;&gt;save_density_matrix -->
<g id="proc~~siesta_forces~~CallsGraph_edge3" class="edge"><title>proc~siesta_forces&#45;&gt;save_density_matrix</title>
<path fill="none" stroke="#000000" d="M40.3443,-1879.71C44.5736,-1846.95 60.5458,-1756.61 112,-1707 113.247,-1705.8 114.567,-1704.66 115.946,-1703.59"/>
<polygon fill="#000000" stroke="#000000" points="117.886,-1706.51 124.396,-1698.15 114.094,-1700.62 117.886,-1706.51"/>
</g>
<!-- proc~state_analysis -->
<g id="proc~~siesta_forces~~CallsGraph_node12" class="node"><title>proc~state_analysis</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node12"><a xlink:href=".././proc/state_analysis.html" xlink:title="state_analysis">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-2915 288,-2915 288,-2891 368,-2891 368,-2915"/>
<text text-anchor="middle" x="328" y="-2900.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">state_analysis</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;proc~state_analysis -->
<g id="proc~~siesta_forces~~CallsGraph_edge26" class="edge"><title>proc~siesta_forces&#45;&gt;proc~state_analysis</title>
<path fill="none" stroke="#000000" d="M42.435,-1904.06C71.8783,-2007.42 281.609,-2743.66 320.726,-2880.98"/>
<polygon fill="#000000" stroke="#000000" points="317.416,-2882.13 323.522,-2890.79 324.148,-2880.21 317.416,-2882.13"/>
</g>
<!-- proc~compute_charge_diff -->
<g id="proc~~siesta_forces~~CallsGraph_node13" class="node"><title>proc~compute_charge_diff</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node13"><a xlink:href=".././proc/compute_charge_diff.html" xlink:title="compute_charge_diff">
<polygon fill="#d9534f" stroke="#d9534f" points="229,-5903 116,-5903 116,-5879 229,-5879 229,-5903"/>
<text text-anchor="middle" x="172.5" y="-5888.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_charge_diff</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;proc~compute_charge_diff -->
<g id="proc~~siesta_forces~~CallsGraph_edge12" class="edge"><title>proc~siesta_forces&#45;&gt;proc~compute_charge_diff</title>
<path fill="none" stroke="#000000" d="M39.0111,-1904.02C39.2494,-2134.7 43.9672,-5611.77 112,-5811 119.929,-5834.22 137.319,-5856.25 151.263,-5871.29"/>
<polygon fill="#000000" stroke="#000000" points="149.118,-5874.11 158.573,-5878.89 154.163,-5869.26 149.118,-5874.11"/>
</g>
<!-- proc~mixing_scf_converged -->
<g id="proc~~siesta_forces~~CallsGraph_node14" class="node"><title>proc~mixing_scf_converged</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node14"><a xlink:href=".././proc/mixing_scf_converged.html" xlink:title="mixing_scf_converged">
<polygon fill="#d9534f" stroke="#d9534f" points="232,-1656 113,-1656 113,-1632 232,-1632 232,-1656"/>
<text text-anchor="middle" x="172.5" y="-1641.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mixing_scf_converged</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;proc~mixing_scf_converged -->
<g id="proc~~siesta_forces~~CallsGraph_edge13" class="edge"><title>proc~siesta_forces&#45;&gt;proc~mixing_scf_converged</title>
<path fill="none" stroke="#000000" d="M39.3064,-1879.76C40.9074,-1842.3 50.8221,-1727.92 112,-1665 113.074,-1663.9 114.209,-1662.85 115.396,-1661.86"/>
<polygon fill="#000000" stroke="#000000" points="117.582,-1664.6 123.872,-1656.08 113.638,-1658.82 117.582,-1664.6"/>
</g>
<!-- dm_charge -->
<g id="proc~~siesta_forces~~CallsGraph_node15" class="node"><title>dm_charge</title>
<polygon fill="#777777" stroke="#777777" points="206,-1576 139,-1576 139,-1552 206,-1552 206,-1576"/>
<text text-anchor="middle" x="172.5" y="-1561.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dm_charge</text>
</g>
<!-- proc~siesta_forces&#45;&gt;dm_charge -->
<g id="proc~~siesta_forces~~CallsGraph_edge14" class="edge"><title>proc~siesta_forces&#45;&gt;dm_charge</title>
<path fill="none" stroke="#000000" d="M40.4847,-1879.86C46.8817,-1829.29 73.5198,-1635.87 112,-1590 116.782,-1584.3 123.053,-1579.81 129.727,-1576.29"/>
<polygon fill="#000000" stroke="#000000" points="131.338,-1579.4 138.977,-1572.06 128.427,-1573.03 131.338,-1579.4"/>
</g>
<!-- proc~setup_hamiltonian -->
<g id="proc~~siesta_forces~~CallsGraph_node16" class="node"><title>proc~setup_hamiltonian</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node16"><a xlink:href=".././proc/setup_hamiltonian.html" xlink:title="setup_hamiltonian">
<polygon fill="#d9534f" stroke="#d9534f" points="222.5,-3784 122.5,-3784 122.5,-3760 222.5,-3760 222.5,-3784"/>
<text text-anchor="middle" x="172.5" y="-3769.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_hamiltonian</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;proc~setup_hamiltonian -->
<g id="proc~~siesta_forces~~CallsGraph_edge6" class="edge"><title>proc~siesta_forces&#45;&gt;proc~setup_hamiltonian</title>
<path fill="none" stroke="#000000" d="M39.4395,-1904.04C43.0337,-2001.26 68.5661,-2668 112,-3208 128.969,-3418.97 159.394,-3673.32 168.712,-3749.43"/>
<polygon fill="#000000" stroke="#000000" points="165.282,-3750.22 169.975,-3759.72 172.23,-3749.37 165.282,-3750.22"/>
</g>
<!-- post_scf_work -->
<g id="proc~~siesta_forces~~CallsGraph_node17" class="node"><title>post_scf_work</title>
<polygon fill="#777777" stroke="#777777" points="213,-1534 132,-1534 132,-1510 213,-1510 213,-1534"/>
<text text-anchor="middle" x="172.5" y="-1519.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">post_scf_work</text>
</g>
<!-- proc~siesta_forces&#45;&gt;post_scf_work -->
<g id="proc~~siesta_forces~~CallsGraph_edge15" class="edge"><title>proc~siesta_forces&#45;&gt;post_scf_work</title>
<path fill="none" stroke="#000000" d="M39.9654,-1879.82C44.5991,-1824.27 66.2431,-1595.29 112,-1543 115.044,-1539.52 118.702,-1536.62 122.688,-1534.2"/>
<polygon fill="#000000" stroke="#000000" points="124.45,-1537.23 131.828,-1529.63 121.319,-1530.97 124.45,-1537.23"/>
</g>
<!-- check_walltime -->
<g id="proc~~siesta_forces~~CallsGraph_node18" class="node"><title>check_walltime</title>
<polygon fill="#777777" stroke="#777777" points="215,-1492 130,-1492 130,-1468 215,-1468 215,-1492"/>
<text text-anchor="middle" x="172.5" y="-1477.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_walltime</text>
</g>
<!-- proc~siesta_forces&#45;&gt;check_walltime -->
<g id="proc~~siesta_forces~~CallsGraph_edge16" class="edge"><title>proc~siesta_forces&#45;&gt;check_walltime</title>
<path fill="none" stroke="#000000" d="M39.6586,-1879.99C43.1332,-1820.77 61.1399,-1560.41 112,-1501 114.61,-1497.95 117.692,-1495.34 121.057,-1493.12"/>
<polygon fill="#000000" stroke="#000000" points="122.777,-1496.17 129.898,-1488.32 119.439,-1490.01 122.777,-1496.17"/>
</g>
<!-- barrier -->
<g id="proc~~siesta_forces~~CallsGraph_node19" class="node"><title>barrier</title>
<polygon fill="#777777" stroke="#777777" points="199.5,-1450 145.5,-1450 145.5,-1426 199.5,-1426 199.5,-1450"/>
<text text-anchor="middle" x="172.5" y="-1435.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">barrier</text>
</g>
<!-- proc~siesta_forces&#45;&gt;barrier -->
<g id="proc~~siesta_forces~~CallsGraph_edge17" class="edge"><title>proc~siesta_forces&#45;&gt;barrier</title>
<path fill="none" stroke="#000000" d="M39.4213,-1879.98C41.859,-1817.01 56.0619,-1525.51 112,-1459 117.994,-1451.87 126.568,-1447.16 135.347,-1444.05"/>
<polygon fill="#000000" stroke="#000000" points="136.6,-1447.33 145.221,-1441.17 134.641,-1440.61 136.6,-1447.33"/>
</g>
<!-- proc~compute_dm -->
<g id="proc~~siesta_forces~~CallsGraph_node20" class="node"><title>proc~compute_dm</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node20"><a xlink:href=".././proc/compute_dm.html" xlink:title="compute_dm">
<polygon fill="#d9534f" stroke="#d9534f" points="365.5,-5414 290.5,-5414 290.5,-5390 365.5,-5390 365.5,-5414"/>
<text text-anchor="middle" x="328" y="-5399.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_dm</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;proc~compute_dm -->
<g id="proc~~siesta_forces~~CallsGraph_edge19" class="edge"><title>proc~siesta_forces&#45;&gt;proc~compute_dm</title>
<path fill="none" stroke="#000000" d="M39.0944,-1904.08C40.73,-2110.43 63.6642,-4893.75 112,-5056 153.218,-5194.36 265.41,-5332.07 309.177,-5382.19"/>
<polygon fill="#000000" stroke="#000000" points="306.588,-5384.54 315.827,-5389.73 311.838,-5379.91 306.588,-5384.54"/>
</g>
<!-- proc~compute_energies -->
<g id="proc~~siesta_forces~~CallsGraph_node21" class="node"><title>proc~compute_energies</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node21"><a xlink:href=".././proc/compute_energies.html" xlink:title="compute_energies">
<polygon fill="#d9534f" stroke="#d9534f" points="378.5,-6036 277.5,-6036 277.5,-6012 378.5,-6012 378.5,-6036"/>
<text text-anchor="middle" x="328" y="-6021.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_energies</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;proc~compute_energies -->
<g id="proc~~siesta_forces~~CallsGraph_edge20" class="edge"><title>proc~siesta_forces&#45;&gt;proc~compute_energies</title>
<path fill="none" stroke="#000000" d="M38.9921,-1904.26C38.8624,-2147.1 38.0415,-5916.04 112,-5998 150.057,-6040.18 218.084,-6041.62 267.447,-6035.73"/>
<polygon fill="#000000" stroke="#000000" points="267.913,-6039.2 277.368,-6034.42 266.995,-6032.26 267.913,-6039.2"/>
</g>
<!-- initwf -->
<g id="proc~~siesta_forces~~CallsGraph_node22" class="node"><title>initwf</title>
<polygon fill="#777777" stroke="#777777" points="199.5,-1408 145.5,-1408 145.5,-1384 199.5,-1384 199.5,-1408"/>
<text text-anchor="middle" x="172.5" y="-1393.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">initwf</text>
</g>
<!-- proc~siesta_forces&#45;&gt;initwf -->
<g id="proc~~siesta_forces~~CallsGraph_edge21" class="edge"><title>proc~siesta_forces&#45;&gt;initwf</title>
<path fill="none" stroke="#000000" d="M39.2306,-1879.72C40.7284,-1812.6 51.0437,-1490.56 112,-1417 118.057,-1409.69 126.831,-1404.92 135.789,-1401.82"/>
<polygon fill="#000000" stroke="#000000" points="136.808,-1405.16 145.461,-1399.05 134.884,-1398.43 136.808,-1405.16"/>
</g>
<!-- reset -->
<g id="proc~~siesta_forces~~CallsGraph_node23" class="node"><title>reset</title>
<polygon fill="#777777" stroke="#777777" points="355,-1346 301,-1346 301,-1322 355,-1322 355,-1346"/>
<text text-anchor="middle" x="328" y="-1331.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reset</text>
</g>
<!-- proc~siesta_forces&#45;&gt;reset -->
<g id="proc~~siesta_forces~~CallsGraph_edge22" class="edge"><title>proc~siesta_forces&#45;&gt;reset</title>
<path fill="none" stroke="#000000" d="M38.4839,-1879.87C37.3919,-1838.05 39.5573,-1698.35 112,-1623 151.067,-1582.37 196.22,-1627.71 233,-1585 300.512,-1506.59 203.193,-1434.84 269,-1355 274.63,-1348.17 282.671,-1343.56 290.979,-1340.45"/>
<polygon fill="#000000" stroke="#000000" points="292.201,-1343.74 300.726,-1337.45 290.139,-1337.05 292.201,-1343.74"/>
</g>
<!-- mixer -->
<g id="proc~~siesta_forces~~CallsGraph_node24" class="node"><title>mixer</title>
<polygon fill="#777777" stroke="#777777" points="199.5,-1366 145.5,-1366 145.5,-1342 199.5,-1342 199.5,-1366"/>
<text text-anchor="middle" x="172.5" y="-1351.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mixer</text>
</g>
<!-- proc~siesta_forces&#45;&gt;mixer -->
<g id="proc~~siesta_forces~~CallsGraph_edge27" class="edge"><title>proc~siesta_forces&#45;&gt;mixer</title>
<path fill="none" stroke="#000000" d="M39.0629,-1879.58C39.664,-1808.7 45.9758,-1455.67 112,-1375 118.012,-1367.65 126.772,-1362.88 135.73,-1359.77"/>
<polygon fill="#000000" stroke="#000000" points="136.751,-1363.12 145.408,-1357.01 134.831,-1356.38 136.751,-1363.12"/>
</g>
<!-- proc~mix_rhog -->
<g id="proc~~siesta_forces~~CallsGraph_node25" class="node"><title>proc~mix_rhog</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node25"><a xlink:href=".././proc/mix_rhog.html" xlink:title="mix_rhog">
<polygon fill="#d9534f" stroke="#d9534f" points="356.5,-5918 299.5,-5918 299.5,-5894 356.5,-5894 356.5,-5918"/>
<text text-anchor="middle" x="328" y="-5903.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mix_rhog</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;proc~mix_rhog -->
<g id="proc~~siesta_forces~~CallsGraph_edge23" class="edge"><title>proc~siesta_forces&#45;&gt;proc~mix_rhog</title>
<path fill="none" stroke="#000000" d="M38.9893,-1904.27C38.8201,-2132.76 37.6153,-5478.56 112,-5667 151.547,-5767.19 253.654,-5852.14 301.523,-5887.9"/>
<polygon fill="#000000" stroke="#000000" points="299.675,-5890.88 309.803,-5893.99 303.825,-5885.25 299.675,-5890.88"/>
</g>
<!-- transiesta -->
<g id="proc~~siesta_forces~~CallsGraph_node26" class="node"><title>transiesta</title>
<polygon fill="#777777" stroke="#777777" points="528,-5876 469,-5876 469,-5852 528,-5852 528,-5876"/>
<text text-anchor="middle" x="498.5" y="-5861.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">transiesta</text>
</g>
<!-- proc~siesta_forces&#45;&gt;transiesta -->
<g id="proc~~siesta_forces~~CallsGraph_edge24" class="edge"><title>proc~siesta_forces&#45;&gt;transiesta</title>
<path fill="none" stroke="#000000" d="M38.9607,-1904.15C38.3376,-2108.92 31.5633,-4838.53 112,-5181 186.327,-5497.46 175.038,-5632.79 423,-5843 433.029,-5851.5 446.275,-5856.57 458.814,-5859.59"/>
<polygon fill="#000000" stroke="#000000" points="458.144,-5863.03 468.642,-5861.6 459.546,-5856.17 458.144,-5863.03"/>
</g>
<!-- die -->
<g id="proc~~siesta_forces~~CallsGraph_node27" class="node"><title>die</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-24 471.5,-24 471.5,-0 525.5,-0 525.5,-24"/>
<text text-anchor="middle" x="498.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">die</text>
</g>
<!-- proc~siesta_forces&#45;&gt;die -->
<g id="proc~~siesta_forces~~CallsGraph_edge25" class="edge"><title>proc~siesta_forces&#45;&gt;die</title>
<path fill="none" stroke="#000000" d="M50.2374,-1879.64C63.6692,-1865.54 87.4293,-1842.68 112,-1829 161.245,-1801.57 197.144,-1834.49 233,-1791 323.758,-1680.91 176.514,-1580.64 269,-1472 304.3,-1430.53 353.532,-1481.96 387,-1439 483.042,-1315.72 327.085,-156.376 423,-33 432.093,-21.3042 447.17,-15.7873 461.391,-13.2965"/>
<polygon fill="#000000" stroke="#000000" points="462.036,-16.7419 471.497,-11.9725 461.127,-9.8012 462.036,-16.7419"/>
</g>
<!-- timer -->
<g id="proc~~siesta_forces~~CallsGraph_node28" class="node"><title>timer</title>
<polygon fill="#777777" stroke="#777777" points="1060.5,-4152 1006.5,-4152 1006.5,-4128 1060.5,-4128 1060.5,-4152"/>
<text text-anchor="middle" x="1033.5" y="-4137.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">timer</text>
</g>
<!-- proc~siesta_forces&#45;&gt;timer -->
<g id="proc~~siesta_forces~~CallsGraph_edge4" class="edge"><title>proc~siesta_forces&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M38.8516,-1904.11C37.5119,-2023.66 29.3765,-3004.65 112,-3793 141.356,-4073.1 45.3623,-5042 327,-5042 327,-5042 327,-5042 499.5,-5042 707.493,-5042 819.988,-5135.07 964,-4985 971.357,-4977.33 1021.22,-4295.38 1030.88,-4162.35"/>
<polygon fill="#000000" stroke="#000000" points="1034.39,-4162.38 1031.62,-4152.15 1027.41,-4161.87 1034.39,-4162.38"/>
</g>
<!-- proc~state_init&#45;&gt;fdf_get -->
<g id="proc~~siesta_forces~~CallsGraph_edge38" class="edge"><title>proc~state_init&#45;&gt;fdf_get</title>
<path fill="none" stroke="#000000" d="M329.678,-1548.3C335.116,-1647.57 371.85,-2328.46 387,-2882 388.173,-2924.86 396.92,-5934.97 423,-5969 432.011,-5980.76 447.077,-5986.28 461.311,-5988.76"/>
<polygon fill="#000000" stroke="#000000" points="461.064,-5992.26 471.431,-5990.08 461.965,-5985.32 461.064,-5992.26"/>
</g>
<!-- proc~state_init&#45;&gt;proc~bye -->
<g id="proc~~siesta_forces~~CallsGraph_edge76" class="edge"><title>proc~state_init&#45;&gt;proc~bye</title>
<path fill="none" stroke="#000000" d="M329.524,-1548.04C336.521,-1708.66 411.426,-3422.5 423,-3445 432.021,-3462.54 448.862,-3476.56 464.252,-3486.53"/>
<polygon fill="#000000" stroke="#000000" points="462.719,-3489.69 473.076,-3491.93 466.371,-3483.72 462.719,-3489.69"/>
</g>
<!-- proc~state_init&#45;&gt;timer -->
<g id="proc~~siesta_forces~~CallsGraph_edge81" class="edge"><title>proc~state_init&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M329.528,-1548.08C333.804,-1643.27 364.116,-2270.27 423,-2327 498.143,-2399.39 552.658,-2346 657,-2346 657,-2346 657,-2346 793,-2346 980.827,-2346 1026.72,-3910.97 1031.96,-4117.58"/>
<polygon fill="#000000" stroke="#000000" points="1028.46,-4117.68 1032.21,-4127.59 1035.46,-4117.5 1028.46,-4117.68"/>
</g>
<!-- volcel -->
<g id="proc~~siesta_forces~~CallsGraph_node29" class="node"><title>volcel</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-2852 471.5,-2852 471.5,-2828 525.5,-2828 525.5,-2852"/>
<text text-anchor="middle" x="498.5" y="-2837.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">volcel</text>
</g>
<!-- proc~state_init&#45;&gt;volcel -->
<g id="proc~~siesta_forces~~CallsGraph_edge28" class="edge"><title>proc~state_init&#45;&gt;volcel</title>
<path fill="none" stroke="#000000" d="M329.056,-1548.01C329.738,-1671.9 337.997,-2714.87 423,-2819 432.3,-2830.39 447.263,-2835.88 461.348,-2838.43"/>
<polygon fill="#000000" stroke="#000000" points="460.971,-2841.92 471.356,-2839.82 461.928,-2834.98 460.971,-2841.92"/>
</g>
<!-- mscell -->
<g id="proc~~siesta_forces~~CallsGraph_node30" class="node"><title>mscell</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-528 471.5,-528 471.5,-504 525.5,-504 525.5,-528"/>
<text text-anchor="middle" x="498.5" y="-513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mscell</text>
</g>
<!-- proc~state_init&#45;&gt;mscell -->
<g id="proc~~siesta_forces~~CallsGraph_edge30" class="edge"><title>proc~state_init&#45;&gt;mscell</title>
<path fill="none" stroke="#000000" d="M355.646,-1530.7C367.265,-1526.95 379.845,-1520.61 387,-1510 447.475,-1420.3 356.115,-622.031 423,-537 432.092,-525.441 447.025,-519.927 461.144,-517.402"/>
<polygon fill="#000000" stroke="#000000" points="461.743,-520.853 471.186,-516.048 460.808,-513.916 461.743,-520.853"/>
</g>
<!-- re_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_node32" class="node"><title>re_alloc</title>
<polygon fill="#777777" stroke="#777777" points="1060.5,-4639 1006.5,-4639 1006.5,-4615 1060.5,-4615 1060.5,-4639"/>
<text text-anchor="middle" x="1033.5" y="-4624.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">re_alloc</text>
</g>
<!-- proc~state_init&#45;&gt;re_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge32" class="edge"><title>proc~state_init&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M329.567,-1548.17C334.204,-1645.46 367.138,-2294.78 423,-2359 468.489,-2411.3 525.115,-2348.86 574,-2398 823.435,-2648.73 902.929,-3592.64 964,-3941 1009.3,-4199.37 1027.24,-4518.13 1031.47,-4604.52"/>
<polygon fill="#000000" stroke="#000000" points="1027.98,-4604.9 1031.95,-4614.73 1034.97,-4604.57 1027.98,-4604.9"/>
</g>
<!-- newddata2d -->
<g id="proc~~siesta_forces~~CallsGraph_node33" class="node"><title>newddata2d</title>
<polygon fill="#777777" stroke="#777777" points="534,-486 463,-486 463,-462 534,-462 534,-486"/>
<text text-anchor="middle" x="498.5" y="-471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">newddata2d</text>
</g>
<!-- proc~state_init&#45;&gt;newddata2d -->
<g id="proc~~siesta_forces~~CallsGraph_edge33" class="edge"><title>proc~state_init&#45;&gt;newddata2d</title>
<path fill="none" stroke="#000000" d="M355.653,-1530.7C367.274,-1526.95 379.853,-1520.62 387,-1510 450.011,-1416.38 353.299,-583.75 423,-495 430.318,-485.682 441.433,-480.291 452.861,-477.228"/>
<polygon fill="#000000" stroke="#000000" points="453.843,-480.598 462.897,-475.095 452.388,-473.75 453.843,-480.598"/>
</g>
<!-- superc -->
<g id="proc~~siesta_forces~~CallsGraph_node34" class="node"><title>superc</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-444 471.5,-444 471.5,-420 525.5,-420 525.5,-444"/>
<text text-anchor="middle" x="498.5" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">superc</text>
</g>
<!-- proc~state_init&#45;&gt;superc -->
<g id="proc~~siesta_forces~~CallsGraph_edge49" class="edge"><title>proc~state_init&#45;&gt;superc</title>
<path fill="none" stroke="#000000" d="M355.66,-1530.71C367.282,-1526.96 379.86,-1520.62 387,-1510 452.546,-1412.47 350.484,-545.469 423,-453 432.075,-441.428 447.006,-435.912 461.127,-433.389"/>
<polygon fill="#000000" stroke="#000000" points="461.728,-436.84 471.172,-432.037 460.794,-429.902 461.728,-436.84"/>
</g>
<!-- ioxv -->
<g id="proc~~siesta_forces~~CallsGraph_node39" class="node"><title>ioxv</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-402 471.5,-402 471.5,-378 525.5,-378 525.5,-402"/>
<text text-anchor="middle" x="498.5" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ioxv</text>
</g>
<!-- proc~state_init&#45;&gt;ioxv -->
<g id="proc~~siesta_forces~~CallsGraph_edge58" class="edge"><title>proc~state_init&#45;&gt;ioxv</title>
<path fill="none" stroke="#000000" d="M355.666,-1530.71C367.29,-1526.96 379.867,-1520.63 387,-1510 455.082,-1408.55 347.668,-507.188 423,-411 432.068,-399.422 446.997,-393.905 461.12,-391.383"/>
<polygon fill="#000000" stroke="#000000" points="461.721,-394.834 471.166,-390.032 460.788,-387.896 461.721,-394.834"/>
</g>
<!-- setup_ts_kpoint_scf -->
<g id="proc~~siesta_forces~~CallsGraph_node40" class="node"><title>setup_ts_kpoint_scf</title>
<polygon fill="#777777" stroke="#777777" points="552,-360 445,-360 445,-336 552,-336 552,-360"/>
<text text-anchor="middle" x="498.5" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_ts_kpoint_scf</text>
</g>
<!-- proc~state_init&#45;&gt;setup_ts_kpoint_scf -->
<g id="proc~~siesta_forces~~CallsGraph_edge59" class="edge"><title>proc~state_init&#45;&gt;setup_ts_kpoint_scf</title>
<path fill="none" stroke="#000000" d="M355.672,-1530.72C367.297,-1526.97 379.873,-1520.63 387,-1510 457.618,-1404.64 344.852,-468.908 423,-369 426.467,-364.568 430.793,-361.024 435.604,-358.196"/>
<polygon fill="#000000" stroke="#000000" points="437.197,-361.314 444.708,-353.841 434.177,-354.999 437.197,-361.314"/>
</g>
<!-- setup_ordern_indexes -->
<g id="proc~~siesta_forces~~CallsGraph_node42" class="node"><title>setup_ordern_indexes</title>
<polygon fill="#777777" stroke="#777777" points="558,-318 439,-318 439,-294 558,-294 558,-318"/>
<text text-anchor="middle" x="498.5" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_ordern_indexes</text>
</g>
<!-- proc~state_init&#45;&gt;setup_ordern_indexes -->
<g id="proc~~siesta_forces~~CallsGraph_edge62" class="edge"><title>proc~state_init&#45;&gt;setup_ordern_indexes</title>
<path fill="none" stroke="#000000" d="M355.677,-1530.72C367.303,-1526.97 379.879,-1520.64 387,-1510 460.153,-1400.72 342.036,-430.627 423,-327 425.11,-324.3 427.538,-321.929 430.201,-319.849"/>
<polygon fill="#000000" stroke="#000000" points="432.203,-322.725 438.809,-314.442 428.48,-316.797 432.203,-322.725"/>
</g>
<!-- setup_dmhs_netcdf_file -->
<g id="proc~~siesta_forces~~CallsGraph_node43" class="node"><title>setup_dmhs_netcdf_file</title>
<polygon fill="#777777" stroke="#777777" points="561.5,-276 435.5,-276 435.5,-252 561.5,-252 561.5,-276"/>
<text text-anchor="middle" x="498.5" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_dmhs_netcdf_file</text>
</g>
<!-- proc~state_init&#45;&gt;setup_dmhs_netcdf_file -->
<g id="proc~~siesta_forces~~CallsGraph_edge40" class="edge"><title>proc~state_init&#45;&gt;setup_dmhs_netcdf_file</title>
<path fill="none" stroke="#000000" d="M355.682,-1530.72C367.309,-1526.98 379.885,-1520.64 387,-1510 462.689,-1396.8 339.22,-392.346 423,-285 424.271,-283.371 425.658,-281.862 427.143,-280.465"/>
<polygon fill="#000000" stroke="#000000" points="429.384,-283.16 435.294,-274.366 425.19,-277.555 429.384,-283.16"/>
</g>
<!-- new_dm -->
<g id="proc~~siesta_forces~~CallsGraph_node45" class="node"><title>new_dm</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-234 471.5,-234 471.5,-210 525.5,-210 525.5,-234"/>
<text text-anchor="middle" x="498.5" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">new_dm</text>
</g>
<!-- proc~state_init&#45;&gt;new_dm -->
<g id="proc~~siesta_forces~~CallsGraph_edge66" class="edge"><title>proc~state_init&#45;&gt;new_dm</title>
<path fill="none" stroke="#000000" d="M355.687,-1530.73C367.315,-1526.98 379.89,-1520.64 387,-1510 465.225,-1392.89 336.405,-354.066 423,-243 432.042,-231.402 446.969,-225.883 461.095,-223.364"/>
<polygon fill="#000000" stroke="#000000" points="461.699,-226.814 471.145,-222.016 460.769,-219.877 461.699,-226.814"/>
</g>
<!-- exact_sc_ag -->
<g id="proc~~siesta_forces~~CallsGraph_node47" class="node"><title>exact_sc_ag</title>
<polygon fill="#777777" stroke="#777777" points="535,-192 462,-192 462,-168 535,-168 535,-192"/>
<text text-anchor="middle" x="498.5" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">exact_sc_ag</text>
</g>
<!-- proc~state_init&#45;&gt;exact_sc_ag -->
<g id="proc~~siesta_forces~~CallsGraph_edge29" class="edge"><title>proc~state_init&#45;&gt;exact_sc_ag</title>
<path fill="none" stroke="#000000" d="M355.691,-1530.73C367.32,-1526.98 379.895,-1520.65 387,-1510 467.761,-1388.97 333.588,-315.785 423,-201 430.09,-191.899 440.803,-186.54 451.912,-183.437"/>
<polygon fill="#000000" stroke="#000000" points="452.697,-186.848 461.695,-181.254 451.172,-180.016 452.697,-186.848"/>
</g>
<!-- cmladdproperty -->
<g id="proc~~siesta_forces~~CallsGraph_node49" class="node"><title>cmladdproperty</title>
<polygon fill="#777777" stroke="#777777" points="542,-2474 455,-2474 455,-2450 542,-2450 542,-2474"/>
<text text-anchor="middle" x="498.5" y="-2459.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cmladdproperty</text>
</g>
<!-- proc~state_init&#45;&gt;cmladdproperty -->
<g id="proc~~siesta_forces~~CallsGraph_edge75" class="edge"><title>proc~state_init&#45;&gt;cmladdproperty</title>
<path fill="none" stroke="#000000" d="M329.495,-1548.28C333.728,-1650.81 365.109,-2362.86 423,-2436 428.807,-2443.34 436.817,-2448.61 445.443,-2452.4"/>
<polygon fill="#000000" stroke="#000000" points="444.376,-2455.73 454.969,-2455.95 446.824,-2449.18 444.376,-2455.73"/>
</g>
<!-- sporb_to_spatom -->
<g id="proc~~siesta_forces~~CallsGraph_node54" class="node"><title>sporb_to_spatom</title>
<polygon fill="#777777" stroke="#777777" points="546.5,-150 450.5,-150 450.5,-126 546.5,-126 546.5,-150"/>
<text text-anchor="middle" x="498.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sporb_to_spatom</text>
</g>
<!-- proc~state_init&#45;&gt;sporb_to_spatom -->
<g id="proc~~siesta_forces~~CallsGraph_edge79" class="edge"><title>proc~state_init&#45;&gt;sporb_to_spatom</title>
<path fill="none" stroke="#000000" d="M355.695,-1530.73C367.325,-1526.99 379.9,-1520.65 387,-1510 470.297,-1385.06 330.772,-277.505 423,-159 427.653,-153.022 433.869,-148.658 440.735,-145.487"/>
<polygon fill="#000000" stroke="#000000" points="442.276,-148.648 450.414,-141.864 439.822,-142.092 442.276,-148.648"/>
</g>
<!-- newzspdata2d -->
<g id="proc~~siesta_forces~~CallsGraph_node55" class="node"><title>newzspdata2d</title>
<polygon fill="#777777" stroke="#777777" points="539.5,-108 457.5,-108 457.5,-84 539.5,-84 539.5,-108"/>
<text text-anchor="middle" x="498.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">newzspdata2d</text>
</g>
<!-- proc~state_init&#45;&gt;newzspdata2d -->
<g id="proc~~siesta_forces~~CallsGraph_edge82" class="edge"><title>proc~state_init&#45;&gt;newzspdata2d</title>
<path fill="none" stroke="#000000" d="M355.699,-1530.74C367.33,-1526.99 379.904,-1520.65 387,-1510 472.833,-1381.14 327.956,-239.225 423,-117 429.187,-109.044 438.143,-103.947 447.715,-100.717"/>
<polygon fill="#000000" stroke="#000000" points="448.685,-104.08 457.412,-98.0727 446.843,-97.327 448.685,-104.08"/>
</g>
<!-- siesta_write_positions -->
<g id="proc~~siesta_forces~~CallsGraph_node56" class="node"><title>siesta_write_positions</title>
<polygon fill="#777777" stroke="#777777" points="557,-2318 440,-2318 440,-2294 557,-2294 557,-2318"/>
<text text-anchor="middle" x="498.5" y="-2303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_write_positions</text>
</g>
<!-- proc~state_init&#45;&gt;siesta_write_positions -->
<g id="proc~~siesta_forces~~CallsGraph_edge83" class="edge"><title>proc~state_init&#45;&gt;siesta_write_positions</title>
<path fill="none" stroke="#000000" d="M328.762,-1548.22C327.303,-1635.83 322.679,-2168.39 423,-2285 425.35,-2287.73 428.025,-2290.12 430.931,-2292.21"/>
<polygon fill="#000000" stroke="#000000" points="429.26,-2295.29 439.654,-2297.34 432.807,-2289.25 429.26,-2295.29"/>
</g>
<!-- write_debug -->
<g id="proc~~siesta_forces~~CallsGraph_node58" class="node"><title>write_debug</title>
<polygon fill="#777777" stroke="#777777" points="956.5,-4344 885.5,-4344 885.5,-4320 956.5,-4320 956.5,-4344"/>
<text text-anchor="middle" x="921" y="-4329.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_debug</text>
</g>
<!-- proc~state_init&#45;&gt;write_debug -->
<g id="proc~~siesta_forces~~CallsGraph_edge87" class="edge"><title>proc~state_init&#45;&gt;write_debug</title>
<path fill="none" stroke="#000000" d="M329.512,-1548.1C333.829,-1647.65 365.41,-2329.77 423,-2398 468.006,-2451.33 530.383,-2386.53 574,-2441 661.653,-2550.46 536.25,-2951.73 610,-3071 635.861,-3112.82 679.951,-3084.29 706,-3126 770.181,-3228.76 721.551,-3550.58 742,-3670 769.811,-3832.41 799.363,-3867.84 842,-4027 870.329,-4132.75 902.078,-4259.74 914.553,-4309.99"/>
<polygon fill="#000000" stroke="#000000" points="911.175,-4310.91 916.979,-4319.77 917.969,-4309.22 911.175,-4310.91"/>
</g>
<!-- domaindecom -->
<g id="proc~~siesta_forces~~CallsGraph_node61" class="node"><title>domaindecom</title>
<polygon fill="#777777" stroke="#777777" points="538.5,-2276 458.5,-2276 458.5,-2252 538.5,-2252 538.5,-2276"/>
<text text-anchor="middle" x="498.5" y="-2261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">domaindecom</text>
</g>
<!-- proc~state_init&#45;&gt;domaindecom -->
<g id="proc~~siesta_forces~~CallsGraph_edge92" class="edge"><title>proc~state_init&#45;&gt;domaindecom</title>
<path fill="none" stroke="#000000" d="M328.863,-1548.07C328.154,-1632.41 328.014,-2133.41 423,-2243 429.667,-2250.69 438.911,-2255.67 448.624,-2258.87"/>
<polygon fill="#000000" stroke="#000000" points="447.849,-2262.28 458.415,-2261.51 449.67,-2255.53 447.849,-2262.28"/>
</g>
<!-- globalize_or -->
<g id="proc~~siesta_forces~~CallsGraph_node65" class="node"><title>globalize_or</title>
<polygon fill="#777777" stroke="#777777" points="533.5,-2234 463.5,-2234 463.5,-2210 533.5,-2210 533.5,-2234"/>
<text text-anchor="middle" x="498.5" y="-2219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">globalize_or</text>
</g>
<!-- proc~state_init&#45;&gt;globalize_or -->
<g id="proc~~siesta_forces~~CallsGraph_edge36" class="edge"><title>proc~state_init&#45;&gt;globalize_or</title>
<path fill="none" stroke="#000000" d="M328.975,-1548.13C329.051,-1629.74 333.419,-2098.5 423,-2201 430.797,-2209.92 442.061,-2215.19 453.478,-2218.26"/>
<polygon fill="#000000" stroke="#000000" points="452.953,-2221.73 463.468,-2220.43 454.44,-2214.89 452.953,-2221.73"/>
</g>
<!-- crtsparsity_sc -->
<g id="proc~~siesta_forces~~CallsGraph_node68" class="node"><title>crtsparsity_sc</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-2192 459.5,-2192 459.5,-2168 537.5,-2168 537.5,-2192"/>
<text text-anchor="middle" x="498.5" y="-2177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">crtsparsity_sc</text>
</g>
<!-- proc~state_init&#45;&gt;crtsparsity_sc -->
<g id="proc~~siesta_forces~~CallsGraph_edge45" class="edge"><title>proc~state_init&#45;&gt;crtsparsity_sc</title>
<path fill="none" stroke="#000000" d="M329.101,-1548.12C330.002,-1626.68 338.786,-2063.54 423,-2159 429.868,-2166.78 439.374,-2171.78 449.302,-2174.97"/>
<polygon fill="#000000" stroke="#000000" points="448.727,-2178.44 459.288,-2177.59 450.502,-2171.66 448.727,-2178.44"/>
</g>
<!-- proximity_check -->
<g id="proc~~siesta_forces~~CallsGraph_node69" class="node"><title>proximity_check</title>
<polygon fill="#777777" stroke="#777777" points="543,-2150 454,-2150 454,-2126 543,-2126 543,-2150"/>
<text text-anchor="middle" x="498.5" y="-2135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">proximity_check</text>
</g>
<!-- proc~state_init&#45;&gt;proximity_check -->
<g id="proc~~siesta_forces~~CallsGraph_edge47" class="edge"><title>proc~state_init&#45;&gt;proximity_check</title>
<path fill="none" stroke="#000000" d="M329.244,-1548.03C331.008,-1623.24 344.114,-2028.54 423,-2117 428.721,-2123.42 436.235,-2127.94 444.288,-2131.11"/>
<polygon fill="#000000" stroke="#000000" points="443.322,-2134.47 453.914,-2134.25 445.491,-2127.82 443.322,-2134.47"/>
</g>
<!-- overlap -->
<g id="proc~~siesta_forces~~CallsGraph_node70" class="node"><title>overlap</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-2108 471.5,-2108 471.5,-2084 525.5,-2084 525.5,-2108"/>
<text text-anchor="middle" x="498.5" y="-2093.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">overlap</text>
</g>
<!-- proc~state_init&#45;&gt;overlap -->
<g id="proc~~siesta_forces~~CallsGraph_edge86" class="edge"><title>proc~state_init&#45;&gt;overlap</title>
<path fill="none" stroke="#000000" d="M329.411,-1548.09C332.104,-1620.23 349.481,-1993.56 423,-2075 432.687,-2085.73 447.389,-2091.15 461.18,-2093.83"/>
<polygon fill="#000000" stroke="#000000" points="461.039,-2097.35 471.45,-2095.39 462.087,-2090.43 461.039,-2097.35"/>
</g>
<!-- cmlendpropertylist -->
<g id="proc~~siesta_forces~~CallsGraph_node71" class="node"><title>cmlendpropertylist</title>
<polygon fill="#777777" stroke="#777777" points="548.5,-2066 448.5,-2066 448.5,-2042 548.5,-2042 548.5,-2066"/>
<text text-anchor="middle" x="498.5" y="-2051.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cmlendpropertylist</text>
</g>
<!-- proc~state_init&#45;&gt;cmlendpropertylist -->
<g id="proc~~siesta_forces~~CallsGraph_edge51" class="edge"><title>proc~state_init&#45;&gt;cmlendpropertylist</title>
<path fill="none" stroke="#000000" d="M329.601,-1548.03C333.27,-1616.7 354.795,-1958.53 423,-2033 427.407,-2037.81 432.824,-2041.55 438.707,-2044.46"/>
<polygon fill="#000000" stroke="#000000" points="437.679,-2047.82 448.26,-2048.37 440.331,-2041.34 437.679,-2047.82"/>
</g>
<!-- newdspdata1d -->
<g id="proc~~siesta_forces~~CallsGraph_node72" class="node"><title>newdspdata1d</title>
<polygon fill="#777777" stroke="#777777" points="539.5,-2024 457.5,-2024 457.5,-2000 539.5,-2000 539.5,-2024"/>
<text text-anchor="middle" x="498.5" y="-2009.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">newdspdata1d</text>
</g>
<!-- proc~state_init&#45;&gt;newdspdata1d -->
<g id="proc~~siesta_forces~~CallsGraph_edge52" class="edge"><title>proc~state_init&#45;&gt;newdspdata1d</title>
<path fill="none" stroke="#000000" d="M329.847,-1548.29C334.616,-1614.02 360.191,-1923.56 423,-1991 429.594,-1998.08 438.37,-2002.84 447.581,-2006.02"/>
<polygon fill="#000000" stroke="#000000" points="446.686,-2009.41 457.264,-2008.8 448.617,-2002.68 446.686,-2009.41"/>
</g>
<!-- newsparsity -->
<g id="proc~~siesta_forces~~CallsGraph_node73" class="node"><title>newsparsity</title>
<polygon fill="#777777" stroke="#777777" points="533,-1982 464,-1982 464,-1958 533,-1958 533,-1982"/>
<text text-anchor="middle" x="498.5" y="-1967.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">newsparsity</text>
</g>
<!-- proc~state_init&#45;&gt;newsparsity -->
<g id="proc~~siesta_forces~~CallsGraph_edge41" class="edge"><title>proc~state_init&#45;&gt;newsparsity</title>
<path fill="none" stroke="#000000" d="M330.132,-1548.37C336.065,-1610.56 365.506,-1888.5 423,-1949 431.162,-1957.59 442.539,-1962.75 453.949,-1965.83"/>
<polygon fill="#000000" stroke="#000000" points="453.384,-1969.29 463.904,-1968.03 454.896,-1962.46 453.384,-1969.29"/>
</g>
<!-- kpoint_nullify -->
<g id="proc~~siesta_forces~~CallsGraph_node77" class="node"><title>kpoint_nullify</title>
<polygon fill="#777777" stroke="#777777" points="535.5,-1940 461.5,-1940 461.5,-1916 535.5,-1916 535.5,-1940"/>
<text text-anchor="middle" x="498.5" y="-1925.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">kpoint_nullify</text>
</g>
<!-- proc~state_init&#45;&gt;kpoint_nullify -->
<g id="proc~~siesta_forces~~CallsGraph_edge84" class="edge"><title>proc~state_init&#45;&gt;kpoint_nullify</title>
<path fill="none" stroke="#000000" d="M330.459,-1548.26C337.61,-1606.35 370.735,-1853.33 423,-1907 430.602,-1914.81 440.862,-1919.77 451.334,-1922.92"/>
<polygon fill="#000000" stroke="#000000" points="450.811,-1926.4 461.36,-1925.41 452.498,-1919.6 450.811,-1926.4"/>
</g>
<!-- hsparse -->
<g id="proc~~siesta_forces~~CallsGraph_node79" class="node"><title>hsparse</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-1898 471.5,-1898 471.5,-1874 525.5,-1874 525.5,-1898"/>
<text text-anchor="middle" x="498.5" y="-1883.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hsparse</text>
</g>
<!-- proc~state_init&#45;&gt;hsparse -->
<g id="proc~~siesta_forces~~CallsGraph_edge74" class="edge"><title>proc~state_init&#45;&gt;hsparse</title>
<path fill="none" stroke="#000000" d="M328.562,-1548.22C327.542,-1596.08 330.426,-1772.75 423,-1865 433.089,-1875.05 447.593,-1880.38 461.128,-1883.17"/>
<polygon fill="#000000" stroke="#000000" points="460.76,-1886.66 471.199,-1884.85 461.91,-1879.76 460.76,-1886.66"/>
</g>
<!-- outcoor -->
<g id="proc~~siesta_forces~~CallsGraph_node82" class="node"><title>outcoor</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-1856 471.5,-1856 471.5,-1832 525.5,-1832 525.5,-1856"/>
<text text-anchor="middle" x="498.5" y="-1841.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">outcoor</text>
</g>
<!-- proc~state_init&#45;&gt;outcoor -->
<g id="proc~~siesta_forces~~CallsGraph_edge78" class="edge"><title>proc~state_init&#45;&gt;outcoor</title>
<path fill="none" stroke="#000000" d="M329.154,-1548.17C330.392,-1592.09 340.697,-1744.06 423,-1823 433.279,-1832.86 447.816,-1838.15 461.324,-1840.97"/>
<polygon fill="#000000" stroke="#000000" points="460.919,-1844.46 471.365,-1842.68 462.094,-1837.55 460.919,-1844.46"/>
</g>
<!-- cmlstartpropertylist -->
<g id="proc~~siesta_forces~~CallsGraph_node83" class="node"><title>cmlstartpropertylist</title>
<polygon fill="#777777" stroke="#777777" points="550,-1814 447,-1814 447,-1790 550,-1790 550,-1814"/>
<text text-anchor="middle" x="498.5" y="-1799.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cmlstartpropertylist</text>
</g>
<!-- proc~state_init&#45;&gt;cmlstartpropertylist -->
<g id="proc~~siesta_forces~~CallsGraph_edge88" class="edge"><title>proc~state_init&#45;&gt;cmlstartpropertylist</title>
<path fill="none" stroke="#000000" d="M329.918,-1548.04C333.601,-1587.64 350.809,-1715.14 423,-1781 427.219,-1784.85 432.091,-1788 437.282,-1790.58"/>
<polygon fill="#000000" stroke="#000000" points="436.324,-1793.97 446.899,-1794.62 439.039,-1787.52 436.324,-1793.97"/>
</g>
<!-- isc_off -->
<g id="proc~~siesta_forces~~CallsGraph_node84" class="node"><title>isc_off</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-1772 471.5,-1772 471.5,-1748 525.5,-1748 525.5,-1772"/>
<text text-anchor="middle" x="498.5" y="-1757.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">isc_off</text>
</g>
<!-- proc~state_init&#45;&gt;isc_off -->
<g id="proc~~siesta_forces~~CallsGraph_edge91" class="edge"><title>proc~state_init&#45;&gt;isc_off</title>
<path fill="none" stroke="#000000" d="M331.002,-1548.18C337.441,-1583.38 360.933,-1686.09 423,-1739 433.757,-1748.17 448.252,-1753.35 461.597,-1756.27"/>
<polygon fill="#000000" stroke="#000000" points="461.028,-1759.72 471.497,-1758.09 462.295,-1752.84 461.028,-1759.72"/>
</g>
<!-- setup_dm_netcdf_file -->
<g id="proc~~siesta_forces~~CallsGraph_node86" class="node"><title>setup_dm_netcdf_file</title>
<polygon fill="#777777" stroke="#777777" points="556,-1730 441,-1730 441,-1706 556,-1706 556,-1730"/>
<text text-anchor="middle" x="498.5" y="-1715.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_dm_netcdf_file</text>
</g>
<!-- proc~state_init&#45;&gt;setup_dm_netcdf_file -->
<g id="proc~~siesta_forces~~CallsGraph_edge55" class="edge"><title>proc~state_init&#45;&gt;setup_dm_netcdf_file</title>
<path fill="none" stroke="#000000" d="M332.596,-1548.23C342.094,-1578.35 370.779,-1656.59 423,-1697 425.657,-1699.06 428.506,-1700.91 431.483,-1702.58"/>
<polygon fill="#000000" stroke="#000000" points="430.214,-1705.86 440.738,-1707.08 433.272,-1699.56 430.214,-1705.86"/>
</g>
<!-- nsc -->
<g id="proc~~siesta_forces~~CallsGraph_node87" class="node"><title>nsc</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-1688 471.5,-1688 471.5,-1664 525.5,-1664 525.5,-1688"/>
<text text-anchor="middle" x="498.5" y="-1673.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nsc</text>
</g>
<!-- proc~state_init&#45;&gt;nsc -->
<g id="proc~~siesta_forces~~CallsGraph_edge34" class="edge"><title>proc~state_init&#45;&gt;nsc</title>
<path fill="none" stroke="#000000" d="M335.896,-1548.17C349.579,-1571.28 382.378,-1621.7 423,-1650 434.441,-1657.97 448.562,-1663.71 461.423,-1667.74"/>
<polygon fill="#000000" stroke="#000000" points="460.814,-1671.21 471.392,-1670.61 462.751,-1664.48 460.814,-1671.21"/>
</g>
<!-- proc~mixers_history_init -->
<g id="proc~~siesta_forces~~CallsGraph_node88" class="node"><title>proc~mixers_history_init</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node88"><a xlink:href=".././proc/mixers_history_init.html" xlink:title="mixers_history_init">
<polygon fill="#d9534f" stroke="#d9534f" points="549,-66 448,-66 448,-42 549,-42 549,-66"/>
<text text-anchor="middle" x="498.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mixers_history_init</text>
</a>
</g>
</g>
<!-- proc~state_init&#45;&gt;proc~mixers_history_init -->
<g id="proc~~siesta_forces~~CallsGraph_edge35" class="edge"><title>proc~state_init&#45;&gt;proc~mixers_history_init</title>
<path fill="none" stroke="#000000" d="M355.703,-1530.74C367.334,-1526.99 379.908,-1520.66 387,-1510 475.369,-1377.22 325.14,-200.944 423,-75 427.058,-69.7772 432.31,-65.7865 438.146,-62.7471"/>
<polygon fill="#000000" stroke="#000000" points="439.856,-65.8244 447.71,-58.7136 437.136,-59.3745 439.856,-65.8244"/>
</g>
<!-- chess_init -->
<g id="proc~~siesta_forces~~CallsGraph_node90" class="node"><title>chess_init</title>
<polygon fill="#777777" stroke="#777777" points="528.5,-1608 468.5,-1608 468.5,-1584 528.5,-1584 528.5,-1608"/>
<text text-anchor="middle" x="498.5" y="-1593.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">chess_init</text>
</g>
<!-- proc~state_init&#45;&gt;chess_init -->
<g id="proc~~siesta_forces~~CallsGraph_edge89" class="edge"><title>proc~state_init&#45;&gt;chess_init</title>
<path fill="none" stroke="#000000" d="M355.713,-1545.75C374.511,-1552.59 400.27,-1561.92 423,-1570 434.581,-1574.12 447.195,-1578.54 458.696,-1582.55"/>
<polygon fill="#000000" stroke="#000000" points="457.867,-1585.97 468.462,-1585.95 460.169,-1579.36 457.867,-1585.97"/>
</g>
<!-- iotdxv -->
<g id="proc~~siesta_forces~~CallsGraph_node91" class="node"><title>iotdxv</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-1528 471.5,-1528 471.5,-1504 525.5,-1504 525.5,-1528"/>
<text text-anchor="middle" x="498.5" y="-1513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iotdxv</text>
</g>
<!-- proc~state_init&#45;&gt;iotdxv -->
<g id="proc~~siesta_forces~~CallsGraph_edge37" class="edge"><title>proc~state_init&#45;&gt;iotdxv</title>
<path fill="none" stroke="#000000" d="M355.699,-1532.83C384.213,-1529.45 429.573,-1524.06 461.29,-1520.3"/>
<polygon fill="#000000" stroke="#000000" points="461.962,-1523.74 471.479,-1519.09 461.136,-1516.79 461.962,-1523.74"/>
</g>
<!-- file_exist -->
<g id="proc~~siesta_forces~~CallsGraph_node92" class="node"><title>file_exist</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-1448 471.5,-1448 471.5,-1424 525.5,-1424 525.5,-1448"/>
<text text-anchor="middle" x="498.5" y="-1433.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">file_exist</text>
</g>
<!-- proc~state_init&#45;&gt;file_exist -->
<g id="proc~~siesta_forces~~CallsGraph_edge43" class="edge"><title>proc~state_init&#45;&gt;file_exist</title>
<path fill="none" stroke="#000000" d="M355.7,-1527.32C366.132,-1523.12 377.777,-1517.37 387,-1510 407.83,-1493.35 401.477,-1477.74 423,-1462 434.255,-1453.77 448.337,-1447.97 461.22,-1443.98"/>
<polygon fill="#000000" stroke="#000000" points="462.549,-1447.24 471.217,-1441.14 460.642,-1440.5 462.549,-1447.24"/>
</g>
<!-- val -->
<g id="proc~~siesta_forces~~CallsGraph_node93" class="node"><title>val</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-3596 471.5,-3596 471.5,-3572 525.5,-3572 525.5,-3596"/>
<text text-anchor="middle" x="498.5" y="-3581.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">val</text>
</g>
<!-- proc~state_init&#45;&gt;val -->
<g id="proc~~siesta_forces~~CallsGraph_edge77" class="edge"><title>proc~state_init&#45;&gt;val</title>
<path fill="none" stroke="#000000" d="M329.5,-1548.04C336.325,-1712.24 410.953,-3501.52 423,-3525 432.004,-3542.55 448.843,-3556.57 464.237,-3566.54"/>
<polygon fill="#000000" stroke="#000000" points="462.706,-3569.7 473.064,-3571.93 466.356,-3563.73 462.706,-3569.7"/>
</g>
<!-- attach -->
<g id="proc~~siesta_forces~~CallsGraph_node95" class="node"><title>attach</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-1406 471.5,-1406 471.5,-1382 525.5,-1382 525.5,-1406"/>
<text text-anchor="middle" x="498.5" y="-1391.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">attach</text>
</g>
<!-- proc~state_init&#45;&gt;attach -->
<g id="proc~~siesta_forces~~CallsGraph_edge50" class="edge"><title>proc~state_init&#45;&gt;attach</title>
<path fill="none" stroke="#000000" d="M355.658,-1529C366.579,-1524.99 378.599,-1518.91 387,-1510 417.969,-1477.14 389.707,-1445.5 423,-1415 433.423,-1405.45 447.858,-1400.2 461.249,-1397.34"/>
<polygon fill="#000000" stroke="#000000" points="461.965,-1400.76 471.201,-1395.57 460.744,-1393.87 461.965,-1400.76"/>
</g>
<!-- sp_to_spglobal -->
<g id="proc~~siesta_forces~~CallsGraph_node96" class="node"><title>sp_to_spglobal</title>
<polygon fill="#777777" stroke="#777777" points="541,-1326 456,-1326 456,-1302 541,-1302 541,-1326"/>
<text text-anchor="middle" x="498.5" y="-1311.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sp_to_spglobal</text>
</g>
<!-- proc~state_init&#45;&gt;sp_to_spglobal -->
<g id="proc~~siesta_forces~~CallsGraph_edge53" class="edge"><title>proc~state_init&#45;&gt;sp_to_spglobal</title>
<path fill="none" stroke="#000000" d="M355.744,-1529.81C366.95,-1525.91 379.169,-1519.7 387,-1510 435.504,-1449.9 371.968,-1397.97 423,-1340 429.249,-1332.9 437.545,-1327.74 446.329,-1323.99"/>
<polygon fill="#000000" stroke="#000000" points="447.799,-1327.18 455.979,-1320.45 445.386,-1320.61 447.799,-1327.18"/>
</g>
<!-- init_val -->
<g id="proc~~siesta_forces~~CallsGraph_node99" class="node"><title>init_val</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-1284 471.5,-1284 471.5,-1260 525.5,-1260 525.5,-1284"/>
<text text-anchor="middle" x="498.5" y="-1269.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_val</text>
</g>
<!-- proc~state_init&#45;&gt;init_val -->
<g id="proc~~siesta_forces~~CallsGraph_edge60" class="edge"><title>proc~state_init&#45;&gt;init_val</title>
<path fill="none" stroke="#000000" d="M355.648,-1530.07C366.976,-1526.21 379.318,-1519.96 387,-1510 446.699,-1432.58 357.789,-1365.84 423,-1293 432.643,-1282.23 447.337,-1276.8 461.135,-1274.13"/>
<polygon fill="#000000" stroke="#000000" points="462.046,-1277.53 471.413,-1272.58 461.003,-1270.61 462.046,-1277.53"/>
</g>
<!-- dict_repopulate_md -->
<g id="proc~~siesta_forces~~CallsGraph_node101" class="node"><title>dict_repopulate_md</title>
<polygon fill="#777777" stroke="#777777" points="552,-1242 445,-1242 445,-1218 552,-1218 552,-1242"/>
<text text-anchor="middle" x="498.5" y="-1227.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dict_repopulate_md</text>
</g>
<!-- proc~state_init&#45;&gt;dict_repopulate_md -->
<g id="proc~~siesta_forces~~CallsGraph_edge63" class="edge"><title>proc~state_init&#45;&gt;dict_repopulate_md</title>
<path fill="none" stroke="#000000" d="M355.77,-1530.16C367.122,-1526.32 379.45,-1520.06 387,-1510 456.753,-1417.04 346.623,-1338.6 423,-1251 426.643,-1246.82 431.046,-1243.45 435.87,-1240.72"/>
<polygon fill="#000000" stroke="#000000" points="437.355,-1243.89 444.934,-1236.49 434.393,-1237.55 437.355,-1243.89"/>
</g>
<!-- kpoint_delete -->
<g id="proc~~siesta_forces~~CallsGraph_node103" class="node"><title>kpoint_delete</title>
<polygon fill="#777777" stroke="#777777" points="536.5,-1200 460.5,-1200 460.5,-1176 536.5,-1176 536.5,-1200"/>
<text text-anchor="middle" x="498.5" y="-1185.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">kpoint_delete</text>
</g>
<!-- proc~state_init&#45;&gt;kpoint_delete -->
<g id="proc~~siesta_forces~~CallsGraph_edge70" class="edge"><title>proc~state_init&#45;&gt;kpoint_delete</title>
<path fill="none" stroke="#000000" d="M355.56,-1530.33C367.013,-1526.51 379.481,-1520.22 387,-1510 466.833,-1401.47 335.429,-1311.39 423,-1209 430.016,-1200.8 439.964,-1195.67 450.314,-1192.51"/>
<polygon fill="#000000" stroke="#000000" points="451.416,-1195.84 460.277,-1190.03 449.728,-1189.04 451.416,-1195.84"/>
</g>
<!-- get_chess_parameter -->
<g id="proc~~siesta_forces~~CallsGraph_node104" class="node"><title>get_chess_parameter</title>
<polygon fill="#777777" stroke="#777777" points="557,-1158 440,-1158 440,-1134 557,-1134 557,-1158"/>
<text text-anchor="middle" x="498.5" y="-1143.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_chess_parameter</text>
</g>
<!-- proc~state_init&#45;&gt;get_chess_parameter -->
<g id="proc~~siesta_forces~~CallsGraph_edge72" class="edge"><title>proc~state_init&#45;&gt;get_chess_parameter</title>
<path fill="none" stroke="#000000" d="M355.627,-1530.38C367.094,-1526.57 379.555,-1520.28 387,-1510 476.93,-1385.87 324.217,-1284.21 423,-1167 425.367,-1164.19 428.077,-1161.74 431.031,-1159.61"/>
<polygon fill="#000000" stroke="#000000" points="433.061,-1162.48 439.916,-1154.4 429.519,-1156.44 433.061,-1162.48"/>
</g>
<!-- ts_tri_analyze -->
<g id="proc~~siesta_forces~~CallsGraph_node106" class="node"><title>ts_tri_analyze</title>
<polygon fill="#777777" stroke="#777777" points="538,-1116 459,-1116 459,-1092 538,-1092 538,-1116"/>
<text text-anchor="middle" x="498.5" y="-1101.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ts_tri_analyze</text>
</g>
<!-- proc~state_init&#45;&gt;ts_tri_analyze -->
<g id="proc~~siesta_forces~~CallsGraph_edge48" class="edge"><title>proc~state_init&#45;&gt;ts_tri_analyze</title>
<path fill="none" stroke="#000000" d="M355.68,-1530.42C367.159,-1526.61 379.613,-1520.32 387,-1510 437.019,-1440.13 367.996,-1191.02 423,-1125 429.714,-1116.94 439.26,-1111.84 449.286,-1108.65"/>
<polygon fill="#000000" stroke="#000000" points="450.168,-1112.04 458.97,-1106.14 448.411,-1105.26 450.168,-1112.04"/>
</g>
<!-- ucell -->
<g id="proc~~siesta_forces~~CallsGraph_node108" class="node"><title>ucell</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-1074 471.5,-1074 471.5,-1050 525.5,-1050 525.5,-1074"/>
<text text-anchor="middle" x="498.5" y="-1059.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ucell</text>
</g>
<!-- proc~state_init&#45;&gt;ucell -->
<g id="proc~~siesta_forces~~CallsGraph_edge56" class="edge"><title>proc~state_init&#45;&gt;ucell</title>
<path fill="none" stroke="#000000" d="M355.723,-1530.45C367.211,-1526.65 379.66,-1520.35 387,-1510 442.077,-1432.32 362.38,-1156.44 423,-1083 432.362,-1071.66 447.334,-1066.18 461.409,-1063.62"/>
<polygon fill="#000000" stroke="#000000" points="461.984,-1067.07 471.407,-1062.23 461.02,-1060.14 461.984,-1067.07"/>
</g>
<!-- nscold -->
<g id="proc~~siesta_forces~~CallsGraph_node110" class="node"><title>nscold</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-1032 471.5,-1032 471.5,-1008 525.5,-1008 525.5,-1032"/>
<text text-anchor="middle" x="498.5" y="-1017.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nscold</text>
</g>
<!-- proc~state_init&#45;&gt;nscold -->
<g id="proc~~siesta_forces~~CallsGraph_edge90" class="edge"><title>proc~state_init&#45;&gt;nscold</title>
<path fill="none" stroke="#000000" d="M355.758,-1530.47C367.253,-1526.68 379.699,-1520.38 387,-1510 447.137,-1424.5 356.76,-1121.86 423,-1041 432.319,-1029.62 447.286,-1024.14 461.368,-1021.58"/>
<polygon fill="#000000" stroke="#000000" points="461.946,-1025.03 471.372,-1020.2 460.987,-1018.1 461.946,-1025.03"/>
</g>
<!-- delete -->
<g id="proc~~siesta_forces~~CallsGraph_node111" class="node"><title>delete</title>
<polygon fill="#777777" stroke="#777777" points="685,-748 631,-748 631,-724 685,-724 685,-748"/>
<text text-anchor="middle" x="658" y="-733.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">delete</text>
</g>
<!-- proc~state_init&#45;&gt;delete -->
<g id="proc~~siesta_forces~~CallsGraph_edge93" class="edge"><title>proc~state_init&#45;&gt;delete</title>
<path fill="none" stroke="#000000" d="M355.526,-1529.63C366.691,-1525.69 378.937,-1519.51 387,-1510 427.71,-1461.98 378.252,-1417.28 423,-1373 472.189,-1324.32 527.8,-1386.52 574,-1335 652.286,-1247.69 657.146,-856.64 657.114,-758.432"/>
<polygon fill="#000000" stroke="#000000" points="660.614,-758.408 657.092,-748.416 653.614,-758.424 660.614,-758.408"/>
</g>
<!-- escf -->
<g id="proc~~siesta_forces~~CallsGraph_node114" class="node"><title>escf</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-3230 471.5,-3230 471.5,-3206 525.5,-3206 525.5,-3230"/>
<text text-anchor="middle" x="498.5" y="-3215.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">escf</text>
</g>
<!-- proc~state_init&#45;&gt;escf -->
<g id="proc~~siesta_forces~~CallsGraph_edge31" class="edge"><title>proc~state_init&#45;&gt;escf</title>
<path fill="none" stroke="#000000" d="M329.49,-1548.15C335.516,-1696.94 395.544,-3162.79 423,-3197 432.205,-3208.47 447.154,-3213.97 461.255,-3216.51"/>
<polygon fill="#000000" stroke="#000000" points="460.896,-3219.99 471.278,-3217.88 461.843,-3213.06 460.896,-3219.99"/>
</g>
<!-- time_io -->
<g id="proc~~siesta_forces~~CallsGraph_node118" class="node"><title>time_io</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-990 471.5,-990 471.5,-966 525.5,-966 525.5,-990"/>
<text text-anchor="middle" x="498.5" y="-975.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">time_io</text>
</g>
<!-- proc~state_init&#45;&gt;time_io -->
<g id="proc~~siesta_forces~~CallsGraph_edge39" class="edge"><title>proc~state_init&#45;&gt;time_io</title>
<path fill="none" stroke="#000000" d="M355.788,-1530.49C367.289,-1526.71 379.732,-1520.4 387,-1510 452.2,-1416.68 351.138,-1087.29 423,-999 432.284,-987.594 447.245,-982.103 461.332,-979.553"/>
<polygon fill="#000000" stroke="#000000" points="461.914,-983.006 471.343,-978.174 460.958,-976.071 461.914,-983.006"/>
</g>
<!-- proc~check_cohp -->
<g id="proc~~siesta_forces~~CallsGraph_node119" class="node"><title>proc~check_cohp</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node119"><a xlink:href=".././proc/check_cohp.html" xlink:title="check_cohp">
<polygon fill="#d9534f" stroke="#d9534f" points="827,-1567 757,-1567 757,-1543 827,-1543 827,-1567"/>
<text text-anchor="middle" x="792" y="-1552.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_cohp</text>
</a>
</g>
</g>
<!-- proc~state_init&#45;&gt;proc~check_cohp -->
<g id="proc~~siesta_forces~~CallsGraph_edge42" class="edge"><title>proc~state_init&#45;&gt;proc~check_cohp</title>
<path fill="none" stroke="#000000" d="M353.726,-1523.84C376.652,-1512.82 409.231,-1497.87 423,-1495 542.286,-1470.12 685.122,-1514.27 752.376,-1539.39"/>
<polygon fill="#000000" stroke="#000000" points="751.148,-1542.66 761.739,-1542.94 753.634,-1536.12 751.148,-1542.66"/>
</g>
<!-- listhptr -->
<g id="proc~~siesta_forces~~CallsGraph_node121" class="node"><title>listhptr</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-948 471.5,-948 471.5,-924 525.5,-924 525.5,-948"/>
<text text-anchor="middle" x="498.5" y="-933.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">listhptr</text>
</g>
<!-- proc~state_init&#45;&gt;listhptr -->
<g id="proc~~siesta_forces~~CallsGraph_edge44" class="edge"><title>proc~state_init&#45;&gt;listhptr</title>
<path fill="none" stroke="#000000" d="M355.513,-1530.61C367.103,-1526.84 379.697,-1520.51 387,-1510 457.264,-1408.86 345.514,-1052.72 423,-957 432.253,-945.57 447.21,-940.074 461.303,-937.529"/>
<polygon fill="#000000" stroke="#000000" points="461.887,-940.981 471.318,-936.153 460.934,-934.046 461.887,-940.981"/>
</g>
<!-- xij_offset -->
<g id="proc~~siesta_forces~~CallsGraph_node122" class="node"><title>xij_offset</title>
<polygon fill="#777777" stroke="#777777" points="526,-906 471,-906 471,-882 526,-882 526,-906"/>
<text text-anchor="middle" x="498.5" y="-891.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xij_offset</text>
</g>
<!-- proc~state_init&#45;&gt;xij_offset -->
<g id="proc~~siesta_forces~~CallsGraph_edge80" class="edge"><title>proc~state_init&#45;&gt;xij_offset</title>
<path fill="none" stroke="#000000" d="M355.535,-1530.62C367.129,-1526.85 379.721,-1520.53 387,-1510 462.33,-1401.04 339.889,-1018.15 423,-915 432.159,-903.633 446.96,-898.131 460.966,-895.564"/>
<polygon fill="#000000" stroke="#000000" points="461.512,-899.022 470.931,-894.172 460.543,-892.089 461.512,-899.022"/>
</g>
<!-- setup_kpoint_scf -->
<g id="proc~~siesta_forces~~CallsGraph_node123" class="node"><title>setup_kpoint_scf</title>
<polygon fill="#777777" stroke="#777777" points="545,-864 452,-864 452,-840 545,-840 545,-864"/>
<text text-anchor="middle" x="498.5" y="-849.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_kpoint_scf</text>
</g>
<!-- proc~state_init&#45;&gt;setup_kpoint_scf -->
<g id="proc~~siesta_forces~~CallsGraph_edge46" class="edge"><title>proc~state_init&#45;&gt;setup_kpoint_scf</title>
<path fill="none" stroke="#000000" d="M355.554,-1530.64C367.152,-1526.87 379.742,-1520.54 387,-1510 467.397,-1393.22 334.263,-983.579 423,-873 428.027,-866.736 434.767,-862.252 442.146,-859.059"/>
<polygon fill="#000000" stroke="#000000" points="443.49,-862.296 451.755,-855.667 441.16,-855.696 443.49,-862.296"/>
</g>
<!-- ts_sparse_init -->
<g id="proc~~siesta_forces~~CallsGraph_node126" class="node"><title>ts_sparse_init</title>
<polygon fill="#777777" stroke="#777777" points="538,-822 459,-822 459,-798 538,-798 538,-822"/>
<text text-anchor="middle" x="498.5" y="-807.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ts_sparse_init</text>
</g>
<!-- proc~state_init&#45;&gt;ts_sparse_init -->
<g id="proc~~siesta_forces~~CallsGraph_edge54" class="edge"><title>proc~state_init&#45;&gt;ts_sparse_init</title>
<path fill="none" stroke="#000000" d="M355.57,-1530.65C367.172,-1526.88 379.76,-1520.56 387,-1510 472.464,-1385.39 328.636,-949.012 423,-831 429.551,-822.808 439.032,-817.659 449.049,-814.459"/>
<polygon fill="#000000" stroke="#000000" points="449.934,-817.846 458.738,-811.953 448.181,-811.069 449.934,-817.846"/>
</g>
<!-- normalize_dm -->
<g id="proc~~siesta_forces~~CallsGraph_node127" class="node"><title>normalize_dm</title>
<polygon fill="#777777" stroke="#777777" points="538.5,-3188 458.5,-3188 458.5,-3164 538.5,-3164 538.5,-3188"/>
<text text-anchor="middle" x="498.5" y="-3173.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">normalize_dm</text>
</g>
<!-- proc~state_init&#45;&gt;normalize_dm -->
<g id="proc~~siesta_forces~~CallsGraph_edge71" class="edge"><title>proc~state_init&#45;&gt;normalize_dm</title>
<path fill="none" stroke="#000000" d="M329.514,-1548.29C335.709,-1695.81 396.239,-3121.71 423,-3155 429.44,-3163.01 438.684,-3168.11 448.481,-3171.32"/>
<polygon fill="#000000" stroke="#000000" points="447.816,-3174.77 458.379,-3173.94 449.607,-3168 447.816,-3174.77"/>
</g>
<!-- proc~die -->
<g id="proc~~siesta_forces~~CallsGraph_node128" class="node"><title>proc~die</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node128"><a xlink:href=".././proc/die.html" xlink:title="die">
<polygon fill="#d9534f" stroke="#d9534f" points="948,-3225 894,-3225 894,-3201 948,-3201 948,-3225"/>
<text text-anchor="middle" x="921" y="-3210.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">die</text>
</a>
</g>
</g>
<!-- proc~state_init&#45;&gt;proc~die -->
<g id="proc~~siesta_forces~~CallsGraph_edge57" class="edge"><title>proc~state_init&#45;&gt;proc~die</title>
<path fill="none" stroke="#000000" d="M339.566,-1548.16C355.733,-1565.98 388.394,-1599.03 423,-1617 484.419,-1648.89 525.756,-1605.39 574,-1655 802.116,-1889.59 903.83,-3017.55 918.204,-3190.68"/>
<polygon fill="#000000" stroke="#000000" points="914.735,-3191.2 919.04,-3200.88 921.711,-3190.63 914.735,-3191.2"/>
</g>
<!-- globalize_sum -->
<g id="proc~~siesta_forces~~CallsGraph_node131" class="node"><title>globalize_sum</title>
<polygon fill="#777777" stroke="#777777" points="539,-3146 458,-3146 458,-3122 539,-3122 539,-3146"/>
<text text-anchor="middle" x="498.5" y="-3131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">globalize_sum</text>
</g>
<!-- proc~state_init&#45;&gt;globalize_sum -->
<g id="proc~~siesta_forces~~CallsGraph_edge61" class="edge"><title>proc~state_init&#45;&gt;globalize_sum</title>
<path fill="none" stroke="#000000" d="M329.322,-1548.15C333.154,-1691.11 370.866,-3048.24 423,-3113 429.383,-3120.93 438.512,-3126 448.202,-3129.22"/>
<polygon fill="#000000" stroke="#000000" points="447.433,-3132.64 457.999,-3131.85 449.25,-3125.88 447.433,-3132.64"/>
</g>
<!-- newdspdata2d -->
<g id="proc~~siesta_forces~~CallsGraph_node133" class="node"><title>newdspdata2d</title>
<polygon fill="#777777" stroke="#777777" points="539.5,-780 457.5,-780 457.5,-756 539.5,-756 539.5,-780"/>
<text text-anchor="middle" x="498.5" y="-765.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">newdspdata2d</text>
</g>
<!-- proc~state_init&#45;&gt;newdspdata2d -->
<g id="proc~~siesta_forces~~CallsGraph_edge65" class="edge"><title>proc~state_init&#45;&gt;newdspdata2d</title>
<path fill="none" stroke="#000000" d="M355.585,-1530.66C367.19,-1526.9 379.776,-1520.57 387,-1510 477.532,-1377.56 323.008,-914.446 423,-789 429.154,-781.279 437.913,-776.26 447.274,-773.028"/>
<polygon fill="#000000" stroke="#000000" points="448.472,-776.328 457.164,-770.269 446.591,-769.585 448.472,-776.328"/>
</g>
<!-- proc~message -->
<g id="proc~~siesta_forces~~CallsGraph_node134" class="node"><title>proc~message</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node134"><a xlink:href=".././proc/message.html" xlink:title="message">
<polygon fill="#d9534f" stroke="#d9534f" points="949,-2022 893,-2022 893,-1998 949,-1998 949,-2022"/>
<text text-anchor="middle" x="921" y="-2007.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">message</text>
</a>
</g>
</g>
<!-- proc~state_init&#45;&gt;proc~message -->
<g id="proc~~siesta_forces~~CallsGraph_edge67" class="edge"><title>proc~state_init&#45;&gt;proc~message</title>
<path fill="none" stroke="#000000" d="M355.665,-1538.88C432.487,-1547.66 652.224,-1576.3 706,-1622 829.825,-1727.23 895.009,-1922.98 914.018,-1988.22"/>
<polygon fill="#000000" stroke="#000000" points="910.659,-1989.2 916.765,-1997.86 917.391,-1987.28 910.659,-1989.2"/>
</g>
<!-- madelung -->
<g id="proc~~siesta_forces~~CallsGraph_node135" class="node"><title>madelung</title>
<polygon fill="#777777" stroke="#777777" points="528.5,-738 468.5,-738 468.5,-714 528.5,-714 528.5,-738"/>
<text text-anchor="middle" x="498.5" y="-723.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">madelung</text>
</g>
<!-- proc~state_init&#45;&gt;madelung -->
<g id="proc~~siesta_forces~~CallsGraph_edge69" class="edge"><title>proc~state_init&#45;&gt;madelung</title>
<path fill="none" stroke="#000000" d="M355.598,-1530.67C367.206,-1526.91 379.791,-1520.58 387,-1510 434.801,-1439.87 370.189,-813.44 423,-747 431.529,-736.27 445.088,-730.757 458.316,-728.006"/>
<polygon fill="#000000" stroke="#000000" points="458.961,-731.447 468.277,-726.401 457.848,-724.537 458.961,-731.447"/>
</g>
<!-- numh -->
<g id="proc~~siesta_forces~~CallsGraph_node137" class="node"><title>numh</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-696 471.5,-696 471.5,-672 525.5,-672 525.5,-696"/>
<text text-anchor="middle" x="498.5" y="-681.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">numh</text>
</g>
<!-- proc~state_init&#45;&gt;numh -->
<g id="proc~~siesta_forces~~CallsGraph_edge73" class="edge"><title>proc~state_init&#45;&gt;numh</title>
<path fill="none" stroke="#000000" d="M355.61,-1530.68C367.22,-1526.92 379.804,-1520.59 387,-1510 437.335,-1435.95 367.375,-775.158 423,-705 432.137,-693.476 447.076,-687.967 461.188,-685.437"/>
<polygon fill="#000000" stroke="#000000" points="461.783,-688.888 471.222,-684.077 460.843,-681.952 461.783,-688.888"/>
</g>
<!-- write_zmatrix -->
<g id="proc~~siesta_forces~~CallsGraph_node139" class="node"><title>write_zmatrix</title>
<polygon fill="#777777" stroke="#777777" points="536.5,-654 460.5,-654 460.5,-630 536.5,-630 536.5,-654"/>
<text text-anchor="middle" x="498.5" y="-639.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_zmatrix</text>
</g>
<!-- proc~state_init&#45;&gt;write_zmatrix -->
<g id="proc~~siesta_forces~~CallsGraph_edge85" class="edge"><title>proc~state_init&#45;&gt;write_zmatrix</title>
<path fill="none" stroke="#000000" d="M355.62,-1530.68C367.233,-1526.93 379.815,-1520.59 387,-1510 439.87,-1432.04 364.56,-736.876 423,-663 429.83,-654.366 439.918,-649.108 450.479,-645.948"/>
<polygon fill="#000000" stroke="#000000" points="451.328,-649.344 460.231,-643.6 449.69,-642.538 451.328,-649.344"/>
</g>
<!-- ts_write_tshs -->
<g id="proc~~siesta_forces~~CallsGraph_node140" class="node"><title>ts_write_tshs</title>
<polygon fill="#777777" stroke="#777777" points="536,-612 461,-612 461,-588 536,-588 536,-612"/>
<text text-anchor="middle" x="498.5" y="-597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ts_write_tshs</text>
</g>
<!-- proc~state_init&#45;&gt;ts_write_tshs -->
<g id="proc~~siesta_forces~~CallsGraph_edge64" class="edge"><title>proc~state_init&#45;&gt;ts_write_tshs</title>
<path fill="none" stroke="#000000" d="M355.63,-1530.69C367.245,-1526.93 379.826,-1520.6 387,-1510 442.405,-1428.13 361.745,-698.594 423,-621 429.949,-612.198 440.284,-606.903 451.06,-603.764"/>
<polygon fill="#000000" stroke="#000000" points="452.05,-607.127 460.995,-601.448 450.461,-600.309 452.05,-607.127"/>
</g>
<!-- fname_tshs -->
<g id="proc~~siesta_forces~~CallsGraph_node141" class="node"><title>fname_tshs</title>
<polygon fill="#777777" stroke="#777777" points="532.5,-570 464.5,-570 464.5,-546 532.5,-546 532.5,-570"/>
<text text-anchor="middle" x="498.5" y="-555.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fname_tshs</text>
</g>
<!-- proc~state_init&#45;&gt;fname_tshs -->
<g id="proc~~siesta_forces~~CallsGraph_edge68" class="edge"><title>proc~state_init&#45;&gt;fname_tshs</title>
<path fill="none" stroke="#000000" d="M355.638,-1530.69C367.255,-1526.94 379.836,-1520.61 387,-1510 444.94,-1424.21 358.93,-660.313 423,-579 430.667,-569.269 442.473,-563.824 454.443,-560.839"/>
<polygon fill="#000000" stroke="#000000" points="455.313,-564.235 464.449,-558.87 453.961,-557.367 455.313,-564.235"/>
</g>
<!-- proc~mixers_scf_history_init&#45;&gt;proc~mixers_history_init -->
<g id="proc~~siesta_forces~~CallsGraph_edge94" class="edge"><title>proc~mixers_scf_history_init&#45;&gt;proc~mixers_history_init</title>
<path fill="none" stroke="#000000" d="M223.109,-1963.97C226.869,-1961.51 230.259,-1958.56 233,-1955 292.883,-1877.29 209.512,-1593.01 269,-1515 302.847,-1470.61 354.406,-1517.31 387,-1472 477.668,-1345.95 327.688,-197.579 423,-75 427.06,-69.7786 432.313,-65.7887 438.149,-62.7498"/>
<polygon fill="#000000" stroke="#000000" points="439.86,-65.8271 447.714,-58.7168 437.14,-59.377 439.86,-65.8271"/>
</g>
<!-- proc~compute_max_diff_2d -->
<g id="proc~~siesta_forces~~CallsGraph_node59" class="node"><title>proc~compute_max_diff_2d</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node59"><a xlink:href=".././proc/compute_max_diff_2d.html" xlink:title="compute_max_diff_2d">
<polygon fill="#d9534f" stroke="#d9534f" points="387,-1430 269,-1430 269,-1406 387,-1406 387,-1430"/>
<text text-anchor="middle" x="328" y="-1415.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_max_diff_2d</text>
</a>
</g>
</g>
<!-- interface~compute_max_diff&#45;&gt;proc~compute_max_diff_2d -->
<g id="proc~~siesta_forces~~CallsGraph_edge96" class="edge"><title>interface~compute_max_diff&#45;&gt;proc~compute_max_diff_2d</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M222.698,-1758.04C226.595,-1755.57 230.127,-1752.59 233,-1749 318.243,-1642.39 188.206,-1554.02 269,-1444 271.29,-1440.88 274.041,-1438.13 277.083,-1435.7"/>
<polygon fill="#000000" stroke="#000000" points="279.289,-1438.44 285.701,-1430.01 275.429,-1432.6 279.289,-1438.44"/>
</g>
<!-- proc~compute_max_diff_1d -->
<g id="proc~~siesta_forces~~CallsGraph_node98" class="node"><title>proc~compute_max_diff_1d</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node98"><a xlink:href=".././proc/compute_max_diff_1d.html" xlink:title="compute_max_diff_1d">
<polygon fill="#d9534f" stroke="#d9534f" points="387,-1388 269,-1388 269,-1364 387,-1364 387,-1388"/>
<text text-anchor="middle" x="328" y="-1373.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_max_diff_1d</text>
</a>
</g>
</g>
<!-- interface~compute_max_diff&#45;&gt;proc~compute_max_diff_1d -->
<g id="proc~~siesta_forces~~CallsGraph_edge95" class="edge"><title>interface~compute_max_diff&#45;&gt;proc~compute_max_diff_1d</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M222.756,-1758.09C226.642,-1755.61 230.155,-1752.62 233,-1749 330.251,-1625.42 172.25,-1520.98 269,-1397 269.692,-1396.11 270.424,-1395.26 271.193,-1394.45"/>
<polygon fill="#000000" stroke="#000000" points="273.47,-1397.11 278.972,-1388.06 269.025,-1391.7 273.47,-1397.11"/>
</g>
<!-- mpi_finalize -->
<g id="proc~~siesta_forces~~CallsGraph_node46" class="node"><title>mpi_finalize</title>
<polygon fill="#777777" stroke="#777777" points="692.5,-3185 623.5,-3185 623.5,-3161 692.5,-3161 692.5,-3185"/>
<text text-anchor="middle" x="658" y="-3170.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_finalize</text>
</g>
<!-- proc~bye&#45;&gt;mpi_finalize -->
<g id="proc~~siesta_forces~~CallsGraph_edge98" class="edge"><title>proc~bye&#45;&gt;mpi_finalize</title>
<path fill="none" stroke="#000000" d="M525.524,-3501.75C541.969,-3498.9 562.261,-3492.47 574,-3478 652.779,-3380.91 539.723,-3302.41 610,-3199 611.939,-3196.15 614.3,-3193.57 616.919,-3191.26"/>
<polygon fill="#000000" stroke="#000000" points="619.374,-3193.8 625.392,-3185.08 615.25,-3188.15 619.374,-3193.8"/>
</g>
<!-- pxfflush -->
<g id="proc~~siesta_forces~~CallsGraph_node94" class="node"><title>pxfflush</title>
<polygon fill="#777777" stroke="#777777" points="1060.5,-2022 1006.5,-2022 1006.5,-1998 1060.5,-1998 1060.5,-2022"/>
<text text-anchor="middle" x="1033.5" y="-2007.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pxfflush</text>
</g>
<!-- proc~bye&#45;&gt;pxfflush -->
<g id="proc~~siesta_forces~~CallsGraph_edge97" class="edge"><title>proc~bye&#45;&gt;pxfflush</title>
<path fill="none" stroke="#000000" d="M523.266,-3491.98C540.468,-3481.92 562.617,-3465.85 574,-3445 613.05,-3373.46 596.243,-3160.34 610,-3080 694.274,-2587.86 485.077,-2297.08 878,-1989 913.19,-1961.41 967.298,-1978.17 1001.26,-1993.53"/>
<polygon fill="#000000" stroke="#000000" points="1000.15,-1996.88 1010.69,-1998 1003.14,-1990.55 1000.15,-1996.88"/>
</g>
<!-- cmlfinishfile -->
<g id="proc~~siesta_forces~~CallsGraph_node100" class="node"><title>cmlfinishfile</title>
<polygon fill="#777777" stroke="#777777" points="1067,-3056 1000,-3056 1000,-3032 1067,-3032 1067,-3056"/>
<text text-anchor="middle" x="1033.5" y="-3041.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cmlfinishfile</text>
</g>
<!-- proc~bye&#45;&gt;cmlfinishfile -->
<g id="proc~~siesta_forces~~CallsGraph_edge99" class="edge"><title>proc~bye&#45;&gt;cmlfinishfile</title>
<path fill="none" stroke="#000000" d="M523.123,-3491.9C540.25,-3481.79 562.368,-3465.72 574,-3445 638.235,-3330.6 523.35,-3250.52 610,-3152 707.918,-3040.67 903.265,-3036.47 989.681,-3040.64"/>
<polygon fill="#000000" stroke="#000000" points="989.735,-3044.15 999.911,-3041.2 990.117,-3037.16 989.735,-3044.15"/>
</g>
<!-- proc~state_analysis&#45;&gt;timer -->
<g id="proc~~siesta_forces~~CallsGraph_edge119" class="edge"><title>proc~state_analysis&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M330.053,-2915.02C335.511,-2974.23 362.666,-3233.83 423,-3281 475.872,-3322.33 521.451,-3322.74 574,-3281 629.377,-3237.01 554.623,-3169.99 610,-3126 643.409,-3099.46 666.047,-3111.03 706,-3126 777.234,-3152.7 929.54,-3283.18 964,-3351 1034.75,-3490.25 1033.87,-4003.78 1032.78,-4117.57"/>
<polygon fill="#000000" stroke="#000000" points="1029.28,-4117.81 1032.67,-4127.85 1036.28,-4117.89 1029.28,-4117.81"/>
</g>
<!-- proc~state_analysis&#45;&gt;volcel -->
<g id="proc~~siesta_forces~~CallsGraph_edge102" class="edge"><title>proc~state_analysis&#45;&gt;volcel</title>
<path fill="none" stroke="#000000" d="M353.337,-2890.95C372.082,-2881.96 398.799,-2869.76 423,-2861 435.339,-2856.53 449.105,-2852.42 461.414,-2849.03"/>
<polygon fill="#000000" stroke="#000000" points="462.593,-2852.34 471.348,-2846.38 460.783,-2845.58 462.593,-2852.34"/>
</g>
<!-- moments -->
<g id="proc~~siesta_forces~~CallsGraph_node31" class="node"><title>moments</title>
<polygon fill="#777777" stroke="#777777" points="527,-2978 470,-2978 470,-2954 527,-2954 527,-2978"/>
<text text-anchor="middle" x="498.5" y="-2963.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">moments</text>
</g>
<!-- proc~state_analysis&#45;&gt;moments -->
<g id="proc~~siesta_forces~~CallsGraph_edge103" class="edge"><title>proc~state_analysis&#45;&gt;moments</title>
<path fill="none" stroke="#000000" d="M353.337,-2915.05C372.082,-2924.04 398.799,-2936.24 423,-2945 434.944,-2949.33 448.225,-2953.32 460.228,-2956.64"/>
<polygon fill="#000000" stroke="#000000" points="459.386,-2960.04 469.952,-2959.26 461.207,-2953.28 459.386,-2960.04"/>
</g>
<!-- cartesianforce_to_zmatforce -->
<g id="proc~~siesta_forces~~CallsGraph_node35" class="node"><title>cartesianforce_to_zmatforce</title>
<polygon fill="#777777" stroke="#777777" points="572.5,-2936 424.5,-2936 424.5,-2912 572.5,-2912 572.5,-2936"/>
<text text-anchor="middle" x="498.5" y="-2921.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cartesianforce_to_zmatforce</text>
</g>
<!-- proc~state_analysis&#45;&gt;cartesianforce_to_zmatforce -->
<g id="proc~~siesta_forces~~CallsGraph_edge106" class="edge"><title>proc~state_analysis&#45;&gt;cartesianforce_to_zmatforce</title>
<path fill="none" stroke="#000000" d="M368.081,-2907.87C381.929,-2909.6 398.088,-2911.61 414.201,-2913.62"/>
<polygon fill="#000000" stroke="#000000" points="413.85,-2917.1 424.206,-2914.87 414.716,-2910.16 413.85,-2917.1"/>
</g>
<!-- print_spin -->
<g id="proc~~siesta_forces~~CallsGraph_node36" class="node"><title>print_spin</title>
<polygon fill="#777777" stroke="#777777" points="528,-2894 469,-2894 469,-2870 528,-2870 528,-2894"/>
<text text-anchor="middle" x="498.5" y="-2879.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_spin</text>
</g>
<!-- proc~state_analysis&#45;&gt;print_spin -->
<g id="proc~~siesta_forces~~CallsGraph_edge107" class="edge"><title>proc~state_analysis&#45;&gt;print_spin</title>
<path fill="none" stroke="#000000" d="M368.081,-2898.13C395.408,-2894.72 431.738,-2890.2 458.948,-2886.8"/>
<polygon fill="#000000" stroke="#000000" points="459.402,-2890.28 468.892,-2885.57 458.536,-2883.33 459.402,-2890.28"/>
</g>
<!-- siesta_write_stress_pressure -->
<g id="proc~~siesta_forces~~CallsGraph_node37" class="node"><title>siesta_write_stress_pressure</title>
<polygon fill="#777777" stroke="#777777" points="574,-2810 423,-2810 423,-2786 574,-2786 574,-2810"/>
<text text-anchor="middle" x="498.5" y="-2795.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_write_stress_pressure</text>
</g>
<!-- proc~state_analysis&#45;&gt;siesta_write_stress_pressure -->
<g id="proc~~siesta_forces~~CallsGraph_edge109" class="edge"><title>proc~state_analysis&#45;&gt;siesta_write_stress_pressure</title>
<path fill="none" stroke="#000000" d="M339.269,-2890.81C355.303,-2872.54 388.082,-2838.17 423,-2819 426.479,-2817.09 430.146,-2815.34 433.913,-2813.74"/>
<polygon fill="#000000" stroke="#000000" points="435.36,-2816.94 443.428,-2810.07 432.838,-2810.41 435.36,-2816.94"/>
</g>
<!-- slua_call -->
<g id="proc~~siesta_forces~~CallsGraph_node38" class="node"><title>slua_call</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-2768 471.5,-2768 471.5,-2744 525.5,-2744 525.5,-2768"/>
<text text-anchor="middle" x="498.5" y="-2753.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">slua_call</text>
</g>
<!-- proc~state_analysis&#45;&gt;slua_call -->
<g id="proc~~siesta_forces~~CallsGraph_edge111" class="edge"><title>proc~state_analysis&#45;&gt;slua_call</title>
<path fill="none" stroke="#000000" d="M334.617,-2890.86C346.914,-2865.65 378.696,-2807.46 423,-2777 434.272,-2769.25 448.358,-2764.34 461.239,-2761.24"/>
<polygon fill="#000000" stroke="#000000" points="462.176,-2764.62 471.233,-2759.13 460.725,-2757.78 462.176,-2764.62"/>
</g>
<!-- update_freeeharris -->
<g id="proc~~siesta_forces~~CallsGraph_node41" class="node"><title>update_freeeharris</title>
<polygon fill="#777777" stroke="#777777" points="550,-2726 447,-2726 447,-2702 550,-2702 550,-2726"/>
<text text-anchor="middle" x="498.5" y="-2711.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_freeeharris</text>
</g>
<!-- proc~state_analysis&#45;&gt;update_freeeharris -->
<g id="proc~~siesta_forces~~CallsGraph_edge112" class="edge"><title>proc~state_analysis&#45;&gt;update_freeeharris</title>
<path fill="none" stroke="#000000" d="M332.3,-2890.7C341.286,-2859.63 369.199,-2777.42 423,-2735 427.353,-2731.57 432.237,-2728.7 437.369,-2726.29"/>
<polygon fill="#000000" stroke="#000000" points="438.864,-2729.46 446.811,-2722.46 436.229,-2722.98 438.864,-2729.46"/>
</g>
<!-- update_freee -->
<g id="proc~~siesta_forces~~CallsGraph_node44" class="node"><title>update_freee</title>
<polygon fill="#777777" stroke="#777777" points="536.5,-5666 460.5,-5666 460.5,-5642 536.5,-5642 536.5,-5666"/>
<text text-anchor="middle" x="498.5" y="-5651.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_freee</text>
</g>
<!-- proc~state_analysis&#45;&gt;update_freee -->
<g id="proc~~siesta_forces~~CallsGraph_edge113" class="edge"><title>proc~state_analysis&#45;&gt;update_freee</title>
<path fill="none" stroke="#000000" d="M330.386,-2915.13C337.827,-2980.79 373.202,-3300.53 387,-3563 390.019,-3620.43 387.89,-5587.45 423,-5633 429.784,-5641.8 439.958,-5647.11 450.624,-5650.26"/>
<polygon fill="#000000" stroke="#000000" points="449.938,-5653.69 460.475,-5652.58 451.547,-5646.88 449.938,-5653.69"/>
</g>
<!-- born_charge -->
<g id="proc~~siesta_forces~~CallsGraph_node48" class="node"><title>born_charge</title>
<polygon fill="#777777" stroke="#777777" points="535,-2684 462,-2684 462,-2660 535,-2660 535,-2684"/>
<text text-anchor="middle" x="498.5" y="-2669.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">born_charge</text>
</g>
<!-- proc~state_analysis&#45;&gt;born_charge -->
<g id="proc~~siesta_forces~~CallsGraph_edge114" class="edge"><title>proc~state_analysis&#45;&gt;born_charge</title>
<path fill="none" stroke="#000000" d="M330.779,-2890.92C336.717,-2855.03 359.212,-2748.09 423,-2693 431.17,-2685.94 441.548,-2681.25 451.943,-2678.13"/>
<polygon fill="#000000" stroke="#000000" points="453.026,-2681.46 461.845,-2675.59 451.289,-2674.68 453.026,-2681.46"/>
</g>
<!-- proc~state_analysis&#45;&gt;cmladdproperty -->
<g id="proc~~siesta_forces~~CallsGraph_edge115" class="edge"><title>proc~state_analysis&#45;&gt;cmladdproperty</title>
<path fill="none" stroke="#000000" d="M330.063,-2890.84C335.753,-2828.43 364.562,-2544.72 423,-2483 428.977,-2476.69 436.69,-2472.22 444.88,-2469.08"/>
<polygon fill="#000000" stroke="#000000" points="446.179,-2472.34 454.639,-2465.96 444.048,-2465.67 446.179,-2472.34"/>
</g>
<!-- mulliken -->
<g id="proc~~siesta_forces~~CallsGraph_node51" class="node"><title>mulliken</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-2642 471.5,-2642 471.5,-2618 525.5,-2618 525.5,-2642"/>
<text text-anchor="middle" x="498.5" y="-2627.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mulliken</text>
</g>
<!-- proc~state_analysis&#45;&gt;mulliken -->
<g id="proc~~siesta_forces~~CallsGraph_edge117" class="edge"><title>proc~state_analysis&#45;&gt;mulliken</title>
<path fill="none" stroke="#000000" d="M329.778,-2890.91C333.044,-2850.53 349.152,-2719.01 423,-2651 433.398,-2641.42 447.829,-2636.17 461.223,-2633.31"/>
<polygon fill="#000000" stroke="#000000" points="461.94,-2636.74 471.18,-2631.55 460.723,-2629.84 461.94,-2636.74"/>
</g>
<!-- eggbox -->
<g id="proc~~siesta_forces~~CallsGraph_node52" class="node"><title>eggbox</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-2600 471.5,-2600 471.5,-2576 525.5,-2576 525.5,-2600"/>
<text text-anchor="middle" x="498.5" y="-2585.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">eggbox</text>
</g>
<!-- proc~state_analysis&#45;&gt;eggbox -->
<g id="proc~~siesta_forces~~CallsGraph_edge118" class="edge"><title>proc~state_analysis&#45;&gt;eggbox</title>
<path fill="none" stroke="#000000" d="M329.044,-2890.85C329.89,-2846.29 338.975,-2690.16 423,-2609 433.244,-2599.11 447.775,-2593.8 461.288,-2590.99"/>
<polygon fill="#000000" stroke="#000000" points="462.06,-2594.41 471.334,-2589.29 460.89,-2587.51 462.06,-2594.41"/>
</g>
<!-- cmlendmodule -->
<g id="proc~~siesta_forces~~CallsGraph_node57" class="node"><title>cmlendmodule</title>
<polygon fill="#777777" stroke="#777777" points="539.5,-2558 457.5,-2558 457.5,-2534 539.5,-2534 539.5,-2558"/>
<text text-anchor="middle" x="498.5" y="-2543.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cmlendmodule</text>
</g>
<!-- proc~state_analysis&#45;&gt;cmlendmodule -->
<g id="proc~~siesta_forces~~CallsGraph_edge120" class="edge"><title>proc~state_analysis&#45;&gt;cmlendmodule</title>
<path fill="none" stroke="#000000" d="M328.478,-2890.86C327.095,-2842.49 328.649,-2661.54 423,-2567 429.692,-2560.29 438.349,-2555.69 447.38,-2552.54"/>
<polygon fill="#000000" stroke="#000000" points="448.633,-2555.82 457.252,-2549.66 446.672,-2549.1 448.633,-2555.82"/>
</g>
<!-- proc~state_analysis&#45;&gt;write_debug -->
<g id="proc~~siesta_forces~~CallsGraph_edge121" class="edge"><title>proc~state_analysis&#45;&gt;write_debug</title>
<path fill="none" stroke="#000000" d="M330.882,-2915.12C343.22,-2994.41 412.359,-3436.05 423,-3445 474.349,-3488.21 523.735,-3489.47 574,-3445 672.268,-3358.07 511.732,-3238.93 610,-3152 641.957,-3123.73 675.216,-3122.46 706,-3152 776.205,-3219.38 714.67,-3933.61 742,-4027 776.538,-4145.02 866.222,-4265.33 903.438,-4311.9"/>
<polygon fill="#000000" stroke="#000000" points="900.945,-4314.38 909.951,-4319.96 906.391,-4309.98 900.945,-4314.38"/>
</g>
<!-- fixed -->
<g id="proc~~siesta_forces~~CallsGraph_node60" class="node"><title>fixed</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-2516 471.5,-2516 471.5,-2492 525.5,-2492 525.5,-2516"/>
<text text-anchor="middle" x="498.5" y="-2501.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fixed</text>
</g>
<!-- proc~state_analysis&#45;&gt;fixed -->
<g id="proc~~siesta_forces~~CallsGraph_edge122" class="edge"><title>proc~state_analysis&#45;&gt;fixed</title>
<path fill="none" stroke="#000000" d="M330.379,-2890.9C337.274,-2832.46 369.811,-2579.86 423,-2525 432.988,-2514.7 447.605,-2509.34 461.253,-2506.59"/>
<polygon fill="#000000" stroke="#000000" points="462.089,-2510 471.407,-2504.95 460.978,-2503.09 462.089,-2510"/>
</g>
<!-- kin_stress -->
<g id="proc~~siesta_forces~~CallsGraph_node62" class="node"><title>kin_stress</title>
<polygon fill="#777777" stroke="#777777" points="529,-3436 468,-3436 468,-3412 529,-3412 529,-3436"/>
<text text-anchor="middle" x="498.5" y="-3421.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">kin_stress</text>
</g>
<!-- proc~state_analysis&#45;&gt;kin_stress -->
<g id="proc~~siesta_forces~~CallsGraph_edge104" class="edge"><title>proc~state_analysis&#45;&gt;kin_stress</title>
<path fill="none" stroke="#000000" d="M331.745,-2915.11C340.442,-2953.67 367.932,-3077.1 387,-3180 396.146,-3229.36 389.598,-3365.53 423,-3403 431.82,-3412.89 444.902,-3418.28 457.654,-3421.17"/>
<polygon fill="#000000" stroke="#000000" points="457.259,-3424.65 467.721,-3422.98 458.501,-3417.76 457.259,-3424.65"/>
</g>
<!-- cmlstartmodule -->
<g id="proc~~siesta_forces~~CallsGraph_node81" class="node"><title>cmlstartmodule</title>
<polygon fill="#777777" stroke="#777777" points="541,-3394 456,-3394 456,-3370 541,-3370 541,-3394"/>
<text text-anchor="middle" x="498.5" y="-3379.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cmlstartmodule</text>
</g>
<!-- proc~state_analysis&#45;&gt;cmlstartmodule -->
<g id="proc~~siesta_forces~~CallsGraph_edge116" class="edge"><title>proc~state_analysis&#45;&gt;cmlstartmodule</title>
<path fill="none" stroke="#000000" d="M331.588,-2915.14C339.816,-2953.79 366.068,-3077.46 387,-3180 403.405,-3260.36 367.321,-3300.77 423,-3361 429.164,-3367.67 437.264,-3372.28 445.849,-3375.45"/>
<polygon fill="#000000" stroke="#000000" points="445.084,-3378.88 455.671,-3378.46 447.134,-3372.19 445.084,-3378.88"/>
</g>
<!-- amass -->
<g id="proc~~siesta_forces~~CallsGraph_node112" class="node"><title>amass</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-3352 471.5,-3352 471.5,-3328 525.5,-3328 525.5,-3352"/>
<text text-anchor="middle" x="498.5" y="-3337.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">amass</text>
</g>
<!-- proc~state_analysis&#45;&gt;amass -->
<g id="proc~~siesta_forces~~CallsGraph_edge100" class="edge"><title>proc~state_analysis&#45;&gt;amass</title>
<path fill="none" stroke="#000000" d="M331.45,-2915.23C344.835,-2981.83 409.028,-3298.39 423,-3314 432.85,-3325.01 447.619,-3331.36 461.417,-3335.02"/>
<polygon fill="#000000" stroke="#000000" points="460.681,-3338.44 471.207,-3337.23 462.228,-3331.61 460.681,-3338.44"/>
</g>
<!-- va -->
<g id="proc~~siesta_forces~~CallsGraph_node113" class="node"><title>va</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-3272 471.5,-3272 471.5,-3248 525.5,-3248 525.5,-3272"/>
<text text-anchor="middle" x="498.5" y="-3257.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">va</text>
</g>
<!-- proc~state_analysis&#45;&gt;va -->
<g id="proc~~siesta_forces~~CallsGraph_edge101" class="edge"><title>proc~state_analysis&#45;&gt;va</title>
<path fill="none" stroke="#000000" d="M330.793,-2915.19C339.05,-2969.75 375.076,-3190.98 423,-3239 433.061,-3249.08 447.56,-3254.41 461.099,-3257.2"/>
<polygon fill="#000000" stroke="#000000" points="460.737,-3260.69 471.175,-3258.88 461.884,-3253.78 460.737,-3260.69"/>
</g>
<!-- siesta_write_forces -->
<g id="proc~~siesta_forces~~CallsGraph_node117" class="node"><title>siesta_write_forces</title>
<polygon fill="#777777" stroke="#777777" points="550.5,-3104 446.5,-3104 446.5,-3080 550.5,-3080 550.5,-3104"/>
<text text-anchor="middle" x="498.5" y="-3089.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_write_forces</text>
</g>
<!-- proc~state_analysis&#45;&gt;siesta_write_forces -->
<g id="proc~~siesta_forces~~CallsGraph_edge105" class="edge"><title>proc~state_analysis&#45;&gt;siesta_write_forces</title>
<path fill="none" stroke="#000000" d="M332.3,-2915.3C341.286,-2946.37 369.199,-3028.58 423,-3071 427.287,-3074.38 432.089,-3077.22 437.136,-3079.6"/>
<polygon fill="#000000" stroke="#000000" points="435.844,-3082.85 446.424,-3083.41 438.5,-3076.37 435.844,-3082.85"/>
</g>
<!-- wallclock -->
<g id="proc~~siesta_forces~~CallsGraph_node124" class="node"><title>wallclock</title>
<polygon fill="#777777" stroke="#777777" points="526,-3062 471,-3062 471,-3038 526,-3038 526,-3062"/>
<text text-anchor="middle" x="498.5" y="-3047.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">wallclock</text>
</g>
<!-- proc~state_analysis&#45;&gt;wallclock -->
<g id="proc~~siesta_forces~~CallsGraph_edge108" class="edge"><title>proc~state_analysis&#45;&gt;wallclock</title>
<path fill="none" stroke="#000000" d="M334.617,-2915.14C346.914,-2940.35 378.696,-2998.54 423,-3029 434.184,-3036.69 448.14,-3041.58 460.939,-3044.68"/>
<polygon fill="#000000" stroke="#000000" points="460.37,-3048.14 470.881,-3046.81 461.833,-3041.3 460.37,-3048.14"/>
</g>
<!-- remove_intramol_pressure -->
<g id="proc~~siesta_forces~~CallsGraph_node125" class="node"><title>remove_intramol_pressure</title>
<polygon fill="#777777" stroke="#777777" points="569,-3020 428,-3020 428,-2996 569,-2996 569,-3020"/>
<text text-anchor="middle" x="498.5" y="-3005.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">remove_intramol_pressure</text>
</g>
<!-- proc~state_analysis&#45;&gt;remove_intramol_pressure -->
<g id="proc~~siesta_forces~~CallsGraph_edge110" class="edge"><title>proc~state_analysis&#45;&gt;remove_intramol_pressure</title>
<path fill="none" stroke="#000000" d="M339.269,-2915.19C355.303,-2933.46 388.082,-2967.83 423,-2987 426.479,-2988.91 430.146,-2990.66 433.913,-2992.26"/>
<polygon fill="#000000" stroke="#000000" points="432.838,-2995.59 443.428,-2995.93 435.36,-2989.06 432.838,-2995.59"/>
</g>
<!-- proc~compute_charge_diff&#45;&gt;fdf_get -->
<g id="proc~~siesta_forces~~CallsGraph_edge123" class="edge"><title>proc~compute_charge_diff&#45;&gt;fdf_get</title>
<path fill="none" stroke="#000000" d="M203.359,-5903.06C222.065,-5910.41 246.76,-5919.76 269,-5927 336.157,-5948.87 415.972,-5969.73 461.286,-5981.11"/>
<polygon fill="#000000" stroke="#000000" points="460.675,-5984.56 471.225,-5983.59 462.371,-5977.77 460.675,-5984.56"/>
</g>
<!-- proc~mixing_scf_converged&#45;&gt;reset -->
<g id="proc~~siesta_forces~~CallsGraph_edge124" class="edge"><title>proc~mixing_scf_converged&#45;&gt;reset</title>
<path fill="none" stroke="#000000" d="M216.06,-1631.94C222.569,-1628.4 228.581,-1623.84 233,-1618 304.158,-1523.9 194.841,-1446.76 269,-1355 274.612,-1348.06 282.721,-1343.41 291.105,-1340.3"/>
<polygon fill="#000000" stroke="#000000" points="292.391,-1343.56 300.94,-1337.3 290.354,-1336.87 292.391,-1343.56"/>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;proc~bye -->
<g id="proc~~siesta_forces~~CallsGraph_edge127" class="edge"><title>proc~setup_hamiltonian&#45;&gt;proc~bye</title>
<path fill="none" stroke="#000000" d="M174.134,-3759.91C176.956,-3719.62 191.935,-3589.09 269,-3530 324.938,-3487.11 412.396,-3491.01 461.295,-3497.56"/>
<polygon fill="#000000" stroke="#000000" points="461.01,-3501.06 471.409,-3499.03 462.015,-3494.13 461.01,-3501.06"/>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;timer -->
<g id="proc~~siesta_forces~~CallsGraph_edge131" class="edge"><title>proc~setup_hamiltonian&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M178.703,-3784.06C190.443,-3809.53 221.709,-3868.32 269,-3891 316.286,-3913.68 346.905,-3924.81 387,-3891 459.396,-3829.96 366.666,-3757.12 423,-3681 467.696,-3620.61 530.62,-3666.34 574,-3605 647.207,-3501.48 514.856,-3405.81 610,-3322 642.017,-3293.8 664.562,-3311.83 706,-3322 903.545,-3370.46 910.462,-3503.77 964,-3700 1006.71,-3856.55 1025.43,-4052.18 1030.79,-4117.56"/>
<polygon fill="#000000" stroke="#000000" points="1027.33,-4118.2 1031.61,-4127.89 1034.31,-4117.65 1027.33,-4118.2"/>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;re_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge134" class="edge"><title>proc~setup_hamiltonian&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M174.482,-3784.08C184.007,-3898.6 263.052,-4793.62 423,-4999 494.691,-5091.05 540.324,-5118 657,-5118 657,-5118 657,-5118 793,-5118 869.745,-5118 910.593,-5149.11 964,-5094 1015.64,-5040.71 987.289,-4835.11 1000,-4762 1007,-4721.71 1019,-4675.54 1026.29,-4648.97"/>
<polygon fill="#000000" stroke="#000000" points="1029.71,-4649.75 1029.01,-4639.18 1022.96,-4647.87 1029.71,-4649.75"/>
</g>
<!-- h -->
<g id="proc~~siesta_forces~~CallsGraph_node53" class="node"><title>h</title>
<polygon fill="#777777" stroke="#777777" points="355,-3764 301,-3764 301,-3740 355,-3740 355,-3764"/>
<text text-anchor="middle" x="328" y="-3749.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">h</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;h -->
<g id="proc~~siesta_forces~~CallsGraph_edge129" class="edge"><title>proc~setup_hamiltonian&#45;&gt;h</title>
<path fill="none" stroke="#000000" d="M222.913,-3765.56C245.005,-3762.68 270.572,-3759.35 290.838,-3756.71"/>
<polygon fill="#000000" stroke="#000000" points="291.443,-3760.16 300.906,-3755.4 290.538,-3753.22 291.443,-3760.16"/>
</g>
<!-- proc~dhscf -->
<g id="proc~~siesta_forces~~CallsGraph_node63" class="node"><title>proc~dhscf</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node63"><a xlink:href=".././proc/dhscf.html" xlink:title="dhscf">
<polygon fill="#d9534f" stroke="#d9534f" points="355,-4311 301,-4311 301,-4287 355,-4287 355,-4311"/>
<text text-anchor="middle" x="328" y="-4296.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dhscf</text>
</a>
</g>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;proc~dhscf -->
<g id="proc~~siesta_forces~~CallsGraph_edge132" class="edge"><title>proc~setup_hamiltonian&#45;&gt;proc~dhscf</title>
<path fill="none" stroke="#000000" d="M177.068,-3784.25C197.009,-3852.71 294.683,-4188.05 320.65,-4277.2"/>
<polygon fill="#000000" stroke="#000000" points="317.294,-4278.19 323.451,-4286.82 324.015,-4276.24 317.294,-4278.19"/>
</g>
<!-- write_hsx -->
<g id="proc~~siesta_forces~~CallsGraph_node76" class="node"><title>write_hsx</title>
<polygon fill="#777777" stroke="#777777" points="357,-3722 299,-3722 299,-3698 357,-3698 357,-3722"/>
<text text-anchor="middle" x="328" y="-3707.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_hsx</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;write_hsx -->
<g id="proc~~siesta_forces~~CallsGraph_edge125" class="edge"><title>proc~setup_hamiltonian&#45;&gt;write_hsx</title>
<path fill="none" stroke="#000000" d="M200.494,-3759.91C219.526,-3751.52 245.676,-3740.22 269,-3731 275.491,-3728.43 282.435,-3725.81 289.183,-3723.33"/>
<polygon fill="#000000" stroke="#000000" points="290.647,-3726.52 298.851,-3719.82 288.256,-3719.95 290.647,-3726.52"/>
</g>
<!-- hubbard_term -->
<g id="proc~~siesta_forces~~CallsGraph_node78" class="node"><title>hubbard_term</title>
<polygon fill="#777777" stroke="#777777" points="368,-3680 288,-3680 288,-3656 368,-3656 368,-3680"/>
<text text-anchor="middle" x="328" y="-3665.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hubbard_term</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;hubbard_term -->
<g id="proc~~siesta_forces~~CallsGraph_edge139" class="edge"><title>proc~setup_hamiltonian&#45;&gt;hubbard_term</title>
<path fill="none" stroke="#000000" d="M184.462,-3759.99C201.177,-3742.3 234.724,-3709.15 269,-3689 271.999,-3687.24 275.171,-3685.58 278.423,-3684.04"/>
<polygon fill="#000000" stroke="#000000" points="279.96,-3687.19 287.726,-3679.98 277.161,-3680.77 279.96,-3687.19"/>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;val -->
<g id="proc~~siesta_forces~~CallsGraph_edge128" class="edge"><title>proc~setup_hamiltonian&#45;&gt;val</title>
<path fill="none" stroke="#000000" d="M193.241,-3784.13C234.384,-3807.68 330.19,-3853.33 387,-3806 455.049,-3749.31 365.38,-3677.26 423,-3610 432.682,-3598.7 447.562,-3592.31 461.485,-3588.69"/>
<polygon fill="#000000" stroke="#000000" points="462.35,-3592.09 471.366,-3586.52 460.848,-3585.25 462.35,-3592.09"/>
</g>
<!-- hold -->
<g id="proc~~siesta_forces~~CallsGraph_node105" class="node"><title>hold</title>
<polygon fill="#777777" stroke="#777777" points="355,-3638 301,-3638 301,-3614 355,-3614 355,-3638"/>
<text text-anchor="middle" x="328" y="-3623.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hold</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;hold -->
<g id="proc~~siesta_forces~~CallsGraph_edge137" class="edge"><title>proc~setup_hamiltonian&#45;&gt;hold</title>
<path fill="none" stroke="#000000" d="M179.666,-3759.84C192.788,-3735.11 225.839,-3678.66 269,-3647 275.618,-3642.15 283.472,-3638.32 291.228,-3635.33"/>
<polygon fill="#000000" stroke="#000000" points="292.591,-3638.56 300.901,-3631.99 290.306,-3631.95 292.591,-3638.56"/>
</g>
<!-- de_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_node107" class="node"><title>de_alloc</title>
<polygon fill="#777777" stroke="#777777" points="1060.5,-4795 1006.5,-4795 1006.5,-4771 1060.5,-4771 1060.5,-4795"/>
<text text-anchor="middle" x="1033.5" y="-4780.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">de_alloc</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;de_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge133" class="edge"><title>proc~setup_hamiltonian&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M174.147,-3784.29C179.413,-3882.76 216.409,-4544.78 269,-4737 311.818,-4893.5 302.108,-4959.78 423,-5068 513.02,-5148.58 874.68,-5203.36 964,-5122 1011.2,-5079.01 1027.25,-4873.51 1031.33,-4805.16"/>
<polygon fill="#000000" stroke="#000000" points="1034.83,-4805.26 1031.91,-4795.07 1027.84,-4804.86 1034.83,-4805.26"/>
</g>
<!-- dimag -->
<g id="proc~~siesta_forces~~CallsGraph_node109" class="node"><title>dimag</title>
<polygon fill="#777777" stroke="#777777" points="355,-3596 301,-3596 301,-3572 355,-3572 355,-3596"/>
<text text-anchor="middle" x="328" y="-3581.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dimag</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;dimag -->
<g id="proc~~siesta_forces~~CallsGraph_edge130" class="edge"><title>proc~setup_hamiltonian&#45;&gt;dimag</title>
<path fill="none" stroke="#000000" d="M177.266,-3759.56C187.175,-3728.86 216.86,-3648.86 269,-3605 275.409,-3599.61 283.315,-3595.55 291.205,-3592.52"/>
<polygon fill="#000000" stroke="#000000" points="292.367,-3595.82 300.719,-3589.3 290.125,-3589.19 292.367,-3595.82"/>
</g>
<!-- update_e0 -->
<g id="proc~~siesta_forces~~CallsGraph_node120" class="node"><title>update_e0</title>
<polygon fill="#777777" stroke="#777777" points="360,-3882 296,-3882 296,-3858 360,-3858 360,-3882"/>
<text text-anchor="middle" x="328" y="-3867.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_e0</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;update_e0 -->
<g id="proc~~siesta_forces~~CallsGraph_edge136" class="edge"><title>proc~setup_hamiltonian&#45;&gt;update_e0</title>
<path fill="none" stroke="#000000" d="M187.354,-3784.03C205.334,-3799.27 238.074,-3825.73 269,-3844 274.808,-3847.43 281.151,-3850.71 287.441,-3853.71"/>
<polygon fill="#000000" stroke="#000000" points="286.002,-3856.9 296.55,-3857.89 288.921,-3850.54 286.002,-3856.9"/>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;proc~die -->
<g id="proc~~siesta_forces~~CallsGraph_edge138" class="edge"><title>proc~setup_hamiltonian&#45;&gt;proc~die</title>
<path fill="none" stroke="#000000" d="M174.987,-3759.77C180.167,-3723.01 200.976,-3612.92 269,-3563 379.132,-3482.18 477.387,-3621.57 574,-3525 665.232,-3433.8 516.664,-3326.04 610,-3237 648.344,-3200.42 810.225,-3205.83 883.59,-3210.34"/>
<polygon fill="#000000" stroke="#000000" points="883.542,-3213.85 893.747,-3211 883.992,-3206.86 883.542,-3213.85"/>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;globalize_sum -->
<g id="proc~~siesta_forces~~CallsGraph_edge126" class="edge"><title>proc~setup_hamiltonian&#45;&gt;globalize_sum</title>
<path fill="none" stroke="#000000" d="M205.172,-3784.06C251.679,-3799.48 338.2,-3819.04 387,-3773 487.062,-3678.6 336.808,-3262.22 423,-3155 429.378,-3147.07 438.504,-3141.99 448.194,-3138.77"/>
<polygon fill="#000000" stroke="#000000" points="449.242,-3142.12 457.991,-3136.14 447.425,-3135.36 449.242,-3142.12"/>
</g>
<!-- dscf -->
<g id="proc~~siesta_forces~~CallsGraph_node136" class="node"><title>dscf</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-5208 471.5,-5208 471.5,-5184 525.5,-5184 525.5,-5208"/>
<text text-anchor="middle" x="498.5" y="-5193.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dscf</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;dscf -->
<g id="proc~~siesta_forces~~CallsGraph_edge135" class="edge"><title>proc~setup_hamiltonian&#45;&gt;dscf</title>
<path fill="none" stroke="#000000" d="M173.405,-3784.33C172.505,-3916.23 167.615,-5063.94 269,-5170 318.427,-5221.71 410.584,-5213.78 461.456,-5204.36"/>
<polygon fill="#000000" stroke="#000000" points="462.219,-5207.77 471.355,-5202.41 460.867,-5200.9 462.219,-5207.77"/>
</g>
<!-- proc~compute_dm&#45;&gt;proc~bye -->
<g id="proc~~siesta_forces~~CallsGraph_edge146" class="edge"><title>proc~compute_dm&#45;&gt;proc~bye</title>
<path fill="none" stroke="#000000" d="M329.671,-5389.99C334.526,-5303.05 364.692,-4761.04 387,-4320 391.254,-4235.9 384.545,-3637.91 423,-3563 432.007,-3545.45 448.846,-3531.43 464.24,-3521.46"/>
<polygon fill="#000000" stroke="#000000" points="466.359,-3524.27 473.066,-3516.07 462.708,-3518.3 466.359,-3524.27"/>
</g>
<!-- proc~compute_dm&#45;&gt;transiesta -->
<g id="proc~~siesta_forces~~CallsGraph_edge148" class="edge"><title>proc~compute_dm&#45;&gt;transiesta</title>
<path fill="none" stroke="#000000" d="M332.304,-5414.27C341.65,-5449.22 368.775,-5552.36 387,-5639 405.953,-5729.1 361.236,-5774.72 423,-5843 432.195,-5853.16 445.89,-5858.56 459.039,-5861.38"/>
<polygon fill="#000000" stroke="#000000" points="458.457,-5864.83 468.904,-5863.07 459.637,-5857.93 458.457,-5864.83"/>
</g>
<!-- proc~compute_dm&#45;&gt;timer -->
<g id="proc~~siesta_forces~~CallsGraph_edge152" class="edge"><title>proc~compute_dm&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M333.155,-5389.91C343.527,-5361.61 373.348,-5290.76 423,-5255 479.154,-5214.55 507.416,-5235.86 574,-5217 748.87,-5167.47 851.352,-5236.63 964,-5094 965.871,-5091.63 1020.94,-4305.34 1030.95,-4162.21"/>
<polygon fill="#000000" stroke="#000000" points="1034.45,-4162.25 1031.66,-4152.03 1027.47,-4161.76 1034.45,-4162.25"/>
</g>
<!-- zminim -->
<g id="proc~~siesta_forces~~CallsGraph_node50" class="node"><title>zminim</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-5456 471.5,-5456 471.5,-5432 525.5,-5432 525.5,-5456"/>
<text text-anchor="middle" x="498.5" y="-5441.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">zminim</text>
</g>
<!-- proc~compute_dm&#45;&gt;zminim -->
<g id="proc~~siesta_forces~~CallsGraph_edge142" class="edge"><title>proc~compute_dm&#45;&gt;zminim</title>
<path fill="none" stroke="#000000" d="M365.562,-5411.11C394.01,-5418.2 433.273,-5427.99 461.561,-5435.04"/>
<polygon fill="#000000" stroke="#000000" points="460.896,-5438.48 471.446,-5437.51 462.59,-5431.69 460.896,-5438.48"/>
</g>
<!-- write_orb_indx -->
<g id="proc~~siesta_forces~~CallsGraph_node64" class="node"><title>write_orb_indx</title>
<polygon fill="#777777" stroke="#777777" points="539.5,-5414 457.5,-5414 457.5,-5390 539.5,-5390 539.5,-5414"/>
<text text-anchor="middle" x="498.5" y="-5399.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_orb_indx</text>
</g>
<!-- proc~compute_dm&#45;&gt;write_orb_indx -->
<g id="proc~~siesta_forces~~CallsGraph_edge155" class="edge"><title>proc~compute_dm&#45;&gt;write_orb_indx</title>
<path fill="none" stroke="#000000" d="M365.562,-5402C389.488,-5402 421.064,-5402 447.327,-5402"/>
<polygon fill="#000000" stroke="#000000" points="447.474,-5405.5 457.474,-5402 447.474,-5398.5 447.474,-5405.5"/>
</g>
<!-- eold -->
<g id="proc~~siesta_forces~~CallsGraph_node67" class="node"><title>eold</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-5372 471.5,-5372 471.5,-5348 525.5,-5348 525.5,-5372"/>
<text text-anchor="middle" x="498.5" y="-5357.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">eold</text>
</g>
<!-- proc~compute_dm&#45;&gt;eold -->
<g id="proc~~siesta_forces~~CallsGraph_edge144" class="edge"><title>proc~compute_dm&#45;&gt;eold</title>
<path fill="none" stroke="#000000" d="M365.562,-5392.89C394.01,-5385.8 433.273,-5376.01 461.561,-5368.96"/>
<polygon fill="#000000" stroke="#000000" points="462.59,-5372.31 471.446,-5366.49 460.896,-5365.52 462.59,-5372.31"/>
</g>
<!-- write_dmh_netcdf -->
<g id="proc~~siesta_forces~~CallsGraph_node75" class="node"><title>write_dmh_netcdf</title>
<polygon fill="#777777" stroke="#777777" points="547,-5330 450,-5330 450,-5306 547,-5306 547,-5330"/>
<text text-anchor="middle" x="498.5" y="-5315.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_dmh_netcdf</text>
</g>
<!-- proc~compute_dm&#45;&gt;write_dmh_netcdf -->
<g id="proc~~siesta_forces~~CallsGraph_edge151" class="edge"><title>proc~compute_dm&#45;&gt;write_dmh_netcdf</title>
<path fill="none" stroke="#000000" d="M343.746,-5389.94C361.547,-5375.92 392.857,-5352.92 423,-5339 428.393,-5336.51 434.144,-5334.25 439.97,-5332.22"/>
<polygon fill="#000000" stroke="#000000" points="441.371,-5335.45 449.794,-5329.02 439.202,-5328.79 441.371,-5335.45"/>
</g>
<!-- dminim -->
<g id="proc~~siesta_forces~~CallsGraph_node80" class="node"><title>dminim</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-5288 471.5,-5288 471.5,-5264 525.5,-5264 525.5,-5288"/>
<text text-anchor="middle" x="498.5" y="-5273.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dminim</text>
</g>
<!-- proc~compute_dm&#45;&gt;dminim -->
<g id="proc~~siesta_forces~~CallsGraph_edge158" class="edge"><title>proc~compute_dm&#45;&gt;dminim</title>
<path fill="none" stroke="#000000" d="M336.434,-5389.91C350.539,-5368.01 383.349,-5321.73 423,-5297 434.516,-5289.82 448.541,-5285.03 461.304,-5281.87"/>
<polygon fill="#000000" stroke="#000000" points="462.195,-5285.26 471.196,-5279.67 460.674,-5278.43 462.195,-5285.26"/>
</g>
<!-- ordern -->
<g id="proc~~siesta_forces~~CallsGraph_node85" class="node"><title>ordern</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-5834 471.5,-5834 471.5,-5810 525.5,-5810 525.5,-5834"/>
<text text-anchor="middle" x="498.5" y="-5819.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ordern</text>
</g>
<!-- proc~compute_dm&#45;&gt;ordern -->
<g id="proc~~siesta_forces~~CallsGraph_edge140" class="edge"><title>proc~compute_dm&#45;&gt;ordern</title>
<path fill="none" stroke="#000000" d="M332.112,-5414.31C340.952,-5449.38 366.874,-5552.79 387,-5639 403.767,-5710.83 372.329,-5747.4 423,-5801 432.858,-5811.43 447.454,-5816.81 461.12,-5819.54"/>
<polygon fill="#000000" stroke="#000000" points="460.871,-5823.05 471.296,-5821.15 461.967,-5816.13 460.871,-5823.05"/>
</g>
<!-- diagon -->
<g id="proc~~siesta_forces~~CallsGraph_node89" class="node"><title>diagon</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-5792 471.5,-5792 471.5,-5768 525.5,-5768 525.5,-5792"/>
<text text-anchor="middle" x="498.5" y="-5777.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">diagon</text>
</g>
<!-- proc~compute_dm&#45;&gt;diagon -->
<g id="proc~~siesta_forces~~CallsGraph_edge141" class="edge"><title>proc~compute_dm&#45;&gt;diagon</title>
<path fill="none" stroke="#000000" d="M331.998,-5414.05C347.342,-5475.62 416.612,-5752.5 423,-5759 433.058,-5769.23 447.688,-5774.58 461.325,-5777.34"/>
<polygon fill="#000000" stroke="#000000" points="461.036,-5780.84 471.467,-5778.99 462.156,-5773.93 461.036,-5780.84"/>
</g>
<!-- proc~compute_dm&#45;&gt;val -->
<g id="proc~~siesta_forces~~CallsGraph_edge145" class="edge"><title>proc~compute_dm&#45;&gt;val</title>
<path fill="none" stroke="#000000" d="M329.662,-5389.66C337.933,-5235.37 421.025,-3686.33 423,-3681 434.359,-3650.34 459.011,-3621.46 476.853,-3603.32"/>
<polygon fill="#000000" stroke="#000000" points="479.375,-3605.75 484.024,-3596.23 474.453,-3600.77 479.375,-3605.75"/>
</g>
<!-- dold -->
<g id="proc~~siesta_forces~~CallsGraph_node97" class="node"><title>dold</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-5750 471.5,-5750 471.5,-5726 525.5,-5726 525.5,-5750"/>
<text text-anchor="middle" x="498.5" y="-5735.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dold</text>
</g>
<!-- proc~compute_dm&#45;&gt;dold -->
<g id="proc~~siesta_forces~~CallsGraph_edge153" class="edge"><title>proc~compute_dm&#45;&gt;dold</title>
<path fill="none" stroke="#000000" d="M331.883,-5414.11C345.093,-5469.22 400.179,-5694.52 423,-5717 433.147,-5726.99 447.662,-5732.31 461.188,-5735.11"/>
<polygon fill="#000000" stroke="#000000" points="460.809,-5738.6 471.25,-5736.8 461.967,-5731.69 460.809,-5738.6"/>
</g>
<!-- pexsi_solver -->
<g id="proc~~siesta_forces~~CallsGraph_node102" class="node"><title>pexsi_solver</title>
<polygon fill="#777777" stroke="#777777" points="534.5,-5708 462.5,-5708 462.5,-5684 534.5,-5684 534.5,-5708"/>
<text text-anchor="middle" x="498.5" y="-5693.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pexsi_solver</text>
</g>
<!-- proc~compute_dm&#45;&gt;pexsi_solver -->
<g id="proc~~siesta_forces~~CallsGraph_edge143" class="edge"><title>proc~compute_dm&#45;&gt;pexsi_solver</title>
<path fill="none" stroke="#000000" d="M329.389,-5414.17C331.425,-5456.75 344.111,-5600.47 423,-5675 431.077,-5682.63 441.709,-5687.52 452.402,-5690.65"/>
<polygon fill="#000000" stroke="#000000" points="451.622,-5694.06 462.169,-5693.05 453.295,-5687.26 451.622,-5694.06"/>
</g>
<!-- proc~compute_dm&#45;&gt;escf -->
<g id="proc~~siesta_forces~~CallsGraph_edge147" class="edge"><title>proc~compute_dm&#45;&gt;escf</title>
<path fill="none" stroke="#000000" d="M329.736,-5389.99C335.047,-5303.07 367.831,-4761.19 387,-4320 389.608,-4259.97 385.937,-3286.3 423,-3239 432.071,-3227.42 447.001,-3221.91 461.123,-3219.39"/>
<polygon fill="#000000" stroke="#000000" points="461.724,-3222.84 471.168,-3218.03 460.791,-3215.9 461.724,-3222.84"/>
</g>
<!-- chess_wrapper -->
<g id="proc~~siesta_forces~~CallsGraph_node115" class="node"><title>chess_wrapper</title>
<polygon fill="#777777" stroke="#777777" points="541,-5624 456,-5624 456,-5600 541,-5600 541,-5624"/>
<text text-anchor="middle" x="498.5" y="-5609.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">chess_wrapper</text>
</g>
<!-- proc~compute_dm&#45;&gt;chess_wrapper -->
<g id="proc~~siesta_forces~~CallsGraph_edge149" class="edge"><title>proc~compute_dm&#45;&gt;chess_wrapper</title>
<path fill="none" stroke="#000000" d="M331.485,-5414.31C338.936,-5447.99 364.309,-5542.36 423,-5591 429.693,-5596.55 437.761,-5600.63 446.08,-5603.64"/>
<polygon fill="#000000" stroke="#000000" points="445.307,-5607.06 455.896,-5606.7 447.39,-5600.38 445.307,-5607.06"/>
</g>
<!-- proc~compute_dm&#45;&gt;normalize_dm -->
<g id="proc~~siesta_forces~~CallsGraph_edge157" class="edge"><title>proc~compute_dm&#45;&gt;normalize_dm</title>
<path fill="none" stroke="#000000" d="M329.742,-5389.99C335.092,-5303.07 368.105,-4761.2 387,-4320 389.671,-4257.64 384.529,-3246.16 423,-3197 429.336,-3188.9 438.538,-3183.77 448.327,-3180.55"/>
<polygon fill="#000000" stroke="#000000" points="449.454,-3183.88 458.227,-3177.94 447.665,-3177.11 449.454,-3183.88"/>
</g>
<!-- compute_ebs_shift -->
<g id="proc~~siesta_forces~~CallsGraph_node129" class="node"><title>compute_ebs_shift</title>
<polygon fill="#777777" stroke="#777777" points="550,-5582 447,-5582 447,-5558 550,-5558 550,-5582"/>
<text text-anchor="middle" x="498.5" y="-5567.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_ebs_shift</text>
</g>
<!-- proc~compute_dm&#45;&gt;compute_ebs_shift -->
<g id="proc~~siesta_forces~~CallsGraph_edge159" class="edge"><title>proc~compute_dm&#45;&gt;compute_ebs_shift</title>
<path fill="none" stroke="#000000" d="M333.381,-5414.42C344.04,-5442.79 374.101,-5512.72 423,-5549 427.384,-5552.25 432.253,-5555 437.343,-5557.33"/>
<polygon fill="#000000" stroke="#000000" points="436.1,-5560.6 446.684,-5561.07 438.701,-5554.1 436.1,-5560.6"/>
</g>
<!-- mpi_bcast -->
<g id="proc~~siesta_forces~~CallsGraph_node132" class="node"><title>mpi_bcast</title>
<polygon fill="#777777" stroke="#777777" points="529,-5540 468,-5540 468,-5516 529,-5516 529,-5540"/>
<text text-anchor="middle" x="498.5" y="-5525.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_bcast</text>
</g>
<!-- proc~compute_dm&#45;&gt;mpi_bcast -->
<g id="proc~~siesta_forces~~CallsGraph_edge150" class="edge"><title>proc~compute_dm&#45;&gt;mpi_bcast</title>
<path fill="none" stroke="#000000" d="M336.434,-5414.09C350.539,-5435.99 383.349,-5482.27 423,-5507 433.6,-5513.61 446.327,-5518.19 458.237,-5521.34"/>
<polygon fill="#000000" stroke="#000000" points="457.446,-5524.75 467.985,-5523.67 459.07,-5517.94 457.446,-5524.75"/>
</g>
<!-- proc~compute_dm&#45;&gt;dscf -->
<g id="proc~~siesta_forces~~CallsGraph_edge156" class="edge"><title>proc~compute_dm&#45;&gt;dscf</title>
<path fill="none" stroke="#000000" d="M331.944,-5389.99C340.403,-5357.95 367.783,-5269.72 423,-5222 433.82,-5212.65 448.204,-5206.6 461.446,-5202.72"/>
<polygon fill="#000000" stroke="#000000" points="462.481,-5206.06 471.271,-5200.15 460.711,-5199.29 462.481,-5206.06"/>
</g>
<!-- write_hs_formatted -->
<g id="proc~~siesta_forces~~CallsGraph_node138" class="node"><title>write_hs_formatted</title>
<polygon fill="#777777" stroke="#777777" points="550.5,-5498 446.5,-5498 446.5,-5474 550.5,-5474 550.5,-5498"/>
<text text-anchor="middle" x="498.5" y="-5483.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_hs_formatted</text>
</g>
<!-- proc~compute_dm&#45;&gt;write_hs_formatted -->
<g id="proc~~siesta_forces~~CallsGraph_edge154" class="edge"><title>proc~compute_dm&#45;&gt;write_hs_formatted</title>
<path fill="none" stroke="#000000" d="M343.746,-5414.06C361.547,-5428.08 392.857,-5451.08 423,-5465 427.419,-5467.04 432.078,-5468.92 436.822,-5470.65"/>
<polygon fill="#000000" stroke="#000000" points="436.034,-5474.08 446.628,-5473.99 438.289,-5467.46 436.034,-5474.08"/>
</g>
<!-- proc~compute_energies&#45;&gt;fdf_get -->
<g id="proc~~siesta_forces~~CallsGraph_edge162" class="edge"><title>proc~compute_energies&#45;&gt;fdf_get</title>
<path fill="none" stroke="#000000" d="M378.644,-6013.98C405.146,-6008.64 437.178,-6002.17 461.307,-5997.3"/>
<polygon fill="#000000" stroke="#000000" points="462.015,-6000.73 471.126,-5995.32 460.631,-5993.87 462.015,-6000.73"/>
</g>
<!-- proc~compute_energies&#45;&gt;update_freee -->
<g id="proc~~siesta_forces~~CallsGraph_edge160" class="edge"><title>proc~compute_energies&#45;&gt;update_freee</title>
<path fill="none" stroke="#000000" d="M338.403,-6011.94C351.59,-5994.34 375.274,-5960.11 387,-5927 424.772,-5820.35 348.487,-5760.13 423,-5675 430.109,-5666.88 440.092,-5661.78 450.446,-5658.62"/>
<polygon fill="#000000" stroke="#000000" points="451.546,-5661.95 460.404,-5656.14 449.854,-5655.16 451.546,-5661.95"/>
</g>
<!-- update_dena -->
<g id="proc~~siesta_forces~~CallsGraph_node116" class="node"><title>update_dena</title>
<polygon fill="#777777" stroke="#777777" points="536.5,-6044 460.5,-6044 460.5,-6020 536.5,-6020 536.5,-6044"/>
<text text-anchor="middle" x="498.5" y="-6029.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_dena</text>
</g>
<!-- proc~compute_energies&#45;&gt;update_dena -->
<g id="proc~~siesta_forces~~CallsGraph_edge161" class="edge"><title>proc~compute_energies&#45;&gt;update_dena</title>
<path fill="none" stroke="#000000" d="M378.644,-6026.36C401.188,-6027.43 427.732,-6028.69 450.011,-6029.75"/>
<polygon fill="#000000" stroke="#000000" points="450.087,-6033.25 460.242,-6030.23 450.419,-6026.26 450.087,-6033.25"/>
</g>
<!-- update_etot -->
<g id="proc~~siesta_forces~~CallsGraph_node130" class="node"><title>update_etot</title>
<polygon fill="#777777" stroke="#777777" points="533.5,-6086 463.5,-6086 463.5,-6062 533.5,-6062 533.5,-6086"/>
<text text-anchor="middle" x="498.5" y="-6071.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_etot</text>
</g>
<!-- proc~compute_energies&#45;&gt;update_etot -->
<g id="proc~~siesta_forces~~CallsGraph_edge163" class="edge"><title>proc~compute_energies&#45;&gt;update_etot</title>
<path fill="none" stroke="#000000" d="M367.353,-6036.06C384.369,-6041.36 404.655,-6047.59 423,-6053 432.86,-6055.91 443.479,-6058.96 453.524,-6061.8"/>
<polygon fill="#000000" stroke="#000000" points="452.754,-6065.22 463.328,-6064.56 454.651,-6058.48 452.754,-6065.22"/>
</g>
<!-- proc~mix_rhog&#45;&gt;fdf_get -->
<g id="proc~~siesta_forces~~CallsGraph_edge166" class="edge"><title>proc~mix_rhog&#45;&gt;fdf_get</title>
<path fill="none" stroke="#000000" d="M356.701,-5915.9C366.695,-5920.11 377.776,-5925.55 387,-5932 405.802,-5945.15 403.285,-5957.26 423,-5969 434.663,-5975.94 448.719,-5980.68 461.465,-5983.86"/>
<polygon fill="#000000" stroke="#000000" points="460.809,-5987.3 471.335,-5986.1 462.356,-5980.48 460.809,-5987.3"/>
</g>
<!-- n_items -->
<g id="proc~~siesta_forces~~CallsGraph_node66" class="node"><title>n_items</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-5960 471.5,-5960 471.5,-5936 525.5,-5936 525.5,-5960"/>
<text text-anchor="middle" x="498.5" y="-5945.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">n_items</text>
</g>
<!-- proc~mix_rhog&#45;&gt;n_items -->
<g id="proc~~siesta_forces~~CallsGraph_edge164" class="edge"><title>proc~mix_rhog&#45;&gt;n_items</title>
<path fill="none" stroke="#000000" d="M356.824,-5912.94C385.378,-5920.05 429.934,-5931.16 461.235,-5938.96"/>
<polygon fill="#000000" stroke="#000000" points="460.749,-5942.45 471.299,-5941.47 462.442,-5935.65 460.749,-5942.45"/>
</g>
<!-- diis -->
<g id="proc~~siesta_forces~~CallsGraph_node74" class="node"><title>diis</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-5918 471.5,-5918 471.5,-5894 525.5,-5894 525.5,-5918"/>
<text text-anchor="middle" x="498.5" y="-5903.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">diis</text>
</g>
<!-- proc~mix_rhog&#45;&gt;diis -->
<g id="proc~~siesta_forces~~CallsGraph_edge165" class="edge"><title>proc~mix_rhog&#45;&gt;diis</title>
<path fill="none" stroke="#000000" d="M356.824,-5906C385.378,-5906 429.934,-5906 461.235,-5906"/>
<polygon fill="#000000" stroke="#000000" points="461.299,-5909.5 471.299,-5906 461.299,-5902.5 461.299,-5909.5"/>
</g>
<!-- proc~compute_max_diff_2d&#45;&gt;die -->
<g id="proc~~siesta_forces~~CallsGraph_edge167" class="edge"><title>proc~compute_max_diff_2d&#45;&gt;die</title>
<path fill="none" stroke="#000000" d="M377.578,-1405.98C381.198,-1403.52 384.431,-1400.56 387,-1397 475.693,-1274.04 329.901,-152.656 423,-33 432.031,-21.3931 446.955,-15.8722 461.084,-13.355"/>
<polygon fill="#000000" stroke="#000000" points="461.689,-16.8053 471.135,-12.0089 460.759,-9.86729 461.689,-16.8053"/>
</g>
<!-- proc~dhscf&#45;&gt;proc~bye -->
<g id="proc~~siesta_forces~~CallsGraph_edge180" class="edge"><title>proc~dhscf&#45;&gt;proc~bye</title>
<path fill="none" stroke="#000000" d="M330.9,-4286.67C338.504,-4237.1 367.29,-4047.52 387,-3891 396.161,-3818.25 387.514,-3627.17 423,-3563 432.611,-3545.62 449.656,-3531.54 465.018,-3521.5"/>
<polygon fill="#000000" stroke="#000000" points="467.142,-3524.3 473.8,-3516.06 463.456,-3518.35 467.142,-3524.3"/>
</g>
<!-- proc~dhscf&#45;&gt;timer -->
<g id="proc~~siesta_forces~~CallsGraph_edge197" class="edge"><title>proc~dhscf&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M329.092,-4286.97C330.144,-4245.03 339.959,-4104.65 423,-4047 478.127,-4008.73 524.537,-4001.64 574,-4047 642.226,-4109.56 547.95,-4393.31 610,-4462 716.552,-4579.96 841.87,-4614.74 964,-4513 1018.26,-4467.8 1029.68,-4236.43 1031.96,-4162.64"/>
<polygon fill="#000000" stroke="#000000" points="1035.47,-4162.3 1032.25,-4152.2 1028.47,-4162.1 1035.47,-4162.3"/>
</g>
<!-- proc~dhscf&#45;&gt;volcel -->
<g id="proc~~siesta_forces~~CallsGraph_edge168" class="edge"><title>proc~dhscf&#45;&gt;volcel</title>
<path fill="none" stroke="#000000" d="M331.236,-4286.7C340.122,-4237.27 373.124,-4048.15 387,-3891 392.036,-3833.96 387.647,-2906.04 423,-2861 432.08,-2849.43 447.012,-2843.92 461.133,-2841.39"/>
<polygon fill="#000000" stroke="#000000" points="461.733,-2844.84 471.176,-2840.04 460.798,-2837.91 461.733,-2844.84"/>
</g>
<!-- proc~dhscf&#45;&gt;re_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge170" class="edge"><title>proc~dhscf&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M330.053,-4311.02C335.511,-4370.23 362.666,-4629.83 423,-4677 475.872,-4718.33 514.269,-4707.6 574,-4677 598.372,-4664.52 585.628,-4639.48 610,-4627 738.756,-4561.05 919.887,-4596.71 996.274,-4616.57"/>
<polygon fill="#000000" stroke="#000000" points="995.776,-4620.06 1006.34,-4619.25 997.58,-4613.3 995.776,-4620.06"/>
</g>
<!-- proc~dhscf&#45;&gt;write_debug -->
<g id="proc~~siesta_forces~~CallsGraph_edge202" class="edge"><title>proc~dhscf&#45;&gt;write_debug</title>
<path fill="none" stroke="#000000" d="M329.81,-4286.75C334.238,-4223.96 357.755,-3939.04 423,-3887 475.468,-3845.15 524.89,-3841.26 574,-3887 656.491,-3963.83 527.509,-4316.17 610,-4393 621.023,-4403.27 814.643,-4404.9 842,-4392 862.079,-4382.53 858.963,-4367.46 877.759,-4350.49"/>
<polygon fill="#000000" stroke="#000000" points="880.088,-4353.11 885.759,-4344.16 875.745,-4347.62 880.088,-4353.11"/>
</g>
<!-- proc~dhscf&#45;&gt;de_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge200" class="edge"><title>proc~dhscf&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M328.831,-4311.26C327.923,-4395.85 326.774,-4892.59 423,-4999 504.871,-5089.53 868.858,-5170.47 964,-5094 1009.42,-5057.49 1026.49,-4870.23 1031.1,-4805.24"/>
<polygon fill="#000000" stroke="#000000" points="1034.59,-4805.46 1031.77,-4795.25 1027.61,-4804.99 1034.59,-4805.46"/>
</g>
<!-- proc~dhscf&#45;&gt;proc~die -->
<g id="proc~~siesta_forces~~CallsGraph_edge183" class="edge"><title>proc~dhscf&#45;&gt;proc~die</title>
<path fill="none" stroke="#000000" d="M330.931,-4286.7C338.311,-4239.67 365.402,-4066.65 387,-3924 403.344,-3816.05 359.05,-3769.49 423,-3681 467.008,-3620.11 530.62,-3666.34 574,-3605 647.207,-3501.48 530.313,-3420.62 610,-3322 645.357,-3278.24 810.228,-3237.21 884.071,-3220.68"/>
<polygon fill="#000000" stroke="#000000" points="884.857,-3224.09 893.864,-3218.51 883.344,-3217.26 884.857,-3224.09"/>
</g>
<!-- elecs -->
<g id="proc~~siesta_forces~~CallsGraph_node142" class="node"><title>elecs</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-4668 471.5,-4668 471.5,-4644 525.5,-4644 525.5,-4668"/>
<text text-anchor="middle" x="498.5" y="-4653.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elecs</text>
</g>
<!-- proc~dhscf&#45;&gt;elecs -->
<g id="proc~~siesta_forces~~CallsGraph_edge174" class="edge"><title>proc~dhscf&#45;&gt;elecs</title>
<path fill="none" stroke="#000000" d="M328.478,-4311.14C327.095,-4359.51 328.649,-4540.46 423,-4635 433.061,-4645.08 447.56,-4650.41 461.099,-4653.2"/>
<polygon fill="#000000" stroke="#000000" points="460.737,-4656.69 471.175,-4654.88 461.884,-4649.78 460.737,-4656.69"/>
</g>
<!-- proc~forhar -->
<g id="proc~~siesta_forces~~CallsGraph_node144" class="node"><title>proc~forhar</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node144"><a xlink:href=".././proc/forhar.html" xlink:title="forhar">
<polygon fill="#d9534f" stroke="#d9534f" points="525.5,-4824 471.5,-4824 471.5,-4800 525.5,-4800 525.5,-4824"/>
<text text-anchor="middle" x="498.5" y="-4809.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">forhar</text>
</a>
</g>
</g>
<!-- proc~dhscf&#45;&gt;proc~forhar -->
<g id="proc~~siesta_forces~~CallsGraph_edge169" class="edge"><title>proc~dhscf&#45;&gt;proc~forhar</title>
<path fill="none" stroke="#000000" d="M329.736,-4311.17C334.075,-4379.13 358.379,-4711.25 423,-4786 432.732,-4797.26 447.62,-4803.64 461.536,-4807.26"/>
<polygon fill="#000000" stroke="#000000" points="460.889,-4810.71 471.409,-4809.44 462.397,-4803.87 460.889,-4810.71"/>
</g>
<!-- ts_voltage -->
<g id="proc~~siesta_forces~~CallsGraph_node145" class="node"><title>ts_voltage</title>
<polygon fill="#777777" stroke="#777777" points="529,-4626 468,-4626 468,-4602 529,-4602 529,-4626"/>
<text text-anchor="middle" x="498.5" y="-4611.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ts_voltage</text>
</g>
<!-- proc~dhscf&#45;&gt;ts_voltage -->
<g id="proc~~siesta_forces~~CallsGraph_edge171" class="edge"><title>proc~dhscf&#45;&gt;ts_voltage</title>
<path fill="none" stroke="#000000" d="M329.044,-4311.15C329.89,-4355.71 338.975,-4511.84 423,-4593 432.381,-4602.06 445.357,-4607.27 457.854,-4610.25"/>
<polygon fill="#000000" stroke="#000000" points="457.207,-4613.69 467.695,-4612.18 458.56,-4606.82 457.207,-4613.69"/>
</g>
<!-- mpi_barrier -->
<g id="proc~~siesta_forces~~CallsGraph_node146" class="node"><title>mpi_barrier</title>
<polygon fill="#777777" stroke="#777777" points="954.5,-4736 887.5,-4736 887.5,-4712 954.5,-4712 954.5,-4736"/>
<text text-anchor="middle" x="921" y="-4721.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_barrier</text>
</g>
<!-- proc~dhscf&#45;&gt;mpi_barrier -->
<g id="proc~~siesta_forces~~CallsGraph_edge172" class="edge"><title>proc~dhscf&#45;&gt;mpi_barrier</title>
<path fill="none" stroke="#000000" d="M328.925,-4311.44C328.743,-4389.19 332.038,-4807.47 423,-4885 470.891,-4925.82 647.302,-4897.68 706,-4875 796.392,-4840.07 794.06,-4789.42 878,-4741 878.187,-4740.89 878.376,-4740.78 878.565,-4740.68"/>
<polygon fill="#000000" stroke="#000000" points="880.166,-4743.79 887.464,-4736.11 876.969,-4737.56 880.166,-4743.79"/>
</g>
<!-- ts_hartree_fix -->
<g id="proc~~siesta_forces~~CallsGraph_node147" class="node"><title>ts_hartree_fix</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-4584 459.5,-4584 459.5,-4560 537.5,-4560 537.5,-4584"/>
<text text-anchor="middle" x="498.5" y="-4569.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ts_hartree_fix</text>
</g>
<!-- proc~dhscf&#45;&gt;ts_hartree_fix -->
<g id="proc~~siesta_forces~~CallsGraph_edge173" class="edge"><title>proc~dhscf&#45;&gt;ts_hartree_fix</title>
<path fill="none" stroke="#000000" d="M329.778,-4311.09C333.044,-4351.47 349.152,-4482.99 423,-4551 430.414,-4557.83 439.878,-4562.46 449.555,-4565.59"/>
<polygon fill="#000000" stroke="#000000" points="448.664,-4568.98 459.234,-4568.25 450.519,-4562.23 448.664,-4568.98"/>
</g>
<!-- ddot -->
<g id="proc~~siesta_forces~~CallsGraph_node148" class="node"><title>ddot</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-4542 471.5,-4542 471.5,-4518 525.5,-4518 525.5,-4542"/>
<text text-anchor="middle" x="498.5" y="-4527.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ddot</text>
</g>
<!-- proc~dhscf&#45;&gt;ddot -->
<g id="proc~~siesta_forces~~CallsGraph_edge175" class="edge"><title>proc~dhscf&#45;&gt;ddot</title>
<path fill="none" stroke="#000000" d="M330.779,-4311.08C336.717,-4346.97 359.212,-4453.91 423,-4509 433.698,-4518.24 448.182,-4523.43 461.536,-4526.34"/>
<polygon fill="#000000" stroke="#000000" points="460.978,-4529.8 471.445,-4528.15 462.237,-4522.91 460.978,-4529.8"/>
</g>
<!-- jms_setmeshdistr -->
<g id="proc~~siesta_forces~~CallsGraph_node149" class="node"><title>jms_setmeshdistr</title>
<polygon fill="#777777" stroke="#777777" points="706,-4866 610,-4866 610,-4842 706,-4842 706,-4866"/>
<text text-anchor="middle" x="658" y="-4851.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jms_setmeshdistr</text>
</g>
<!-- proc~dhscf&#45;&gt;jms_setmeshdistr -->
<g id="proc~~siesta_forces~~CallsGraph_edge176" class="edge"><title>proc~dhscf&#45;&gt;jms_setmeshdistr</title>
<path fill="none" stroke="#000000" d="M329.032,-4311.34C329.512,-4386.64 336.171,-4783.57 423,-4857 476.515,-4902.25 564.156,-4885.16 615.636,-4869.19"/>
<polygon fill="#000000" stroke="#000000" points="616.986,-4872.43 625.428,-4866.03 614.837,-4865.77 616.986,-4872.43"/>
</g>
<!-- mpitrace_restart -->
<g id="proc~~siesta_forces~~CallsGraph_node150" class="node"><title>mpitrace_restart</title>
<polygon fill="#777777" stroke="#777777" points="544,-4500 453,-4500 453,-4476 544,-4476 544,-4500"/>
<text text-anchor="middle" x="498.5" y="-4485.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpitrace_restart</text>
</g>
<!-- proc~dhscf&#45;&gt;mpitrace_restart -->
<g id="proc~~siesta_forces~~CallsGraph_edge177" class="edge"><title>proc~dhscf&#45;&gt;mpitrace_restart</title>
<path fill="none" stroke="#000000" d="M332.3,-4311.3C341.286,-4342.37 369.199,-4424.58 423,-4467 428.876,-4471.63 435.721,-4475.24 442.835,-4478.06"/>
<polygon fill="#000000" stroke="#000000" points="442.043,-4481.49 452.638,-4481.43 444.316,-4474.87 442.043,-4481.49"/>
</g>
<!-- bsc_cellxc -->
<g id="proc~~siesta_forces~~CallsGraph_node151" class="node"><title>bsc_cellxc</title>
<polygon fill="#777777" stroke="#777777" points="688.5,-4824 627.5,-4824 627.5,-4800 688.5,-4800 688.5,-4824"/>
<text text-anchor="middle" x="658" y="-4809.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bsc_cellxc</text>
</g>
<!-- proc~dhscf&#45;&gt;bsc_cellxc -->
<g id="proc~~siesta_forces~~CallsGraph_edge178" class="edge"><title>proc~dhscf&#45;&gt;bsc_cellxc</title>
<path fill="none" stroke="#000000" d="M329.132,-4311.28C330.198,-4384.55 339.722,-4763.1 423,-4833 474.404,-4876.15 507.403,-4841.29 574,-4833 588.34,-4831.21 603.758,-4827.76 617.368,-4824.15"/>
<polygon fill="#000000" stroke="#000000" points="618.664,-4827.43 627.375,-4821.4 616.805,-4820.68 618.664,-4827.43"/>
</g>
<!-- write_grid_netcdf -->
<g id="proc~~siesta_forces~~CallsGraph_node152" class="node"><title>write_grid_netcdf</title>
<polygon fill="#777777" stroke="#777777" points="545.5,-4458 451.5,-4458 451.5,-4434 545.5,-4434 545.5,-4458"/>
<text text-anchor="middle" x="498.5" y="-4443.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_grid_netcdf</text>
</g>
<!-- proc~dhscf&#45;&gt;write_grid_netcdf -->
<g id="proc~~siesta_forces~~CallsGraph_edge179" class="edge"><title>proc~dhscf&#45;&gt;write_grid_netcdf</title>
<path fill="none" stroke="#000000" d="M334.617,-4311.14C346.914,-4336.35 378.696,-4394.54 423,-4425 428.654,-4428.89 435.017,-4432.06 441.581,-4434.65"/>
<polygon fill="#000000" stroke="#000000" points="440.687,-4438.04 451.282,-4438.04 442.995,-4431.43 440.687,-4438.04"/>
</g>
<!-- proc~setmeshdistr -->
<g id="proc~~siesta_forces~~CallsGraph_node154" class="node"><title>proc~setmeshdistr</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node154"><a xlink:href=".././proc/setmeshdistr.html" xlink:title="setMeshDistr">
<polygon fill="#d9534f" stroke="#d9534f" points="695.5,-4702 620.5,-4702 620.5,-4678 695.5,-4678 695.5,-4702"/>
<text text-anchor="middle" x="658" y="-4687.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setMeshDistr</text>
</a>
</g>
</g>
<!-- proc~dhscf&#45;&gt;proc~setmeshdistr -->
<g id="proc~~siesta_forces~~CallsGraph_edge181" class="edge"><title>proc~dhscf&#45;&gt;proc~setmeshdistr</title>
<path fill="none" stroke="#000000" d="M329.629,-4311.14C333.263,-4376.05 353.891,-4681.15 423,-4737 475.197,-4779.18 509.215,-4754.51 574,-4737 591.881,-4732.17 593.895,-4725.15 610,-4716 615.194,-4713.05 620.732,-4709.95 626.116,-4706.95"/>
<polygon fill="#000000" stroke="#000000" points="627.891,-4709.97 634.944,-4702.07 624.5,-4703.85 627.891,-4709.97"/>
</g>
<!-- rhoofdsp -->
<g id="proc~~siesta_forces~~CallsGraph_node158" class="node"><title>rhoofdsp</title>
<polygon fill="#777777" stroke="#777777" points="526,-4416 471,-4416 471,-4392 526,-4392 526,-4416"/>
<text text-anchor="middle" x="498.5" y="-4401.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rhoofdsp</text>
</g>
<!-- proc~dhscf&#45;&gt;rhoofdsp -->
<g id="proc~~siesta_forces~~CallsGraph_edge182" class="edge"><title>proc~dhscf&#45;&gt;rhoofdsp</title>
<path fill="none" stroke="#000000" d="M339.269,-4311.19C355.303,-4329.46 388.082,-4363.83 423,-4383 434.712,-4389.43 448.564,-4394.03 461.126,-4397.26"/>
<polygon fill="#000000" stroke="#000000" points="460.323,-4400.66 470.86,-4399.56 461.933,-4393.85 460.323,-4400.66"/>
</g>
<!-- get_field_from_dipole -->
<g id="proc~~siesta_forces~~CallsGraph_node159" class="node"><title>get_field_from_dipole</title>
<polygon fill="#777777" stroke="#777777" points="556,-4374 441,-4374 441,-4350 556,-4350 556,-4374"/>
<text text-anchor="middle" x="498.5" y="-4359.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_field_from_dipole</text>
</g>
<!-- proc~dhscf&#45;&gt;get_field_from_dipole -->
<g id="proc~~siesta_forces~~CallsGraph_edge184" class="edge"><title>proc~dhscf&#45;&gt;get_field_from_dipole</title>
<path fill="none" stroke="#000000" d="M353.337,-4311.05C372.082,-4320.04 398.799,-4332.24 423,-4341 428.804,-4343.1 434.924,-4345.13 441.06,-4347.03"/>
<polygon fill="#000000" stroke="#000000" points="440.087,-4350.39 450.671,-4349.92 442.104,-4343.69 440.087,-4350.39"/>
</g>
<!-- vmatsp -->
<g id="proc~~siesta_forces~~CallsGraph_node160" class="node"><title>vmatsp</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-4332 471.5,-4332 471.5,-4308 525.5,-4308 525.5,-4332"/>
<text text-anchor="middle" x="498.5" y="-4317.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">vmatsp</text>
</g>
<!-- proc~dhscf&#45;&gt;vmatsp -->
<g id="proc~~siesta_forces~~CallsGraph_edge185" class="edge"><title>proc~dhscf&#45;&gt;vmatsp</title>
<path fill="none" stroke="#000000" d="M355.328,-4302.28C383.769,-4305.83 429.277,-4311.5 461.124,-4315.47"/>
<polygon fill="#000000" stroke="#000000" points="461.001,-4318.98 471.357,-4316.74 461.866,-4312.03 461.001,-4318.98"/>
</g>
<!-- add_potential_from_field -->
<g id="proc~~siesta_forces~~CallsGraph_node161" class="node"><title>add_potential_from_field</title>
<polygon fill="#777777" stroke="#777777" points="563.5,-4290 433.5,-4290 433.5,-4266 563.5,-4266 563.5,-4290"/>
<text text-anchor="middle" x="498.5" y="-4275.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">add_potential_from_field</text>
</g>
<!-- proc~dhscf&#45;&gt;add_potential_from_field -->
<g id="proc~~siesta_forces~~CallsGraph_edge186" class="edge"><title>proc~dhscf&#45;&gt;add_potential_from_field</title>
<path fill="none" stroke="#000000" d="M355.328,-4295.72C373.632,-4293.44 399.006,-4290.28 423.258,-4287.25"/>
<polygon fill="#000000" stroke="#000000" points="423.706,-4290.72 433.196,-4286.01 422.84,-4283.78 423.706,-4290.72"/>
</g>
<!-- hartree_add -->
<g id="proc~~siesta_forces~~CallsGraph_node162" class="node"><title>hartree_add</title>
<polygon fill="#777777" stroke="#777777" points="534,-4248 463,-4248 463,-4224 534,-4224 534,-4248"/>
<text text-anchor="middle" x="498.5" y="-4233.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hartree_add</text>
</g>
<!-- proc~dhscf&#45;&gt;hartree_add -->
<g id="proc~~siesta_forces~~CallsGraph_edge187" class="edge"><title>proc~dhscf&#45;&gt;hartree_add</title>
<path fill="none" stroke="#000000" d="M353.337,-4286.95C372.082,-4277.96 398.799,-4265.76 423,-4257 432.571,-4253.53 443.001,-4250.28 452.943,-4247.42"/>
<polygon fill="#000000" stroke="#000000" points="453.989,-4250.76 462.673,-4244.69 452.1,-4244.02 453.989,-4250.76"/>
</g>
<!-- proc~dfscf -->
<g id="proc~~siesta_forces~~CallsGraph_node163" class="node"><title>proc~dfscf</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node163"><a xlink:href=".././proc/dfscf.html" xlink:title="dfscf">
<polygon fill="#d9534f" stroke="#d9534f" points="525.5,-3756 471.5,-3756 471.5,-3732 525.5,-3732 525.5,-3756"/>
<text text-anchor="middle" x="498.5" y="-3741.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dfscf</text>
</a>
</g>
</g>
<!-- proc~dhscf&#45;&gt;proc~dfscf -->
<g id="proc~~siesta_forces~~CallsGraph_edge188" class="edge"><title>proc~dhscf&#45;&gt;proc~dfscf</title>
<path fill="none" stroke="#000000" d="M330.767,-4286.84C342.097,-4209.19 404.651,-3785.29 423,-3765 432.696,-3754.28 447.399,-3748.86 461.188,-3746.18"/>
<polygon fill="#000000" stroke="#000000" points="462.095,-3749.58 471.457,-3744.62 461.046,-3742.66 462.095,-3749.58"/>
</g>
<!-- proc~reord -->
<g id="proc~~siesta_forces~~CallsGraph_node164" class="node"><title>proc~reord</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node164"><a xlink:href=".././proc/reord.html" xlink:title="reord">
<polygon fill="#d9534f" stroke="#d9534f" points="948,-4976 894,-4976 894,-4952 948,-4952 948,-4976"/>
<text text-anchor="middle" x="921" y="-4961.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reord</text>
</a>
</g>
</g>
<!-- proc~dhscf&#45;&gt;proc~reord -->
<g id="proc~~siesta_forces~~CallsGraph_edge189" class="edge"><title>proc~dhscf&#45;&gt;proc~reord</title>
<path fill="none" stroke="#000000" d="M329.759,-4311.17C335.31,-4398.25 370.909,-4924.7 423,-4970 491.301,-5029.4 781.44,-4987.41 883.948,-4970.32"/>
<polygon fill="#000000" stroke="#000000" points="884.551,-4973.77 893.829,-4968.65 883.386,-4966.87 884.551,-4973.77"/>
</g>
<!-- compute_partial_charges -->
<g id="proc~~siesta_forces~~CallsGraph_node165" class="node"><title>compute_partial_charges</title>
<polygon fill="#777777" stroke="#777777" points="565,-4206 432,-4206 432,-4182 565,-4182 565,-4206"/>
<text text-anchor="middle" x="498.5" y="-4191.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_partial_charges</text>
</g>
<!-- proc~dhscf&#45;&gt;compute_partial_charges -->
<g id="proc~~siesta_forces~~CallsGraph_edge190" class="edge"><title>proc~dhscf&#45;&gt;compute_partial_charges</title>
<path fill="none" stroke="#000000" d="M339.269,-4286.81C355.303,-4268.54 388.082,-4234.17 423,-4215 426.479,-4213.09 430.146,-4211.34 433.913,-4209.74"/>
<polygon fill="#000000" stroke="#000000" points="435.36,-4212.94 443.428,-4206.07 432.838,-4206.41 435.36,-4212.94"/>
</g>
<!-- write_tdrho -->
<g id="proc~~siesta_forces~~CallsGraph_node166" class="node"><title>write_tdrho</title>
<polygon fill="#777777" stroke="#777777" points="531.5,-4164 465.5,-4164 465.5,-4140 531.5,-4140 531.5,-4164"/>
<text text-anchor="middle" x="498.5" y="-4149.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_tdrho</text>
</g>
<!-- proc~dhscf&#45;&gt;write_tdrho -->
<g id="proc~~siesta_forces~~CallsGraph_edge191" class="edge"><title>proc~dhscf&#45;&gt;write_tdrho</title>
<path fill="none" stroke="#000000" d="M334.617,-4286.86C346.914,-4261.65 378.696,-4203.46 423,-4173 432.678,-4166.35 444.431,-4161.79 455.715,-4158.67"/>
<polygon fill="#000000" stroke="#000000" points="456.566,-4162.06 465.445,-4156.28 454.899,-4155.27 456.566,-4162.06"/>
</g>
<!-- partialcoreonmesh -->
<g id="proc~~siesta_forces~~CallsGraph_node167" class="node"><title>partialcoreonmesh</title>
<polygon fill="#777777" stroke="#777777" points="549,-4122 448,-4122 448,-4098 549,-4098 549,-4122"/>
<text text-anchor="middle" x="498.5" y="-4107.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">partialcoreonmesh</text>
</g>
<!-- proc~dhscf&#45;&gt;partialcoreonmesh -->
<g id="proc~~siesta_forces~~CallsGraph_edge192" class="edge"><title>proc~dhscf&#45;&gt;partialcoreonmesh</title>
<path fill="none" stroke="#000000" d="M332.3,-4286.7C341.286,-4255.63 369.199,-4173.42 423,-4131 427.664,-4127.32 432.939,-4124.29 438.474,-4121.79"/>
<polygon fill="#000000" stroke="#000000" points="439.945,-4124.97 447.974,-4118.06 437.387,-4118.45 439.945,-4124.97"/>
</g>
<!-- mymeshbox -->
<g id="proc~~siesta_forces~~CallsGraph_node168" class="node"><title>mymeshbox</title>
<polygon fill="#777777" stroke="#777777" points="693,-4660 623,-4660 623,-4636 693,-4636 693,-4660"/>
<text text-anchor="middle" x="658" y="-4645.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mymeshbox</text>
</g>
<!-- proc~dhscf&#45;&gt;mymeshbox -->
<g id="proc~~siesta_forces~~CallsGraph_edge193" class="edge"><title>proc~dhscf&#45;&gt;mymeshbox</title>
<path fill="none" stroke="#000000" d="M329.815,-4311.22C334.268,-4373.86 357.892,-4658.1 423,-4710 475.479,-4751.83 512.863,-4737.68 574,-4710 596.091,-4700 590.48,-4683.39 610,-4669 611.812,-4667.66 613.722,-4666.39 615.694,-4665.17"/>
<polygon fill="#000000" stroke="#000000" points="617.562,-4668.14 624.619,-4660.24 614.174,-4662.01 617.562,-4668.14"/>
</g>
<!-- neutralatomonmesh -->
<g id="proc~~siesta_forces~~CallsGraph_node169" class="node"><title>neutralatomonmesh</title>
<polygon fill="#777777" stroke="#777777" points="552.5,-4080 444.5,-4080 444.5,-4056 552.5,-4056 552.5,-4080"/>
<text text-anchor="middle" x="498.5" y="-4065.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">neutralatomonmesh</text>
</g>
<!-- proc~dhscf&#45;&gt;neutralatomonmesh -->
<g id="proc~~siesta_forces~~CallsGraph_edge194" class="edge"><title>proc~dhscf&#45;&gt;neutralatomonmesh</title>
<path fill="none" stroke="#000000" d="M330.779,-4286.92C336.717,-4251.03 359.212,-4144.09 423,-4089 426.684,-4085.82 430.816,-4083.12 435.197,-4080.82"/>
<polygon fill="#000000" stroke="#000000" points="436.78,-4083.95 444.473,-4076.67 433.916,-4077.56 436.78,-4083.95"/>
</g>
<!-- interface~distmeshdata -->
<g id="proc~~siesta_forces~~CallsGraph_node170" class="node"><title>interface~distmeshdata</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node170"><a xlink:href=".././interface/distmeshdata.html" xlink:title="distMeshData">
<polygon fill="#a7506f" stroke="#a7506f" points="697,-4946 619,-4946 619,-4922 697,-4922 697,-4946"/>
<text text-anchor="middle" x="658" y="-4931.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">distMeshData</text>
</a>
</g>
</g>
<!-- proc~dhscf&#45;&gt;interface~distmeshdata -->
<g id="proc~~siesta_forces~~CallsGraph_edge195" class="edge"><title>proc~dhscf&#45;&gt;interface~distmeshdata</title>
<path fill="none" stroke="#000000" d="M328.742,-4311.03C327.281,-4391.92 323.354,-4855.86 423,-4942 477.056,-4988.73 567.204,-4967.51 618.393,-4949.63"/>
<polygon fill="#000000" stroke="#000000" points="619.878,-4952.81 628.089,-4946.12 617.495,-4946.23 619.878,-4952.81"/>
</g>
<!-- proc~vmat -->
<g id="proc~~siesta_forces~~CallsGraph_node171" class="node"><title>proc~vmat</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node171"><a xlink:href=".././proc/vmat.html" xlink:title="vmat">
<polygon fill="#d9534f" stroke="#d9534f" points="525.5,-3714 471.5,-3714 471.5,-3690 525.5,-3690 525.5,-3714"/>
<text text-anchor="middle" x="498.5" y="-3699.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">vmat</text>
</a>
</g>
</g>
<!-- proc~dhscf&#45;&gt;proc~vmat -->
<g id="proc~~siesta_forces~~CallsGraph_edge196" class="edge"><title>proc~dhscf&#45;&gt;proc~vmat</title>
<path fill="none" stroke="#000000" d="M330.895,-4286.83C343.773,-4204.19 418.07,-3728.52 423,-3723 432.629,-3712.22 447.321,-3706.79 461.121,-3704.12"/>
<polygon fill="#000000" stroke="#000000" points="462.033,-3707.52 471.401,-3702.57 460.991,-3700.6 462.033,-3707.52"/>
</g>
<!-- mpi_allreduce -->
<g id="proc~~siesta_forces~~CallsGraph_node173" class="node"><title>mpi_allreduce</title>
<polygon fill="#777777" stroke="#777777" points="538,-3962 459,-3962 459,-3938 538,-3938 538,-3962"/>
<text text-anchor="middle" x="498.5" y="-3947.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_allreduce</text>
</g>
<!-- proc~dhscf&#45;&gt;mpi_allreduce -->
<g id="proc~~siesta_forces~~CallsGraph_edge198" class="edge"><title>proc~dhscf&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M328.807,-4286.85C328.734,-4239.98 334.767,-4069 423,-3976 430.072,-3968.55 439.394,-3963.23 449.041,-3959.43"/>
<polygon fill="#000000" stroke="#000000" points="450.394,-3962.67 458.726,-3956.13 448.131,-3956.05 450.394,-3962.67"/>
</g>
<!-- vacuum_level -->
<g id="proc~~siesta_forces~~CallsGraph_node174" class="node"><title>vacuum_level</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-3920 459.5,-3920 459.5,-3896 537.5,-3896 537.5,-3920"/>
<text text-anchor="middle" x="498.5" y="-3905.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">vacuum_level</text>
</g>
<!-- proc~dhscf&#45;&gt;vacuum_level -->
<g id="proc~~siesta_forces~~CallsGraph_edge199" class="edge"><title>proc~dhscf&#45;&gt;vacuum_level</title>
<path fill="none" stroke="#000000" d="M330.464,-4286.77C337.638,-4228.84 370.85,-3982.52 423,-3929 430.174,-3921.64 439.713,-3916.8 449.563,-3913.64"/>
<polygon fill="#000000" stroke="#000000" points="450.683,-3916.96 459.441,-3911 448.877,-3910.2 450.683,-3916.96"/>
</g>
<!-- localchargeonmesh -->
<g id="proc~~siesta_forces~~CallsGraph_node175" class="node"><title>localchargeonmesh</title>
<polygon fill="#777777" stroke="#777777" points="551.5,-3840 445.5,-3840 445.5,-3816 551.5,-3816 551.5,-3840"/>
<text text-anchor="middle" x="498.5" y="-3825.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">localchargeonmesh</text>
</g>
<!-- proc~dhscf&#45;&gt;localchargeonmesh -->
<g id="proc~~siesta_forces~~CallsGraph_edge201" class="edge"><title>proc~dhscf&#45;&gt;localchargeonmesh</title>
<path fill="none" stroke="#000000" d="M329.993,-4286.62C335.43,-4221.76 363.537,-3921.58 423,-3854 426.733,-3849.76 431.197,-3846.21 436.06,-3843.24"/>
<polygon fill="#000000" stroke="#000000" points="437.92,-3846.21 445.172,-3838.49 434.686,-3840.01 437.92,-3846.21"/>
</g>
<!-- proc~rhoofd -->
<g id="proc~~siesta_forces~~CallsGraph_node176" class="node"><title>proc~rhoofd</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node176"><a xlink:href=".././proc/rhoofd.html" xlink:title="rhoofd">
<polygon fill="#d9534f" stroke="#d9534f" points="525.5,-3798 471.5,-3798 471.5,-3774 525.5,-3774 525.5,-3798"/>
<text text-anchor="middle" x="498.5" y="-3783.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rhoofd</text>
</a>
</g>
</g>
<!-- proc~dhscf&#45;&gt;proc~rhoofd -->
<g id="proc~~siesta_forces~~CallsGraph_edge203" class="edge"><title>proc~dhscf&#45;&gt;proc~rhoofd</title>
<path fill="none" stroke="#000000" d="M330.543,-4286.9C339.832,-4214.83 389.048,-3844 423,-3807 432.701,-3796.43 447.271,-3791.02 460.96,-3788.31"/>
<polygon fill="#000000" stroke="#000000" points="461.819,-3791.72 471.162,-3786.72 460.742,-3784.8 461.819,-3791.72"/>
</g>
<!-- proc~write_rho -->
<g id="proc~~siesta_forces~~CallsGraph_node177" class="node"><title>proc~write_rho</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node177"><a xlink:href=".././proc/write_rho.html" xlink:title="write_rho">
<polygon fill="#d9534f" stroke="#d9534f" points="820.5,-4469 763.5,-4469 763.5,-4445 820.5,-4445 820.5,-4469"/>
<text text-anchor="middle" x="792" y="-4454.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_rho</text>
</a>
</g>
</g>
<!-- proc~dhscf&#45;&gt;proc~write_rho -->
<g id="proc~~siesta_forces~~CallsGraph_edge204" class="edge"><title>proc~dhscf&#45;&gt;proc~write_rho</title>
<path fill="none" stroke="#000000" d="M328.522,-4286.74C327.497,-4241.16 330.753,-4080.71 423,-4014 477.381,-3974.67 524.547,-3968.63 574,-4014 642.539,-4076.88 546.117,-4363.4 610,-4431 646.282,-4469.39 711.869,-4468.86 753.336,-4463.78"/>
<polygon fill="#000000" stroke="#000000" points="753.893,-4467.24 763.326,-4462.42 752.944,-4460.31 753.893,-4467.24"/>
</g>
<!-- proc~mixers_history_init&#45;&gt;delete -->
<g id="proc~~siesta_forces~~CallsGraph_edge207" class="edge"><title>proc~mixers_history_init&#45;&gt;delete</title>
<path fill="none" stroke="#000000" d="M549.09,-59.3203C558.553,-62.527 567.514,-67.4618 574,-75 658.885,-173.661 658.668,-609.739 657.376,-713.696"/>
<polygon fill="#000000" stroke="#000000" points="653.872,-713.903 657.23,-723.951 660.872,-714.002 653.872,-713.903"/>
</g>
<!-- proc~current_itt -->
<g id="proc~~siesta_forces~~CallsGraph_node156" class="node"><title>proc~current_itt</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node156"><a xlink:href=".././proc/current_itt.html" xlink:title="current_itt">
<polygon fill="#d94e8f" stroke="#d94e8f" points="688.5,-87 627.5,-87 627.5,-63 688.5,-63 688.5,-87"/>
<text text-anchor="middle" x="658" y="-72.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">current_itt</text>
</a>
</g>
</g>
<!-- proc~mixers_history_init&#45;&gt;proc~current_itt -->
<g id="proc~~siesta_forces~~CallsGraph_edge206" class="edge"><title>proc~mixers_history_init&#45;&gt;proc~current_itt</title>
<path fill="none" stroke="#000000" d="M549.334,-60.6445C571.229,-63.5639 596.588,-66.9451 617.193,-69.6924"/>
<polygon fill="#000000" stroke="#000000" points="616.815,-73.1729 627.19,-71.0254 617.741,-66.2344 616.815,-73.1729"/>
</g>
<!-- new -->
<g id="proc~~siesta_forces~~CallsGraph_node157" class="node"><title>new</title>
<polygon fill="#777777" stroke="#777777" points="685,-45 631,-45 631,-21 685,-21 685,-45"/>
<text text-anchor="middle" x="658" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">new</text>
</g>
<!-- proc~mixers_history_init&#45;&gt;new -->
<g id="proc~~siesta_forces~~CallsGraph_edge205" class="edge"><title>proc~mixers_history_init&#45;&gt;new</title>
<path fill="none" stroke="#000000" d="M549.334,-47.3555C572.463,-44.2716 599.457,-40.6725 620.629,-37.8495"/>
<polygon fill="#000000" stroke="#000000" points="621.366,-41.2823 630.815,-36.4913 620.44,-34.3437 621.366,-41.2823"/>
</g>
<!-- proc~compute_max_diff_1d&#45;&gt;die -->
<g id="proc~~siesta_forces~~CallsGraph_edge208" class="edge"><title>proc~compute_max_diff_1d&#45;&gt;die</title>
<path fill="none" stroke="#000000" d="M377.575,-1363.98C381.195,-1361.52 384.43,-1358.56 387,-1355 473.014,-1235.86 332.717,-148.937 423,-33 432.036,-21.3969 446.961,-15.8765 461.089,-13.3587"/>
<polygon fill="#000000" stroke="#000000" points="461.693,-16.8091 471.139,-12.012 460.763,-9.87113 461.693,-16.8091"/>
</g>
<!-- proc~check_cohp&#45;&gt;proc~message -->
<g id="proc~~siesta_forces~~CallsGraph_edge209" class="edge"><title>proc~check_cohp&#45;&gt;proc~message</title>
<path fill="none" stroke="#000000" d="M797.548,-1567.13C806.653,-1591.64 827.487,-1648.93 842,-1698 873.865,-1805.74 903.83,-1936.89 915.193,-1988.07"/>
<polygon fill="#000000" stroke="#000000" points="911.813,-1988.99 917.387,-1998 918.648,-1987.48 911.813,-1988.99"/>
</g>
<!-- proc~die&#45;&gt;pxfflush -->
<g id="proc~~siesta_forces~~CallsGraph_edge215" class="edge"><title>proc~die&#45;&gt;pxfflush</title>
<path fill="none" stroke="#000000" d="M923.13,-3200.7C933.768,-3084.89 1016.27,-2186.74 1030.43,-2032.51"/>
<polygon fill="#000000" stroke="#000000" points="1033.94,-2032.63 1031.37,-2022.35 1026.97,-2031.99 1033.94,-2032.63"/>
</g>
<!-- proc~die&#45;&gt;cmlfinishfile -->
<g id="proc~~siesta_forces~~CallsGraph_edge211" class="edge"><title>proc~die&#45;&gt;cmlfinishfile</title>
<path fill="none" stroke="#000000" d="M929.947,-3200.85C948.663,-3172.22 995.686,-3100.3 1018.98,-3064.67"/>
<polygon fill="#000000" stroke="#000000" points="1022.08,-3066.33 1024.63,-3056.04 1016.22,-3062.5 1022.08,-3066.33"/>
</g>
<!-- mpi_abort -->
<g id="proc~~siesta_forces~~CallsGraph_node143" class="node"><title>mpi_abort</title>
<polygon fill="#777777" stroke="#777777" points="1064,-3246 1003,-3246 1003,-3222 1064,-3222 1064,-3246"/>
<text text-anchor="middle" x="1033.5" y="-3231.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_abort</text>
</g>
<!-- proc~die&#45;&gt;mpi_abort -->
<g id="proc~~siesta_forces~~CallsGraph_edge214" class="edge"><title>proc~die&#45;&gt;mpi_abort</title>
<path fill="none" stroke="#000000" d="M948.187,-3217.98C961.565,-3220.52 978.122,-3223.67 993.012,-3226.5"/>
<polygon fill="#000000" stroke="#000000" points="992.517,-3229.96 1002.99,-3228.39 993.824,-3223.09 992.517,-3229.96"/>
</g>
<!-- io_close -->
<g id="proc~~siesta_forces~~CallsGraph_node153" class="node"><title>io_close</title>
<polygon fill="#777777" stroke="#777777" points="1060.5,-3204 1006.5,-3204 1006.5,-3180 1060.5,-3180 1060.5,-3204"/>
<text text-anchor="middle" x="1033.5" y="-3189.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">io_close</text>
</g>
<!-- proc~die&#45;&gt;io_close -->
<g id="proc~~siesta_forces~~CallsGraph_edge210" class="edge"><title>proc~die&#45;&gt;io_close</title>
<path fill="none" stroke="#000000" d="M948.187,-3208.02C962.532,-3205.3 980.53,-3201.88 996.211,-3198.9"/>
<polygon fill="#000000" stroke="#000000" points="996.947,-3202.32 1006.12,-3197.01 995.64,-3195.44 996.947,-3202.32"/>
</g>
<!-- io_assign -->
<g id="proc~~siesta_forces~~CallsGraph_node155" class="node"><title>io_assign</title>
<polygon fill="#777777" stroke="#777777" points="1062.5,-3162 1004.5,-3162 1004.5,-3138 1062.5,-3138 1062.5,-3162"/>
<text text-anchor="middle" x="1033.5" y="-3147.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">io_assign</text>
</g>
<!-- proc~die&#45;&gt;io_assign -->
<g id="proc~~siesta_forces~~CallsGraph_edge212" class="edge"><title>proc~die&#45;&gt;io_assign</title>
<path fill="none" stroke="#000000" d="M943.306,-3200.85C960.121,-3191.27 983.785,-3177.77 1002.51,-3167.1"/>
<polygon fill="#000000" stroke="#000000" points="1004.31,-3170.1 1011.26,-3162.11 1000.84,-3164.02 1004.31,-3170.1"/>
</g>
<!-- pxfabort -->
<g id="proc~~siesta_forces~~CallsGraph_node172" class="node"><title>pxfabort</title>
<polygon fill="#777777" stroke="#777777" points="1060.5,-3288 1006.5,-3288 1006.5,-3264 1060.5,-3264 1060.5,-3288"/>
<text text-anchor="middle" x="1033.5" y="-3273.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pxfabort</text>
</g>
<!-- proc~die&#45;&gt;pxfabort -->
<g id="proc~~siesta_forces~~CallsGraph_edge213" class="edge"><title>proc~die&#45;&gt;pxfabort</title>
<path fill="none" stroke="#000000" d="M943.306,-3225.15C960.121,-3234.73 983.785,-3248.23 1002.51,-3258.9"/>
<polygon fill="#000000" stroke="#000000" points="1000.84,-3261.98 1011.26,-3263.89 1004.31,-3255.9 1000.84,-3261.98"/>
</g>
<!-- proc~message&#45;&gt;pxfflush -->
<g id="proc~~siesta_forces~~CallsGraph_edge217" class="edge"><title>proc~message&#45;&gt;pxfflush</title>
<path fill="none" stroke="#000000" d="M949.031,-2010C963.152,-2010 980.634,-2010 995.944,-2010"/>
<polygon fill="#000000" stroke="#000000" points="996.129,-2013.5 1006.13,-2010 996.129,-2006.5 996.129,-2013.5"/>
</g>
<!-- proc~message&#45;&gt;io_close -->
<g id="proc~~siesta_forces~~CallsGraph_edge218" class="edge"><title>proc~message&#45;&gt;io_close</title>
<path fill="none" stroke="#000000" d="M923.987,-2022.24C930.82,-2064.85 953.505,-2210.68 964,-2332 972.042,-2424.96 953.637,-3090.03 1000,-3171 1000.24,-3171.42 1000.5,-3171.84 1000.76,-3172.25"/>
<polygon fill="#000000" stroke="#000000" points="998.377,-3174.82 1007.72,-3179.81 1003.53,-3170.08 998.377,-3174.82"/>
</g>
<!-- proc~message&#45;&gt;io_assign -->
<g id="proc~~siesta_forces~~CallsGraph_edge216" class="edge"><title>proc~message&#45;&gt;io_assign</title>
<path fill="none" stroke="#000000" d="M923.96,-2022.24C930.703,-2064.86 953.129,-2210.71 964,-2332 993.117,-2656.87 932.92,-2745.8 1000,-3065 1004.71,-3087.41 1014.5,-3111.68 1022.11,-3128.53"/>
<polygon fill="#000000" stroke="#000000" points="1019.12,-3130.39 1026.51,-3137.98 1025.46,-3127.44 1019.12,-3130.39"/>
</g>
<!-- proc~forhar&#45;&gt;re_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge221" class="edge"><title>proc~forhar&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M515.937,-4799.9C536.861,-4784.97 574.56,-4759.66 610,-4744 681.155,-4712.57 908.043,-4656.74 996.605,-4635.51"/>
<polygon fill="#000000" stroke="#000000" points="997.544,-4638.89 1006.46,-4633.16 995.916,-4632.08 997.544,-4638.89"/>
</g>
<!-- proc~forhar&#45;&gt;de_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge223" class="edge"><title>proc~forhar&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M525.67,-4803.42C599.244,-4779.48 807.157,-4713 878,-4703 915.847,-4697.66 929.279,-4687.02 964,-4703 990.264,-4715.09 1010.22,-4742.77 1021.64,-4762.16"/>
<polygon fill="#000000" stroke="#000000" points="1018.6,-4763.9 1026.55,-4770.91 1024.7,-4760.48 1018.6,-4763.9"/>
</g>
<!-- proc~forhar&#45;&gt;jms_setmeshdistr -->
<g id="proc~~siesta_forces~~CallsGraph_edge224" class="edge"><title>proc~forhar&#45;&gt;jms_setmeshdistr</title>
<path fill="none" stroke="#000000" d="M525.508,-4818.94C546.271,-4824.47 576.087,-4832.42 602.08,-4839.35"/>
<polygon fill="#000000" stroke="#000000" points="601.263,-4842.76 611.827,-4841.95 603.067,-4836 601.263,-4842.76"/>
</g>
<!-- proc~forhar&#45;&gt;bsc_cellxc -->
<g id="proc~~siesta_forces~~CallsGraph_edge225" class="edge"><title>proc~forhar&#45;&gt;bsc_cellxc</title>
<path fill="none" stroke="#000000" d="M525.508,-4812C550.487,-4812 588.568,-4812 617.331,-4812"/>
<polygon fill="#000000" stroke="#000000" points="617.465,-4815.5 627.465,-4812 617.465,-4808.5 617.465,-4815.5"/>
</g>
<!-- proc~forhar&#45;&gt;proc~setmeshdistr -->
<g id="proc~~siesta_forces~~CallsGraph_edge220" class="edge"><title>proc~forhar&#45;&gt;proc~setmeshdistr</title>
<path fill="none" stroke="#000000" d="M525.755,-4807.88C541.268,-4804.31 560.458,-4797.78 574,-4786 600.398,-4763.04 585.64,-4741.11 610,-4716 612.995,-4712.91 616.437,-4710.09 620.066,-4707.55"/>
<polygon fill="#000000" stroke="#000000" points="622.143,-4710.38 628.757,-4702.1 618.425,-4704.45 622.143,-4710.38"/>
</g>
<!-- proc~forhar&#45;&gt;mymeshbox -->
<g id="proc~~siesta_forces~~CallsGraph_edge219" class="edge"><title>proc~forhar&#45;&gt;mymeshbox</title>
<path fill="none" stroke="#000000" d="M517.726,-4799.84C534.162,-4788.14 558.125,-4769.13 574,-4748 597.176,-4717.15 582.616,-4696.18 610,-4669 611.265,-4667.74 612.617,-4666.56 614.037,-4665.44"/>
<polygon fill="#000000" stroke="#000000" points="616.319,-4668.12 622.747,-4659.7 612.47,-4662.28 616.319,-4668.12"/>
</g>
<!-- proc~forhar&#45;&gt;interface~distmeshdata -->
<g id="proc~~siesta_forces~~CallsGraph_edge222" class="edge"><title>proc~forhar&#45;&gt;interface~distmeshdata</title>
<path fill="none" stroke="#000000" d="M515.178,-4824.14C542.891,-4845.61 600.678,-4890.37 633.287,-4915.63"/>
<polygon fill="#000000" stroke="#000000" points="631.337,-4918.55 641.386,-4921.91 635.624,-4913.01 631.337,-4918.55"/>
</g>
<!-- proc~dfscf&#45;&gt;timer -->
<g id="proc~~siesta_forces~~CallsGraph_edge232" class="edge"><title>proc~dfscf&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M525.692,-3745.26C541.575,-3747.36 561.183,-3752.54 574,-3765 612.409,-3802.32 570.674,-3843.64 610,-3880 669.257,-3934.78 903.071,-3908.08 964,-3961 1011.33,-4002.11 1026.1,-4079.66 1030.59,-4117.75"/>
<polygon fill="#000000" stroke="#000000" points="1027.12,-4118.22 1031.65,-4127.8 1034.09,-4117.49 1027.12,-4118.22"/>
</g>
<!-- proc~dfscf&#45;&gt;re_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge229" class="edge"><title>proc~dfscf&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M525.649,-3744.53C541.931,-3746.31 561.992,-3751.4 574,-3765 644.524,-3844.86 543.646,-3918.64 610,-4002 638.579,-4037.9 666.328,-4016.94 706,-4040 833.1,-4113.88 888.859,-4120.64 964,-4247 1000.67,-4308.66 1023.91,-4532.87 1030.54,-4604.7"/>
<polygon fill="#000000" stroke="#000000" points="1027.07,-4605.23 1031.46,-4614.87 1034.04,-4604.59 1027.07,-4605.23"/>
</g>
<!-- proc~dfscf&#45;&gt;de_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge237" class="edge"><title>proc~dfscf&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M525.822,-3744.38C542.175,-3746.09 562.25,-3751.18 574,-3765 665.84,-3873.03 523.795,-3969.42 610,-4082 637.898,-4118.43 666.154,-4097.24 706,-4120 723.601,-4130.05 725.482,-4136.25 742,-4148 837.837,-4216.16 902.722,-4191.62 964,-4292 1005.43,-4359.87 986.664,-4569.61 1000,-4648 1006.86,-4688.31 1018.9,-4734.47 1026.24,-4761.03"/>
<polygon fill="#000000" stroke="#000000" points="1022.92,-4762.14 1028.98,-4770.83 1029.66,-4760.26 1022.92,-4762.14"/>
</g>
<!-- proc~dfscf&#45;&gt;proc~die -->
<g id="proc~~siesta_forces~~CallsGraph_edge240" class="edge"><title>proc~dfscf&#45;&gt;proc~die</title>
<path fill="none" stroke="#000000" d="M525.849,-3749.94C575.047,-3760.38 678.402,-3778.99 706,-3758 753.715,-3721.7 722.139,-3684.57 742,-3628 796.136,-3473.82 880.121,-3295.58 909.458,-3234.68"/>
<polygon fill="#000000" stroke="#000000" points="912.783,-3235.85 913.984,-3225.32 906.481,-3232.8 912.783,-3235.85"/>
</g>
<!-- indxuo -->
<g id="proc~~siesta_forces~~CallsGraph_node180" class="node"><title>indxuo</title>
<polygon fill="#777777" stroke="#777777" points="685,-3993 631,-3993 631,-3969 685,-3969 685,-3993"/>
<text text-anchor="middle" x="658" y="-3978.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">indxuo</text>
</g>
<!-- proc~dfscf&#45;&gt;indxuo -->
<g id="proc~~siesta_forces~~CallsGraph_edge226" class="edge"><title>proc~dfscf&#45;&gt;indxuo</title>
<path fill="none" stroke="#000000" d="M525.505,-3744.66C541.727,-3746.49 561.777,-3751.59 574,-3765 633.38,-3830.12 555.508,-3890.73 610,-3960 613.084,-3963.92 617.057,-3967.13 621.386,-3969.75"/>
<polygon fill="#000000" stroke="#000000" points="620.086,-3973.01 630.597,-3974.35 623.212,-3966.75 620.086,-3973.01"/>
</g>
<!-- listsc -->
<g id="proc~~siesta_forces~~CallsGraph_node181" class="node"><title>listsc</title>
<polygon fill="#777777" stroke="#777777" points="685,-3951 631,-3951 631,-3927 685,-3927 685,-3951"/>
<text text-anchor="middle" x="658" y="-3936.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">listsc</text>
</g>
<!-- proc~dfscf&#45;&gt;listsc -->
<g id="proc~~siesta_forces~~CallsGraph_edge227" class="edge"><title>proc~dfscf&#45;&gt;listsc</title>
<path fill="none" stroke="#000000" d="M525.616,-3744.93C541.673,-3746.89 561.499,-3752.04 574,-3765 620.995,-3813.73 568.921,-3859.19 610,-3913 613.241,-3917.25 617.385,-3920.89 621.866,-3924"/>
<polygon fill="#000000" stroke="#000000" points="620.369,-3927.18 630.747,-3929.31 623.963,-3921.17 620.369,-3927.18"/>
</g>
<!-- endpht -->
<g id="proc~~siesta_forces~~CallsGraph_node183" class="node"><title>endpht</title>
<polygon fill="#777777" stroke="#777777" points="685,-3707 631,-3707 631,-3683 685,-3683 685,-3707"/>
<text text-anchor="middle" x="658" y="-3692.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">endpht</text>
</g>
<!-- proc~dfscf&#45;&gt;endpht -->
<g id="proc~~siesta_forces~~CallsGraph_edge228" class="edge"><title>proc~dfscf&#45;&gt;endpht</title>
<path fill="none" stroke="#000000" d="M525.799,-3736.94C540.105,-3733.01 558.081,-3727.93 574,-3723 589.581,-3718.18 606.675,-3712.48 621.279,-3707.49"/>
<polygon fill="#000000" stroke="#000000" points="622.625,-3710.73 630.943,-3704.17 620.348,-3704.11 622.625,-3710.73"/>
</g>
<!-- listp2 -->
<g id="proc~~siesta_forces~~CallsGraph_node185" class="node"><title>listp2</title>
<polygon fill="#777777" stroke="#777777" points="685,-3665 631,-3665 631,-3641 685,-3641 685,-3665"/>
<text text-anchor="middle" x="658" y="-3650.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">listp2</text>
</g>
<!-- proc~dfscf&#45;&gt;listp2 -->
<g id="proc~~siesta_forces~~CallsGraph_edge230" class="edge"><title>proc~dfscf&#45;&gt;listp2</title>
<path fill="none" stroke="#000000" d="M525.793,-3740.91C540.945,-3738.13 559.751,-3732.87 574,-3723 596.212,-3707.61 588.965,-3690.96 610,-3674 613.539,-3671.15 617.528,-3668.6 621.648,-3666.34"/>
<polygon fill="#000000" stroke="#000000" points="623.312,-3669.43 630.752,-3661.88 620.232,-3663.14 623.312,-3669.43"/>
</g>
<!-- needdscfl -->
<g id="proc~~siesta_forces~~CallsGraph_node186" class="node"><title>needdscfl</title>
<polygon fill="#777777" stroke="#777777" points="687,-3623 629,-3623 629,-3599 687,-3599 687,-3623"/>
<text text-anchor="middle" x="658" y="-3608.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">needdscfl</text>
</g>
<!-- proc~dfscf&#45;&gt;needdscfl -->
<g id="proc~~siesta_forces~~CallsGraph_edge231" class="edge"><title>proc~dfscf&#45;&gt;needdscfl</title>
<path fill="none" stroke="#000000" d="M525.738,-3742.36C541.438,-3740.1 560.834,-3734.89 574,-3723 606.282,-3693.85 579.921,-3663.42 610,-3632 612.92,-3628.95 616.364,-3626.31 620.038,-3624.03"/>
<polygon fill="#000000" stroke="#000000" points="621.683,-3627.12 628.891,-3619.36 618.414,-3620.93 621.683,-3627.12"/>
</g>
<!-- listdlptr -->
<g id="proc~~siesta_forces~~CallsGraph_node187" class="node"><title>listdlptr</title>
<polygon fill="#777777" stroke="#777777" points="685,-3581 631,-3581 631,-3557 685,-3557 685,-3581"/>
<text text-anchor="middle" x="658" y="-3566.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">listdlptr</text>
</g>
<!-- proc~dfscf&#45;&gt;listdlptr -->
<g id="proc~~siesta_forces~~CallsGraph_edge233" class="edge"><title>proc~dfscf&#45;&gt;listdlptr</title>
<path fill="none" stroke="#000000" d="M525.503,-3742.96C541.515,-3740.95 561.334,-3735.8 574,-3723 617.076,-3679.47 570.2,-3636.54 610,-3590 613.242,-3586.21 617.304,-3583.07 621.675,-3580.49"/>
<polygon fill="#000000" stroke="#000000" points="623.505,-3583.49 630.916,-3575.91 620.401,-3577.21 623.505,-3583.49"/>
</g>
<!-- matrixotom -->
<g id="proc~~siesta_forces~~CallsGraph_node188" class="node"><title>matrixotom</title>
<polygon fill="#777777" stroke="#777777" points="691,-4237 625,-4237 625,-4213 691,-4213 691,-4237"/>
<text text-anchor="middle" x="658" y="-4222.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">matrixotom</text>
</g>
<!-- proc~dfscf&#45;&gt;matrixotom -->
<g id="proc~~siesta_forces~~CallsGraph_edge234" class="edge"><title>proc~dfscf&#45;&gt;matrixotom</title>
<path fill="none" stroke="#000000" d="M525.604,-3744.22C542.082,-3745.85 562.382,-3750.89 574,-3765 636.226,-3840.56 553.429,-4124.12 610,-4204 611.743,-4206.46 613.844,-4208.64 616.177,-4210.56"/>
<polygon fill="#000000" stroke="#000000" points="614.534,-4213.67 624.826,-4216.19 618.35,-4207.8 614.534,-4213.67"/>
</g>
<!-- lstpht -->
<g id="proc~~siesta_forces~~CallsGraph_node189" class="node"><title>lstpht</title>
<polygon fill="#777777" stroke="#777777" points="685,-3497 631,-3497 631,-3473 685,-3473 685,-3497"/>
<text text-anchor="middle" x="658" y="-3482.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lstpht</text>
</g>
<!-- proc~dfscf&#45;&gt;lstpht -->
<g id="proc~~siesta_forces~~CallsGraph_edge235" class="edge"><title>proc~dfscf&#45;&gt;lstpht</title>
<path fill="none" stroke="#000000" d="M525.587,-3743.42C541.843,-3741.62 561.899,-3736.52 574,-3723 639.211,-3650.16 550.253,-3583.38 610,-3506 613.048,-3502.05 617.002,-3498.83 621.32,-3496.2"/>
<polygon fill="#000000" stroke="#000000" points="623.145,-3499.2 630.525,-3491.6 620.015,-3492.94 623.145,-3499.2"/>
</g>
<!-- globaltolocalorb -->
<g id="proc~~siesta_forces~~CallsGraph_node190" class="node"><title>globaltolocalorb</title>
<polygon fill="#777777" stroke="#777777" points="702,-4153 614,-4153 614,-4129 702,-4129 702,-4153"/>
<text text-anchor="middle" x="658" y="-4138.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">globaltolocalorb</text>
</g>
<!-- proc~dfscf&#45;&gt;globaltolocalorb -->
<g id="proc~~siesta_forces~~CallsGraph_edge236" class="edge"><title>proc~dfscf&#45;&gt;globaltolocalorb</title>
<path fill="none" stroke="#000000" d="M525.508,-3744.3C541.946,-3745.96 562.237,-3751.01 574,-3765 624.327,-3824.84 566.89,-4049.77 610,-4115 611.902,-4117.88 614.237,-4120.47 616.838,-4122.79"/>
<polygon fill="#000000" stroke="#000000" points="615.148,-4125.89 625.28,-4128.99 619.291,-4120.25 615.148,-4125.89"/>
</g>
<!-- numdl -->
<g id="proc~~siesta_forces~~CallsGraph_node191" class="node"><title>numdl</title>
<polygon fill="#777777" stroke="#777777" points="685,-4073 631,-4073 631,-4049 685,-4049 685,-4073"/>
<text text-anchor="middle" x="658" y="-4058.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">numdl</text>
</g>
<!-- proc~dfscf&#45;&gt;numdl -->
<g id="proc~~siesta_forces~~CallsGraph_edge238" class="edge"><title>proc~dfscf&#45;&gt;numdl</title>
<path fill="none" stroke="#000000" d="M525.732,-3744.45C542.048,-3746.2 562.116,-3751.29 574,-3765 653.306,-3856.47 541.74,-3935.02 610,-4035 613.155,-4039.62 617.412,-4043.5 622.083,-4046.74"/>
<polygon fill="#000000" stroke="#000000" points="620.397,-4049.81 630.786,-4051.89 623.962,-4043.79 620.397,-4049.81"/>
</g>
<!-- proc~rcut -->
<g id="proc~~siesta_forces~~CallsGraph_node194" class="node"><title>proc~rcut</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node194"><a xlink:href=".././proc/rcut.html" xlink:title="rcut">
<polygon fill="#d94e8f" stroke="#d94e8f" points="685,-3829 631,-3829 631,-3805 685,-3805 685,-3829"/>
<text text-anchor="middle" x="658" y="-3814.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rcut</text>
</a>
</g>
</g>
<!-- proc~dfscf&#45;&gt;proc~rcut -->
<g id="proc~~siesta_forces~~CallsGraph_edge239" class="edge"><title>proc~dfscf&#45;&gt;proc~rcut</title>
<path fill="none" stroke="#000000" d="M525.829,-3749.05C540.469,-3752.43 558.755,-3757.63 574,-3765 591.771,-3773.59 593.335,-3780.43 610,-3791 614.724,-3794 619.816,-3797.02 624.843,-3799.89"/>
<polygon fill="#000000" stroke="#000000" points="623.292,-3803.03 633.729,-3804.85 626.704,-3796.92 623.292,-3803.03"/>
</g>
<!-- alloc_default -->
<g id="proc~~siesta_forces~~CallsGraph_node195" class="node"><title>alloc_default</title>
<polygon fill="#777777" stroke="#777777" points="694.5,-3871 621.5,-3871 621.5,-3847 694.5,-3847 694.5,-3871"/>
<text text-anchor="middle" x="658" y="-3856.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">alloc_default</text>
</g>
<!-- proc~dfscf&#45;&gt;alloc_default -->
<g id="proc~~siesta_forces~~CallsGraph_edge241" class="edge"><title>proc~dfscf&#45;&gt;alloc_default</title>
<path fill="none" stroke="#000000" d="M525.759,-3746.08C541.274,-3748.51 560.465,-3753.74 574,-3765 601.815,-3788.13 583.939,-3812.91 610,-3838 611.239,-3839.19 612.558,-3840.33 613.937,-3841.4"/>
<polygon fill="#000000" stroke="#000000" points="612.084,-3844.37 622.365,-3846.93 615.925,-3838.52 612.084,-3844.37"/>
</g>
<!-- dscfl -->
<g id="proc~~siesta_forces~~CallsGraph_node196" class="node"><title>dscfl</title>
<polygon fill="#777777" stroke="#777777" points="685,-4195 631,-4195 631,-4171 685,-4171 685,-4195"/>
<text text-anchor="middle" x="658" y="-4180.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dscfl</text>
</g>
<!-- proc~dfscf&#45;&gt;dscfl -->
<g id="proc~~siesta_forces~~CallsGraph_edge242" class="edge"><title>proc~dfscf&#45;&gt;dscfl</title>
<path fill="none" stroke="#000000" d="M525.564,-3744.25C542.025,-3745.89 562.321,-3750.94 574,-3765 630.608,-3833.14 558.492,-4089.93 610,-4162 613.04,-4166.25 617.145,-4169.66 621.669,-4172.38"/>
<polygon fill="#000000" stroke="#000000" points="620.198,-4175.56 630.717,-4176.82 623.282,-4169.28 620.198,-4175.56"/>
</g>
<!-- listdl -->
<g id="proc~~siesta_forces~~CallsGraph_node197" class="node"><title>listdl</title>
<polygon fill="#777777" stroke="#777777" points="685,-3539 631,-3539 631,-3515 685,-3515 685,-3539"/>
<text text-anchor="middle" x="658" y="-3524.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">listdl</text>
</g>
<!-- proc~dfscf&#45;&gt;listdl -->
<g id="proc~~siesta_forces~~CallsGraph_edge243" class="edge"><title>proc~dfscf&#45;&gt;listdl</title>
<path fill="none" stroke="#000000" d="M525.775,-3743.22C541.896,-3741.32 561.733,-3736.18 574,-3723 628.095,-3664.87 560.271,-3609.91 610,-3548 613.124,-3544.11 617.12,-3540.92 621.458,-3538.31"/>
<polygon fill="#000000" stroke="#000000" points="623.286,-3541.31 630.677,-3533.72 620.166,-3535.04 623.286,-3541.31"/>
</g>
<!-- proc~reord&#45;&gt;timer -->
<g id="proc~~siesta_forces~~CallsGraph_edge246" class="edge"><title>proc~reord&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M948.195,-4955.97C954.312,-4952.88 960.155,-4948.67 964,-4943 975.307,-4926.33 1021.71,-4289.79 1030.91,-4162.15"/>
<polygon fill="#000000" stroke="#000000" points="1034.41,-4162.24 1031.64,-4152.02 1027.43,-4161.74 1034.41,-4162.24"/>
</g>
<!-- proc~reord&#45;&gt;re_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge244" class="edge"><title>proc~reord&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M948.213,-4955.45C954.179,-4952.38 959.945,-4948.31 964,-4943 1013.75,-4877.79 982.398,-4842.11 1000,-4762 1008.78,-4722.06 1020.19,-4675.78 1026.89,-4649.09"/>
<polygon fill="#000000" stroke="#000000" points="1030.33,-4649.8 1029.38,-4639.25 1023.54,-4648.09 1030.33,-4649.8"/>
</g>
<!-- proc~reord&#45;&gt;de_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge245" class="edge"><title>proc~reord&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M948.353,-4954.37C954.036,-4951.38 959.639,-4947.63 964,-4943 1001.61,-4903.09 1020.32,-4839.36 1028.03,-4805.63"/>
<polygon fill="#000000" stroke="#000000" points="1031.54,-4805.94 1030.23,-4795.43 1024.7,-4804.46 1031.54,-4805.94"/>
</g>
<!-- proc~distmeshdata_rea -->
<g id="proc~~siesta_forces~~CallsGraph_node182" class="node"><title>proc~distmeshdata_rea</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node182"><a xlink:href=".././proc/distmeshdata_rea.html" xlink:title="distMeshData_rea">
<polygon fill="#d9534f" stroke="#d9534f" points="842,-4894 742,-4894 742,-4870 842,-4870 842,-4894"/>
<text text-anchor="middle" x="792" y="-4879.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">distMeshData_rea</text>
</a>
</g>
</g>
<!-- interface~distmeshdata&#45;&gt;proc~distmeshdata_rea -->
<g id="proc~~siesta_forces~~CallsGraph_edge247" class="edge"><title>interface~distmeshdata&#45;&gt;proc~distmeshdata_rea</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M689.615,-4921.94C707.81,-4914.77 731.1,-4905.6 750.768,-4897.85"/>
<polygon fill="#000000" stroke="#000000" points="752.072,-4901.1 760.094,-4894.18 749.507,-4894.58 752.072,-4901.1"/>
</g>
<!-- proc~distmeshdata_int -->
<g id="proc~~siesta_forces~~CallsGraph_node192" class="node"><title>proc~distmeshdata_int</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node192"><a xlink:href=".././proc/distmeshdata_int.html" xlink:title="distMeshData_int">
<polygon fill="#d9534f" stroke="#d9534f" points="839.5,-4946 744.5,-4946 744.5,-4922 839.5,-4922 839.5,-4946"/>
<text text-anchor="middle" x="792" y="-4931.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">distMeshData_int</text>
</a>
</g>
</g>
<!-- interface~distmeshdata&#45;&gt;proc~distmeshdata_int -->
<g id="proc~~siesta_forces~~CallsGraph_edge248" class="edge"><title>interface~distmeshdata&#45;&gt;proc~distmeshdata_int</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M697.18,-4934C708.72,-4934 721.649,-4934 734.134,-4934"/>
<polygon fill="#000000" stroke="#000000" points="734.476,-4937.5 744.476,-4934 734.476,-4930.5 734.476,-4937.5"/>
</g>
<!-- proc~vmat&#45;&gt;timer -->
<g id="proc~~siesta_forces~~CallsGraph_edge256" class="edge"><title>proc~vmat&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M525.618,-3699.83C542.103,-3697.01 562.404,-3690.58 574,-3676 619.915,-3618.26 555.082,-3395.25 610,-3346 641.764,-3317.51 669.867,-3323.31 706,-3346 765.818,-3383.56 939.828,-3860.63 964,-3927 989.152,-3996.06 1014.54,-4079.39 1026.08,-4118.17"/>
<polygon fill="#000000" stroke="#000000" points="1022.76,-4119.29 1028.96,-4127.88 1029.47,-4117.3 1022.76,-4119.29"/>
</g>
<!-- proc~vmat&#45;&gt;re_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge253" class="edge"><title>proc~vmat&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M525.803,-3699.62C542.148,-3696.71 562.222,-3690.26 574,-3676 644.095,-3591.15 526.712,-3502.94 610,-3431 642.289,-3403.11 673.661,-3403.17 706,-3431 746.709,-3466.04 726.322,-3618.63 742,-3670 809.2,-3890.19 897.938,-3917.47 964,-4138 1016.31,-4312.64 1028.98,-4534.58 1031.77,-4604.72"/>
<polygon fill="#000000" stroke="#000000" points="1028.29,-4605.12 1032.15,-4614.98 1035.28,-4604.86 1028.29,-4605.12"/>
</g>
<!-- proc~vmat&#45;&gt;de_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge261" class="edge"><title>proc~vmat&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M525.697,-3699.53C541.998,-3696.58 562.063,-3690.13 574,-3676 635.686,-3603 536.983,-3525.66 610,-3464 642.598,-3436.47 674.217,-3435.53 706,-3464 760.292,-3512.63 721.014,-3720.2 742,-3790 780.118,-3916.78 815.656,-3938.22 878,-4055 915.102,-4124.5 941.149,-4134.6 964,-4210 1020.65,-4396.93 969.05,-4455.14 1000,-4648 1006.48,-4688.38 1018.64,-4734.52 1026.11,-4761.06"/>
<polygon fill="#000000" stroke="#000000" points="1022.79,-4762.19 1028.9,-4770.84 1029.52,-4760.27 1022.79,-4762.19"/>
</g>
<!-- matrixmtoo -->
<g id="proc~~siesta_forces~~CallsGraph_node178" class="node"><title>matrixmtoo</title>
<polygon fill="#777777" stroke="#777777" points="691,-3379 625,-3379 625,-3355 691,-3355 691,-3379"/>
<text text-anchor="middle" x="658" y="-3364.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">matrixmtoo</text>
</g>
<!-- proc~vmat&#45;&gt;matrixmtoo -->
<g id="proc~~siesta_forces~~CallsGraph_edge258" class="edge"><title>proc~vmat&#45;&gt;matrixmtoo</title>
<path fill="none" stroke="#000000" d="M525.533,-3699.76C541.981,-3696.91 562.274,-3690.48 574,-3676 653.802,-3577.47 538.826,-3497.93 610,-3393 611.937,-3390.14 614.296,-3387.57 616.914,-3385.26"/>
<polygon fill="#000000" stroke="#000000" points="619.369,-3387.8 625.385,-3379.08 615.243,-3382.15 619.369,-3387.8"/>
</g>
<!-- phi -->
<g id="proc~~siesta_forces~~CallsGraph_node179" class="node"><title>phi</title>
<polygon fill="#777777" stroke="#777777" points="685,-3749 631,-3749 631,-3725 685,-3725 685,-3749"/>
<text text-anchor="middle" x="658" y="-3734.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">phi</text>
</g>
<!-- proc~vmat&#45;&gt;phi -->
<g id="proc~~siesta_forces~~CallsGraph_edge249" class="edge"><title>proc~vmat&#45;&gt;phi</title>
<path fill="none" stroke="#000000" d="M525.508,-3707.78C551.612,-3713.58 592.027,-3722.56 621.161,-3729.04"/>
<polygon fill="#000000" stroke="#000000" points="620.432,-3732.46 630.953,-3731.21 621.951,-3725.63 620.432,-3732.46"/>
</g>
<!-- proc~vmat&#45;&gt;indxuo -->
<g id="proc~~siesta_forces~~CallsGraph_edge250" class="edge"><title>proc~vmat&#45;&gt;indxuo</title>
<path fill="none" stroke="#000000" d="M525.649,-3702.53C541.931,-3704.31 561.992,-3709.4 574,-3723 644.524,-3802.86 545.465,-3875.23 610,-3960 613.167,-3964.16 617.341,-3967.52 621.896,-3970.22"/>
<polygon fill="#000000" stroke="#000000" points="620.44,-3973.4 630.961,-3974.64 623.512,-3967.11 620.44,-3973.4"/>
</g>
<!-- proc~vmat&#45;&gt;listsc -->
<g id="proc~~siesta_forces~~CallsGraph_edge251" class="edge"><title>proc~vmat&#45;&gt;listsc</title>
<path fill="none" stroke="#000000" d="M525.674,-3702.88C541.755,-3704.81 561.585,-3709.96 574,-3723 623.357,-3774.85 578.924,-3815.51 610,-3880 616.886,-3894.29 627.777,-3908.27 637.343,-3919.03"/>
<polygon fill="#000000" stroke="#000000" points="634.957,-3921.6 644.31,-3926.58 640.102,-3916.85 634.957,-3921.6"/>
</g>
<!-- proc~vmat&#45;&gt;endpht -->
<g id="proc~~siesta_forces~~CallsGraph_edge252" class="edge"><title>proc~vmat&#45;&gt;endpht</title>
<path fill="none" stroke="#000000" d="M525.508,-3700.84C551.498,-3699.69 591.674,-3697.9 620.778,-3696.61"/>
<polygon fill="#000000" stroke="#000000" points="621.119,-3700.1 630.953,-3696.16 620.808,-3693.11 621.119,-3700.1"/>
</g>
<!-- proc~vmat&#45;&gt;listp2 -->
<g id="proc~~siesta_forces~~CallsGraph_edge254" class="edge"><title>proc~vmat&#45;&gt;listp2</title>
<path fill="none" stroke="#000000" d="M525.508,-3693.91C551.612,-3685.79 592.027,-3673.21 621.161,-3664.15"/>
<polygon fill="#000000" stroke="#000000" points="622.445,-3667.42 630.953,-3661.1 620.365,-3660.73 622.445,-3667.42"/>
</g>
<!-- proc~vmat&#45;&gt;needdscfl -->
<g id="proc~~siesta_forces~~CallsGraph_edge255" class="edge"><title>proc~vmat&#45;&gt;needdscfl</title>
<path fill="none" stroke="#000000" d="M525.622,-3696.63C540.716,-3692.65 559.52,-3686.13 574,-3676 594.704,-3661.52 589.926,-3647.34 610,-3632 613.018,-3629.69 616.329,-3627.57 619.753,-3625.64"/>
<polygon fill="#000000" stroke="#000000" points="621.622,-3628.62 628.955,-3620.97 618.454,-3622.38 621.622,-3628.62"/>
</g>
<!-- proc~vmat&#45;&gt;listdlptr -->
<g id="proc~~siesta_forces~~CallsGraph_edge257" class="edge"><title>proc~vmat&#45;&gt;listdlptr</title>
<path fill="none" stroke="#000000" d="M525.736,-3698.33C541.436,-3694.92 560.832,-3688.39 574,-3676 604.175,-3647.6 581.05,-3619.65 610,-3590 613.411,-3586.51 617.506,-3583.55 621.838,-3581.06"/>
<polygon fill="#000000" stroke="#000000" points="623.504,-3584.14 630.92,-3576.57 620.404,-3577.86 623.504,-3584.14"/>
</g>
<!-- proc~vmat&#45;&gt;lstpht -->
<g id="proc~~siesta_forces~~CallsGraph_edge259" class="edge"><title>proc~vmat&#45;&gt;lstpht</title>
<path fill="none" stroke="#000000" d="M525.507,-3699.37C541.73,-3696.35 561.78,-3689.88 574,-3676 625.032,-3618.03 561.459,-3566.07 610,-3506 613.135,-3502.12 617.137,-3498.93 621.479,-3496.32"/>
<polygon fill="#000000" stroke="#000000" points="623.306,-3499.32 630.7,-3491.74 620.188,-3493.06 623.306,-3499.32"/>
</g>
<!-- proc~vmat&#45;&gt;globaltolocalorb -->
<g id="proc~~siesta_forces~~CallsGraph_edge260" class="edge"><title>proc~vmat&#45;&gt;globaltolocalorb</title>
<path fill="none" stroke="#000000" d="M525.52,-3702.29C541.963,-3703.95 562.254,-3709 574,-3723 625.529,-3784.43 579.791,-4007.73 610,-4082 615.976,-4096.69 626.819,-4110.69 636.585,-4121.36"/>
<polygon fill="#000000" stroke="#000000" points="634.298,-4124.03 643.745,-4128.83 639.351,-4119.19 634.298,-4124.03"/>
</g>
<!-- proc~vmat&#45;&gt;numdl -->
<g id="proc~~siesta_forces~~CallsGraph_edge262" class="edge"><title>proc~vmat&#45;&gt;numdl</title>
<path fill="none" stroke="#000000" d="M525.752,-3702.44C542.075,-3704.18 562.145,-3709.27 574,-3723 655.704,-3817.64 561.255,-3886.87 610,-4002 616.184,-4016.61 627.038,-4030.6 636.758,-4041.29"/>
<polygon fill="#000000" stroke="#000000" points="634.448,-4043.94 643.874,-4048.78 639.521,-4039.12 634.448,-4043.94"/>
</g>
<!-- proc~vmat&#45;&gt;proc~rcut -->
<g id="proc~~siesta_forces~~CallsGraph_edge263" class="edge"><title>proc~vmat&#45;&gt;proc~rcut</title>
<path fill="none" stroke="#000000" d="M525.828,-3705.64C540.812,-3708.6 559.437,-3713.85 574,-3723 589.911,-3733 622.111,-3772.26 641.392,-3796.77"/>
<polygon fill="#000000" stroke="#000000" points="638.712,-3799.03 647.626,-3804.75 644.229,-3794.72 638.712,-3799.03"/>
</g>
<!-- proc~vmat&#45;&gt;listdl -->
<g id="proc~~siesta_forces~~CallsGraph_edge264" class="edge"><title>proc~vmat&#45;&gt;listdl</title>
<path fill="none" stroke="#000000" d="M525.566,-3699.03C541.603,-3695.87 561.426,-3689.37 574,-3676 614.48,-3632.95 571.372,-3592.72 610,-3548 613.26,-3544.23 617.333,-3541.1 621.709,-3538.52"/>
<polygon fill="#000000" stroke="#000000" points="623.539,-3541.52 630.954,-3533.95 620.438,-3535.24 623.539,-3541.52"/>
</g>
<!-- proc~rhoofd&#45;&gt;timer -->
<g id="proc~~siesta_forces~~CallsGraph_edge272" class="edge"><title>proc~rhoofd&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M525.624,-3786.2C542.11,-3787.82 562.412,-3792.87 574,-3807 639.437,-3886.8 534.251,-4199.91 610,-4270 641.317,-4298.98 664.097,-4278.04 706,-4270 709.805,-4269.27 913.286,-4187.79 997.053,-4154.21"/>
<polygon fill="#000000" stroke="#000000" points="998.441,-4157.43 1006.42,-4150.46 995.836,-4150.93 998.441,-4157.43"/>
</g>
<!-- proc~rhoofd&#45;&gt;re_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge269" class="edge"><title>proc~rhoofd&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M525.639,-3786.19C542.132,-3787.81 562.435,-3792.85 574,-3807 642.248,-3890.51 530.959,-4217.62 610,-4291 725.381,-4398.12 842.425,-4177.97 964,-4278 1014.81,-4319.81 1028.5,-4533.91 1031.66,-4604.44"/>
<polygon fill="#000000" stroke="#000000" points="1028.18,-4604.98 1032.09,-4614.83 1035.17,-4604.69 1028.18,-4604.98"/>
</g>
<!-- proc~rhoofd&#45;&gt;de_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge277" class="edge"><title>proc~rhoofd&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M525.659,-3786.17C542.16,-3787.78 562.465,-3792.82 574,-3807 646.13,-3895.64 526.411,-4242.07 610,-4320 667.558,-4373.66 905.476,-4258.39 964,-4311 1020.01,-4361.35 987.159,-4573.79 1000,-4648 1006.97,-4688.29 1018.97,-4734.46 1026.28,-4761.03"/>
<polygon fill="#000000" stroke="#000000" points="1022.95,-4762.13 1029.01,-4770.83 1029.7,-4760.25 1022.95,-4762.13"/>
</g>
<!-- proc~rhoofd&#45;&gt;proc~die -->
<g id="proc~~siesta_forces~~CallsGraph_edge280" class="edge"><title>proc~rhoofd&#45;&gt;proc~die</title>
<path fill="none" stroke="#000000" d="M525.604,-3786.22C542.082,-3787.85 562.382,-3792.89 574,-3807 636.226,-3882.56 538.013,-4179.67 610,-4246 641.379,-4274.91 672.543,-4272.48 706,-4246 872.405,-4114.31 912.9,-3374.58 919.082,-3235.53"/>
<polygon fill="#000000" stroke="#000000" points="922.591,-3235.4 919.524,-3225.26 915.597,-3235.1 922.591,-3235.4"/>
</g>
<!-- proc~rhoofd&#45;&gt;phi -->
<g id="proc~~siesta_forces~~CallsGraph_edge265" class="edge"><title>proc~rhoofd&#45;&gt;phi</title>
<path fill="none" stroke="#000000" d="M525.799,-3778.94C540.105,-3775.01 558.081,-3769.93 574,-3765 589.581,-3760.18 606.675,-3754.48 621.279,-3749.49"/>
<polygon fill="#000000" stroke="#000000" points="622.625,-3752.73 630.943,-3746.17 620.348,-3746.11 622.625,-3752.73"/>
</g>
<!-- proc~rhoofd&#45;&gt;indxuo -->
<g id="proc~~siesta_forces~~CallsGraph_edge266" class="edge"><title>proc~rhoofd&#45;&gt;indxuo</title>
<path fill="none" stroke="#000000" d="M525.649,-3786.9C541.72,-3788.85 561.548,-3793.99 574,-3807 622.306,-3857.46 565.488,-3906.16 610,-3960 613.178,-3963.84 617.205,-3967.01 621.558,-3969.61"/>
<polygon fill="#000000" stroke="#000000" points="620.274,-3972.88 630.788,-3974.19 623.387,-3966.61 620.274,-3972.88"/>
</g>
<!-- proc~rhoofd&#45;&gt;listsc -->
<g id="proc~~siesta_forces~~CallsGraph_edge267" class="edge"><title>proc~rhoofd&#45;&gt;listsc</title>
<path fill="none" stroke="#000000" d="M525.589,-3787.37C541.432,-3789.51 561.034,-3794.7 574,-3807 610.095,-3841.24 578.083,-3874.83 610,-3913 613.354,-3917.01 617.493,-3920.51 621.912,-3923.53"/>
<polygon fill="#000000" stroke="#000000" points="620.248,-3926.62 630.623,-3928.76 623.851,-3920.62 620.248,-3926.62"/>
</g>
<!-- proc~rhoofd&#45;&gt;endpht -->
<g id="proc~~siesta_forces~~CallsGraph_edge268" class="edge"><title>proc~rhoofd&#45;&gt;endpht</title>
<path fill="none" stroke="#000000" d="M525.793,-3782.91C540.945,-3780.13 559.751,-3774.87 574,-3765 596.212,-3749.61 588.965,-3732.96 610,-3716 613.539,-3713.15 617.528,-3710.6 621.648,-3708.34"/>
<polygon fill="#000000" stroke="#000000" points="623.312,-3711.43 630.752,-3703.88 620.232,-3705.14 623.312,-3711.43"/>
</g>
<!-- proc~rhoofd&#45;&gt;listp2 -->
<g id="proc~~siesta_forces~~CallsGraph_edge270" class="edge"><title>proc~rhoofd&#45;&gt;listp2</title>
<path fill="none" stroke="#000000" d="M525.738,-3784.36C541.438,-3782.1 560.834,-3776.89 574,-3765 606.282,-3735.85 579.921,-3705.42 610,-3674 613.376,-3670.47 617.451,-3667.5 621.774,-3664.99"/>
<polygon fill="#000000" stroke="#000000" points="623.44,-3668.07 630.848,-3660.5 620.333,-3661.8 623.44,-3668.07"/>
</g>
<!-- proc~rhoofd&#45;&gt;needdscfl -->
<g id="proc~~siesta_forces~~CallsGraph_edge271" class="edge"><title>proc~rhoofd&#45;&gt;needdscfl</title>
<path fill="none" stroke="#000000" d="M525.503,-3784.96C541.515,-3782.95 561.334,-3777.8 574,-3765 617.076,-3721.47 570.2,-3678.54 610,-3632 612.81,-3628.71 616.236,-3625.92 619.945,-3623.55"/>
<polygon fill="#000000" stroke="#000000" points="621.773,-3626.54 628.957,-3618.75 618.485,-3620.36 621.773,-3626.54"/>
</g>
<!-- proc~rhoofd&#45;&gt;listdlptr -->
<g id="proc~~siesta_forces~~CallsGraph_edge273" class="edge"><title>proc~rhoofd&#45;&gt;listdlptr</title>
<path fill="none" stroke="#000000" d="M525.775,-3785.22C541.896,-3783.32 561.733,-3778.18 574,-3765 628.095,-3706.87 560.271,-3651.91 610,-3590 613.124,-3586.11 617.12,-3582.92 621.458,-3580.31"/>
<polygon fill="#000000" stroke="#000000" points="623.286,-3583.31 630.677,-3575.72 620.166,-3577.04 623.286,-3583.31"/>
</g>
<!-- proc~rhoofd&#45;&gt;matrixotom -->
<g id="proc~~siesta_forces~~CallsGraph_edge274" class="edge"><title>proc~rhoofd&#45;&gt;matrixotom</title>
<path fill="none" stroke="#000000" d="M525.564,-3786.25C542.025,-3787.89 562.321,-3792.94 574,-3807 630.608,-3875.14 558.492,-4131.93 610,-4204 611.754,-4206.45 613.862,-4208.63 616.201,-4210.55"/>
<polygon fill="#000000" stroke="#000000" points="614.566,-4213.66 624.861,-4216.16 618.374,-4207.79 614.566,-4213.66"/>
</g>
<!-- proc~rhoofd&#45;&gt;lstpht -->
<g id="proc~~siesta_forces~~CallsGraph_edge275" class="edge"><title>proc~rhoofd&#45;&gt;lstpht</title>
<path fill="none" stroke="#000000" d="M525.707,-3785.52C542.012,-3783.77 562.078,-3778.67 574,-3765 650.377,-3677.4 540.19,-3598.91 610,-3506 613.141,-3501.82 617.3,-3498.45 621.849,-3495.75"/>
<polygon fill="#000000" stroke="#000000" points="623.464,-3498.85 630.911,-3491.32 620.39,-3492.57 623.464,-3498.85"/>
</g>
<!-- proc~rhoofd&#45;&gt;globaltolocalorb -->
<g id="proc~~siesta_forces~~CallsGraph_edge276" class="edge"><title>proc~rhoofd&#45;&gt;globaltolocalorb</title>
<path fill="none" stroke="#000000" d="M525.807,-3786.39C542.153,-3788.11 562.227,-3793.2 574,-3807 663.438,-3911.86 533.215,-4000.55 610,-4115 611.922,-4117.87 614.271,-4120.45 616.882,-4122.76"/>
<polygon fill="#000000" stroke="#000000" points="615.203,-4125.87 625.341,-4128.95 619.336,-4120.22 615.203,-4125.87"/>
</g>
<!-- proc~rhoofd&#45;&gt;numdl -->
<g id="proc~~siesta_forces~~CallsGraph_edge278" class="edge"><title>proc~rhoofd&#45;&gt;numdl</title>
<path fill="none" stroke="#000000" d="M525.623,-3786.55C541.893,-3788.34 561.952,-3793.44 574,-3807 642.132,-3883.7 551.142,-3950.98 610,-4035 613.21,-4039.58 617.497,-4043.45 622.18,-4046.67"/>
<polygon fill="#000000" stroke="#000000" points="620.5,-4049.75 630.89,-4051.82 624.06,-4043.72 620.5,-4049.75"/>
</g>
<!-- proc~rhoofd&#45;&gt;proc~rcut -->
<g id="proc~~siesta_forces~~CallsGraph_edge279" class="edge"><title>proc~rhoofd&#45;&gt;proc~rcut</title>
<path fill="none" stroke="#000000" d="M525.508,-3791.12C551.498,-3796.23 591.674,-3804.14 620.778,-3809.87"/>
<polygon fill="#000000" stroke="#000000" points="620.466,-3813.38 630.953,-3811.87 621.818,-3806.51 620.466,-3813.38"/>
</g>
<!-- proc~rhoofd&#45;&gt;dscfl -->
<g id="proc~~siesta_forces~~CallsGraph_edge281" class="edge"><title>proc~rhoofd&#45;&gt;dscfl</title>
<path fill="none" stroke="#000000" d="M525.515,-3786.29C541.955,-3787.95 562.247,-3793 574,-3807 675.989,-3928.44 517.104,-4033.47 610,-4162 613.063,-4166.24 617.18,-4169.63 621.71,-4172.35"/>
<polygon fill="#000000" stroke="#000000" points="620.241,-4175.53 630.761,-4176.79 623.323,-4169.25 620.241,-4175.53"/>
</g>
<!-- proc~rhoofd&#45;&gt;listdl -->
<g id="proc~~siesta_forces~~CallsGraph_edge282" class="edge"><title>proc~rhoofd&#45;&gt;listdl</title>
<path fill="none" stroke="#000000" d="M525.587,-3785.42C541.843,-3783.62 561.899,-3778.52 574,-3765 639.211,-3692.16 550.253,-3625.38 610,-3548 613.048,-3544.05 617.002,-3540.83 621.32,-3538.2"/>
<polygon fill="#000000" stroke="#000000" points="623.145,-3541.2 630.525,-3533.6 620.015,-3534.94 623.145,-3541.2"/>
</g>
<!-- proc~write_rho&#45;&gt;write_debug -->
<g id="proc~~siesta_forces~~CallsGraph_edge288" class="edge"><title>proc~write_rho&#45;&gt;write_debug</title>
<path fill="none" stroke="#000000" d="M820.729,-4446.09C828.289,-4442.17 836.03,-4437.15 842,-4431 867.197,-4405.04 853.679,-4384.78 878,-4358 880.649,-4355.08 883.699,-4352.38 886.922,-4349.9"/>
<polygon fill="#000000" stroke="#000000" points="888.913,-4352.78 895.157,-4344.22 884.938,-4347.01 888.913,-4352.78"/>
</g>
<!-- proc~write_rho&#45;&gt;de_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge287" class="edge"><title>proc~write_rho&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M803.61,-4469.04C831.391,-4500.82 907.981,-4589.97 964,-4670 985.641,-4700.92 1007.75,-4738.76 1020.8,-4761.86"/>
<polygon fill="#000000" stroke="#000000" points="1017.86,-4763.78 1025.8,-4770.8 1023.97,-4760.36 1017.86,-4763.78"/>
</g>
<!-- proc~write_rho&#45;&gt;mpi_barrier -->
<g id="proc~~siesta_forces~~CallsGraph_edge286" class="edge"><title>proc~write_rho&#45;&gt;mpi_barrier</title>
<path fill="none" stroke="#000000" d="M798.787,-4469.17C818.663,-4510.95 884.314,-4648.98 909.779,-4702.51"/>
<polygon fill="#000000" stroke="#000000" points="906.723,-4704.24 914.179,-4711.76 913.044,-4701.23 906.723,-4704.24"/>
</g>
<!-- proc~write_rho&#45;&gt;io_close -->
<g id="proc~~siesta_forces~~CallsGraph_edge283" class="edge"><title>proc~write_rho&#45;&gt;io_close</title>
<path fill="none" stroke="#000000" d="M820.602,-4447.4C866.751,-4431.07 955.397,-4398.47 964,-4386 1038.05,-4278.67 935.9,-3326.55 1000,-3213 1000.24,-3212.58 1000.49,-3212.16 1000.75,-3211.75"/>
<polygon fill="#000000" stroke="#000000" points="1003.52,-3213.91 1007.69,-3204.17 998.356,-3209.19 1003.52,-3213.91"/>
</g>
<!-- proc~write_rho&#45;&gt;io_assign -->
<g id="proc~~siesta_forces~~CallsGraph_edge284" class="edge"><title>proc~write_rho&#45;&gt;io_assign</title>
<path fill="none" stroke="#000000" d="M820.434,-4444.96C827.823,-4441.06 835.549,-4436.35 842,-4431 861.722,-4414.66 857.323,-4401.11 878,-4386 911.051,-4361.84 940.299,-4386.38 964,-4353 1040.07,-4245.86 935.422,-3285.43 1000,-3171 1000.24,-3170.58 1000.49,-3170.16 1000.75,-3169.75"/>
<polygon fill="#000000" stroke="#000000" points="1003.52,-3171.91 1007.69,-3162.17 998.356,-3167.19 1003.52,-3171.91"/>
</g>
<!-- mpi_wait -->
<g id="proc~~siesta_forces~~CallsGraph_node184" class="node"><title>mpi_wait</title>
<polygon fill="#777777" stroke="#777777" points="948.5,-4462 893.5,-4462 893.5,-4438 948.5,-4438 948.5,-4462"/>
<text text-anchor="middle" x="921" y="-4447.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_wait</text>
</g>
<!-- proc~write_rho&#45;&gt;mpi_wait -->
<g id="proc~~siesta_forces~~CallsGraph_edge285" class="edge"><title>proc~write_rho&#45;&gt;mpi_wait</title>
<path fill="none" stroke="#000000" d="M820.557,-4455.48C838.946,-4454.47 863.33,-4453.12 883.35,-4452.02"/>
<polygon fill="#000000" stroke="#000000" points="883.575,-4455.51 893.367,-4451.47 883.189,-4448.52 883.575,-4455.51"/>
</g>
<!-- mpi_irecv -->
<g id="proc~~siesta_forces~~CallsGraph_node193" class="node"><title>mpi_irecv</title>
<polygon fill="#777777" stroke="#777777" points="950,-4504 892,-4504 892,-4480 950,-4480 950,-4504"/>
<text text-anchor="middle" x="921" y="-4489.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_irecv</text>
</g>
<!-- proc~write_rho&#45;&gt;mpi_irecv -->
<g id="proc~~siesta_forces~~CallsGraph_edge289" class="edge"><title>proc~write_rho&#45;&gt;mpi_irecv</title>
<path fill="none" stroke="#000000" d="M820.557,-4464.59C838.449,-4469.53 862.017,-4476.02 881.718,-4481.45"/>
<polygon fill="#000000" stroke="#000000" points="881.047,-4484.9 891.617,-4484.18 882.907,-4478.15 881.047,-4484.9"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;timer -->
<g id="proc~~siesta_forces~~CallsGraph_edge294" class="edge"><title>proc~distmeshdata_rea&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M823.026,-4869.87C829.836,-4866.14 836.634,-4861.53 842,-4856 867.197,-4830.04 851.888,-4808.04 878,-4783 908.163,-4754.08 939.255,-4778.67 964,-4745 999.219,-4697.07 1025.46,-4265.81 1031.28,-4162.27"/>
<polygon fill="#000000" stroke="#000000" points="1034.79,-4162.23 1031.85,-4152.05 1027.8,-4161.84 1034.79,-4162.23"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;re_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge293" class="edge"><title>proc~distmeshdata_rea&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M835.567,-4869.95C883.087,-4856.16 954.598,-4834.3 964,-4825 989.622,-4799.67 1016.61,-4694.96 1027.51,-4648.9"/>
<polygon fill="#000000" stroke="#000000" points="1030.95,-4649.56 1029.81,-4639.03 1024.13,-4647.97 1030.95,-4649.56"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;write_debug -->
<g id="proc~~siesta_forces~~CallsGraph_edge297" class="edge"><title>proc~distmeshdata_rea&#45;&gt;write_debug</title>
<path fill="none" stroke="#000000" d="M794.269,-4869.86C800.036,-4816.73 825.77,-4599.63 878,-4429 886.233,-4402.1 899.664,-4372.64 909.117,-4353.33"/>
<polygon fill="#000000" stroke="#000000" points="912.328,-4354.73 913.649,-4344.22 906.061,-4351.61 912.328,-4354.73"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;de_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge296" class="edge"><title>proc~distmeshdata_rea&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M842.125,-4883.77C877.847,-4883.06 926.341,-4877.85 964,-4858 987.779,-4845.47 1007.53,-4821.27 1019.61,-4803.74"/>
<polygon fill="#000000" stroke="#000000" points="1022.61,-4805.55 1025.22,-4795.28 1016.78,-4801.68 1022.61,-4805.55"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;proc~die -->
<g id="proc~~siesta_forces~~CallsGraph_edge298" class="edge"><title>proc~distmeshdata_rea&#45;&gt;proc~die</title>
<path fill="none" stroke="#000000" d="M794.747,-4869.8C801.715,-4820.75 827.821,-4633.14 842,-4478 887.88,-3976 914.111,-3359.39 919.117,-3235.34"/>
<polygon fill="#000000" stroke="#000000" points="922.621,-3235.31 919.524,-3225.18 915.626,-3235.03 922.621,-3235.31"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;mpi_barrier -->
<g id="proc~~siesta_forces~~CallsGraph_edge295" class="edge"><title>proc~distmeshdata_rea&#45;&gt;mpi_barrier</title>
<path fill="none" stroke="#000000" d="M824.318,-4869.92C830.846,-4866.25 837.194,-4861.65 842,-4856 874.249,-4818.11 847.028,-4788.94 878,-4750 880.326,-4747.08 883.076,-4744.39 886.039,-4741.96"/>
<polygon fill="#000000" stroke="#000000" points="888.149,-4744.75 894.234,-4736.08 884.068,-4739.06 888.149,-4744.75"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;proc~reord -->
<g id="proc~~siesta_forces~~CallsGraph_edge292" class="edge"><title>proc~distmeshdata_rea&#45;&gt;proc~reord</title>
<path fill="none" stroke="#000000" d="M813.419,-4894.09C822.368,-4899.6 832.886,-4906.36 842,-4913 858.836,-4925.26 860.57,-4931.6 878,-4943 880.149,-4944.41 882.405,-4945.78 884.71,-4947.12"/>
<polygon fill="#000000" stroke="#000000" points="883.256,-4950.31 893.711,-4952.03 886.608,-4944.17 883.256,-4950.31"/>
</g>
<!-- mpitrace_event -->
<g id="proc~~siesta_forces~~CallsGraph_node198" class="node"><title>mpitrace_event</title>
<polygon fill="#777777" stroke="#777777" points="964,-4816 878,-4816 878,-4792 964,-4792 964,-4816"/>
<text text-anchor="middle" x="921" y="-4801.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpitrace_event</text>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;mpitrace_event -->
<g id="proc~~siesta_forces~~CallsGraph_edge290" class="edge"><title>proc~distmeshdata_rea&#45;&gt;mpitrace_event</title>
<path fill="none" stroke="#000000" d="M817.298,-4869.95C825.298,-4865.76 834.151,-4860.88 842,-4856 858.757,-4845.57 861.599,-4840.98 878,-4830 882.147,-4827.22 886.578,-4824.37 890.951,-4821.61"/>
<polygon fill="#000000" stroke="#000000" points="893.092,-4824.4 899.733,-4816.14 889.394,-4818.46 893.092,-4824.4"/>
</g>
<!-- proc~boxintersection -->
<g id="proc~~siesta_forces~~CallsGraph_node199" class="node"><title>proc~boxintersection</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node199"><a xlink:href=".././proc/boxintersection.html" xlink:title="boxIntersection">
<polygon fill="#d9534f" stroke="#d9534f" points="963.5,-4934 878.5,-4934 878.5,-4910 963.5,-4910 963.5,-4934"/>
<text text-anchor="middle" x="921" y="-4919.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">boxIntersection</text>
</a>
</g>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;proc~boxintersection -->
<g id="proc~~siesta_forces~~CallsGraph_edge291" class="edge"><title>proc~distmeshdata_rea&#45;&gt;proc~boxintersection</title>
<path fill="none" stroke="#000000" d="M831.104,-4894C843.921,-4898.04 858.391,-4902.6 871.876,-4906.84"/>
<polygon fill="#000000" stroke="#000000" points="870.894,-4910.2 881.484,-4909.87 872.997,-4903.53 870.894,-4910.2"/>
</g>
<!-- proc~distmeshdata_int&#45;&gt;re_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge299" class="edge"><title>proc~distmeshdata_int&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M807.196,-4946.02C838.991,-4971.45 916.826,-5025.17 964,-4985 1002.22,-4952.46 990.118,-4811.21 1000,-4762 1008.05,-4721.91 1019.7,-4675.67 1026.65,-4649.04"/>
<polygon fill="#000000" stroke="#000000" points="1030.07,-4649.78 1029.23,-4639.22 1023.3,-4648 1030.07,-4649.78"/>
</g>
<!-- proc~distmeshdata_int&#45;&gt;de_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge301" class="edge"><title>proc~distmeshdata_int&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M800.584,-4946.12C813.608,-4965.64 842.304,-5003.34 878,-5018 913.356,-5032.52 933.424,-5040.94 964,-5018 998.594,-4992.05 1021.48,-4858.83 1029.41,-4805.3"/>
<polygon fill="#000000" stroke="#000000" points="1032.91,-4805.56 1030.87,-4795.16 1025.98,-4804.56 1032.91,-4805.56"/>
</g>
<!-- proc~distmeshdata_int&#45;&gt;proc~die -->
<g id="proc~~siesta_forces~~CallsGraph_edge302" class="edge"><title>proc~distmeshdata_int&#45;&gt;proc~die</title>
<path fill="none" stroke="#000000" d="M821.834,-4921.99C829.71,-4917.26 837.347,-4911.01 842,-4903 853.004,-4884.06 911.262,-3432.14 919.122,-3235.05"/>
<polygon fill="#000000" stroke="#000000" points="922.621,-3235.15 919.522,-3225.01 915.627,-3234.87 922.621,-3235.15"/>
</g>
<!-- proc~distmeshdata_int&#45;&gt;proc~boxintersection -->
<g id="proc~~siesta_forces~~CallsGraph_edge300" class="edge"><title>proc~distmeshdata_int&#45;&gt;proc~boxintersection</title>
<path fill="none" stroke="#000000" d="M839.569,-4929.6C848.927,-4928.72 858.814,-4927.78 868.333,-4926.88"/>
<polygon fill="#000000" stroke="#000000" points="868.849,-4930.35 878.476,-4925.92 868.191,-4923.38 868.849,-4930.35"/>
</g>
<!-- proc~chk -->
<g id="proc~~siesta_forces~~CallsGraph_node200" class="node"><title>proc~chk</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node200"><a xlink:href=".././proc/chk.html" xlink:title="chk">
<polygon fill="#d9534f" stroke="#d9534f" points="819,-3661 765,-3661 765,-3637 819,-3637 819,-3661"/>
<text text-anchor="middle" x="792" y="-3646.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">chk</text>
</a>
</g>
</g>
<!-- proc~rcut&#45;&gt;proc~chk -->
<g id="proc~~siesta_forces~~CallsGraph_edge303" class="edge"><title>proc~rcut&#45;&gt;proc~chk</title>
<path fill="none" stroke="#000000" d="M685.045,-3805.74C692.365,-3801.78 699.965,-3796.83 706,-3791 742.777,-3755.46 769.507,-3700.68 782.38,-3670.61"/>
<polygon fill="#000000" stroke="#000000" points="785.738,-3671.65 786.349,-3661.07 779.275,-3668.96 785.738,-3671.65"/>
</g>
<!-- proc~chk&#45;&gt;proc~die -->
<g id="proc~~siesta_forces~~CallsGraph_edge304" class="edge"><title>proc~chk&#45;&gt;proc~die</title>
<path fill="none" stroke="#000000" d="M796.529,-3636.88C813.938,-3577.12 890.741,-3313.45 913.576,-3235.06"/>
<polygon fill="#000000" stroke="#000000" points="916.991,-3235.84 916.428,-3225.26 910.271,-3233.89 916.991,-3235.84"/>
</g>
</g>
</svg>
</div><script>var panprocsiesta_forcesCallsGraph = svgPanZoom('#procsiesta_forcesCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,-0 209.5,-0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.5,-24 454.5,-24 454.5,-0 551.5,-0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/siesta_forces.html#src">siesta_forces</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>  <span class="k">subroutine </span><span class="n">siesta_forces</span><span class="p">(</span><span class="n">istep</span><span class="p">)</span>
  <span class="c">!! This subroutine represents central SIESTA operation logic.</span>

<span class="cp">#ifdef MPI</span>
    <span class="k">use </span><span class="n">mpi_siesta</span>
<span class="cp">#endif</span>
    <span class="k">use </span><span class="n">units</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">eV</span><span class="p">,</span> <span class="n">Ang</span>
    <span class="k">use </span><span class="nb">precision</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">dp</span>
    <span class="k">use </span><span class="n">sys</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">bye</span>

    <span class="k">use </span><span class="n">files</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">slabel</span>
    <span class="k">use </span><span class="n">siesta_cml</span>
<span class="cp">#ifdef SIESTA__FLOOK</span>
    <span class="k">use </span><span class="n">flook_siesta</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">slua_call</span>
    <span class="k">use </span><span class="n">flook_siesta</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">LUA_INIT_MD</span><span class="p">,</span> <span class="n">LUA_SCF_LOOP</span>
    <span class="k">use </span><span class="n">siesta_dicts</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">dict_variable_add</span>
    <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">ts_scf_mixs</span>
    <span class="k">use </span><span class="n">variable</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">cunpack</span>
<span class="cp">#ifndef NCDF_4</span>
    <span class="k">use </span><span class="n">dictionary</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="k">assign</span>
<span class="cp">#endif</span>
    <span class="k">use </span><span class="n">m_mixing</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">mixers_history_init</span>
<span class="cp">#endif</span>
    <span class="k">use </span><span class="n">m_state_init</span>
    <span class="k">use </span><span class="n">m_setup_hamiltonian</span>
    <span class="k">use </span><span class="n">m_setup_H0</span>
    <span class="k">use </span><span class="n">m_compute_dm</span>
    <span class="k">use </span><span class="n">m_compute_max_diff</span>
    <span class="k">use </span><span class="n">m_scfconvergence_test</span>
    <span class="k">use </span><span class="n">m_post_scf_work</span>
    <span class="k">use </span><span class="n">m_mixer</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">mixer</span>
    <span class="k">use </span><span class="n">m_mixing_scf</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">mixing_scf_converged</span>
    <span class="k">use </span><span class="n">m_mixing_scf</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">mixers_scf_history_init</span>
    <span class="k">use </span><span class="n">m_mixing_scf</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">scf_mixs</span><span class="p">,</span> <span class="n">scf_mix</span>

    <span class="k">use </span><span class="n">m_rhog</span><span class="p">,</span>                <span class="n">only</span><span class="p">:</span> <span class="n">mix_rhog</span><span class="p">,</span> <span class="n">compute_charge_diff</span>
    <span class="k">use </span><span class="n">siesta_options</span>
    <span class="k">use </span><span class="n">parallel</span><span class="p">,</span>     <span class="n">only</span> <span class="p">:</span> <span class="n">IOnode</span><span class="p">,</span> <span class="n">SIESTA_worker</span>
    <span class="k">use </span><span class="n">m_state_analysis</span>
    <span class="k">use </span><span class="n">m_steps</span>
    <span class="k">use </span><span class="n">m_spin</span><span class="p">,</span>                <span class="n">only</span><span class="p">:</span> <span class="n">spin</span>
    <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">DM_2D</span><span class="p">,</span> <span class="n">S_1D</span>
    <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">H</span><span class="p">,</span> <span class="n">Hold</span><span class="p">,</span> <span class="n">Dold</span><span class="p">,</span> <span class="n">Dscf</span><span class="p">,</span> <span class="n">Eold</span><span class="p">,</span> <span class="n">Escf</span><span class="p">,</span> <span class="n">maxnh</span>
    <span class="k">use </span><span class="n">m_convergence</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">converger_t</span>
    <span class="k">use </span><span class="n">m_convergence</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">reset</span><span class="p">,</span> <span class="n">set_tolerance</span>
    <span class="k">use </span><span class="n">siesta_geom</span><span class="p">,</span>   <span class="n">only</span><span class="p">:</span> <span class="n">na_u</span>           <span class="c">! Number of atoms in unit cell</span>
    <span class="k">use </span><span class="n">m_energies</span><span class="p">,</span>    <span class="n">only</span><span class="p">:</span> <span class="n">Etot</span>           <span class="c">! Total energy</span>
    <span class="k">use </span><span class="n">m_forces</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">fa</span><span class="p">,</span> <span class="n">cfa</span>        <span class="c">! Forces and constrained forces</span>
    <span class="k">use </span><span class="n">m_stress</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">cstress</span>        <span class="c">! Constrained stress tensor</span>
    <span class="k">use </span><span class="n">siesta_master</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">forcesToMaster</span> <span class="c">! Send forces to master prog</span>
    <span class="k">use </span><span class="n">siesta_master</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">siesta_server</span>  <span class="c">! Is siesta a server?</span>
    <span class="k">use </span><span class="n">m_save_density_matrix</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">save_density_matrix</span>
    <span class="k">use </span><span class="n">m_iodm_old</span><span class="p">,</span>    <span class="n">only</span><span class="p">:</span> <span class="n">write_spmatrix</span>

    <span class="k">use </span><span class="n">atomlist</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span> <span class="n">Qtot</span>
    <span class="k">use </span><span class="n">m_dm_charge</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">dm_charge</span>

    <span class="k">use </span><span class="n">m_pexsi_solver</span><span class="p">,</span>        <span class="n">only</span><span class="p">:</span> <span class="n">prevDmax</span>
    <span class="k">use </span><span class="n">write_subs</span><span class="p">,</span>            <span class="n">only</span><span class="p">:</span> <span class="n">siesta_write_forces</span>
    <span class="k">use </span><span class="n">write_subs</span><span class="p">,</span>            <span class="n">only</span><span class="p">:</span> <span class="n">siesta_write_stress_pressure</span>

<span class="cp">#ifdef NCDF_4</span>
    <span class="k">use </span><span class="n">dictionary</span>
    <span class="k">use </span><span class="n">m_ncdf_siesta</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">cdf_init_file</span><span class="p">,</span> <span class="n">cdf_save_settings</span>
    <span class="k">use </span><span class="n">m_ncdf_siesta</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">cdf_save_state</span><span class="p">,</span> <span class="n">cdf_save_basis</span>
<span class="cp">#endif</span>
    <span class="k">use </span><span class="n">m_compute_energies</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">compute_energies</span>

    <span class="k">use </span><span class="n">m_mpi_utils</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">broadcast</span><span class="p">,</span> <span class="n">barrier</span>
    <span class="k">use </span><span class="n">fdf</span>
<span class="cp">#ifdef SIESTA__PEXSI</span>
    <span class="k">use </span><span class="n">m_pexsi</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">pexsi_finalize_scfloop</span>
<span class="cp">#endif</span>
    <span class="k">use </span><span class="n">m_check_walltime</span>

    <span class="k">use </span><span class="n">m_energies</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">DE_NEGF</span>
    <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">N_Elec</span>
    <span class="k">use </span><span class="n">m_ts_method</span>
    <span class="k">use </span><span class="n">m_ts_global_vars</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">TSmode</span><span class="p">,</span> <span class="n">TSinit</span><span class="p">,</span> <span class="n">TSrun</span>
    <span class="k">use </span><span class="n">siesta_geom</span><span class="p">,</span>           <span class="n">only</span><span class="p">:</span> <span class="n">nsc</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">ucell</span><span class="p">,</span> <span class="n">isc_off</span>
    <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span>       <span class="n">only</span><span class="p">:</span> <span class="n">sparse_pattern</span><span class="p">,</span> <span class="n">block_dist</span>
    <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span>       <span class="n">only</span><span class="p">:</span> <span class="n">S</span>
    <span class="k">use </span><span class="n">m_ts_charge</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">ts_get_charges</span>
    <span class="k">use </span><span class="n">m_ts_charge</span><span class="p">,</span>           <span class="n">only</span><span class="p">:</span> <span class="n">TS_RHOCORR_METHOD</span>
    <span class="k">use </span><span class="n">m_ts_charge</span><span class="p">,</span>           <span class="n">only</span><span class="p">:</span> <span class="n">TS_RHOCORR_FERMI</span>
    <span class="k">use </span><span class="n">m_ts_charge</span><span class="p">,</span>           <span class="n">only</span><span class="p">:</span> <span class="n">TS_RHOCORR_FERMI_TOLERANCE</span>
    <span class="k">use </span><span class="n">m_transiesta</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">transiesta</span>
    <span class="k">use </span><span class="n">kpoint_scf_m</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">gamma_scf</span>
    <span class="k">use </span><span class="n">m_energies</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">Ef</span>

    <span class="k">use </span><span class="n">m_initwf</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">initwf</span>

    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">istep</span>

    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iscf</span>
    <span class="kt">logical</span> <span class="kd">::</span> <span class="n">first_scf</span><span class="p">,</span> <span class="n">SCFconverged</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dDmax</span> <span class="c">! Max. change in DM elements</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dHmax</span> <span class="c">! Max. change in H elements</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dEmax</span> <span class="c">! Max. change in EDM elements</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">drhog</span> <span class="c">! Max. change in rho(G) (experimental)</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">G2max</span> <span class="c">! actually used meshcutoff</span>
    <span class="k">type</span><span class="p">(</span><span class="n">converger_t</span><span class="p">)</span> <span class="kd">::</span>  <span class="n">conv_harris</span><span class="p">,</span> <span class="n">conv_freeE</span>

    <span class="c">! For initwf</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">istpp</span>

<span class="cp">#ifdef SIESTA__FLOOK</span>
    <span class="c">! len=24 from m_mixing.F90</span>
    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">next_mixer</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nnext_mixer</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">imix</span>
<span class="cp">#endif</span>

    <span class="kt">logical</span>               <span class="kd">::</span> <span class="n">time_is_up</span>
    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">tmp_str</span>

    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Qcur</span>
<span class="cp">#ifdef NCDF_4</span>
    <span class="k">type</span><span class="p">(</span><span class="n">dict</span><span class="p">)</span> <span class="kd">::</span> <span class="n">d_sav</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef MPI</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">MPIerror</span>
<span class="cp">#endif</span>

    <span class="k">external</span> <span class="kd">::</span> <span class="n">die</span><span class="p">,</span> <span class="n">message</span>

<span class="cp">#ifdef DEBUG</span>
    <span class="k">call </span><span class="n">write_debug</span><span class="p">(</span> <span class="s1">&#39;    PRE siesta_forces&#39;</span> <span class="p">)</span>
<span class="cp">#endif</span>

<span class="cp">#ifdef SIESTA__PEXSI</span>
    <span class="c">! Broadcast relevant things for program logic</span>
    <span class="c">! These were set in read_options, called only by &quot;SIESTA_workers&quot;.</span>
    <span class="k">call </span><span class="n">broadcast</span><span class="p">(</span><span class="n">nscf</span><span class="p">,</span> <span class="n">comm</span><span class="o">=</span><span class="n">true_MPI_Comm_World</span><span class="p">)</span>
<span class="cp">#endif</span>

    <span class="c">!  Initialization tasks for a given geometry:</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">SIESTA_worker</span> <span class="p">)</span>  <span class="k">then</span>
<span class="k">       call </span><span class="n">state_init</span><span class="p">(</span> <span class="n">istep</span> <span class="p">)</span>
    <span class="k">end if</span>

<span class="cp">#ifdef SIESTA__PEXSI</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ionode</span><span class="p">)</span> <span class="k">call </span><span class="n">memory_snapshot</span><span class="p">(</span><span class="s2">&quot;after state_init&quot;</span><span class="p">)</span>
<span class="cp">#endif</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">fdf_get</span><span class="p">(</span><span class="s2">&quot;Sonly&quot;</span><span class="p">,.</span><span class="n">false</span><span class="p">.)</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">       if</span> <span class="p">(</span> <span class="n">SIESTA_worker</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">          call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="mi">2</span> <span class="p">)</span>
          <span class="k">call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="mi">3</span> <span class="p">)</span>
       <span class="k">end if</span>
<span class="k">       call </span><span class="n">bye</span><span class="p">(</span><span class="s2">&quot;S only&quot;</span><span class="p">)</span>
    <span class="k">end if</span>

<span class="k">    </span><span class="n">Qcur</span> <span class="o">=</span> <span class="n">Qtot</span>
    
<span class="cp">#ifdef SIESTA__FLOOK</span>
    <span class="c">! Add the iscf constant to the list of variables</span>
    <span class="c">! that are available only in this part of the routine.</span>
    <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.iteration&#39;</span><span class="p">,</span><span class="n">iscf</span><span class="p">)</span>
    <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.converged&#39;</span><span class="p">,</span><span class="n">SCFconverged</span><span class="p">)</span>
    <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.charge&#39;</span><span class="p">,</span><span class="n">Qcur</span><span class="p">)</span>
    <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.dD&#39;</span><span class="p">,</span><span class="n">dDmax</span><span class="p">)</span>
    <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.dH&#39;</span><span class="p">,</span><span class="n">dHmax</span><span class="p">)</span>
    <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.dE&#39;</span><span class="p">,</span><span class="n">dEmax</span><span class="p">)</span>
    <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.drhoG&#39;</span><span class="p">,</span><span class="n">drhog</span><span class="p">)</span>
    <span class="c">! We have to set the meshcutoff here</span>
    <span class="c">! because the asked and required ones are not</span>
    <span class="c">! necessarily the same</span>
    <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;Mesh.Cutoff.Minimum&#39;</span><span class="p">,</span><span class="n">G2cut</span><span class="p">)</span>
    <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;Mesh.Cutoff.Used&#39;</span><span class="p">,</span><span class="n">G2max</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">mix_charge</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">      call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Weight&#39;</span><span class="p">,</span> <span class="n">wmix</span><span class="p">)</span>
    <span class="k">else</span>
<span class="k">      call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Weight&#39;</span><span class="p">,</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">w</span><span class="p">)</span>
      <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Restart&#39;</span><span class="p">,</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">restart</span><span class="p">)</span>
      <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Iterations&#39;</span><span class="p">,</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">n_itt</span><span class="p">)</span>
      
      <span class="c">! Just to populate the table in the dictionary</span>
      <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Switch&#39;</span><span class="p">,</span><span class="n">next_mixer</span><span class="p">)</span>
    <span class="k">end if</span>

    <span class="c">! Initialize to no switch</span>
    <span class="n">next_mixer</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
<span class="cp">#endif</span>

    <span class="c">!  This call computes the **non-scf** part of \( H \) and initializes the</span>
    <span class="c">!  real-space grid structures:</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">SIESTA_worker</span> <span class="p">)</span> <span class="k">call </span><span class="n">setup_H0</span><span class="p">(</span><span class="n">G2max</span><span class="p">)</span>
    <span class="c">!!@todo</span>
    <span class="c">!* It might be better to split the two,</span>
    <span class="c">!  putting the grid initialization into **state_init (link!)** and moving the</span>
    <span class="c">!  calculation of \( H_0 \) to the body of the loop, done `if first_scf=.true.`</span>
    <span class="c">!  This would suit _analysis_ runs in which **nscf = 0**</span>
    <span class="c">!!@endtodo</span>

<span class="cp">#ifdef SIESTA__PEXSI</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ionode</span><span class="p">)</span> <span class="k">call </span><span class="n">memory_snapshot</span><span class="p">(</span><span class="s2">&quot;after setup_H0&quot;</span><span class="p">)</span>
<span class="cp">#endif</span>

<span class="cp">#ifdef SIESTA__FLOOK</span>
    <span class="c">! Communicate with lua, just before entering the SCF loop</span>
    <span class="c">! This is mainly to be able to communicate</span>
    <span class="c">! mesh-related quantities (g2max)</span>
    <span class="k">call </span><span class="n">slua_call</span><span class="p">(</span><span class="n">LUA</span><span class="p">,</span> <span class="n">LUA_INIT_MD</span><span class="p">)</span>
<span class="cp">#endif</span>

<span class="cp">#ifdef NCDF_4</span>
    <span class="c">! Initialize the NC file</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">write_cdf</span> <span class="p">)</span> <span class="k">then</span>

       <span class="c">! Initialize the file...</span>
       <span class="k">call </span><span class="n">cdf_init_file</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.nc&#39;</span><span class="p">,</span><span class="n">is_MD</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.)</span>
<span class="cp">#ifdef MPI</span>
       <span class="k">call </span><span class="n">MPI_Barrier</span><span class="p">(</span><span class="n">MPI_Comm_World</span><span class="p">,</span><span class="n">MPIerror</span><span class="p">)</span>
<span class="cp">#endif</span>

       <span class="c">! Save the settings</span>
       <span class="k">call </span><span class="n">cdf_save_settings</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.nc&#39;</span><span class="p">)</span>
<span class="cp">#ifdef MPI</span>
       <span class="k">call </span><span class="n">MPI_Barrier</span><span class="p">(</span><span class="n">MPI_Comm_World</span><span class="p">,</span><span class="n">MPIerror</span><span class="p">)</span>
<span class="cp">#endif</span>
       
       <span class="n">d_sav</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;sp&#39;</span><span class="p">.</span><span class="n">kv</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">.</span><span class="n">kv</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">d_sav</span> <span class="o">=</span> <span class="n">d_sav</span><span class="o">//</span><span class="p">(</span><span class="s1">&#39;nsc&#39;</span><span class="p">.</span><span class="n">kv</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="p">(</span><span class="s1">&#39;xij&#39;</span><span class="p">.</span><span class="n">kv</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">d_sav</span> <span class="o">=</span> <span class="n">d_sav</span><span class="o">//</span><span class="p">(</span><span class="s1">&#39;xa&#39;</span><span class="p">.</span><span class="n">kv</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="p">(</span><span class="s1">&#39;cell&#39;</span><span class="p">.</span><span class="n">kv</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">d_sav</span> <span class="o">=</span> <span class="n">d_sav</span><span class="o">//</span><span class="p">(</span><span class="s1">&#39;isc_off&#39;</span><span class="p">.</span><span class="n">kv</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span>
       <span class="k">call </span><span class="n">cdf_save_state</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.nc&#39;</span><span class="p">,</span><span class="n">d_sav</span><span class="p">)</span>
       <span class="k">call </span><span class="n">delete</span><span class="p">(</span><span class="n">d_sav</span><span class="p">)</span>

       <span class="c">! Save the basis set</span>
       <span class="k">call </span><span class="n">cdf_save_basis</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.nc&#39;</span><span class="p">)</span>

    <span class="k">end if</span>
<span class="cp">#endif</span>

    <span class="c">!* The dHmax variable only has meaning for Hamiltonian</span>
    <span class="c">!  mixing, or when requiring the Hamiltonian to be converged.</span>
    <span class="n">dDmax</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1._dp</span>
    <span class="n">dHmax</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1._dp</span>
    <span class="n">dEmax</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1._dp</span>
    <span class="n">drhog</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1._dp</span>

    <span class="c">! Setup convergence criteria:</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">SIESTA_worker</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">       if</span> <span class="p">(</span> <span class="n">converge_Eharr</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">          call </span><span class="n">reset</span><span class="p">(</span><span class="n">conv_harris</span><span class="p">)</span>
          <span class="k">call </span><span class="n">set_tolerance</span><span class="p">(</span><span class="n">conv_harris</span><span class="p">,</span><span class="n">tolerance_Eharr</span><span class="p">)</span>
       <span class="k">end if</span>
<span class="k">       if</span> <span class="p">(</span> <span class="n">converge_FreeE</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">          call </span><span class="n">reset</span><span class="p">(</span><span class="n">conv_FreeE</span><span class="p">)</span>
          <span class="k">call </span><span class="n">set_tolerance</span><span class="p">(</span><span class="n">conv_FreeE</span><span class="p">,</span><span class="n">tolerance_FreeE</span><span class="p">)</span>
       <span class="k">end if</span>
<span class="k">    end if</span>

    <span class="c">!!# SCF loop</span>
    <span class="c">!* The current structure of the loop tries to reproduce the</span>
    <span class="c">!  historical Siesta usage. It should be made more clear.</span>

    <span class="c">!* Two changes:</span>
    <span class="c">!</span>
    <span class="c">!  1. The number of scf iterations performed is exactly</span>
    <span class="c">!     equal to the number specified (i.e., the &quot;forces&quot;</span>
    <span class="c">!     phase is not counted as a final scf step)</span>
    <span class="c">!  2. At the change to a TranSiesta GF run the variable &quot;first_scf&quot;</span>
    <span class="c">!     is implicitly reset to &quot;true&quot;.</span>
    <span class="c">!</span>

    <span class="c">!!## Start of SCF cycle</span>
    <span class="c">!</span>
    <span class="c">!* Conditions of exit:</span>
    <span class="c">!</span>
    <span class="c">!  * At the top, to catch a non-positive nscf and # of iterations</span>
    <span class="c">!  * At the bottom, based on convergence</span>
    <span class="c">!</span>
    <span class="n">iscf</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">do while</span> <span class="p">(</span> <span class="n">iscf</span> <span class="o">&lt;</span> <span class="n">nscf</span> <span class="p">)</span>

       <span class="n">iscf</span> <span class="o">=</span> <span class="n">iscf</span> <span class="o">+</span> <span class="mi">1</span>

       <span class="c">!* Note implications for TranSiesta when mixing \(H\).</span>
       <span class="c">!  Now \(H\) will be recomputed instead of simply being</span>
       <span class="c">!  inherited, however, this is required as if</span>
       <span class="c">!  we have bias calculations as the electric</span>
       <span class="c">!  field across the junction needs to be present.</span>

       <span class="n">first_scf</span> <span class="o">=</span> <span class="p">(</span><span class="n">iscf</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>

       <span class="k">if</span> <span class="p">(</span> <span class="n">SIESTA_worker</span> <span class="p">)</span> <span class="k">then</span>

          <span class="c">! Check whether we are short of time to continue</span>
          <span class="k">call </span><span class="n">check_walltime</span><span class="p">(</span><span class="n">time_is_up</span><span class="p">)</span>
          <span class="k">if</span> <span class="p">(</span> <span class="n">time_is_up</span> <span class="p">)</span> <span class="k">then</span>
             <span class="c">! Save DM/H if we were not saving it...</span>
             <span class="c">!   Do any other bookeeping not done by &quot;die&quot;</span>
             <span class="k">call </span><span class="n">timer</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
             <span class="k">call </span><span class="n">timer</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
             <span class="k">call </span><span class="n">message</span><span class="p">(</span><span class="s1">&#39;WARNING&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
                  <span class="s1">&#39;SCF_NOT_CONV: SCF did not converge&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
                  <span class="s1">&#39; before wall time exhaustion&#39;</span><span class="p">)</span>
             <span class="k">write</span><span class="p">(</span><span class="n">tmp_str</span><span class="p">,</span><span class="s2">&quot;(2(i5,tr1),f12.6)&quot;</span><span class="p">)</span> <span class="n">istep</span><span class="p">,</span> <span class="n">iscf</span><span class="p">,</span> <span class="n">prevDmax</span>
             <span class="k">call </span><span class="n">message</span><span class="p">(</span><span class="s1">&#39; (info)&#39;</span><span class="p">,</span><span class="s2">&quot;Geom step, scf iteration, dmax:&quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">tmp_str</span><span class="p">))</span>
             
             <span class="k">call </span><span class="n">barrier</span><span class="p">()</span> <span class="c">! A non-root node might get first to the &#39;die&#39; call</span>
             <span class="k">call </span><span class="n">die</span><span class="p">(</span><span class="s2">&quot;OUT_OF_TIME: Time is up.&quot;</span><span class="p">)</span>

          <span class="k">end if</span>

<span class="k">          call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;IterSCF&#39;</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">cml_p</span><span class="p">)</span> <span class="p">&amp;</span>
               <span class="k">call </span><span class="n">cmlStartStep</span><span class="p">(</span> <span class="n">xf</span><span class="o">=</span><span class="n">mainXML</span><span class="p">,</span> <span class="k">type</span><span class="o">=</span><span class="s1">&#39;SCF&#39;</span><span class="p">,</span> <span class="nb">index</span><span class="o">=</span><span class="n">iscf</span> <span class="p">)</span>

          <span class="k">if</span> <span class="p">(</span> <span class="n">mixH</span> <span class="p">)</span> <span class="k">then</span>

<span class="k">             if</span> <span class="p">(</span> <span class="n">first_scf</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">                if</span> <span class="p">(</span><span class="n">fdf_get</span><span class="p">(</span><span class="s2">&quot;Read-H-from-file&quot;</span><span class="p">,.</span><span class="n">false</span><span class="p">.))</span> <span class="k">then</span>
<span class="k">                   call </span><span class="n">get_H_from_file</span><span class="p">()</span>
                <span class="k">else</span>
<span class="k">                   call </span><span class="n">setup_hamiltonian</span><span class="p">(</span> <span class="n">iscf</span> <span class="p">)</span>
                <span class="k">end if</span>
<span class="k">             end if</span>

<span class="k">             call </span><span class="n">compute_DM</span><span class="p">(</span> <span class="n">iscf</span> <span class="p">)</span>

             <span class="c">! Maybe set Dold to zero if reading charge or H...</span>
             <span class="k">call </span><span class="n">compute_max_diff</span><span class="p">(</span><span class="n">Dold</span><span class="p">,</span> <span class="n">Dscf</span><span class="p">,</span> <span class="n">dDmax</span><span class="p">)</span>
             <span class="k">if</span> <span class="p">(</span> <span class="n">converge_EDM</span> <span class="p">)</span> <span class="p">&amp;</span>
                  <span class="k">call </span><span class="n">compute_max_diff</span><span class="p">(</span><span class="n">Eold</span><span class="p">,</span> <span class="n">Escf</span><span class="p">,</span> <span class="n">dEmax</span><span class="p">)</span>
             <span class="k">call </span><span class="n">setup_hamiltonian</span><span class="p">(</span> <span class="n">iscf</span> <span class="p">)</span>
             <span class="k">call </span><span class="n">compute_max_diff</span><span class="p">(</span><span class="n">Hold</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">dHmax</span><span class="p">)</span>

          <span class="k">else</span>

<span class="k">             call </span><span class="n">setup_hamiltonian</span><span class="p">(</span> <span class="n">iscf</span> <span class="p">)</span>
             <span class="k">call </span><span class="n">compute_max_diff</span><span class="p">(</span><span class="n">Hold</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">dHmax</span><span class="p">)</span>

             <span class="k">call </span><span class="n">compute_DM</span><span class="p">(</span> <span class="n">iscf</span> <span class="p">)</span>

             <span class="k">call </span><span class="n">compute_max_diff</span><span class="p">(</span><span class="n">Dold</span><span class="p">,</span> <span class="n">Dscf</span><span class="p">,</span> <span class="n">dDmax</span><span class="p">)</span>
             <span class="k">if</span> <span class="p">(</span> <span class="n">converge_EDM</span> <span class="p">)</span> <span class="p">&amp;</span>
                  <span class="k">call </span><span class="n">compute_max_diff</span><span class="p">(</span><span class="n">Eold</span><span class="p">,</span> <span class="n">Escf</span><span class="p">,</span> <span class="n">dEmax</span><span class="p">)</span>

          <span class="k">end if</span>

          <span class="c">! This iteration has completed calculating the new DM</span>

          <span class="k">call </span><span class="n">compute_energies</span><span class="p">(</span> <span class="n">iscf</span> <span class="p">)</span>
          <span class="k">if</span> <span class="p">(</span> <span class="n">mix_charge</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">             call </span><span class="n">compute_charge_diff</span><span class="p">(</span> <span class="n">drhog</span> <span class="p">)</span>
          <span class="k">end if</span>

          <span class="c">! Note: For DM and H convergence checks. At this point:</span>
          <span class="c">! If mixing the DM:</span>
          <span class="c">!        Dscf=DM_out, Dold=DM_in(mixed), H=H_in, Hold=H_in(prev step)</span>
          <span class="c">!        dDmax=maxdiff(DM_out,DM_in)</span>
          <span class="c">!        dHmax=maxdiff(H_in - H_in(prev step))</span>
          <span class="c">! If mixing the Hamiltonian:</span>
          <span class="c">!        Dscf=DM_out, Dold=DM_in, H=H_(DM_out), Hold=H_in(mixed)</span>
          <span class="c">!        dDmax=maxdiff(DM_out,DM_in)</span>
          <span class="c">!        dHmax=maxdiff(H(DM_out),H_in)</span>
          <span class="k">call </span><span class="n">scfconvergence_test</span><span class="p">(</span> <span class="n">first_scf</span><span class="p">,</span> <span class="n">iscf</span><span class="p">,</span> <span class="p">&amp;</span>
               <span class="n">dDmax</span><span class="p">,</span> <span class="n">dHmax</span><span class="p">,</span> <span class="n">dEmax</span><span class="p">,</span> <span class="p">&amp;</span>
               <span class="n">conv_harris</span><span class="p">,</span> <span class="n">conv_freeE</span><span class="p">,</span> <span class="p">&amp;</span>
               <span class="n">SCFconverged</span> <span class="p">)</span>

          <span class="c">! ** Check this heuristic</span>
          <span class="k">if</span> <span class="p">(</span> <span class="n">mixH</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">             </span><span class="n">prevDmax</span> <span class="o">=</span> <span class="n">dHmax</span>
          <span class="k">else</span>
<span class="k">             </span><span class="n">prevDmax</span> <span class="o">=</span> <span class="n">dDmax</span>
          <span class="k">end if</span>

          <span class="c">! Calculate current charge based on the density matrix</span>
          <span class="k">call </span><span class="n">dm_charge</span><span class="p">(</span><span class="n">spin</span><span class="p">,</span> <span class="n">DM_2D</span><span class="p">,</span> <span class="n">S_1D</span><span class="p">,</span> <span class="n">Qcur</span><span class="p">)</span>


          <span class="c">! Check whether we should step to the next mixer</span>
          <span class="k">call </span><span class="n">mixing_scf_converged</span><span class="p">(</span> <span class="n">SCFconverged</span> <span class="p">)</span>

          <span class="k">if</span> <span class="p">(</span> <span class="n">SCFconverged</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">iscf</span> <span class="o">&lt;</span> <span class="n">min_nscf</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">             </span><span class="n">SCFconverged</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
             <span class="k">if</span> <span class="p">(</span> <span class="n">IONode</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">                write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s2">&quot;(a,i0)&quot;</span><span class="p">)</span> <span class="p">&amp;</span>
                     <span class="s2">&quot;SCF cycle continued for minimum number of iterations: &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">min_nscf</span>
             <span class="k">end if</span>
<span class="k">          end if</span>

          <span class="c">! In case the user has requested a Fermi-level correction</span>
          <span class="c">! Then we start by correcting the fermi-level</span>
          <span class="k">if</span> <span class="p">(</span> <span class="n">TSrun</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">SCFconverged</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
               <span class="n">TS_RHOCORR_METHOD</span> <span class="o">==</span> <span class="n">TS_RHOCORR_FERMI</span> <span class="p">)</span> <span class="k">then</span>

<span class="k">             if</span> <span class="p">(</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Qcur</span> <span class="o">-</span> <span class="n">Qtot</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">TS_RHOCORR_FERMI_TOLERANCE</span> <span class="p">)</span> <span class="k">then</span>

                <span class="c">! Call transiesta with fermi-correct</span>
                <span class="k">call </span><span class="n">transiesta</span><span class="p">(</span><span class="n">iscf</span><span class="p">,</span><span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">block_dist</span><span class="p">,</span> <span class="n">sparse_pattern</span><span class="p">,</span> <span class="n">Gamma_Scf</span><span class="p">,</span> <span class="n">ucell</span><span class="p">,</span> <span class="n">nsc</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">isc_off</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">Dscf</span><span class="p">,</span> <span class="n">Escf</span><span class="p">,</span> <span class="n">Ef</span><span class="p">,</span> <span class="n">Qtot</span><span class="p">,</span> <span class="p">.</span><span class="n">true</span><span class="p">.,</span> <span class="n">DE_NEGF</span><span class="p">)</span>

                <span class="c">! We will not have not converged as we have just</span>
                <span class="c">! changed the Fermi-level</span>
                <span class="n">SCFconverged</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>

             <span class="k">end if</span>

<span class="k">          end if</span>

<span class="k">          if</span> <span class="p">(</span> <span class="n">monitor_forces_in_scf</span> <span class="p">)</span> <span class="k">call </span><span class="n">compute_forces</span><span class="p">()</span>

          <span class="c">! Mix_after_convergence preserves the old behavior of</span>
          <span class="c">! the program.</span>
          <span class="k">if</span> <span class="p">(</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SCFconverged</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">mix_after_convergence</span><span class="p">)</span> <span class="k">then</span>

             <span class="c">! Mix for next step</span>
             <span class="k">if</span> <span class="p">(</span> <span class="n">mix_charge</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">                call </span><span class="n">mix_rhog</span><span class="p">(</span> <span class="n">iscf</span> <span class="p">)</span>
             <span class="k">else</span>
<span class="k">                call </span><span class="n">mixer</span><span class="p">(</span> <span class="n">iscf</span> <span class="p">)</span>
             <span class="k">end if</span>

             <span class="c">! Save for possible restarts</span>
             <span class="k">if</span> <span class="p">(</span> <span class="n">mixH</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">                call </span><span class="n">write_spmatrix</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="k">file</span><span class="o">=</span><span class="s2">&quot;H_MIXED&quot;</span><span class="p">,</span><span class="n">when</span><span class="o">=</span><span class="n">writeH</span><span class="p">)</span>
                <span class="k">call </span><span class="n">save_density_matrix</span><span class="p">(</span><span class="k">file</span><span class="o">=</span><span class="s2">&quot;DM_OUT&quot;</span><span class="p">,</span><span class="n">when</span><span class="o">=</span><span class="n">writeDM</span><span class="p">)</span>
             <span class="k">else</span>
<span class="k">                call </span><span class="n">save_density_matrix</span><span class="p">(</span><span class="k">file</span><span class="o">=</span><span class="s2">&quot;DM_MIXED&quot;</span><span class="p">,</span><span class="n">when</span><span class="o">=</span><span class="n">writeDM</span><span class="p">)</span>
                <span class="k">call </span><span class="n">write_spmatrix</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="k">file</span><span class="o">=</span><span class="s2">&quot;H_DMGEN&quot;</span><span class="p">,</span><span class="n">when</span><span class="o">=</span><span class="n">writeH</span><span class="p">)</span>
             <span class="k">end if</span>
<span class="k">          end if</span>

<span class="k">          call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;IterSCF&#39;</span><span class="p">,</span> <span class="mi">2</span> <span class="p">)</span>
          <span class="k">call </span><span class="n">print_timings</span><span class="p">(</span> <span class="n">first_scf</span><span class="p">,</span> <span class="n">istep</span> <span class="o">==</span> <span class="n">inicoor</span> <span class="p">)</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">cml_p</span><span class="p">)</span> <span class="k">call </span><span class="n">cmlEndStep</span><span class="p">(</span><span class="n">mainXML</span><span class="p">)</span>

<span class="cp">#ifdef SIESTA__FLOOK</span>
          <span class="c">! Communicate with lua</span>
          <span class="k">call </span><span class="n">slua_call</span><span class="p">(</span><span class="n">LUA</span><span class="p">,</span> <span class="n">LUA_SCF_LOOP</span><span class="p">)</span>

          <span class="c">! Retrieve an easy character string</span>
          <span class="n">nnext_mixer</span> <span class="o">=</span> <span class="n">cunpack</span><span class="p">(</span><span class="n">next_mixer</span><span class="p">)</span>
          <span class="k">if</span> <span class="p">(</span> <span class="nb">len_trim</span><span class="p">(</span><span class="n">nnext_mixer</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">mix_charge</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">             if</span> <span class="p">(</span> <span class="n">TSrun</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">                do </span><span class="n">imix</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">ts_scf_mixs</span><span class="p">)</span>
                   <span class="k">if</span> <span class="p">(</span> <span class="n">ts_scf_mixs</span><span class="p">(</span><span class="n">imix</span><span class="p">)%</span><span class="n">name</span> <span class="o">==</span> <span class="n">nnext_mixer</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">                      call </span><span class="n">mixers_history_init</span><span class="p">(</span><span class="n">ts_scf_mixs</span><span class="p">)</span>
                      <span class="n">scf_mix</span> <span class="o">=&gt;</span> <span class="n">ts_scf_mixs</span><span class="p">(</span><span class="n">imix</span><span class="p">)</span>
                      <span class="k">exit</span>
<span class="k">                   end if</span>
<span class="k">                end do</span>
<span class="k">             else</span>
<span class="k">                do </span><span class="n">imix</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">scf_mixs</span><span class="p">)</span>
                   <span class="k">if</span> <span class="p">(</span> <span class="n">scf_mixs</span><span class="p">(</span><span class="n">imix</span><span class="p">)%</span><span class="n">name</span> <span class="o">==</span> <span class="n">nnext_mixer</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">                      call </span><span class="n">mixers_history_init</span><span class="p">(</span><span class="n">scf_mixs</span><span class="p">)</span>
                      <span class="n">scf_mix</span> <span class="o">=&gt;</span> <span class="n">scf_mixs</span><span class="p">(</span><span class="n">imix</span><span class="p">)</span>
                      <span class="k">exit</span>
<span class="k">                   end if</span>
<span class="k">                end do</span>
<span class="k">             end if</span>

             <span class="c">! Check that we indeed have changed the mixer</span>
             <span class="k">if</span> <span class="p">(</span> <span class="n">IONode</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">scf_mix</span><span class="p">%</span><span class="n">name</span> <span class="o">/=</span> <span class="n">nnext_mixer</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">                write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(2a)&#39;</span><span class="p">)</span> <span class="s1">&#39;siesta-lua: WARNING: trying to change &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="s1">&#39;to a non-existing mixer! Not changing anything!&#39;</span>

             <span class="k">else if</span> <span class="p">(</span> <span class="n">IONode</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">                write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(2a)&#39;</span><span class="p">)</span> <span class="s1">&#39;siesta-lua: Switching mixer method to: &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="nb">trim</span><span class="p">(</span><span class="n">nnext_mixer</span><span class="p">)</span>

             <span class="k">end if</span>
             <span class="c">! Reset for next loop</span>
             <span class="n">next_mixer</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>

             <span class="c">! Update the references</span>
             <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Weight&#39;</span><span class="p">,</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">w</span><span class="p">)</span>
             <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Restart&#39;</span><span class="p">,</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">restart</span><span class="p">)</span>
             <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Iterations&#39;</span><span class="p">,</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">n_itt</span><span class="p">)</span>

          <span class="k">end if</span>
<span class="cp">#endif</span>

          <span class="c">! ... except that we might continue for TranSiesta</span>
          <span class="k">if</span> <span class="p">(</span> <span class="n">SCFconverged</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">             call </span><span class="n">transiesta_switch</span><span class="p">()</span>
             <span class="c">! might reset SCFconverged and iscf</span>
          <span class="k">end if</span>

<span class="k">       else</span>

          <span class="c">! non-siesta worker</span>
          <span class="k">call </span><span class="n">compute_DM</span><span class="p">(</span> <span class="n">iscf</span> <span class="p">)</span>

       <span class="k">end if</span>

<span class="cp">#ifdef SIESTA__PEXSI</span>
       <span class="k">call </span><span class="n">broadcast</span><span class="p">(</span><span class="n">iscf</span><span class="p">,</span> <span class="n">comm</span><span class="o">=</span><span class="n">true_MPI_Comm_World</span><span class="p">)</span>
       <span class="k">call </span><span class="n">broadcast</span><span class="p">(</span><span class="n">SCFconverged</span><span class="p">,</span> <span class="n">comm</span><span class="o">=</span><span class="n">true_MPI_Comm_World</span><span class="p">)</span>
<span class="cp">#endif</span>

       <span class="c">!  Exit if converged:</span>
       <span class="k">if</span> <span class="p">(</span> <span class="n">SCFconverged</span> <span class="p">)</span> <span class="k">exit</span>

<span class="k">    end do</span>
    <span class="c">!! **end of SCF cycle**</span>

<span class="cp">#ifdef SIESTA__PEXSI</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">isolve</span> <span class="o">==</span> <span class="n">SOLVE_PEXSI</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">       call </span><span class="n">pexsi_finalize_scfloop</span><span class="p">()</span>
    <span class="k">end if</span>
<span class="cp">#endif</span>

    <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SIESTA_worker</span> <span class="p">)</span> <span class="k">return</span>

<span class="k">    call </span><span class="n">end_of_cycle_save_operations</span><span class="p">()</span>

    <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SCFconverged</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">       if</span> <span class="p">(</span> <span class="n">SCFMustConverge</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">          call </span><span class="n">message</span><span class="p">(</span><span class="s1">&#39;FATAL&#39;</span><span class="p">,</span><span class="s1">&#39;SCF_NOT_CONV: SCF did not converge&#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
               <span class="s1">&#39; in maximum number of steps (required).&#39;</span><span class="p">)</span>
          <span class="k">write</span><span class="p">(</span><span class="n">tmp_str</span><span class="p">,</span><span class="s2">&quot;(2(i5,tr1),f12.6)&quot;</span><span class="p">)</span> <span class="n">istep</span><span class="p">,</span> <span class="n">iscf</span><span class="p">,</span> <span class="n">prevDmax</span>
          <span class="k">call </span><span class="n">message</span><span class="p">(</span><span class="s1">&#39; (info)&#39;</span><span class="p">,</span><span class="s2">&quot;Geom step, scf iteration, dmax:&quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">tmp_str</span><span class="p">))</span>
          <span class="k">call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="mi">2</span> <span class="p">)</span> <span class="c">! New call to close the tree</span>
          <span class="k">call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="mi">3</span> <span class="p">)</span>
          <span class="k">call </span><span class="n">barrier</span><span class="p">()</span>
          <span class="k">call </span><span class="n">die</span><span class="p">(</span><span class="s1">&#39;ABNORMAL_TERMINATION&#39;</span><span class="p">)</span>
       <span class="k">else if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">harrisfun</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">          call </span><span class="n">message</span><span class="p">(</span><span class="s1">&#39;WARNING&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
               <span class="s1">&#39;SCF_NOT_CONV: SCF did not converge  in maximum number of steps.&#39;</span><span class="p">)</span>
          <span class="k">write</span><span class="p">(</span><span class="n">tmp_str</span><span class="p">,</span><span class="s2">&quot;(2(i5,tr1),f12.6)&quot;</span><span class="p">)</span> <span class="n">istep</span><span class="p">,</span> <span class="n">iscf</span><span class="p">,</span> <span class="n">prevDmax</span>
          <span class="k">call </span><span class="n">message</span><span class="p">(</span><span class="s1">&#39; (info)&#39;</span><span class="p">,</span><span class="s2">&quot;Geom step, scf iteration, dmax:&quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">tmp_str</span><span class="p">))</span>
       <span class="k">end if</span>
<span class="k">    end if</span>

    <span class="c">! To write the initial wavefunctions to be used in a</span>
    <span class="c">! consequent TDDFT run.</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">writetdwf</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">       </span><span class="n">istpp</span> <span class="o">=</span> <span class="mi">0</span>
       <span class="k">call </span><span class="n">initwf</span><span class="p">(</span><span class="n">istpp</span><span class="p">,</span><span class="n">totime</span><span class="p">)</span>
    <span class="k">end if</span>
<span class="k">    </span>
<span class="k">    if</span> <span class="p">(</span> <span class="n">TSmode</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">TSinit</span><span class="p">.</span><span class="nb">and</span><span class="p">.(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SCFConverged</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
       <span class="c">! Signal that the DM hasn&#39;t converged, so we cannot</span>
       <span class="c">! continue to the transiesta routines</span>
       <span class="k">call </span><span class="n">die</span><span class="p">(</span><span class="s1">&#39;ABNORMAL_TERMINATION&#39;</span><span class="p">)</span>
    <span class="k">end if</span>
    
    <span class="c">! Clean-up here to limit memory usage</span>
    <span class="k">call </span><span class="n">mixers_scf_history_init</span><span class="p">(</span> <span class="p">)</span>
    
    <span class="c">! End of standard SCF loop.</span>
    <span class="c">! Do one more pass to compute forces and stresses</span>
    
    <span class="c">! Note that this call will no longer overwrite H while computing the</span>
    <span class="c">! final energies, forces and stresses...</span>
    
    <span class="k">if</span> <span class="p">(</span> <span class="n">fdf_get</span><span class="p">(</span><span class="s2">&quot;compute-forces&quot;</span><span class="p">,.</span><span class="n">true</span><span class="p">.)</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">       call </span><span class="n">post_scf_work</span><span class="p">(</span> <span class="n">istep</span><span class="p">,</span> <span class="n">iscf</span> <span class="p">,</span> <span class="n">SCFconverged</span> <span class="p">)</span>
<span class="cp">#ifdef SIESTA__PEXSI</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">ionode</span><span class="p">)</span> <span class="k">call </span><span class="n">memory_snapshot</span><span class="p">(</span><span class="s2">&quot;after post_scf_work&quot;</span><span class="p">)</span>
<span class="cp">#endif</span>
    <span class="k">end if</span>
    
    <span class="c">! ... so H at this point is the latest generator of the DM, except</span>
    <span class="c">! if mixing H beyond self-consistency or terminating the scf loop</span>
    <span class="c">! without convergence while mixing H</span>
    
    <span class="k">call </span><span class="n">state_analysis</span><span class="p">(</span> <span class="n">istep</span> <span class="p">)</span>
<span class="cp">#ifdef SIESTA__PEXSI</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ionode</span><span class="p">)</span> <span class="k">call </span><span class="n">memory_snapshot</span><span class="p">(</span><span class="s2">&quot;after state_analysis&quot;</span><span class="p">)</span>
<span class="cp">#endif</span>

    <span class="c">! If siesta is running as a subroutine, send forces to master program</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">siesta_server</span><span class="p">)</span> <span class="p">&amp;</span>
         <span class="k">call </span><span class="n">forcesToMaster</span><span class="p">(</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">Etot</span><span class="p">,</span> <span class="n">cfa</span><span class="p">,</span> <span class="n">cstress</span> <span class="p">)</span>

<span class="cp">#ifdef DEBUG</span>
    <span class="k">call </span><span class="n">write_debug</span><span class="p">(</span> <span class="s1">&#39;    POS siesta_forces&#39;</span> <span class="p">)</span>
<span class="cp">#endif</span>
    
  <span class="k">contains</span>

    <span class="c">! Read the Hamiltonian from a file</span>
    <span class="k">subroutine </span><span class="n">get_H_from_file</span><span class="p">()</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">listhptr</span>
      <span class="k">use </span><span class="n">atomlist</span><span class="p">,</span>        <span class="n">only</span><span class="p">:</span> <span class="n">no_l</span>
      <span class="k">use </span><span class="n">m_spin</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">spin</span>
      <span class="k">use </span><span class="n">m_iodm_old</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">read_spmatrix</span>

      <span class="kt">logical</span> <span class="kd">::</span> <span class="n">found</span>

      <span class="k">call </span><span class="n">read_spmatrix</span><span class="p">(</span><span class="n">maxnh</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="p">&amp;</span>
           <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">userfile</span><span class="o">=</span><span class="s2">&quot;H_IN&quot;</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">found</span><span class="p">)</span> <span class="k">call </span><span class="n">die</span><span class="p">(</span><span class="s2">&quot;Could not find H_IN&quot;</span><span class="p">)</span>

    <span class="k">end subroutine </span><span class="n">get_H_from_file</span>

    <span class="c">! Computes forces and stresses with the current DM_out</span>
    <span class="k">subroutine </span><span class="n">compute_forces</span><span class="p">()</span>

      <span class="k">use </span><span class="n">siesta_options</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">recompute_H_after_scf</span>
      <span class="k">use </span><span class="n">m_final_H_f_stress</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">final_H_f_stress</span>
      <span class="k">use </span><span class="n">write_subs</span>

      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">fa_old</span><span class="p">(:,:),</span> <span class="n">Hsave</span><span class="p">(:,:)</span>

      <span class="k">allocate</span><span class="p">(</span><span class="n">fa_old</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">fa</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">fa</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)))</span>
      <span class="n">fa_old</span><span class="p">(:,:)</span> <span class="o">=</span> <span class="n">fa</span><span class="p">(:,:)</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">recompute_H_after_scf</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">         allocate</span><span class="p">(</span><span class="n">Hsave</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)))</span>
         <span class="n">Hsave</span><span class="p">(:,:)</span> <span class="o">=</span> <span class="n">H</span><span class="p">(:,:)</span>
      <span class="k">end if</span>
<span class="k">      call </span><span class="n">final_H_f_stress</span><span class="p">(</span> <span class="n">istep</span> <span class="p">,</span> <span class="n">iscf</span> <span class="p">,</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">recompute_H_after_scf</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">         </span><span class="n">H</span><span class="p">(:,:)</span> <span class="o">=</span> <span class="n">Hsave</span><span class="p">(:,:)</span>
         <span class="k">deallocate</span><span class="p">(</span><span class="n">Hsave</span><span class="p">)</span>
      <span class="k">end if</span>
<span class="k">      if</span> <span class="p">(</span><span class="n">ionode</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         print</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;Max diff in force (eV/Ang): &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
              <span class="nb">maxval</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">fa</span><span class="o">-</span><span class="n">fa_old</span><span class="p">))</span><span class="o">*</span><span class="n">Ang</span><span class="o">/</span><span class="n">eV</span>
         <span class="k">call </span><span class="n">siesta_write_forces</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
         <span class="k">call </span><span class="n">siesta_write_stress_pressure</span><span class="p">()</span>
      <span class="n">endif</span>
      <span class="k">deallocate</span><span class="p">(</span><span class="n">fa_old</span><span class="p">)</span>

    <span class="k">end subroutine </span><span class="n">compute_forces</span>

    <span class="c">! Print out timings of the first SCF loop only</span>
    <span class="k">subroutine </span><span class="n">print_timings</span><span class="p">(</span><span class="n">first_scf</span><span class="p">,</span> <span class="n">first_md</span><span class="p">)</span>
      <span class="k">use </span><span class="n">timer_options</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">use_tree_timer</span>
      <span class="k">use </span><span class="n">m_ts_global_vars</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">TSrun</span>
      <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">first_scf</span><span class="p">,</span> <span class="n">first_md</span>
      <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="kd">::</span> <span class="n">routine</span>

      <span class="c">! If this is not the first iteration,</span>
      <span class="c">! we immediately return.</span>
      <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">first_scf</span> <span class="p">)</span> <span class="k">return</span>
<span class="k">      if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">first_md</span> <span class="p">)</span> <span class="k">return</span>

<span class="k">      </span><span class="n">routine</span> <span class="o">=</span> <span class="s1">&#39;IterSCF&#39;</span>

      <span class="k">if</span> <span class="p">(</span> <span class="n">TSrun</span> <span class="p">)</span> <span class="k">then</span>
         <span class="c">! with Green function generation</span>
         <span class="c">! The tree-timer requires direct</span>
         <span class="c">! children of the routine to be</span>
         <span class="c">! queried.</span>
         <span class="c">! This is not obeyed in the TS case... :(</span>
         <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">use_tree_timer</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            </span><span class="n">routine</span> <span class="o">=</span> <span class="s1">&#39;TS&#39;</span>
         <span class="k">end if</span>
<span class="k">      </span><span class="n">endif</span>
      <span class="k">call </span><span class="n">timer</span><span class="p">(</span> <span class="n">routine</span><span class="p">,</span> <span class="mi">3</span> <span class="p">)</span>

    <span class="k">end subroutine </span><span class="n">print_timings</span>

    <span class="c">! Depending on various conditions, save the DMin</span>
    <span class="c">! or the DMout, and possibly keep a copy of H</span>

    <span class="c">! NOTE: Only if the scf cycle converged before exit it</span>
    <span class="c">! is guaranteed that the DM is &quot;pure out&quot; and that</span>
    <span class="c">! we can recover the right H if mixing H.</span>
    <span class="c">!</span>
    <span class="k">subroutine </span><span class="n">end_of_cycle_save_operations</span><span class="p">()</span>

      <span class="kt">logical</span> <span class="kd">::</span> <span class="n">DM_write</span><span class="p">,</span> <span class="n">H_write</span>

      <span class="c">! Depending on the option we should overwrite the</span>
      <span class="c">! Hamiltonian</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">mixH</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">mix_after_convergence</span> <span class="p">)</span> <span class="k">then</span>
         <span class="c">! Make sure that we keep the H actually used</span>
         <span class="c">! to generate the last DM, if needed.</span>
         <span class="n">H</span> <span class="o">=</span> <span class="n">Hold</span>
      <span class="k">end if</span>

<span class="k">      </span><span class="n">DM_write</span> <span class="o">=</span> <span class="n">write_DM_at_end_of_cycle</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
           <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">writeDM</span>
      <span class="n">H_write</span> <span class="o">=</span> <span class="n">write_H_at_end_of_cycle</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
           <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">writeH</span>

      <span class="k">if</span> <span class="p">(</span> <span class="n">mix_after_convergence</span> <span class="p">)</span> <span class="k">then</span>
         <span class="c">! If we have been saving them, there is no point in doing</span>
         <span class="c">! it one more time</span>
         <span class="k">if</span> <span class="p">(</span> <span class="n">mixH</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            call </span><span class="n">save_density_matrix</span><span class="p">(</span><span class="k">file</span><span class="o">=</span><span class="s2">&quot;DM_OUT&quot;</span><span class="p">,</span> <span class="n">when</span><span class="o">=</span><span class="n">DM_write</span><span class="p">)</span>
            <span class="k">call </span><span class="n">write_spmatrix</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="k">file</span><span class="o">=</span><span class="s2">&quot;H_MIXED&quot;</span><span class="p">,</span> <span class="n">when</span><span class="o">=</span><span class="n">H_write</span><span class="p">)</span>
         <span class="k">else</span>
<span class="k">            call </span><span class="n">save_density_matrix</span><span class="p">(</span><span class="k">file</span><span class="o">=</span><span class="s2">&quot;DM_MIXED&quot;</span><span class="p">,</span> <span class="n">when</span><span class="o">=</span><span class="n">DM_write</span><span class="p">)</span>
            <span class="k">call </span><span class="n">write_spmatrix</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="k">file</span><span class="o">=</span><span class="s2">&quot;H_DMGEN&quot;</span><span class="p">,</span> <span class="n">when</span><span class="o">=</span><span class="n">H_write</span><span class="p">)</span>
         <span class="k">end if</span>
<span class="k">      else</span>
<span class="k">         call </span><span class="n">save_density_matrix</span><span class="p">(</span><span class="k">file</span><span class="o">=</span><span class="s2">&quot;DM_OUT&quot;</span><span class="p">,</span> <span class="n">when</span><span class="o">=</span><span class="n">DM_write</span><span class="p">)</span>
         <span class="k">call </span><span class="n">write_spmatrix</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="k">file</span><span class="o">=</span><span class="s2">&quot;H_DMGEN&quot;</span><span class="p">,</span> <span class="n">when</span><span class="o">=</span><span class="n">H_write</span><span class="p">)</span>
      <span class="k">end if</span>

<span class="k">    end subroutine </span><span class="n">end_of_cycle_save_operations</span>

    <span class="k">subroutine </span><span class="n">transiesta_switch</span><span class="p">()</span>

      <span class="k">use </span><span class="nb">precision</span><span class="p">,</span>             <span class="n">only</span><span class="p">:</span> <span class="n">dp</span>
      <span class="k">use </span><span class="n">parallel</span><span class="p">,</span>              <span class="n">only</span><span class="p">:</span> <span class="n">IONode</span>
      <span class="k">use </span><span class="n">class_dSpData2D</span>
      <span class="k">use </span><span class="n">class_Fstack_dData1D</span>
      <span class="k">use </span><span class="n">densematrix</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">resetDenseMatrix</span>

      <span class="k">use </span><span class="n">siesta_options</span><span class="p">,</span>        <span class="n">only</span><span class="p">:</span> <span class="n">fire_mix</span><span class="p">,</span> <span class="n">broyden_maxit</span>
      <span class="k">use </span><span class="n">siesta_options</span><span class="p">,</span>        <span class="n">only</span><span class="p">:</span> <span class="n">dDtol</span><span class="p">,</span> <span class="n">dHtol</span>

      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">DM_2D</span><span class="p">,</span> <span class="n">EDM_2D</span>
      <span class="k">use </span><span class="n">atomlist</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">lasto</span>
      <span class="k">use </span><span class="n">siesta_geom</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">nsc</span><span class="p">,</span> <span class="n">isc_off</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">ucell</span>
      <span class="k">use </span><span class="n">m_energies</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">Ef</span>
      <span class="k">use </span><span class="n">m_mixing</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">mixers_history_init</span>
      <span class="k">use </span><span class="n">m_mixing_scf</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">scf_mix</span><span class="p">,</span> <span class="n">scf_mixs</span>
      <span class="k">use </span><span class="n">m_rhog</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">resetRhoG</span>

      <span class="k">use </span><span class="n">m_ts_global_vars</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">TSinit</span><span class="p">,</span> <span class="n">TSrun</span>
      <span class="k">use </span><span class="n">m_ts_global_vars</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">ts_print_transiesta</span>
      <span class="k">use </span><span class="n">m_ts_method</span>
      <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">N_Elec</span><span class="p">,</span> <span class="n">Elecs</span>
      <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">DM_bulk</span>
      <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">val_swap</span>
      <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">ts_Dtol</span><span class="p">,</span> <span class="n">ts_Htol</span>
      <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">ts_hist_keep</span>
      <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">ts_siesta_stop</span>
      <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">ts_scf_mixs</span>
      <span class="k">use </span><span class="n">m_ts_electype</span>

      <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iEl</span><span class="p">,</span> <span class="n">na_a</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">allowed_a</span><span class="p">(:)</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">DM</span><span class="p">(:,:),</span> <span class="n">EDM</span><span class="p">(:,:)</span>

      <span class="c">! We are done with the initial diagon run</span>
      <span class="c">! Now we start the TRANSIESTA (Green functions) run</span>
      <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">TSmode</span> <span class="p">)</span> <span class="k">return</span>
<span class="k">      if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">TSinit</span> <span class="p">)</span> <span class="k">return</span>

      <span class="c">! whether we are in siesta initialization step</span>
      <span class="n">TSinit</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
      <span class="c">! whether transiesta is running</span>
      <span class="n">TSrun</span>  <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>

      <span class="c">! If transiesta should stop immediately</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">ts_siesta_stop</span> <span class="p">)</span> <span class="k">then</span>

<span class="k">         if</span> <span class="p">(</span> <span class="n">IONode</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(a)&#39;</span><span class="p">)</span> <span class="s1">&#39;ts: Stopping transiesta (user option)!&#39;</span>
         <span class="k">end if</span>

<span class="k">         return</span>

<span class="k">      end if</span>

      <span class="c">! Reduce memory requirements</span>
      <span class="k">call </span><span class="n">resetDenseMatrix</span><span class="p">()</span>

      <span class="c">! Signal to continue...</span>
      <span class="c">! These two variables are from the top-level</span>
      <span class="c">! routine (siesta_forces)</span>
      <span class="n">SCFconverged</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
      <span class="n">iscf</span> <span class="o">=</span> <span class="mi">0</span>

      <span class="c">! DANGER (when/if going back to the DIAGON run, we should</span>
      <span class="c">! re-instantiate the original mixing value)</span>
      <span class="k">call </span><span class="n">val_swap</span><span class="p">(</span><span class="n">dDtol</span><span class="p">,</span> <span class="n">ts_Dtol</span><span class="p">)</span>
      <span class="k">call </span><span class="n">val_swap</span><span class="p">(</span><span class="n">dHtol</span><span class="p">,</span> <span class="n">ts_Htol</span><span class="p">)</span>

      <span class="c">! Clean up mixing history</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">mix_charge</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">resetRhoG</span><span class="p">(.</span><span class="n">true</span><span class="p">.)</span>
      <span class="k">else</span>
<span class="k">        if</span> <span class="p">(</span> <span class="nb">associated</span><span class="p">(</span><span class="n">ts_scf_mixs</span><span class="p">,</span> <span class="k">target</span><span class="o">=</span><span class="n">scf_mixs</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">          do </span><span class="n">iel</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">stack</span><span class="p">)</span>
            <span class="k">call </span><span class="n">reset</span><span class="p">(</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">stack</span><span class="p">(</span><span class="n">iel</span><span class="p">),</span> <span class="o">-</span><span class="n">ts_hist_keep</span><span class="p">)</span>
            <span class="c">! Reset iteration count as certain</span>
            <span class="c">! mixing schemes require this for consistency</span>
            <span class="n">scf_mix</span><span class="p">%</span><span class="n">cur_itt</span> <span class="o">=</span> <span class="n">n_items</span><span class="p">(</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">stack</span><span class="p">(</span><span class="n">iel</span><span class="p">))</span>
          <span class="k">end do</span>
<span class="k">        else</span>
<span class="k">          call </span><span class="n">mixers_history_init</span><span class="p">(</span><span class="n">scf_mixs</span><span class="p">)</span>
        <span class="k">end if</span>
<span class="k">      end if</span>
      
      <span class="c">! Transfer scf_mixing to the transiesta mixing routine</span>
      <span class="n">scf_mix</span> <span class="o">=&gt;</span> <span class="n">ts_scf_mixs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="cp">#ifdef SIESTA__FLOOK</span>
      <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">mix_charge</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Weight&#39;</span><span class="p">,</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">w</span><span class="p">)</span>
         <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Restart&#39;</span><span class="p">,</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">restart</span><span class="p">)</span>
         <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Iterations&#39;</span><span class="p">,</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">n_itt</span><span class="p">)</span>
      <span class="k">end if</span>
<span class="cp">#endif</span>

      <span class="k">call </span><span class="n">ts_print_transiesta</span><span class="p">()</span>

      <span class="c">! In case of transiesta and DM_bulk.</span>
      <span class="c">! In case we ask for initialization of the DM in bulk</span>
      <span class="c">! we read in the DM files from the electrodes and</span>
      <span class="c">! initialize the bulk to those values</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">DM_bulk</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">then</span>

<span class="k">         if</span> <span class="p">(</span> <span class="n">IONode</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(/,2a)&#39;</span><span class="p">)</span> <span class="s1">&#39;transiesta: &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
                 <span class="s1">&#39;Initializing bulk DM in electrodes.&#39;</span>
         <span class="k">end if</span>

<span class="k">         </span><span class="n">na_a</span> <span class="o">=</span> <span class="mi">0</span>
         <span class="k">do </span><span class="n">iEl</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">na_u</span>
            <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">a_isDev</span><span class="p">(</span><span class="n">iEl</span><span class="p">)</span> <span class="p">)</span> <span class="n">na_a</span> <span class="o">=</span> <span class="n">na_a</span> <span class="o">+</span> <span class="mi">1</span>
         <span class="k">end do</span>
<span class="k">         allocate</span><span class="p">(</span><span class="n">allowed_a</span><span class="p">(</span><span class="n">na_a</span><span class="p">))</span>
         <span class="n">na_a</span> <span class="o">=</span> <span class="mi">0</span>
         <span class="k">do </span><span class="n">iEl</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">na_u</span>
            <span class="c">! We allow the buffer atoms as well (this will even out the</span>
            <span class="c">! potential around the back of the electrode)</span>
            <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">a_isDev</span><span class="p">(</span><span class="n">iEl</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">               </span><span class="n">na_a</span> <span class="o">=</span> <span class="n">na_a</span> <span class="o">+</span> <span class="mi">1</span>
               <span class="n">allowed_a</span><span class="p">(</span><span class="n">na_a</span><span class="p">)</span> <span class="o">=</span> <span class="n">iEl</span>
            <span class="k">end if</span>
<span class="k">         end do</span>

<span class="k">         do </span><span class="n">iEl</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">N_Elec</span>

            <span class="k">if</span> <span class="p">(</span> <span class="n">IONode</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">               write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(/,2a)&#39;</span><span class="p">)</span> <span class="s1">&#39;transiesta: &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
                    <span class="s1">&#39;Reading in electrode TSDE for &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
                    <span class="nb">trim</span><span class="p">(</span><span class="n">Elecs</span><span class="p">(</span><span class="n">iEl</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
            <span class="k">end if</span>

            <span class="c">! Copy over the DM in the lead</span>
            <span class="c">! Notice that the EDM matrix that is copied over</span>
            <span class="c">! will be equivalent at Ef == 0</span>
            <span class="k">call </span><span class="n">copy_DM</span><span class="p">(</span><span class="n">Elecs</span><span class="p">(</span><span class="n">iEl</span><span class="p">),</span><span class="n">na_u</span><span class="p">,</span><span class="n">xa</span><span class="p">,</span><span class="n">lasto</span><span class="p">,</span><span class="n">nsc</span><span class="p">,</span><span class="n">isc_off</span><span class="p">,</span> <span class="p">&amp;</span>
                 <span class="n">ucell</span><span class="p">,</span> <span class="n">DM_2D</span><span class="p">,</span> <span class="n">EDM_2D</span><span class="p">,</span> <span class="n">na_a</span><span class="p">,</span> <span class="n">allowed_a</span><span class="p">)</span>

         <span class="k">end do</span>

         <span class="c">! Clean-up</span>
         <span class="k">deallocate</span><span class="p">(</span><span class="n">allowed_a</span><span class="p">)</span>

         <span class="k">if</span> <span class="p">(</span> <span class="n">IONode</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="c">! new-line</span>
         <span class="k">end if</span>

         <span class="c">! The electrode EDM is aligned at Ef == 0</span>
         <span class="c">! We need to align the energy matrix</span>
         <span class="n">DM</span>  <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">DM_2D</span><span class="p">)</span>
         <span class="n">EDM</span> <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">EDM_2D</span><span class="p">)</span>
         <span class="n">iEl</span> <span class="o">=</span>  <span class="n">size</span><span class="p">(</span><span class="n">DM</span><span class="p">)</span>
         <span class="k">call </span><span class="n">daxpy</span><span class="p">(</span><span class="n">iEl</span><span class="p">,</span><span class="n">Ef</span><span class="p">,</span><span class="n">DM</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">EDM</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>

      <span class="k">end if</span>

<span class="k">    end subroutine </span><span class="n">transiesta_switch</span>

  <span class="k">end subroutine </span><span class="n">siesta_forces</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2018 <a rel="license" href="http://www.gnu.org/licenses/old-licenses/fdl-1.2.en.html">GNU Free Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> SIESTA was developed by SIESTA Group</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>