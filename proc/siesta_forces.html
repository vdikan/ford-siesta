<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="A first-principles materials simulation code using Density Functional Theory.">
    
    <meta name="author" content="SIESTA Group" >
    <link rel="icon" href="../favicon.png">

    <title>siesta_forces &ndash; SIESTA</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">SIESTA <small>trunk-700--vdikan-edens-708-ford-681</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>Program Overview</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>siesta_forces
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 6.0% of total for procedures.">375 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/siesta_forces.F90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/siesta_forces.f90.html'>siesta_forces.F90</a></li>
    
     <li><a href='../module/m_siesta_forces.html'>m_siesta_forces</a></li>
    
  
     <li class="active">siesta_forces</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/siesta_forces.html#src">siesta_forces</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine siesta_forces(istep)
    
    
   
</h2>
    
  
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
      
      <li class="list-group-item">
  <ul class="list-inline">
    
    <li>units</li>
    
    <li>precision</li>
    
    <li>sys</li>
    
    <li>files</li>
    
    <li>siesta_cml</li>
    
    <li><a href='../module/m_state_init.html'>m_state_init</a></li>
    
    <li><a href='../module/m_setup_hamiltonian.html'>m_setup_hamiltonian</a></li>
    
    <li><a href='../module/m_setup_h0.html'>m_setup_H0</a></li>
    
    <li><a href='../module/m_compute_dm.html'>m_compute_dm</a></li>
    
    <li><a href='../module/m_compute_max_diff.html'>m_compute_max_diff</a></li>
    
    <li>m_scfconvergence_test</li>
    
    <li>m_post_scf_work</li>
    
    <li>m_mixer</li>
    
    <li><a href='../module/m_mixing_scf.html'>m_mixing_scf</a></li>
    
    <li><a href='../module/m_mixing_scf.html'>m_mixing_scf</a></li>
    
    <li><a href='../module/m_mixing_scf.html'>m_mixing_scf</a></li>
    
    <li>m_rhog</li>
    
    <li>siesta_options</li>
    
    <li>parallel</li>
    
    <li><a href='../module/m_state_analysis.html'>m_state_analysis</a></li>
    
    <li>m_steps</li>
    
    <li>m_spin</li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>m_convergence</li>
    
    <li>m_convergence</li>
    
    <li>siesta_geom</li>
    
    <li>m_energies</li>
    
    <li>m_forces</li>
    
    <li>m_stress</li>
    
    <li>siesta_master</li>
    
    <li>siesta_master</li>
    
    <li>m_save_density_matrix</li>
    
    <li>m_iodm_old</li>
    
    <li>atomlist</li>
    
    <li>m_dm_charge</li>
    
    <li>m_pexsi_solver</li>
    
    <li>write_subs</li>
    
    <li>write_subs</li>
    
    <li>m_compute_energies</li>
    
    <li>m_mpi_utils</li>
    
    <li>fdf</li>
    
    <li>m_check_walltime</li>
    
    <li>m_energies</li>
    
    <li>m_ts_options</li>
    
    <li>m_ts_method</li>
    
    <li>m_ts_global_vars</li>
    
    <li>siesta_geom</li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>m_ts_charge</li>
    
    <li>m_ts_charge</li>
    
    <li>m_ts_charge</li>
    
    <li>m_ts_charge</li>
    
    <li>m_transiesta</li>
    
    <li>kpoint_scf_m</li>
    
    <li>m_energies</li>
    
    <li>m_initwf</li>
    
  </ul>
      </li>
      
      
      
      <li class="list-group-item">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~siesta_forces~~UsesGraph Pages: 1 -->
<svg id="procsiesta_forcesUsesGraph" width="555pt" height="1826pt"
 viewBox="0.00 0.00 555.00 1826.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~siesta_forces~~UsesGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 1822)">
<title>proc~~siesta_forces~~UsesGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1822 551,-1822 551,4 -4,4"/>
<!-- proc~siesta_forces -->
<g id="proc~~siesta_forces~~UsesGraph_node1" class="node"><title>proc~siesta_forces</title>
<polygon fill="none" stroke="black" points="547,-923 471,-923 471,-899 547,-899 547,-923"/>
<text text-anchor="middle" x="509" y="-908.6" font-family="Helvetica,sans-Serif" font-size="10.50">siesta_forces</text>
</g>
<!-- files -->
<g id="proc~~siesta_forces~~UsesGraph_node2" class="node"><title>files</title>
<polygon fill="#337ab7" stroke="#337ab7" points="399,-1818 345,-1818 345,-1794 399,-1794 399,-1818"/>
<text text-anchor="middle" x="372" y="-1803.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">files</text>
</g>
<!-- proc~siesta_forces&#45;&gt;files -->
<g id="proc~~siesta_forces~~UsesGraph_edge22" class="edge"><title>proc~siesta_forces&#45;&gt;files</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.778,-923.234C505.849,-1023.92 490.64,-1713.86 435,-1785 428.594,-1793.19 418.846,-1798.21 408.965,-1801.28"/>
<polygon fill="#000000" stroke="#000000" points="408.004,-1797.91 399.157,-1803.74 409.708,-1804.7 408.004,-1797.91"/>
</g>
<!-- m_check_walltime -->
<g id="proc~~siesta_forces~~UsesGraph_node3" class="node"><title>m_check_walltime</title>
<polygon fill="#337ab7" stroke="#337ab7" points="422,-1776 322,-1776 322,-1752 422,-1752 422,-1776"/>
<text text-anchor="middle" x="372" y="-1761.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_check_walltime</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_check_walltime -->
<g id="proc~~siesta_forces~~UsesGraph_edge2" class="edge"><title>proc~siesta_forces&#45;&gt;m_check_walltime</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.723,-923.261C505.407,-1021.27 488.015,-1675.51 435,-1743 433.574,-1744.82 431.984,-1746.47 430.265,-1747.99"/>
<polygon fill="#000000" stroke="#000000" points="428.195,-1745.17 422.01,-1753.77 432.209,-1750.9 428.195,-1745.17"/>
</g>
<!-- m_spin -->
<g id="proc~~siesta_forces~~UsesGraph_node4" class="node"><title>m_spin</title>
<polygon fill="#337ab7" stroke="#337ab7" points="399,-1734 345,-1734 345,-1710 399,-1710 399,-1734"/>
<text text-anchor="middle" x="372" y="-1719.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_spin</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_spin -->
<g id="proc~~siesta_forces~~UsesGraph_edge32" class="edge"><title>proc~siesta_forces&#45;&gt;m_spin</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.618,-923.132C504.552,-1017.4 482.837,-1630.83 435,-1696 428.614,-1704.7 418.755,-1710.51 408.763,-1714.38"/>
<polygon fill="#000000" stroke="#000000" points="407.646,-1711.06 399.252,-1717.52 409.845,-1717.7 407.646,-1711.06"/>
</g>
<!-- write_subs -->
<g id="proc~~siesta_forces~~UsesGraph_node5" class="node"><title>write_subs</title>
<polygon fill="#337ab7" stroke="#337ab7" points="247.5,-1569 183.5,-1569 183.5,-1545 247.5,-1545 247.5,-1569"/>
<text text-anchor="middle" x="215.5" y="-1554.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_subs</text>
</g>
<!-- proc~siesta_forces&#45;&gt;write_subs -->
<g id="proc~~siesta_forces~~UsesGraph_edge4" class="edge"><title>proc~siesta_forces&#45;&gt;write_subs</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.782,-923.1C505.993,-1015.78 492.306,-1610.99 435,-1663 393.533,-1700.64 359.98,-1686.17 309,-1663 270.751,-1645.61 242.138,-1603.73 227.483,-1578.12"/>
<polygon fill="#000000" stroke="#000000" points="230.451,-1576.26 222.558,-1569.19 224.321,-1579.64 230.451,-1576.26"/>
</g>
<!-- m_ts_options -->
<g id="proc~~siesta_forces~~UsesGraph_node6" class="node"><title>m_ts_options</title>
<polygon fill="#337ab7" stroke="#337ab7" points="410,-1654 334,-1654 334,-1630 410,-1630 410,-1654"/>
<text text-anchor="middle" x="372" y="-1639.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_options</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_ts_options -->
<g id="proc~~siesta_forces~~UsesGraph_edge5" class="edge"><title>proc~siesta_forces&#45;&gt;m_ts_options</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.535,-923.115C504.013,-1012.2 480.446,-1564.03 435,-1621 430.907,-1626.13 425.506,-1630.02 419.595,-1632.95"/>
<polygon fill="#000000" stroke="#000000" points="417.956,-1629.84 410.001,-1636.84 420.583,-1636.33 417.956,-1629.84"/>
</g>
<!-- siesta_cml -->
<g id="proc~~siesta_forces~~UsesGraph_node7" class="node"><title>siesta_cml</title>
<polygon fill="#337ab7" stroke="#337ab7" points="403.5,-1612 340.5,-1612 340.5,-1588 403.5,-1588 403.5,-1612"/>
<text text-anchor="middle" x="372" y="-1597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_cml</text>
</g>
<!-- proc~siesta_forces&#45;&gt;siesta_cml -->
<g id="proc~~siesta_forces~~UsesGraph_edge6" class="edge"><title>proc~siesta_forces&#45;&gt;siesta_cml</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.448,-923.215C503.446,-1009.53 477.821,-1525.67 435,-1579 429.477,-1585.88 421.603,-1590.52 413.311,-1593.64"/>
<polygon fill="#000000" stroke="#000000" points="412.032,-1590.37 403.501,-1596.66 414.088,-1597.06 412.032,-1590.37"/>
</g>
<!-- m_energies -->
<g id="proc~~siesta_forces~~UsesGraph_node8" class="node"><title>m_energies</title>
<polygon fill="#337ab7" stroke="#337ab7" points="406.5,-1570 337.5,-1570 337.5,-1546 406.5,-1546 406.5,-1570"/>
<text text-anchor="middle" x="372" y="-1555.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_energies</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_energies -->
<g id="proc~~siesta_forces~~UsesGraph_edge7" class="edge"><title>proc~siesta_forces&#45;&gt;m_energies</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M508.285,-923.103C509.888,-1001.56 515.082,-1438 435,-1537 430.185,-1542.95 423.609,-1547.23 416.534,-1550.29"/>
<polygon fill="#000000" stroke="#000000" points="414.957,-1547.14 406.695,-1553.77 417.289,-1553.74 414.957,-1547.14"/>
</g>
<!-- module~m_setup_h0 -->
<g id="proc~~siesta_forces~~UsesGraph_node9" class="node"><title>module~m_setup_h0</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node9"><a xlink:href=".././module/m_setup_h0.html" xlink:title="m_setup_H0">
<polygon fill="#337ab7" stroke="#337ab7" points="408.5,-1528 335.5,-1528 335.5,-1504 408.5,-1504 408.5,-1528"/>
<text text-anchor="middle" x="372" y="-1513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_setup_H0</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;module~m_setup_h0 -->
<g id="proc~~siesta_forces~~UsesGraph_edge8" class="edge"><title>proc~siesta_forces&#45;&gt;module~m_setup_h0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M508.171,-923.014C509.002,-998.147 509.923,-1403.16 435,-1495 430.56,-1500.44 424.649,-1504.48 418.237,-1507.48"/>
<polygon fill="#000000" stroke="#000000" points="416.688,-1504.32 408.596,-1511.16 419.187,-1510.86 416.688,-1504.32"/>
</g>
<!-- kpoint_scf_m -->
<g id="proc~~siesta_forces~~UsesGraph_node10" class="node"><title>kpoint_scf_m</title>
<polygon fill="#337ab7" stroke="#337ab7" points="410,-1486 334,-1486 334,-1462 410,-1462 410,-1486"/>
<text text-anchor="middle" x="372" y="-1471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">kpoint_scf_m</text>
</g>
<!-- proc~siesta_forces&#45;&gt;kpoint_scf_m -->
<g id="proc~~siesta_forces~~UsesGraph_edge9" class="edge"><title>proc~siesta_forces&#45;&gt;kpoint_scf_m</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M508.042,-923.076C508.056,-995.158 504.724,-1368.36 435,-1453 430.875,-1458.01 425.506,-1461.83 419.653,-1464.74"/>
<polygon fill="#000000" stroke="#000000" points="418.105,-1461.59 410.166,-1468.61 420.748,-1468.07 418.105,-1461.59"/>
</g>
<!-- module~m_state_analysis -->
<g id="proc~~siesta_forces~~UsesGraph_node11" class="node"><title>module~m_state_analysis</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node11"><a xlink:href=".././module/m_state_analysis.html" xlink:title="m_state_analysis">
<polygon fill="#337ab7" stroke="#337ab7" points="419.5,-1444 324.5,-1444 324.5,-1420 419.5,-1420 419.5,-1444"/>
<text text-anchor="middle" x="372" y="-1429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_state_analysis</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;module~m_state_analysis -->
<g id="proc~~siesta_forces~~UsesGraph_edge10" class="edge"><title>proc~siesta_forces&#45;&gt;module~m_state_analysis</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.892,-923.026C507.041,-991.661 499.574,-1333.49 435,-1411 433.056,-1413.33 430.843,-1415.41 428.438,-1417.25"/>
<polygon fill="#000000" stroke="#000000" points="426.307,-1414.45 419.631,-1422.68 429.98,-1420.41 426.307,-1414.45"/>
</g>
<!-- m_steps -->
<g id="proc~~siesta_forces~~UsesGraph_node12" class="node"><title>m_steps</title>
<polygon fill="#337ab7" stroke="#337ab7" points="399,-1402 345,-1402 345,-1378 399,-1378 399,-1402"/>
<text text-anchor="middle" x="372" y="-1387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_steps</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_steps -->
<g id="proc~~siesta_forces~~UsesGraph_edge11" class="edge"><title>proc~siesta_forces&#45;&gt;m_steps</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.708,-923.286C505.908,-989.012 494.342,-1298.71 435,-1369 428.347,-1376.88 418.62,-1381.81 408.834,-1384.9"/>
<polygon fill="#000000" stroke="#000000" points="407.944,-1381.51 399.14,-1387.41 409.698,-1388.29 407.944,-1381.51"/>
</g>
<!-- m_mixer -->
<g id="proc~~siesta_forces~~UsesGraph_node13" class="node"><title>m_mixer</title>
<polygon fill="#337ab7" stroke="#337ab7" points="399,-1360 345,-1360 345,-1336 399,-1336 399,-1360"/>
<text text-anchor="middle" x="372" y="-1345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_mixer</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_mixer -->
<g id="proc~~siesta_forces~~UsesGraph_edge12" class="edge"><title>proc~siesta_forces&#45;&gt;m_mixer</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.38,-923.155C504.04,-984.291 486.385,-1257.77 435,-1322 428.383,-1330.27 418.666,-1335.95 408.879,-1339.82"/>
<polygon fill="#000000" stroke="#000000" points="407.513,-1336.59 399.18,-1343.14 409.774,-1343.22 407.513,-1336.59"/>
</g>
<!-- module~m_compute_max_diff -->
<g id="proc~~siesta_forces~~UsesGraph_node14" class="node"><title>module~m_compute_max_diff</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node14"><a xlink:href=".././module/m_compute_max_diff.html" xlink:title="m_compute_max_diff">
<polygon fill="#337ab7" stroke="#337ab7" points="273,-1027 158,-1027 158,-1003 273,-1003 273,-1027"/>
<text text-anchor="middle" x="215.5" y="-1012.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_compute_max_diff</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;module~m_compute_max_diff -->
<g id="proc~~siesta_forces~~UsesGraph_edge13" class="edge"><title>proc~siesta_forces&#45;&gt;module~m_compute_max_diff</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.627,-923.376C505.545,-983.135 493.249,-1240.92 435,-1289 391.811,-1324.65 354.492,-1321.66 309,-1289 225.991,-1229.41 216.504,-1091.39 216.103,-1037.31"/>
<polygon fill="#000000" stroke="#000000" points="219.603,-1037.11 216.132,-1027.1 212.603,-1037.09 219.603,-1037.11"/>
</g>
<!-- siesta_geom -->
<g id="proc~~siesta_forces~~UsesGraph_node15" class="node"><title>siesta_geom</title>
<polygon fill="#337ab7" stroke="#337ab7" points="408.5,-1280 335.5,-1280 335.5,-1256 408.5,-1256 408.5,-1280"/>
<text text-anchor="middle" x="372" y="-1265.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_geom</text>
</g>
<!-- proc~siesta_forces&#45;&gt;siesta_geom -->
<g id="proc~~siesta_forces~~UsesGraph_edge14" class="edge"><title>proc~siesta_forces&#45;&gt;siesta_geom</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M506.951,-923.1C502.025,-977.285 479.539,-1197.14 435,-1247 430.422,-1252.13 424.548,-1256 418.244,-1258.93"/>
<polygon fill="#000000" stroke="#000000" points="416.867,-1255.71 408.804,-1262.58 419.393,-1262.24 416.867,-1255.71"/>
</g>
<!-- module~m_state_init -->
<g id="proc~~siesta_forces~~UsesGraph_node16" class="node"><title>module~m_state_init</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node16"><a xlink:href=".././module/m_state_init.html" xlink:title="m_state_init">
<polygon fill="#337ab7" stroke="#337ab7" points="407,-1238 337,-1238 337,-1214 407,-1214 407,-1238"/>
<text text-anchor="middle" x="372" y="-1223.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_state_init</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;module~m_state_init -->
<g id="proc~~siesta_forces~~UsesGraph_edge15" class="edge"><title>proc~siesta_forces&#45;&gt;module~m_state_init</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M506.529,-923.244C500.28,-973.35 474.437,-1162.14 435,-1205 429.974,-1210.46 423.477,-1214.5 416.587,-1217.5"/>
<polygon fill="#000000" stroke="#000000" points="415.255,-1214.26 407.049,-1220.96 417.643,-1220.84 415.255,-1214.26"/>
</g>
<!-- m_ts_method -->
<g id="proc~~siesta_forces~~UsesGraph_node17" class="node"><title>m_ts_method</title>
<polygon fill="#337ab7" stroke="#337ab7" points="411,-1196 333,-1196 333,-1172 411,-1172 411,-1196"/>
<text text-anchor="middle" x="372" y="-1181.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_method</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_ts_method -->
<g id="proc~~siesta_forces~~UsesGraph_edge16" class="edge"><title>proc~siesta_forces&#45;&gt;m_ts_method</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M508.191,-923.153C508.144,-963.188 502.527,-1092.39 435,-1163 430.874,-1167.31 425.83,-1170.74 420.42,-1173.47"/>
<polygon fill="#000000" stroke="#000000" points="418.915,-1170.3 411.065,-1177.42 421.639,-1176.75 418.915,-1170.3"/>
</g>
<!-- m_ts_charge -->
<g id="proc~~siesta_forces~~UsesGraph_node18" class="node"><title>m_ts_charge</title>
<polygon fill="#337ab7" stroke="#337ab7" points="409.5,-1154 334.5,-1154 334.5,-1130 409.5,-1130 409.5,-1154"/>
<text text-anchor="middle" x="372" y="-1139.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_charge</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_ts_charge -->
<g id="proc~~siesta_forces~~UsesGraph_edge17" class="edge"><title>proc~siesta_forces&#45;&gt;m_ts_charge</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.368,-923.12C504.86,-958.674 492.681,-1063.78 435,-1121 430.447,-1125.52 424.888,-1129.06 418.988,-1131.85"/>
<polygon fill="#000000" stroke="#000000" points="417.52,-1128.66 409.531,-1135.62 420.116,-1135.17 417.52,-1128.66"/>
</g>
<!-- m_save_density_matrix -->
<g id="proc~~siesta_forces~~UsesGraph_node19" class="node"><title>m_save_density_matrix</title>
<polygon fill="#337ab7" stroke="#337ab7" points="434.5,-1112 309.5,-1112 309.5,-1088 434.5,-1088 434.5,-1112"/>
<text text-anchor="middle" x="372" y="-1097.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_save_density_matrix</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_save_density_matrix -->
<g id="proc~~siesta_forces~~UsesGraph_edge18" class="edge"><title>proc~siesta_forces&#45;&gt;m_save_density_matrix</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M506.175,-923.091C500.928,-953.684 482.978,-1034.86 435,-1079 433.677,-1080.22 432.282,-1081.36 430.827,-1082.44"/>
<polygon fill="#000000" stroke="#000000" points="428.611,-1079.7 421.947,-1087.94 432.293,-1085.65 428.611,-1079.7"/>
</g>
<!-- m_stress -->
<g id="proc~~siesta_forces~~UsesGraph_node20" class="node"><title>m_stress</title>
<polygon fill="#337ab7" stroke="#337ab7" points="400,-1070 344,-1070 344,-1046 400,-1046 400,-1070"/>
<text text-anchor="middle" x="372" y="-1055.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_stress</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_stress -->
<g id="proc~~siesta_forces~~UsesGraph_edge19" class="edge"><title>proc~siesta_forces&#45;&gt;m_stress</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M504.168,-923.346C495.762,-948.426 473.338,-1005.61 435,-1037 427.781,-1042.91 418.815,-1047.19 409.966,-1050.28"/>
<polygon fill="#000000" stroke="#000000" points="408.668,-1047.01 400.124,-1053.28 410.71,-1053.71 408.668,-1047.01"/>
</g>
<!-- units -->
<g id="proc~~siesta_forces~~UsesGraph_node21" class="node"><title>units</title>
<polygon fill="#337ab7" stroke="#337ab7" points="399,-1028 345,-1028 345,-1004 399,-1004 399,-1028"/>
<text text-anchor="middle" x="372" y="-1013.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">units</text>
</g>
<!-- proc~siesta_forces&#45;&gt;units -->
<g id="proc~~siesta_forces~~UsesGraph_edge20" class="edge"><title>proc~siesta_forces&#45;&gt;units</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M500.547,-923.088C488.778,-941.217 464.2,-975.408 435,-995 427.099,-1000.3 417.735,-1004.38 408.71,-1007.47"/>
<polygon fill="#000000" stroke="#000000" points="407.646,-1004.14 399.135,-1010.45 409.724,-1010.82 407.646,-1004.14"/>
</g>
<!-- m_mpi_utils -->
<g id="proc~~siesta_forces~~UsesGraph_node22" class="node"><title>m_mpi_utils</title>
<polygon fill="#337ab7" stroke="#337ab7" points="407,-986 337,-986 337,-962 407,-962 407,-986"/>
<text text-anchor="middle" x="372" y="-971.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_mpi_utils</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_mpi_utils -->
<g id="proc~~siesta_forces~~UsesGraph_edge21" class="edge"><title>proc~siesta_forces&#45;&gt;m_mpi_utils</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M489.326,-923.105C474.887,-932.126 454.188,-944.331 435,-953 429.223,-955.61 423.02,-958.08 416.851,-960.346"/>
<polygon fill="#000000" stroke="#000000" points="415.517,-957.105 407.25,-963.732 417.845,-963.707 415.517,-957.105"/>
</g>
<!-- siesta_options -->
<g id="proc~~siesta_forces~~UsesGraph_node23" class="node"><title>siesta_options</title>
<polygon fill="#337ab7" stroke="#337ab7" points="412.5,-944 331.5,-944 331.5,-920 412.5,-920 412.5,-944"/>
<text text-anchor="middle" x="372" y="-929.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_options</text>
</g>
<!-- proc~siesta_forces&#45;&gt;siesta_options -->
<g id="proc~~siesta_forces~~UsesGraph_edge1" class="edge"><title>proc~siesta_forces&#45;&gt;siesta_options</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M470.753,-916.794C456.028,-919.084 438.882,-921.752 423.097,-924.207"/>
<polygon fill="#000000" stroke="#000000" points="422.304,-920.788 412.961,-925.784 423.38,-927.705 422.304,-920.788"/>
</g>
<!-- m_pexsi_solver -->
<g id="proc~~siesta_forces~~UsesGraph_node24" class="node"><title>m_pexsi_solver</title>
<polygon fill="#337ab7" stroke="#337ab7" points="415.5,-902 328.5,-902 328.5,-878 415.5,-878 415.5,-902"/>
<text text-anchor="middle" x="372" y="-887.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_pexsi_solver</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_pexsi_solver -->
<g id="proc~~siesta_forces~~UsesGraph_edge23" class="edge"><title>proc~siesta_forces&#45;&gt;m_pexsi_solver</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M470.753,-905.206C456.93,-903.056 440.971,-900.573 426.01,-898.246"/>
<polygon fill="#000000" stroke="#000000" points="426.269,-894.744 415.85,-896.665 425.193,-901.661 426.269,-894.744"/>
</g>
<!-- m_dm_charge -->
<g id="proc~~siesta_forces~~UsesGraph_node25" class="node"><title>m_dm_charge</title>
<polygon fill="#337ab7" stroke="#337ab7" points="413,-860 331,-860 331,-836 413,-836 413,-860"/>
<text text-anchor="middle" x="372" y="-845.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_dm_charge</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_dm_charge -->
<g id="proc~~siesta_forces~~UsesGraph_edge24" class="edge"><title>proc~siesta_forces&#45;&gt;m_dm_charge</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M489.326,-898.895C474.887,-889.874 454.188,-877.669 435,-869 430.869,-867.134 426.519,-865.339 422.121,-863.639"/>
<polygon fill="#000000" stroke="#000000" points="423.07,-860.258 412.476,-860.078 420.645,-866.825 423.07,-860.258"/>
</g>
<!-- m_convergence -->
<g id="proc~~siesta_forces~~UsesGraph_node26" class="node"><title>m_convergence</title>
<polygon fill="#337ab7" stroke="#337ab7" points="416.5,-818 327.5,-818 327.5,-794 416.5,-794 416.5,-818"/>
<text text-anchor="middle" x="372" y="-803.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_convergence</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_convergence -->
<g id="proc~~siesta_forces~~UsesGraph_edge25" class="edge"><title>proc~siesta_forces&#45;&gt;m_convergence</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M500.547,-898.912C488.778,-880.783 464.2,-846.592 435,-827 432.129,-825.074 429.065,-823.309 425.894,-821.694"/>
<polygon fill="#000000" stroke="#000000" points="427.298,-818.488 416.747,-817.531 424.399,-824.859 427.298,-818.488"/>
</g>
<!-- m_ts_global_vars -->
<g id="proc~~siesta_forces~~UsesGraph_node27" class="node"><title>m_ts_global_vars</title>
<polygon fill="#337ab7" stroke="#337ab7" points="420.5,-776 323.5,-776 323.5,-752 420.5,-752 420.5,-776"/>
<text text-anchor="middle" x="372" y="-761.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_global_vars</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_ts_global_vars -->
<g id="proc~~siesta_forces~~UsesGraph_edge26" class="edge"><title>proc~siesta_forces&#45;&gt;m_ts_global_vars</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M504.168,-898.654C495.762,-873.574 473.338,-816.393 435,-785 433.25,-783.567 431.397,-782.229 429.468,-780.982"/>
<polygon fill="#000000" stroke="#000000" points="431.047,-777.855 420.604,-776.066 427.652,-783.977 431.047,-777.855"/>
</g>
<!-- m_post_scf_work -->
<g id="proc~~siesta_forces~~UsesGraph_node28" class="node"><title>m_post_scf_work</title>
<polygon fill="#337ab7" stroke="#337ab7" points="420,-734 324,-734 324,-710 420,-710 420,-734"/>
<text text-anchor="middle" x="372" y="-719.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_post_scf_work</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_post_scf_work -->
<g id="proc~~siesta_forces~~UsesGraph_edge27" class="edge"><title>proc~siesta_forces&#45;&gt;m_post_scf_work</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M506.175,-898.909C500.928,-868.316 482.978,-787.138 435,-743 433.097,-741.25 431.043,-739.644 428.879,-738.172"/>
<polygon fill="#000000" stroke="#000000" points="430.496,-735.065 420.08,-733.131 427.016,-741.139 430.496,-735.065"/>
</g>
<!-- precision -->
<g id="proc~~siesta_forces~~UsesGraph_node29" class="node"><title>precision</title>
<polygon fill="#337ab7" stroke="#337ab7" points="88.5,-694 33.5,-694 33.5,-670 88.5,-670 88.5,-694"/>
<text text-anchor="middle" x="61" y="-679.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">precision</text>
</g>
<!-- proc~siesta_forces&#45;&gt;precision -->
<g id="proc~~siesta_forces~~UsesGraph_edge28" class="edge"><title>proc~siesta_forces&#45;&gt;precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M508.073,-898.873C507.564,-861.895 500.459,-750.102 435,-701 382.77,-661.822 181.886,-672.526 98.5528,-678.876"/>
<polygon fill="#000000" stroke="#000000" points="98.2219,-675.391 88.5263,-679.663 98.7694,-682.37 98.2219,-675.391"/>
</g>
<!-- sys -->
<g id="proc~~siesta_forces~~UsesGraph_node30" class="node"><title>sys</title>
<polygon fill="#337ab7" stroke="#337ab7" points="399,-654 345,-654 345,-630 399,-630 399,-654"/>
<text text-anchor="middle" x="372" y="-639.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sys</text>
</g>
<!-- proc~siesta_forces&#45;&gt;sys -->
<g id="proc~~siesta_forces~~UsesGraph_edge29" class="edge"><title>proc~siesta_forces&#45;&gt;sys</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.834,-898.912C506.662,-860.225 497.911,-737.907 435,-668 428.032,-660.257 418.386,-654.752 408.777,-650.867"/>
<polygon fill="#000000" stroke="#000000" points="409.876,-647.543 399.281,-647.498 407.536,-654.14 409.876,-647.543"/>
</g>
<!-- m_scfconvergence_test -->
<g id="proc~~siesta_forces~~UsesGraph_node31" class="node"><title>m_scfconvergence_test</title>
<polygon fill="#337ab7" stroke="#337ab7" points="435,-612 309,-612 309,-588 435,-588 435,-612"/>
<text text-anchor="middle" x="372" y="-597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_scfconvergence_test</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_scfconvergence_test -->
<g id="proc~~siesta_forces~~UsesGraph_edge30" class="edge"><title>proc~siesta_forces&#45;&gt;m_scfconvergence_test</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M506.505,-898.921C500.162,-849.491 474,-663.251 435,-621 434.089,-620.014 433.131,-619.073 432.131,-618.177"/>
<polygon fill="#000000" stroke="#000000" points="433.912,-615.147 423.754,-612.137 429.818,-620.825 433.912,-615.147"/>
</g>
<!-- m_compute_energies -->
<g id="proc~~siesta_forces~~UsesGraph_node32" class="node"><title>m_compute_energies</title>
<polygon fill="#337ab7" stroke="#337ab7" points="430,-570 314,-570 314,-546 430,-546 430,-570"/>
<text text-anchor="middle" x="372" y="-555.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_compute_energies</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_compute_energies -->
<g id="proc~~siesta_forces~~UsesGraph_edge31" class="edge"><title>proc~siesta_forces&#45;&gt;m_compute_energies</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M506.896,-898.681C501.812,-844.528 478.996,-628.13 435,-579 434.104,-578 433.16,-577.047 432.172,-576.14"/>
<polygon fill="#000000" stroke="#000000" points="433.996,-573.138 423.866,-570.036 429.851,-578.778 433.996,-573.138"/>
</g>
<!-- m_rhog -->
<g id="proc~~siesta_forces~~UsesGraph_node33" class="node"><title>m_rhog</title>
<polygon fill="#337ab7" stroke="#337ab7" points="399,-528 345,-528 345,-504 399,-504 399,-528"/>
<text text-anchor="middle" x="372" y="-513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_rhog</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_rhog -->
<g id="proc~~siesta_forces~~UsesGraph_edge3" class="edge"><title>proc~siesta_forces&#45;&gt;m_rhog</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.229,-898.73C503.341,-840.572 484.099,-593.152 435,-537 428.337,-529.38 418.807,-524.521 409.21,-521.423"/>
<polygon fill="#000000" stroke="#000000" points="409.865,-517.976 399.302,-518.791 408.068,-524.741 409.865,-517.976"/>
</g>
<!-- module~m_setup_hamiltonian -->
<g id="proc~~siesta_forces~~UsesGraph_node34" class="node"><title>module~m_setup_hamiltonian</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node34"><a xlink:href=".././module/m_setup_hamiltonian.html" xlink:title="m_setup_hamiltonian">
<polygon fill="#337ab7" stroke="#337ab7" points="429.5,-486 314.5,-486 314.5,-462 429.5,-462 429.5,-486"/>
<text text-anchor="middle" x="372" y="-471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_setup_hamiltonian</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;module~m_setup_hamiltonian -->
<g id="proc~~siesta_forces~~UsesGraph_edge33" class="edge"><title>proc~siesta_forces&#45;&gt;module~m_setup_hamiltonian</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.488,-898.626C504.674,-836.4 489.183,-558.171 435,-495 434.147,-494.005 433.245,-493.058 432.3,-492.155"/>
<polygon fill="#000000" stroke="#000000" points="434.395,-489.351 424.319,-486.073 430.152,-494.918 434.395,-489.351"/>
</g>
<!-- siesta_master -->
<g id="proc~~siesta_forces~~UsesGraph_node35" class="node"><title>siesta_master</title>
<polygon fill="#337ab7" stroke="#337ab7" points="411.5,-444 332.5,-444 332.5,-420 411.5,-420 411.5,-444"/>
<text text-anchor="middle" x="372" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_master</text>
</g>
<!-- proc~siesta_forces&#45;&gt;siesta_master -->
<g id="proc~~siesta_forces~~UsesGraph_edge34" class="edge"><title>proc~siesta_forces&#45;&gt;siesta_master</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.708,-898.714C505.908,-832.988 494.342,-523.291 435,-453 431.149,-448.438 426.268,-444.864 420.941,-442.065"/>
<polygon fill="#000000" stroke="#000000" points="422.228,-438.808 411.66,-438.048 419.447,-445.232 422.228,-438.808"/>
</g>
<!-- m_transiesta -->
<g id="proc~~siesta_forces~~UsesGraph_node36" class="node"><title>m_transiesta</title>
<polygon fill="#337ab7" stroke="#337ab7" points="409,-402 335,-402 335,-378 409,-378 409,-402"/>
<text text-anchor="middle" x="372" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_transiesta</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_transiesta -->
<g id="proc~~siesta_forces~~UsesGraph_edge35" class="edge"><title>proc~siesta_forces&#45;&gt;m_transiesta</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.892,-898.974C507.041,-830.339 499.574,-488.511 435,-411 430.601,-405.72 424.822,-401.763 418.558,-398.798"/>
<polygon fill="#000000" stroke="#000000" points="419.729,-395.498 409.141,-395.126 417.186,-402.02 419.729,-395.498"/>
</g>
<!-- parallel -->
<g id="proc~~siesta_forces~~UsesGraph_node37" class="node"><title>parallel</title>
<polygon fill="#337ab7" stroke="#337ab7" points="399,-360 345,-360 345,-336 399,-336 399,-360"/>
<text text-anchor="middle" x="372" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel</text>
</g>
<!-- proc~siesta_forces&#45;&gt;parallel -->
<g id="proc~~siesta_forces~~UsesGraph_edge36" class="edge"><title>proc~siesta_forces&#45;&gt;parallel</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M508.042,-898.924C508.056,-826.842 504.724,-453.644 435,-369 428.443,-361.04 418.743,-356.084 408.953,-353.003"/>
<polygon fill="#000000" stroke="#000000" points="409.803,-349.608 399.246,-350.506 408.059,-356.387 409.803,-349.608"/>
</g>
<!-- m_iodm_old -->
<g id="proc~~siesta_forces~~UsesGraph_node38" class="node"><title>m_iodm_old</title>
<polygon fill="#337ab7" stroke="#337ab7" points="407.5,-318 336.5,-318 336.5,-294 407.5,-294 407.5,-318"/>
<text text-anchor="middle" x="372" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_iodm_old</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_iodm_old -->
<g id="proc~~siesta_forces~~UsesGraph_edge37" class="edge"><title>proc~siesta_forces&#45;&gt;m_iodm_old</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M508.171,-898.986C509.002,-823.853 509.923,-418.843 435,-327 430.308,-321.249 423.975,-317.065 417.143,-314.023"/>
<polygon fill="#000000" stroke="#000000" points="418.219,-310.69 407.625,-310.544 415.815,-317.265 418.219,-310.69"/>
</g>
<!-- m_forces -->
<g id="proc~~siesta_forces~~UsesGraph_node39" class="node"><title>m_forces</title>
<polygon fill="#337ab7" stroke="#337ab7" points="400.5,-276 343.5,-276 343.5,-252 400.5,-252 400.5,-276"/>
<text text-anchor="middle" x="372" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_forces</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_forces -->
<g id="proc~~siesta_forces~~UsesGraph_edge38" class="edge"><title>proc~siesta_forces&#45;&gt;m_forces</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M508.285,-898.897C509.888,-820.439 515.082,-383.999 435,-285 428.794,-277.327 419.664,-272.444 410.308,-269.34"/>
<polygon fill="#000000" stroke="#000000" points="411.158,-265.944 400.59,-266.707 409.327,-272.7 411.158,-265.944"/>
</g>
<!-- module~m_compute_dm -->
<g id="proc~~siesta_forces~~UsesGraph_node40" class="node"><title>module~m_compute_dm</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node40"><a xlink:href=".././module/m_compute_dm.html" xlink:title="m_compute_dm">
<polygon fill="#337ab7" stroke="#337ab7" points="417,-234 327,-234 327,-210 417,-210 417,-234"/>
<text text-anchor="middle" x="372" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_compute_dm</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;module~m_compute_dm -->
<g id="proc~~siesta_forces~~UsesGraph_edge39" class="edge"><title>proc~siesta_forces&#45;&gt;module~m_compute_dm</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.448,-898.785C503.446,-812.466 477.821,-296.33 435,-243 432.432,-239.802 429.355,-237.088 425.965,-234.785"/>
<polygon fill="#000000" stroke="#000000" points="427.452,-231.609 417.002,-229.867 424.085,-237.746 427.452,-231.609"/>
</g>
<!-- fdf -->
<g id="proc~~siesta_forces~~UsesGraph_node41" class="node"><title>fdf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="399,-192 345,-192 345,-168 399,-168 399,-192"/>
<text text-anchor="middle" x="372" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fdf</text>
</g>
<!-- proc~siesta_forces&#45;&gt;fdf -->
<g id="proc~~siesta_forces~~UsesGraph_edge40" class="edge"><title>proc~siesta_forces&#45;&gt;fdf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.535,-898.885C504.013,-809.802 480.446,-257.971 435,-201 428.515,-192.871 418.746,-187.87 408.868,-184.8"/>
<polygon fill="#000000" stroke="#000000" points="409.624,-181.381 399.071,-182.329 407.912,-188.168 409.624,-181.381"/>
</g>
<!-- m_initwf -->
<g id="proc~~siesta_forces~~UsesGraph_node42" class="node"><title>m_initwf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="399,-150 345,-150 345,-126 399,-126 399,-150"/>
<text text-anchor="middle" x="372" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_initwf</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_initwf -->
<g id="proc~~siesta_forces~~UsesGraph_edge41" class="edge"><title>proc~siesta_forces&#45;&gt;m_initwf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.604,-898.765C504.508,-806.319 483.037,-219.572 435,-159 428.539,-150.853 418.776,-145.846 408.897,-142.777"/>
<polygon fill="#000000" stroke="#000000" points="409.649,-139.357 399.097,-140.309 407.939,-146.145 409.649,-139.357"/>
</g>
<!-- sparse_matrices -->
<g id="proc~~siesta_forces~~UsesGraph_node43" class="node"><title>sparse_matrices</title>
<polygon fill="#337ab7" stroke="#337ab7" points="417.5,-108 326.5,-108 326.5,-84 417.5,-84 417.5,-108"/>
<text text-anchor="middle" x="372" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sparse_matrices</text>
</g>
<!-- proc~siesta_forces&#45;&gt;sparse_matrices -->
<g id="proc~~siesta_forces~~UsesGraph_edge42" class="edge"><title>proc~siesta_forces&#45;&gt;sparse_matrices</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.676,-899C505.025,-804.435 485.693,-181.257 435,-117 432.607,-113.966 429.756,-111.368 426.61,-109.143"/>
<polygon fill="#000000" stroke="#000000" points="428.133,-105.983 417.71,-104.083 424.673,-112.068 428.133,-105.983"/>
</g>
<!-- atomlist -->
<g id="proc~~siesta_forces~~UsesGraph_node44" class="node"><title>atomlist</title>
<polygon fill="#337ab7" stroke="#337ab7" points="399,-66 345,-66 345,-42 399,-42 399,-66"/>
<text text-anchor="middle" x="372" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">atomlist</text>
</g>
<!-- proc~siesta_forces&#45;&gt;atomlist -->
<g id="proc~~siesta_forces~~UsesGraph_edge43" class="edge"><title>proc~siesta_forces&#45;&gt;atomlist</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.734,-898.99C505.479,-801.589 488.31,-142.893 435,-75 428.578,-66.8214 418.826,-61.8065 408.945,-58.7385"/>
<polygon fill="#000000" stroke="#000000" points="409.692,-55.3172 399.14,-56.2744 407.985,-62.1061 409.692,-55.3172"/>
</g>
<!-- module~m_mixing_scf -->
<g id="proc~~siesta_forces~~UsesGraph_node45" class="node"><title>module~m_mixing_scf</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node45"><a xlink:href=".././module/m_mixing_scf.html" xlink:title="m_mixing_scf">
<polygon fill="#337ab7" stroke="#337ab7" points="411,-24 333,-24 333,-0 411,-0 411,-24"/>
<text text-anchor="middle" x="372" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_mixing_scf</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;module~m_mixing_scf -->
<g id="proc~~siesta_forces~~UsesGraph_edge44" class="edge"><title>proc~siesta_forces&#45;&gt;module~m_mixing_scf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.782,-898.71C505.884,-797.566 490.88,-104.47 435,-33 431.188,-28.1249 426.193,-24.3736 420.69,-21.4886"/>
<polygon fill="#000000" stroke="#000000" points="421.642,-18.0904 411.069,-17.4057 418.907,-24.5342 421.642,-18.0904"/>
</g>
<!-- module~m_state_analysis&#45;&gt;write_subs -->
<g id="proc~~siesta_forces~~UsesGraph_edge45" class="edge"><title>module~m_state_analysis&#45;&gt;write_subs</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M325.992,-1444.12C320.044,-1446.61 314.21,-1449.55 309,-1453 275.214,-1475.39 245.991,-1513.09 229.857,-1536.42"/>
<polygon fill="#000000" stroke="#000000" points="226.837,-1534.64 224.143,-1544.88 232.639,-1538.55 226.837,-1534.64"/>
</g>
<!-- module~m_compute_max_diff&#45;&gt;precision -->
<g id="proc~~siesta_forces~~UsesGraph_edge46" class="edge"><title>module~m_compute_max_diff&#45;&gt;precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M208.892,-1002.75C186.189,-953.18 100.937,-767.022 71.8191,-703.441"/>
<polygon fill="#000000" stroke="#000000" points="74.8446,-701.641 67.4986,-694.007 68.4802,-704.556 74.8446,-701.641"/>
</g>
<!-- class_Fstack_dData1D -->
<g id="proc~~siesta_forces~~UsesGraph_node46" class="node"><title>class_Fstack_dData1D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="122,-24 -7.10543e-15,-24 -7.10543e-15,-0 122,-0 122,-24"/>
<text text-anchor="middle" x="61" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_Fstack_dData1D</text>
</g>
<!-- module~m_mixing_scf&#45;&gt;class_Fstack_dData1D -->
<g id="proc~~siesta_forces~~UsesGraph_edge47" class="edge"><title>module~m_mixing_scf&#45;&gt;class_Fstack_dData1D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M332.801,-12C282.86,-12 194.44,-12 132.252,-12"/>
<polygon fill="#000000" stroke="#000000" points="132.121,-8.5001 122.121,-12 132.121,-15.5001 132.121,-8.5001"/>
</g>
<!-- module~m_mixing -->
<g id="proc~~siesta_forces~~UsesGraph_node47" class="node"><title>module~m_mixing</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node47"><a xlink:href=".././module/m_mixing.html" xlink:title="m_mixing">
<polygon fill="#337ab7" stroke="#337ab7" points="244.5,-65 186.5,-65 186.5,-41 244.5,-41 244.5,-65"/>
<text text-anchor="middle" x="215.5" y="-50.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_mixing</text>
</a>
</g>
</g>
<!-- module~m_mixing_scf&#45;&gt;module~m_mixing -->
<g id="proc~~siesta_forces~~UsesGraph_edge48" class="edge"><title>module~m_mixing_scf&#45;&gt;module~m_mixing</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M332.809,-22.1348C308.883,-28.4841 278.174,-36.6336 254.319,-42.964"/>
<polygon fill="#000000" stroke="#000000" points="253.322,-39.6072 244.554,-45.5552 255.118,-46.373 253.322,-39.6072"/>
</g>
<!-- module~m_mixing&#45;&gt;precision -->
<g id="proc~~siesta_forces~~UsesGraph_edge50" class="edge"><title>module~m_mixing&#45;&gt;precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M211.59,-65.0034C193.094,-141.29 91.9252,-558.571 67.3708,-659.848"/>
<polygon fill="#000000" stroke="#000000" points="63.8956,-659.327 64.9408,-669.87 70.6985,-660.977 63.8956,-659.327"/>
</g>
<!-- module~m_mixing&#45;&gt;class_Fstack_dData1D -->
<g id="proc~~siesta_forces~~UsesGraph_edge49" class="edge"><title>module~m_mixing&#45;&gt;class_Fstack_dData1D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M186.173,-45.3843C166.653,-40.1361 140.085,-32.9933 116.533,-26.6613"/>
<polygon fill="#000000" stroke="#000000" points="117.219,-23.2215 106.653,-24.0051 115.402,-29.9815 117.219,-23.2215"/>
</g>
<!-- class_dData1D -->
<g id="proc~~siesta_forces~~UsesGraph_node48" class="node"><title>class_dData1D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="103.5,-66 18.5,-66 18.5,-42 103.5,-42 103.5,-66"/>
<text text-anchor="middle" x="61" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_dData1D</text>
</g>
<!-- module~m_mixing&#45;&gt;class_dData1D -->
<g id="proc~~siesta_forces~~UsesGraph_edge51" class="edge"><title>module~m_mixing&#45;&gt;class_dData1D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M186.173,-53.1857C165.899,-53.3187 138.023,-53.5015 113.819,-53.6602"/>
<polygon fill="#000000" stroke="#000000" points="113.68,-50.1609 103.704,-53.7265 113.726,-57.1608 113.68,-50.1609"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="490pt" height="32pt"
 viewBox="0.00 0.00 489.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 485.5,-28 485.5,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node"><title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node"><title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="139.5,-24 72.5,-24 72.5,-0 139.5,-0 139.5,-24"/>
<text text-anchor="middle" x="106" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="222,-24 158,-24 158,-0 222,-0 222,-24"/>
<text text-anchor="middle" x="190" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="294,-24 240,-24 240,-0 294,-0 294,-24"/>
<text text-anchor="middle" x="267" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="366,-24 312,-24 312,-0 366,-0 366,-24"/>
<text text-anchor="middle" x="339" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="481.5,-24 384.5,-24 384.5,-0 481.5,-0 481.5,-24"/>
<text text-anchor="middle" x="433" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses.
    </p>
    </div></div></div></div>
      </li>
      
      </ul>
    </div>
    


    
    <p>This subroutine represents central SIESTA operation logic.</p>
<p></p><div class="alert alert-success" role="alert"><h4>Todo</h4><p>It might be better to split the two,
  putting the grid initialization into <strong>state_init (link!)</strong> and moving the
  calculation of <script type="math/tex"> H_0 </script> to the body of the loop, done <code>if first_scf=.true.</code>
  This would suit <em>analysis</em> runs in which <strong>nscf = 0</strong>
</p></div>
<p>
<p>The dHmax variable only has meaning for Hamiltonian
  mixing, or when requiring the Hamiltonian to be converged.</p>
<h1>SCF loop</h1>
<p>The current structure of the loop tries to reproduce the
  historical Siesta usage. It should be made more clear.</p>
<p>Two changes:</p>
<ol>
<li>The number of scf iterations performed is exactly
     equal to the number specified (i.e., the "forces"
     phase is not counted as a final scf step)</li>
<li>At the change to a TranSiesta GF run the variable "first_scf"
     is implicitly reset to "true".</li>
</ol>
<h2>Start of SCF cycle</h2>
<p>Conditions of exit:</p>
<ul>
<li>At the top, to catch a non-positive nscf and # of iterations</li>
<li>At the bottom, based on convergence</li>
</ul>
<p>Note implications for TranSiesta when mixing <script type="math/tex">H</script>.
  Now <script type="math/tex">H</script> will be recomputed instead of simply being
  inherited, however, this is required as if
  we have bias calculations as the electric
  field across the junction needs to be present.</p>
<p><strong>end of SCF cycle</strong></p>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-istep"></span>integer,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>istep</strong></td><td></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~siesta_forces~~CallsGraph Pages: 1 -->
<svg id="procsiesta_forcesCallsGraph" width="641pt" height="3815pt"
 viewBox="0.00 0.00 641.00 3815.16" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~siesta_forces~~CallsGraph" class="graph" transform="scale(0.670502 0.670502) rotate(0) translate(4 5686)">
<title>proc~~siesta_forces~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-5686 952,-5686 952,4 -4,4"/>
<!-- proc~siesta_forces -->
<g id="proc~~siesta_forces~~CallsGraph_node1" class="node"><title>proc~siesta_forces</title>
<polygon fill="none" stroke="black" points="76,-566 0,-566 0,-542 76,-542 76,-566"/>
<text text-anchor="middle" x="38" y="-551.6" font-family="Helvetica,sans-Serif" font-size="10.50">siesta_forces</text>
</g>
<!-- proc~state_init -->
<g id="proc~~siesta_forces~~CallsGraph_node2" class="node"><title>proc~state_init</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node2"><a xlink:href=".././proc/state_init.html" xlink:title="state_init">
<polygon fill="#d9534f" stroke="#d9534f" points="200,-2035 145,-2035 145,-2011 200,-2011 200,-2035"/>
<text text-anchor="middle" x="172.5" y="-2020.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">state_init</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;proc~state_init -->
<g id="proc~~siesta_forces~~CallsGraph_edge1" class="edge"><title>proc~siesta_forces&#45;&gt;proc~state_init</title>
<path fill="none" stroke="#000000" d="M40.1057,-566.258C51.8709,-696.697 153.876,-1827.61 169.497,-2000.79"/>
<polygon fill="#000000" stroke="#000000" points="166.015,-2001.15 170.399,-2010.79 172.986,-2000.52 166.015,-2001.15"/>
</g>
<!-- scfconvergence_test -->
<g id="proc~~siesta_forces~~CallsGraph_node3" class="node"><title>scfconvergence_test</title>
<polygon fill="#777777" stroke="#777777" points="228,-608 117,-608 117,-584 228,-584 228,-608"/>
<text text-anchor="middle" x="172.5" y="-593.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">scfconvergence_test</text>
</g>
<!-- proc~siesta_forces&#45;&gt;scfconvergence_test -->
<g id="proc~~siesta_forces~~CallsGraph_edge2" class="edge"><title>proc~siesta_forces&#45;&gt;scfconvergence_test</title>
<path fill="none" stroke="#000000" d="M76.2612,-565.811C91.0939,-570.513 108.341,-575.98 124.051,-580.96"/>
<polygon fill="#000000" stroke="#000000" points="123.009,-584.301 133.599,-583.986 125.124,-577.628 123.009,-584.301"/>
</g>
<!-- compute_energies -->
<g id="proc~~siesta_forces~~CallsGraph_node4" class="node"><title>compute_energies</title>
<polygon fill="#777777" stroke="#777777" points="223,-566 122,-566 122,-542 223,-542 223,-566"/>
<text text-anchor="middle" x="172.5" y="-551.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_energies</text>
</g>
<!-- proc~siesta_forces&#45;&gt;compute_energies -->
<g id="proc~~siesta_forces~~CallsGraph_edge3" class="edge"><title>proc~siesta_forces&#45;&gt;compute_energies</title>
<path fill="none" stroke="#000000" d="M76.2612,-554C87.2644,-554 99.5964,-554 111.644,-554"/>
<polygon fill="#000000" stroke="#000000" points="111.661,-557.5 121.661,-554 111.661,-550.5 111.661,-557.5"/>
</g>
<!-- mix_rhog -->
<g id="proc~~siesta_forces~~CallsGraph_node5" class="node"><title>mix_rhog</title>
<polygon fill="#777777" stroke="#777777" points="201,-524 144,-524 144,-500 201,-500 201,-524"/>
<text text-anchor="middle" x="172.5" y="-509.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mix_rhog</text>
</g>
<!-- proc~siesta_forces&#45;&gt;mix_rhog -->
<g id="proc~~siesta_forces~~CallsGraph_edge4" class="edge"><title>proc~siesta_forces&#45;&gt;mix_rhog</title>
<path fill="none" stroke="#000000" d="M76.2612,-542.189C94.3446,-536.457 116.017,-529.587 134.117,-523.85"/>
<polygon fill="#000000" stroke="#000000" points="135.284,-527.151 143.759,-520.793 133.169,-520.479 135.284,-527.151"/>
</g>
<!-- fdf_get -->
<g id="proc~~siesta_forces~~CallsGraph_node6" class="node"><title>fdf_get</title>
<polygon fill="#777777" stroke="#777777" points="359,-3119 305,-3119 305,-3095 359,-3095 359,-3119"/>
<text text-anchor="middle" x="332" y="-3104.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fdf_get</text>
</g>
<!-- proc~siesta_forces&#45;&gt;fdf_get -->
<g id="proc~~siesta_forces~~CallsGraph_edge19" class="edge"><title>proc~siesta_forces&#45;&gt;fdf_get</title>
<path fill="none" stroke="#000000" d="M39.1265,-566.296C40.307,-671.512 50.7691,-1431.3 112,-2044 158.354,-2507.83 -17.5301,-2713.32 269,-3081 275.511,-3089.35 285.197,-3095.05 294.989,-3098.93"/>
<polygon fill="#000000" stroke="#000000" points="294.108,-3102.33 304.702,-3102.23 296.359,-3095.7 294.108,-3102.33"/>
</g>
<!-- message -->
<g id="proc~~siesta_forces~~CallsGraph_node7" class="node"><title>message</title>
<polygon fill="#777777" stroke="#777777" points="534.5,-1473 478.5,-1473 478.5,-1449 534.5,-1449 534.5,-1473"/>
<text text-anchor="middle" x="506.5" y="-1458.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">message</text>
</g>
<!-- proc~siesta_forces&#45;&gt;message -->
<g id="proc~~siesta_forces~~CallsGraph_edge6" class="edge"><title>proc~siesta_forces&#45;&gt;message</title>
<path fill="none" stroke="#000000" d="M40.6415,-566.254C45.4589,-597.217 62.482,-679.1 112,-721 161.496,-762.881 353.716,-742.004 395,-792 486.83,-903.208 340.789,-1327.47 431,-1440 439.909,-1451.11 454.21,-1456.62 467.912,-1459.27"/>
<polygon fill="#000000" stroke="#000000" points="467.771,-1462.78 478.174,-1460.77 468.788,-1455.86 467.771,-1462.78"/>
</g>
<!-- proc~mixers_scf_history_init -->
<g id="proc~~siesta_forces~~CallsGraph_node8" class="node"><title>proc~mixers_scf_history_init</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node8"><a xlink:href=".././proc/mixers_scf_history_init.html" xlink:title="mixers_scf_history_init">
<polygon fill="#d9534f" stroke="#d9534f" points="233,-650 112,-650 112,-626 233,-626 233,-650"/>
<text text-anchor="middle" x="172.5" y="-635.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mixers_scf_history_init</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;proc~mixers_scf_history_init -->
<g id="proc~~siesta_forces~~CallsGraph_edge11" class="edge"><title>proc~siesta_forces&#45;&gt;proc~mixers_scf_history_init</title>
<path fill="none" stroke="#000000" d="M50.3237,-566.212C63.8364,-580.166 87.6725,-602.888 112,-617 115.029,-618.757 118.23,-620.403 121.512,-621.938"/>
<polygon fill="#000000" stroke="#000000" points="120.331,-625.24 130.901,-625.97 123.093,-618.808 120.331,-625.24"/>
</g>
<!-- interface~compute_max_diff -->
<g id="proc~~siesta_forces~~CallsGraph_node9" class="node"><title>interface~compute_max_diff</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node9"><a xlink:href=".././interface/compute_max_diff.html" xlink:title="compute_max_diff">
<polygon fill="#a7506f" stroke="#a7506f" points="556.5,-1431 456.5,-1431 456.5,-1407 556.5,-1407 556.5,-1431"/>
<text text-anchor="middle" x="506.5" y="-1416.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_max_diff</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;interface~compute_max_diff -->
<g id="proc~~siesta_forces~~CallsGraph_edge8" class="edge"><title>proc~siesta_forces&#45;&gt;interface~compute_max_diff</title>
<path fill="none" stroke="#000000" d="M41.7958,-566.161C48.685,-593.262 69.1214,-658.835 112,-692 214.241,-771.08 306.696,-664.612 395,-759 484.317,-854.471 501.994,-1292.19 504.962,-1396.6"/>
<polygon fill="#000000" stroke="#000000" points="501.471,-1396.99 505.237,-1406.9 508.469,-1396.81 501.471,-1396.99"/>
</g>
<!-- write_spmatrix -->
<g id="proc~~siesta_forces~~CallsGraph_node10" class="node"><title>write_spmatrix</title>
<polygon fill="#777777" stroke="#777777" points="213.5,-482 131.5,-482 131.5,-458 213.5,-458 213.5,-482"/>
<text text-anchor="middle" x="172.5" y="-467.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_spmatrix</text>
</g>
<!-- proc~siesta_forces&#45;&gt;write_spmatrix -->
<g id="proc~~siesta_forces~~CallsGraph_edge9" class="edge"><title>proc~siesta_forces&#45;&gt;write_spmatrix</title>
<path fill="none" stroke="#000000" d="M50.3237,-541.788C63.8364,-527.834 87.6725,-505.112 112,-491 115.171,-489.16 118.53,-487.443 121.974,-485.847"/>
<polygon fill="#000000" stroke="#000000" points="123.39,-489.048 131.216,-481.906 120.644,-482.609 123.39,-489.048"/>
</g>
<!-- set_tolerance -->
<g id="proc~~siesta_forces~~CallsGraph_node11" class="node"><title>set_tolerance</title>
<polygon fill="#777777" stroke="#777777" points="211,-440 134,-440 134,-416 211,-416 211,-440"/>
<text text-anchor="middle" x="172.5" y="-425.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_tolerance</text>
</g>
<!-- proc~siesta_forces&#45;&gt;set_tolerance -->
<g id="proc~~siesta_forces~~CallsGraph_edge10" class="edge"><title>proc~siesta_forces&#45;&gt;set_tolerance</title>
<path fill="none" stroke="#000000" d="M44.3648,-541.76C54.4899,-520.024 78.4511,-474.572 112,-449 115.828,-446.082 120.094,-443.547 124.536,-441.35"/>
<polygon fill="#000000" stroke="#000000" points="126.052,-444.508 133.816,-437.299 123.251,-438.092 126.052,-444.508"/>
</g>
<!-- proc~mixing_scf_converged -->
<g id="proc~~siesta_forces~~CallsGraph_node12" class="node"><title>proc~mixing_scf_converged</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node12"><a xlink:href=".././proc/mixing_scf_converged.html" xlink:title="mixing_scf_converged">
<polygon fill="#d9534f" stroke="#d9534f" points="232,-360 113,-360 113,-336 232,-336 232,-360"/>
<text text-anchor="middle" x="172.5" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mixing_scf_converged</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;proc~mixing_scf_converged -->
<g id="proc~~siesta_forces~~CallsGraph_edge12" class="edge"><title>proc~siesta_forces&#45;&gt;proc~mixing_scf_converged</title>
<path fill="none" stroke="#000000" d="M40.7204,-541.779C45.8007,-509.996 63.5387,-423.772 112,-374 115.228,-370.685 118.951,-367.764 122.926,-365.197"/>
<polygon fill="#000000" stroke="#000000" points="124.941,-368.079 131.939,-360.125 121.508,-361.979 124.941,-368.079"/>
</g>
<!-- save_density_matrix -->
<g id="proc~~siesta_forces~~CallsGraph_node13" class="node"><title>save_density_matrix</title>
<polygon fill="#777777" stroke="#777777" points="227.5,-318 117.5,-318 117.5,-294 227.5,-294 227.5,-318"/>
<text text-anchor="middle" x="172.5" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_density_matrix</text>
</g>
<!-- proc~siesta_forces&#45;&gt;save_density_matrix -->
<g id="proc~~siesta_forces~~CallsGraph_edge17" class="edge"><title>proc~siesta_forces&#45;&gt;save_density_matrix</title>
<path fill="none" stroke="#000000" d="M39.3064,-541.764C40.9074,-504.305 50.8221,-389.925 112,-327 113.074,-325.896 114.209,-324.849 115.396,-323.857"/>
<polygon fill="#000000" stroke="#000000" points="117.582,-326.604 123.872,-318.078 113.638,-320.82 117.582,-326.604"/>
</g>
<!-- proc~setup_hamiltonian -->
<g id="proc~~siesta_forces~~CallsGraph_node14" class="node"><title>proc~setup_hamiltonian</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node14"><a xlink:href=".././proc/setup_hamiltonian.html" xlink:title="setup_hamiltonian">
<polygon fill="#d9534f" stroke="#d9534f" points="222.5,-3711 122.5,-3711 122.5,-3687 222.5,-3687 222.5,-3711"/>
<text text-anchor="middle" x="172.5" y="-3696.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_hamiltonian</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;proc~setup_hamiltonian -->
<g id="proc~~siesta_forces~~CallsGraph_edge7" class="edge"><title>proc~siesta_forces&#45;&gt;proc~setup_hamiltonian</title>
<path fill="none" stroke="#000000" d="M38.9847,-566.185C38.7628,-771.527 37.2182,-3505.09 112,-3653 117.799,-3664.47 127.936,-3673.92 138.217,-3681.21"/>
<polygon fill="#000000" stroke="#000000" points="136.511,-3684.27 146.795,-3686.82 140.342,-3678.42 136.511,-3684.27"/>
</g>
<!-- bye -->
<g id="proc~~siesta_forces~~CallsGraph_node15" class="node"><title>bye</title>
<polygon fill="#777777" stroke="#777777" points="533.5,-4333 479.5,-4333 479.5,-4309 533.5,-4309 533.5,-4333"/>
<text text-anchor="middle" x="506.5" y="-4318.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bye</text>
</g>
<!-- proc~siesta_forces&#45;&gt;bye -->
<g id="proc~~siesta_forces~~CallsGraph_edge14" class="edge"><title>proc~siesta_forces&#45;&gt;bye</title>
<path fill="none" stroke="#000000" d="M38.9127,-566.28C38.1462,-689.578 34.3069,-1717.05 112,-2544 155.479,-3006.78 15.0866,-3188.66 269,-3578 305.235,-3633.56 361.434,-3600.79 395,-3658 467.305,-3781.25 341.593,-4188.54 431,-4300 440.202,-4311.47 455.151,-4316.97 469.252,-4319.51"/>
<polygon fill="#000000" stroke="#000000" points="468.894,-4323 479.275,-4320.88 469.841,-4316.06 468.894,-4323"/>
</g>
<!-- reset -->
<g id="proc~~siesta_forces~~CallsGraph_node16" class="node"><title>reset</title>
<polygon fill="#777777" stroke="#777777" points="359,-380 305,-380 305,-356 359,-356 359,-380"/>
<text text-anchor="middle" x="332" y="-365.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reset</text>
</g>
<!-- proc~siesta_forces&#45;&gt;reset -->
<g id="proc~~siesta_forces~~CallsGraph_edge24" class="edge"><title>proc~siesta_forces&#45;&gt;reset</title>
<path fill="none" stroke="#000000" d="M41.2254,-541.744C47.1162,-513.086 65.9375,-441.515 112,-407 140.25,-385.833 239.833,-375.009 294.463,-370.55"/>
<polygon fill="#000000" stroke="#000000" points="295.06,-374.014 304.755,-369.742 294.512,-367.035 295.06,-374.014"/>
</g>
<!-- check_walltime -->
<g id="proc~~siesta_forces~~CallsGraph_node17" class="node"><title>check_walltime</title>
<polygon fill="#777777" stroke="#777777" points="215,-276 130,-276 130,-252 215,-252 215,-276"/>
<text text-anchor="middle" x="172.5" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_walltime</text>
</g>
<!-- proc~siesta_forces&#45;&gt;check_walltime -->
<g id="proc~~siesta_forces~~CallsGraph_edge16" class="edge"><title>proc~siesta_forces&#45;&gt;check_walltime</title>
<path fill="none" stroke="#000000" d="M38.5812,-541.961C37.8074,-500.443 40.8868,-361.603 112,-285 114.613,-282.185 117.627,-279.747 120.882,-277.636"/>
<polygon fill="#000000" stroke="#000000" points="122.792,-280.584 129.954,-272.776 119.486,-274.413 122.792,-280.584"/>
</g>
<!-- barrier -->
<g id="proc~~siesta_forces~~CallsGraph_node18" class="node"><title>barrier</title>
<polygon fill="#777777" stroke="#777777" points="199.5,-234 145.5,-234 145.5,-210 199.5,-210 199.5,-234"/>
<text text-anchor="middle" x="172.5" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">barrier</text>
</g>
<!-- proc~siesta_forces&#45;&gt;barrier -->
<g id="proc~~siesta_forces~~CallsGraph_edge18" class="edge"><title>proc~siesta_forces&#45;&gt;barrier</title>
<path fill="none" stroke="#000000" d="M40.3068,-541.777C46.0744,-489.953 70.807,-288.935 112,-243 118.217,-236.067 126.866,-231.423 135.646,-228.312"/>
<polygon fill="#000000" stroke="#000000" points="136.89,-231.595 145.493,-225.411 134.911,-224.88 136.89,-231.595"/>
</g>
<!-- dm_charge -->
<g id="proc~~siesta_forces~~CallsGraph_node19" class="node"><title>dm_charge</title>
<polygon fill="#777777" stroke="#777777" points="206,-192 139,-192 139,-168 206,-168 206,-192"/>
<text text-anchor="middle" x="172.5" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dm_charge</text>
</g>
<!-- proc~siesta_forces&#45;&gt;dm_charge -->
<g id="proc~~siesta_forces~~CallsGraph_edge13" class="edge"><title>proc~siesta_forces&#45;&gt;dm_charge</title>
<path fill="none" stroke="#000000" d="M39.9453,-541.685C44.4902,-485.496 65.8006,-253.918 112,-201 116.647,-195.677 122.729,-191.704 129.229,-188.737"/>
<polygon fill="#000000" stroke="#000000" points="130.813,-191.88 138.931,-185.072 128.339,-185.332 130.813,-191.88"/>
</g>
<!-- proc~compute_dm -->
<g id="proc~~siesta_forces~~CallsGraph_node20" class="node"><title>proc~compute_dm</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node20"><a xlink:href=".././proc/compute_dm.html" xlink:title="compute_dm">
<polygon fill="#d9534f" stroke="#d9534f" points="210,-5262 135,-5262 135,-5238 210,-5238 210,-5262"/>
<text text-anchor="middle" x="172.5" y="-5247.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_dm</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;proc~compute_dm -->
<g id="proc~~siesta_forces~~CallsGraph_edge20" class="edge"><title>proc~siesta_forces&#45;&gt;proc~compute_dm</title>
<path fill="none" stroke="#000000" d="M38.9822,-566.247C38.6581,-808.911 34.8709,-4581.58 112,-5060 122.121,-5122.78 148.423,-5193.45 162.423,-5228.25"/>
<polygon fill="#000000" stroke="#000000" points="159.322,-5229.91 166.341,-5237.85 165.803,-5227.27 159.322,-5229.91"/>
</g>
<!-- compute_charge_diff -->
<g id="proc~~siesta_forces~~CallsGraph_node21" class="node"><title>compute_charge_diff</title>
<polygon fill="#777777" stroke="#777777" points="229,-150 116,-150 116,-126 229,-126 229,-150"/>
<text text-anchor="middle" x="172.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_charge_diff</text>
</g>
<!-- proc~siesta_forces&#45;&gt;compute_charge_diff -->
<g id="proc~~siesta_forces~~CallsGraph_edge21" class="edge"><title>proc~siesta_forces&#45;&gt;compute_charge_diff</title>
<path fill="none" stroke="#000000" d="M39.6407,-541.865C43.0299,-482.048 60.6919,-219.042 112,-159 112.747,-158.126 113.533,-157.288 114.354,-156.484"/>
<polygon fill="#000000" stroke="#000000" points="116.771,-159.04 122.545,-150.157 112.491,-153.5 116.771,-159.04"/>
</g>
<!-- proc~state_analysis -->
<g id="proc~~siesta_forces~~CallsGraph_node22" class="node"><title>proc~state_analysis</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node22"><a xlink:href=".././proc/state_analysis.html" xlink:title="state_analysis">
<polygon fill="#d9534f" stroke="#d9534f" points="372,-4766 292,-4766 292,-4742 372,-4742 372,-4766"/>
<text text-anchor="middle" x="332" y="-4751.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">state_analysis</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;proc~state_analysis -->
<g id="proc~~siesta_forces~~CallsGraph_edge22" class="edge"><title>proc~siesta_forces&#45;&gt;proc~state_analysis</title>
<path fill="none" stroke="#000000" d="M38.9645,-566.158C38.4644,-753.395 33.9674,-3049.65 112,-3720 159.999,-4132.34 294.191,-4623.4 324.752,-4732.03"/>
<polygon fill="#000000" stroke="#000000" points="321.439,-4733.18 327.526,-4741.85 328.175,-4731.28 321.439,-4733.18"/>
</g>
<!-- initwf -->
<g id="proc~~siesta_forces~~CallsGraph_node23" class="node"><title>initwf</title>
<polygon fill="#777777" stroke="#777777" points="199.5,-108 145.5,-108 145.5,-84 199.5,-84 199.5,-108"/>
<text text-anchor="middle" x="172.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">initwf</text>
</g>
<!-- proc~siesta_forces&#45;&gt;initwf -->
<g id="proc~~siesta_forces~~CallsGraph_edge23" class="edge"><title>proc~siesta_forces&#45;&gt;initwf</title>
<path fill="none" stroke="#000000" d="M39.4051,-541.87C41.7601,-478.323 55.6097,-184.152 112,-117 117.988,-109.869 126.561,-105.158 135.34,-102.047"/>
<polygon fill="#000000" stroke="#000000" points="136.593,-105.327 145.214,-99.1694 134.634,-98.6068 136.593,-105.327"/>
</g>
<!-- post_scf_work -->
<g id="proc~~siesta_forces~~CallsGraph_node24" class="node"><title>post_scf_work</title>
<polygon fill="#777777" stroke="#777777" points="213,-66 132,-66 132,-42 213,-42 213,-66"/>
<text text-anchor="middle" x="172.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">post_scf_work</text>
</g>
<!-- proc~siesta_forces&#45;&gt;post_scf_work -->
<g id="proc~~siesta_forces~~CallsGraph_edge15" class="edge"><title>proc~siesta_forces&#45;&gt;post_scf_work</title>
<path fill="none" stroke="#000000" d="M39.2154,-541.615C40.6325,-473.941 50.5887,-149.2 112,-75 114.988,-71.3897 118.639,-68.3996 122.648,-65.9232"/>
<polygon fill="#000000" stroke="#000000" points="124.516,-68.9013 131.878,-61.2813 121.371,-62.6477 124.516,-68.9013"/>
</g>
<!-- mixer -->
<g id="proc~~siesta_forces~~CallsGraph_node25" class="node"><title>mixer</title>
<polygon fill="#777777" stroke="#777777" points="199.5,-24 145.5,-24 145.5,-0 199.5,-0 199.5,-24"/>
<text text-anchor="middle" x="172.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mixer</text>
</g>
<!-- proc~siesta_forces&#45;&gt;mixer -->
<g id="proc~~siesta_forces~~CallsGraph_edge27" class="edge"><title>proc~siesta_forces&#45;&gt;mixer</title>
<path fill="none" stroke="#000000" d="M39.0454,-541.947C39.5454,-471.612 45.3736,-114.494 112,-33 118.008,-25.6509 126.767,-20.8709 135.725,-17.7628"/>
<polygon fill="#000000" stroke="#000000" points="136.746,-21.1113 145.403,-15.0039 134.827,-14.3794 136.746,-21.1113"/>
</g>
<!-- transiesta -->
<g id="proc~~siesta_forces~~CallsGraph_node26" class="node"><title>transiesta</title>
<polygon fill="#777777" stroke="#777777" points="361.5,-5682 302.5,-5682 302.5,-5658 361.5,-5658 361.5,-5682"/>
<text text-anchor="middle" x="332" y="-5667.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">transiesta</text>
</g>
<!-- proc~siesta_forces&#45;&gt;transiesta -->
<g id="proc~~siesta_forces~~CallsGraph_edge25" class="edge"><title>proc~siesta_forces&#45;&gt;transiesta</title>
<path fill="none" stroke="#000000" d="M39.0547,-566.023C40.227,-820.209 60.3701,-5022.15 112,-5271 148.955,-5449.12 136.126,-5524.75 269,-5649 275.634,-5655.2 284.169,-5659.58 292.771,-5662.67"/>
<polygon fill="#000000" stroke="#000000" points="291.827,-5666.04 302.414,-5665.63 293.884,-5659.35 291.827,-5666.04"/>
</g>
<!-- die -->
<g id="proc~~siesta_forces~~CallsGraph_node27" class="node"><title>die</title>
<polygon fill="#777777" stroke="#777777" points="842,-2108 788,-2108 788,-2084 842,-2084 842,-2108"/>
<text text-anchor="middle" x="815" y="-2093.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">die</text>
</g>
<!-- proc~siesta_forces&#45;&gt;die -->
<g id="proc~~siesta_forces~~CallsGraph_edge26" class="edge"><title>proc~siesta_forces&#45;&gt;die</title>
<path fill="none" stroke="#000000" d="M43.7028,-566.053C53.0617,-588.33 76.2484,-635.785 112,-659 219.393,-728.734 293.748,-634.615 395,-713 675.298,-929.994 638.198,-1093.28 736,-1434 805.905,-1677.53 813.291,-1988.71 813.964,-2073.7"/>
<polygon fill="#000000" stroke="#000000" points="810.466,-2073.98 814.02,-2083.96 817.466,-2073.94 810.466,-2073.98"/>
</g>
<!-- timer -->
<g id="proc~~siesta_forces~~CallsGraph_node28" class="node"><title>timer</title>
<polygon fill="#777777" stroke="#777777" points="948,-3177 894,-3177 894,-3153 948,-3153 948,-3177"/>
<text text-anchor="middle" x="921" y="-3162.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">timer</text>
</g>
<!-- proc~siesta_forces&#45;&gt;timer -->
<g id="proc~~siesta_forces~~CallsGraph_edge5" class="edge"><title>proc~siesta_forces&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M39.1093,-566.244C41.023,-778.462 67.957,-3682.76 112,-4055 150.483,-4380.25 170.285,-4462.71 269,-4775 312.587,-4912.89 352.825,-4936.67 395,-5075 419.174,-5154.29 366.979,-5205.35 431,-5258 482.833,-5300.63 529.769,-5300.14 582,-5258 1033.57,-4893.66 774.517,-4556.19 858,-3982 903.529,-3668.85 916.748,-3283.01 919.431,-3187.27"/>
<polygon fill="#000000" stroke="#000000" points="922.935,-3187.15 919.707,-3177.06 915.938,-3186.96 922.935,-3187.15"/>
</g>
<!-- proc~state_init&#45;&gt;fdf_get -->
<g id="proc~~siesta_forces~~CallsGraph_edge38" class="edge"><title>proc~state_init&#45;&gt;fdf_get</title>
<path fill="none" stroke="#000000" d="M175.013,-2035.33C182.247,-2094.58 213.752,-2356.06 233,-2571 238.067,-2627.58 235.896,-3034.83 269,-3081 275.34,-3089.84 285.283,-3095.69 295.364,-3099.56"/>
<polygon fill="#000000" stroke="#000000" points="294.366,-3102.91 304.959,-3102.69 296.537,-3096.26 294.366,-3102.91"/>
</g>
<!-- proc~state_init&#45;&gt;message -->
<g id="proc~~siesta_forces~~CallsGraph_edge42" class="edge"><title>proc~state_init&#45;&gt;message</title>
<path fill="none" stroke="#000000" d="M174.242,-2010.79C179.748,-1922.24 215.499,-1380.6 269,-1334 311.229,-1297.22 349.478,-1301.38 395,-1334 435.445,-1362.98 394.905,-1405.76 431,-1440 441.099,-1449.58 455.225,-1454.85 468.464,-1457.72"/>
<polygon fill="#000000" stroke="#000000" points="467.874,-1461.17 478.333,-1459.48 469.105,-1454.28 467.874,-1461.17"/>
</g>
<!-- proc~state_init&#45;&gt;bye -->
<g id="proc~~siesta_forces~~CallsGraph_edge58" class="edge"><title>proc~state_init&#45;&gt;bye</title>
<path fill="none" stroke="#000000" d="M173.467,-2035.4C173.2,-2173.06 173.463,-3413.16 269,-3541 304.687,-3588.75 359.609,-3539.03 395,-3587 489.182,-3714.67 332.08,-4175.97 431,-4300 440.17,-4311.5 455.114,-4317 469.22,-4319.54"/>
<polygon fill="#000000" stroke="#000000" points="468.869,-4323.02 479.249,-4320.9 469.812,-4316.09 468.869,-4323.02"/>
</g>
<!-- proc~state_init&#45;&gt;die -->
<g id="proc~~siesta_forces~~CallsGraph_edge78" class="edge"><title>proc~state_init&#45;&gt;die</title>
<path fill="none" stroke="#000000" d="M174.8,-2010.88C181.227,-1953.5 211.619,-1710.05 269,-1666 313.421,-1631.9 343.403,-1644.24 395,-1666 603.181,-1753.82 759.224,-2001.22 802.162,-2074.99"/>
<polygon fill="#000000" stroke="#000000" points="799.236,-2076.92 807.256,-2083.84 805.304,-2073.43 799.236,-2076.92"/>
</g>
<!-- proc~state_init&#45;&gt;timer -->
<g id="proc~~siesta_forces~~CallsGraph_edge81" class="edge"><title>proc~state_init&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M200.217,-2023.84C212.151,-2025.71 225.246,-2030.11 233,-2040 299.534,-2124.88 191.336,-2935.16 269,-3010 309.326,-3048.86 350.655,-3044.2 395,-3010 444.854,-2971.55 381.146,-2911.45 431,-2873 433.305,-2871.22 735.649,-2873.96 736,-2874 791.41,-2880.9 818.673,-2864.36 858,-2904 891.75,-2938.02 911.303,-3085.99 917.675,-3142.74"/>
<polygon fill="#000000" stroke="#000000" points="914.21,-3143.25 918.774,-3152.81 921.168,-3142.49 914.21,-3143.25"/>
</g>
<!-- volcel -->
<g id="proc~~siesta_forces~~CallsGraph_node29" class="node"><title>volcel</title>
<polygon fill="#777777" stroke="#777777" points="533.5,-4291 479.5,-4291 479.5,-4267 533.5,-4267 533.5,-4291"/>
<text text-anchor="middle" x="506.5" y="-4276.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">volcel</text>
</g>
<!-- proc~state_init&#45;&gt;volcel -->
<g id="proc~~siesta_forces~~CallsGraph_edge28" class="edge"><title>proc~state_init&#45;&gt;volcel</title>
<path fill="none" stroke="#000000" d="M173.474,-2035.12C173.287,-2169.72 174.248,-3382.16 269,-3506 304.956,-3552.99 359.355,-3501.77 395,-3549 489.365,-3674.04 337.067,-4127.64 431,-4253 440.056,-4265.09 455.128,-4271.58 469.355,-4275.07"/>
<polygon fill="#000000" stroke="#000000" points="468.973,-4278.56 479.467,-4277.1 470.357,-4271.7 468.973,-4278.56"/>
</g>
<!-- mscell -->
<g id="proc~~siesta_forces~~CallsGraph_node30" class="node"><title>mscell</title>
<polygon fill="#777777" stroke="#777777" points="359,-2791 305,-2791 305,-2767 359,-2767 359,-2791"/>
<text text-anchor="middle" x="332" y="-2776.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mscell</text>
</g>
<!-- proc~state_init&#45;&gt;mscell -->
<g id="proc~~siesta_forces~~CallsGraph_edge30" class="edge"><title>proc~state_init&#45;&gt;mscell</title>
<path fill="none" stroke="#000000" d="M174.717,-2035.22C184.079,-2128.77 244.934,-2728.64 269,-2758 275.539,-2765.98 285.233,-2770.94 295.023,-2774.02"/>
<polygon fill="#000000" stroke="#000000" points="294.176,-2777.41 304.733,-2776.51 295.919,-2770.63 294.176,-2777.41"/>
</g>
<!-- re_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_node32" class="node"><title>re_alloc</title>
<polygon fill="#777777" stroke="#777777" points="948,-2646 894,-2646 894,-2622 948,-2622 948,-2646"/>
<text text-anchor="middle" x="921" y="-2631.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">re_alloc</text>
</g>
<!-- proc~state_init&#45;&gt;re_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge32" class="edge"><title>proc~state_init&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M173.465,-2010.91C173.191,-1879.2 173.477,-713.263 269,-598 338.266,-514.42 396.949,-537 505.5,-537 505.5,-537 505.5,-537 678,-537 898.294,-537 918.256,-2386.9 919.868,-2611.71"/>
<polygon fill="#000000" stroke="#000000" points="916.37,-2611.97 919.937,-2621.95 923.37,-2611.92 916.37,-2611.97"/>
</g>
<!-- newddata2d -->
<g id="proc~~siesta_forces~~CallsGraph_node33" class="node"><title>newddata2d</title>
<polygon fill="#777777" stroke="#777777" points="367.5,-2749 296.5,-2749 296.5,-2725 367.5,-2725 367.5,-2749"/>
<text text-anchor="middle" x="332" y="-2734.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">newddata2d</text>
</g>
<!-- proc~state_init&#45;&gt;newddata2d -->
<g id="proc~~siesta_forces~~CallsGraph_edge33" class="edge"><title>proc~state_init&#45;&gt;newddata2d</title>
<path fill="none" stroke="#000000" d="M174.801,-2035.09C184.535,-2125.13 246.227,-2688.44 269,-2716 273.728,-2721.72 280.079,-2725.89 286.917,-2728.93"/>
<polygon fill="#000000" stroke="#000000" points="285.844,-2732.26 296.437,-2732.4 288.245,-2725.69 285.844,-2732.26"/>
</g>
<!-- superc -->
<g id="proc~~siesta_forces~~CallsGraph_node34" class="node"><title>superc</title>
<polygon fill="#777777" stroke="#777777" points="359,-2707 305,-2707 305,-2683 359,-2683 359,-2707"/>
<text text-anchor="middle" x="332" y="-2692.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">superc</text>
</g>
<!-- proc~state_init&#45;&gt;superc -->
<g id="proc~~siesta_forces~~CallsGraph_edge50" class="edge"><title>proc~state_init&#45;&gt;superc</title>
<path fill="none" stroke="#000000" d="M174.523,-2035.19C181.759,-2120.19 226.164,-2622.62 269,-2674 275.604,-2681.92 285.317,-2686.87 295.105,-2689.95"/>
<polygon fill="#000000" stroke="#000000" points="294.248,-2693.34 304.806,-2692.45 295.997,-2686.56 294.248,-2693.34"/>
</g>
<!-- ioxv -->
<g id="proc~~siesta_forces~~CallsGraph_node39" class="node"><title>ioxv</title>
<polygon fill="#777777" stroke="#777777" points="359,-2665 305,-2665 305,-2641 359,-2641 359,-2665"/>
<text text-anchor="middle" x="332" y="-2650.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ioxv</text>
</g>
<!-- proc~state_init&#45;&gt;ioxv -->
<g id="proc~~siesta_forces~~CallsGraph_edge59" class="edge"><title>proc~state_init&#45;&gt;ioxv</title>
<path fill="none" stroke="#000000" d="M173.741,-2035.05C175.516,-2112.21 188.863,-2536.83 269,-2632 275.643,-2639.89 285.368,-2644.82 295.154,-2647.91"/>
<polygon fill="#000000" stroke="#000000" points="294.291,-2651.3 304.849,-2650.41 296.044,-2644.52 294.291,-2651.3"/>
</g>
<!-- setup_ts_kpoint_scf -->
<g id="proc~~siesta_forces~~CallsGraph_node40" class="node"><title>setup_ts_kpoint_scf</title>
<polygon fill="#777777" stroke="#777777" points="385.5,-2623 278.5,-2623 278.5,-2599 385.5,-2599 385.5,-2623"/>
<text text-anchor="middle" x="332" y="-2608.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_ts_kpoint_scf</text>
</g>
<!-- proc~state_init&#45;&gt;setup_ts_kpoint_scf -->
<g id="proc~~siesta_forces~~CallsGraph_edge60" class="edge"><title>proc~state_init&#45;&gt;setup_ts_kpoint_scf</title>
<path fill="none" stroke="#000000" d="M173.898,-2035.17C176.563,-2109.5 194.075,-2502.04 269,-2590 269.85,-2591 270.749,-2591.95 271.691,-2592.85"/>
<polygon fill="#000000" stroke="#000000" points="269.587,-2595.65 279.655,-2598.95 273.841,-2590.09 269.587,-2595.65"/>
</g>
<!-- setup_ordern_indexes -->
<g id="proc~~siesta_forces~~CallsGraph_node42" class="node"><title>setup_ordern_indexes</title>
<polygon fill="#777777" stroke="#777777" points="391.5,-2581 272.5,-2581 272.5,-2557 391.5,-2557 391.5,-2581"/>
<text text-anchor="middle" x="332" y="-2566.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_ordern_indexes</text>
</g>
<!-- proc~state_init&#45;&gt;setup_ordern_indexes -->
<g id="proc~~siesta_forces~~CallsGraph_edge63" class="edge"><title>proc~state_init&#45;&gt;setup_ordern_indexes</title>
<path fill="none" stroke="#000000" d="M174.077,-2035.18C177.68,-2106.28 199.236,-2467.17 269,-2548 269.856,-2548.99 270.761,-2549.94 271.709,-2550.84"/>
<polygon fill="#000000" stroke="#000000" points="269.622,-2553.65 279.704,-2556.91 273.855,-2548.07 269.622,-2553.65"/>
</g>
<!-- setup_dmhs_netcdf_file -->
<g id="proc~~siesta_forces~~CallsGraph_node43" class="node"><title>setup_dmhs_netcdf_file</title>
<polygon fill="#777777" stroke="#777777" points="395,-2539 269,-2539 269,-2515 395,-2515 395,-2539"/>
<text text-anchor="middle" x="332" y="-2524.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_dmhs_netcdf_file</text>
</g>
<!-- proc~state_init&#45;&gt;setup_dmhs_netcdf_file -->
<g id="proc~~siesta_forces~~CallsGraph_edge40" class="edge"><title>proc~state_init&#45;&gt;setup_dmhs_netcdf_file</title>
<path fill="none" stroke="#000000" d="M174.28,-2035.08C178.863,-2102.55 204.345,-2432.24 269,-2506 269.864,-2506.99 270.776,-2507.92 271.729,-2508.82"/>
<polygon fill="#000000" stroke="#000000" points="269.664,-2511.65 279.761,-2514.86 273.871,-2506.05 269.664,-2511.65"/>
</g>
<!-- new_dm -->
<g id="proc~~siesta_forces~~CallsGraph_node45" class="node"><title>new_dm</title>
<polygon fill="#777777" stroke="#777777" points="359,-2497 305,-2497 305,-2473 359,-2473 359,-2497"/>
<text text-anchor="middle" x="332" y="-2482.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">new_dm</text>
</g>
<!-- proc~state_init&#45;&gt;new_dm -->
<g id="proc~~siesta_forces~~CallsGraph_edge67" class="edge"><title>proc~state_init&#45;&gt;new_dm</title>
<path fill="none" stroke="#000000" d="M174.543,-2035.28C180.239,-2099.62 209.53,-2397.38 269,-2464 275.74,-2471.55 285.295,-2476.39 294.89,-2479.49"/>
<polygon fill="#000000" stroke="#000000" points="294.222,-2482.93 304.787,-2482.13 296.028,-2476.17 294.222,-2482.93"/>
</g>
<!-- exact_sc_ag -->
<g id="proc~~siesta_forces~~CallsGraph_node46" class="node"><title>exact_sc_ag</title>
<polygon fill="#777777" stroke="#777777" points="368.5,-2455 295.5,-2455 295.5,-2431 368.5,-2431 368.5,-2455"/>
<text text-anchor="middle" x="332" y="-2440.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">exact_sc_ag</text>
</g>
<!-- proc~state_init&#45;&gt;exact_sc_ag -->
<g id="proc~~siesta_forces~~CallsGraph_edge29" class="edge"><title>proc~state_init&#45;&gt;exact_sc_ag</title>
<path fill="none" stroke="#000000" d="M174.846,-2035.3C181.712,-2095.92 214.634,-2362.41 269,-2422 273.632,-2427.08 279.534,-2430.93 285.849,-2433.85"/>
<polygon fill="#000000" stroke="#000000" points="284.707,-2437.16 295.296,-2437.49 287.228,-2430.63 284.707,-2437.16"/>
</g>
<!-- cmladdproperty -->
<g id="proc~~siesta_forces~~CallsGraph_node48" class="node"><title>cmladdproperty</title>
<polygon fill="#777777" stroke="#777777" points="550,-4375 463,-4375 463,-4351 550,-4351 550,-4375"/>
<text text-anchor="middle" x="506.5" y="-4360.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cmladdproperty</text>
</g>
<!-- proc~state_init&#45;&gt;cmladdproperty -->
<g id="proc~~siesta_forces~~CallsGraph_edge75" class="edge"><title>proc~state_init&#45;&gt;cmladdproperty</title>
<path fill="none" stroke="#000000" d="M173.579,-2035.18C174.562,-2173.01 185.823,-3437.08 269,-3578 302.718,-3635.13 361.532,-3600.73 395,-3658 471.795,-3789.42 335.966,-4223.1 431,-4342 436.669,-4349.09 444.536,-4353.9 453.045,-4357.14"/>
<polygon fill="#000000" stroke="#000000" points="452.255,-4360.56 462.843,-4360.17 454.323,-4353.88 452.255,-4360.56"/>
</g>
<!-- sporb_to_spatom -->
<g id="proc~~siesta_forces~~CallsGraph_node53" class="node"><title>sporb_to_spatom</title>
<polygon fill="#777777" stroke="#777777" points="380,-2413 284,-2413 284,-2389 380,-2389 380,-2413"/>
<text text-anchor="middle" x="332" y="-2398.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sporb_to_spatom</text>
</g>
<!-- proc~state_init&#45;&gt;sporb_to_spatom -->
<g id="proc~~siesta_forces~~CallsGraph_edge79" class="edge"><title>proc~state_init&#45;&gt;sporb_to_spatom</title>
<path fill="none" stroke="#000000" d="M172.942,-2035.05C171.318,-2084.79 171.841,-2276.29 269,-2380 270.836,-2381.96 272.86,-2383.74 275.024,-2385.35"/>
<polygon fill="#000000" stroke="#000000" points="273.586,-2388.57 283.949,-2390.77 277.223,-2382.59 273.586,-2388.57"/>
</g>
<!-- newzspdata2d -->
<g id="proc~~siesta_forces~~CallsGraph_node54" class="node"><title>newzspdata2d</title>
<polygon fill="#777777" stroke="#777777" points="373,-2371 291,-2371 291,-2347 373,-2347 373,-2371"/>
<text text-anchor="middle" x="332" y="-2356.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">newzspdata2d</text>
</g>
<!-- proc~state_init&#45;&gt;newzspdata2d -->
<g id="proc~~siesta_forces~~CallsGraph_edge82" class="edge"><title>proc~state_init&#45;&gt;newzspdata2d</title>
<path fill="none" stroke="#000000" d="M173.452,-2035.2C173.946,-2081.49 181.943,-2248.09 269,-2338 272.613,-2341.73 276.912,-2344.8 281.537,-2347.32"/>
<polygon fill="#000000" stroke="#000000" points="280.189,-2350.55 290.738,-2351.53 283.102,-2344.19 280.189,-2350.55"/>
</g>
<!-- siesta_write_positions -->
<g id="proc~~siesta_forces~~CallsGraph_node55" class="node"><title>siesta_write_positions</title>
<polygon fill="#777777" stroke="#777777" points="390.5,-2329 273.5,-2329 273.5,-2305 390.5,-2305 390.5,-2329"/>
<text text-anchor="middle" x="332" y="-2314.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_write_positions</text>
</g>
<!-- proc~state_init&#45;&gt;siesta_write_positions -->
<g id="proc~~siesta_forces~~CallsGraph_edge83" class="edge"><title>proc~state_init&#45;&gt;siesta_write_positions</title>
<path fill="none" stroke="#000000" d="M174.102,-2035.03C176.858,-2077.14 191.75,-2219.51 269,-2296 270.11,-2297.1 271.28,-2298.14 272.5,-2299.13"/>
<polygon fill="#000000" stroke="#000000" points="270.908,-2302.27 281.176,-2304.89 274.779,-2296.44 270.908,-2302.27"/>
</g>
<!-- write_debug -->
<g id="proc~~siesta_forces~~CallsGraph_node57" class="node"><title>write_debug</title>
<polygon fill="#777777" stroke="#777777" points="850.5,-3750 779.5,-3750 779.5,-3726 850.5,-3726 850.5,-3750"/>
<text text-anchor="middle" x="815" y="-3735.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_debug</text>
</g>
<!-- proc~state_init&#45;&gt;write_debug -->
<g id="proc~~siesta_forces~~CallsGraph_edge87" class="edge"><title>proc~state_init&#45;&gt;write_debug</title>
<path fill="none" stroke="#000000" d="M200.223,-2023.84C212.158,-2025.7 225.252,-2030.1 233,-2040 301.741,-2127.81 194.213,-2960.28 269,-3043 316.085,-3095.08 515.31,-3064.05 582,-3086 656.057,-3110.37 691.724,-3105.83 736,-3170 798.875,-3261.13 811.375,-3622.78 813.572,-3715.99"/>
<polygon fill="#000000" stroke="#000000" points="810.073,-3716.07 813.791,-3725.99 817.071,-3715.92 810.073,-3716.07"/>
</g>
<!-- domaindecom -->
<g id="proc~~siesta_forces~~CallsGraph_node60" class="node"><title>domaindecom</title>
<polygon fill="#777777" stroke="#777777" points="372,-2287 292,-2287 292,-2263 372,-2263 372,-2287"/>
<text text-anchor="middle" x="332" y="-2272.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">domaindecom</text>
</g>
<!-- proc~state_init&#45;&gt;domaindecom -->
<g id="proc~~siesta_forces~~CallsGraph_edge92" class="edge"><title>proc~state_init&#45;&gt;domaindecom</title>
<path fill="none" stroke="#000000" d="M174.968,-2035.01C180.224,-2072.86 201.536,-2190.81 269,-2254 272.992,-2257.74 277.674,-2260.81 282.645,-2263.34"/>
<polygon fill="#000000" stroke="#000000" points="281.254,-2266.55 291.821,-2267.33 284.045,-2260.13 281.254,-2266.55"/>
</g>
<!-- globalize_or -->
<g id="proc~~siesta_forces~~CallsGraph_node64" class="node"><title>globalize_or</title>
<polygon fill="#777777" stroke="#777777" points="367,-2245 297,-2245 297,-2221 367,-2221 367,-2245"/>
<text text-anchor="middle" x="332" y="-2230.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">globalize_or</text>
</g>
<!-- proc~state_init&#45;&gt;globalize_or -->
<g id="proc~~siesta_forces~~CallsGraph_edge36" class="edge"><title>proc~state_init&#45;&gt;globalize_or</title>
<path fill="none" stroke="#000000" d="M176.222,-2035.16C184.298,-2068.44 211.247,-2161.88 269,-2212 274.305,-2216.6 280.663,-2220.21 287.256,-2223.03"/>
<polygon fill="#000000" stroke="#000000" points="286.396,-2226.44 296.989,-2226.62 288.821,-2219.88 286.396,-2226.44"/>
</g>
<!-- crtsparsity_sc -->
<g id="proc~~siesta_forces~~CallsGraph_node66" class="node"><title>crtsparsity_sc</title>
<polygon fill="#777777" stroke="#777777" points="371,-2203 293,-2203 293,-2179 371,-2179 371,-2203"/>
<text text-anchor="middle" x="332" y="-2188.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">crtsparsity_sc</text>
</g>
<!-- proc~state_init&#45;&gt;crtsparsity_sc -->
<g id="proc~~siesta_forces~~CallsGraph_edge46" class="edge"><title>proc~state_init&#45;&gt;crtsparsity_sc</title>
<path fill="none" stroke="#000000" d="M178.142,-2035.24C189.372,-2063.25 220.698,-2132.46 269,-2170 273.375,-2173.4 278.331,-2176.27 283.49,-2178.68"/>
<polygon fill="#000000" stroke="#000000" points="282.332,-2181.99 292.912,-2182.55 284.992,-2175.51 282.332,-2181.99"/>
</g>
<!-- proximity_check -->
<g id="proc~~siesta_forces~~CallsGraph_node67" class="node"><title>proximity_check</title>
<polygon fill="#777777" stroke="#777777" points="376.5,-2161 287.5,-2161 287.5,-2137 376.5,-2137 376.5,-2161"/>
<text text-anchor="middle" x="332" y="-2146.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">proximity_check</text>
</g>
<!-- proc~state_init&#45;&gt;proximity_check -->
<g id="proc~~siesta_forces~~CallsGraph_edge48" class="edge"><title>proc~state_init&#45;&gt;proximity_check</title>
<path fill="none" stroke="#000000" d="M181.459,-2035.23C196.197,-2056.94 229.829,-2102.36 269,-2128 271.893,-2129.89 274.973,-2131.63 278.156,-2133.23"/>
<polygon fill="#000000" stroke="#000000" points="276.772,-2136.45 287.328,-2137.36 279.644,-2130.06 276.772,-2136.45"/>
</g>
<!-- overlap -->
<g id="proc~~siesta_forces~~CallsGraph_node68" class="node"><title>overlap</title>
<polygon fill="#777777" stroke="#777777" points="359,-2119 305,-2119 305,-2095 359,-2095 359,-2119"/>
<text text-anchor="middle" x="332" y="-2104.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">overlap</text>
</g>
<!-- proc~state_init&#45;&gt;overlap -->
<g id="proc~~siesta_forces~~CallsGraph_edge86" class="edge"><title>proc~state_init&#45;&gt;overlap</title>
<path fill="none" stroke="#000000" d="M188.97,-2035.02C207.263,-2048.79 239.024,-2071.34 269,-2086 277.233,-2090.03 286.432,-2093.6 295.172,-2096.61"/>
<polygon fill="#000000" stroke="#000000" points="294.174,-2099.96 304.767,-2099.75 296.356,-2093.31 294.174,-2099.96"/>
</g>
<!-- cmlendpropertylist -->
<g id="proc~~siesta_forces~~CallsGraph_node69" class="node"><title>cmlendpropertylist</title>
<polygon fill="#777777" stroke="#777777" points="382,-2077 282,-2077 282,-2053 382,-2053 382,-2077"/>
<text text-anchor="middle" x="332" y="-2062.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cmlendpropertylist</text>
</g>
<!-- proc~state_init&#45;&gt;cmlendpropertylist -->
<g id="proc~~siesta_forces~~CallsGraph_edge52" class="edge"><title>proc~state_init&#45;&gt;cmlendpropertylist</title>
<path fill="none" stroke="#000000" d="M200.218,-2030.12C220.905,-2035.64 250.263,-2043.47 275.923,-2050.31"/>
<polygon fill="#000000" stroke="#000000" points="275.354,-2053.78 285.918,-2052.98 277.157,-2047.02 275.354,-2053.78"/>
</g>
<!-- newdspdata1d -->
<g id="proc~~siesta_forces~~CallsGraph_node70" class="node"><title>newdspdata1d</title>
<polygon fill="#777777" stroke="#777777" points="373,-2035 291,-2035 291,-2011 373,-2011 373,-2035"/>
<text text-anchor="middle" x="332" y="-2020.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">newdspdata1d</text>
</g>
<!-- proc~state_init&#45;&gt;newdspdata1d -->
<g id="proc~~siesta_forces~~CallsGraph_edge53" class="edge"><title>proc~state_init&#45;&gt;newdspdata1d</title>
<path fill="none" stroke="#000000" d="M200.218,-2023C222.144,-2023 253.812,-2023 280.494,-2023"/>
<polygon fill="#000000" stroke="#000000" points="280.822,-2026.5 290.821,-2023 280.821,-2019.5 280.822,-2026.5"/>
</g>
<!-- newsparsity -->
<g id="proc~~siesta_forces~~CallsGraph_node71" class="node"><title>newsparsity</title>
<polygon fill="#777777" stroke="#777777" points="366.5,-1993 297.5,-1993 297.5,-1969 366.5,-1969 366.5,-1993"/>
<text text-anchor="middle" x="332" y="-1978.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">newsparsity</text>
</g>
<!-- proc~state_init&#45;&gt;newsparsity -->
<g id="proc~~siesta_forces~~CallsGraph_edge41" class="edge"><title>proc~state_init&#45;&gt;newsparsity</title>
<path fill="none" stroke="#000000" d="M200.218,-2015.88C224.058,-2009.52 259.414,-2000.09 287.356,-1992.64"/>
<polygon fill="#000000" stroke="#000000" points="288.52,-1995.95 297.28,-1989.99 286.716,-1989.19 288.52,-1995.95"/>
</g>
<!-- kpoint_nullify -->
<g id="proc~~siesta_forces~~CallsGraph_node73" class="node"><title>kpoint_nullify</title>
<polygon fill="#777777" stroke="#777777" points="369,-1951 295,-1951 295,-1927 369,-1927 369,-1951"/>
<text text-anchor="middle" x="332" y="-1936.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">kpoint_nullify</text>
</g>
<!-- proc~state_init&#45;&gt;kpoint_nullify -->
<g id="proc~~siesta_forces~~CallsGraph_edge84" class="edge"><title>proc~state_init&#45;&gt;kpoint_nullify</title>
<path fill="none" stroke="#000000" d="M188.97,-2010.98C207.263,-1997.21 239.024,-1974.66 269,-1960 274.232,-1957.44 279.854,-1955.07 285.5,-1952.9"/>
<polygon fill="#000000" stroke="#000000" points="286.756,-1956.17 294.961,-1949.47 284.367,-1949.59 286.756,-1956.17"/>
</g>
<!-- hsparse -->
<g id="proc~~siesta_forces~~CallsGraph_node75" class="node"><title>hsparse</title>
<polygon fill="#777777" stroke="#777777" points="359,-1909 305,-1909 305,-1885 359,-1885 359,-1909"/>
<text text-anchor="middle" x="332" y="-1894.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hsparse</text>
</g>
<!-- proc~state_init&#45;&gt;hsparse -->
<g id="proc~~siesta_forces~~CallsGraph_edge74" class="edge"><title>proc~state_init&#45;&gt;hsparse</title>
<path fill="none" stroke="#000000" d="M181.459,-2010.77C196.197,-1989.06 229.829,-1943.64 269,-1918 276.96,-1912.79 286.345,-1908.74 295.37,-1905.65"/>
<polygon fill="#000000" stroke="#000000" points="296.435,-1908.98 304.939,-1902.67 294.351,-1902.3 296.435,-1908.98"/>
</g>
<!-- outcoor -->
<g id="proc~~siesta_forces~~CallsGraph_node78" class="node"><title>outcoor</title>
<polygon fill="#777777" stroke="#777777" points="359,-1867 305,-1867 305,-1843 359,-1843 359,-1867"/>
<text text-anchor="middle" x="332" y="-1852.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">outcoor</text>
</g>
<!-- proc~state_init&#45;&gt;outcoor -->
<g id="proc~~siesta_forces~~CallsGraph_edge77" class="edge"><title>proc~state_init&#45;&gt;outcoor</title>
<path fill="none" stroke="#000000" d="M178.142,-2010.76C189.372,-1982.75 220.698,-1913.54 269,-1876 276.644,-1870.06 286.067,-1865.75 295.237,-1862.64"/>
<polygon fill="#000000" stroke="#000000" points="296.418,-1865.94 304.993,-1859.71 294.409,-1859.23 296.418,-1865.94"/>
</g>
<!-- cmlstartpropertylist -->
<g id="proc~~siesta_forces~~CallsGraph_node79" class="node"><title>cmlstartpropertylist</title>
<polygon fill="#777777" stroke="#777777" points="383.5,-1825 280.5,-1825 280.5,-1801 383.5,-1801 383.5,-1825"/>
<text text-anchor="middle" x="332" y="-1810.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cmlstartpropertylist</text>
</g>
<!-- proc~state_init&#45;&gt;cmlstartpropertylist -->
<g id="proc~~siesta_forces~~CallsGraph_edge88" class="edge"><title>proc~state_init&#45;&gt;cmlstartpropertylist</title>
<path fill="none" stroke="#000000" d="M176.222,-2010.84C184.298,-1977.56 211.247,-1884.12 269,-1834 270.513,-1832.69 272.111,-1831.46 273.776,-1830.3"/>
<polygon fill="#000000" stroke="#000000" points="275.718,-1833.22 282.568,-1825.14 272.173,-1827.18 275.718,-1833.22"/>
</g>
<!-- isc_off -->
<g id="proc~~siesta_forces~~CallsGraph_node80" class="node"><title>isc_off</title>
<polygon fill="#777777" stroke="#777777" points="359,-1783 305,-1783 305,-1759 359,-1759 359,-1783"/>
<text text-anchor="middle" x="332" y="-1768.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">isc_off</text>
</g>
<!-- proc~state_init&#45;&gt;isc_off -->
<g id="proc~~siesta_forces~~CallsGraph_edge91" class="edge"><title>proc~state_init&#45;&gt;isc_off</title>
<path fill="none" stroke="#000000" d="M174.968,-2010.99C180.224,-1973.14 201.536,-1855.19 269,-1792 276.264,-1785.2 285.814,-1780.59 295.236,-1777.47"/>
<polygon fill="#000000" stroke="#000000" points="296.238,-1780.83 304.907,-1774.74 294.332,-1774.09 296.238,-1780.83"/>
</g>
<!-- setup_dm_netcdf_file -->
<g id="proc~~siesta_forces~~CallsGraph_node82" class="node"><title>setup_dm_netcdf_file</title>
<polygon fill="#777777" stroke="#777777" points="389.5,-1741 274.5,-1741 274.5,-1717 389.5,-1717 389.5,-1741"/>
<text text-anchor="middle" x="332" y="-1726.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_dm_netcdf_file</text>
</g>
<!-- proc~state_init&#45;&gt;setup_dm_netcdf_file -->
<g id="proc~~siesta_forces~~CallsGraph_edge56" class="edge"><title>proc~state_init&#45;&gt;setup_dm_netcdf_file</title>
<path fill="none" stroke="#000000" d="M174.102,-2010.97C176.858,-1968.86 191.75,-1826.49 269,-1750 270.11,-1748.9 271.28,-1747.86 272.5,-1746.87"/>
<polygon fill="#000000" stroke="#000000" points="274.779,-1749.56 281.176,-1741.11 270.908,-1743.73 274.779,-1749.56"/>
</g>
<!-- nsc -->
<g id="proc~~siesta_forces~~CallsGraph_node83" class="node"><title>nsc</title>
<polygon fill="#777777" stroke="#777777" points="359,-1699 305,-1699 305,-1675 359,-1675 359,-1699"/>
<text text-anchor="middle" x="332" y="-1684.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nsc</text>
</g>
<!-- proc~state_init&#45;&gt;nsc -->
<g id="proc~~siesta_forces~~CallsGraph_edge34" class="edge"><title>proc~state_init&#45;&gt;nsc</title>
<path fill="none" stroke="#000000" d="M173.452,-2010.8C173.946,-1964.51 181.943,-1797.91 269,-1708 275.982,-1700.79 285.526,-1696.05 295.033,-1692.95"/>
<polygon fill="#000000" stroke="#000000" points="296.102,-1696.28 304.819,-1690.26 294.249,-1689.53 296.102,-1696.28"/>
</g>
<!-- proc~mixers_history_init -->
<g id="proc~~siesta_forces~~CallsGraph_node84" class="node"><title>proc~mixers_history_init</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node84"><a xlink:href=".././proc/mixers_history_init.html" xlink:title="mixers_history_init">
<polygon fill="#d9534f" stroke="#d9534f" points="382.5,-631 281.5,-631 281.5,-607 382.5,-607 382.5,-631"/>
<text text-anchor="middle" x="332" y="-616.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mixers_history_init</text>
</a>
</g>
</g>
<!-- proc~state_init&#45;&gt;proc~mixers_history_init -->
<g id="proc~~siesta_forces~~CallsGraph_edge35" class="edge"><title>proc~state_init&#45;&gt;proc~mixers_history_init</title>
<path fill="none" stroke="#000000" d="M173.608,-2010.69C174.751,-1893.9 186.283,-979.5 269,-721 278.858,-690.191 299.745,-659.031 314.546,-639.403"/>
<polygon fill="#000000" stroke="#000000" points="317.511,-641.291 320.857,-631.238 311.972,-637.01 317.511,-641.291"/>
</g>
<!-- chess_init -->
<g id="proc~~siesta_forces~~CallsGraph_node86" class="node"><title>chess_init</title>
<polygon fill="#777777" stroke="#777777" points="362,-1577 302,-1577 302,-1553 362,-1553 362,-1577"/>
<text text-anchor="middle" x="332" y="-1562.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">chess_init</text>
</g>
<!-- proc~state_init&#45;&gt;chess_init -->
<g id="proc~~siesta_forces~~CallsGraph_edge89" class="edge"><title>proc~state_init&#45;&gt;chess_init</title>
<path fill="none" stroke="#000000" d="M174.559,-2010.83C180.338,-1947.07 209.982,-1651.99 269,-1586 275.11,-1579.17 283.523,-1574.56 292.183,-1571.44"/>
<polygon fill="#000000" stroke="#000000" points="293.372,-1574.74 301.954,-1568.53 291.371,-1568.03 293.372,-1574.74"/>
</g>
<!-- iotdxv -->
<g id="proc~~siesta_forces~~CallsGraph_node87" class="node"><title>iotdxv</title>
<polygon fill="#777777" stroke="#777777" points="359,-1535 305,-1535 305,-1511 359,-1511 359,-1535"/>
<text text-anchor="middle" x="332" y="-1520.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iotdxv</text>
</g>
<!-- proc~state_init&#45;&gt;iotdxv -->
<g id="proc~~siesta_forces~~CallsGraph_edge37" class="edge"><title>proc~state_init&#45;&gt;iotdxv</title>
<path fill="none" stroke="#000000" d="M174.325,-2010.57C179.07,-1942.68 204.942,-1616.96 269,-1544 275.678,-1536.39 285.213,-1531.54 294.81,-1528.44"/>
<polygon fill="#000000" stroke="#000000" points="295.951,-1531.76 304.716,-1525.81 294.152,-1524.99 295.951,-1531.76"/>
</g>
<!-- file_exist -->
<g id="proc~~siesta_forces~~CallsGraph_node88" class="node"><title>file_exist</title>
<polygon fill="#777777" stroke="#777777" points="359,-1493 305,-1493 305,-1469 359,-1469 359,-1493"/>
<text text-anchor="middle" x="332" y="-1478.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">file_exist</text>
</g>
<!-- proc~state_init&#45;&gt;file_exist -->
<g id="proc~~siesta_forces~~CallsGraph_edge44" class="edge"><title>proc~state_init&#45;&gt;file_exist</title>
<path fill="none" stroke="#000000" d="M174.091,-2010.91C177.771,-1940.35 199.696,-1582.18 269,-1502 275.744,-1494.2 285.498,-1489.29 295.28,-1486.2"/>
<polygon fill="#000000" stroke="#000000" points="296.165,-1489.59 304.961,-1483.68 294.402,-1482.81 296.165,-1489.59"/>
</g>
<!-- val -->
<g id="proc~~siesta_forces~~CallsGraph_node89" class="node"><title>val</title>
<polygon fill="#777777" stroke="#777777" points="359,-4023 305,-4023 305,-3999 359,-3999 359,-4023"/>
<text text-anchor="middle" x="332" y="-4008.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">val</text>
</g>
<!-- proc~state_init&#45;&gt;val -->
<g id="proc~~siesta_forces~~CallsGraph_edge76" class="edge"><title>proc~state_init&#45;&gt;val</title>
<path fill="none" stroke="#000000" d="M173.903,-2035.29C179.299,-2199.18 237.597,-3948.38 269,-3990 275.263,-3998.3 284.969,-4003.35 294.858,-4006.41"/>
<polygon fill="#000000" stroke="#000000" points="294.136,-4009.84 304.686,-4008.86 295.827,-4003.05 294.136,-4009.84"/>
</g>
<!-- attach -->
<g id="proc~~siesta_forces~~CallsGraph_node91" class="node"><title>attach</title>
<polygon fill="#777777" stroke="#777777" points="359,-1451 305,-1451 305,-1427 359,-1427 359,-1451"/>
<text text-anchor="middle" x="332" y="-1436.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">attach</text>
</g>
<!-- proc~state_init&#45;&gt;attach -->
<g id="proc~~siesta_forces~~CallsGraph_edge51" class="edge"><title>proc~state_init&#45;&gt;attach</title>
<path fill="none" stroke="#000000" d="M173.911,-2010.92C176.652,-1937.11 194.538,-1547.31 269,-1460 275.692,-1452.15 285.431,-1447.23 295.215,-1444.14"/>
<polygon fill="#000000" stroke="#000000" points="296.103,-1447.53 304.904,-1441.63 294.345,-1440.75 296.103,-1447.53"/>
</g>
<!-- sp_to_spglobal -->
<g id="proc~~siesta_forces~~CallsGraph_node92" class="node"><title>sp_to_spglobal</title>
<polygon fill="#777777" stroke="#777777" points="374.5,-1409 289.5,-1409 289.5,-1385 374.5,-1385 374.5,-1409"/>
<text text-anchor="middle" x="332" y="-1394.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sp_to_spglobal</text>
</g>
<!-- proc~state_init&#45;&gt;sp_to_spglobal -->
<g id="proc~~siesta_forces~~CallsGraph_edge54" class="edge"><title>proc~state_init&#45;&gt;sp_to_spglobal</title>
<path fill="none" stroke="#000000" d="M173.764,-2010.53C175.661,-1932.56 189.5,-1512.31 269,-1418 272.175,-1414.23 276.052,-1411.14 280.302,-1408.6"/>
<polygon fill="#000000" stroke="#000000" points="282.002,-1411.67 289.446,-1404.13 278.925,-1405.38 282.002,-1411.67"/>
</g>
<!-- init_val -->
<g id="proc~~siesta_forces~~CallsGraph_node94" class="node"><title>init_val</title>
<polygon fill="#777777" stroke="#777777" points="359,-1367 305,-1367 305,-1343 359,-1343 359,-1367"/>
<text text-anchor="middle" x="332" y="-1352.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_val</text>
</g>
<!-- proc~state_init&#45;&gt;init_val -->
<g id="proc~~siesta_forces~~CallsGraph_edge61" class="edge"><title>proc~state_init&#45;&gt;init_val</title>
<path fill="none" stroke="#000000" d="M173.619,-2010.99C174.641,-1931.19 184.161,-1477.67 269,-1376 275.608,-1368.08 285.322,-1363.14 295.109,-1360.06"/>
<polygon fill="#000000" stroke="#000000" points="296.001,-1363.44 304.81,-1357.55 294.252,-1356.66 296.001,-1363.44"/>
</g>
<!-- dict_repopulate_md -->
<g id="proc~~siesta_forces~~CallsGraph_node95" class="node"><title>dict_repopulate_md</title>
<polygon fill="#777777" stroke="#777777" points="385.5,-1287 278.5,-1287 278.5,-1263 385.5,-1263 385.5,-1287"/>
<text text-anchor="middle" x="332" y="-1272.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dict_repopulate_md</text>
</g>
<!-- proc~state_init&#45;&gt;dict_repopulate_md -->
<g id="proc~~siesta_forces~~CallsGraph_edge64" class="edge"><title>proc~state_init&#45;&gt;dict_repopulate_md</title>
<path fill="none" stroke="#000000" d="M173.503,-2010.8C173.757,-1925.52 179.069,-1418.66 269,-1301 271.442,-1297.81 274.35,-1295 277.554,-1292.54"/>
<polygon fill="#000000" stroke="#000000" points="279.509,-1295.44 286.031,-1287.09 275.725,-1289.55 279.509,-1295.44"/>
</g>
<!-- kpoint_delete -->
<g id="proc~~siesta_forces~~CallsGraph_node97" class="node"><title>kpoint_delete</title>
<polygon fill="#777777" stroke="#777777" points="370,-1245 294,-1245 294,-1221 370,-1221 370,-1245"/>
<text text-anchor="middle" x="332" y="-1230.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">kpoint_delete</text>
</g>
<!-- proc~state_init&#45;&gt;kpoint_delete -->
<g id="proc~~siesta_forces~~CallsGraph_edge70" class="edge"><title>proc~state_init&#45;&gt;kpoint_delete</title>
<path fill="none" stroke="#000000" d="M173.306,-2010.8C172.14,-1922.11 169.126,-1376.53 269,-1254 273.099,-1248.97 278.454,-1245.14 284.3,-1242.22"/>
<polygon fill="#000000" stroke="#000000" points="285.847,-1245.37 293.782,-1238.35 283.201,-1238.89 285.847,-1245.37"/>
</g>
<!-- get_chess_parameter -->
<g id="proc~~siesta_forces~~CallsGraph_node98" class="node"><title>get_chess_parameter</title>
<polygon fill="#777777" stroke="#777777" points="390.5,-1203 273.5,-1203 273.5,-1179 390.5,-1179 390.5,-1203"/>
<text text-anchor="middle" x="332" y="-1188.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_chess_parameter</text>
</g>
<!-- proc~state_init&#45;&gt;get_chess_parameter -->
<g id="proc~~siesta_forces~~CallsGraph_edge72" class="edge"><title>proc~state_init&#45;&gt;get_chess_parameter</title>
<path fill="none" stroke="#000000" d="M174.16,-2010.73C179.458,-1914.08 216.246,-1277.14 269,-1212 269.715,-1211.12 270.469,-1210.27 271.258,-1209.46"/>
<polygon fill="#000000" stroke="#000000" points="273.588,-1212.08 279.178,-1203.08 269.196,-1206.63 273.588,-1212.08"/>
</g>
<!-- ts_tri_analyze -->
<g id="proc~~siesta_forces~~CallsGraph_node101" class="node"><title>ts_tri_analyze</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-1161 292.5,-1161 292.5,-1137 371.5,-1137 371.5,-1161"/>
<text text-anchor="middle" x="332" y="-1146.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ts_tri_analyze</text>
</g>
<!-- proc~state_init&#45;&gt;ts_tri_analyze -->
<g id="proc~~siesta_forces~~CallsGraph_edge49" class="edge"><title>proc~state_init&#45;&gt;ts_tri_analyze</title>
<path fill="none" stroke="#000000" d="M174.085,-2010.74C178.931,-1911.29 213.63,-1238.77 269,-1170 272.79,-1165.29 277.68,-1161.64 283.05,-1158.79"/>
<polygon fill="#000000" stroke="#000000" points="284.638,-1161.92 292.43,-1154.74 281.862,-1155.49 284.638,-1161.92"/>
</g>
<!-- ucell -->
<g id="proc~~siesta_forces~~CallsGraph_node103" class="node"><title>ucell</title>
<polygon fill="#777777" stroke="#777777" points="359,-1119 305,-1119 305,-1095 359,-1095 359,-1119"/>
<text text-anchor="middle" x="332" y="-1104.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ucell</text>
</g>
<!-- proc~state_init&#45;&gt;ucell -->
<g id="proc~~siesta_forces~~CallsGraph_edge57" class="edge"><title>proc~state_init&#45;&gt;ucell</title>
<path fill="none" stroke="#000000" d="M174.015,-2010.79C178.422,-1908.79 211.002,-1200.42 269,-1128 275.5,-1119.88 285.274,-1114.89 295.151,-1111.82"/>
<polygon fill="#000000" stroke="#000000" points="296.107,-1115.18 304.946,-1109.34 294.393,-1108.4 296.107,-1115.18"/>
</g>
<!-- nscold -->
<g id="proc~~siesta_forces~~CallsGraph_node105" class="node"><title>nscold</title>
<polygon fill="#777777" stroke="#777777" points="359,-1077 305,-1077 305,-1053 359,-1053 359,-1077"/>
<text text-anchor="middle" x="332" y="-1062.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nscold</text>
</g>
<!-- proc~state_init&#45;&gt;nscold -->
<g id="proc~~siesta_forces~~CallsGraph_edge90" class="edge"><title>proc~state_init&#45;&gt;nscold</title>
<path fill="none" stroke="#000000" d="M173.951,-2010.88C177.93,-1906.57 208.363,-1162.08 269,-1086 275.481,-1077.87 285.25,-1072.87 295.128,-1069.8"/>
<polygon fill="#000000" stroke="#000000" points="296.084,-1073.16 304.925,-1067.33 294.372,-1066.38 296.084,-1073.16"/>
</g>
<!-- delete -->
<g id="proc~~siesta_forces~~CallsGraph_node106" class="node"><title>delete</title>
<polygon fill="#777777" stroke="#777777" points="533.5,-673 479.5,-673 479.5,-649 533.5,-649 533.5,-673"/>
<text text-anchor="middle" x="506.5" y="-658.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">delete</text>
</g>
<!-- proc~state_init&#45;&gt;delete -->
<g id="proc~~siesta_forces~~CallsGraph_edge93" class="edge"><title>proc~state_init&#45;&gt;delete</title>
<path fill="none" stroke="#000000" d="M173.75,-2010.82C176.325,-1889.52 199.394,-900.311 269,-792 315.248,-720.035 415.514,-684.141 469.443,-669.434"/>
<polygon fill="#000000" stroke="#000000" points="470.485,-672.779 479.266,-666.85 468.705,-666.009 470.485,-672.779"/>
</g>
<!-- escf -->
<g id="proc~~siesta_forces~~CallsGraph_node109" class="node"><title>escf</title>
<polygon fill="#777777" stroke="#777777" points="359,-3771 305,-3771 305,-3747 359,-3747 359,-3771"/>
<text text-anchor="middle" x="332" y="-3756.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">escf</text>
</g>
<!-- proc~state_init&#45;&gt;escf -->
<g id="proc~~siesta_forces~~CallsGraph_edge31" class="edge"><title>proc~state_init&#45;&gt;escf</title>
<path fill="none" stroke="#000000" d="M173.649,-2035.16C175.474,-2178.29 194.732,-3539.56 269,-3700 276.527,-3716.26 290.719,-3730.29 303.628,-3740.59"/>
<polygon fill="#000000" stroke="#000000" points="301.755,-3743.56 311.842,-3746.8 305.977,-3737.98 301.755,-3743.56"/>
</g>
<!-- time_io -->
<g id="proc~~siesta_forces~~CallsGraph_node111" class="node"><title>time_io</title>
<polygon fill="#777777" stroke="#777777" points="359,-1035 305,-1035 305,-1011 359,-1011 359,-1035"/>
<text text-anchor="middle" x="332" y="-1020.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">time_io</text>
</g>
<!-- proc~state_init&#45;&gt;time_io -->
<g id="proc~~siesta_forces~~CallsGraph_edge39" class="edge"><title>proc~state_init&#45;&gt;time_io</title>
<path fill="none" stroke="#000000" d="M173.902,-2010.68C177.517,-1903 205.778,-1123.68 269,-1044 275.463,-1035.85 285.227,-1030.85 295.106,-1027.78"/>
<polygon fill="#000000" stroke="#000000" points="296.063,-1031.15 304.905,-1025.31 294.353,-1024.36 296.063,-1031.15"/>
</g>
<!-- proc~check_cohp -->
<g id="proc~~siesta_forces~~CallsGraph_node112" class="node"><title>proc~check_cohp</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node112"><a xlink:href=".././proc/check_cohp.html" xlink:title="check_cohp">
<polygon fill="#d9534f" stroke="#d9534f" points="367,-1619 297,-1619 297,-1595 367,-1595 367,-1619"/>
<text text-anchor="middle" x="332" y="-1604.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_cohp</text>
</a>
</g>
</g>
<!-- proc~state_init&#45;&gt;proc~check_cohp -->
<g id="proc~~siesta_forces~~CallsGraph_edge43" class="edge"><title>proc~state_init&#45;&gt;proc~check_cohp</title>
<path fill="none" stroke="#000000" d="M175.019,-2010.66C182.58,-1950.99 217.838,-1692.89 269,-1633 273.951,-1627.2 280.412,-1622.67 287.289,-1619.14"/>
<polygon fill="#000000" stroke="#000000" points="289.1,-1622.16 296.823,-1614.91 286.263,-1615.76 289.1,-1622.16"/>
</g>
<!-- listhptr -->
<g id="proc~~siesta_forces~~CallsGraph_node114" class="node"><title>listhptr</title>
<polygon fill="#777777" stroke="#777777" points="359,-993 305,-993 305,-969 359,-969 359,-993"/>
<text text-anchor="middle" x="332" y="-978.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">listhptr</text>
</g>
<!-- proc~state_init&#45;&gt;listhptr -->
<g id="proc~~siesta_forces~~CallsGraph_edge45" class="edge"><title>proc~state_init&#45;&gt;listhptr</title>
<path fill="none" stroke="#000000" d="M173.845,-2010.85C177.058,-1901.28 203.118,-1085.37 269,-1002 275.447,-993.841 285.206,-988.832 295.086,-985.763"/>
<polygon fill="#000000" stroke="#000000" points="296.044,-989.131 304.888,-983.296 294.336,-982.343 296.044,-989.131"/>
</g>
<!-- xij_offset -->
<g id="proc~~siesta_forces~~CallsGraph_node115" class="node"><title>xij_offset</title>
<polygon fill="#777777" stroke="#777777" points="359.5,-951 304.5,-951 304.5,-927 359.5,-927 359.5,-951"/>
<text text-anchor="middle" x="332" y="-936.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xij_offset</text>
</g>
<!-- proc~state_init&#45;&gt;xij_offset -->
<g id="proc~~siesta_forces~~CallsGraph_edge80" class="edge"><title>proc~state_init&#45;&gt;xij_offset</title>
<path fill="none" stroke="#000000" d="M173.802,-2010.71C176.667,-1898.06 200.518,-1046.99 269,-960 275.261,-952.047 284.669,-947.086 294.278,-943.998"/>
<polygon fill="#000000" stroke="#000000" points="295.441,-947.312 304.24,-941.411 293.681,-940.537 295.441,-947.312"/>
</g>
<!-- setup_kpoint_scf -->
<g id="proc~~siesta_forces~~CallsGraph_node116" class="node"><title>setup_kpoint_scf</title>
<polygon fill="#777777" stroke="#777777" points="378.5,-909 285.5,-909 285.5,-885 378.5,-885 378.5,-909"/>
<text text-anchor="middle" x="332" y="-894.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_kpoint_scf</text>
</g>
<!-- proc~state_init&#45;&gt;setup_kpoint_scf -->
<g id="proc~~siesta_forces~~CallsGraph_edge47" class="edge"><title>proc~state_init&#45;&gt;setup_kpoint_scf</title>
<path fill="none" stroke="#000000" d="M173.752,-2010.95C176.241,-1896.84 197.838,-1008.71 269,-918 271.206,-915.188 273.806,-912.749 276.67,-910.636"/>
<polygon fill="#000000" stroke="#000000" points="278.517,-913.61 285.331,-905.497 274.945,-907.59 278.517,-913.61"/>
</g>
<!-- ts_sparse_init -->
<g id="proc~~siesta_forces~~CallsGraph_node119" class="node"><title>ts_sparse_init</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-867 292.5,-867 292.5,-843 371.5,-843 371.5,-867"/>
<text text-anchor="middle" x="332" y="-852.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ts_sparse_init</text>
</g>
<!-- proc~state_init&#45;&gt;ts_sparse_init -->
<g id="proc~~siesta_forces~~CallsGraph_edge55" class="edge"><title>proc~state_init&#45;&gt;ts_sparse_init</title>
<path fill="none" stroke="#000000" d="M173.714,-2010.86C175.873,-1893.98 195.224,-970.347 269,-876 272.722,-871.24 277.573,-867.551 282.923,-864.694"/>
<polygon fill="#000000" stroke="#000000" points="284.507,-867.822 292.286,-860.629 281.72,-861.401 284.507,-867.822"/>
</g>
<!-- normalize_dm -->
<g id="proc~~siesta_forces~~CallsGraph_node120" class="node"><title>normalize_dm</title>
<polygon fill="#777777" stroke="#777777" points="372,-3897 292,-3897 292,-3873 372,-3873 372,-3897"/>
<text text-anchor="middle" x="332" y="-3882.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">normalize_dm</text>
</g>
<!-- proc~state_init&#45;&gt;normalize_dm -->
<g id="proc~~siesta_forces~~CallsGraph_edge71" class="edge"><title>proc~state_init&#45;&gt;normalize_dm</title>
<path fill="none" stroke="#000000" d="M173.74,-2035.18C176.856,-2190.81 210.2,-3786.33 269,-3864 272.604,-3868.76 277.339,-3872.45 282.59,-3875.31"/>
<polygon fill="#000000" stroke="#000000" points="281.243,-3878.54 291.804,-3879.38 284.071,-3872.14 281.243,-3878.54"/>
</g>
<!-- globalize_sum -->
<g id="proc~~siesta_forces~~CallsGraph_node122" class="node"><title>globalize_sum</title>
<polygon fill="#777777" stroke="#777777" points="372.5,-3161 291.5,-3161 291.5,-3137 372.5,-3137 372.5,-3161"/>
<text text-anchor="middle" x="332" y="-3146.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">globalize_sum</text>
</g>
<!-- proc~state_init&#45;&gt;globalize_sum -->
<g id="proc~~siesta_forces~~CallsGraph_edge62" class="edge"><title>proc~state_init&#45;&gt;globalize_sum</title>
<path fill="none" stroke="#000000" d="M173.752,-2035.05C176.241,-2149.16 197.838,-3037.29 269,-3128 272.507,-3132.47 277.01,-3136 281.985,-3138.78"/>
<polygon fill="#000000" stroke="#000000" points="280.784,-3142.07 291.337,-3143.01 283.673,-3135.7 280.784,-3142.07"/>
</g>
<!-- ts_write_tshs -->
<g id="proc~~siesta_forces~~CallsGraph_node124" class="node"><title>ts_write_tshs</title>
<polygon fill="#777777" stroke="#777777" points="369.5,-825 294.5,-825 294.5,-801 369.5,-801 369.5,-825"/>
<text text-anchor="middle" x="332" y="-810.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ts_write_tshs</text>
</g>
<!-- proc~state_init&#45;&gt;ts_write_tshs -->
<g id="proc~~siesta_forces~~CallsGraph_edge65" class="edge"><title>proc~state_init&#45;&gt;ts_write_tshs</title>
<path fill="none" stroke="#000000" d="M173.677,-2010.8C175.515,-1891.27 192.604,-931.993 269,-834 273.081,-828.765 278.527,-824.826 284.503,-821.864"/>
<polygon fill="#000000" stroke="#000000" points="286.234,-824.94 294.21,-817.967 283.626,-818.444 286.234,-824.94"/>
</g>
<!-- newdspdata2d -->
<g id="proc~~siesta_forces~~CallsGraph_node125" class="node"><title>newdspdata2d</title>
<polygon fill="#777777" stroke="#777777" points="373,-3001 291,-3001 291,-2977 373,-2977 373,-3001"/>
<text text-anchor="middle" x="332" y="-2986.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">newdspdata2d</text>
</g>
<!-- proc~state_init&#45;&gt;newdspdata2d -->
<g id="proc~~siesta_forces~~CallsGraph_edge66" class="edge"><title>proc~state_init&#45;&gt;newdspdata2d</title>
<path fill="none" stroke="#000000" d="M174.922,-2035.34C181.736,-2094.63 211.608,-2356.26 233,-2571 241.781,-2659.15 214.176,-2898.42 269,-2968 272.429,-2972.35 276.8,-2975.81 281.63,-2978.55"/>
<polygon fill="#000000" stroke="#000000" points="280.172,-2981.73 290.717,-2982.76 283.114,-2975.38 280.172,-2981.73"/>
</g>
<!-- madelung -->
<g id="proc~~siesta_forces~~CallsGraph_node126" class="node"><title>madelung</title>
<polygon fill="#777777" stroke="#777777" points="362,-2959 302,-2959 302,-2935 362,-2935 362,-2959"/>
<text text-anchor="middle" x="332" y="-2944.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">madelung</text>
</g>
<!-- proc~state_init&#45;&gt;madelung -->
<g id="proc~~siesta_forces~~CallsGraph_edge69" class="edge"><title>proc~state_init&#45;&gt;madelung</title>
<path fill="none" stroke="#000000" d="M174.873,-2035.34C181.464,-2094.66 210.467,-2356.38 233,-2571 241.28,-2649.86 219.596,-2863.98 269,-2926 274.824,-2933.31 283.306,-2938.09 292.136,-2941.21"/>
<polygon fill="#000000" stroke="#000000" points="291.167,-2944.58 301.745,-2943.99 293.111,-2937.85 291.167,-2944.58"/>
</g>
<!-- numh -->
<g id="proc~~siesta_forces~~CallsGraph_node128" class="node"><title>numh</title>
<polygon fill="#777777" stroke="#777777" points="359,-2917 305,-2917 305,-2893 359,-2893 359,-2917"/>
<text text-anchor="middle" x="332" y="-2902.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">numh</text>
</g>
<!-- proc~state_init&#45;&gt;numh -->
<g id="proc~~siesta_forces~~CallsGraph_edge73" class="edge"><title>proc~state_init&#45;&gt;numh</title>
<path fill="none" stroke="#000000" d="M174.824,-2035.14C186.211,-2139.52 267.247,-2881.82 269,-2884 275.517,-2892.1 285.296,-2897.1 295.172,-2900.17"/>
<polygon fill="#000000" stroke="#000000" points="294.411,-2903.59 304.964,-2902.64 296.127,-2896.8 294.411,-2903.59"/>
</g>
<!-- write_zmatrix -->
<g id="proc~~siesta_forces~~CallsGraph_node130" class="node"><title>write_zmatrix</title>
<polygon fill="#777777" stroke="#777777" points="370,-2875 294,-2875 294,-2851 370,-2851 370,-2875"/>
<text text-anchor="middle" x="332" y="-2860.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_zmatrix</text>
</g>
<!-- proc~state_init&#45;&gt;write_zmatrix -->
<g id="proc~~siesta_forces~~CallsGraph_edge85" class="edge"><title>proc~state_init&#45;&gt;write_zmatrix</title>
<path fill="none" stroke="#000000" d="M174.819,-2035.08C185.838,-2135.9 262.318,-2833.74 269,-2842 273.081,-2847.04 278.425,-2850.88 284.266,-2853.8"/>
<polygon fill="#000000" stroke="#000000" points="283.164,-2857.13 293.745,-2857.68 285.812,-2850.65 283.164,-2857.13"/>
</g>
<!-- fname_tshs -->
<g id="proc~~siesta_forces~~CallsGraph_node132" class="node"><title>fname_tshs</title>
<polygon fill="#777777" stroke="#777777" points="366,-2833 298,-2833 298,-2809 366,-2809 366,-2833"/>
<text text-anchor="middle" x="332" y="-2818.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fname_tshs</text>
</g>
<!-- proc~state_init&#45;&gt;fname_tshs -->
<g id="proc~~siesta_forces~~CallsGraph_edge68" class="edge"><title>proc~state_init&#45;&gt;fname_tshs</title>
<path fill="none" stroke="#000000" d="M174.823,-2035.25C185.413,-2133.11 256.304,-2784.4 269,-2800 274.045,-2806.2 280.995,-2810.57 288.424,-2813.66"/>
<polygon fill="#000000" stroke="#000000" points="287.389,-2817.01 297.983,-2816.93 289.651,-2810.38 287.389,-2817.01"/>
</g>
<!-- proc~mixers_scf_history_init&#45;&gt;proc~mixers_history_init -->
<g id="proc~~siesta_forces~~CallsGraph_edge94" class="edge"><title>proc~mixers_scf_history_init&#45;&gt;proc~mixers_history_init</title>
<path fill="none" stroke="#000000" d="M233.044,-630.817C245.498,-629.314 258.635,-627.73 271.102,-626.226"/>
<polygon fill="#000000" stroke="#000000" points="271.878,-629.658 281.387,-624.985 271.04,-622.708 271.878,-629.658"/>
</g>
<!-- proc~compute_max_diff_2d -->
<g id="proc~~siesta_forces~~CallsGraph_node58" class="node"><title>proc~compute_max_diff_2d</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node58"><a xlink:href=".././proc/compute_max_diff_2d.html" xlink:title="compute_max_diff_2d">
<polygon fill="#d9534f" stroke="#d9534f" points="736,-1546 618,-1546 618,-1522 736,-1522 736,-1546"/>
<text text-anchor="middle" x="677" y="-1531.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_max_diff_2d</text>
</a>
</g>
</g>
<!-- interface~compute_max_diff&#45;&gt;proc~compute_max_diff_2d -->
<g id="proc~~siesta_forces~~CallsGraph_edge96" class="edge"><title>interface~compute_max_diff&#45;&gt;proc~compute_max_diff_2d</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M556.66,-1428.99C565.427,-1431.84 574.232,-1435.45 582,-1440 582.07,-1440.04 629.023,-1487.01 656.534,-1514.53"/>
<polygon fill="#000000" stroke="#000000" points="654.178,-1517.12 663.723,-1521.72 659.129,-1512.17 654.178,-1517.12"/>
</g>
<!-- proc~compute_max_diff_1d -->
<g id="proc~~siesta_forces~~CallsGraph_node93" class="node"><title>proc~compute_max_diff_1d</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node93"><a xlink:href=".././proc/compute_max_diff_1d.html" xlink:title="compute_max_diff_1d">
<polygon fill="#d9534f" stroke="#d9534f" points="736,-1467 618,-1467 618,-1443 736,-1443 736,-1467"/>
<text text-anchor="middle" x="677" y="-1452.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_max_diff_1d</text>
</a>
</g>
</g>
<!-- interface~compute_max_diff&#45;&gt;proc~compute_max_diff_1d -->
<g id="proc~~siesta_forces~~CallsGraph_edge95" class="edge"><title>interface~compute_max_diff&#45;&gt;proc~compute_max_diff_1d</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M556.69,-1429.51C573.174,-1433.03 591.838,-1437.02 609.425,-1440.78"/>
<polygon fill="#000000" stroke="#000000" points="609.121,-1444.29 619.631,-1442.96 610.583,-1437.44 609.121,-1444.29"/>
</g>
<!-- proc~mixing_scf_converged&#45;&gt;reset -->
<g id="proc~~siesta_forces~~CallsGraph_edge97" class="edge"><title>proc~mixing_scf_converged&#45;&gt;reset</title>
<path fill="none" stroke="#000000" d="M232.147,-355.447C253.155,-358.115 276.208,-361.042 294.763,-363.399"/>
<polygon fill="#000000" stroke="#000000" points="294.482,-366.891 304.843,-364.678 295.364,-359.947 294.482,-366.891"/>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;bye -->
<g id="proc~~siesta_forces~~CallsGraph_edge99" class="edge"><title>proc~setup_hamiltonian&#45;&gt;bye</title>
<path fill="none" stroke="#000000" d="M222.667,-3700.79C280.848,-3704.03 372.666,-3713.06 395,-3738 478.478,-3831.23 352.309,-4202.69 431,-4300 440.247,-4311.44 455.203,-4316.93 469.297,-4319.48"/>
<polygon fill="#000000" stroke="#000000" points="468.93,-4322.96 479.313,-4320.85 469.881,-4316.02 468.93,-4322.96"/>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;die -->
<g id="proc~~siesta_forces~~CallsGraph_edge108" class="edge"><title>proc~setup_hamiltonian&#45;&gt;die</title>
<path fill="none" stroke="#000000" d="M174.271,-3686.84C178.809,-3618.98 204.088,-3287.31 269,-3213 307.926,-3168.44 359.041,-3216.99 395,-3170 470.513,-3071.32 388.22,-2728.66 431,-2612 513.123,-2388.05 725.228,-2178.25 792.911,-2115.18"/>
<polygon fill="#000000" stroke="#000000" points="795.467,-2117.58 800.431,-2108.22 790.713,-2112.44 795.467,-2117.58"/>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;timer -->
<g id="proc~~siesta_forces~~CallsGraph_edge104" class="edge"><title>proc~setup_hamiltonian&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M177.411,-3686.86C189.038,-3651.43 225.316,-3545.51 269,-3464 315.99,-3376.32 360.855,-3372.44 395,-3279 421.761,-3205.77 373.11,-2982.23 431,-2930 531.65,-2839.2 607.457,-2886.97 736,-2930 768.199,-2940.78 836.997,-2995.32 858,-3022 887.515,-3059.49 905.787,-3113.19 914.3,-3142.97"/>
<polygon fill="#000000" stroke="#000000" points="910.973,-3144.07 916.998,-3152.79 917.723,-3142.22 910.973,-3144.07"/>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;re_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge107" class="edge"><title>proc~setup_hamiltonian&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M174.382,-3686.63C179.34,-3620.49 205.811,-3308.96 269,-3241 308.658,-3198.35 358.24,-3250.17 395,-3205 463.633,-3120.66 359.908,-2799.28 431,-2717 546.734,-2583.05 791.931,-2610.71 884.031,-2626.8"/>
<polygon fill="#000000" stroke="#000000" points="883.518,-2630.27 893.981,-2628.6 884.763,-2623.38 883.518,-2630.27"/>
</g>
<!-- h -->
<g id="proc~~siesta_forces~~CallsGraph_node52" class="node"><title>h</title>
<polygon fill="#777777" stroke="#777777" points="359,-3981 305,-3981 305,-3957 359,-3957 359,-3981"/>
<text text-anchor="middle" x="332" y="-3966.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">h</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;h -->
<g id="proc~~siesta_forces~~CallsGraph_edge102" class="edge"><title>proc~setup_hamiltonian&#45;&gt;h</title>
<path fill="none" stroke="#000000" d="M174.57,-3711.08C178.738,-3750.87 197.397,-3879.18 269,-3948 276.176,-3954.9 285.698,-3959.53 295.121,-3962.65"/>
<polygon fill="#000000" stroke="#000000" points="294.229,-3966.03 304.803,-3965.37 296.126,-3959.29 294.229,-3966.03"/>
</g>
<!-- proc~dhscf -->
<g id="proc~~siesta_forces~~CallsGraph_node62" class="node"><title>proc~dhscf</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node62"><a xlink:href=".././proc/dhscf.html" xlink:title="dhscf">
<polygon fill="#d9534f" stroke="#d9534f" points="359,-3497 305,-3497 305,-3473 359,-3473 359,-3497"/>
<text text-anchor="middle" x="332" y="-3482.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dhscf</text>
</a>
</g>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;proc~dhscf -->
<g id="proc~~siesta_forces~~CallsGraph_edge105" class="edge"><title>proc~setup_hamiltonian&#45;&gt;proc~dhscf</title>
<path fill="none" stroke="#000000" d="M182.419,-3686.88C208.293,-3651.73 283.586,-3549.42 315.938,-3505.46"/>
<polygon fill="#000000" stroke="#000000" points="318.875,-3507.38 321.983,-3497.25 313.237,-3503.23 318.875,-3507.38"/>
</g>
<!-- write_hsx -->
<g id="proc~~siesta_forces~~CallsGraph_node72" class="node"><title>write_hsx</title>
<polygon fill="#777777" stroke="#777777" points="361,-3939 303,-3939 303,-3915 361,-3915 361,-3939"/>
<text text-anchor="middle" x="332" y="-3924.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_hsx</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;write_hsx -->
<g id="proc~~siesta_forces~~CallsGraph_edge98" class="edge"><title>proc~setup_hamiltonian&#45;&gt;write_hsx</title>
<path fill="none" stroke="#000000" d="M175.608,-3711.01C182.413,-3746.24 207.061,-3850.28 269,-3906 275.814,-3912.13 284.488,-3916.48 293.174,-3919.57"/>
<polygon fill="#000000" stroke="#000000" points="292.3,-3922.96 302.887,-3922.54 294.349,-3916.27 292.3,-3922.96"/>
</g>
<!-- hubbard_term -->
<g id="proc~~siesta_forces~~CallsGraph_node74" class="node"><title>hubbard_term</title>
<polygon fill="#777777" stroke="#777777" points="372,-3855 292,-3855 292,-3831 372,-3831 372,-3855"/>
<text text-anchor="middle" x="332" y="-3840.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hubbard_term</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;hubbard_term -->
<g id="proc~~siesta_forces~~CallsGraph_edge112" class="edge"><title>proc~setup_hamiltonian&#45;&gt;hubbard_term</title>
<path fill="none" stroke="#000000" d="M179.665,-3711.04C192.784,-3735.5 225.83,-3791.27 269,-3822 273.175,-3824.97 277.803,-3827.55 282.595,-3829.78"/>
<polygon fill="#000000" stroke="#000000" points="281.357,-3833.05 291.935,-3833.64 284.035,-3826.58 281.357,-3833.05"/>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;val -->
<g id="proc~~siesta_forces~~CallsGraph_edge101" class="edge"><title>proc~setup_hamiltonian&#45;&gt;val</title>
<path fill="none" stroke="#000000" d="M173.808,-3711.19C175.585,-3755.23 187.612,-3907.84 269,-3990 276.064,-3997.13 285.633,-4001.84 295.138,-4004.95"/>
<polygon fill="#000000" stroke="#000000" points="294.342,-4008.36 304.913,-4007.65 296.204,-4001.62 294.342,-4008.36"/>
</g>
<!-- hold -->
<g id="proc~~siesta_forces~~CallsGraph_node99" class="node"><title>hold</title>
<polygon fill="#777777" stroke="#777777" points="359,-3813 305,-3813 305,-3789 359,-3789 359,-3813"/>
<text text-anchor="middle" x="332" y="-3798.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hold</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;hold -->
<g id="proc~~siesta_forces~~CallsGraph_edge111" class="edge"><title>proc~setup_hamiltonian&#45;&gt;hold</title>
<path fill="none" stroke="#000000" d="M184.748,-3711.08C201.565,-3728.51 234.943,-3760.73 269,-3780 277.048,-3784.55 286.245,-3788.34 295.046,-3791.37"/>
<polygon fill="#000000" stroke="#000000" points="294.141,-3794.76 304.733,-3794.49 296.286,-3788.1 294.141,-3794.76"/>
</g>
<!-- de_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_node102" class="node"><title>de_alloc</title>
<polygon fill="#777777" stroke="#777777" points="948,-2779 894,-2779 894,-2755 948,-2755 948,-2779"/>
<text text-anchor="middle" x="921" y="-2764.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">de_alloc</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;de_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge106" class="edge"><title>proc~setup_hamiltonian&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M174.63,-3686.86C180.66,-3624.54 210.974,-3341.19 269,-3279 308.901,-3236.23 358.206,-3286.47 395,-3241 455.876,-3165.77 373.691,-2884.98 431,-2807 513.728,-2694.43 596.561,-2722.46 736,-2731 790.528,-2734.34 804.74,-2733.84 858,-2746 866.6,-2747.96 875.686,-2750.67 884.171,-2753.48"/>
<polygon fill="#000000" stroke="#000000" points="883.197,-2756.85 893.791,-2756.8 885.478,-2750.23 883.197,-2756.85"/>
</g>
<!-- dimag -->
<g id="proc~~siesta_forces~~CallsGraph_node104" class="node"><title>dimag</title>
<polygon fill="#777777" stroke="#777777" points="359,-3691 305,-3691 305,-3667 359,-3667 359,-3691"/>
<text text-anchor="middle" x="332" y="-3676.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dimag</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;dimag -->
<g id="proc~~siesta_forces~~CallsGraph_edge103" class="edge"><title>proc~setup_hamiltonian&#45;&gt;dimag</title>
<path fill="none" stroke="#000000" d="M222.902,-3692.73C246.16,-3689.77 273.404,-3686.31 294.723,-3683.61"/>
<polygon fill="#000000" stroke="#000000" points="295.189,-3687.08 304.669,-3682.34 294.307,-3680.13 295.189,-3687.08"/>
</g>
<!-- update_e0 -->
<g id="proc~~siesta_forces~~CallsGraph_node113" class="node"><title>update_e0</title>
<polygon fill="#777777" stroke="#777777" points="364,-4065 300,-4065 300,-4041 364,-4041 364,-4065"/>
<text text-anchor="middle" x="332" y="-4050.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_e0</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;update_e0 -->
<g id="proc~~siesta_forces~~CallsGraph_edge110" class="edge"><title>proc~setup_hamiltonian&#45;&gt;update_e0</title>
<path fill="none" stroke="#000000" d="M173.217,-3711.22C172.786,-3759.14 177.678,-3936.25 269,-4032 274.744,-4038.02 282.274,-4042.32 290.1,-4045.38"/>
<polygon fill="#000000" stroke="#000000" points="289.098,-4048.74 299.691,-4048.54 291.288,-4042.09 289.098,-4048.74"/>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;globalize_sum -->
<g id="proc~~siesta_forces~~CallsGraph_edge100" class="edge"><title>proc~setup_hamiltonian&#45;&gt;globalize_sum</title>
<path fill="none" stroke="#000000" d="M174.167,-3686.91C178.277,-3616.36 202.237,-3258.07 269,-3175 272.701,-3170.4 277.361,-3166.6 282.457,-3163.46"/>
<polygon fill="#000000" stroke="#000000" points="284.125,-3166.54 291.353,-3158.79 280.872,-3160.34 284.125,-3166.54"/>
</g>
<!-- dscf -->
<g id="proc~~siesta_forces~~CallsGraph_node127" class="node"><title>dscf</title>
<polygon fill="#777777" stroke="#777777" points="359,-4396 305,-4396 305,-4372 359,-4372 359,-4396"/>
<text text-anchor="middle" x="332" y="-4381.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dscf</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;dscf -->
<g id="proc~~siesta_forces~~CallsGraph_edge109" class="edge"><title>proc~setup_hamiltonian&#45;&gt;dscf</title>
<path fill="none" stroke="#000000" d="M176.301,-3711.18C194.955,-3792.31 301.241,-4254.57 325.894,-4361.79"/>
<polygon fill="#000000" stroke="#000000" points="322.545,-4362.85 328.197,-4371.81 329.367,-4361.28 322.545,-4362.85"/>
</g>
<!-- proc~compute_dm&#45;&gt;bye -->
<g id="proc~~siesta_forces~~CallsGraph_edge130" class="edge"><title>proc~compute_dm&#45;&gt;bye</title>
<path fill="none" stroke="#000000" d="M174.798,-5237.76C181.114,-5180.06 210.722,-4929.93 269,-4733 282.345,-4687.91 395.844,-4373.23 431,-4342 441.567,-4332.61 456.028,-4327.39 469.399,-4324.5"/>
<polygon fill="#000000" stroke="#000000" points="470.107,-4327.93 479.329,-4322.72 468.867,-4321.04 470.107,-4327.93"/>
</g>
<!-- proc~compute_dm&#45;&gt;transiesta -->
<g id="proc~~siesta_forces~~CallsGraph_edge120" class="edge"><title>proc~compute_dm&#45;&gt;transiesta</title>
<path fill="none" stroke="#000000" d="M177.175,-5262.1C187.025,-5294.77 214.525,-5387.63 233,-5466 252.02,-5546.68 214.39,-5586.64 269,-5649 275.213,-5656.09 283.913,-5660.8 292.835,-5663.91"/>
<polygon fill="#000000" stroke="#000000" points="291.916,-5667.29 302.495,-5666.71 293.862,-5660.57 291.916,-5667.29"/>
</g>
<!-- proc~compute_dm&#45;&gt;timer -->
<g id="proc~~siesta_forces~~CallsGraph_edge124" class="edge"><title>proc~compute_dm&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M176.966,-5237.93C186.19,-5208.38 214.436,-5132.62 269,-5103 318.216,-5076.28 351.839,-5067.32 395,-5103 460.569,-5157.2 365.431,-5236.8 431,-5291 577.269,-5411.92 721.865,-5423.22 858,-5291 897.785,-5252.36 917.512,-3412.7 919.779,-3187.51"/>
<polygon fill="#000000" stroke="#000000" points="923.281,-3187.28 919.881,-3177.25 916.281,-3187.21 923.281,-3187.28"/>
</g>
<!-- zminim -->
<g id="proc~~siesta_forces~~CallsGraph_node49" class="node"><title>zminim</title>
<polygon fill="#777777" stroke="#777777" points="359,-5472 305,-5472 305,-5448 359,-5448 359,-5472"/>
<text text-anchor="middle" x="332" y="-5457.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">zminim</text>
</g>
<!-- proc~compute_dm&#45;&gt;zminim -->
<g id="proc~~siesta_forces~~CallsGraph_edge115" class="edge"><title>proc~compute_dm&#45;&gt;zminim</title>
<path fill="none" stroke="#000000" d="M176.222,-5262.16C184.298,-5295.44 211.247,-5388.88 269,-5439 276.375,-5445.4 285.783,-5449.87 295.03,-5452.98"/>
<polygon fill="#000000" stroke="#000000" points="294.316,-5456.42 304.896,-5455.86 296.274,-5449.7 294.316,-5456.42"/>
</g>
<!-- dold -->
<g id="proc~~siesta_forces~~CallsGraph_node61" class="node"><title>dold</title>
<polygon fill="#777777" stroke="#777777" points="359,-5430 305,-5430 305,-5406 359,-5406 359,-5430"/>
<text text-anchor="middle" x="332" y="-5415.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dold</text>
</g>
<!-- proc~compute_dm&#45;&gt;dold -->
<g id="proc~~siesta_forces~~CallsGraph_edge125" class="edge"><title>proc~compute_dm&#45;&gt;dold</title>
<path fill="none" stroke="#000000" d="M178.142,-5262.24C189.372,-5290.25 220.698,-5359.46 269,-5397 276.644,-5402.94 286.067,-5407.25 295.237,-5410.36"/>
<polygon fill="#000000" stroke="#000000" points="294.409,-5413.77 304.993,-5413.29 296.418,-5407.06 294.409,-5413.77"/>
</g>
<!-- write_orb_indx -->
<g id="proc~~siesta_forces~~CallsGraph_node63" class="node"><title>write_orb_indx</title>
<polygon fill="#777777" stroke="#777777" points="373,-5388 291,-5388 291,-5364 373,-5364 373,-5388"/>
<text text-anchor="middle" x="332" y="-5373.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_orb_indx</text>
</g>
<!-- proc~compute_dm&#45;&gt;write_orb_indx -->
<g id="proc~~siesta_forces~~CallsGraph_edge127" class="edge"><title>proc~compute_dm&#45;&gt;write_orb_indx</title>
<path fill="none" stroke="#000000" d="M181.459,-5262.23C196.197,-5283.94 229.829,-5329.36 269,-5355 272.848,-5357.52 277.028,-5359.77 281.341,-5361.77"/>
<polygon fill="#000000" stroke="#000000" points="280.335,-5365.14 290.912,-5365.75 283.027,-5358.68 280.335,-5365.14"/>
</g>
<!-- eold -->
<g id="proc~~siesta_forces~~CallsGraph_node65" class="node"><title>eold</title>
<polygon fill="#777777" stroke="#777777" points="359,-5346 305,-5346 305,-5322 359,-5322 359,-5346"/>
<text text-anchor="middle" x="332" y="-5331.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">eold</text>
</g>
<!-- proc~compute_dm&#45;&gt;eold -->
<g id="proc~~siesta_forces~~CallsGraph_edge117" class="edge"><title>proc~compute_dm&#45;&gt;eold</title>
<path fill="none" stroke="#000000" d="M188.97,-5262.02C207.263,-5275.79 239.024,-5298.34 269,-5313 277.233,-5317.03 286.432,-5320.6 295.172,-5323.61"/>
<polygon fill="#000000" stroke="#000000" points="294.174,-5326.96 304.767,-5326.75 296.356,-5320.31 294.174,-5326.96"/>
</g>
<!-- dminim -->
<g id="proc~~siesta_forces~~CallsGraph_node76" class="node"><title>dminim</title>
<polygon fill="#777777" stroke="#777777" points="359,-5304 305,-5304 305,-5280 359,-5280 359,-5304"/>
<text text-anchor="middle" x="332" y="-5289.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dminim</text>
</g>
<!-- proc~compute_dm&#45;&gt;dminim -->
<g id="proc~~siesta_forces~~CallsGraph_edge131" class="edge"><title>proc~compute_dm&#45;&gt;dminim</title>
<path fill="none" stroke="#000000" d="M210.03,-5259.74C235.588,-5266.56 269.569,-5275.62 295.008,-5282.4"/>
<polygon fill="#000000" stroke="#000000" points="294.428,-5285.87 304.992,-5285.06 296.232,-5279.11 294.428,-5285.87"/>
</g>
<!-- diagon -->
<g id="proc~~siesta_forces~~CallsGraph_node85" class="node"><title>diagon</title>
<polygon fill="#777777" stroke="#777777" points="359,-5262 305,-5262 305,-5238 359,-5238 359,-5262"/>
<text text-anchor="middle" x="332" y="-5247.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">diagon</text>
</g>
<!-- proc~compute_dm&#45;&gt;diagon -->
<g id="proc~~siesta_forces~~CallsGraph_edge114" class="edge"><title>proc~compute_dm&#45;&gt;diagon</title>
<path fill="none" stroke="#000000" d="M210.03,-5250C235.474,-5250 269.268,-5250 294.669,-5250"/>
<polygon fill="#000000" stroke="#000000" points="294.992,-5253.5 304.992,-5250 294.992,-5246.5 294.992,-5253.5"/>
</g>
<!-- proc~compute_dm&#45;&gt;val -->
<g id="proc~~siesta_forces~~CallsGraph_edge118" class="edge"><title>proc~compute_dm&#45;&gt;val</title>
<path fill="none" stroke="#000000" d="M173.652,-5237.88C175.263,-5117.11 190.767,-4132.55 269,-4032 275.386,-4023.79 285.127,-4018.77 295.01,-4015.7"/>
<polygon fill="#000000" stroke="#000000" points="295.972,-4019.07 304.82,-4013.24 294.269,-4012.28 295.972,-4019.07"/>
</g>
<!-- write_dmh_netcdf -->
<g id="proc~~siesta_forces~~CallsGraph_node90" class="node"><title>write_dmh_netcdf</title>
<polygon fill="#777777" stroke="#777777" points="380.5,-5220 283.5,-5220 283.5,-5196 380.5,-5196 380.5,-5220"/>
<text text-anchor="middle" x="332" y="-5205.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_dmh_netcdf</text>
</g>
<!-- proc~compute_dm&#45;&gt;write_dmh_netcdf -->
<g id="proc~~siesta_forces~~CallsGraph_edge123" class="edge"><title>proc~compute_dm&#45;&gt;write_dmh_netcdf</title>
<path fill="none" stroke="#000000" d="M210.03,-5240.26C229.652,-5235.03 254.239,-5228.47 276.114,-5222.64"/>
<polygon fill="#000000" stroke="#000000" points="277.185,-5225.97 285.946,-5220.01 275.382,-5219.21 277.185,-5225.97"/>
</g>
<!-- pexsi_solver -->
<g id="proc~~siesta_forces~~CallsGraph_node96" class="node"><title>pexsi_solver</title>
<polygon fill="#777777" stroke="#777777" points="368,-5178 296,-5178 296,-5154 368,-5154 368,-5178"/>
<text text-anchor="middle" x="332" y="-5163.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pexsi_solver</text>
</g>
<!-- proc~compute_dm&#45;&gt;pexsi_solver -->
<g id="proc~~siesta_forces~~CallsGraph_edge116" class="edge"><title>proc~compute_dm&#45;&gt;pexsi_solver</title>
<path fill="none" stroke="#000000" d="M188.97,-5237.98C207.263,-5224.21 239.024,-5201.66 269,-5187 274.428,-5184.35 280.276,-5181.89 286.136,-5179.66"/>
<polygon fill="#000000" stroke="#000000" points="287.711,-5182.81 295.935,-5176.13 285.34,-5176.23 287.711,-5182.81"/>
</g>
<!-- ordern -->
<g id="proc~~siesta_forces~~CallsGraph_node107" class="node"><title>ordern</title>
<polygon fill="#777777" stroke="#777777" points="359,-5136 305,-5136 305,-5112 359,-5112 359,-5136"/>
<text text-anchor="middle" x="332" y="-5121.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ordern</text>
</g>
<!-- proc~compute_dm&#45;&gt;ordern -->
<g id="proc~~siesta_forces~~CallsGraph_edge113" class="edge"><title>proc~compute_dm&#45;&gt;ordern</title>
<path fill="none" stroke="#000000" d="M181.459,-5237.77C196.197,-5216.06 229.829,-5170.64 269,-5145 276.96,-5139.79 286.345,-5135.74 295.37,-5132.65"/>
<polygon fill="#000000" stroke="#000000" points="296.435,-5135.98 304.939,-5129.67 294.351,-5129.3 296.435,-5135.98"/>
</g>
<!-- proc~compute_dm&#45;&gt;escf -->
<g id="proc~~siesta_forces~~CallsGraph_edge119" class="edge"><title>proc~compute_dm&#45;&gt;escf</title>
<path fill="none" stroke="#000000" d="M173.48,-5237.98C173.36,-5104.55 174.9,-3902.62 269,-3780 275.331,-3771.75 285.056,-3766.72 294.942,-3763.65"/>
<polygon fill="#000000" stroke="#000000" points="295.907,-3767.02 304.76,-3761.2 294.21,-3760.23 295.907,-3767.02"/>
</g>
<!-- proc~compute_dm&#45;&gt;normalize_dm -->
<g id="proc~~siesta_forces~~CallsGraph_edge129" class="edge"><title>proc~compute_dm&#45;&gt;normalize_dm</title>
<path fill="none" stroke="#000000" d="M173.558,-5237.85C174.269,-5110.19 182.859,-4017.55 269,-3906 272.649,-3901.27 277.411,-3897.6 282.675,-3894.76"/>
<polygon fill="#000000" stroke="#000000" points="284.16,-3897.93 291.902,-3890.69 281.34,-3891.52 284.16,-3897.93"/>
</g>
<!-- compute_ebs_shift -->
<g id="proc~~siesta_forces~~CallsGraph_node121" class="node"><title>compute_ebs_shift</title>
<polygon fill="#777777" stroke="#777777" points="383.5,-5640 280.5,-5640 280.5,-5616 383.5,-5616 383.5,-5640"/>
<text text-anchor="middle" x="332" y="-5625.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_ebs_shift</text>
</g>
<!-- proc~compute_dm&#45;&gt;compute_ebs_shift -->
<g id="proc~~siesta_forces~~CallsGraph_edge132" class="edge"><title>proc~compute_dm&#45;&gt;compute_ebs_shift</title>
<path fill="none" stroke="#000000" d="M176.935,-5262.16C186.192,-5294.98 212.348,-5388.18 233,-5466 249.589,-5528.51 225.051,-5559.55 269,-5607 269.912,-5607.98 270.872,-5608.92 271.874,-5609.82"/>
<polygon fill="#000000" stroke="#000000" points="270.097,-5612.85 280.258,-5615.85 274.185,-5607.17 270.097,-5612.85"/>
</g>
<!-- mpi_bcast -->
<g id="proc~~siesta_forces~~CallsGraph_node123" class="node"><title>mpi_bcast</title>
<polygon fill="#777777" stroke="#777777" points="362.5,-5598 301.5,-5598 301.5,-5574 362.5,-5574 362.5,-5598"/>
<text text-anchor="middle" x="332" y="-5583.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_bcast</text>
</g>
<!-- proc~compute_dm&#45;&gt;mpi_bcast -->
<g id="proc~~siesta_forces~~CallsGraph_edge122" class="edge"><title>proc~compute_dm&#45;&gt;mpi_bcast</title>
<path fill="none" stroke="#000000" d="M176.87,-5262.23C192.521,-5318.87 257.82,-5553.45 269,-5565 275.137,-5571.34 283.252,-5575.76 291.583,-5578.85"/>
<polygon fill="#000000" stroke="#000000" points="290.766,-5582.26 301.354,-5581.9 292.85,-5575.58 290.766,-5582.26"/>
</g>
<!-- proc~compute_dm&#45;&gt;dscf -->
<g id="proc~~siesta_forces~~CallsGraph_edge128" class="edge"><title>proc~compute_dm&#45;&gt;dscf</title>
<path fill="none" stroke="#000000" d="M173.471,-5237.8C173.622,-5165.88 178.867,-4790.57 269,-4503 280.451,-4466.46 302.754,-4427.79 317.255,-4404.79"/>
<polygon fill="#000000" stroke="#000000" points="320.3,-4406.52 322.755,-4396.22 314.408,-4402.74 320.3,-4406.52"/>
</g>
<!-- write_hs_formatted -->
<g id="proc~~siesta_forces~~CallsGraph_node129" class="node"><title>write_hs_formatted</title>
<polygon fill="#777777" stroke="#777777" points="384,-5556 280,-5556 280,-5532 384,-5532 384,-5556"/>
<text text-anchor="middle" x="332" y="-5541.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_hs_formatted</text>
</g>
<!-- proc~compute_dm&#45;&gt;write_hs_formatted -->
<g id="proc~~siesta_forces~~CallsGraph_edge126" class="edge"><title>proc~compute_dm&#45;&gt;write_hs_formatted</title>
<path fill="none" stroke="#000000" d="M176.231,-5262.05C187.24,-5309.66 229.662,-5484.05 269,-5523 270.11,-5524.1 271.28,-5525.14 272.5,-5526.13"/>
<polygon fill="#000000" stroke="#000000" points="270.908,-5529.27 281.176,-5531.89 274.779,-5523.44 270.908,-5529.27"/>
</g>
<!-- chess_wrapper -->
<g id="proc~~siesta_forces~~CallsGraph_node131" class="node"><title>chess_wrapper</title>
<polygon fill="#777777" stroke="#777777" points="374.5,-5514 289.5,-5514 289.5,-5490 374.5,-5490 374.5,-5514"/>
<text text-anchor="middle" x="332" y="-5499.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">chess_wrapper</text>
</g>
<!-- proc~compute_dm&#45;&gt;chess_wrapper -->
<g id="proc~~siesta_forces~~CallsGraph_edge121" class="edge"><title>proc~compute_dm&#45;&gt;chess_wrapper</title>
<path fill="none" stroke="#000000" d="M174.968,-5262.01C180.224,-5299.86 201.536,-5417.81 269,-5481 272.309,-5484.1 276.092,-5486.74 280.121,-5489"/>
<polygon fill="#000000" stroke="#000000" points="278.712,-5492.2 289.246,-5493.34 281.718,-5485.88 278.712,-5492.2"/>
</g>
<!-- proc~state_analysis&#45;&gt;timer -->
<g id="proc~~siesta_forces~~CallsGraph_edge152" class="edge"><title>proc~state_analysis&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M337.782,-4741.65C348.564,-4713.63 375.356,-4643.02 395,-4583 412.717,-4528.87 390.33,-4499.88 431,-4460 480.652,-4411.31 522.605,-4455.17 582,-4419 668.512,-4366.32 688.106,-4340.25 736,-4251 842.525,-4052.49 819.101,-3980.91 858,-3759 896.734,-3538.04 914.281,-3266.28 918.787,-3187.42"/>
<polygon fill="#000000" stroke="#000000" points="922.294,-3187.4 919.358,-3177.22 915.305,-3187 922.294,-3187.4"/>
</g>
<!-- proc~state_analysis&#45;&gt;volcel -->
<g id="proc~~siesta_forces~~CallsGraph_edge135" class="edge"><title>proc~state_analysis&#45;&gt;volcel</title>
<path fill="none" stroke="#000000" d="M334.845,-4741.95C345.446,-4673.33 399.249,-4333.79 431,-4300 440.826,-4289.54 455.417,-4284.16 469.088,-4281.43"/>
<polygon fill="#000000" stroke="#000000" points="469.937,-4284.84 479.269,-4279.82 468.845,-4277.92 469.937,-4284.84"/>
</g>
<!-- moments -->
<g id="proc~~siesta_forces~~CallsGraph_node31" class="node"><title>moments</title>
<polygon fill="#777777" stroke="#777777" points="535,-5081 478,-5081 478,-5057 535,-5057 535,-5081"/>
<text text-anchor="middle" x="506.5" y="-5066.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">moments</text>
</g>
<!-- proc~state_analysis&#45;&gt;moments -->
<g id="proc~~siesta_forces~~CallsGraph_edge136" class="edge"><title>proc~state_analysis&#45;&gt;moments</title>
<path fill="none" stroke="#000000" d="M333.227,-4766.16C334.741,-4810.77 346.138,-4967.04 431,-5048 440.897,-5057.44 454.702,-5062.7 467.742,-5065.6"/>
<polygon fill="#000000" stroke="#000000" points="467.481,-5069.11 477.947,-5067.46 468.736,-5062.22 467.481,-5069.11"/>
</g>
<!-- cartesianforce_to_zmatforce -->
<g id="proc~~siesta_forces~~CallsGraph_node35" class="node"><title>cartesianforce_to_zmatforce</title>
<polygon fill="#777777" stroke="#777777" points="580.5,-5039 432.5,-5039 432.5,-5015 580.5,-5015 580.5,-5039"/>
<text text-anchor="middle" x="506.5" y="-5024.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cartesianforce_to_zmatforce</text>
</g>
<!-- proc~state_analysis&#45;&gt;cartesianforce_to_zmatforce -->
<g id="proc~~siesta_forces~~CallsGraph_edge139" class="edge"><title>proc~state_analysis&#45;&gt;cartesianforce_to_zmatforce</title>
<path fill="none" stroke="#000000" d="M333.987,-4766.1C337.946,-4806.52 356.289,-4938.15 431,-5006 432.334,-5007.21 433.732,-5008.35 435.184,-5009.43"/>
<polygon fill="#000000" stroke="#000000" points="433.68,-5012.61 444.023,-5014.91 437.368,-5006.67 433.68,-5012.61"/>
</g>
<!-- print_spin -->
<g id="proc~~siesta_forces~~CallsGraph_node36" class="node"><title>print_spin</title>
<polygon fill="#777777" stroke="#777777" points="536,-4997 477,-4997 477,-4973 536,-4973 536,-4997"/>
<text text-anchor="middle" x="506.5" y="-4982.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_spin</text>
</g>
<!-- proc~state_analysis&#45;&gt;print_spin -->
<g id="proc~~siesta_forces~~CallsGraph_edge140" class="edge"><title>proc~state_analysis&#45;&gt;print_spin</title>
<path fill="none" stroke="#000000" d="M335.024,-4766.09C341.685,-4802.01 366.316,-4909.02 431,-4964 441.099,-4972.58 454.475,-4977.67 467.104,-4980.68"/>
<polygon fill="#000000" stroke="#000000" points="466.5,-4984.13 476.995,-4982.68 467.885,-4977.27 466.5,-4984.13"/>
</g>
<!-- siesta_write_stress_pressure -->
<g id="proc~~siesta_forces~~CallsGraph_node37" class="node"><title>siesta_write_stress_pressure</title>
<polygon fill="#777777" stroke="#777777" points="582,-4955 431,-4955 431,-4931 582,-4931 582,-4955"/>
<text text-anchor="middle" x="506.5" y="-4940.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_write_stress_pressure</text>
</g>
<!-- proc~state_analysis&#45;&gt;siesta_write_stress_pressure -->
<g id="proc~~siesta_forces~~CallsGraph_edge142" class="edge"><title>proc~state_analysis&#45;&gt;siesta_write_stress_pressure</title>
<path fill="none" stroke="#000000" d="M336.601,-4766.3C346.348,-4797.39 376.262,-4879.63 431,-4922 432.856,-4923.44 434.806,-4924.78 436.828,-4926.02"/>
<polygon fill="#000000" stroke="#000000" points="435.614,-4929.34 446.089,-4930.92 438.888,-4923.15 435.614,-4929.34"/>
</g>
<!-- slua_call -->
<g id="proc~~siesta_forces~~CallsGraph_node38" class="node"><title>slua_call</title>
<polygon fill="#777777" stroke="#777777" points="533.5,-4913 479.5,-4913 479.5,-4889 533.5,-4889 533.5,-4913"/>
<text text-anchor="middle" x="506.5" y="-4898.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">slua_call</text>
</g>
<!-- proc~state_analysis&#45;&gt;slua_call -->
<g id="proc~~siesta_forces~~CallsGraph_edge144" class="edge"><title>proc~state_analysis&#45;&gt;slua_call</title>
<path fill="none" stroke="#000000" d="M338.999,-4766.14C352.088,-4791.34 385.704,-4849.52 431,-4880 442.349,-4887.64 456.451,-4892.52 469.323,-4895.63"/>
<polygon fill="#000000" stroke="#000000" points="468.795,-4899.1 479.306,-4897.77 470.259,-4892.25 468.795,-4899.1"/>
</g>
<!-- update_freeeharris -->
<g id="proc~~siesta_forces~~CallsGraph_node41" class="node"><title>update_freeeharris</title>
<polygon fill="#777777" stroke="#777777" points="558,-4871 455,-4871 455,-4847 558,-4847 558,-4871"/>
<text text-anchor="middle" x="506.5" y="-4856.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_freeeharris</text>
</g>
<!-- proc~state_analysis&#45;&gt;update_freeeharris -->
<g id="proc~~siesta_forces~~CallsGraph_edge145" class="edge"><title>proc~state_analysis&#45;&gt;update_freeeharris</title>
<path fill="none" stroke="#000000" d="M343.82,-4766.17C360.683,-4784.41 395.048,-4818.75 431,-4838 435.476,-4840.4 440.253,-4842.54 445.145,-4844.46"/>
<polygon fill="#000000" stroke="#000000" points="444.052,-4847.79 454.646,-4847.88 446.418,-4841.2 444.052,-4847.79"/>
</g>
<!-- update_freee -->
<g id="proc~~siesta_forces~~CallsGraph_node44" class="node"><title>update_freee</title>
<polygon fill="#777777" stroke="#777777" points="544.5,-4829 468.5,-4829 468.5,-4805 544.5,-4805 544.5,-4829"/>
<text text-anchor="middle" x="506.5" y="-4814.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_freee</text>
</g>
<!-- proc~state_analysis&#45;&gt;update_freee -->
<g id="proc~~siesta_forces~~CallsGraph_edge146" class="edge"><title>proc~state_analysis&#45;&gt;update_freee</title>
<path fill="none" stroke="#000000" d="M358.839,-4766.17C378.39,-4775.11 406.044,-4787.18 431,-4796 439.839,-4799.12 449.393,-4802.11 458.617,-4804.79"/>
<polygon fill="#000000" stroke="#000000" points="457.87,-4808.22 468.446,-4807.58 459.78,-4801.48 457.87,-4808.22"/>
</g>
<!-- born_charge -->
<g id="proc~~siesta_forces~~CallsGraph_node47" class="node"><title>born_charge</title>
<polygon fill="#777777" stroke="#777777" points="543,-4787 470,-4787 470,-4763 543,-4763 543,-4787"/>
<text text-anchor="middle" x="506.5" y="-4772.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">born_charge</text>
</g>
<!-- proc~state_analysis&#45;&gt;born_charge -->
<g id="proc~~siesta_forces~~CallsGraph_edge147" class="edge"><title>proc~state_analysis&#45;&gt;born_charge</title>
<path fill="none" stroke="#000000" d="M372.143,-4758.77C398.145,-4761.93 432.387,-4766.1 459.662,-4769.42"/>
<polygon fill="#000000" stroke="#000000" points="459.393,-4772.91 469.743,-4770.65 460.239,-4765.96 459.393,-4772.91"/>
</g>
<!-- proc~state_analysis&#45;&gt;cmladdproperty -->
<g id="proc~~siesta_forces~~CallsGraph_edge148" class="edge"><title>proc~state_analysis&#45;&gt;cmladdproperty</title>
<path fill="none" stroke="#000000" d="M336.458,-4741.94C346.021,-4708.51 373.534,-4611.78 395,-4531 411.721,-4468.08 387.019,-4437.01 431,-4389 437.051,-4382.39 444.872,-4377.47 453.163,-4373.79"/>
<polygon fill="#000000" stroke="#000000" points="454.572,-4377 462.655,-4370.15 452.065,-4370.46 454.572,-4377"/>
</g>
<!-- mulliken -->
<g id="proc~~siesta_forces~~CallsGraph_node50" class="node"><title>mulliken</title>
<polygon fill="#777777" stroke="#777777" points="533.5,-4745 479.5,-4745 479.5,-4721 533.5,-4721 533.5,-4745"/>
<text text-anchor="middle" x="506.5" y="-4730.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mulliken</text>
</g>
<!-- proc~state_analysis&#45;&gt;mulliken -->
<g id="proc~~siesta_forces~~CallsGraph_edge150" class="edge"><title>proc~state_analysis&#45;&gt;mulliken</title>
<path fill="none" stroke="#000000" d="M372.143,-4749.23C401.358,-4745.68 440.976,-4740.86 469.426,-4737.39"/>
<polygon fill="#000000" stroke="#000000" points="469.859,-4740.86 479.362,-4736.18 469.013,-4733.92 469.859,-4740.86"/>
</g>
<!-- eggbox -->
<g id="proc~~siesta_forces~~CallsGraph_node51" class="node"><title>eggbox</title>
<polygon fill="#777777" stroke="#777777" points="533.5,-4703 479.5,-4703 479.5,-4679 533.5,-4679 533.5,-4703"/>
<text text-anchor="middle" x="506.5" y="-4688.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">eggbox</text>
</g>
<!-- proc~state_analysis&#45;&gt;eggbox -->
<g id="proc~~siesta_forces~~CallsGraph_edge151" class="edge"><title>proc~state_analysis&#45;&gt;eggbox</title>
<path fill="none" stroke="#000000" d="M358.839,-4741.83C378.39,-4732.89 406.044,-4720.82 431,-4712 443.373,-4707.63 457.147,-4703.53 469.453,-4700.14"/>
<polygon fill="#000000" stroke="#000000" points="470.635,-4703.45 479.382,-4697.47 468.816,-4696.69 470.635,-4703.45"/>
</g>
<!-- cmlendmodule -->
<g id="proc~~siesta_forces~~CallsGraph_node56" class="node"><title>cmlendmodule</title>
<polygon fill="#777777" stroke="#777777" points="547.5,-4661 465.5,-4661 465.5,-4637 547.5,-4637 547.5,-4661"/>
<text text-anchor="middle" x="506.5" y="-4646.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cmlendmodule</text>
</g>
<!-- proc~state_analysis&#45;&gt;cmlendmodule -->
<g id="proc~~siesta_forces~~CallsGraph_edge153" class="edge"><title>proc~state_analysis&#45;&gt;cmlendmodule</title>
<path fill="none" stroke="#000000" d="M343.82,-4741.83C360.683,-4723.59 395.048,-4689.25 431,-4670 438.578,-4665.94 447.02,-4662.6 455.422,-4659.87"/>
<polygon fill="#000000" stroke="#000000" points="456.635,-4663.16 465.212,-4656.94 454.629,-4656.46 456.635,-4663.16"/>
</g>
<!-- proc~state_analysis&#45;&gt;write_debug -->
<g id="proc~~siesta_forces~~CallsGraph_edge154" class="edge"><title>proc~state_analysis&#45;&gt;write_debug</title>
<path fill="none" stroke="#000000" d="M338.033,-4741.73C349.328,-4713.87 377.103,-4643.57 395,-4583 415.164,-4514.76 381.975,-4478.57 431,-4427 479.077,-4376.43 526.7,-4426.56 582,-4384 688.134,-4302.33 687.864,-4249.97 736,-4125 787.031,-3992.51 806.548,-3821.04 812.138,-3760.42"/>
<polygon fill="#000000" stroke="#000000" points="815.654,-3760.4 813.05,-3750.13 808.681,-3759.78 815.654,-3760.4"/>
</g>
<!-- fixed -->
<g id="proc~~siesta_forces~~CallsGraph_node59" class="node"><title>fixed</title>
<polygon fill="#777777" stroke="#777777" points="533.5,-4619 479.5,-4619 479.5,-4595 533.5,-4595 533.5,-4619"/>
<text text-anchor="middle" x="506.5" y="-4604.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fixed</text>
</g>
<!-- proc~state_analysis&#45;&gt;fixed -->
<g id="proc~~siesta_forces~~CallsGraph_edge155" class="edge"><title>proc~state_analysis&#45;&gt;fixed</title>
<path fill="none" stroke="#000000" d="M338.999,-4741.86C352.088,-4716.66 385.704,-4658.48 431,-4628 442.349,-4620.36 456.451,-4615.48 469.323,-4612.37"/>
<polygon fill="#000000" stroke="#000000" points="470.259,-4615.75 479.306,-4610.23 468.795,-4608.9 470.259,-4615.75"/>
</g>
<!-- cmlstartmodule -->
<g id="proc~~siesta_forces~~CallsGraph_node77" class="node"><title>cmlstartmodule</title>
<polygon fill="#777777" stroke="#777777" points="549,-4577 464,-4577 464,-4553 549,-4553 549,-4577"/>
<text text-anchor="middle" x="506.5" y="-4562.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cmlstartmodule</text>
</g>
<!-- proc~state_analysis&#45;&gt;cmlstartmodule -->
<g id="proc~~siesta_forces~~CallsGraph_edge149" class="edge"><title>proc~state_analysis&#45;&gt;cmlstartmodule</title>
<path fill="none" stroke="#000000" d="M336.601,-4741.7C346.348,-4710.61 376.262,-4628.37 431,-4586 437.798,-4580.74 445.85,-4576.79 454.105,-4573.84"/>
<polygon fill="#000000" stroke="#000000" points="455.324,-4577.13 463.826,-4570.8 453.238,-4570.44 455.324,-4577.13"/>
</g>
<!-- amass -->
<g id="proc~~siesta_forces~~CallsGraph_node81" class="node"><title>amass</title>
<polygon fill="#777777" stroke="#777777" points="533.5,-4535 479.5,-4535 479.5,-4511 533.5,-4511 533.5,-4535"/>
<text text-anchor="middle" x="506.5" y="-4520.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">amass</text>
</g>
<!-- proc~state_analysis&#45;&gt;amass -->
<g id="proc~~siesta_forces~~CallsGraph_edge133" class="edge"><title>proc~state_analysis&#45;&gt;amass</title>
<path fill="none" stroke="#000000" d="M335.024,-4741.91C341.685,-4705.99 366.316,-4598.98 431,-4544 441.689,-4534.92 456.048,-4529.75 469.308,-4526.81"/>
<polygon fill="#000000" stroke="#000000" points="469.965,-4530.25 479.153,-4524.98 468.681,-4523.37 469.965,-4530.25"/>
</g>
<!-- kin_stress -->
<g id="proc~~siesta_forces~~CallsGraph_node100" class="node"><title>kin_stress</title>
<polygon fill="#777777" stroke="#777777" points="537,-4493 476,-4493 476,-4469 537,-4469 537,-4493"/>
<text text-anchor="middle" x="506.5" y="-4478.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">kin_stress</text>
</g>
<!-- proc~state_analysis&#45;&gt;kin_stress -->
<g id="proc~~siesta_forces~~CallsGraph_edge137" class="edge"><title>proc~state_analysis&#45;&gt;kin_stress</title>
<path fill="none" stroke="#000000" d="M333.987,-4741.9C337.946,-4701.48 356.289,-4569.85 431,-4502 440.655,-4493.23 453.697,-4488.09 466.17,-4485.09"/>
<polygon fill="#000000" stroke="#000000" points="466.865,-4488.52 475.976,-4483.12 465.482,-4481.66 466.865,-4488.52"/>
</g>
<!-- va -->
<g id="proc~~siesta_forces~~CallsGraph_node108" class="node"><title>va</title>
<polygon fill="#777777" stroke="#777777" points="533.5,-5249 479.5,-5249 479.5,-5225 533.5,-5225 533.5,-5249"/>
<text text-anchor="middle" x="506.5" y="-5234.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">va</text>
</g>
<!-- proc~state_analysis&#45;&gt;va -->
<g id="proc~~siesta_forces~~CallsGraph_edge134" class="edge"><title>proc~state_analysis&#45;&gt;va</title>
<path fill="none" stroke="#000000" d="M335.834,-4766.17C344.83,-4804.91 373.423,-4928.91 395,-5032 412.071,-5113.56 374.529,-5154.73 431,-5216 440.725,-5226.55 455.298,-5231.95 468.984,-5234.67"/>
<polygon fill="#000000" stroke="#000000" points="468.762,-5238.18 479.182,-5236.26 469.841,-5231.26 468.762,-5238.18"/>
</g>
<!-- siesta_write_forces -->
<g id="proc~~siesta_forces~~CallsGraph_node110" class="node"><title>siesta_write_forces</title>
<polygon fill="#777777" stroke="#777777" points="558.5,-5207 454.5,-5207 454.5,-5183 558.5,-5183 558.5,-5207"/>
<text text-anchor="middle" x="506.5" y="-5192.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_write_forces</text>
</g>
<!-- proc~state_analysis&#45;&gt;siesta_write_forces -->
<g id="proc~~siesta_forces~~CallsGraph_edge138" class="edge"><title>proc~state_analysis&#45;&gt;siesta_write_forces</title>
<path fill="none" stroke="#000000" d="M335.694,-4766.32C350.703,-4834.84 423.581,-5166.23 431,-5174 434.945,-5178.13 439.634,-5181.47 444.711,-5184.16"/>
<polygon fill="#000000" stroke="#000000" points="443.629,-5187.51 454.19,-5188.35 446.457,-5181.11 443.629,-5187.51"/>
</g>
<!-- wallclock -->
<g id="proc~~siesta_forces~~CallsGraph_node117" class="node"><title>wallclock</title>
<polygon fill="#777777" stroke="#777777" points="534,-5165 479,-5165 479,-5141 534,-5141 534,-5165"/>
<text text-anchor="middle" x="506.5" y="-5150.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">wallclock</text>
</g>
<!-- proc~state_analysis&#45;&gt;wallclock -->
<g id="proc~~siesta_forces~~CallsGraph_edge141" class="edge"><title>proc~state_analysis&#45;&gt;wallclock</title>
<path fill="none" stroke="#000000" d="M335.452,-4766.39C347.847,-4828.56 404.083,-5104.51 431,-5132 440.889,-5142.1 455.229,-5147.45 468.693,-5150.24"/>
<polygon fill="#000000" stroke="#000000" points="468.291,-5153.72 478.73,-5151.91 469.443,-5146.81 468.291,-5153.72"/>
</g>
<!-- remove_intramol_pressure -->
<g id="proc~~siesta_forces~~CallsGraph_node118" class="node"><title>remove_intramol_pressure</title>
<polygon fill="#777777" stroke="#777777" points="577,-5123 436,-5123 436,-5099 577,-5099 577,-5123"/>
<text text-anchor="middle" x="506.5" y="-5108.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">remove_intramol_pressure</text>
</g>
<!-- proc~state_analysis&#45;&gt;remove_intramol_pressure -->
<g id="proc~~siesta_forces~~CallsGraph_edge143" class="edge"><title>proc~state_analysis&#45;&gt;remove_intramol_pressure</title>
<path fill="none" stroke="#000000" d="M334.945,-4766.19C343.884,-4820.77 382.66,-5042.1 431,-5090 432.104,-5091.09 433.26,-5092.13 434.461,-5093.12"/>
<polygon fill="#000000" stroke="#000000" points="432.728,-5096.17 442.973,-5098.87 436.65,-5090.37 432.728,-5096.17"/>
</g>
<!-- proc~compute_max_diff_2d&#45;&gt;die -->
<g id="proc~~siesta_forces~~CallsGraph_edge156" class="edge"><title>proc~compute_max_diff_2d&#45;&gt;die</title>
<path fill="none" stroke="#000000" d="M687.063,-1546.08C700.057,-1564.05 723.758,-1599.3 736,-1633 794.922,-1795.21 809.733,-2005.79 813.095,-2073.79"/>
<polygon fill="#000000" stroke="#000000" points="809.599,-2073.96 813.555,-2083.79 816.591,-2073.64 809.599,-2073.96"/>
</g>
<!-- proc~dhscf&#45;&gt;bye -->
<g id="proc~~siesta_forces~~CallsGraph_edge169" class="edge"><title>proc~dhscf&#45;&gt;bye</title>
<path fill="none" stroke="#000000" d="M350.465,-3497.2C365.285,-3508.66 385.593,-3527.28 395,-3549 428.201,-3625.66 378.994,-4234.62 431,-4300 440.155,-4311.51 455.097,-4317.02 469.206,-4319.55"/>
<polygon fill="#000000" stroke="#000000" points="468.857,-4323.03 479.237,-4320.91 469.799,-4316.1 468.857,-4323.03"/>
</g>
<!-- proc~dhscf&#45;&gt;die -->
<g id="proc~~siesta_forces~~CallsGraph_edge185" class="edge"><title>proc~dhscf&#45;&gt;die</title>
<path fill="none" stroke="#000000" d="M336.301,-3472.74C346.685,-3433.68 378.943,-3308.56 395,-3203 409.088,-3110.39 386.086,-2865.21 431,-2783 481.295,-2690.95 534.051,-2701.9 618,-2639 669.935,-2600.09 701.803,-2608.15 736,-2553 782.18,-2478.52 806.234,-2200.09 812.39,-2118.56"/>
<polygon fill="#000000" stroke="#000000" points="815.894,-2118.64 813.14,-2108.41 808.913,-2118.12 815.894,-2118.64"/>
</g>
<!-- proc~dhscf&#45;&gt;timer -->
<g id="proc~~siesta_forces~~CallsGraph_edge186" class="edge"><title>proc~dhscf&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M338.54,-3472.63C350.611,-3445.18 379.45,-3376.88 395,-3317 408.058,-3266.71 391.537,-3119.79 431,-3086 481.978,-3042.35 516.848,-3069.9 582,-3086 605.16,-3091.72 748.84,-3180.28 772,-3186 809.106,-3195.17 820.286,-3192.21 858,-3186 866.704,-3184.57 875.831,-3182.07 884.322,-3179.29"/>
<polygon fill="#000000" stroke="#000000" points="885.645,-3182.54 893.936,-3175.94 883.342,-3175.93 885.645,-3182.54"/>
</g>
<!-- proc~dhscf&#45;&gt;volcel -->
<g id="proc~~siesta_forces~~CallsGraph_edge157" class="edge"><title>proc~dhscf&#45;&gt;volcel</title>
<path fill="none" stroke="#000000" d="M359.145,-3489.24C372.128,-3492.78 386.763,-3499.24 395,-3511 489.719,-3646.21 332.182,-4120.76 431,-4253 440.04,-4265.1 455.11,-4271.6 469.34,-4275.08"/>
<polygon fill="#000000" stroke="#000000" points="468.961,-4278.57 479.455,-4277.11 470.343,-4271.71 468.961,-4278.57"/>
</g>
<!-- proc~dhscf&#45;&gt;re_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge158" class="edge"><title>proc~dhscf&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M336.815,-3472.96C347.823,-3437.72 379.817,-3331.52 395,-3241 410.862,-3146.43 374.892,-2888.76 431,-2811 443.045,-2794.31 752.371,-2672.2 772,-2666 809.445,-2654.16 853.586,-2645.24 883.857,-2639.87"/>
<polygon fill="#000000" stroke="#000000" points="884.698,-2643.28 893.952,-2638.12 883.501,-2636.38 884.698,-2643.28"/>
</g>
<!-- proc~dhscf&#45;&gt;write_debug -->
<g id="proc~~siesta_forces~~CallsGraph_edge192" class="edge"><title>proc~dhscf&#45;&gt;write_debug</title>
<path fill="none" stroke="#000000" d="M359.17,-3485.37C371.993,-3487.02 386.474,-3491.38 395,-3502 445.018,-3564.28 373.121,-4164.95 431,-4220 479.628,-4266.25 525.179,-4255.71 582,-4220 752.847,-4112.63 800.809,-3840.3 811.409,-3760.37"/>
<polygon fill="#000000" stroke="#000000" points="814.886,-3760.77 812.665,-3750.41 807.941,-3759.89 814.886,-3760.77"/>
</g>
<!-- proc~dhscf&#45;&gt;de_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge190" class="edge"><title>proc~dhscf&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M337.676,-3472.68C349.469,-3441.05 380.511,-3354.18 395,-3279 412.141,-3190.06 377.286,-2945.93 431,-2873 474.023,-2814.59 527.488,-2858.87 582,-2811 606.232,-2789.72 590.107,-2764.19 618,-2748 663.36,-2721.68 683.625,-2745.3 736,-2748 787.375,-2750.65 846.5,-2757.42 883.56,-2762.12"/>
<polygon fill="#000000" stroke="#000000" points="883.496,-2765.64 893.861,-2763.44 884.39,-2758.7 883.496,-2765.64"/>
</g>
<!-- elecs -->
<g id="proc~~siesta_forces~~CallsGraph_node133" class="node"><title>elecs</title>
<polygon fill="#777777" stroke="#777777" points="533.5,-3917 479.5,-3917 479.5,-3893 533.5,-3893 533.5,-3917"/>
<text text-anchor="middle" x="506.5" y="-3902.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elecs</text>
</g>
<!-- proc~dhscf&#45;&gt;elecs -->
<g id="proc~~siesta_forces~~CallsGraph_edge162" class="edge"><title>proc~dhscf&#45;&gt;elecs</title>
<path fill="none" stroke="#000000" d="M359.235,-3489.49C372.077,-3493.09 386.554,-3499.54 395,-3511 444.394,-3578.04 377.6,-3820.1 431,-3884 440.43,-3895.28 455.413,-3900.76 469.477,-3903.33"/>
<polygon fill="#000000" stroke="#000000" points="469.074,-3906.81 479.463,-3904.73 470.045,-3899.87 469.074,-3906.81"/>
</g>
<!-- ts_voltage -->
<g id="proc~~siesta_forces~~CallsGraph_node134" class="node"><title>ts_voltage</title>
<polygon fill="#777777" stroke="#777777" points="537,-3875 476,-3875 476,-3851 537,-3851 537,-3875"/>
<text text-anchor="middle" x="506.5" y="-3860.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ts_voltage</text>
</g>
<!-- proc~dhscf&#45;&gt;ts_voltage -->
<g id="proc~~siesta_forces~~CallsGraph_edge159" class="edge"><title>proc~dhscf&#45;&gt;ts_voltage</title>
<path fill="none" stroke="#000000" d="M359.179,-3489.53C372.004,-3493.15 386.484,-3499.59 395,-3511 483.494,-3629.6 335.422,-3729.03 431,-3842 439.629,-3852.2 452.793,-3857.64 465.667,-3860.49"/>
<polygon fill="#000000" stroke="#000000" points="465.386,-3863.99 475.837,-3862.25 466.583,-3857.1 465.386,-3863.99"/>
</g>
<!-- dfscf -->
<g id="proc~~siesta_forces~~CallsGraph_node135" class="node"><title>dfscf</title>
<polygon fill="#777777" stroke="#777777" points="533.5,-3833 479.5,-3833 479.5,-3809 533.5,-3809 533.5,-3833"/>
<text text-anchor="middle" x="506.5" y="-3818.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dfscf</text>
</g>
<!-- proc~dhscf&#45;&gt;dfscf -->
<g id="proc~~siesta_forces~~CallsGraph_edge179" class="edge"><title>proc~dhscf&#45;&gt;dfscf</title>
<path fill="none" stroke="#000000" d="M359.106,-3489.59C371.911,-3493.22 386.396,-3499.65 395,-3511 473.212,-3614.13 346.63,-3701.84 431,-3800 440.515,-3811.07 455.37,-3816.53 469.32,-3819.14"/>
<polygon fill="#000000" stroke="#000000" points="468.828,-3822.61 479.228,-3820.58 469.835,-3815.68 468.828,-3822.61"/>
</g>
<!-- ts_hartree_fix -->
<g id="proc~~siesta_forces~~CallsGraph_node136" class="node"><title>ts_hartree_fix</title>
<polygon fill="#777777" stroke="#777777" points="545.5,-3791 467.5,-3791 467.5,-3767 545.5,-3767 545.5,-3791"/>
<text text-anchor="middle" x="506.5" y="-3776.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ts_hartree_fix</text>
</g>
<!-- proc~dhscf&#45;&gt;ts_hartree_fix -->
<g id="proc~~siesta_forces~~CallsGraph_edge161" class="edge"><title>proc~dhscf&#45;&gt;ts_hartree_fix</title>
<path fill="none" stroke="#000000" d="M359.009,-3489.66C371.788,-3493.31 386.278,-3499.74 395,-3511 462.95,-3598.69 357.817,-3674.62 431,-3758 437.848,-3765.8 447.347,-3770.81 457.273,-3773.99"/>
<polygon fill="#000000" stroke="#000000" points="456.699,-3777.46 467.26,-3776.61 458.473,-3770.69 456.699,-3777.46"/>
</g>
<!-- ddot -->
<g id="proc~~siesta_forces~~CallsGraph_node137" class="node"><title>ddot</title>
<polygon fill="#777777" stroke="#777777" points="533.5,-3749 479.5,-3749 479.5,-3725 533.5,-3725 533.5,-3749"/>
<text text-anchor="middle" x="506.5" y="-3734.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ddot</text>
</g>
<!-- proc~dhscf&#45;&gt;ddot -->
<g id="proc~~siesta_forces~~CallsGraph_edge163" class="edge"><title>proc~dhscf&#45;&gt;ddot</title>
<path fill="none" stroke="#000000" d="M359.189,-3489.86C371.855,-3493.55 386.188,-3499.96 395,-3511 452.718,-3583.29 368.971,-3647.37 431,-3716 440.694,-3726.72 455.396,-3732.14 469.186,-3734.82"/>
<polygon fill="#000000" stroke="#000000" points="469.044,-3738.34 479.455,-3736.38 470.093,-3731.42 469.044,-3738.34"/>
</g>
<!-- jms_setmeshdistr -->
<g id="proc~~siesta_forces~~CallsGraph_node138" class="node"><title>jms_setmeshdistr</title>
<polygon fill="#777777" stroke="#777777" points="554.5,-3707 458.5,-3707 458.5,-3683 554.5,-3683 554.5,-3707"/>
<text text-anchor="middle" x="506.5" y="-3692.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jms_setmeshdistr</text>
</g>
<!-- proc~dhscf&#45;&gt;jms_setmeshdistr -->
<g id="proc~~siesta_forces~~CallsGraph_edge164" class="edge"><title>proc~dhscf&#45;&gt;jms_setmeshdistr</title>
<path fill="none" stroke="#000000" d="M359.303,-3490.11C371.841,-3493.86 386.025,-3500.25 395,-3511 442.541,-3567.96 380.066,-3620.06 431,-3674 436.011,-3679.31 442.249,-3683.31 448.967,-3686.32"/>
<polygon fill="#000000" stroke="#000000" points="447.765,-3689.6 458.357,-3689.84 450.222,-3683.05 447.765,-3689.6"/>
</g>
<!-- mpitrace_restart -->
<g id="proc~~siesta_forces~~CallsGraph_node139" class="node"><title>mpitrace_restart</title>
<polygon fill="#777777" stroke="#777777" points="552,-3665 461,-3665 461,-3641 552,-3641 552,-3665"/>
<text text-anchor="middle" x="506.5" y="-3650.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpitrace_restart</text>
</g>
<!-- proc~dhscf&#45;&gt;mpitrace_restart -->
<g id="proc~~siesta_forces~~CallsGraph_edge165" class="edge"><title>proc~dhscf&#45;&gt;mpitrace_restart</title>
<path fill="none" stroke="#000000" d="M359.293,-3490.49C371.673,-3494.32 385.722,-3500.66 395,-3511 432.477,-3552.76 391.041,-3592.61 431,-3632 436.653,-3637.57 443.662,-3641.69 451.102,-3644.73"/>
<polygon fill="#000000" stroke="#000000" points="450.092,-3648.08 460.687,-3648.03 452.371,-3641.46 450.092,-3648.08"/>
</g>
<!-- bsc_cellxc -->
<g id="proc~~siesta_forces~~CallsGraph_node140" class="node"><title>bsc_cellxc</title>
<polygon fill="#777777" stroke="#777777" points="537,-3623 476,-3623 476,-3599 537,-3599 537,-3623"/>
<text text-anchor="middle" x="506.5" y="-3608.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bsc_cellxc</text>
</g>
<!-- proc~dhscf&#45;&gt;bsc_cellxc -->
<g id="proc~~siesta_forces~~CallsGraph_edge166" class="edge"><title>proc~dhscf&#45;&gt;bsc_cellxc</title>
<path fill="none" stroke="#000000" d="M359.007,-3491.16C371.169,-3495.14 385.114,-3501.41 395,-3511 422.697,-3537.86 401.713,-3564.88 431,-3590 440.722,-3598.34 453.531,-3603.38 465.782,-3606.42"/>
<polygon fill="#000000" stroke="#000000" points="465.356,-3609.91 475.861,-3608.54 466.793,-3603.06 465.356,-3609.91"/>
</g>
<!-- write_grid_netcdf -->
<g id="proc~~siesta_forces~~CallsGraph_node141" class="node"><title>write_grid_netcdf</title>
<polygon fill="#777777" stroke="#777777" points="553.5,-3581 459.5,-3581 459.5,-3557 553.5,-3557 553.5,-3581"/>
<text text-anchor="middle" x="506.5" y="-3566.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_grid_netcdf</text>
</g>
<!-- proc~dhscf&#45;&gt;write_grid_netcdf -->
<g id="proc~~siesta_forces~~CallsGraph_edge167" class="edge"><title>proc~dhscf&#45;&gt;write_grid_netcdf</title>
<path fill="none" stroke="#000000" d="M359.221,-3493.32C370.743,-3497.64 384.1,-3503.57 395,-3511 413.961,-3523.92 411.285,-3536.26 431,-3548 436.819,-3551.46 443.233,-3554.38 449.784,-3556.82"/>
<polygon fill="#000000" stroke="#000000" points="448.83,-3560.2 459.424,-3560.08 451.072,-3553.56 448.83,-3560.2"/>
</g>
<!-- proc~setmeshdistr -->
<g id="proc~~siesta_forces~~CallsGraph_node142" class="node"><title>proc~setmeshdistr</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node142"><a xlink:href=".././proc/setmeshdistr.html" xlink:title="setMeshDistr">
<polygon fill="#d9534f" stroke="#d9534f" points="544,-3203 469,-3203 469,-3179 544,-3179 544,-3203"/>
<text text-anchor="middle" x="506.5" y="-3188.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setMeshDistr</text>
</a>
</g>
</g>
<!-- proc~dhscf&#45;&gt;proc~setmeshdistr -->
<g id="proc~~siesta_forces~~CallsGraph_edge168" class="edge"><title>proc~dhscf&#45;&gt;proc~setmeshdistr</title>
<path fill="none" stroke="#000000" d="M337.61,-3472.81C348.037,-3445.17 374.152,-3375.58 395,-3317 411.541,-3270.52 395.161,-3245.9 431,-3212 438.694,-3204.72 448.712,-3199.93 458.893,-3196.79"/>
<polygon fill="#000000" stroke="#000000" points="459.837,-3200.17 468.634,-3194.26 458.075,-3193.39 459.837,-3200.17"/>
</g>
<!-- rhoofdsp -->
<g id="proc~~siesta_forces~~CallsGraph_node145" class="node"><title>rhoofdsp</title>
<polygon fill="#777777" stroke="#777777" points="534,-3539 479,-3539 479,-3515 534,-3515 534,-3539"/>
<text text-anchor="middle" x="506.5" y="-3524.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rhoofdsp</text>
</g>
<!-- proc~dhscf&#45;&gt;rhoofdsp -->
<g id="proc~~siesta_forces~~CallsGraph_edge181" class="edge"><title>proc~dhscf&#45;&gt;rhoofdsp</title>
<path fill="none" stroke="#000000" d="M359.199,-3491.38C388.37,-3498.48 435.735,-3510.01 468.637,-3518.02"/>
<polygon fill="#000000" stroke="#000000" points="468.226,-3521.53 478.77,-3520.49 469.882,-3514.73 468.226,-3521.53"/>
</g>
<!-- get_field_from_dipole -->
<g id="proc~~siesta_forces~~CallsGraph_node146" class="node"><title>get_field_from_dipole</title>
<polygon fill="#777777" stroke="#777777" points="564,-3497 449,-3497 449,-3473 564,-3473 564,-3497"/>
<text text-anchor="middle" x="506.5" y="-3482.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_field_from_dipole</text>
</g>
<!-- proc~dhscf&#45;&gt;get_field_from_dipole -->
<g id="proc~~siesta_forces~~CallsGraph_edge170" class="edge"><title>proc~dhscf&#45;&gt;get_field_from_dipole</title>
<path fill="none" stroke="#000000" d="M359.199,-3485C380.268,-3485 410.829,-3485 438.577,-3485"/>
<polygon fill="#000000" stroke="#000000" points="438.649,-3488.5 448.649,-3485 438.649,-3481.5 438.649,-3488.5"/>
</g>
<!-- vmatsp -->
<g id="proc~~siesta_forces~~CallsGraph_node147" class="node"><title>vmatsp</title>
<polygon fill="#777777" stroke="#777777" points="533.5,-3455 479.5,-3455 479.5,-3431 533.5,-3431 533.5,-3455"/>
<text text-anchor="middle" x="506.5" y="-3440.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">vmatsp</text>
</g>
<!-- proc~dhscf&#45;&gt;vmatsp -->
<g id="proc~~siesta_forces~~CallsGraph_edge171" class="edge"><title>proc~dhscf&#45;&gt;vmatsp</title>
<path fill="none" stroke="#000000" d="M359.199,-3478.62C388.54,-3471.48 436.288,-3459.85 469.211,-3451.84"/>
<polygon fill="#000000" stroke="#000000" points="470.449,-3455.14 479.338,-3449.37 468.793,-3448.34 470.449,-3455.14"/>
</g>
<!-- rhoofd -->
<g id="proc~~siesta_forces~~CallsGraph_node148" class="node"><title>rhoofd</title>
<polygon fill="#777777" stroke="#777777" points="533.5,-3413 479.5,-3413 479.5,-3389 533.5,-3389 533.5,-3413"/>
<text text-anchor="middle" x="506.5" y="-3398.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rhoofd</text>
</g>
<!-- proc~dhscf&#45;&gt;rhoofd -->
<g id="proc~~siesta_forces~~CallsGraph_edge172" class="edge"><title>proc~dhscf&#45;&gt;rhoofd</title>
<path fill="none" stroke="#000000" d="M348.463,-3472.98C367.106,-3458.99 399.831,-3436.03 431,-3422 443.062,-3416.57 456.863,-3412.21 469.282,-3408.9"/>
<polygon fill="#000000" stroke="#000000" points="470.481,-3412.21 479.321,-3406.37 468.769,-3405.42 470.481,-3412.21"/>
</g>
<!-- hartree_add -->
<g id="proc~~siesta_forces~~CallsGraph_node149" class="node"><title>hartree_add</title>
<polygon fill="#777777" stroke="#777777" points="542,-3371 471,-3371 471,-3347 542,-3347 542,-3371"/>
<text text-anchor="middle" x="506.5" y="-3356.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hartree_add</text>
</g>
<!-- proc~dhscf&#45;&gt;hartree_add -->
<g id="proc~~siesta_forces~~CallsGraph_edge173" class="edge"><title>proc~dhscf&#45;&gt;hartree_add</title>
<path fill="none" stroke="#000000" d="M340.88,-3472.92C355.795,-3451.03 390.33,-3404.78 431,-3380 440.131,-3374.44 450.783,-3370.3 461.129,-3367.25"/>
<polygon fill="#000000" stroke="#000000" points="462.137,-3370.6 470.894,-3364.64 460.329,-3363.84 462.137,-3370.6"/>
</g>
<!-- add_potential_from_field -->
<g id="proc~~siesta_forces~~CallsGraph_node150" class="node"><title>add_potential_from_field</title>
<polygon fill="#777777" stroke="#777777" points="571.5,-3329 441.5,-3329 441.5,-3305 571.5,-3305 571.5,-3329"/>
<text text-anchor="middle" x="506.5" y="-3314.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">add_potential_from_field</text>
</g>
<!-- proc~dhscf&#45;&gt;add_potential_from_field -->
<g id="proc~~siesta_forces~~CallsGraph_edge174" class="edge"><title>proc~dhscf&#45;&gt;add_potential_from_field</title>
<path fill="none" stroke="#000000" d="M337.722,-3472.58C349.162,-3444.2 381.14,-3374.26 431,-3338 433.216,-3336.39 435.552,-3334.9 437.974,-3333.53"/>
<polygon fill="#000000" stroke="#000000" points="439.65,-3336.6 447.064,-3329.03 436.548,-3330.33 439.65,-3336.6"/>
</g>
<!-- proc~reord -->
<g id="proc~~siesta_forces~~CallsGraph_node151" class="node"><title>proc~reord</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node151"><a xlink:href=".././proc/reord.html" xlink:title="reord">
<polygon fill="#d9534f" stroke="#d9534f" points="842,-2937 788,-2937 788,-2913 842,-2913 842,-2937"/>
<text text-anchor="middle" x="815" y="-2922.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reord</text>
</a>
</g>
</g>
<!-- proc~dhscf&#45;&gt;proc~reord -->
<g id="proc~~siesta_forces~~CallsGraph_edge175" class="edge"><title>proc~dhscf&#45;&gt;proc~reord</title>
<path fill="none" stroke="#000000" d="M337.612,-3472.67C349.255,-3441.01 379.972,-3354.08 395,-3279 410.304,-3202.55 373.452,-2982.6 431,-2930 528.002,-2841.33 703.487,-2886.59 778.472,-2911.83"/>
<polygon fill="#000000" stroke="#000000" points="777.353,-2915.15 787.948,-2915.1 779.634,-2908.53 777.353,-2915.15"/>
</g>
<!-- compute_partial_charges -->
<g id="proc~~siesta_forces~~CallsGraph_node152" class="node"><title>compute_partial_charges</title>
<polygon fill="#777777" stroke="#777777" points="573,-3287 440,-3287 440,-3263 573,-3263 573,-3287"/>
<text text-anchor="middle" x="506.5" y="-3272.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_partial_charges</text>
</g>
<!-- proc~dhscf&#45;&gt;compute_partial_charges -->
<g id="proc~~siesta_forces~~CallsGraph_edge177" class="edge"><title>proc~dhscf&#45;&gt;compute_partial_charges</title>
<path fill="none" stroke="#000000" d="M335.757,-3472.68C343.953,-3438.98 371.395,-3344.56 431,-3296 432.778,-3294.55 434.649,-3293.2 436.595,-3291.95"/>
<polygon fill="#000000" stroke="#000000" points="438.467,-3294.91 445.531,-3287.02 435.085,-3288.78 438.467,-3294.91"/>
</g>
<!-- write_tdrho -->
<g id="proc~~siesta_forces~~CallsGraph_node153" class="node"><title>write_tdrho</title>
<polygon fill="#777777" stroke="#777777" points="539.5,-3245 473.5,-3245 473.5,-3221 539.5,-3221 539.5,-3245"/>
<text text-anchor="middle" x="506.5" y="-3230.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_tdrho</text>
</g>
<!-- proc~dhscf&#45;&gt;write_tdrho -->
<g id="proc~~siesta_forces~~CallsGraph_edge178" class="edge"><title>proc~dhscf&#45;&gt;write_tdrho</title>
<path fill="none" stroke="#000000" d="M337.428,-3472.91C354.107,-3427.61 413.102,-3269.77 431,-3254 439.969,-3246.1 451.699,-3241.15 463.189,-3238.06"/>
<polygon fill="#000000" stroke="#000000" points="464.174,-3241.43 473.148,-3235.8 462.621,-3234.6 464.174,-3241.43"/>
</g>
<!-- mpi_barrier -->
<g id="proc~~siesta_forces~~CallsGraph_node154" class="node"><title>mpi_barrier</title>
<polygon fill="#777777" stroke="#777777" points="848.5,-3177 781.5,-3177 781.5,-3153 848.5,-3153 848.5,-3177"/>
<text text-anchor="middle" x="815" y="-3162.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_barrier</text>
</g>
<!-- proc~dhscf&#45;&gt;mpi_barrier -->
<g id="proc~~siesta_forces~~CallsGraph_edge160" class="edge"><title>proc~dhscf&#45;&gt;mpi_barrier</title>
<path fill="none" stroke="#000000" d="M338.7,-3472.67C351.091,-3445.3 380.529,-3377.15 395,-3317 410.809,-3251.29 380.46,-3059.87 431,-3015 481.683,-2970 681.759,-2974.36 736,-3015 781.584,-3049.15 737.888,-3092.38 772,-3138 774.442,-3141.26 777.404,-3144.24 780.612,-3146.93"/>
<polygon fill="#000000" stroke="#000000" points="778.797,-3149.93 788.941,-3152.99 782.919,-3144.28 778.797,-3149.93"/>
</g>
<!-- write_rho -->
<g id="proc~~siesta_forces~~CallsGraph_node155" class="node"><title>write_rho</title>
<polygon fill="#777777" stroke="#777777" points="535,-3161 478,-3161 478,-3137 535,-3137 535,-3161"/>
<text text-anchor="middle" x="506.5" y="-3146.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_rho</text>
</g>
<!-- proc~dhscf&#45;&gt;write_rho -->
<g id="proc~~siesta_forces~~CallsGraph_edge180" class="edge"><title>proc~dhscf&#45;&gt;write_rho</title>
<path fill="none" stroke="#000000" d="M337.991,-3472.94C349.201,-3445.55 376.812,-3376.46 395,-3317 414.676,-3252.68 384.267,-3218.38 431,-3170 440.672,-3159.99 454.716,-3154.64 468.009,-3151.82"/>
<polygon fill="#000000" stroke="#000000" points="468.676,-3155.26 477.944,-3150.12 467.497,-3148.36 468.676,-3155.26"/>
</g>
<!-- partialcoreonmesh -->
<g id="proc~~siesta_forces~~CallsGraph_node156" class="node"><title>partialcoreonmesh</title>
<polygon fill="#777777" stroke="#777777" points="557,-3119 456,-3119 456,-3095 557,-3095 557,-3119"/>
<text text-anchor="middle" x="506.5" y="-3104.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">partialcoreonmesh</text>
</g>
<!-- proc~dhscf&#45;&gt;partialcoreonmesh -->
<g id="proc~~siesta_forces~~CallsGraph_edge176" class="edge"><title>proc~dhscf&#45;&gt;partialcoreonmesh</title>
<path fill="none" stroke="#000000" d="M338.39,-3472.59C350.164,-3445.06 378.445,-3376.61 395,-3317 417.881,-3234.61 373.207,-3191.02 431,-3128 435.351,-3123.26 440.682,-3119.55 446.475,-3116.66"/>
<polygon fill="#000000" stroke="#000000" points="447.983,-3119.83 455.883,-3112.77 445.304,-3113.36 447.983,-3119.83"/>
</g>
<!-- mymeshbox -->
<g id="proc~~siesta_forces~~CallsGraph_node157" class="node"><title>mymeshbox</title>
<polygon fill="#777777" stroke="#777777" points="541.5,-4211 471.5,-4211 471.5,-4187 541.5,-4187 541.5,-4211"/>
<text text-anchor="middle" x="506.5" y="-4196.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mymeshbox</text>
</g>
<!-- proc~dhscf&#45;&gt;mymeshbox -->
<g id="proc~~siesta_forces~~CallsGraph_edge182" class="edge"><title>proc~dhscf&#45;&gt;mymeshbox</title>
<path fill="none" stroke="#000000" d="M359.12,-3489.26C372.095,-3492.8 386.731,-3499.26 395,-3511 480.499,-3632.34 338.243,-4062.11 431,-4178 438.469,-4187.33 449.741,-4192.71 461.272,-4195.76"/>
<polygon fill="#000000" stroke="#000000" points="460.878,-4199.26 471.383,-4197.89 462.315,-4192.41 460.878,-4199.26"/>
</g>
<!-- neutralatomonmesh -->
<g id="proc~~siesta_forces~~CallsGraph_node158" class="node"><title>neutralatomonmesh</title>
<polygon fill="#777777" stroke="#777777" points="560.5,-4169 452.5,-4169 452.5,-4145 560.5,-4145 560.5,-4169"/>
<text text-anchor="middle" x="506.5" y="-4154.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">neutralatomonmesh</text>
</g>
<!-- proc~dhscf&#45;&gt;neutralatomonmesh -->
<g id="proc~~siesta_forces~~CallsGraph_edge183" class="edge"><title>proc~dhscf&#45;&gt;neutralatomonmesh</title>
<path fill="none" stroke="#000000" d="M359.102,-3489.27C372.073,-3492.82 386.709,-3499.28 395,-3511 475.337,-3624.58 343.87,-4027.54 431,-4136 434.385,-4140.21 438.545,-4143.62 443.153,-4146.37"/>
<polygon fill="#000000" stroke="#000000" points="441.956,-4149.68 452.481,-4150.89 445.009,-4143.38 441.956,-4149.68"/>
</g>
<!-- interface~distmeshdata -->
<g id="proc~~siesta_forces~~CallsGraph_node159" class="node"><title>interface~distmeshdata</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node159"><a xlink:href=".././interface/distmeshdata.html" xlink:title="distMeshData">
<polygon fill="#a7506f" stroke="#a7506f" points="545.5,-2963 467.5,-2963 467.5,-2939 545.5,-2939 545.5,-2963"/>
<text text-anchor="middle" x="506.5" y="-2948.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">distMeshData</text>
</a>
</g>
</g>
<!-- proc~dhscf&#45;&gt;interface~distmeshdata -->
<g id="proc~~siesta_forces~~CallsGraph_edge184" class="edge"><title>proc~dhscf&#45;&gt;interface~distmeshdata</title>
<path fill="none" stroke="#000000" d="M338.759,-3472.68C351.268,-3445.34 380.925,-3377.25 395,-3317 412.285,-3243.01 383.804,-3036.54 431,-2977 437.707,-2968.54 447.345,-2962.82 457.474,-2958.96"/>
<polygon fill="#000000" stroke="#000000" points="458.816,-2962.21 467.256,-2955.81 456.664,-2955.55 458.816,-2962.21"/>
</g>
<!-- mpi_allreduce -->
<g id="proc~~siesta_forces~~CallsGraph_node160" class="node"><title>mpi_allreduce</title>
<polygon fill="#777777" stroke="#777777" points="546,-4127 467,-4127 467,-4103 546,-4103 546,-4127"/>
<text text-anchor="middle" x="506.5" y="-4112.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_allreduce</text>
</g>
<!-- proc~dhscf&#45;&gt;mpi_allreduce -->
<g id="proc~~siesta_forces~~CallsGraph_edge187" class="edge"><title>proc~dhscf&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M359.083,-3489.28C372.048,-3492.84 386.685,-3499.3 395,-3511 470.176,-3616.82 349.496,-3992.98 431,-4094 437.586,-4102.16 447.082,-4107.3 457.101,-4110.5"/>
<polygon fill="#000000" stroke="#000000" points="456.231,-4113.89 466.789,-4113.01 457.985,-4107.11 456.231,-4113.89"/>
</g>
<!-- forhar -->
<g id="proc~~siesta_forces~~CallsGraph_node161" class="node"><title>forhar</title>
<polygon fill="#777777" stroke="#777777" points="533.5,-4085 479.5,-4085 479.5,-4061 533.5,-4061 533.5,-4085"/>
<text text-anchor="middle" x="506.5" y="-4070.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">forhar</text>
</g>
<!-- proc~dhscf&#45;&gt;forhar -->
<g id="proc~~siesta_forces~~CallsGraph_edge188" class="edge"><title>proc~dhscf&#45;&gt;forhar</title>
<path fill="none" stroke="#000000" d="M359.06,-3489.3C372.019,-3492.86 386.657,-3499.32 395,-3511 465.016,-3609.06 355.121,-3958.41 431,-4052 440.261,-4063.42 455.219,-4068.92 469.311,-4071.46"/>
<polygon fill="#000000" stroke="#000000" points="468.941,-4074.95 479.324,-4072.84 469.894,-4068.01 468.941,-4074.95"/>
</g>
<!-- vacuum_level -->
<g id="proc~~siesta_forces~~CallsGraph_node162" class="node"><title>vacuum_level</title>
<polygon fill="#777777" stroke="#777777" points="545.5,-4043 467.5,-4043 467.5,-4019 545.5,-4019 545.5,-4043"/>
<text text-anchor="middle" x="506.5" y="-4028.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">vacuum_level</text>
</g>
<!-- proc~dhscf&#45;&gt;vacuum_level -->
<g id="proc~~siesta_forces~~CallsGraph_edge189" class="edge"><title>proc~dhscf&#45;&gt;vacuum_level</title>
<path fill="none" stroke="#000000" d="M359.034,-3489.32C371.985,-3492.88 386.625,-3499.34 395,-3511 459.857,-3601.3 360.745,-3923.83 431,-4010 437.693,-4018.21 447.325,-4023.35 457.454,-4026.54"/>
<polygon fill="#000000" stroke="#000000" points="456.682,-4029.96 467.237,-4029.04 458.412,-4023.17 456.682,-4029.96"/>
</g>
<!-- localchargeonmesh -->
<g id="proc~~siesta_forces~~CallsGraph_node163" class="node"><title>localchargeonmesh</title>
<polygon fill="#777777" stroke="#777777" points="559.5,-4001 453.5,-4001 453.5,-3977 559.5,-3977 559.5,-4001"/>
<text text-anchor="middle" x="506.5" y="-3986.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">localchargeonmesh</text>
</g>
<!-- proc~dhscf&#45;&gt;localchargeonmesh -->
<g id="proc~~siesta_forces~~CallsGraph_edge191" class="edge"><title>proc~dhscf&#45;&gt;localchargeonmesh</title>
<path fill="none" stroke="#000000" d="M359.003,-3489.34C371.945,-3492.91 386.586,-3499.37 395,-3511 454.7,-3593.54 366.366,-3889.26 431,-3968 434.624,-3972.41 439.097,-3975.94 444.039,-3978.76"/>
<polygon fill="#000000" stroke="#000000" points="442.814,-3982.05 453.357,-3983.09 445.764,-3975.7 442.814,-3982.05"/>
</g>
<!-- vmat -->
<g id="proc~~siesta_forces~~CallsGraph_node164" class="node"><title>vmat</title>
<polygon fill="#777777" stroke="#777777" points="533.5,-3959 479.5,-3959 479.5,-3935 533.5,-3935 533.5,-3959"/>
<text text-anchor="middle" x="506.5" y="-3944.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">vmat</text>
</g>
<!-- proc~dhscf&#45;&gt;vmat -->
<g id="proc~~siesta_forces~~CallsGraph_edge193" class="edge"><title>proc~dhscf&#45;&gt;vmat</title>
<path fill="none" stroke="#000000" d="M359.281,-3489.46C372.135,-3493.05 386.609,-3499.49 395,-3511 449.546,-3585.79 371.985,-3854.68 431,-3926 440.376,-3937.33 455.35,-3942.81 469.423,-3945.37"/>
<polygon fill="#000000" stroke="#000000" points="469.031,-3948.85 479.418,-3946.76 469.996,-3941.92 469.031,-3948.85"/>
</g>
<!-- proc~mixers_history_init&#45;&gt;delete -->
<g id="proc~~siesta_forces~~CallsGraph_edge196" class="edge"><title>proc~mixers_history_init&#45;&gt;delete</title>
<path fill="none" stroke="#000000" d="M382.432,-631.036C410.082,-637.768 443.948,-646.013 469.149,-652.149"/>
<polygon fill="#000000" stroke="#000000" points="468.49,-655.591 479.034,-654.556 470.146,-648.79 468.49,-655.591"/>
</g>
<!-- proc~current_itt -->
<g id="proc~~siesta_forces~~CallsGraph_node143" class="node"><title>proc~current_itt</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node143"><a xlink:href=".././proc/current_itt.html" xlink:title="current_itt">
<polygon fill="#d94e8f" stroke="#d94e8f" points="537,-631 476,-631 476,-607 537,-607 537,-631"/>
<text text-anchor="middle" x="506.5" y="-616.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">current_itt</text>
</a>
</g>
</g>
<!-- proc~mixers_history_init&#45;&gt;proc~current_itt -->
<g id="proc~~siesta_forces~~CallsGraph_edge195" class="edge"><title>proc~mixers_history_init&#45;&gt;proc~current_itt</title>
<path fill="none" stroke="#000000" d="M382.894,-619C409.275,-619 441.21,-619 465.874,-619"/>
<polygon fill="#000000" stroke="#000000" points="465.961,-622.5 475.961,-619 465.961,-615.5 465.961,-622.5"/>
</g>
<!-- new -->
<g id="proc~~siesta_forces~~CallsGraph_node144" class="node"><title>new</title>
<polygon fill="#777777" stroke="#777777" points="533.5,-589 479.5,-589 479.5,-565 533.5,-565 533.5,-589"/>
<text text-anchor="middle" x="506.5" y="-574.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">new</text>
</g>
<!-- proc~mixers_history_init&#45;&gt;new -->
<g id="proc~~siesta_forces~~CallsGraph_edge194" class="edge"><title>proc~mixers_history_init&#45;&gt;new</title>
<path fill="none" stroke="#000000" d="M382.432,-606.964C410.082,-600.232 443.948,-591.987 469.149,-585.851"/>
<polygon fill="#000000" stroke="#000000" points="470.146,-589.21 479.034,-583.444 468.49,-582.409 470.146,-589.21"/>
</g>
<!-- proc~compute_max_diff_1d&#45;&gt;die -->
<g id="proc~~siesta_forces~~CallsGraph_edge197" class="edge"><title>proc~compute_max_diff_1d&#45;&gt;die</title>
<path fill="none" stroke="#000000" d="M695.271,-1467.17C708.733,-1477.67 726.659,-1494.11 736,-1513 786.344,-1614.82 808.092,-1979.91 812.926,-2073.84"/>
<polygon fill="#000000" stroke="#000000" points="809.435,-2074.1 813.433,-2083.91 816.426,-2073.75 809.435,-2074.1"/>
</g>
<!-- proc~check_cohp&#45;&gt;message -->
<g id="proc~~siesta_forces~~CallsGraph_edge198" class="edge"><title>proc~check_cohp&#45;&gt;message</title>
<path fill="none" stroke="#000000" d="M367.298,-1598.89C376.743,-1595.75 386.672,-1591.54 395,-1586 437.475,-1557.76 473.8,-1509.23 492.338,-1481.68"/>
<polygon fill="#000000" stroke="#000000" points="495.345,-1483.48 497.926,-1473.2 489.501,-1479.62 495.345,-1483.48"/>
</g>
<!-- meshlim -->
<g id="proc~~siesta_forces~~CallsGraph_node165" class="node"><title>meshlim</title>
<polygon fill="#777777" stroke="#777777" points="704,-3203 650,-3203 650,-3179 704,-3179 704,-3203"/>
<text text-anchor="middle" x="677" y="-3188.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">meshlim</text>
</g>
<!-- proc~setmeshdistr&#45;&gt;meshlim -->
<g id="proc~~siesta_forces~~CallsGraph_edge199" class="edge"><title>proc~setmeshdistr&#45;&gt;meshlim</title>
<path fill="none" stroke="#000000" d="M544.062,-3191C572.385,-3191 611.429,-3191 639.688,-3191"/>
<polygon fill="#000000" stroke="#000000" points="639.946,-3194.5 649.946,-3191 639.946,-3187.5 639.946,-3194.5"/>
</g>
<!-- proc~reord&#45;&gt;timer -->
<g id="proc~~siesta_forces~~CallsGraph_edge202" class="edge"><title>proc~reord&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M842.377,-2937.22C848.195,-2940.95 853.852,-2945.54 858,-2951 902.878,-3010.13 915.313,-3100.86 918.726,-3142.59"/>
<polygon fill="#000000" stroke="#000000" points="915.25,-3143.05 919.456,-3152.77 922.232,-3142.55 915.25,-3143.05"/>
</g>
<!-- proc~reord&#45;&gt;re_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge200" class="edge"><title>proc~reord&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M825.601,-2912.93C835.037,-2900.54 849.258,-2880.38 858,-2861 874.825,-2823.69 903.289,-2705.75 914.869,-2656.23"/>
<polygon fill="#000000" stroke="#000000" points="918.338,-2656.77 917.195,-2646.23 911.52,-2655.18 918.338,-2656.77"/>
</g>
<!-- proc~reord&#45;&gt;de_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge201" class="edge"><title>proc~reord&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M823.988,-2912.86C841.64,-2886.05 884.144,-2821.47 906.2,-2787.96"/>
<polygon fill="#000000" stroke="#000000" points="909.267,-2789.67 911.841,-2779.39 903.42,-2785.82 909.267,-2789.67"/>
</g>
<!-- proc~distmeshdata_rea -->
<g id="proc~~siesta_forces~~CallsGraph_node166" class="node"><title>proc~distmeshdata_rea</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node166"><a xlink:href=".././proc/distmeshdata_rea.html" xlink:title="distMeshData_rea">
<polygon fill="#d9534f" stroke="#d9534f" points="727,-2963 627,-2963 627,-2939 727,-2939 727,-2963"/>
<text text-anchor="middle" x="677" y="-2948.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">distMeshData_rea</text>
</a>
</g>
</g>
<!-- interface~distmeshdata&#45;&gt;proc~distmeshdata_rea -->
<g id="proc~~siesta_forces~~CallsGraph_edge203" class="edge"><title>interface~distmeshdata&#45;&gt;proc~distmeshdata_rea</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M545.735,-2951C566.627,-2951 592.964,-2951 616.481,-2951"/>
<polygon fill="#000000" stroke="#000000" points="616.709,-2954.5 626.709,-2951 616.709,-2947.5 616.709,-2954.5"/>
</g>
<!-- proc~distmeshdata_int -->
<g id="proc~~siesta_forces~~CallsGraph_node167" class="node"><title>proc~distmeshdata_int</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node167"><a xlink:href=".././proc/distmeshdata_int.html" xlink:title="distMeshData_int">
<polygon fill="#d9534f" stroke="#d9534f" points="724.5,-2781 629.5,-2781 629.5,-2757 724.5,-2757 724.5,-2781"/>
<text text-anchor="middle" x="677" y="-2766.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">distMeshData_int</text>
</a>
</g>
</g>
<!-- interface~distmeshdata&#45;&gt;proc~distmeshdata_int -->
<g id="proc~~siesta_forces~~CallsGraph_edge204" class="edge"><title>interface~distmeshdata&#45;&gt;proc~distmeshdata_int</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M518.817,-2938.78C547.355,-2907.95 622.466,-2826.82 657.507,-2788.98"/>
<polygon fill="#000000" stroke="#000000" points="660.506,-2790.89 664.732,-2781.17 655.37,-2786.13 660.506,-2790.89"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;die -->
<g id="proc~~siesta_forces~~CallsGraph_edge214" class="edge"><title>proc~distmeshdata_rea&#45;&gt;die</title>
<path fill="none" stroke="#000000" d="M683.527,-2938.77C695.257,-2912.27 722.655,-2847.29 736,-2790 796.474,-2530.38 810.606,-2204.81 813.391,-2118.06"/>
<polygon fill="#000000" stroke="#000000" points="816.89,-2118.16 813.695,-2108.06 809.893,-2117.95 816.89,-2118.16"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;timer -->
<g id="proc~~siesta_forces~~CallsGraph_edge210" class="edge"><title>proc~distmeshdata_rea&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M717.679,-2963.11C724.529,-2966.68 731.032,-2971.23 736,-2977 774.834,-3022.11 732.225,-3061.72 772,-3106 779.893,-3114.79 843.139,-3138.11 884.36,-3152.67"/>
<polygon fill="#000000" stroke="#000000" points="883.214,-3155.97 893.809,-3155.99 885.534,-3149.37 883.214,-3155.97"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;re_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge208" class="edge"><title>proc~distmeshdata_rea&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M706.404,-2938.9C746.048,-2920.6 817.635,-2882.18 858,-2828 878.785,-2800.1 904.248,-2700.47 914.918,-2655.87"/>
<polygon fill="#000000" stroke="#000000" points="918.349,-2656.56 917.244,-2646.03 911.537,-2654.95 918.349,-2656.56"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;write_debug -->
<g id="proc~~siesta_forces~~CallsGraph_edge213" class="edge"><title>proc~distmeshdata_rea&#45;&gt;write_debug</title>
<path fill="none" stroke="#000000" d="M687.074,-2963.11C700.309,-2981.47 724.569,-3017.95 736,-3053 777.711,-3180.92 806.318,-3612.47 812.667,-3715.69"/>
<polygon fill="#000000" stroke="#000000" points="809.186,-3716.11 813.287,-3725.88 816.173,-3715.68 809.186,-3716.11"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;de_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge212" class="edge"><title>proc~distmeshdata_rea&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M723.621,-2963.03C763.034,-2970.57 819.55,-2974.19 858,-2946 908.322,-2909.11 918.109,-2828.59 919.804,-2789.37"/>
<polygon fill="#000000" stroke="#000000" points="923.305,-2789.35 920.097,-2779.25 916.308,-2789.15 923.305,-2789.35"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;proc~reord -->
<g id="proc~~siesta_forces~~CallsGraph_edge207" class="edge"><title>proc~distmeshdata_rea&#45;&gt;proc~reord</title>
<path fill="none" stroke="#000000" d="M727.099,-2941.61C743.79,-2938.42 762.132,-2934.92 777.645,-2931.95"/>
<polygon fill="#000000" stroke="#000000" points="778.714,-2935.31 787.878,-2929.99 777.399,-2928.43 778.714,-2935.31"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;mpi_barrier -->
<g id="proc~~siesta_forces~~CallsGraph_edge211" class="edge"><title>proc~distmeshdata_rea&#45;&gt;mpi_barrier</title>
<path fill="none" stroke="#000000" d="M718.225,-2963.06C724.943,-2966.62 731.258,-2971.18 736,-2977 782.608,-3034.16 729.29,-3078.87 772,-3139 773.986,-3141.8 776.377,-3144.35 778.998,-3146.68"/>
<polygon fill="#000000" stroke="#000000" points="777.274,-3149.76 787.374,-3152.96 781.475,-3144.16 777.274,-3149.76"/>
</g>
<!-- mpitrace_event -->
<g id="proc~~siesta_forces~~CallsGraph_node168" class="node"><title>mpitrace_event</title>
<polygon fill="#777777" stroke="#777777" points="858,-3055 772,-3055 772,-3031 858,-3031 858,-3055"/>
<text text-anchor="middle" x="815" y="-3040.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpitrace_event</text>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;mpitrace_event -->
<g id="proc~~siesta_forces~~CallsGraph_edge205" class="edge"><title>proc~distmeshdata_rea&#45;&gt;mpitrace_event</title>
<path fill="none" stroke="#000000" d="M711.219,-2963.05C719.689,-2966.87 728.509,-2971.54 736,-2977 755.33,-2991.09 753.648,-3001.66 772,-3017 775.5,-3019.92 779.358,-3022.76 783.276,-3025.41"/>
<polygon fill="#000000" stroke="#000000" points="781.52,-3028.44 791.828,-3030.89 785.297,-3022.55 781.52,-3028.44"/>
</g>
<!-- nmeshg -->
<g id="proc~~siesta_forces~~CallsGraph_node169" class="node"><title>nmeshg</title>
<polygon fill="#777777" stroke="#777777" points="842,-3097 788,-3097 788,-3073 842,-3073 842,-3097"/>
<text text-anchor="middle" x="815" y="-3082.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nmeshg</text>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;nmeshg -->
<g id="proc~~siesta_forces~~CallsGraph_edge206" class="edge"><title>proc~distmeshdata_rea&#45;&gt;nmeshg</title>
<path fill="none" stroke="#000000" d="M715.937,-2963.01C723.259,-2966.62 730.387,-2971.22 736,-2977 765.156,-3007.02 743.484,-3033.37 772,-3064 774.031,-3066.18 776.339,-3068.17 778.803,-3069.97"/>
<polygon fill="#000000" stroke="#000000" points="777.259,-3073.13 787.606,-3075.41 780.938,-3067.18 777.259,-3073.13"/>
</g>
<!-- proc~boxintersection -->
<g id="proc~~siesta_forces~~CallsGraph_node170" class="node"><title>proc~boxintersection</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node170"><a xlink:href=".././proc/boxintersection.html" xlink:title="boxIntersection">
<polygon fill="#d9534f" stroke="#d9534f" points="857.5,-2819 772.5,-2819 772.5,-2795 857.5,-2795 857.5,-2819"/>
<text text-anchor="middle" x="815" y="-2804.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">boxIntersection</text>
</a>
</g>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;proc~boxintersection -->
<g id="proc~~siesta_forces~~CallsGraph_edge209" class="edge"><title>proc~distmeshdata_rea&#45;&gt;proc~boxintersection</title>
<path fill="none" stroke="#000000" d="M685.638,-2938.82C700.325,-2916.07 734.4,-2866.39 772,-2833 775.246,-2830.12 778.851,-2827.36 782.545,-2824.79"/>
<polygon fill="#000000" stroke="#000000" points="784.729,-2827.54 791.203,-2819.15 780.912,-2821.67 784.729,-2827.54"/>
</g>
<!-- proc~distmeshdata_int&#45;&gt;die -->
<g id="proc~~siesta_forces~~CallsGraph_edge215" class="edge"><title>proc~distmeshdata_int&#45;&gt;die</title>
<path fill="none" stroke="#000000" d="M682.769,-2756.68C693.691,-2728.03 720.748,-2654.52 736,-2591 779.194,-2411.1 804.451,-2188.5 811.764,-2118.29"/>
<polygon fill="#000000" stroke="#000000" points="815.28,-2118.32 812.819,-2108.01 808.316,-2117.6 815.28,-2118.32"/>
</g>
<!-- proc~distmeshdata_int&#45;&gt;re_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge218" class="edge"><title>proc~distmeshdata_int&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M699.903,-2756.78C743.187,-2732.64 839.772,-2678.76 889.348,-2651.1"/>
<polygon fill="#000000" stroke="#000000" points="891.293,-2654.02 898.321,-2646.09 887.883,-2647.91 891.293,-2654.02"/>
</g>
<!-- proc~distmeshdata_int&#45;&gt;de_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge217" class="edge"><title>proc~distmeshdata_int&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M724.66,-2768.61C771.002,-2768.23 841.097,-2767.65 883.514,-2767.3"/>
<polygon fill="#000000" stroke="#000000" points="883.699,-2770.8 893.67,-2767.22 883.641,-2763.8 883.699,-2770.8"/>
</g>
<!-- proc~distmeshdata_int&#45;&gt;proc~boxintersection -->
<g id="proc~~siesta_forces~~CallsGraph_edge216" class="edge"><title>proc~distmeshdata_int&#45;&gt;proc~boxintersection</title>
<path fill="none" stroke="#000000" d="M721.031,-2781.02C734.182,-2784.7 748.779,-2788.78 762.435,-2792.59"/>
<polygon fill="#000000" stroke="#000000" points="761.606,-2795.99 772.179,-2795.31 763.489,-2789.25 761.606,-2795.99"/>
</g>
</g>
</svg>
</div><script>var panprocsiesta_forcesCallsGraph = svgPanZoom('#procsiesta_forcesCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,-0 209.5,-0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.5,-24 454.5,-24 454.5,-0 551.5,-0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/siesta_forces.html#src">siesta_forces</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>  <span class="k">subroutine </span><span class="n">siesta_forces</span><span class="p">(</span><span class="n">istep</span><span class="p">)</span>
  <span class="c">!! This subroutine represents central SIESTA operation logic.</span>

<span class="cp">#ifdef MPI</span>
    <span class="k">use </span><span class="n">mpi_siesta</span>
<span class="cp">#endif</span>
    <span class="k">use </span><span class="n">units</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">eV</span><span class="p">,</span> <span class="n">Ang</span>
    <span class="k">use </span><span class="nb">precision</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">dp</span>
    <span class="k">use </span><span class="n">sys</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">bye</span>

    <span class="k">use </span><span class="n">files</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">slabel</span>
    <span class="k">use </span><span class="n">siesta_cml</span>
<span class="cp">#ifdef SIESTA__FLOOK</span>
    <span class="k">use </span><span class="n">flook_siesta</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">slua_call</span>
    <span class="k">use </span><span class="n">flook_siesta</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">LUA_INIT_MD</span><span class="p">,</span> <span class="n">LUA_SCF_LOOP</span>
    <span class="k">use </span><span class="n">siesta_dicts</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">dict_variable_add</span>
    <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">ts_scf_mixs</span>
    <span class="k">use </span><span class="n">variable</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">cunpack</span>
<span class="cp">#ifndef NCDF_4</span>
    <span class="k">use </span><span class="n">dictionary</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="k">assign</span>
<span class="cp">#endif</span>
    <span class="k">use </span><span class="n">m_mixing</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">mixers_history_init</span>
<span class="cp">#endif</span>
    <span class="k">use </span><span class="n">m_state_init</span>
    <span class="k">use </span><span class="n">m_setup_hamiltonian</span>
    <span class="k">use </span><span class="n">m_setup_H0</span>
    <span class="k">use </span><span class="n">m_compute_dm</span>
    <span class="k">use </span><span class="n">m_compute_max_diff</span>
    <span class="k">use </span><span class="n">m_scfconvergence_test</span>
    <span class="k">use </span><span class="n">m_post_scf_work</span>
    <span class="k">use </span><span class="n">m_mixer</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">mixer</span>
    <span class="k">use </span><span class="n">m_mixing_scf</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">mixing_scf_converged</span>
    <span class="k">use </span><span class="n">m_mixing_scf</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">mixers_scf_history_init</span>
    <span class="k">use </span><span class="n">m_mixing_scf</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">scf_mixs</span><span class="p">,</span> <span class="n">scf_mix</span>

    <span class="k">use </span><span class="n">m_rhog</span><span class="p">,</span>                <span class="n">only</span><span class="p">:</span> <span class="n">mix_rhog</span><span class="p">,</span> <span class="n">compute_charge_diff</span>
    <span class="k">use </span><span class="n">siesta_options</span>
    <span class="k">use </span><span class="n">parallel</span><span class="p">,</span>     <span class="n">only</span> <span class="p">:</span> <span class="n">IOnode</span><span class="p">,</span> <span class="n">SIESTA_worker</span>
    <span class="k">use </span><span class="n">m_state_analysis</span>
    <span class="k">use </span><span class="n">m_steps</span>
    <span class="k">use </span><span class="n">m_spin</span><span class="p">,</span>                <span class="n">only</span><span class="p">:</span> <span class="n">spin</span>
    <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">DM_2D</span><span class="p">,</span> <span class="n">S_1D</span>
    <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">H</span><span class="p">,</span> <span class="n">Hold</span><span class="p">,</span> <span class="n">Dold</span><span class="p">,</span> <span class="n">Dscf</span><span class="p">,</span> <span class="n">Eold</span><span class="p">,</span> <span class="n">Escf</span><span class="p">,</span> <span class="n">maxnh</span>
    <span class="k">use </span><span class="n">m_convergence</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">converger_t</span>
    <span class="k">use </span><span class="n">m_convergence</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">reset</span><span class="p">,</span> <span class="n">set_tolerance</span>
    <span class="k">use </span><span class="n">siesta_geom</span><span class="p">,</span>   <span class="n">only</span><span class="p">:</span> <span class="n">na_u</span>           <span class="c">! Number of atoms in unit cell</span>
    <span class="k">use </span><span class="n">m_energies</span><span class="p">,</span>    <span class="n">only</span><span class="p">:</span> <span class="n">Etot</span>           <span class="c">! Total energy</span>
    <span class="k">use </span><span class="n">m_forces</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">fa</span><span class="p">,</span> <span class="n">cfa</span>        <span class="c">! Forces and constrained forces</span>
    <span class="k">use </span><span class="n">m_stress</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">cstress</span>        <span class="c">! Constrained stress tensor</span>
    <span class="k">use </span><span class="n">siesta_master</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">forcesToMaster</span> <span class="c">! Send forces to master prog</span>
    <span class="k">use </span><span class="n">siesta_master</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">siesta_server</span>  <span class="c">! Is siesta a server?</span>
    <span class="k">use </span><span class="n">m_save_density_matrix</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">save_density_matrix</span>
    <span class="k">use </span><span class="n">m_iodm_old</span><span class="p">,</span>    <span class="n">only</span><span class="p">:</span> <span class="n">write_spmatrix</span>

    <span class="k">use </span><span class="n">atomlist</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span> <span class="n">Qtot</span>
    <span class="k">use </span><span class="n">m_dm_charge</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">dm_charge</span>

    <span class="k">use </span><span class="n">m_pexsi_solver</span><span class="p">,</span>        <span class="n">only</span><span class="p">:</span> <span class="n">prevDmax</span>
    <span class="k">use </span><span class="n">write_subs</span><span class="p">,</span>            <span class="n">only</span><span class="p">:</span> <span class="n">siesta_write_forces</span>
    <span class="k">use </span><span class="n">write_subs</span><span class="p">,</span>            <span class="n">only</span><span class="p">:</span> <span class="n">siesta_write_stress_pressure</span>

<span class="cp">#ifdef NCDF_4</span>
    <span class="k">use </span><span class="n">dictionary</span>
    <span class="k">use </span><span class="n">m_ncdf_siesta</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">cdf_init_file</span><span class="p">,</span> <span class="n">cdf_save_settings</span>
    <span class="k">use </span><span class="n">m_ncdf_siesta</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">cdf_save_state</span><span class="p">,</span> <span class="n">cdf_save_basis</span>
<span class="cp">#endif</span>
    <span class="k">use </span><span class="n">m_compute_energies</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">compute_energies</span>

    <span class="k">use </span><span class="n">m_mpi_utils</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">broadcast</span><span class="p">,</span> <span class="n">barrier</span>
    <span class="k">use </span><span class="n">fdf</span>
<span class="cp">#ifdef SIESTA__PEXSI</span>
    <span class="k">use </span><span class="n">m_pexsi</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">pexsi_finalize_scfloop</span>
<span class="cp">#endif</span>
    <span class="k">use </span><span class="n">m_check_walltime</span>

    <span class="k">use </span><span class="n">m_energies</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">DE_NEGF</span>
    <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">N_Elec</span>
    <span class="k">use </span><span class="n">m_ts_method</span>
    <span class="k">use </span><span class="n">m_ts_global_vars</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">TSmode</span><span class="p">,</span> <span class="n">TSinit</span><span class="p">,</span> <span class="n">TSrun</span>
    <span class="k">use </span><span class="n">siesta_geom</span><span class="p">,</span>           <span class="n">only</span><span class="p">:</span> <span class="n">nsc</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">ucell</span><span class="p">,</span> <span class="n">isc_off</span>
    <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span>       <span class="n">only</span><span class="p">:</span> <span class="n">sparse_pattern</span><span class="p">,</span> <span class="n">block_dist</span>
    <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span>       <span class="n">only</span><span class="p">:</span> <span class="n">S</span>
    <span class="k">use </span><span class="n">m_ts_charge</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">ts_get_charges</span>
    <span class="k">use </span><span class="n">m_ts_charge</span><span class="p">,</span>           <span class="n">only</span><span class="p">:</span> <span class="n">TS_RHOCORR_METHOD</span>
    <span class="k">use </span><span class="n">m_ts_charge</span><span class="p">,</span>           <span class="n">only</span><span class="p">:</span> <span class="n">TS_RHOCORR_FERMI</span>
    <span class="k">use </span><span class="n">m_ts_charge</span><span class="p">,</span>           <span class="n">only</span><span class="p">:</span> <span class="n">TS_RHOCORR_FERMI_TOLERANCE</span>
    <span class="k">use </span><span class="n">m_transiesta</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">transiesta</span>
    <span class="k">use </span><span class="n">kpoint_scf_m</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">gamma_scf</span>
    <span class="k">use </span><span class="n">m_energies</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">Ef</span>

    <span class="k">use </span><span class="n">m_initwf</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">initwf</span>

    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">istep</span>

    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iscf</span>
    <span class="kt">logical</span> <span class="kd">::</span> <span class="n">first_scf</span><span class="p">,</span> <span class="n">SCFconverged</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dDmax</span> <span class="c">! Max. change in DM elements</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dHmax</span> <span class="c">! Max. change in H elements</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dEmax</span> <span class="c">! Max. change in EDM elements</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">drhog</span> <span class="c">! Max. change in rho(G) (experimental)</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">G2max</span> <span class="c">! actually used meshcutoff</span>
    <span class="k">type</span><span class="p">(</span><span class="n">converger_t</span><span class="p">)</span> <span class="kd">::</span>  <span class="n">conv_harris</span><span class="p">,</span> <span class="n">conv_freeE</span>

    <span class="c">! For initwf</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">istpp</span>

<span class="cp">#ifdef SIESTA__FLOOK</span>
    <span class="c">! len=24 from m_mixing.F90</span>
    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">next_mixer</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nnext_mixer</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">imix</span>
<span class="cp">#endif</span>

    <span class="kt">logical</span>               <span class="kd">::</span> <span class="n">time_is_up</span>
    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">tmp_str</span>

    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Qcur</span>
<span class="cp">#ifdef NCDF_4</span>
    <span class="k">type</span><span class="p">(</span><span class="n">dict</span><span class="p">)</span> <span class="kd">::</span> <span class="n">d_sav</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef MPI</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">MPIerror</span>
<span class="cp">#endif</span>

    <span class="k">external</span> <span class="kd">::</span> <span class="n">die</span><span class="p">,</span> <span class="n">message</span>

<span class="cp">#ifdef DEBUG</span>
    <span class="k">call </span><span class="n">write_debug</span><span class="p">(</span> <span class="s1">&#39;    PRE siesta_forces&#39;</span> <span class="p">)</span>
<span class="cp">#endif</span>

<span class="cp">#ifdef SIESTA__PEXSI</span>
    <span class="c">! Broadcast relevant things for program logic</span>
    <span class="c">! These were set in read_options, called only by &quot;SIESTA_workers&quot;.</span>
    <span class="k">call </span><span class="n">broadcast</span><span class="p">(</span><span class="n">nscf</span><span class="p">,</span> <span class="n">comm</span><span class="o">=</span><span class="n">true_MPI_Comm_World</span><span class="p">)</span>
<span class="cp">#endif</span>

    <span class="c">!  Initialization tasks for a given geometry:</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">SIESTA_worker</span> <span class="p">)</span>  <span class="k">then</span>
<span class="k">       call </span><span class="n">state_init</span><span class="p">(</span> <span class="n">istep</span> <span class="p">)</span>
    <span class="k">end if</span>

<span class="cp">#ifdef SIESTA__PEXSI</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ionode</span><span class="p">)</span> <span class="k">call </span><span class="n">memory_snapshot</span><span class="p">(</span><span class="s2">&quot;after state_init&quot;</span><span class="p">)</span>
<span class="cp">#endif</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">fdf_get</span><span class="p">(</span><span class="s2">&quot;Sonly&quot;</span><span class="p">,.</span><span class="n">false</span><span class="p">.)</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">       if</span> <span class="p">(</span> <span class="n">SIESTA_worker</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">          call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="mi">2</span> <span class="p">)</span>
          <span class="k">call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="mi">3</span> <span class="p">)</span>
       <span class="k">end if</span>
<span class="k">       call </span><span class="n">bye</span><span class="p">(</span><span class="s2">&quot;S only&quot;</span><span class="p">)</span>
    <span class="k">end if</span>

<span class="k">    </span><span class="n">Qcur</span> <span class="o">=</span> <span class="n">Qtot</span>
    
<span class="cp">#ifdef SIESTA__FLOOK</span>
    <span class="c">! Add the iscf constant to the list of variables</span>
    <span class="c">! that are available only in this part of the routine.</span>
    <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.iteration&#39;</span><span class="p">,</span><span class="n">iscf</span><span class="p">)</span>
    <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.converged&#39;</span><span class="p">,</span><span class="n">SCFconverged</span><span class="p">)</span>
    <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.charge&#39;</span><span class="p">,</span><span class="n">Qcur</span><span class="p">)</span>
    <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.dD&#39;</span><span class="p">,</span><span class="n">dDmax</span><span class="p">)</span>
    <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.dH&#39;</span><span class="p">,</span><span class="n">dHmax</span><span class="p">)</span>
    <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.dE&#39;</span><span class="p">,</span><span class="n">dEmax</span><span class="p">)</span>
    <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.drhoG&#39;</span><span class="p">,</span><span class="n">drhog</span><span class="p">)</span>
    <span class="c">! We have to set the meshcutoff here</span>
    <span class="c">! because the asked and required ones are not</span>
    <span class="c">! necessarily the same</span>
    <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;Mesh.Cutoff.Minimum&#39;</span><span class="p">,</span><span class="n">G2cut</span><span class="p">)</span>
    <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;Mesh.Cutoff.Used&#39;</span><span class="p">,</span><span class="n">G2max</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">mix_charge</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">      call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Weight&#39;</span><span class="p">,</span> <span class="n">wmix</span><span class="p">)</span>
    <span class="k">else</span>
<span class="k">      call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Weight&#39;</span><span class="p">,</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">w</span><span class="p">)</span>
      <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Restart&#39;</span><span class="p">,</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">restart</span><span class="p">)</span>
      <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Iterations&#39;</span><span class="p">,</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">n_itt</span><span class="p">)</span>
      
      <span class="c">! Just to populate the table in the dictionary</span>
      <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Switch&#39;</span><span class="p">,</span><span class="n">next_mixer</span><span class="p">)</span>
    <span class="k">end if</span>

    <span class="c">! Initialize to no switch</span>
    <span class="n">next_mixer</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
<span class="cp">#endif</span>

    <span class="c">!  This call computes the **non-scf** part of \( H \) and initializes the</span>
    <span class="c">!  real-space grid structures:</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">SIESTA_worker</span> <span class="p">)</span> <span class="k">call </span><span class="n">setup_H0</span><span class="p">(</span><span class="n">G2max</span><span class="p">)</span>
    <span class="c">!!@todo</span>
    <span class="c">!* It might be better to split the two,</span>
    <span class="c">!  putting the grid initialization into **state_init (link!)** and moving the</span>
    <span class="c">!  calculation of \( H_0 \) to the body of the loop, done `if first_scf=.true.`</span>
    <span class="c">!  This would suit _analysis_ runs in which **nscf = 0**</span>
    <span class="c">!!@endtodo</span>

<span class="cp">#ifdef SIESTA__PEXSI</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ionode</span><span class="p">)</span> <span class="k">call </span><span class="n">memory_snapshot</span><span class="p">(</span><span class="s2">&quot;after setup_H0&quot;</span><span class="p">)</span>
<span class="cp">#endif</span>

<span class="cp">#ifdef SIESTA__FLOOK</span>
    <span class="c">! Communicate with lua, just before entering the SCF loop</span>
    <span class="c">! This is mainly to be able to communicate</span>
    <span class="c">! mesh-related quantities (g2max)</span>
    <span class="k">call </span><span class="n">slua_call</span><span class="p">(</span><span class="n">LUA</span><span class="p">,</span> <span class="n">LUA_INIT_MD</span><span class="p">)</span>
<span class="cp">#endif</span>

<span class="cp">#ifdef NCDF_4</span>
    <span class="c">! Initialize the NC file</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">write_cdf</span> <span class="p">)</span> <span class="k">then</span>

       <span class="c">! Initialize the file...</span>
       <span class="k">call </span><span class="n">cdf_init_file</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.nc&#39;</span><span class="p">,</span><span class="n">is_MD</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.)</span>
<span class="cp">#ifdef MPI</span>
       <span class="k">call </span><span class="n">MPI_Barrier</span><span class="p">(</span><span class="n">MPI_Comm_World</span><span class="p">,</span><span class="n">MPIerror</span><span class="p">)</span>
<span class="cp">#endif</span>

       <span class="c">! Save the settings</span>
       <span class="k">call </span><span class="n">cdf_save_settings</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.nc&#39;</span><span class="p">)</span>
<span class="cp">#ifdef MPI</span>
       <span class="k">call </span><span class="n">MPI_Barrier</span><span class="p">(</span><span class="n">MPI_Comm_World</span><span class="p">,</span><span class="n">MPIerror</span><span class="p">)</span>
<span class="cp">#endif</span>
       
       <span class="n">d_sav</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;sp&#39;</span><span class="p">.</span><span class="n">kv</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">.</span><span class="n">kv</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">d_sav</span> <span class="o">=</span> <span class="n">d_sav</span><span class="o">//</span><span class="p">(</span><span class="s1">&#39;nsc&#39;</span><span class="p">.</span><span class="n">kv</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="p">(</span><span class="s1">&#39;xij&#39;</span><span class="p">.</span><span class="n">kv</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">d_sav</span> <span class="o">=</span> <span class="n">d_sav</span><span class="o">//</span><span class="p">(</span><span class="s1">&#39;xa&#39;</span><span class="p">.</span><span class="n">kv</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="p">(</span><span class="s1">&#39;cell&#39;</span><span class="p">.</span><span class="n">kv</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">d_sav</span> <span class="o">=</span> <span class="n">d_sav</span><span class="o">//</span><span class="p">(</span><span class="s1">&#39;isc_off&#39;</span><span class="p">.</span><span class="n">kv</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span>
       <span class="k">call </span><span class="n">cdf_save_state</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.nc&#39;</span><span class="p">,</span><span class="n">d_sav</span><span class="p">)</span>
       <span class="k">call </span><span class="n">delete</span><span class="p">(</span><span class="n">d_sav</span><span class="p">)</span>

       <span class="c">! Save the basis set</span>
       <span class="k">call </span><span class="n">cdf_save_basis</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.nc&#39;</span><span class="p">)</span>

    <span class="k">end if</span>
<span class="cp">#endif</span>

    <span class="c">!* The dHmax variable only has meaning for Hamiltonian</span>
    <span class="c">!  mixing, or when requiring the Hamiltonian to be converged.</span>
    <span class="n">dDmax</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1._dp</span>
    <span class="n">dHmax</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1._dp</span>
    <span class="n">dEmax</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1._dp</span>
    <span class="n">drhog</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1._dp</span>

    <span class="c">! Setup convergence criteria:</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">SIESTA_worker</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">       if</span> <span class="p">(</span> <span class="n">converge_Eharr</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">          call </span><span class="n">reset</span><span class="p">(</span><span class="n">conv_harris</span><span class="p">)</span>
          <span class="k">call </span><span class="n">set_tolerance</span><span class="p">(</span><span class="n">conv_harris</span><span class="p">,</span><span class="n">tolerance_Eharr</span><span class="p">)</span>
       <span class="k">end if</span>
<span class="k">       if</span> <span class="p">(</span> <span class="n">converge_FreeE</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">          call </span><span class="n">reset</span><span class="p">(</span><span class="n">conv_FreeE</span><span class="p">)</span>
          <span class="k">call </span><span class="n">set_tolerance</span><span class="p">(</span><span class="n">conv_FreeE</span><span class="p">,</span><span class="n">tolerance_FreeE</span><span class="p">)</span>
       <span class="k">end if</span>
<span class="k">    end if</span>

    <span class="c">!!# SCF loop</span>
    <span class="c">!* The current structure of the loop tries to reproduce the</span>
    <span class="c">!  historical Siesta usage. It should be made more clear.</span>

    <span class="c">!* Two changes:</span>
    <span class="c">!</span>
    <span class="c">!  1. The number of scf iterations performed is exactly</span>
    <span class="c">!     equal to the number specified (i.e., the &quot;forces&quot;</span>
    <span class="c">!     phase is not counted as a final scf step)</span>
    <span class="c">!  2. At the change to a TranSiesta GF run the variable &quot;first_scf&quot;</span>
    <span class="c">!     is implicitly reset to &quot;true&quot;.</span>
    <span class="c">!</span>

    <span class="c">!!## Start of SCF cycle</span>
    <span class="c">!</span>
    <span class="c">!* Conditions of exit:</span>
    <span class="c">!</span>
    <span class="c">!  * At the top, to catch a non-positive nscf and # of iterations</span>
    <span class="c">!  * At the bottom, based on convergence</span>
    <span class="c">!</span>
    <span class="n">iscf</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">do while</span> <span class="p">(</span> <span class="n">iscf</span> <span class="o">&lt;</span> <span class="n">nscf</span> <span class="p">)</span>

       <span class="n">iscf</span> <span class="o">=</span> <span class="n">iscf</span> <span class="o">+</span> <span class="mi">1</span>

       <span class="c">!* Note implications for TranSiesta when mixing \(H\).</span>
       <span class="c">!  Now \(H\) will be recomputed instead of simply being</span>
       <span class="c">!  inherited, however, this is required as if</span>
       <span class="c">!  we have bias calculations as the electric</span>
       <span class="c">!  field across the junction needs to be present.</span>

       <span class="n">first_scf</span> <span class="o">=</span> <span class="p">(</span><span class="n">iscf</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>

       <span class="k">if</span> <span class="p">(</span> <span class="n">SIESTA_worker</span> <span class="p">)</span> <span class="k">then</span>

          <span class="c">! Check whether we are short of time to continue</span>
          <span class="k">call </span><span class="n">check_walltime</span><span class="p">(</span><span class="n">time_is_up</span><span class="p">)</span>
          <span class="k">if</span> <span class="p">(</span> <span class="n">time_is_up</span> <span class="p">)</span> <span class="k">then</span>
             <span class="c">! Save DM/H if we were not saving it...</span>
             <span class="c">!   Do any other bookeeping not done by &quot;die&quot;</span>
             <span class="k">call </span><span class="n">timer</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
             <span class="k">call </span><span class="n">timer</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
             <span class="k">call </span><span class="n">message</span><span class="p">(</span><span class="s1">&#39;WARNING&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
                  <span class="s1">&#39;SCF_NOT_CONV: SCF did not converge&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
                  <span class="s1">&#39; before wall time exhaustion&#39;</span><span class="p">)</span>
             <span class="k">write</span><span class="p">(</span><span class="n">tmp_str</span><span class="p">,</span><span class="s2">&quot;(2(i5,tr1),f12.6)&quot;</span><span class="p">)</span> <span class="n">istep</span><span class="p">,</span> <span class="n">iscf</span><span class="p">,</span> <span class="n">prevDmax</span>
             <span class="k">call </span><span class="n">message</span><span class="p">(</span><span class="s1">&#39; (info)&#39;</span><span class="p">,</span><span class="s2">&quot;Geom step, scf iteration, dmax:&quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">tmp_str</span><span class="p">))</span>
             
             <span class="k">call </span><span class="n">barrier</span><span class="p">()</span> <span class="c">! A non-root node might get first to the &#39;die&#39; call</span>
             <span class="k">call </span><span class="n">die</span><span class="p">(</span><span class="s2">&quot;OUT_OF_TIME: Time is up.&quot;</span><span class="p">)</span>

          <span class="k">end if</span>

<span class="k">          call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;IterSCF&#39;</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">cml_p</span><span class="p">)</span> <span class="p">&amp;</span>
               <span class="k">call </span><span class="n">cmlStartStep</span><span class="p">(</span> <span class="n">xf</span><span class="o">=</span><span class="n">mainXML</span><span class="p">,</span> <span class="k">type</span><span class="o">=</span><span class="s1">&#39;SCF&#39;</span><span class="p">,</span> <span class="nb">index</span><span class="o">=</span><span class="n">iscf</span> <span class="p">)</span>

          <span class="k">if</span> <span class="p">(</span> <span class="n">mixH</span> <span class="p">)</span> <span class="k">then</span>

<span class="k">             if</span> <span class="p">(</span> <span class="n">first_scf</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">                if</span> <span class="p">(</span><span class="n">fdf_get</span><span class="p">(</span><span class="s2">&quot;Read-H-from-file&quot;</span><span class="p">,.</span><span class="n">false</span><span class="p">.))</span> <span class="k">then</span>
<span class="k">                   call </span><span class="n">get_H_from_file</span><span class="p">()</span>
                <span class="k">else</span>
<span class="k">                   call </span><span class="n">setup_hamiltonian</span><span class="p">(</span> <span class="n">iscf</span> <span class="p">)</span>
                <span class="k">end if</span>
<span class="k">             end if</span>

<span class="k">             call </span><span class="n">compute_DM</span><span class="p">(</span> <span class="n">iscf</span> <span class="p">)</span>

             <span class="c">! Maybe set Dold to zero if reading charge or H...</span>
             <span class="k">call </span><span class="n">compute_max_diff</span><span class="p">(</span><span class="n">Dold</span><span class="p">,</span> <span class="n">Dscf</span><span class="p">,</span> <span class="n">dDmax</span><span class="p">)</span>
             <span class="k">if</span> <span class="p">(</span> <span class="n">converge_EDM</span> <span class="p">)</span> <span class="p">&amp;</span>
                  <span class="k">call </span><span class="n">compute_max_diff</span><span class="p">(</span><span class="n">Eold</span><span class="p">,</span> <span class="n">Escf</span><span class="p">,</span> <span class="n">dEmax</span><span class="p">)</span>
             <span class="k">call </span><span class="n">setup_hamiltonian</span><span class="p">(</span> <span class="n">iscf</span> <span class="p">)</span>
             <span class="k">call </span><span class="n">compute_max_diff</span><span class="p">(</span><span class="n">Hold</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">dHmax</span><span class="p">)</span>

          <span class="k">else</span>

<span class="k">             call </span><span class="n">setup_hamiltonian</span><span class="p">(</span> <span class="n">iscf</span> <span class="p">)</span>
             <span class="k">call </span><span class="n">compute_max_diff</span><span class="p">(</span><span class="n">Hold</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">dHmax</span><span class="p">)</span>

             <span class="k">call </span><span class="n">compute_DM</span><span class="p">(</span> <span class="n">iscf</span> <span class="p">)</span>

             <span class="k">call </span><span class="n">compute_max_diff</span><span class="p">(</span><span class="n">Dold</span><span class="p">,</span> <span class="n">Dscf</span><span class="p">,</span> <span class="n">dDmax</span><span class="p">)</span>
             <span class="k">if</span> <span class="p">(</span> <span class="n">converge_EDM</span> <span class="p">)</span> <span class="p">&amp;</span>
                  <span class="k">call </span><span class="n">compute_max_diff</span><span class="p">(</span><span class="n">Eold</span><span class="p">,</span> <span class="n">Escf</span><span class="p">,</span> <span class="n">dEmax</span><span class="p">)</span>

          <span class="k">end if</span>

          <span class="c">! This iteration has completed calculating the new DM</span>

          <span class="k">call </span><span class="n">compute_energies</span><span class="p">(</span> <span class="n">iscf</span> <span class="p">)</span>
          <span class="k">if</span> <span class="p">(</span> <span class="n">mix_charge</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">             call </span><span class="n">compute_charge_diff</span><span class="p">(</span> <span class="n">drhog</span> <span class="p">)</span>
          <span class="k">end if</span>

          <span class="c">! Note: For DM and H convergence checks. At this point:</span>
          <span class="c">! If mixing the DM:</span>
          <span class="c">!        Dscf=DM_out, Dold=DM_in(mixed), H=H_in, Hold=H_in(prev step)</span>
          <span class="c">!        dDmax=maxdiff(DM_out,DM_in)</span>
          <span class="c">!        dHmax=maxdiff(H_in - H_in(prev step))</span>
          <span class="c">! If mixing the Hamiltonian:</span>
          <span class="c">!        Dscf=DM_out, Dold=DM_in, H=H_(DM_out), Hold=H_in(mixed)</span>
          <span class="c">!        dDmax=maxdiff(DM_out,DM_in)</span>
          <span class="c">!        dHmax=maxdiff(H(DM_out),H_in)</span>
          <span class="k">call </span><span class="n">scfconvergence_test</span><span class="p">(</span> <span class="n">first_scf</span><span class="p">,</span> <span class="n">iscf</span><span class="p">,</span> <span class="p">&amp;</span>
               <span class="n">dDmax</span><span class="p">,</span> <span class="n">dHmax</span><span class="p">,</span> <span class="n">dEmax</span><span class="p">,</span> <span class="p">&amp;</span>
               <span class="n">conv_harris</span><span class="p">,</span> <span class="n">conv_freeE</span><span class="p">,</span> <span class="p">&amp;</span>
               <span class="n">SCFconverged</span> <span class="p">)</span>

          <span class="c">! ** Check this heuristic</span>
          <span class="k">if</span> <span class="p">(</span> <span class="n">mixH</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">             </span><span class="n">prevDmax</span> <span class="o">=</span> <span class="n">dHmax</span>
          <span class="k">else</span>
<span class="k">             </span><span class="n">prevDmax</span> <span class="o">=</span> <span class="n">dDmax</span>
          <span class="k">end if</span>

          <span class="c">! Calculate current charge based on the density matrix</span>
          <span class="k">call </span><span class="n">dm_charge</span><span class="p">(</span><span class="n">spin</span><span class="p">,</span> <span class="n">DM_2D</span><span class="p">,</span> <span class="n">S_1D</span><span class="p">,</span> <span class="n">Qcur</span><span class="p">)</span>


          <span class="c">! Check whether we should step to the next mixer</span>
          <span class="k">call </span><span class="n">mixing_scf_converged</span><span class="p">(</span> <span class="n">SCFconverged</span> <span class="p">)</span>

          <span class="k">if</span> <span class="p">(</span> <span class="n">SCFconverged</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">iscf</span> <span class="o">&lt;</span> <span class="n">min_nscf</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">             </span><span class="n">SCFconverged</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
             <span class="k">if</span> <span class="p">(</span> <span class="n">IONode</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">                write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s2">&quot;(a,i0)&quot;</span><span class="p">)</span> <span class="p">&amp;</span>
                     <span class="s2">&quot;SCF cycle continued for minimum number of iterations: &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">min_nscf</span>
             <span class="k">end if</span>
<span class="k">          end if</span>

          <span class="c">! In case the user has requested a Fermi-level correction</span>
          <span class="c">! Then we start by correcting the fermi-level</span>
          <span class="k">if</span> <span class="p">(</span> <span class="n">TSrun</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">SCFconverged</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
               <span class="n">TS_RHOCORR_METHOD</span> <span class="o">==</span> <span class="n">TS_RHOCORR_FERMI</span> <span class="p">)</span> <span class="k">then</span>

<span class="k">             if</span> <span class="p">(</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Qcur</span> <span class="o">-</span> <span class="n">Qtot</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">TS_RHOCORR_FERMI_TOLERANCE</span> <span class="p">)</span> <span class="k">then</span>

                <span class="c">! Call transiesta with fermi-correct</span>
                <span class="k">call </span><span class="n">transiesta</span><span class="p">(</span><span class="n">iscf</span><span class="p">,</span><span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">block_dist</span><span class="p">,</span> <span class="n">sparse_pattern</span><span class="p">,</span> <span class="n">Gamma_Scf</span><span class="p">,</span> <span class="n">ucell</span><span class="p">,</span> <span class="n">nsc</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">isc_off</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">Dscf</span><span class="p">,</span> <span class="n">Escf</span><span class="p">,</span> <span class="n">Ef</span><span class="p">,</span> <span class="n">Qtot</span><span class="p">,</span> <span class="p">.</span><span class="n">true</span><span class="p">.,</span> <span class="n">DE_NEGF</span><span class="p">)</span>

                <span class="c">! We will not have not converged as we have just</span>
                <span class="c">! changed the Fermi-level</span>
                <span class="n">SCFconverged</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>

             <span class="k">end if</span>

<span class="k">          end if</span>

<span class="k">          if</span> <span class="p">(</span> <span class="n">monitor_forces_in_scf</span> <span class="p">)</span> <span class="k">call </span><span class="n">compute_forces</span><span class="p">()</span>

          <span class="c">! Mix_after_convergence preserves the old behavior of</span>
          <span class="c">! the program.</span>
          <span class="k">if</span> <span class="p">(</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SCFconverged</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">mix_after_convergence</span><span class="p">)</span> <span class="k">then</span>

             <span class="c">! Mix for next step</span>
             <span class="k">if</span> <span class="p">(</span> <span class="n">mix_charge</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">                call </span><span class="n">mix_rhog</span><span class="p">(</span> <span class="n">iscf</span> <span class="p">)</span>
             <span class="k">else</span>
<span class="k">                call </span><span class="n">mixer</span><span class="p">(</span> <span class="n">iscf</span> <span class="p">)</span>
             <span class="k">end if</span>

             <span class="c">! Save for possible restarts</span>
             <span class="k">if</span> <span class="p">(</span> <span class="n">mixH</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">                call </span><span class="n">write_spmatrix</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="k">file</span><span class="o">=</span><span class="s2">&quot;H_MIXED&quot;</span><span class="p">,</span><span class="n">when</span><span class="o">=</span><span class="n">writeH</span><span class="p">)</span>
                <span class="k">call </span><span class="n">save_density_matrix</span><span class="p">(</span><span class="k">file</span><span class="o">=</span><span class="s2">&quot;DM_OUT&quot;</span><span class="p">,</span><span class="n">when</span><span class="o">=</span><span class="n">writeDM</span><span class="p">)</span>
             <span class="k">else</span>
<span class="k">                call </span><span class="n">save_density_matrix</span><span class="p">(</span><span class="k">file</span><span class="o">=</span><span class="s2">&quot;DM_MIXED&quot;</span><span class="p">,</span><span class="n">when</span><span class="o">=</span><span class="n">writeDM</span><span class="p">)</span>
                <span class="k">call </span><span class="n">write_spmatrix</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="k">file</span><span class="o">=</span><span class="s2">&quot;H_DMGEN&quot;</span><span class="p">,</span><span class="n">when</span><span class="o">=</span><span class="n">writeH</span><span class="p">)</span>
             <span class="k">end if</span>
<span class="k">          end if</span>

<span class="k">          call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;IterSCF&#39;</span><span class="p">,</span> <span class="mi">2</span> <span class="p">)</span>
          <span class="k">call </span><span class="n">print_timings</span><span class="p">(</span> <span class="n">first_scf</span><span class="p">,</span> <span class="n">istep</span> <span class="o">==</span> <span class="n">inicoor</span> <span class="p">)</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">cml_p</span><span class="p">)</span> <span class="k">call </span><span class="n">cmlEndStep</span><span class="p">(</span><span class="n">mainXML</span><span class="p">)</span>

<span class="cp">#ifdef SIESTA__FLOOK</span>
          <span class="c">! Communicate with lua</span>
          <span class="k">call </span><span class="n">slua_call</span><span class="p">(</span><span class="n">LUA</span><span class="p">,</span> <span class="n">LUA_SCF_LOOP</span><span class="p">)</span>

          <span class="c">! Retrieve an easy character string</span>
          <span class="n">nnext_mixer</span> <span class="o">=</span> <span class="n">cunpack</span><span class="p">(</span><span class="n">next_mixer</span><span class="p">)</span>
          <span class="k">if</span> <span class="p">(</span> <span class="nb">len_trim</span><span class="p">(</span><span class="n">nnext_mixer</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">mix_charge</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">             if</span> <span class="p">(</span> <span class="n">TSrun</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">                do </span><span class="n">imix</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">ts_scf_mixs</span><span class="p">)</span>
                   <span class="k">if</span> <span class="p">(</span> <span class="n">ts_scf_mixs</span><span class="p">(</span><span class="n">imix</span><span class="p">)%</span><span class="n">name</span> <span class="o">==</span> <span class="n">nnext_mixer</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">                      call </span><span class="n">mixers_history_init</span><span class="p">(</span><span class="n">ts_scf_mixs</span><span class="p">)</span>
                      <span class="n">scf_mix</span> <span class="o">=&gt;</span> <span class="n">ts_scf_mixs</span><span class="p">(</span><span class="n">imix</span><span class="p">)</span>
                      <span class="k">exit</span>
<span class="k">                   end if</span>
<span class="k">                end do</span>
<span class="k">             else</span>
<span class="k">                do </span><span class="n">imix</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">scf_mixs</span><span class="p">)</span>
                   <span class="k">if</span> <span class="p">(</span> <span class="n">scf_mixs</span><span class="p">(</span><span class="n">imix</span><span class="p">)%</span><span class="n">name</span> <span class="o">==</span> <span class="n">nnext_mixer</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">                      call </span><span class="n">mixers_history_init</span><span class="p">(</span><span class="n">scf_mixs</span><span class="p">)</span>
                      <span class="n">scf_mix</span> <span class="o">=&gt;</span> <span class="n">scf_mixs</span><span class="p">(</span><span class="n">imix</span><span class="p">)</span>
                      <span class="k">exit</span>
<span class="k">                   end if</span>
<span class="k">                end do</span>
<span class="k">             end if</span>

             <span class="c">! Check that we indeed have changed the mixer</span>
             <span class="k">if</span> <span class="p">(</span> <span class="n">IONode</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">scf_mix</span><span class="p">%</span><span class="n">name</span> <span class="o">/=</span> <span class="n">nnext_mixer</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">                write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(2a)&#39;</span><span class="p">)</span> <span class="s1">&#39;siesta-lua: WARNING: trying to change &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="s1">&#39;to a non-existing mixer! Not changing anything!&#39;</span>

             <span class="k">else if</span> <span class="p">(</span> <span class="n">IONode</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">                write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(2a)&#39;</span><span class="p">)</span> <span class="s1">&#39;siesta-lua: Switching mixer method to: &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="nb">trim</span><span class="p">(</span><span class="n">nnext_mixer</span><span class="p">)</span>

             <span class="k">end if</span>
             <span class="c">! Reset for next loop</span>
             <span class="n">next_mixer</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>

             <span class="c">! Update the references</span>
             <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Weight&#39;</span><span class="p">,</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">w</span><span class="p">)</span>
             <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Restart&#39;</span><span class="p">,</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">restart</span><span class="p">)</span>
             <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Iterations&#39;</span><span class="p">,</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">n_itt</span><span class="p">)</span>

          <span class="k">end if</span>
<span class="cp">#endif</span>

          <span class="c">! ... except that we might continue for TranSiesta</span>
          <span class="k">if</span> <span class="p">(</span> <span class="n">SCFconverged</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">             call </span><span class="n">transiesta_switch</span><span class="p">()</span>
             <span class="c">! might reset SCFconverged and iscf</span>
          <span class="k">end if</span>

<span class="k">       else</span>

          <span class="c">! non-siesta worker</span>
          <span class="k">call </span><span class="n">compute_DM</span><span class="p">(</span> <span class="n">iscf</span> <span class="p">)</span>

       <span class="k">end if</span>

<span class="cp">#ifdef SIESTA__PEXSI</span>
       <span class="k">call </span><span class="n">broadcast</span><span class="p">(</span><span class="n">iscf</span><span class="p">,</span> <span class="n">comm</span><span class="o">=</span><span class="n">true_MPI_Comm_World</span><span class="p">)</span>
       <span class="k">call </span><span class="n">broadcast</span><span class="p">(</span><span class="n">SCFconverged</span><span class="p">,</span> <span class="n">comm</span><span class="o">=</span><span class="n">true_MPI_Comm_World</span><span class="p">)</span>
<span class="cp">#endif</span>

       <span class="c">!  Exit if converged:</span>
       <span class="k">if</span> <span class="p">(</span> <span class="n">SCFconverged</span> <span class="p">)</span> <span class="k">exit</span>

<span class="k">    end do</span>
    <span class="c">!! **end of SCF cycle**</span>

<span class="cp">#ifdef SIESTA__PEXSI</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">isolve</span> <span class="o">==</span> <span class="n">SOLVE_PEXSI</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">       call </span><span class="n">pexsi_finalize_scfloop</span><span class="p">()</span>
    <span class="k">end if</span>
<span class="cp">#endif</span>

    <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SIESTA_worker</span> <span class="p">)</span> <span class="k">return</span>

<span class="k">    call </span><span class="n">end_of_cycle_save_operations</span><span class="p">()</span>

    <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SCFconverged</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">       if</span> <span class="p">(</span> <span class="n">SCFMustConverge</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">          call </span><span class="n">message</span><span class="p">(</span><span class="s1">&#39;FATAL&#39;</span><span class="p">,</span><span class="s1">&#39;SCF_NOT_CONV: SCF did not converge&#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
               <span class="s1">&#39; in maximum number of steps (required).&#39;</span><span class="p">)</span>
          <span class="k">write</span><span class="p">(</span><span class="n">tmp_str</span><span class="p">,</span><span class="s2">&quot;(2(i5,tr1),f12.6)&quot;</span><span class="p">)</span> <span class="n">istep</span><span class="p">,</span> <span class="n">iscf</span><span class="p">,</span> <span class="n">prevDmax</span>
          <span class="k">call </span><span class="n">message</span><span class="p">(</span><span class="s1">&#39; (info)&#39;</span><span class="p">,</span><span class="s2">&quot;Geom step, scf iteration, dmax:&quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">tmp_str</span><span class="p">))</span>
          <span class="k">call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="mi">2</span> <span class="p">)</span> <span class="c">! New call to close the tree</span>
          <span class="k">call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="mi">3</span> <span class="p">)</span>
          <span class="k">call </span><span class="n">barrier</span><span class="p">()</span>
          <span class="k">call </span><span class="n">die</span><span class="p">(</span><span class="s1">&#39;ABNORMAL_TERMINATION&#39;</span><span class="p">)</span>
       <span class="k">else if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">harrisfun</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">          call </span><span class="n">message</span><span class="p">(</span><span class="s1">&#39;WARNING&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
               <span class="s1">&#39;SCF_NOT_CONV: SCF did not converge  in maximum number of steps.&#39;</span><span class="p">)</span>
          <span class="k">write</span><span class="p">(</span><span class="n">tmp_str</span><span class="p">,</span><span class="s2">&quot;(2(i5,tr1),f12.6)&quot;</span><span class="p">)</span> <span class="n">istep</span><span class="p">,</span> <span class="n">iscf</span><span class="p">,</span> <span class="n">prevDmax</span>
          <span class="k">call </span><span class="n">message</span><span class="p">(</span><span class="s1">&#39; (info)&#39;</span><span class="p">,</span><span class="s2">&quot;Geom step, scf iteration, dmax:&quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">tmp_str</span><span class="p">))</span>
       <span class="k">end if</span>
<span class="k">    end if</span>

    <span class="c">! To write the initial wavefunctions to be used in a</span>
    <span class="c">! consequent TDDFT run.</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">writetdwf</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">       </span><span class="n">istpp</span> <span class="o">=</span> <span class="mi">0</span>
       <span class="k">call </span><span class="n">initwf</span><span class="p">(</span><span class="n">istpp</span><span class="p">,</span><span class="n">totime</span><span class="p">)</span>
    <span class="k">end if</span>
<span class="k">    </span>
<span class="k">    if</span> <span class="p">(</span> <span class="n">TSmode</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">TSinit</span><span class="p">.</span><span class="nb">and</span><span class="p">.(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SCFConverged</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
       <span class="c">! Signal that the DM hasn&#39;t converged, so we cannot</span>
       <span class="c">! continue to the transiesta routines</span>
       <span class="k">call </span><span class="n">die</span><span class="p">(</span><span class="s1">&#39;ABNORMAL_TERMINATION&#39;</span><span class="p">)</span>
    <span class="k">end if</span>
    
    <span class="c">! Clean-up here to limit memory usage</span>
    <span class="k">call </span><span class="n">mixers_scf_history_init</span><span class="p">(</span> <span class="p">)</span>
    
    <span class="c">! End of standard SCF loop.</span>
    <span class="c">! Do one more pass to compute forces and stresses</span>
    
    <span class="c">! Note that this call will no longer overwrite H while computing the</span>
    <span class="c">! final energies, forces and stresses...</span>
    
    <span class="k">if</span> <span class="p">(</span> <span class="n">fdf_get</span><span class="p">(</span><span class="s2">&quot;compute-forces&quot;</span><span class="p">,.</span><span class="n">true</span><span class="p">.)</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">       call </span><span class="n">post_scf_work</span><span class="p">(</span> <span class="n">istep</span><span class="p">,</span> <span class="n">iscf</span> <span class="p">,</span> <span class="n">SCFconverged</span> <span class="p">)</span>
<span class="cp">#ifdef SIESTA__PEXSI</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">ionode</span><span class="p">)</span> <span class="k">call </span><span class="n">memory_snapshot</span><span class="p">(</span><span class="s2">&quot;after post_scf_work&quot;</span><span class="p">)</span>
<span class="cp">#endif</span>
    <span class="k">end if</span>
    
    <span class="c">! ... so H at this point is the latest generator of the DM, except</span>
    <span class="c">! if mixing H beyond self-consistency or terminating the scf loop</span>
    <span class="c">! without convergence while mixing H</span>
    
    <span class="k">call </span><span class="n">state_analysis</span><span class="p">(</span> <span class="n">istep</span> <span class="p">)</span>
<span class="cp">#ifdef SIESTA__PEXSI</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ionode</span><span class="p">)</span> <span class="k">call </span><span class="n">memory_snapshot</span><span class="p">(</span><span class="s2">&quot;after state_analysis&quot;</span><span class="p">)</span>
<span class="cp">#endif</span>

    <span class="c">! If siesta is running as a subroutine, send forces to master program</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">siesta_server</span><span class="p">)</span> <span class="p">&amp;</span>
         <span class="k">call </span><span class="n">forcesToMaster</span><span class="p">(</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">Etot</span><span class="p">,</span> <span class="n">cfa</span><span class="p">,</span> <span class="n">cstress</span> <span class="p">)</span>

<span class="cp">#ifdef DEBUG</span>
    <span class="k">call </span><span class="n">write_debug</span><span class="p">(</span> <span class="s1">&#39;    POS siesta_forces&#39;</span> <span class="p">)</span>
<span class="cp">#endif</span>
    
  <span class="k">contains</span>

    <span class="c">! Read the Hamiltonian from a file</span>
    <span class="k">subroutine </span><span class="n">get_H_from_file</span><span class="p">()</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">listhptr</span>
      <span class="k">use </span><span class="n">atomlist</span><span class="p">,</span>        <span class="n">only</span><span class="p">:</span> <span class="n">no_l</span>
      <span class="k">use </span><span class="n">m_spin</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">spin</span>
      <span class="k">use </span><span class="n">m_iodm_old</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">read_spmatrix</span>

      <span class="kt">logical</span> <span class="kd">::</span> <span class="n">found</span>

      <span class="k">call </span><span class="n">read_spmatrix</span><span class="p">(</span><span class="n">maxnh</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="p">&amp;</span>
           <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">userfile</span><span class="o">=</span><span class="s2">&quot;H_IN&quot;</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">found</span><span class="p">)</span> <span class="k">call </span><span class="n">die</span><span class="p">(</span><span class="s2">&quot;Could not find H_IN&quot;</span><span class="p">)</span>

    <span class="k">end subroutine </span><span class="n">get_H_from_file</span>

    <span class="c">! Computes forces and stresses with the current DM_out</span>
    <span class="k">subroutine </span><span class="n">compute_forces</span><span class="p">()</span>

      <span class="k">use </span><span class="n">siesta_options</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">recompute_H_after_scf</span>
      <span class="k">use </span><span class="n">m_final_H_f_stress</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">final_H_f_stress</span>
      <span class="k">use </span><span class="n">write_subs</span>

      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">fa_old</span><span class="p">(:,:),</span> <span class="n">Hsave</span><span class="p">(:,:)</span>

      <span class="k">allocate</span><span class="p">(</span><span class="n">fa_old</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">fa</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">fa</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)))</span>
      <span class="n">fa_old</span><span class="p">(:,:)</span> <span class="o">=</span> <span class="n">fa</span><span class="p">(:,:)</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">recompute_H_after_scf</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">         allocate</span><span class="p">(</span><span class="n">Hsave</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)))</span>
         <span class="n">Hsave</span><span class="p">(:,:)</span> <span class="o">=</span> <span class="n">H</span><span class="p">(:,:)</span>
      <span class="k">end if</span>
<span class="k">      call </span><span class="n">final_H_f_stress</span><span class="p">(</span> <span class="n">istep</span> <span class="p">,</span> <span class="n">iscf</span> <span class="p">,</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">recompute_H_after_scf</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">         </span><span class="n">H</span><span class="p">(:,:)</span> <span class="o">=</span> <span class="n">Hsave</span><span class="p">(:,:)</span>
         <span class="k">deallocate</span><span class="p">(</span><span class="n">Hsave</span><span class="p">)</span>
      <span class="k">end if</span>
<span class="k">      if</span> <span class="p">(</span><span class="n">ionode</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         print</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;Max diff in force (eV/Ang): &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
              <span class="nb">maxval</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">fa</span><span class="o">-</span><span class="n">fa_old</span><span class="p">))</span><span class="o">*</span><span class="n">Ang</span><span class="o">/</span><span class="n">eV</span>
         <span class="k">call </span><span class="n">siesta_write_forces</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
         <span class="k">call </span><span class="n">siesta_write_stress_pressure</span><span class="p">()</span>
      <span class="n">endif</span>
      <span class="k">deallocate</span><span class="p">(</span><span class="n">fa_old</span><span class="p">)</span>

    <span class="k">end subroutine </span><span class="n">compute_forces</span>

    <span class="c">! Print out timings of the first SCF loop only</span>
    <span class="k">subroutine </span><span class="n">print_timings</span><span class="p">(</span><span class="n">first_scf</span><span class="p">,</span> <span class="n">first_md</span><span class="p">)</span>
      <span class="k">use </span><span class="n">timer_options</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">use_tree_timer</span>
      <span class="k">use </span><span class="n">m_ts_global_vars</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">TSrun</span>
      <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">first_scf</span><span class="p">,</span> <span class="n">first_md</span>
      <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="kd">::</span> <span class="n">routine</span>

      <span class="c">! If this is not the first iteration,</span>
      <span class="c">! we immediately return.</span>
      <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">first_scf</span> <span class="p">)</span> <span class="k">return</span>
<span class="k">      if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">first_md</span> <span class="p">)</span> <span class="k">return</span>

<span class="k">      </span><span class="n">routine</span> <span class="o">=</span> <span class="s1">&#39;IterSCF&#39;</span>

      <span class="k">if</span> <span class="p">(</span> <span class="n">TSrun</span> <span class="p">)</span> <span class="k">then</span>
         <span class="c">! with Green function generation</span>
         <span class="c">! The tree-timer requires direct</span>
         <span class="c">! children of the routine to be</span>
         <span class="c">! queried.</span>
         <span class="c">! This is not obeyed in the TS case... :(</span>
         <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">use_tree_timer</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            </span><span class="n">routine</span> <span class="o">=</span> <span class="s1">&#39;TS&#39;</span>
         <span class="k">end if</span>
<span class="k">      </span><span class="n">endif</span>
      <span class="k">call </span><span class="n">timer</span><span class="p">(</span> <span class="n">routine</span><span class="p">,</span> <span class="mi">3</span> <span class="p">)</span>

    <span class="k">end subroutine </span><span class="n">print_timings</span>

    <span class="c">! Depending on various conditions, save the DMin</span>
    <span class="c">! or the DMout, and possibly keep a copy of H</span>

    <span class="c">! NOTE: Only if the scf cycle converged before exit it</span>
    <span class="c">! is guaranteed that the DM is &quot;pure out&quot; and that</span>
    <span class="c">! we can recover the right H if mixing H.</span>
    <span class="c">!</span>
    <span class="k">subroutine </span><span class="n">end_of_cycle_save_operations</span><span class="p">()</span>

      <span class="kt">logical</span> <span class="kd">::</span> <span class="n">DM_write</span><span class="p">,</span> <span class="n">H_write</span>

      <span class="c">! Depending on the option we should overwrite the</span>
      <span class="c">! Hamiltonian</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">mixH</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">mix_after_convergence</span> <span class="p">)</span> <span class="k">then</span>
         <span class="c">! Make sure that we keep the H actually used</span>
         <span class="c">! to generate the last DM, if needed.</span>
         <span class="n">H</span> <span class="o">=</span> <span class="n">Hold</span>
      <span class="k">end if</span>

<span class="k">      </span><span class="n">DM_write</span> <span class="o">=</span> <span class="n">write_DM_at_end_of_cycle</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
           <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">writeDM</span>
      <span class="n">H_write</span> <span class="o">=</span> <span class="n">write_H_at_end_of_cycle</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
           <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">writeH</span>

      <span class="k">if</span> <span class="p">(</span> <span class="n">mix_after_convergence</span> <span class="p">)</span> <span class="k">then</span>
         <span class="c">! If we have been saving them, there is no point in doing</span>
         <span class="c">! it one more time</span>
         <span class="k">if</span> <span class="p">(</span> <span class="n">mixH</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            call </span><span class="n">save_density_matrix</span><span class="p">(</span><span class="k">file</span><span class="o">=</span><span class="s2">&quot;DM_OUT&quot;</span><span class="p">,</span> <span class="n">when</span><span class="o">=</span><span class="n">DM_write</span><span class="p">)</span>
            <span class="k">call </span><span class="n">write_spmatrix</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="k">file</span><span class="o">=</span><span class="s2">&quot;H_MIXED&quot;</span><span class="p">,</span> <span class="n">when</span><span class="o">=</span><span class="n">H_write</span><span class="p">)</span>
         <span class="k">else</span>
<span class="k">            call </span><span class="n">save_density_matrix</span><span class="p">(</span><span class="k">file</span><span class="o">=</span><span class="s2">&quot;DM_MIXED&quot;</span><span class="p">,</span> <span class="n">when</span><span class="o">=</span><span class="n">DM_write</span><span class="p">)</span>
            <span class="k">call </span><span class="n">write_spmatrix</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="k">file</span><span class="o">=</span><span class="s2">&quot;H_DMGEN&quot;</span><span class="p">,</span> <span class="n">when</span><span class="o">=</span><span class="n">H_write</span><span class="p">)</span>
         <span class="k">end if</span>
<span class="k">      else</span>
<span class="k">         call </span><span class="n">save_density_matrix</span><span class="p">(</span><span class="k">file</span><span class="o">=</span><span class="s2">&quot;DM_OUT&quot;</span><span class="p">,</span> <span class="n">when</span><span class="o">=</span><span class="n">DM_write</span><span class="p">)</span>
         <span class="k">call </span><span class="n">write_spmatrix</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="k">file</span><span class="o">=</span><span class="s2">&quot;H_DMGEN&quot;</span><span class="p">,</span> <span class="n">when</span><span class="o">=</span><span class="n">H_write</span><span class="p">)</span>
      <span class="k">end if</span>

<span class="k">    end subroutine </span><span class="n">end_of_cycle_save_operations</span>

    <span class="k">subroutine </span><span class="n">transiesta_switch</span><span class="p">()</span>

      <span class="k">use </span><span class="nb">precision</span><span class="p">,</span>             <span class="n">only</span><span class="p">:</span> <span class="n">dp</span>
      <span class="k">use </span><span class="n">parallel</span><span class="p">,</span>              <span class="n">only</span><span class="p">:</span> <span class="n">IONode</span>
      <span class="k">use </span><span class="n">class_dSpData2D</span>
      <span class="k">use </span><span class="n">class_Fstack_dData1D</span>
      <span class="k">use </span><span class="n">densematrix</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">resetDenseMatrix</span>

      <span class="k">use </span><span class="n">siesta_options</span><span class="p">,</span>        <span class="n">only</span><span class="p">:</span> <span class="n">fire_mix</span><span class="p">,</span> <span class="n">broyden_maxit</span>
      <span class="k">use </span><span class="n">siesta_options</span><span class="p">,</span>        <span class="n">only</span><span class="p">:</span> <span class="n">dDtol</span><span class="p">,</span> <span class="n">dHtol</span>

      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">DM_2D</span><span class="p">,</span> <span class="n">EDM_2D</span>
      <span class="k">use </span><span class="n">atomlist</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">lasto</span>
      <span class="k">use </span><span class="n">siesta_geom</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">nsc</span><span class="p">,</span> <span class="n">isc_off</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">ucell</span>
      <span class="k">use </span><span class="n">m_energies</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">Ef</span>
      <span class="k">use </span><span class="n">m_mixing</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">mixers_history_init</span>
      <span class="k">use </span><span class="n">m_mixing_scf</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">scf_mix</span><span class="p">,</span> <span class="n">scf_mixs</span>
      <span class="k">use </span><span class="n">m_rhog</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">resetRhoG</span>

      <span class="k">use </span><span class="n">m_ts_global_vars</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">TSinit</span><span class="p">,</span> <span class="n">TSrun</span>
      <span class="k">use </span><span class="n">m_ts_global_vars</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">ts_print_transiesta</span>
      <span class="k">use </span><span class="n">m_ts_method</span>
      <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">N_Elec</span><span class="p">,</span> <span class="n">Elecs</span>
      <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">DM_bulk</span>
      <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">val_swap</span>
      <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">ts_Dtol</span><span class="p">,</span> <span class="n">ts_Htol</span>
      <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">ts_hist_keep</span>
      <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">ts_siesta_stop</span>
      <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">ts_scf_mixs</span>
      <span class="k">use </span><span class="n">m_ts_electype</span>

      <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iEl</span><span class="p">,</span> <span class="n">na_a</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">allowed_a</span><span class="p">(:)</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">DM</span><span class="p">(:,:),</span> <span class="n">EDM</span><span class="p">(:,:)</span>

      <span class="c">! We are done with the initial diagon run</span>
      <span class="c">! Now we start the TRANSIESTA (Green functions) run</span>
      <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">TSmode</span> <span class="p">)</span> <span class="k">return</span>
<span class="k">      if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">TSinit</span> <span class="p">)</span> <span class="k">return</span>

      <span class="c">! whether we are in siesta initialization step</span>
      <span class="n">TSinit</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
      <span class="c">! whether transiesta is running</span>
      <span class="n">TSrun</span>  <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>

      <span class="c">! If transiesta should stop immediately</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">ts_siesta_stop</span> <span class="p">)</span> <span class="k">then</span>

<span class="k">         if</span> <span class="p">(</span> <span class="n">IONode</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(a)&#39;</span><span class="p">)</span> <span class="s1">&#39;ts: Stopping transiesta (user option)!&#39;</span>
         <span class="k">end if</span>

<span class="k">         return</span>

<span class="k">      end if</span>

      <span class="c">! Reduce memory requirements</span>
      <span class="k">call </span><span class="n">resetDenseMatrix</span><span class="p">()</span>

      <span class="c">! Signal to continue...</span>
      <span class="c">! These two variables are from the top-level</span>
      <span class="c">! routine (siesta_forces)</span>
      <span class="n">SCFconverged</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
      <span class="n">iscf</span> <span class="o">=</span> <span class="mi">0</span>

      <span class="c">! DANGER (when/if going back to the DIAGON run, we should</span>
      <span class="c">! re-instantiate the original mixing value)</span>
      <span class="k">call </span><span class="n">val_swap</span><span class="p">(</span><span class="n">dDtol</span><span class="p">,</span> <span class="n">ts_Dtol</span><span class="p">)</span>
      <span class="k">call </span><span class="n">val_swap</span><span class="p">(</span><span class="n">dHtol</span><span class="p">,</span> <span class="n">ts_Htol</span><span class="p">)</span>

      <span class="c">! Clean up mixing history</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">mix_charge</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">resetRhoG</span><span class="p">(.</span><span class="n">true</span><span class="p">.)</span>
      <span class="k">else</span>
<span class="k">        if</span> <span class="p">(</span> <span class="nb">associated</span><span class="p">(</span><span class="n">ts_scf_mixs</span><span class="p">,</span> <span class="k">target</span><span class="o">=</span><span class="n">scf_mixs</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">          do </span><span class="n">iel</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">stack</span><span class="p">)</span>
            <span class="k">call </span><span class="n">reset</span><span class="p">(</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">stack</span><span class="p">(</span><span class="n">iel</span><span class="p">),</span> <span class="o">-</span><span class="n">ts_hist_keep</span><span class="p">)</span>
            <span class="c">! Reset iteration count as certain</span>
            <span class="c">! mixing schemes require this for consistency</span>
            <span class="n">scf_mix</span><span class="p">%</span><span class="n">cur_itt</span> <span class="o">=</span> <span class="n">n_items</span><span class="p">(</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">stack</span><span class="p">(</span><span class="n">iel</span><span class="p">))</span>
          <span class="k">end do</span>
<span class="k">        else</span>
<span class="k">          call </span><span class="n">mixers_history_init</span><span class="p">(</span><span class="n">scf_mixs</span><span class="p">)</span>
        <span class="k">end if</span>
<span class="k">      end if</span>
      
      <span class="c">! Transfer scf_mixing to the transiesta mixing routine</span>
      <span class="n">scf_mix</span> <span class="o">=&gt;</span> <span class="n">ts_scf_mixs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="cp">#ifdef SIESTA__FLOOK</span>
      <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">mix_charge</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Weight&#39;</span><span class="p">,</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">w</span><span class="p">)</span>
         <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Restart&#39;</span><span class="p">,</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">restart</span><span class="p">)</span>
         <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Iterations&#39;</span><span class="p">,</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">n_itt</span><span class="p">)</span>
      <span class="k">end if</span>
<span class="cp">#endif</span>

      <span class="k">call </span><span class="n">ts_print_transiesta</span><span class="p">()</span>

      <span class="c">! In case of transiesta and DM_bulk.</span>
      <span class="c">! In case we ask for initialization of the DM in bulk</span>
      <span class="c">! we read in the DM files from the electrodes and</span>
      <span class="c">! initialize the bulk to those values</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">DM_bulk</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">then</span>

<span class="k">         if</span> <span class="p">(</span> <span class="n">IONode</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(/,2a)&#39;</span><span class="p">)</span> <span class="s1">&#39;transiesta: &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
                 <span class="s1">&#39;Initializing bulk DM in electrodes.&#39;</span>
         <span class="k">end if</span>

<span class="k">         </span><span class="n">na_a</span> <span class="o">=</span> <span class="mi">0</span>
         <span class="k">do </span><span class="n">iEl</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">na_u</span>
            <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">a_isDev</span><span class="p">(</span><span class="n">iEl</span><span class="p">)</span> <span class="p">)</span> <span class="n">na_a</span> <span class="o">=</span> <span class="n">na_a</span> <span class="o">+</span> <span class="mi">1</span>
         <span class="k">end do</span>
<span class="k">         allocate</span><span class="p">(</span><span class="n">allowed_a</span><span class="p">(</span><span class="n">na_a</span><span class="p">))</span>
         <span class="n">na_a</span> <span class="o">=</span> <span class="mi">0</span>
         <span class="k">do </span><span class="n">iEl</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">na_u</span>
            <span class="c">! We allow the buffer atoms as well (this will even out the</span>
            <span class="c">! potential around the back of the electrode)</span>
            <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">a_isDev</span><span class="p">(</span><span class="n">iEl</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">               </span><span class="n">na_a</span> <span class="o">=</span> <span class="n">na_a</span> <span class="o">+</span> <span class="mi">1</span>
               <span class="n">allowed_a</span><span class="p">(</span><span class="n">na_a</span><span class="p">)</span> <span class="o">=</span> <span class="n">iEl</span>
            <span class="k">end if</span>
<span class="k">         end do</span>

<span class="k">         do </span><span class="n">iEl</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">N_Elec</span>

            <span class="k">if</span> <span class="p">(</span> <span class="n">IONode</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">               write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(/,2a)&#39;</span><span class="p">)</span> <span class="s1">&#39;transiesta: &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
                    <span class="s1">&#39;Reading in electrode TSDE for &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
                    <span class="nb">trim</span><span class="p">(</span><span class="n">Elecs</span><span class="p">(</span><span class="n">iEl</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
            <span class="k">end if</span>

            <span class="c">! Copy over the DM in the lead</span>
            <span class="c">! Notice that the EDM matrix that is copied over</span>
            <span class="c">! will be equivalent at Ef == 0</span>
            <span class="k">call </span><span class="n">copy_DM</span><span class="p">(</span><span class="n">Elecs</span><span class="p">(</span><span class="n">iEl</span><span class="p">),</span><span class="n">na_u</span><span class="p">,</span><span class="n">xa</span><span class="p">,</span><span class="n">lasto</span><span class="p">,</span><span class="n">nsc</span><span class="p">,</span><span class="n">isc_off</span><span class="p">,</span> <span class="p">&amp;</span>
                 <span class="n">ucell</span><span class="p">,</span> <span class="n">DM_2D</span><span class="p">,</span> <span class="n">EDM_2D</span><span class="p">,</span> <span class="n">na_a</span><span class="p">,</span> <span class="n">allowed_a</span><span class="p">)</span>

         <span class="k">end do</span>

         <span class="c">! Clean-up</span>
         <span class="k">deallocate</span><span class="p">(</span><span class="n">allowed_a</span><span class="p">)</span>

         <span class="k">if</span> <span class="p">(</span> <span class="n">IONode</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="c">! new-line</span>
         <span class="k">end if</span>

         <span class="c">! The electrode EDM is aligned at Ef == 0</span>
         <span class="c">! We need to align the energy matrix</span>
         <span class="n">DM</span>  <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">DM_2D</span><span class="p">)</span>
         <span class="n">EDM</span> <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">EDM_2D</span><span class="p">)</span>
         <span class="n">iEl</span> <span class="o">=</span>  <span class="n">size</span><span class="p">(</span><span class="n">DM</span><span class="p">)</span>
         <span class="k">call </span><span class="n">daxpy</span><span class="p">(</span><span class="n">iEl</span><span class="p">,</span><span class="n">Ef</span><span class="p">,</span><span class="n">DM</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">EDM</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>

      <span class="k">end if</span>

<span class="k">    end subroutine </span><span class="n">transiesta_switch</span>

  <span class="k">end subroutine </span><span class="n">siesta_forces</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2018 <a rel="license" href="http://www.gnu.org/licenses/old-licenses/fdl-1.2.en.html">GNU Free Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> SIESTA was developed by SIESTA Group</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>