<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="A first-principles materials simulation code using Density Functional Theory.">
    
    <meta name="author" content="SIESTA Group" >
    <link rel="icon" href="../favicon.png">

    <title>siesta_forces &ndash; SIESTA</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">SIESTA <small>trunk-700--vdikan-edens-710-ford-681</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>Program Overview</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>siesta_forces
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 4.4% of total for procedures.">375 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/siesta_forces.F90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/siesta_forces.f90.html'>siesta_forces.F90</a></li>
    
     <li><a href='../module/m_siesta_forces.html'>m_siesta_forces</a></li>
    
  
     <li class="active">siesta_forces</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/siesta_forces.html#src">siesta_forces</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine siesta_forces(istep)
    
    
   
</h2>
    
  
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
      
      <li class="list-group-item">
  <ul class="list-inline">
    
    <li><a href='../module/units.html'>units</a></li>
    
    <li><a href='../module/precision.html'>precision</a></li>
    
    <li><a href='../module/sys.html'>sys</a></li>
    
    <li>files</li>
    
    <li>siesta_cml</li>
    
    <li><a href='../module/m_state_init.html'>m_state_init</a></li>
    
    <li><a href='../module/m_setup_hamiltonian.html'>m_setup_hamiltonian</a></li>
    
    <li><a href='../module/m_setup_h0.html'>m_setup_H0</a></li>
    
    <li><a href='../module/m_compute_dm.html'>m_compute_dm</a></li>
    
    <li><a href='../module/m_compute_max_diff.html'>m_compute_max_diff</a></li>
    
    <li>m_scfconvergence_test</li>
    
    <li>m_post_scf_work</li>
    
    <li>m_mixer</li>
    
    <li><a href='../module/m_mixing_scf.html'>m_mixing_scf</a></li>
    
    <li><a href='../module/m_mixing_scf.html'>m_mixing_scf</a></li>
    
    <li><a href='../module/m_mixing_scf.html'>m_mixing_scf</a></li>
    
    <li><a href='../module/m_rhog.html'>m_rhog</a></li>
    
    <li><a href='../module/siesta_options.html'>siesta_options</a></li>
    
    <li><a href='../module/parallel.html'>parallel</a></li>
    
    <li><a href='../module/m_state_analysis.html'>m_state_analysis</a></li>
    
    <li>m_steps</li>
    
    <li>m_spin</li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>m_convergence</li>
    
    <li>m_convergence</li>
    
    <li>siesta_geom</li>
    
    <li>m_energies</li>
    
    <li>m_forces</li>
    
    <li>m_stress</li>
    
    <li>siesta_master</li>
    
    <li>siesta_master</li>
    
    <li>m_save_density_matrix</li>
    
    <li>m_iodm_old</li>
    
    <li>atomlist</li>
    
    <li>m_dm_charge</li>
    
    <li>m_pexsi_solver</li>
    
    <li>write_subs</li>
    
    <li>write_subs</li>
    
    <li><a href='../module/m_compute_energies.html'>m_compute_energies</a></li>
    
    <li>m_mpi_utils</li>
    
    <li>fdf</li>
    
    <li>m_check_walltime</li>
    
    <li>m_energies</li>
    
    <li>m_ts_options</li>
    
    <li>m_ts_method</li>
    
    <li>m_ts_global_vars</li>
    
    <li>siesta_geom</li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>m_ts_charge</li>
    
    <li>m_ts_charge</li>
    
    <li>m_ts_charge</li>
    
    <li>m_ts_charge</li>
    
    <li>m_transiesta</li>
    
    <li>kpoint_scf_m</li>
    
    <li>m_energies</li>
    
    <li>m_initwf</li>
    
  </ul>
      </li>
      
      
      
      <li class="list-group-item">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~siesta_forces~~UsesGraph Pages: 1 -->
<svg id="procsiesta_forcesUsesGraph" width="587pt" height="1818pt"
 viewBox="0.00 0.00 587.00 1818.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~siesta_forces~~UsesGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 1814)">
<title>proc~~siesta_forces~~UsesGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1814 583,-1814 583,4 -4,4"/>
<!-- proc~siesta_forces -->
<g id="proc~~siesta_forces~~UsesGraph_node1" class="node"><title>proc~siesta_forces</title>
<polygon fill="none" stroke="black" points="579,-919 503,-919 503,-895 579,-895 579,-919"/>
<text text-anchor="middle" x="541" y="-904.6" font-family="Helvetica,sans-Serif" font-size="10.50">siesta_forces</text>
</g>
<!-- m_check_walltime -->
<g id="proc~~siesta_forces~~UsesGraph_node2" class="node"><title>m_check_walltime</title>
<polygon fill="#337ab7" stroke="#337ab7" points="454,-1810 354,-1810 354,-1786 454,-1786 454,-1810"/>
<text text-anchor="middle" x="404" y="-1795.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_check_walltime</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_check_walltime -->
<g id="proc~~siesta_forces~~UsesGraph_edge1" class="edge"><title>proc~siesta_forces&#45;&gt;m_check_walltime</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.729,-919.078C537.401,-1018.48 519.587,-1699.72 467,-1772 464.738,-1775.11 462.032,-1777.85 459.034,-1780.26"/>
<polygon fill="#000000" stroke="#000000" points="456.91,-1777.47 450.517,-1785.92 460.783,-1783.3 456.91,-1777.47"/>
</g>
<!-- m_spin -->
<g id="proc~~siesta_forces~~UsesGraph_node3" class="node"><title>m_spin</title>
<polygon fill="#337ab7" stroke="#337ab7" points="258.5,-586 204.5,-586 204.5,-562 258.5,-562 258.5,-586"/>
<text text-anchor="middle" x="231.5" y="-571.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_spin</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_spin -->
<g id="proc~~siesta_forces~~UsesGraph_edge33" class="edge"><title>proc~siesta_forces&#45;&gt;m_spin</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M536.379,-894.931C528.233,-869.858 506.059,-811.9 467,-781 421.128,-744.71 387.688,-778.234 341,-743 289.073,-703.812 255.203,-631.974 240.653,-595.896"/>
<polygon fill="#000000" stroke="#000000" points="243.811,-594.362 236.91,-586.323 237.292,-596.911 243.811,-594.362"/>
</g>
<!-- write_subs -->
<g id="proc~~siesta_forces~~UsesGraph_node4" class="node"><title>write_subs</title>
<polygon fill="#337ab7" stroke="#337ab7" points="263.5,-1750 199.5,-1750 199.5,-1726 263.5,-1726 263.5,-1750"/>
<text text-anchor="middle" x="231.5" y="-1735.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_subs</text>
</g>
<!-- proc~siesta_forces&#45;&gt;write_subs -->
<g id="proc~~siesta_forces~~UsesGraph_edge11" class="edge"><title>proc~siesta_forces&#45;&gt;write_subs</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.9,-919.11C538.969,-1017.3 530.348,-1680.97 467,-1739 414.826,-1786.8 325.411,-1769.23 273.369,-1753.03"/>
<polygon fill="#000000" stroke="#000000" points="274.384,-1749.68 263.792,-1749.93 272.229,-1756.34 274.384,-1749.68"/>
</g>
<!-- m_ts_options -->
<g id="proc~~siesta_forces~~UsesGraph_node5" class="node"><title>m_ts_options</title>
<polygon fill="#337ab7" stroke="#337ab7" points="442,-1688 366,-1688 366,-1664 442,-1664 442,-1688"/>
<text text-anchor="middle" x="404" y="-1673.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_options</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_ts_options -->
<g id="proc~~siesta_forces~~UsesGraph_edge4" class="edge"><title>proc~siesta_forces&#45;&gt;m_ts_options</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.599,-919.17C536.47,-1011.13 514.799,-1594.76 467,-1655 462.921,-1660.14 457.527,-1664.03 451.619,-1666.97"/>
<polygon fill="#000000" stroke="#000000" points="449.981,-1663.86 442.027,-1670.86 452.609,-1670.35 449.981,-1663.86"/>
</g>
<!-- siesta_cml -->
<g id="proc~~siesta_forces~~UsesGraph_node6" class="node"><title>siesta_cml</title>
<polygon fill="#337ab7" stroke="#337ab7" points="435.5,-1646 372.5,-1646 372.5,-1622 435.5,-1622 435.5,-1646"/>
<text text-anchor="middle" x="404" y="-1631.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_cml</text>
</g>
<!-- proc~siesta_forces&#45;&gt;siesta_cml -->
<g id="proc~~siesta_forces~~UsesGraph_edge5" class="edge"><title>proc~siesta_forces&#45;&gt;siesta_cml</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.53,-919.047C535.974,-1007.63 512.209,-1556.36 467,-1613 461.497,-1619.89 453.63,-1624.54 445.34,-1627.66"/>
<polygon fill="#000000" stroke="#000000" points="444.061,-1624.4 435.529,-1630.68 446.116,-1631.09 444.061,-1624.4"/>
</g>
<!-- module~parallel -->
<g id="proc~~siesta_forces~~UsesGraph_node7" class="node"><title>module~parallel</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node7"><a xlink:href=".././module/parallel.html" xlink:title="parallel">
<polygon fill="#337ab7" stroke="#337ab7" points="431,-1604 377,-1604 377,-1580 431,-1580 431,-1604"/>
<text text-anchor="middle" x="404" y="-1589.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;module~parallel -->
<g id="proc~~siesta_forces~~UsesGraph_edge6" class="edge"><title>proc~siesta_forces&#45;&gt;module~parallel</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.443,-919.142C535.406,-1004.95 509.585,-1518 467,-1571 460.487,-1579.11 450.709,-1584.1 440.832,-1587.17"/>
<polygon fill="#000000" stroke="#000000" points="439.878,-1583.8 431.04,-1589.65 441.593,-1590.59 439.878,-1583.8"/>
</g>
<!-- m_energies -->
<g id="proc~~siesta_forces~~UsesGraph_node8" class="node"><title>m_energies</title>
<polygon fill="#337ab7" stroke="#337ab7" points="438.5,-1562 369.5,-1562 369.5,-1538 438.5,-1538 438.5,-1562"/>
<text text-anchor="middle" x="404" y="-1547.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_energies</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_energies -->
<g id="proc~~siesta_forces~~UsesGraph_edge7" class="edge"><title>proc~siesta_forces&#45;&gt;m_energies</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M540.273,-919.026C541.803,-996.986 546.613,-1430.65 467,-1529 462.182,-1534.95 455.606,-1539.22 448.531,-1542.29"/>
<polygon fill="#000000" stroke="#000000" points="446.953,-1539.14 438.691,-1545.77 449.286,-1545.74 446.953,-1539.14"/>
</g>
<!-- m_dm_charge -->
<g id="proc~~siesta_forces~~UsesGraph_node9" class="node"><title>m_dm_charge</title>
<polygon fill="#337ab7" stroke="#337ab7" points="445,-1520 363,-1520 363,-1496 445,-1496 445,-1520"/>
<text text-anchor="middle" x="404" y="-1505.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_dm_charge</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_dm_charge -->
<g id="proc~~siesta_forces~~UsesGraph_edge26" class="edge"><title>proc~siesta_forces&#45;&gt;m_dm_charge</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M540.164,-919.42C540.917,-995.286 541.296,-1396 467,-1487 463.496,-1491.29 459.078,-1494.71 454.222,-1497.43"/>
<polygon fill="#000000" stroke="#000000" points="452.735,-1494.26 445.109,-1501.62 455.657,-1500.62 452.735,-1494.26"/>
</g>
<!-- module~m_setup_h0 -->
<g id="proc~~siesta_forces~~UsesGraph_node10" class="node"><title>module~m_setup_h0</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node10"><a xlink:href=".././module/m_setup_h0.html" xlink:title="m_setup_H0">
<polygon fill="#337ab7" stroke="#337ab7" points="440.5,-1478 367.5,-1478 367.5,-1454 440.5,-1454 440.5,-1478"/>
<text text-anchor="middle" x="404" y="-1463.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_setup_H0</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;module~m_setup_h0 -->
<g id="proc~~siesta_forces~~UsesGraph_edge8" class="edge"><title>proc~siesta_forces&#45;&gt;module~m_setup_h0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M540.029,-919.456C539.949,-992.144 536.11,-1361.19 467,-1445 462.531,-1450.42 456.605,-1454.45 450.187,-1457.44"/>
<polygon fill="#000000" stroke="#000000" points="448.638,-1454.28 440.544,-1461.12 451.135,-1460.82 448.638,-1454.28"/>
</g>
<!-- module~sys -->
<g id="proc~~siesta_forces~~UsesGraph_node11" class="node"><title>module~sys</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node11"><a xlink:href=".././module/sys.html" xlink:title="sys">
<polygon fill="#337ab7" stroke="#337ab7" points="431,-1436 377,-1436 377,-1412 431,-1412 431,-1436"/>
<text text-anchor="middle" x="404" y="-1421.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sys</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;module~sys -->
<g id="proc~~siesta_forces~~UsesGraph_edge9" class="edge"><title>proc~siesta_forces&#45;&gt;module~sys</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.872,-919.379C538.913,-988.493 530.973,-1326.3 467,-1403 460.394,-1410.92 450.68,-1415.86 440.893,-1418.95"/>
<polygon fill="#000000" stroke="#000000" points="440.001,-1415.56 431.192,-1421.45 441.75,-1422.34 440.001,-1415.56"/>
</g>
<!-- kpoint_scf_m -->
<g id="proc~~siesta_forces~~UsesGraph_node12" class="node"><title>kpoint_scf_m</title>
<polygon fill="#337ab7" stroke="#337ab7" points="442,-1394 366,-1394 366,-1370 442,-1370 442,-1394"/>
<text text-anchor="middle" x="404" y="-1379.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">kpoint_scf_m</text>
</g>
<!-- proc~siesta_forces&#45;&gt;kpoint_scf_m -->
<g id="proc~~siesta_forces~~UsesGraph_edge10" class="edge"><title>proc~siesta_forces&#45;&gt;kpoint_scf_m</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.571,-919.401C537.095,-984.379 522.728,-1285.29 467,-1356 462.777,-1361.36 457.25,-1365.63 451.235,-1369.02"/>
<polygon fill="#000000" stroke="#000000" points="449.653,-1365.9 442.167,-1373.39 452.695,-1372.2 449.653,-1365.9"/>
</g>
<!-- module~m_state_analysis -->
<g id="proc~~siesta_forces~~UsesGraph_node13" class="node"><title>module~m_state_analysis</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node13"><a xlink:href=".././module/m_state_analysis.html" xlink:title="m_state_analysis">
<polygon fill="#337ab7" stroke="#337ab7" points="451.5,-1730 356.5,-1730 356.5,-1706 451.5,-1706 451.5,-1730"/>
<text text-anchor="middle" x="404" y="-1715.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_state_analysis</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;module~m_state_analysis -->
<g id="proc~~siesta_forces~~UsesGraph_edge12" class="edge"><title>proc~siesta_forces&#45;&gt;module~m_state_analysis</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.664,-919.24C536.948,-1014.34 517.402,-1633.14 467,-1697 465.086,-1699.43 462.879,-1701.57 460.463,-1703.47"/>
<polygon fill="#000000" stroke="#000000" points="458.193,-1700.76 451.566,-1709.03 461.901,-1706.7 458.193,-1700.76"/>
</g>
<!-- m_steps -->
<g id="proc~~siesta_forces~~UsesGraph_node14" class="node"><title>m_steps</title>
<polygon fill="#337ab7" stroke="#337ab7" points="431,-1314 377,-1314 377,-1290 431,-1290 431,-1314"/>
<text text-anchor="middle" x="404" y="-1299.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_steps</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_steps -->
<g id="proc~~siesta_forces~~UsesGraph_edge13" class="edge"><title>proc~siesta_forces&#45;&gt;m_steps</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.229,-919.27C535.341,-977.428 516.099,-1224.85 467,-1281 460.337,-1288.62 450.807,-1293.48 441.21,-1296.58"/>
<polygon fill="#000000" stroke="#000000" points="440.068,-1293.26 431.302,-1299.21 441.865,-1300.02 440.068,-1293.26"/>
</g>
<!-- m_mixer -->
<g id="proc~~siesta_forces~~UsesGraph_node15" class="node"><title>m_mixer</title>
<polygon fill="#337ab7" stroke="#337ab7" points="431,-1272 377,-1272 377,-1248 431,-1248 431,-1272"/>
<text text-anchor="middle" x="404" y="-1257.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_mixer</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_mixer -->
<g id="proc~~siesta_forces~~UsesGraph_edge14" class="edge"><title>proc~siesta_forces&#45;&gt;m_mixer</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M538.786,-919.062C533.232,-972.098 508.711,-1184.14 467,-1234 460.259,-1242.06 450.595,-1247.66 440.896,-1251.54"/>
<polygon fill="#000000" stroke="#000000" points="439.592,-1248.29 431.293,-1254.88 441.888,-1254.9 439.592,-1248.29"/>
</g>
<!-- module~m_compute_max_diff -->
<g id="proc~~siesta_forces~~UsesGraph_node16" class="node"><title>module~m_compute_max_diff</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node16"><a xlink:href=".././module/m_compute_max_diff.html" xlink:title="m_compute_max_diff">
<polygon fill="#337ab7" stroke="#337ab7" points="289,-169 174,-169 174,-145 289,-145 289,-169"/>
<text text-anchor="middle" x="231.5" y="-154.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_compute_max_diff</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;module~m_compute_max_diff -->
<g id="proc~~siesta_forces~~UsesGraph_edge15" class="edge"><title>proc~siesta_forces&#45;&gt;module~m_compute_max_diff</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.905,-894.832C539.013,-796.169 530.638,-129.324 467,-71 425.716,-33.1635 389.246,-42.5693 341,-71 312.549,-87.7659 330.813,-115.403 305,-136 302.939,-137.645 300.753,-139.161 298.476,-140.558"/>
<polygon fill="#000000" stroke="#000000" points="296.528,-137.628 289.307,-145.38 299.787,-143.823 296.528,-137.628"/>
</g>
<!-- siesta_geom -->
<g id="proc~~siesta_forces~~UsesGraph_node17" class="node"><title>siesta_geom</title>
<polygon fill="#337ab7" stroke="#337ab7" points="440.5,-1192 367.5,-1192 367.5,-1168 440.5,-1168 440.5,-1192"/>
<text text-anchor="middle" x="404" y="-1177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_geom</text>
</g>
<!-- proc~siesta_forces&#45;&gt;siesta_geom -->
<g id="proc~~siesta_forces~~UsesGraph_edge16" class="edge"><title>proc~siesta_forces&#45;&gt;siesta_geom</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M540.191,-919.153C540.144,-959.188 534.527,-1088.39 467,-1159 462.303,-1163.91 456.418,-1167.67 450.155,-1170.56"/>
<polygon fill="#000000" stroke="#000000" points="448.863,-1167.3 440.805,-1174.18 451.394,-1173.83 448.863,-1167.3"/>
</g>
<!-- module~m_state_init -->
<g id="proc~~siesta_forces~~UsesGraph_node18" class="node"><title>module~m_state_init</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node18"><a xlink:href=".././module/m_state_init.html" xlink:title="m_state_init">
<polygon fill="#337ab7" stroke="#337ab7" points="439,-1150 369,-1150 369,-1126 439,-1126 439,-1150"/>
<text text-anchor="middle" x="404" y="-1135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_state_init</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;module~m_state_init -->
<g id="proc~~siesta_forces~~UsesGraph_edge17" class="edge"><title>proc~siesta_forces&#45;&gt;module~m_state_init</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.368,-919.12C536.86,-954.674 524.681,-1059.78 467,-1117 461.959,-1122 455.685,-1125.81 449.08,-1128.72"/>
<polygon fill="#000000" stroke="#000000" points="447.431,-1125.59 439.272,-1132.35 449.865,-1132.16 447.431,-1125.59"/>
</g>
<!-- m_ts_method -->
<g id="proc~~siesta_forces~~UsesGraph_node19" class="node"><title>m_ts_method</title>
<polygon fill="#337ab7" stroke="#337ab7" points="443,-1108 365,-1108 365,-1084 443,-1084 443,-1108"/>
<text text-anchor="middle" x="404" y="-1093.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_method</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_ts_method -->
<g id="proc~~siesta_forces~~UsesGraph_edge18" class="edge"><title>proc~siesta_forces&#45;&gt;m_ts_method</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M538.175,-919.091C532.928,-949.684 514.978,-1030.86 467,-1075 462.818,-1078.85 457.905,-1081.99 452.705,-1084.56"/>
<polygon fill="#000000" stroke="#000000" points="450.988,-1081.49 443.133,-1088.6 453.707,-1087.94 450.988,-1081.49"/>
</g>
<!-- m_ts_charge -->
<g id="proc~~siesta_forces~~UsesGraph_node20" class="node"><title>m_ts_charge</title>
<polygon fill="#337ab7" stroke="#337ab7" points="441.5,-1066 366.5,-1066 366.5,-1042 441.5,-1042 441.5,-1066"/>
<text text-anchor="middle" x="404" y="-1051.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_charge</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_ts_charge -->
<g id="proc~~siesta_forces~~UsesGraph_edge19" class="edge"><title>proc~siesta_forces&#45;&gt;m_ts_charge</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M536.168,-919.346C527.762,-944.426 505.338,-1001.61 467,-1033 462.325,-1036.83 456.917,-1039.97 451.282,-1042.55"/>
<polygon fill="#000000" stroke="#000000" points="449.67,-1039.43 441.676,-1046.38 452.261,-1045.93 449.67,-1039.43"/>
</g>
<!-- m_save_density_matrix -->
<g id="proc~~siesta_forces~~UsesGraph_node21" class="node"><title>m_save_density_matrix</title>
<polygon fill="#337ab7" stroke="#337ab7" points="466.5,-1024 341.5,-1024 341.5,-1000 466.5,-1000 466.5,-1024"/>
<text text-anchor="middle" x="404" y="-1009.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_save_density_matrix</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_save_density_matrix -->
<g id="proc~~siesta_forces~~UsesGraph_edge20" class="edge"><title>proc~siesta_forces&#45;&gt;m_save_density_matrix</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M532.547,-919.088C520.778,-937.217 496.2,-971.408 467,-991 464.567,-992.632 461.995,-994.149 459.337,-995.557"/>
<polygon fill="#000000" stroke="#000000" points="457.601,-992.505 450.045,-999.932 460.583,-998.839 457.601,-992.505"/>
</g>
<!-- m_stress -->
<g id="proc~~siesta_forces~~UsesGraph_node22" class="node"><title>m_stress</title>
<polygon fill="#337ab7" stroke="#337ab7" points="432,-982 376,-982 376,-958 432,-958 432,-982"/>
<text text-anchor="middle" x="404" y="-967.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_stress</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_stress -->
<g id="proc~~siesta_forces~~UsesGraph_edge21" class="edge"><title>proc~siesta_forces&#45;&gt;m_stress</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M521.326,-919.105C506.887,-928.126 486.188,-940.331 467,-949 459.035,-952.598 450.26,-955.93 441.881,-958.83"/>
<polygon fill="#000000" stroke="#000000" points="440.677,-955.542 432.298,-962.027 442.892,-962.183 440.677,-955.542"/>
</g>
<!-- module~m_compute_energies -->
<g id="proc~~siesta_forces~~UsesGraph_node23" class="node"><title>module~m_compute_energies</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node23"><a xlink:href=".././module/m_compute_energies.html" xlink:title="m_compute_energies">
<polygon fill="#337ab7" stroke="#337ab7" points="462,-940 346,-940 346,-916 462,-916 462,-940"/>
<text text-anchor="middle" x="404" y="-925.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_compute_energies</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;module~m_compute_energies -->
<g id="proc~~siesta_forces~~UsesGraph_edge22" class="edge"><title>proc~siesta_forces&#45;&gt;module~m_compute_energies</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M502.753,-912.794C493.231,-914.275 482.696,-915.914 472.172,-917.551"/>
<polygon fill="#000000" stroke="#000000" points="471.462,-914.119 462.118,-919.115 472.538,-921.036 471.462,-914.119"/>
</g>
<!-- m_mpi_utils -->
<g id="proc~~siesta_forces~~UsesGraph_node24" class="node"><title>m_mpi_utils</title>
<polygon fill="#337ab7" stroke="#337ab7" points="439,-898 369,-898 369,-874 439,-874 439,-898"/>
<text text-anchor="middle" x="404" y="-883.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_mpi_utils</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_mpi_utils -->
<g id="proc~~siesta_forces~~UsesGraph_edge23" class="edge"><title>proc~siesta_forces&#45;&gt;m_mpi_utils</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M502.753,-901.206C486.182,-898.628 466.544,-895.573 449.232,-892.881"/>
<polygon fill="#000000" stroke="#000000" points="449.768,-889.422 439.349,-891.343 448.692,-896.339 449.768,-889.422"/>
</g>
<!-- files -->
<g id="proc~~siesta_forces~~UsesGraph_node25" class="node"><title>files</title>
<polygon fill="#337ab7" stroke="#337ab7" points="431,-856 377,-856 377,-832 431,-832 431,-856"/>
<text text-anchor="middle" x="404" y="-841.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">files</text>
</g>
<!-- proc~siesta_forces&#45;&gt;files -->
<g id="proc~~siesta_forces~~UsesGraph_edge24" class="edge"><title>proc~siesta_forces&#45;&gt;files</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M521.326,-894.895C506.887,-885.874 486.188,-873.669 467,-865 458.648,-861.226 449.404,-857.746 440.661,-854.749"/>
<polygon fill="#000000" stroke="#000000" points="441.668,-851.396 431.075,-851.581 439.472,-858.043 441.668,-851.396"/>
</g>
<!-- m_pexsi_solver -->
<g id="proc~~siesta_forces~~UsesGraph_node26" class="node"><title>m_pexsi_solver</title>
<polygon fill="#337ab7" stroke="#337ab7" points="447.5,-814 360.5,-814 360.5,-790 447.5,-790 447.5,-814"/>
<text text-anchor="middle" x="404" y="-799.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_pexsi_solver</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_pexsi_solver -->
<g id="proc~~siesta_forces~~UsesGraph_edge25" class="edge"><title>proc~siesta_forces&#45;&gt;m_pexsi_solver</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M532.547,-894.912C520.778,-876.783 496.2,-842.592 467,-823 463.892,-820.914 460.557,-819.018 457.105,-817.296"/>
<polygon fill="#000000" stroke="#000000" points="458.33,-814.01 447.771,-813.138 455.481,-820.405 458.33,-814.01"/>
</g>
<!-- module~units -->
<g id="proc~~siesta_forces~~UsesGraph_node27" class="node"><title>module~units</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node27"><a xlink:href=".././module/units.html" xlink:title="units">
<polygon fill="#337ab7" stroke="#337ab7" points="258.5,-1313 204.5,-1313 204.5,-1289 258.5,-1289 258.5,-1313"/>
<text text-anchor="middle" x="231.5" y="-1298.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">units</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;module~units -->
<g id="proc~~siesta_forces~~UsesGraph_edge3" class="edge"><title>proc~siesta_forces&#45;&gt;module~units</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.862,-919.325C538.872,-982.526 530.872,-1269.36 467,-1323 409.902,-1370.95 315.172,-1339.43 265.387,-1317.32"/>
<polygon fill="#000000" stroke="#000000" points="266.603,-1314.03 256.054,-1313.05 263.691,-1320.4 266.603,-1314.03"/>
</g>
<!-- module~siesta_options -->
<g id="proc~~siesta_forces~~UsesGraph_node28" class="node"><title>module~siesta_options</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node28"><a xlink:href=".././module/siesta_options.html" xlink:title="siesta_options">
<polygon fill="#337ab7" stroke="#337ab7" points="444.5,-734 363.5,-734 363.5,-710 444.5,-710 444.5,-734"/>
<text text-anchor="middle" x="404" y="-719.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_options</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;module~siesta_options -->
<g id="proc~~siesta_forces~~UsesGraph_edge27" class="edge"><title>proc~siesta_forces&#45;&gt;module~siesta_options</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M537.608,-894.889C531.254,-865.729 511.321,-790.868 467,-748 463.067,-744.196 458.496,-740.914 453.652,-738.089"/>
<polygon fill="#000000" stroke="#000000" points="455.21,-734.954 444.717,-733.486 452.004,-741.177 455.21,-734.954"/>
</g>
<!-- m_convergence -->
<g id="proc~~siesta_forces~~UsesGraph_node29" class="node"><title>m_convergence</title>
<polygon fill="#337ab7" stroke="#337ab7" points="448.5,-692 359.5,-692 359.5,-668 448.5,-668 448.5,-692"/>
<text text-anchor="middle" x="404" y="-677.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_convergence</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_convergence -->
<g id="proc~~siesta_forces~~UsesGraph_edge28" class="edge"><title>proc~siesta_forces&#45;&gt;m_convergence</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.272,-894.856C536.512,-859.726 523.735,-756.947 467,-701 464.168,-698.207 460.951,-695.785 457.508,-693.686"/>
<polygon fill="#000000" stroke="#000000" points="459.068,-690.552 448.573,-689.101 455.872,-696.78 459.068,-690.552"/>
</g>
<!-- m_ts_global_vars -->
<g id="proc~~siesta_forces~~UsesGraph_node30" class="node"><title>m_ts_global_vars</title>
<polygon fill="#337ab7" stroke="#337ab7" points="452.5,-650 355.5,-650 355.5,-626 452.5,-626 452.5,-650"/>
<text text-anchor="middle" x="404" y="-635.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ts_global_vars</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_ts_global_vars -->
<g id="proc~~siesta_forces~~UsesGraph_edge29" class="edge"><title>proc~siesta_forces&#45;&gt;m_ts_global_vars</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M540.123,-894.758C539.843,-855.03 533.533,-728.271 467,-659 465.209,-657.135 463.247,-655.436 461.158,-653.888"/>
<polygon fill="#000000" stroke="#000000" points="462.923,-650.865 452.566,-648.633 459.271,-656.837 462.923,-650.865"/>
</g>
<!-- m_post_scf_work -->
<g id="proc~~siesta_forces~~UsesGraph_node31" class="node"><title>m_post_scf_work</title>
<polygon fill="#337ab7" stroke="#337ab7" points="452,-608 356,-608 356,-584 452,-584 452,-608"/>
<text text-anchor="middle" x="404" y="-593.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_post_scf_work</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_post_scf_work -->
<g id="proc~~siesta_forces~~UsesGraph_edge30" class="edge"><title>proc~siesta_forces&#45;&gt;m_post_scf_work</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M538.505,-894.921C532.162,-845.491 506,-659.251 467,-617 465.179,-615.027 463.166,-613.24 461.012,-611.62"/>
<polygon fill="#000000" stroke="#000000" points="462.468,-608.408 452.113,-606.168 458.812,-614.376 462.468,-608.408"/>
</g>
<!-- m_forces -->
<g id="proc~~siesta_forces~~UsesGraph_node32" class="node"><title>m_forces</title>
<polygon fill="#337ab7" stroke="#337ab7" points="432.5,-566 375.5,-566 375.5,-542 432.5,-542 432.5,-566"/>
<text text-anchor="middle" x="404" y="-551.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_forces</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_forces -->
<g id="proc~~siesta_forces~~UsesGraph_edge31" class="edge"><title>proc~siesta_forces&#45;&gt;m_forces</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M538.896,-894.681C533.812,-840.528 510.996,-624.13 467,-575 460.597,-567.85 451.671,-563.132 442.584,-560.02"/>
<polygon fill="#000000" stroke="#000000" points="443.348,-556.598 432.772,-557.234 441.435,-563.332 443.348,-556.598"/>
</g>
<!-- m_scfconvergence_test -->
<g id="proc~~siesta_forces~~UsesGraph_node33" class="node"><title>m_scfconvergence_test</title>
<polygon fill="#337ab7" stroke="#337ab7" points="467,-524 341,-524 341,-500 467,-500 467,-524"/>
<text text-anchor="middle" x="404" y="-509.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_scfconvergence_test</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_scfconvergence_test -->
<g id="proc~~siesta_forces~~UsesGraph_edge32" class="edge"><title>proc~siesta_forces&#45;&gt;m_scfconvergence_test</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.229,-894.73C535.341,-836.572 516.099,-589.152 467,-533 466.137,-532.013 465.227,-531.073 464.274,-530.177"/>
<polygon fill="#000000" stroke="#000000" points="466.342,-527.353 456.248,-524.134 462.132,-532.945 466.342,-527.353"/>
</g>
<!-- m_transiesta -->
<g id="proc~~siesta_forces~~UsesGraph_node34" class="node"><title>m_transiesta</title>
<polygon fill="#337ab7" stroke="#337ab7" points="441,-482 367,-482 367,-458 441,-458 441,-482"/>
<text text-anchor="middle" x="404" y="-467.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_transiesta</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_transiesta -->
<g id="proc~~siesta_forces~~UsesGraph_edge2" class="edge"><title>proc~siesta_forces&#45;&gt;m_transiesta</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.488,-894.626C536.674,-832.4 521.183,-554.171 467,-491 462.576,-485.842 456.836,-481.948 450.636,-479.008"/>
<polygon fill="#000000" stroke="#000000" points="451.91,-475.749 441.323,-475.349 449.35,-482.264 451.91,-475.749"/>
</g>
<!-- module~m_setup_hamiltonian -->
<g id="proc~~siesta_forces~~UsesGraph_node35" class="node"><title>module~m_setup_hamiltonian</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node35"><a xlink:href=".././module/m_setup_hamiltonian.html" xlink:title="m_setup_hamiltonian">
<polygon fill="#337ab7" stroke="#337ab7" points="461.5,-440 346.5,-440 346.5,-416 461.5,-416 461.5,-440"/>
<text text-anchor="middle" x="404" y="-425.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_setup_hamiltonian</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;module~m_setup_hamiltonian -->
<g id="proc~~siesta_forces~~UsesGraph_edge34" class="edge"><title>proc~siesta_forces&#45;&gt;module~m_setup_hamiltonian</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.708,-894.714C537.908,-828.988 526.342,-519.291 467,-449 466.155,-447.999 465.26,-447.045 464.321,-446.137"/>
<polygon fill="#000000" stroke="#000000" points="466.438,-443.349 456.378,-440.023 462.168,-448.896 466.438,-443.349"/>
</g>
<!-- siesta_master -->
<g id="proc~~siesta_forces~~UsesGraph_node36" class="node"><title>siesta_master</title>
<polygon fill="#337ab7" stroke="#337ab7" points="443.5,-398 364.5,-398 364.5,-374 443.5,-374 443.5,-398"/>
<text text-anchor="middle" x="404" y="-383.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_master</text>
</g>
<!-- proc~siesta_forces&#45;&gt;siesta_master -->
<g id="proc~~siesta_forces~~UsesGraph_edge35" class="edge"><title>proc~siesta_forces&#45;&gt;siesta_master</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.892,-894.974C539.041,-826.339 531.574,-484.511 467,-407 463.179,-402.413 458.315,-398.825 452.998,-396.018"/>
<polygon fill="#000000" stroke="#000000" points="454.292,-392.764 443.725,-391.993 451.505,-399.185 454.292,-392.764"/>
</g>
<!-- m_iodm_old -->
<g id="proc~~siesta_forces~~UsesGraph_node37" class="node"><title>m_iodm_old</title>
<polygon fill="#337ab7" stroke="#337ab7" points="439.5,-356 368.5,-356 368.5,-332 439.5,-332 439.5,-356"/>
<text text-anchor="middle" x="404" y="-341.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_iodm_old</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_iodm_old -->
<g id="proc~~siesta_forces~~UsesGraph_edge36" class="edge"><title>proc~siesta_forces&#45;&gt;m_iodm_old</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M540.042,-894.924C540.056,-822.842 536.724,-449.644 467,-365 462.281,-359.271 455.934,-355.098 449.097,-352.061"/>
<polygon fill="#000000" stroke="#000000" points="450.172,-348.727 439.578,-348.583 447.769,-355.302 450.172,-348.727"/>
</g>
<!-- module~precision -->
<g id="proc~~siesta_forces~~UsesGraph_node38" class="node"><title>module~precision</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node38"><a xlink:href=".././module/precision.html" xlink:title="precision">
<polygon fill="#337ab7" stroke="#337ab7" points="88.5,-210 33.5,-210 33.5,-186 88.5,-186 88.5,-210"/>
<text text-anchor="middle" x="61" y="-195.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">precision</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;module~precision -->
<g id="proc~~siesta_forces~~UsesGraph_edge37" class="edge"><title>proc~siesta_forces&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M538.912,-919.277C534.112,-970.355 512.984,-1165.04 467,-1201 422.888,-1235.5 385.959,-1234.39 341,-1201 173.044,-1076.27 80.7044,-356.968 64.5636,-220.388"/>
<polygon fill="#000000" stroke="#000000" points="68.0192,-219.803 63.383,-210.277 61.0664,-220.615 68.0192,-219.803"/>
</g>
<!-- module~m_compute_dm -->
<g id="proc~~siesta_forces~~UsesGraph_node39" class="node"><title>module~m_compute_dm</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node39"><a xlink:href=".././module/m_compute_dm.html" xlink:title="m_compute_dm">
<polygon fill="#337ab7" stroke="#337ab7" points="449,-272 359,-272 359,-248 449,-248 449,-272"/>
<text text-anchor="middle" x="404" y="-257.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_compute_dm</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;module~m_compute_dm -->
<g id="proc~~siesta_forces~~UsesGraph_edge38" class="edge"><title>proc~siesta_forces&#45;&gt;module~m_compute_dm</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M540.285,-894.897C541.888,-816.439 547.082,-379.999 467,-281 464.459,-277.859 461.429,-275.186 458.094,-272.91"/>
<polygon fill="#000000" stroke="#000000" points="459.725,-269.813 449.28,-268.035 456.337,-275.938 459.725,-269.813"/>
</g>
<!-- fdf -->
<g id="proc~~siesta_forces~~UsesGraph_node40" class="node"><title>fdf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="431,-230 377,-230 377,-206 431,-206 431,-230"/>
<text text-anchor="middle" x="404" y="-215.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fdf</text>
</g>
<!-- proc~siesta_forces&#45;&gt;fdf -->
<g id="proc~~siesta_forces~~UsesGraph_edge39" class="edge"><title>proc~siesta_forces&#45;&gt;fdf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.448,-894.785C535.446,-808.466 509.821,-292.33 467,-239 460.49,-230.892 450.712,-225.897 440.836,-222.826"/>
<polygon fill="#000000" stroke="#000000" points="441.596,-219.408 431.043,-220.351 439.881,-226.194 441.596,-219.408"/>
</g>
<!-- m_initwf -->
<g id="proc~~siesta_forces~~UsesGraph_node41" class="node"><title>m_initwf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="431,-188 377,-188 377,-164 431,-164 431,-188"/>
<text text-anchor="middle" x="404" y="-173.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_initwf</text>
</g>
<!-- proc~siesta_forces&#45;&gt;m_initwf -->
<g id="proc~~siesta_forces~~UsesGraph_edge40" class="edge"><title>proc~siesta_forces&#45;&gt;m_initwf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.535,-894.885C536.013,-805.802 512.446,-253.971 467,-197 460.515,-188.871 450.746,-183.87 440.868,-180.8"/>
<polygon fill="#000000" stroke="#000000" points="441.624,-177.381 431.071,-178.329 439.912,-184.168 441.624,-177.381"/>
</g>
<!-- sparse_matrices -->
<g id="proc~~siesta_forces~~UsesGraph_node42" class="node"><title>sparse_matrices</title>
<polygon fill="#337ab7" stroke="#337ab7" points="449.5,-146 358.5,-146 358.5,-122 449.5,-122 449.5,-146"/>
<text text-anchor="middle" x="404" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sparse_matrices</text>
</g>
<!-- proc~siesta_forces&#45;&gt;sparse_matrices -->
<g id="proc~~siesta_forces~~UsesGraph_edge41" class="edge"><title>proc~siesta_forces&#45;&gt;sparse_matrices</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.604,-894.765C536.508,-802.319 515.037,-215.572 467,-155 464.599,-151.973 461.742,-149.379 458.593,-147.157"/>
<polygon fill="#000000" stroke="#000000" points="460.111,-143.994 449.686,-142.102 456.655,-150.082 460.111,-143.994"/>
</g>
<!-- atomlist -->
<g id="proc~~siesta_forces~~UsesGraph_node43" class="node"><title>atomlist</title>
<polygon fill="#337ab7" stroke="#337ab7" points="431,-104 377,-104 377,-80 431,-80 431,-104"/>
<text text-anchor="middle" x="404" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">atomlist</text>
</g>
<!-- proc~siesta_forces&#45;&gt;atomlist -->
<g id="proc~~siesta_forces~~UsesGraph_edge42" class="edge"><title>proc~siesta_forces&#45;&gt;atomlist</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.676,-895C537.025,-800.435 517.693,-177.257 467,-113 460.559,-104.836 450.802,-99.8254 440.922,-96.7567"/>
<polygon fill="#000000" stroke="#000000" points="441.671,-93.3362 431.119,-94.2906 439.963,-100.125 441.671,-93.3362"/>
</g>
<!-- module~m_rhog -->
<g id="proc~~siesta_forces~~UsesGraph_node44" class="node"><title>module~m_rhog</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node44"><a xlink:href=".././module/m_rhog.html" xlink:title="m_rhog">
<polygon fill="#337ab7" stroke="#337ab7" points="431,-314 377,-314 377,-290 431,-290 431,-314"/>
<text text-anchor="middle" x="404" y="-299.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_rhog</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;module~m_rhog -->
<g id="proc~~siesta_forces~~UsesGraph_edge43" class="edge"><title>proc~siesta_forces&#45;&gt;module~m_rhog</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M540.171,-894.986C541.002,-819.853 541.923,-414.843 467,-323 460.481,-315.008 450.792,-310.044 441.001,-306.964"/>
<polygon fill="#000000" stroke="#000000" points="441.845,-303.568 431.289,-304.471 440.104,-310.348 441.845,-303.568"/>
</g>
<!-- module~m_mixing_scf -->
<g id="proc~~siesta_forces~~UsesGraph_node45" class="node"><title>module~m_mixing_scf</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node45"><a xlink:href=".././module/m_mixing_scf.html" xlink:title="m_mixing_scf">
<polygon fill="#337ab7" stroke="#337ab7" points="443,-24 365,-24 365,-0 443,-0 443,-24"/>
<text text-anchor="middle" x="404" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_mixing_scf</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;module~m_mixing_scf -->
<g id="proc~~siesta_forces~~UsesGraph_edge44" class="edge"><title>proc~siesta_forces&#45;&gt;module~m_mixing_scf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.733,-894.867C537.435,-795.005 519.815,-110.625 467,-38 463.171,-32.7343 458.067,-28.529 452.425,-25.1718"/>
<polygon fill="#000000" stroke="#000000" points="453.732,-21.912 443.223,-20.564 450.597,-28.1711 453.732,-21.912"/>
</g>
<!-- module~m_state_analysis&#45;&gt;write_subs -->
<g id="proc~~siesta_forces~~UsesGraph_edge45" class="edge"><title>module~m_state_analysis&#45;&gt;write_subs</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M356.41,-1723.47C330.615,-1726.49 298.828,-1730.22 273.908,-1733.14"/>
<polygon fill="#000000" stroke="#000000" points="273.21,-1729.7 263.686,-1734.34 274.025,-1736.65 273.21,-1729.7"/>
</g>
<!-- module~m_compute_max_diff&#45;&gt;module~precision -->
<g id="proc~~siesta_forces~~UsesGraph_edge46" class="edge"><title>module~m_compute_max_diff&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M180.856,-169.08C154.524,-175.487 122.733,-183.222 98.6577,-189.08"/>
<polygon fill="#000000" stroke="#000000" points="97.7397,-185.701 88.8507,-191.467 99.3947,-192.503 97.7397,-185.701"/>
</g>
<!-- module~units&#45;&gt;module~precision -->
<g id="proc~~siesta_forces~~UsesGraph_edge47" class="edge"><title>module~units&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M210.708,-1288.84C193.547,-1277.1 169.684,-1257.67 158,-1234 65.634,-1046.91 61.795,-353.825 61.9254,-220.329"/>
<polygon fill="#000000" stroke="#000000" points="65.4257,-220.116 61.9448,-210.109 58.4257,-220.102 65.4257,-220.116"/>
</g>
<!-- module~m_rhog&#45;&gt;m_spin -->
<g id="proc~~siesta_forces~~UsesGraph_edge50" class="edge"><title>module~m_rhog&#45;&gt;m_spin</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M376.971,-305.805C364.804,-308.74 350.861,-313.911 341,-323 271.535,-387.027 244.504,-503.181 235.91,-551.733"/>
<polygon fill="#000000" stroke="#000000" points="232.426,-551.35 234.226,-561.791 239.33,-552.506 232.426,-551.35"/>
</g>
<!-- module~m_rhog&#45;&gt;module~precision -->
<g id="proc~~siesta_forces~~UsesGraph_edge48" class="edge"><title>module~m_rhog&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M230.5,-198C187.595,-181.792 134.044,-185.436 98.9786,-190.696"/>
<polygon fill="#000000" stroke="#000000" points="98.0324,-187.304 88.722,-192.36 99.1534,-194.213 98.0324,-187.304"/>
</g>
<!-- class_Fstack_Pair_dData1D -->
<g id="proc~~siesta_forces~~UsesGraph_node48" class="node"><title>class_Fstack_Pair_dData1D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="305,-335 158,-335 158,-311 305,-311 305,-335"/>
<text text-anchor="middle" x="231.5" y="-320.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_Fstack_Pair_dData1D</text>
</g>
<!-- module~m_rhog&#45;&gt;class_Fstack_Pair_dData1D -->
<g id="proc~~siesta_forces~~UsesGraph_edge51" class="edge"><title>module~m_rhog&#45;&gt;class_Fstack_Pair_dData1D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M376.733,-305.235C360.127,-307.281 337.664,-310.047 315.414,-312.788"/>
<polygon fill="#000000" stroke="#000000" points="314.725,-309.346 305.228,-314.042 315.58,-316.294 314.725,-309.346"/>
</g>
<!-- class_dData1D -->
<g id="proc~~siesta_forces~~UsesGraph_node49" class="node"><title>class_dData1D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="103.5,-148 18.5,-148 18.5,-124 103.5,-124 103.5,-148"/>
<text text-anchor="middle" x="61" y="-133.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_dData1D</text>
</g>
<!-- module~m_rhog&#45;&gt;class_dData1D -->
<g id="proc~~siesta_forces~~UsesGraph_edge52" class="edge"><title>module~m_rhog&#45;&gt;class_dData1D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M376.879,-295.225C365.503,-291.756 352.232,-286.988 341,-281 287.424,-252.437 289.296,-219.456 232.5,-198"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M230.5,-198C199.231,-186.187 189.504,-189.172 158,-178 137.168,-170.612 114.486,-160.777 96.402,-152.481"/>
<polygon fill="#000000" stroke="#000000" points="97.4136,-149.091 86.8695,-148.055 94.4661,-155.441 97.4136,-149.091"/>
</g>
<!-- class_Pair_dData1D -->
<g id="proc~~siesta_forces~~UsesGraph_node50" class="node"><title>class_Pair_dData1D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="286,-293 177,-293 177,-269 286,-269 286,-293"/>
<text text-anchor="middle" x="231.5" y="-278.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_Pair_dData1D</text>
</g>
<!-- module~m_rhog&#45;&gt;class_Pair_dData1D -->
<g id="proc~~siesta_forces~~UsesGraph_edge49" class="edge"><title>module~m_rhog&#45;&gt;class_Pair_dData1D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M376.733,-298.765C355.352,-296.131 324.262,-292.302 296.417,-288.872"/>
<polygon fill="#000000" stroke="#000000" points="296.682,-285.379 286.329,-287.63 295.826,-292.326 296.682,-285.379"/>
</g>
<!-- module~m_mixing -->
<g id="proc~~siesta_forces~~UsesGraph_node46" class="node"><title>module~m_mixing</title>
<g id="a_proc~~siesta_forces~~UsesGraph_node46"><a xlink:href=".././module/m_mixing.html" xlink:title="m_mixing">
<polygon fill="#337ab7" stroke="#337ab7" points="260.5,-127 202.5,-127 202.5,-103 260.5,-103 260.5,-127"/>
<text text-anchor="middle" x="231.5" y="-112.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_mixing</text>
</a>
</g>
</g>
<!-- module~m_mixing_scf&#45;&gt;module~m_mixing -->
<g id="proc~~siesta_forces~~UsesGraph_edge54" class="edge"><title>module~m_mixing_scf&#45;&gt;module~m_mixing</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M370.504,-24.0507C360.803,-28.0649 350.285,-32.8414 341,-38 309.767,-55.3532 276.664,-79.8491 255.354,-96.5198"/>
<polygon fill="#000000" stroke="#000000" points="252.927,-93.9774 247.254,-102.926 257.269,-99.4681 252.927,-93.9774"/>
</g>
<!-- class_Fstack_dData1D -->
<g id="proc~~siesta_forces~~UsesGraph_node47" class="node"><title>class_Fstack_dData1D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="122,-66 -7.10543e-15,-66 -7.10543e-15,-42 122,-42 122,-66"/>
<text text-anchor="middle" x="61" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_Fstack_dData1D</text>
</g>
<!-- module~m_mixing_scf&#45;&gt;class_Fstack_dData1D -->
<g id="proc~~siesta_forces~~UsesGraph_edge53" class="edge"><title>module~m_mixing_scf&#45;&gt;class_Fstack_dData1D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M364.876,-16.6957C308.721,-23.6121 202.821,-36.6555 132.324,-45.3383"/>
<polygon fill="#000000" stroke="#000000" points="131.688,-41.8902 122.19,-46.5865 132.543,-48.8377 131.688,-41.8902"/>
</g>
<!-- module~m_mixing&#45;&gt;module~precision -->
<g id="proc~~siesta_forces~~UsesGraph_edge55" class="edge"><title>module~m_mixing&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M202.276,-121.137C188.573,-124.624 172.07,-129.586 158,-136 143.913,-142.421 111.324,-164.055 88.0272,-179.967"/>
<polygon fill="#000000" stroke="#000000" points="85.8766,-177.198 79.6113,-185.742 89.8371,-182.97 85.8766,-177.198"/>
</g>
<!-- module~m_mixing&#45;&gt;class_Fstack_dData1D -->
<g id="proc~~siesta_forces~~UsesGraph_edge56" class="edge"><title>module~m_mixing&#45;&gt;class_Fstack_dData1D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M202.297,-104.79C175.667,-95.1496 135.366,-80.5598 104.78,-69.4871"/>
<polygon fill="#000000" stroke="#000000" points="105.814,-66.1394 95.2202,-66.0263 103.432,-72.7214 105.814,-66.1394"/>
</g>
<!-- module~m_mixing&#45;&gt;class_dData1D -->
<g id="proc~~siesta_forces~~UsesGraph_edge57" class="edge"><title>module~m_mixing&#45;&gt;class_dData1D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M202.297,-118.515C178.161,-121.523 142.793,-125.931 113.608,-129.568"/>
<polygon fill="#000000" stroke="#000000" points="113.061,-126.109 103.571,-130.819 113.927,-133.055 113.061,-126.109"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="490pt" height="32pt"
 viewBox="0.00 0.00 489.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 485.5,-28 485.5,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node"><title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node"><title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="139.5,-24 72.5,-24 72.5,-0 139.5,-0 139.5,-24"/>
<text text-anchor="middle" x="106" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="222,-24 158,-24 158,-0 222,-0 222,-24"/>
<text text-anchor="middle" x="190" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="294,-24 240,-24 240,-0 294,-0 294,-24"/>
<text text-anchor="middle" x="267" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="366,-24 312,-24 312,-0 366,-0 366,-24"/>
<text text-anchor="middle" x="339" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="481.5,-24 384.5,-24 384.5,-0 481.5,-0 481.5,-24"/>
<text text-anchor="middle" x="433" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses.
    </p>
    </div></div></div></div>
      </li>
      
      </ul>
    </div>
    


    
    <p>This subroutine represents central SIESTA operation logic.</p>
<p></p><div class="alert alert-success" role="alert"><h4>Todo</h4><p>It might be better to split the two,
  putting the grid initialization into <strong>state_init (link!)</strong> and moving the
  calculation of <script type="math/tex"> H_0 </script> to the body of the loop, done <code>if first_scf=.true.</code>
  This would suit <em>analysis</em> runs in which <strong>nscf = 0</strong>
</p></div>
<p>
<p>The dHmax variable only has meaning for Hamiltonian
  mixing, or when requiring the Hamiltonian to be converged.</p>
<h1>SCF loop</h1>
<p>The current structure of the loop tries to reproduce the
  historical Siesta usage. It should be made more clear.</p>
<p>Two changes:</p>
<ol>
<li>The number of scf iterations performed is exactly
     equal to the number specified (i.e., the "forces"
     phase is not counted as a final scf step)</li>
<li>At the change to a TranSiesta GF run the variable "first_scf"
     is implicitly reset to "true".</li>
</ol>
<h2>Start of SCF cycle</h2>
<p>Conditions of exit:</p>
<ul>
<li>At the top, to catch a non-positive nscf and # of iterations</li>
<li>At the bottom, based on convergence</li>
</ul>
<p>Note implications for TranSiesta when mixing <script type="math/tex">H</script>.
  Now <script type="math/tex">H</script> will be recomputed instead of simply being
  inherited, however, this is required as if
  we have bias calculations as the electric
  field across the junction needs to be present.</p>
<p><strong>end of SCF cycle</strong></p>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-istep"></span>integer,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>istep</strong></td><td></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~siesta_forces~~CallsGraph Pages: 1 -->
<svg id="procsiesta_forcesCallsGraph" width="641pt" height="3634pt"
 viewBox="0.00 0.00 641.00 3633.72" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~siesta_forces~~CallsGraph" class="graph" transform="scale(0.596279 0.596279) rotate(0) translate(4 6090)">
<title>proc~~siesta_forces~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-6090 1071,-6090 1071,4 -4,4"/>
<!-- proc~siesta_forces -->
<g id="proc~~siesta_forces~~CallsGraph_node1" class="node"><title>proc~siesta_forces</title>
<polygon fill="none" stroke="black" points="76,-1904 0,-1904 0,-1880 76,-1880 76,-1904"/>
<text text-anchor="middle" x="38" y="-1889.6" font-family="Helvetica,sans-Serif" font-size="10.50">siesta_forces</text>
</g>
<!-- proc~state_init -->
<g id="proc~~siesta_forces~~CallsGraph_node2" class="node"><title>proc~state_init</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node2"><a xlink:href=".././proc/state_init.html" xlink:title="state_init">
<polygon fill="#d9534f" stroke="#d9534f" points="355.5,-1548 300.5,-1548 300.5,-1524 355.5,-1524 355.5,-1548"/>
<text text-anchor="middle" x="328" y="-1533.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">state_init</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;proc~state_init -->
<g id="proc~~siesta_forces~~CallsGraph_edge1" class="edge"><title>proc~siesta_forces&#45;&gt;proc~state_init</title>
<path fill="none" stroke="#000000" d="M43.1876,-1904.34C51.8179,-1927.55 74.0251,-1977.15 112,-1997 159.66,-2021.91 191.347,-2031.02 233,-1997 302.326,-1940.38 321.845,-1642.84 326.027,-1558.38"/>
<polygon fill="#000000" stroke="#000000" points="329.526,-1558.48 326.501,-1548.33 322.534,-1558.15 329.526,-1558.48"/>
</g>
<!-- scfconvergence_test -->
<g id="proc~~siesta_forces~~CallsGraph_node3" class="node"><title>scfconvergence_test</title>
<polygon fill="#777777" stroke="#777777" points="228,-1946 117,-1946 117,-1922 228,-1922 228,-1946"/>
<text text-anchor="middle" x="172.5" y="-1931.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">scfconvergence_test</text>
</g>
<!-- proc~siesta_forces&#45;&gt;scfconvergence_test -->
<g id="proc~~siesta_forces~~CallsGraph_edge2" class="edge"><title>proc~siesta_forces&#45;&gt;scfconvergence_test</title>
<path fill="none" stroke="#000000" d="M76.2612,-1903.81C91.0939,-1908.51 108.341,-1913.98 124.051,-1918.96"/>
<polygon fill="#000000" stroke="#000000" points="123.009,-1922.3 133.599,-1921.99 125.124,-1915.63 123.009,-1922.3"/>
</g>
<!-- set_tolerance -->
<g id="proc~~siesta_forces~~CallsGraph_node4" class="node"><title>set_tolerance</title>
<polygon fill="#777777" stroke="#777777" points="211,-1904 134,-1904 134,-1880 211,-1880 211,-1904"/>
<text text-anchor="middle" x="172.5" y="-1889.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_tolerance</text>
</g>
<!-- proc~siesta_forces&#45;&gt;set_tolerance -->
<g id="proc~~siesta_forces~~CallsGraph_edge10" class="edge"><title>proc~siesta_forces&#45;&gt;set_tolerance</title>
<path fill="none" stroke="#000000" d="M76.2612,-1892C90.8141,-1892 107.691,-1892 123.16,-1892"/>
<polygon fill="#000000" stroke="#000000" points="123.599,-1895.5 133.599,-1892 123.599,-1888.5 123.599,-1895.5"/>
</g>
<!-- fdf_get -->
<g id="proc~~siesta_forces~~CallsGraph_node5" class="node"><title>fdf_get</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-6002 471.5,-6002 471.5,-5978 525.5,-5978 525.5,-6002"/>
<text text-anchor="middle" x="498.5" y="-5987.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fdf_get</text>
</g>
<!-- proc~siesta_forces&#45;&gt;fdf_get -->
<g id="proc~~siesta_forces~~CallsGraph_edge18" class="edge"><title>proc~siesta_forces&#45;&gt;fdf_get</title>
<path fill="none" stroke="#000000" d="M39.0188,-1904.35C39.4094,-2145.11 46.4518,-5826.13 112,-5912 154.251,-5967.35 373.876,-5984.02 461.423,-5988.5"/>
<polygon fill="#000000" stroke="#000000" points="461.265,-5992 471.424,-5988.99 461.606,-5985.01 461.265,-5992"/>
</g>
<!-- message -->
<g id="proc~~siesta_forces~~CallsGraph_node6" class="node"><title>message</title>
<polygon fill="#777777" stroke="#777777" points="200.5,-1862 144.5,-1862 144.5,-1838 200.5,-1838 200.5,-1862"/>
<text text-anchor="middle" x="172.5" y="-1847.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">message</text>
</g>
<!-- proc~siesta_forces&#45;&gt;message -->
<g id="proc~~siesta_forces~~CallsGraph_edge5" class="edge"><title>proc~siesta_forces&#45;&gt;message</title>
<path fill="none" stroke="#000000" d="M76.2612,-1880.19C94.4738,-1874.42 116.327,-1867.49 134.504,-1861.73"/>
<polygon fill="#000000" stroke="#000000" points="135.703,-1865.02 144.178,-1858.66 133.588,-1858.35 135.703,-1865.02"/>
</g>
<!-- proc~mixers_scf_history_init -->
<g id="proc~~siesta_forces~~CallsGraph_node7" class="node"><title>proc~mixers_scf_history_init</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node7"><a xlink:href=".././proc/mixers_scf_history_init.html" xlink:title="mixers_scf_history_init">
<polygon fill="#d9534f" stroke="#d9534f" points="233,-1988 112,-1988 112,-1964 233,-1964 233,-1988"/>
<text text-anchor="middle" x="172.5" y="-1973.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mixers_scf_history_init</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;proc~mixers_scf_history_init -->
<g id="proc~~siesta_forces~~CallsGraph_edge11" class="edge"><title>proc~siesta_forces&#45;&gt;proc~mixers_scf_history_init</title>
<path fill="none" stroke="#000000" d="M50.3237,-1904.21C63.8364,-1918.17 87.6725,-1940.89 112,-1955 115.029,-1956.76 118.23,-1958.4 121.512,-1959.94"/>
<polygon fill="#000000" stroke="#000000" points="120.331,-1963.24 130.901,-1963.97 123.093,-1956.81 120.331,-1963.24"/>
</g>
<!-- interface~compute_max_diff -->
<g id="proc~~siesta_forces~~CallsGraph_node8" class="node"><title>interface~compute_max_diff</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node8"><a xlink:href=".././interface/compute_max_diff.html" xlink:title="compute_max_diff">
<polygon fill="#a7506f" stroke="#a7506f" points="222.5,-1782 122.5,-1782 122.5,-1758 222.5,-1758 222.5,-1782"/>
<text text-anchor="middle" x="172.5" y="-1767.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_max_diff</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;interface~compute_max_diff -->
<g id="proc~~siesta_forces~~CallsGraph_edge7" class="edge"><title>proc~siesta_forces&#45;&gt;interface~compute_max_diff</title>
<path fill="none" stroke="#000000" d="M45.5224,-1879.79C56.7215,-1859.84 81.3855,-1820.07 112,-1796 116.431,-1792.52 121.401,-1789.4 126.53,-1786.64"/>
<polygon fill="#000000" stroke="#000000" points="128.42,-1789.62 135.853,-1782.07 125.334,-1783.33 128.42,-1789.62"/>
</g>
<!-- write_spmatrix -->
<g id="proc~~siesta_forces~~CallsGraph_node9" class="node"><title>write_spmatrix</title>
<polygon fill="#777777" stroke="#777777" points="213.5,-1740 131.5,-1740 131.5,-1716 213.5,-1716 213.5,-1740"/>
<text text-anchor="middle" x="172.5" y="-1725.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_spmatrix</text>
</g>
<!-- proc~siesta_forces&#45;&gt;write_spmatrix -->
<g id="proc~~siesta_forces~~CallsGraph_edge8" class="edge"><title>proc~siesta_forces&#45;&gt;write_spmatrix</title>
<path fill="none" stroke="#000000" d="M41.9295,-1879.74C49.0925,-1852.35 70.0529,-1785.72 112,-1749 115.065,-1746.32 118.495,-1743.97 122.12,-1741.92"/>
<polygon fill="#000000" stroke="#000000" points="123.961,-1744.92 131.432,-1737.4 120.907,-1738.62 123.961,-1744.92"/>
</g>
<!-- proc~bye -->
<g id="proc~~siesta_forces~~CallsGraph_node10" class="node"><title>proc~bye</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node10"><a xlink:href=".././proc/bye.html" xlink:title="bye">
<polygon fill="#d9534f" stroke="#d9534f" points="525.5,-3592 471.5,-3592 471.5,-3568 525.5,-3568 525.5,-3592"/>
<text text-anchor="middle" x="498.5" y="-3577.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bye</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;proc~bye -->
<g id="proc~~siesta_forces~~CallsGraph_edge9" class="edge"><title>proc~siesta_forces&#45;&gt;proc~bye</title>
<path fill="none" stroke="#000000" d="M39.2277,-1904.37C41.8029,-2041.65 66.209,-3276.46 112,-3337 189.834,-3439.9 292.616,-3342.03 387,-3430 417.312,-3458.25 398.63,-3482.49 423,-3516 436.115,-3534.04 455.274,-3550.35 470.878,-3561.99"/>
<polygon fill="#000000" stroke="#000000" points="468.968,-3564.93 479.12,-3567.96 473.073,-3559.26 468.968,-3564.93"/>
</g>
<!-- save_density_matrix -->
<g id="proc~~siesta_forces~~CallsGraph_node11" class="node"><title>save_density_matrix</title>
<polygon fill="#777777" stroke="#777777" points="227.5,-1698 117.5,-1698 117.5,-1674 227.5,-1674 227.5,-1698"/>
<text text-anchor="middle" x="172.5" y="-1683.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_density_matrix</text>
</g>
<!-- proc~siesta_forces&#45;&gt;save_density_matrix -->
<g id="proc~~siesta_forces~~CallsGraph_edge3" class="edge"><title>proc~siesta_forces&#45;&gt;save_density_matrix</title>
<path fill="none" stroke="#000000" d="M40.3443,-1879.71C44.5736,-1846.95 60.5458,-1756.61 112,-1707 113.247,-1705.8 114.567,-1704.66 115.946,-1703.59"/>
<polygon fill="#000000" stroke="#000000" points="117.886,-1706.51 124.396,-1698.15 114.094,-1700.62 117.886,-1706.51"/>
</g>
<!-- proc~state_analysis -->
<g id="proc~~siesta_forces~~CallsGraph_node12" class="node"><title>proc~state_analysis</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node12"><a xlink:href=".././proc/state_analysis.html" xlink:title="state_analysis">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-2915 288,-2915 288,-2891 368,-2891 368,-2915"/>
<text text-anchor="middle" x="328" y="-2900.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">state_analysis</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;proc~state_analysis -->
<g id="proc~~siesta_forces~~CallsGraph_edge26" class="edge"><title>proc~siesta_forces&#45;&gt;proc~state_analysis</title>
<path fill="none" stroke="#000000" d="M42.435,-1904.06C71.8783,-2007.42 281.609,-2743.66 320.726,-2880.98"/>
<polygon fill="#000000" stroke="#000000" points="317.416,-2882.13 323.522,-2890.79 324.148,-2880.21 317.416,-2882.13"/>
</g>
<!-- proc~compute_charge_diff -->
<g id="proc~~siesta_forces~~CallsGraph_node13" class="node"><title>proc~compute_charge_diff</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node13"><a xlink:href=".././proc/compute_charge_diff.html" xlink:title="compute_charge_diff">
<polygon fill="#d9534f" stroke="#d9534f" points="229,-5903 116,-5903 116,-5879 229,-5879 229,-5903"/>
<text text-anchor="middle" x="172.5" y="-5888.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_charge_diff</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;proc~compute_charge_diff -->
<g id="proc~~siesta_forces~~CallsGraph_edge12" class="edge"><title>proc~siesta_forces&#45;&gt;proc~compute_charge_diff</title>
<path fill="none" stroke="#000000" d="M39.0879,-1904.18C40.7668,-2134.53 66.4495,-5556.43 112,-5759 121.34,-5800.54 144.364,-5844.89 158.878,-5870.15"/>
<polygon fill="#000000" stroke="#000000" points="155.901,-5871.99 163.977,-5878.85 161.941,-5868.45 155.901,-5871.99"/>
</g>
<!-- proc~mixing_scf_converged -->
<g id="proc~~siesta_forces~~CallsGraph_node14" class="node"><title>proc~mixing_scf_converged</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node14"><a xlink:href=".././proc/mixing_scf_converged.html" xlink:title="mixing_scf_converged">
<polygon fill="#d9534f" stroke="#d9534f" points="232,-1656 113,-1656 113,-1632 232,-1632 232,-1656"/>
<text text-anchor="middle" x="172.5" y="-1641.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mixing_scf_converged</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;proc~mixing_scf_converged -->
<g id="proc~~siesta_forces~~CallsGraph_edge13" class="edge"><title>proc~siesta_forces&#45;&gt;proc~mixing_scf_converged</title>
<path fill="none" stroke="#000000" d="M39.3064,-1879.76C40.9074,-1842.3 50.8221,-1727.92 112,-1665 113.074,-1663.9 114.209,-1662.85 115.396,-1661.86"/>
<polygon fill="#000000" stroke="#000000" points="117.582,-1664.6 123.872,-1656.08 113.638,-1658.82 117.582,-1664.6"/>
</g>
<!-- dm_charge -->
<g id="proc~~siesta_forces~~CallsGraph_node15" class="node"><title>dm_charge</title>
<polygon fill="#777777" stroke="#777777" points="206,-1576 139,-1576 139,-1552 206,-1552 206,-1576"/>
<text text-anchor="middle" x="172.5" y="-1561.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dm_charge</text>
</g>
<!-- proc~siesta_forces&#45;&gt;dm_charge -->
<g id="proc~~siesta_forces~~CallsGraph_edge14" class="edge"><title>proc~siesta_forces&#45;&gt;dm_charge</title>
<path fill="none" stroke="#000000" d="M40.4847,-1879.86C46.8817,-1829.29 73.5198,-1635.87 112,-1590 116.782,-1584.3 123.053,-1579.81 129.727,-1576.29"/>
<polygon fill="#000000" stroke="#000000" points="131.338,-1579.4 138.977,-1572.06 128.427,-1573.03 131.338,-1579.4"/>
</g>
<!-- proc~setup_hamiltonian -->
<g id="proc~~siesta_forces~~CallsGraph_node16" class="node"><title>proc~setup_hamiltonian</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node16"><a xlink:href=".././proc/setup_hamiltonian.html" xlink:title="setup_hamiltonian">
<polygon fill="#d9534f" stroke="#d9534f" points="222.5,-3677 122.5,-3677 122.5,-3653 222.5,-3653 222.5,-3677"/>
<text text-anchor="middle" x="172.5" y="-3662.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_hamiltonian</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;proc~setup_hamiltonian -->
<g id="proc~~siesta_forces~~CallsGraph_edge6" class="edge"><title>proc~siesta_forces&#45;&gt;proc~setup_hamiltonian</title>
<path fill="none" stroke="#000000" d="M38.888,-1904.27C38.0758,-2009.22 35.1203,-2766.98 112,-3375 124.8,-3476.23 153.532,-3594.87 165.787,-3643.03"/>
<polygon fill="#000000" stroke="#000000" points="162.459,-3644.14 168.335,-3652.96 169.239,-3642.4 162.459,-3644.14"/>
</g>
<!-- post_scf_work -->
<g id="proc~~siesta_forces~~CallsGraph_node17" class="node"><title>post_scf_work</title>
<polygon fill="#777777" stroke="#777777" points="213,-1534 132,-1534 132,-1510 213,-1510 213,-1534"/>
<text text-anchor="middle" x="172.5" y="-1519.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">post_scf_work</text>
</g>
<!-- proc~siesta_forces&#45;&gt;post_scf_work -->
<g id="proc~~siesta_forces~~CallsGraph_edge15" class="edge"><title>proc~siesta_forces&#45;&gt;post_scf_work</title>
<path fill="none" stroke="#000000" d="M39.9654,-1879.82C44.5991,-1824.27 66.2431,-1595.29 112,-1543 115.044,-1539.52 118.702,-1536.62 122.688,-1534.2"/>
<polygon fill="#000000" stroke="#000000" points="124.45,-1537.23 131.828,-1529.63 121.319,-1530.97 124.45,-1537.23"/>
</g>
<!-- check_walltime -->
<g id="proc~~siesta_forces~~CallsGraph_node18" class="node"><title>check_walltime</title>
<polygon fill="#777777" stroke="#777777" points="215,-1492 130,-1492 130,-1468 215,-1468 215,-1492"/>
<text text-anchor="middle" x="172.5" y="-1477.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_walltime</text>
</g>
<!-- proc~siesta_forces&#45;&gt;check_walltime -->
<g id="proc~~siesta_forces~~CallsGraph_edge16" class="edge"><title>proc~siesta_forces&#45;&gt;check_walltime</title>
<path fill="none" stroke="#000000" d="M39.6586,-1879.99C43.1332,-1820.77 61.1399,-1560.41 112,-1501 114.61,-1497.95 117.692,-1495.34 121.057,-1493.12"/>
<polygon fill="#000000" stroke="#000000" points="122.777,-1496.17 129.898,-1488.32 119.439,-1490.01 122.777,-1496.17"/>
</g>
<!-- barrier -->
<g id="proc~~siesta_forces~~CallsGraph_node19" class="node"><title>barrier</title>
<polygon fill="#777777" stroke="#777777" points="199.5,-1450 145.5,-1450 145.5,-1426 199.5,-1426 199.5,-1450"/>
<text text-anchor="middle" x="172.5" y="-1435.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">barrier</text>
</g>
<!-- proc~siesta_forces&#45;&gt;barrier -->
<g id="proc~~siesta_forces~~CallsGraph_edge17" class="edge"><title>proc~siesta_forces&#45;&gt;barrier</title>
<path fill="none" stroke="#000000" d="M39.4213,-1879.98C41.859,-1817.01 56.0619,-1525.51 112,-1459 117.994,-1451.87 126.568,-1447.16 135.347,-1444.05"/>
<polygon fill="#000000" stroke="#000000" points="136.6,-1447.33 145.221,-1441.17 134.641,-1440.61 136.6,-1447.33"/>
</g>
<!-- proc~compute_dm -->
<g id="proc~~siesta_forces~~CallsGraph_node20" class="node"><title>proc~compute_dm</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node20"><a xlink:href=".././proc/compute_dm.html" xlink:title="compute_dm">
<polygon fill="#d9534f" stroke="#d9534f" points="365.5,-5414 290.5,-5414 290.5,-5390 365.5,-5390 365.5,-5414"/>
<text text-anchor="middle" x="328" y="-5399.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_dm</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;proc~compute_dm -->
<g id="proc~~siesta_forces~~CallsGraph_edge19" class="edge"><title>proc~siesta_forces&#45;&gt;proc~compute_dm</title>
<path fill="none" stroke="#000000" d="M39.2026,-1904.12C41.1969,-2019.82 58.3954,-2941.37 112,-3686 160.701,-4362.51 138.235,-4538.46 269,-5204 281.822,-5269.26 306.555,-5344.01 319.176,-5380.16"/>
<polygon fill="#000000" stroke="#000000" points="315.91,-5381.42 322.537,-5389.69 322.512,-5379.09 315.91,-5381.42"/>
</g>
<!-- proc~compute_energies -->
<g id="proc~~siesta_forces~~CallsGraph_node21" class="node"><title>proc~compute_energies</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node21"><a xlink:href=".././proc/compute_energies.html" xlink:title="compute_energies">
<polygon fill="#d9534f" stroke="#d9534f" points="378.5,-6036 277.5,-6036 277.5,-6012 378.5,-6012 378.5,-6036"/>
<text text-anchor="middle" x="328" y="-6021.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_energies</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;proc~compute_energies -->
<g id="proc~~siesta_forces~~CallsGraph_edge20" class="edge"><title>proc~siesta_forces&#45;&gt;proc~compute_energies</title>
<path fill="none" stroke="#000000" d="M38.9921,-1904.26C38.8624,-2147.1 38.0415,-5916.04 112,-5998 150.057,-6040.18 218.084,-6041.62 267.447,-6035.73"/>
<polygon fill="#000000" stroke="#000000" points="267.913,-6039.2 277.368,-6034.42 266.995,-6032.26 267.913,-6039.2"/>
</g>
<!-- initwf -->
<g id="proc~~siesta_forces~~CallsGraph_node22" class="node"><title>initwf</title>
<polygon fill="#777777" stroke="#777777" points="199.5,-1408 145.5,-1408 145.5,-1384 199.5,-1384 199.5,-1408"/>
<text text-anchor="middle" x="172.5" y="-1393.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">initwf</text>
</g>
<!-- proc~siesta_forces&#45;&gt;initwf -->
<g id="proc~~siesta_forces~~CallsGraph_edge21" class="edge"><title>proc~siesta_forces&#45;&gt;initwf</title>
<path fill="none" stroke="#000000" d="M39.2306,-1879.72C40.7284,-1812.6 51.0437,-1490.56 112,-1417 118.057,-1409.69 126.831,-1404.92 135.789,-1401.82"/>
<polygon fill="#000000" stroke="#000000" points="136.808,-1405.16 145.461,-1399.05 134.884,-1398.43 136.808,-1405.16"/>
</g>
<!-- reset -->
<g id="proc~~siesta_forces~~CallsGraph_node23" class="node"><title>reset</title>
<polygon fill="#777777" stroke="#777777" points="355,-1346 301,-1346 301,-1322 355,-1322 355,-1346"/>
<text text-anchor="middle" x="328" y="-1331.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reset</text>
</g>
<!-- proc~siesta_forces&#45;&gt;reset -->
<g id="proc~~siesta_forces~~CallsGraph_edge22" class="edge"><title>proc~siesta_forces&#45;&gt;reset</title>
<path fill="none" stroke="#000000" d="M38.4839,-1879.87C37.3919,-1838.05 39.5573,-1698.35 112,-1623 151.067,-1582.37 196.22,-1627.71 233,-1585 300.512,-1506.59 203.193,-1434.84 269,-1355 274.63,-1348.17 282.671,-1343.56 290.979,-1340.45"/>
<polygon fill="#000000" stroke="#000000" points="292.201,-1343.74 300.726,-1337.45 290.139,-1337.05 292.201,-1343.74"/>
</g>
<!-- mixer -->
<g id="proc~~siesta_forces~~CallsGraph_node24" class="node"><title>mixer</title>
<polygon fill="#777777" stroke="#777777" points="199.5,-1366 145.5,-1366 145.5,-1342 199.5,-1342 199.5,-1366"/>
<text text-anchor="middle" x="172.5" y="-1351.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mixer</text>
</g>
<!-- proc~siesta_forces&#45;&gt;mixer -->
<g id="proc~~siesta_forces~~CallsGraph_edge27" class="edge"><title>proc~siesta_forces&#45;&gt;mixer</title>
<path fill="none" stroke="#000000" d="M39.0629,-1879.58C39.664,-1808.7 45.9758,-1455.67 112,-1375 118.012,-1367.65 126.772,-1362.88 135.73,-1359.77"/>
<polygon fill="#000000" stroke="#000000" points="136.751,-1363.12 145.408,-1357.01 134.831,-1356.38 136.751,-1363.12"/>
</g>
<!-- proc~mix_rhog -->
<g id="proc~~siesta_forces~~CallsGraph_node25" class="node"><title>proc~mix_rhog</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node25"><a xlink:href=".././proc/mix_rhog.html" xlink:title="mix_rhog">
<polygon fill="#d9534f" stroke="#d9534f" points="356.5,-5918 299.5,-5918 299.5,-5894 356.5,-5894 356.5,-5918"/>
<text text-anchor="middle" x="328" y="-5903.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mix_rhog</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;proc~mix_rhog -->
<g id="proc~~siesta_forces~~CallsGraph_edge23" class="edge"><title>proc~siesta_forces&#45;&gt;proc~mix_rhog</title>
<path fill="none" stroke="#000000" d="M38.9893,-1904.27C38.8201,-2132.76 37.6153,-5478.56 112,-5667 151.547,-5767.19 253.654,-5852.14 301.523,-5887.9"/>
<polygon fill="#000000" stroke="#000000" points="299.675,-5890.88 309.803,-5893.99 303.825,-5885.25 299.675,-5890.88"/>
</g>
<!-- transiesta -->
<g id="proc~~siesta_forces~~CallsGraph_node26" class="node"><title>transiesta</title>
<polygon fill="#777777" stroke="#777777" points="528,-5876 469,-5876 469,-5852 528,-5852 528,-5876"/>
<text text-anchor="middle" x="498.5" y="-5861.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">transiesta</text>
</g>
<!-- proc~siesta_forces&#45;&gt;transiesta -->
<g id="proc~~siesta_forces~~CallsGraph_edge24" class="edge"><title>proc~siesta_forces&#45;&gt;transiesta</title>
<path fill="none" stroke="#000000" d="M39.1668,-1904.27C41.4261,-2068.25 66.5895,-3829.56 112,-4348 154.132,-4829 150.369,-4954.95 269,-5423 317.848,-5615.73 277.127,-5707.91 423,-5843 432.802,-5852.08 446.228,-5857.27 458.983,-5860.23"/>
<polygon fill="#000000" stroke="#000000" points="458.507,-5863.7 468.988,-5862.15 459.829,-5856.83 458.507,-5863.7"/>
</g>
<!-- die -->
<g id="proc~~siesta_forces~~CallsGraph_node27" class="node"><title>die</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-24 471.5,-24 471.5,-0 525.5,-0 525.5,-24"/>
<text text-anchor="middle" x="498.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">die</text>
</g>
<!-- proc~siesta_forces&#45;&gt;die -->
<g id="proc~~siesta_forces~~CallsGraph_edge25" class="edge"><title>proc~siesta_forces&#45;&gt;die</title>
<path fill="none" stroke="#000000" d="M50.2374,-1879.64C63.6692,-1865.54 87.4293,-1842.68 112,-1829 161.245,-1801.57 197.144,-1834.49 233,-1791 323.758,-1680.91 176.514,-1580.64 269,-1472 304.3,-1430.53 353.532,-1481.96 387,-1439 483.042,-1315.72 327.085,-156.376 423,-33 432.093,-21.3042 447.17,-15.7873 461.391,-13.2965"/>
<polygon fill="#000000" stroke="#000000" points="462.036,-16.7419 471.497,-11.9725 461.127,-9.8012 462.036,-16.7419"/>
</g>
<!-- timer -->
<g id="proc~~siesta_forces~~CallsGraph_node28" class="node"><title>timer</title>
<polygon fill="#777777" stroke="#777777" points="1060.5,-3502 1006.5,-3502 1006.5,-3478 1060.5,-3478 1060.5,-3502"/>
<text text-anchor="middle" x="1033.5" y="-3487.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">timer</text>
</g>
<!-- proc~siesta_forces&#45;&gt;timer -->
<g id="proc~~siesta_forces~~CallsGraph_edge4" class="edge"><title>proc~siesta_forces&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M40.3103,-1904.26C46.2728,-1958.97 72.2775,-2186.02 112,-2369 125.201,-2429.81 373.153,-3407.76 423,-3445 476.761,-3485.17 521.911,-3487.32 574,-3445 634.619,-3395.76 549.381,-3322.24 610,-3273 615.988,-3268.14 807.51,-3268.76 842,-3274 898.017,-3282.52 923.223,-3271.66 964,-3311 999.503,-3345.25 982.065,-3370.04 1000,-3416 1007,-3433.95 1015.85,-3453.93 1022.54,-3468.6"/>
<polygon fill="#000000" stroke="#000000" points="1019.42,-3470.2 1026.78,-3477.82 1025.78,-3467.28 1019.42,-3470.2"/>
</g>
<!-- proc~state_init&#45;&gt;fdf_get -->
<g id="proc~~siesta_forces~~CallsGraph_edge38" class="edge"><title>proc~state_init&#45;&gt;fdf_get</title>
<path fill="none" stroke="#000000" d="M329.678,-1548.3C335.116,-1647.57 371.85,-2328.46 387,-2882 388.173,-2924.86 396.92,-5934.97 423,-5969 432.011,-5980.76 447.077,-5986.28 461.311,-5988.76"/>
<polygon fill="#000000" stroke="#000000" points="461.064,-5992.26 471.431,-5990.08 461.965,-5985.32 461.064,-5992.26"/>
</g>
<!-- proc~state_init&#45;&gt;proc~bye -->
<g id="proc~~siesta_forces~~CallsGraph_edge76" class="edge"><title>proc~state_init&#45;&gt;proc~bye</title>
<path fill="none" stroke="#000000" d="M329.52,-1548.11C336.384,-1707.94 409.182,-3396.35 423,-3445 435.441,-3488.8 464.244,-3534 482.17,-3559.4"/>
<polygon fill="#000000" stroke="#000000" points="479.549,-3561.75 488.232,-3567.82 485.231,-3557.66 479.549,-3561.75"/>
</g>
<!-- proc~state_init&#45;&gt;timer -->
<g id="proc~~siesta_forces~~CallsGraph_edge81" class="edge"><title>proc~state_init&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M329.646,-1548.29C334.769,-1643.75 370.018,-2264.84 423,-2327 468.263,-2380.11 521.638,-2323.88 574,-2370 801.409,-2570.32 740.009,-2711.62 842,-2997 861.313,-3051.04 851.741,-3069.97 878,-3121 906.236,-3175.87 938.299,-3173.9 964,-3230 999.069,-3306.55 974.915,-3335.62 1000,-3416 1005.71,-3434.28 1014.57,-3454.11 1021.6,-3468.63"/>
<polygon fill="#000000" stroke="#000000" points="1018.54,-3470.34 1026.11,-3477.76 1024.81,-3467.24 1018.54,-3470.34"/>
</g>
<!-- volcel -->
<g id="proc~~siesta_forces~~CallsGraph_node29" class="node"><title>volcel</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-2978 471.5,-2978 471.5,-2954 525.5,-2954 525.5,-2978"/>
<text text-anchor="middle" x="498.5" y="-2963.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">volcel</text>
</g>
<!-- proc~state_init&#45;&gt;volcel -->
<g id="proc~~siesta_forces~~CallsGraph_edge28" class="edge"><title>proc~state_init&#45;&gt;volcel</title>
<path fill="none" stroke="#000000" d="M328.973,-1548.35C328.788,-1680.45 329.872,-2830.15 423,-2945 432.262,-2956.42 447.22,-2961.92 461.312,-2964.46"/>
<polygon fill="#000000" stroke="#000000" points="460.942,-2967.95 471.325,-2965.84 461.895,-2961.01 460.942,-2967.95"/>
</g>
<!-- mscell -->
<g id="proc~~siesta_forces~~CallsGraph_node30" class="node"><title>mscell</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-528 471.5,-528 471.5,-504 525.5,-504 525.5,-528"/>
<text text-anchor="middle" x="498.5" y="-513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mscell</text>
</g>
<!-- proc~state_init&#45;&gt;mscell -->
<g id="proc~~siesta_forces~~CallsGraph_edge30" class="edge"><title>proc~state_init&#45;&gt;mscell</title>
<path fill="none" stroke="#000000" d="M355.646,-1530.7C367.265,-1526.95 379.845,-1520.61 387,-1510 447.475,-1420.3 356.115,-622.031 423,-537 432.092,-525.441 447.025,-519.927 461.144,-517.402"/>
<polygon fill="#000000" stroke="#000000" points="461.743,-520.853 471.186,-516.048 460.808,-513.916 461.743,-520.853"/>
</g>
<!-- re_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_node32" class="node"><title>re_alloc</title>
<polygon fill="#777777" stroke="#777777" points="1060.5,-4789 1006.5,-4789 1006.5,-4765 1060.5,-4765 1060.5,-4789"/>
<text text-anchor="middle" x="1033.5" y="-4774.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">re_alloc</text>
</g>
<!-- proc~state_init&#45;&gt;re_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge32" class="edge"><title>proc~state_init&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M329.554,-1548.22C334.086,-1645.94 366.35,-2298.06 423,-2362 468.753,-2413.64 527.122,-2347.38 574,-2398 637.599,-2466.67 691.752,-3137.49 706,-3230 722.485,-3337.04 695.35,-3373.26 742,-3471 770.319,-3530.33 811.438,-3521.79 842,-3580 955.172,-3795.54 926.846,-3873.4 964,-4114 993.877,-4307.47 977.935,-4358.48 1000,-4553 1008.42,-4627.24 1022.26,-4714.76 1028.82,-4754.88"/>
<polygon fill="#000000" stroke="#000000" points="1025.39,-4755.6 1030.47,-4764.89 1032.3,-4754.46 1025.39,-4755.6"/>
</g>
<!-- newddata2d -->
<g id="proc~~siesta_forces~~CallsGraph_node33" class="node"><title>newddata2d</title>
<polygon fill="#777777" stroke="#777777" points="534,-486 463,-486 463,-462 534,-462 534,-486"/>
<text text-anchor="middle" x="498.5" y="-471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">newddata2d</text>
</g>
<!-- proc~state_init&#45;&gt;newddata2d -->
<g id="proc~~siesta_forces~~CallsGraph_edge33" class="edge"><title>proc~state_init&#45;&gt;newddata2d</title>
<path fill="none" stroke="#000000" d="M355.653,-1530.7C367.274,-1526.95 379.853,-1520.62 387,-1510 450.011,-1416.38 353.299,-583.75 423,-495 430.318,-485.682 441.433,-480.291 452.861,-477.228"/>
<polygon fill="#000000" stroke="#000000" points="453.843,-480.598 462.897,-475.095 452.388,-473.75 453.843,-480.598"/>
</g>
<!-- superc -->
<g id="proc~~siesta_forces~~CallsGraph_node34" class="node"><title>superc</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-444 471.5,-444 471.5,-420 525.5,-420 525.5,-444"/>
<text text-anchor="middle" x="498.5" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">superc</text>
</g>
<!-- proc~state_init&#45;&gt;superc -->
<g id="proc~~siesta_forces~~CallsGraph_edge49" class="edge"><title>proc~state_init&#45;&gt;superc</title>
<path fill="none" stroke="#000000" d="M355.66,-1530.71C367.282,-1526.96 379.86,-1520.62 387,-1510 452.546,-1412.47 350.484,-545.469 423,-453 432.075,-441.428 447.006,-435.912 461.127,-433.389"/>
<polygon fill="#000000" stroke="#000000" points="461.728,-436.84 471.172,-432.037 460.794,-429.902 461.728,-436.84"/>
</g>
<!-- ioxv -->
<g id="proc~~siesta_forces~~CallsGraph_node39" class="node"><title>ioxv</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-402 471.5,-402 471.5,-378 525.5,-378 525.5,-402"/>
<text text-anchor="middle" x="498.5" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ioxv</text>
</g>
<!-- proc~state_init&#45;&gt;ioxv -->
<g id="proc~~siesta_forces~~CallsGraph_edge58" class="edge"><title>proc~state_init&#45;&gt;ioxv</title>
<path fill="none" stroke="#000000" d="M355.666,-1530.71C367.29,-1526.96 379.867,-1520.63 387,-1510 455.082,-1408.55 347.668,-507.188 423,-411 432.068,-399.422 446.997,-393.905 461.12,-391.383"/>
<polygon fill="#000000" stroke="#000000" points="461.721,-394.834 471.166,-390.032 460.788,-387.896 461.721,-394.834"/>
</g>
<!-- setup_ts_kpoint_scf -->
<g id="proc~~siesta_forces~~CallsGraph_node40" class="node"><title>setup_ts_kpoint_scf</title>
<polygon fill="#777777" stroke="#777777" points="552,-360 445,-360 445,-336 552,-336 552,-360"/>
<text text-anchor="middle" x="498.5" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_ts_kpoint_scf</text>
</g>
<!-- proc~state_init&#45;&gt;setup_ts_kpoint_scf -->
<g id="proc~~siesta_forces~~CallsGraph_edge59" class="edge"><title>proc~state_init&#45;&gt;setup_ts_kpoint_scf</title>
<path fill="none" stroke="#000000" d="M355.672,-1530.72C367.297,-1526.97 379.873,-1520.63 387,-1510 457.618,-1404.64 344.852,-468.908 423,-369 426.467,-364.568 430.793,-361.024 435.604,-358.196"/>
<polygon fill="#000000" stroke="#000000" points="437.197,-361.314 444.708,-353.841 434.177,-354.999 437.197,-361.314"/>
</g>
<!-- setup_ordern_indexes -->
<g id="proc~~siesta_forces~~CallsGraph_node42" class="node"><title>setup_ordern_indexes</title>
<polygon fill="#777777" stroke="#777777" points="558,-318 439,-318 439,-294 558,-294 558,-318"/>
<text text-anchor="middle" x="498.5" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_ordern_indexes</text>
</g>
<!-- proc~state_init&#45;&gt;setup_ordern_indexes -->
<g id="proc~~siesta_forces~~CallsGraph_edge62" class="edge"><title>proc~state_init&#45;&gt;setup_ordern_indexes</title>
<path fill="none" stroke="#000000" d="M355.677,-1530.72C367.303,-1526.97 379.879,-1520.64 387,-1510 460.153,-1400.72 342.036,-430.627 423,-327 425.11,-324.3 427.538,-321.929 430.201,-319.849"/>
<polygon fill="#000000" stroke="#000000" points="432.203,-322.725 438.809,-314.442 428.48,-316.797 432.203,-322.725"/>
</g>
<!-- setup_dmhs_netcdf_file -->
<g id="proc~~siesta_forces~~CallsGraph_node43" class="node"><title>setup_dmhs_netcdf_file</title>
<polygon fill="#777777" stroke="#777777" points="561.5,-276 435.5,-276 435.5,-252 561.5,-252 561.5,-276"/>
<text text-anchor="middle" x="498.5" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_dmhs_netcdf_file</text>
</g>
<!-- proc~state_init&#45;&gt;setup_dmhs_netcdf_file -->
<g id="proc~~siesta_forces~~CallsGraph_edge40" class="edge"><title>proc~state_init&#45;&gt;setup_dmhs_netcdf_file</title>
<path fill="none" stroke="#000000" d="M355.682,-1530.72C367.309,-1526.98 379.885,-1520.64 387,-1510 462.689,-1396.8 339.22,-392.346 423,-285 424.271,-283.371 425.658,-281.862 427.143,-280.465"/>
<polygon fill="#000000" stroke="#000000" points="429.384,-283.16 435.294,-274.366 425.19,-277.555 429.384,-283.16"/>
</g>
<!-- new_dm -->
<g id="proc~~siesta_forces~~CallsGraph_node45" class="node"><title>new_dm</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-234 471.5,-234 471.5,-210 525.5,-210 525.5,-234"/>
<text text-anchor="middle" x="498.5" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">new_dm</text>
</g>
<!-- proc~state_init&#45;&gt;new_dm -->
<g id="proc~~siesta_forces~~CallsGraph_edge66" class="edge"><title>proc~state_init&#45;&gt;new_dm</title>
<path fill="none" stroke="#000000" d="M355.687,-1530.73C367.315,-1526.98 379.89,-1520.64 387,-1510 465.225,-1392.89 336.405,-354.066 423,-243 432.042,-231.402 446.969,-225.883 461.095,-223.364"/>
<polygon fill="#000000" stroke="#000000" points="461.699,-226.814 471.145,-222.016 460.769,-219.877 461.699,-226.814"/>
</g>
<!-- exact_sc_ag -->
<g id="proc~~siesta_forces~~CallsGraph_node47" class="node"><title>exact_sc_ag</title>
<polygon fill="#777777" stroke="#777777" points="535,-192 462,-192 462,-168 535,-168 535,-192"/>
<text text-anchor="middle" x="498.5" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">exact_sc_ag</text>
</g>
<!-- proc~state_init&#45;&gt;exact_sc_ag -->
<g id="proc~~siesta_forces~~CallsGraph_edge29" class="edge"><title>proc~state_init&#45;&gt;exact_sc_ag</title>
<path fill="none" stroke="#000000" d="M355.691,-1530.73C367.32,-1526.98 379.895,-1520.65 387,-1510 467.761,-1388.97 333.588,-315.785 423,-201 430.09,-191.899 440.803,-186.54 451.912,-183.437"/>
<polygon fill="#000000" stroke="#000000" points="452.697,-186.848 461.695,-181.254 451.172,-180.016 452.697,-186.848"/>
</g>
<!-- cmladdproperty -->
<g id="proc~~siesta_forces~~CallsGraph_node49" class="node"><title>cmladdproperty</title>
<polygon fill="#777777" stroke="#777777" points="542,-2474 455,-2474 455,-2450 542,-2450 542,-2474"/>
<text text-anchor="middle" x="498.5" y="-2459.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cmladdproperty</text>
</g>
<!-- proc~state_init&#45;&gt;cmladdproperty -->
<g id="proc~~siesta_forces~~CallsGraph_edge75" class="edge"><title>proc~state_init&#45;&gt;cmladdproperty</title>
<path fill="none" stroke="#000000" d="M329.495,-1548.28C333.728,-1650.81 365.109,-2362.86 423,-2436 428.807,-2443.34 436.817,-2448.61 445.443,-2452.4"/>
<polygon fill="#000000" stroke="#000000" points="444.376,-2455.73 454.969,-2455.95 446.824,-2449.18 444.376,-2455.73"/>
</g>
<!-- sporb_to_spatom -->
<g id="proc~~siesta_forces~~CallsGraph_node54" class="node"><title>sporb_to_spatom</title>
<polygon fill="#777777" stroke="#777777" points="546.5,-150 450.5,-150 450.5,-126 546.5,-126 546.5,-150"/>
<text text-anchor="middle" x="498.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sporb_to_spatom</text>
</g>
<!-- proc~state_init&#45;&gt;sporb_to_spatom -->
<g id="proc~~siesta_forces~~CallsGraph_edge79" class="edge"><title>proc~state_init&#45;&gt;sporb_to_spatom</title>
<path fill="none" stroke="#000000" d="M355.695,-1530.73C367.325,-1526.99 379.9,-1520.65 387,-1510 470.297,-1385.06 330.772,-277.505 423,-159 427.653,-153.022 433.869,-148.658 440.735,-145.487"/>
<polygon fill="#000000" stroke="#000000" points="442.276,-148.648 450.414,-141.864 439.822,-142.092 442.276,-148.648"/>
</g>
<!-- newzspdata2d -->
<g id="proc~~siesta_forces~~CallsGraph_node55" class="node"><title>newzspdata2d</title>
<polygon fill="#777777" stroke="#777777" points="539.5,-108 457.5,-108 457.5,-84 539.5,-84 539.5,-108"/>
<text text-anchor="middle" x="498.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">newzspdata2d</text>
</g>
<!-- proc~state_init&#45;&gt;newzspdata2d -->
<g id="proc~~siesta_forces~~CallsGraph_edge82" class="edge"><title>proc~state_init&#45;&gt;newzspdata2d</title>
<path fill="none" stroke="#000000" d="M355.699,-1530.74C367.33,-1526.99 379.904,-1520.65 387,-1510 472.833,-1381.14 327.956,-239.225 423,-117 429.187,-109.044 438.143,-103.947 447.715,-100.717"/>
<polygon fill="#000000" stroke="#000000" points="448.685,-104.08 457.412,-98.0727 446.843,-97.327 448.685,-104.08"/>
</g>
<!-- siesta_write_positions -->
<g id="proc~~siesta_forces~~CallsGraph_node56" class="node"><title>siesta_write_positions</title>
<polygon fill="#777777" stroke="#777777" points="557,-2318 440,-2318 440,-2294 557,-2294 557,-2318"/>
<text text-anchor="middle" x="498.5" y="-2303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_write_positions</text>
</g>
<!-- proc~state_init&#45;&gt;siesta_write_positions -->
<g id="proc~~siesta_forces~~CallsGraph_edge83" class="edge"><title>proc~state_init&#45;&gt;siesta_write_positions</title>
<path fill="none" stroke="#000000" d="M328.762,-1548.22C327.303,-1635.83 322.679,-2168.39 423,-2285 425.35,-2287.73 428.025,-2290.12 430.931,-2292.21"/>
<polygon fill="#000000" stroke="#000000" points="429.26,-2295.29 439.654,-2297.34 432.807,-2289.25 429.26,-2295.29"/>
</g>
<!-- write_debug -->
<g id="proc~~siesta_forces~~CallsGraph_node58" class="node"><title>write_debug</title>
<polygon fill="#777777" stroke="#777777" points="956.5,-4166 885.5,-4166 885.5,-4142 956.5,-4142 956.5,-4166"/>
<text text-anchor="middle" x="921" y="-4151.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_debug</text>
</g>
<!-- proc~state_init&#45;&gt;write_debug -->
<g id="proc~~siesta_forces~~CallsGraph_edge87" class="edge"><title>proc~state_init&#45;&gt;write_debug</title>
<path fill="none" stroke="#000000" d="M329.512,-1548.1C333.829,-1647.65 365.41,-2329.77 423,-2398 468.006,-2451.33 530.696,-2386.28 574,-2441 628.461,-2509.81 564.568,-3154.92 610,-3230 635.572,-3272.26 678.836,-3244.74 706,-3286 778.394,-3395.95 676.431,-3465.85 742,-3580 769.805,-3628.41 813.388,-3608.07 842,-3656 891.258,-3738.52 913.409,-4046.02 918.707,-4131.71"/>
<polygon fill="#000000" stroke="#000000" points="915.224,-4132.1 919.32,-4141.87 922.212,-4131.68 915.224,-4132.1"/>
</g>
<!-- domaindecom -->
<g id="proc~~siesta_forces~~CallsGraph_node61" class="node"><title>domaindecom</title>
<polygon fill="#777777" stroke="#777777" points="538.5,-2276 458.5,-2276 458.5,-2252 538.5,-2252 538.5,-2276"/>
<text text-anchor="middle" x="498.5" y="-2261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">domaindecom</text>
</g>
<!-- proc~state_init&#45;&gt;domaindecom -->
<g id="proc~~siesta_forces~~CallsGraph_edge92" class="edge"><title>proc~state_init&#45;&gt;domaindecom</title>
<path fill="none" stroke="#000000" d="M328.863,-1548.07C328.154,-1632.41 328.014,-2133.41 423,-2243 429.667,-2250.69 438.911,-2255.67 448.624,-2258.87"/>
<polygon fill="#000000" stroke="#000000" points="447.849,-2262.28 458.415,-2261.51 449.67,-2255.53 447.849,-2262.28"/>
</g>
<!-- globalize_or -->
<g id="proc~~siesta_forces~~CallsGraph_node65" class="node"><title>globalize_or</title>
<polygon fill="#777777" stroke="#777777" points="533.5,-2234 463.5,-2234 463.5,-2210 533.5,-2210 533.5,-2234"/>
<text text-anchor="middle" x="498.5" y="-2219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">globalize_or</text>
</g>
<!-- proc~state_init&#45;&gt;globalize_or -->
<g id="proc~~siesta_forces~~CallsGraph_edge36" class="edge"><title>proc~state_init&#45;&gt;globalize_or</title>
<path fill="none" stroke="#000000" d="M328.975,-1548.13C329.051,-1629.74 333.419,-2098.5 423,-2201 430.797,-2209.92 442.061,-2215.19 453.478,-2218.26"/>
<polygon fill="#000000" stroke="#000000" points="452.953,-2221.73 463.468,-2220.43 454.44,-2214.89 452.953,-2221.73"/>
</g>
<!-- crtsparsity_sc -->
<g id="proc~~siesta_forces~~CallsGraph_node68" class="node"><title>crtsparsity_sc</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-2192 459.5,-2192 459.5,-2168 537.5,-2168 537.5,-2192"/>
<text text-anchor="middle" x="498.5" y="-2177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">crtsparsity_sc</text>
</g>
<!-- proc~state_init&#45;&gt;crtsparsity_sc -->
<g id="proc~~siesta_forces~~CallsGraph_edge45" class="edge"><title>proc~state_init&#45;&gt;crtsparsity_sc</title>
<path fill="none" stroke="#000000" d="M329.101,-1548.12C330.002,-1626.68 338.786,-2063.54 423,-2159 429.868,-2166.78 439.374,-2171.78 449.302,-2174.97"/>
<polygon fill="#000000" stroke="#000000" points="448.727,-2178.44 459.288,-2177.59 450.502,-2171.66 448.727,-2178.44"/>
</g>
<!-- proximity_check -->
<g id="proc~~siesta_forces~~CallsGraph_node69" class="node"><title>proximity_check</title>
<polygon fill="#777777" stroke="#777777" points="543,-2150 454,-2150 454,-2126 543,-2126 543,-2150"/>
<text text-anchor="middle" x="498.5" y="-2135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">proximity_check</text>
</g>
<!-- proc~state_init&#45;&gt;proximity_check -->
<g id="proc~~siesta_forces~~CallsGraph_edge47" class="edge"><title>proc~state_init&#45;&gt;proximity_check</title>
<path fill="none" stroke="#000000" d="M329.244,-1548.03C331.008,-1623.24 344.114,-2028.54 423,-2117 428.721,-2123.42 436.235,-2127.94 444.288,-2131.11"/>
<polygon fill="#000000" stroke="#000000" points="443.322,-2134.47 453.914,-2134.25 445.491,-2127.82 443.322,-2134.47"/>
</g>
<!-- overlap -->
<g id="proc~~siesta_forces~~CallsGraph_node70" class="node"><title>overlap</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-2108 471.5,-2108 471.5,-2084 525.5,-2084 525.5,-2108"/>
<text text-anchor="middle" x="498.5" y="-2093.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">overlap</text>
</g>
<!-- proc~state_init&#45;&gt;overlap -->
<g id="proc~~siesta_forces~~CallsGraph_edge86" class="edge"><title>proc~state_init&#45;&gt;overlap</title>
<path fill="none" stroke="#000000" d="M329.411,-1548.09C332.104,-1620.23 349.481,-1993.56 423,-2075 432.687,-2085.73 447.389,-2091.15 461.18,-2093.83"/>
<polygon fill="#000000" stroke="#000000" points="461.039,-2097.35 471.45,-2095.39 462.087,-2090.43 461.039,-2097.35"/>
</g>
<!-- cmlendpropertylist -->
<g id="proc~~siesta_forces~~CallsGraph_node71" class="node"><title>cmlendpropertylist</title>
<polygon fill="#777777" stroke="#777777" points="548.5,-2066 448.5,-2066 448.5,-2042 548.5,-2042 548.5,-2066"/>
<text text-anchor="middle" x="498.5" y="-2051.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cmlendpropertylist</text>
</g>
<!-- proc~state_init&#45;&gt;cmlendpropertylist -->
<g id="proc~~siesta_forces~~CallsGraph_edge51" class="edge"><title>proc~state_init&#45;&gt;cmlendpropertylist</title>
<path fill="none" stroke="#000000" d="M329.601,-1548.03C333.27,-1616.7 354.795,-1958.53 423,-2033 427.407,-2037.81 432.824,-2041.55 438.707,-2044.46"/>
<polygon fill="#000000" stroke="#000000" points="437.679,-2047.82 448.26,-2048.37 440.331,-2041.34 437.679,-2047.82"/>
</g>
<!-- newdspdata1d -->
<g id="proc~~siesta_forces~~CallsGraph_node72" class="node"><title>newdspdata1d</title>
<polygon fill="#777777" stroke="#777777" points="539.5,-2024 457.5,-2024 457.5,-2000 539.5,-2000 539.5,-2024"/>
<text text-anchor="middle" x="498.5" y="-2009.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">newdspdata1d</text>
</g>
<!-- proc~state_init&#45;&gt;newdspdata1d -->
<g id="proc~~siesta_forces~~CallsGraph_edge52" class="edge"><title>proc~state_init&#45;&gt;newdspdata1d</title>
<path fill="none" stroke="#000000" d="M329.847,-1548.29C334.616,-1614.02 360.191,-1923.56 423,-1991 429.594,-1998.08 438.37,-2002.84 447.581,-2006.02"/>
<polygon fill="#000000" stroke="#000000" points="446.686,-2009.41 457.264,-2008.8 448.617,-2002.68 446.686,-2009.41"/>
</g>
<!-- newsparsity -->
<g id="proc~~siesta_forces~~CallsGraph_node73" class="node"><title>newsparsity</title>
<polygon fill="#777777" stroke="#777777" points="533,-1982 464,-1982 464,-1958 533,-1958 533,-1982"/>
<text text-anchor="middle" x="498.5" y="-1967.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">newsparsity</text>
</g>
<!-- proc~state_init&#45;&gt;newsparsity -->
<g id="proc~~siesta_forces~~CallsGraph_edge41" class="edge"><title>proc~state_init&#45;&gt;newsparsity</title>
<path fill="none" stroke="#000000" d="M330.132,-1548.37C336.065,-1610.56 365.506,-1888.5 423,-1949 431.162,-1957.59 442.539,-1962.75 453.949,-1965.83"/>
<polygon fill="#000000" stroke="#000000" points="453.384,-1969.29 463.904,-1968.03 454.896,-1962.46 453.384,-1969.29"/>
</g>
<!-- kpoint_nullify -->
<g id="proc~~siesta_forces~~CallsGraph_node77" class="node"><title>kpoint_nullify</title>
<polygon fill="#777777" stroke="#777777" points="535.5,-1940 461.5,-1940 461.5,-1916 535.5,-1916 535.5,-1940"/>
<text text-anchor="middle" x="498.5" y="-1925.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">kpoint_nullify</text>
</g>
<!-- proc~state_init&#45;&gt;kpoint_nullify -->
<g id="proc~~siesta_forces~~CallsGraph_edge84" class="edge"><title>proc~state_init&#45;&gt;kpoint_nullify</title>
<path fill="none" stroke="#000000" d="M330.459,-1548.26C337.61,-1606.35 370.735,-1853.33 423,-1907 430.602,-1914.81 440.862,-1919.77 451.334,-1922.92"/>
<polygon fill="#000000" stroke="#000000" points="450.811,-1926.4 461.36,-1925.41 452.498,-1919.6 450.811,-1926.4"/>
</g>
<!-- hsparse -->
<g id="proc~~siesta_forces~~CallsGraph_node79" class="node"><title>hsparse</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-1898 471.5,-1898 471.5,-1874 525.5,-1874 525.5,-1898"/>
<text text-anchor="middle" x="498.5" y="-1883.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hsparse</text>
</g>
<!-- proc~state_init&#45;&gt;hsparse -->
<g id="proc~~siesta_forces~~CallsGraph_edge74" class="edge"><title>proc~state_init&#45;&gt;hsparse</title>
<path fill="none" stroke="#000000" d="M328.562,-1548.22C327.542,-1596.08 330.426,-1772.75 423,-1865 433.089,-1875.05 447.593,-1880.38 461.128,-1883.17"/>
<polygon fill="#000000" stroke="#000000" points="460.76,-1886.66 471.199,-1884.85 461.91,-1879.76 460.76,-1886.66"/>
</g>
<!-- outcoor -->
<g id="proc~~siesta_forces~~CallsGraph_node82" class="node"><title>outcoor</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-1856 471.5,-1856 471.5,-1832 525.5,-1832 525.5,-1856"/>
<text text-anchor="middle" x="498.5" y="-1841.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">outcoor</text>
</g>
<!-- proc~state_init&#45;&gt;outcoor -->
<g id="proc~~siesta_forces~~CallsGraph_edge78" class="edge"><title>proc~state_init&#45;&gt;outcoor</title>
<path fill="none" stroke="#000000" d="M329.154,-1548.17C330.392,-1592.09 340.697,-1744.06 423,-1823 433.279,-1832.86 447.816,-1838.15 461.324,-1840.97"/>
<polygon fill="#000000" stroke="#000000" points="460.919,-1844.46 471.365,-1842.68 462.094,-1837.55 460.919,-1844.46"/>
</g>
<!-- cmlstartpropertylist -->
<g id="proc~~siesta_forces~~CallsGraph_node83" class="node"><title>cmlstartpropertylist</title>
<polygon fill="#777777" stroke="#777777" points="550,-1814 447,-1814 447,-1790 550,-1790 550,-1814"/>
<text text-anchor="middle" x="498.5" y="-1799.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cmlstartpropertylist</text>
</g>
<!-- proc~state_init&#45;&gt;cmlstartpropertylist -->
<g id="proc~~siesta_forces~~CallsGraph_edge88" class="edge"><title>proc~state_init&#45;&gt;cmlstartpropertylist</title>
<path fill="none" stroke="#000000" d="M329.918,-1548.04C333.601,-1587.64 350.809,-1715.14 423,-1781 427.219,-1784.85 432.091,-1788 437.282,-1790.58"/>
<polygon fill="#000000" stroke="#000000" points="436.324,-1793.97 446.899,-1794.62 439.039,-1787.52 436.324,-1793.97"/>
</g>
<!-- isc_off -->
<g id="proc~~siesta_forces~~CallsGraph_node84" class="node"><title>isc_off</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-1772 471.5,-1772 471.5,-1748 525.5,-1748 525.5,-1772"/>
<text text-anchor="middle" x="498.5" y="-1757.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">isc_off</text>
</g>
<!-- proc~state_init&#45;&gt;isc_off -->
<g id="proc~~siesta_forces~~CallsGraph_edge91" class="edge"><title>proc~state_init&#45;&gt;isc_off</title>
<path fill="none" stroke="#000000" d="M331.002,-1548.18C337.441,-1583.38 360.933,-1686.09 423,-1739 433.757,-1748.17 448.252,-1753.35 461.597,-1756.27"/>
<polygon fill="#000000" stroke="#000000" points="461.028,-1759.72 471.497,-1758.09 462.295,-1752.84 461.028,-1759.72"/>
</g>
<!-- setup_dm_netcdf_file -->
<g id="proc~~siesta_forces~~CallsGraph_node86" class="node"><title>setup_dm_netcdf_file</title>
<polygon fill="#777777" stroke="#777777" points="556,-1730 441,-1730 441,-1706 556,-1706 556,-1730"/>
<text text-anchor="middle" x="498.5" y="-1715.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_dm_netcdf_file</text>
</g>
<!-- proc~state_init&#45;&gt;setup_dm_netcdf_file -->
<g id="proc~~siesta_forces~~CallsGraph_edge55" class="edge"><title>proc~state_init&#45;&gt;setup_dm_netcdf_file</title>
<path fill="none" stroke="#000000" d="M332.596,-1548.23C342.094,-1578.35 370.779,-1656.59 423,-1697 425.657,-1699.06 428.506,-1700.91 431.483,-1702.58"/>
<polygon fill="#000000" stroke="#000000" points="430.214,-1705.86 440.738,-1707.08 433.272,-1699.56 430.214,-1705.86"/>
</g>
<!-- nsc -->
<g id="proc~~siesta_forces~~CallsGraph_node87" class="node"><title>nsc</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-1688 471.5,-1688 471.5,-1664 525.5,-1664 525.5,-1688"/>
<text text-anchor="middle" x="498.5" y="-1673.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nsc</text>
</g>
<!-- proc~state_init&#45;&gt;nsc -->
<g id="proc~~siesta_forces~~CallsGraph_edge34" class="edge"><title>proc~state_init&#45;&gt;nsc</title>
<path fill="none" stroke="#000000" d="M335.896,-1548.17C349.579,-1571.28 382.378,-1621.7 423,-1650 434.441,-1657.97 448.562,-1663.71 461.423,-1667.74"/>
<polygon fill="#000000" stroke="#000000" points="460.814,-1671.21 471.392,-1670.61 462.751,-1664.48 460.814,-1671.21"/>
</g>
<!-- proc~mixers_history_init -->
<g id="proc~~siesta_forces~~CallsGraph_node88" class="node"><title>proc~mixers_history_init</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node88"><a xlink:href=".././proc/mixers_history_init.html" xlink:title="mixers_history_init">
<polygon fill="#d9534f" stroke="#d9534f" points="549,-66 448,-66 448,-42 549,-42 549,-66"/>
<text text-anchor="middle" x="498.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mixers_history_init</text>
</a>
</g>
</g>
<!-- proc~state_init&#45;&gt;proc~mixers_history_init -->
<g id="proc~~siesta_forces~~CallsGraph_edge35" class="edge"><title>proc~state_init&#45;&gt;proc~mixers_history_init</title>
<path fill="none" stroke="#000000" d="M355.703,-1530.74C367.334,-1526.99 379.908,-1520.66 387,-1510 475.369,-1377.22 325.14,-200.944 423,-75 427.058,-69.7772 432.31,-65.7865 438.146,-62.7471"/>
<polygon fill="#000000" stroke="#000000" points="439.856,-65.8244 447.71,-58.7136 437.136,-59.3745 439.856,-65.8244"/>
</g>
<!-- chess_init -->
<g id="proc~~siesta_forces~~CallsGraph_node90" class="node"><title>chess_init</title>
<polygon fill="#777777" stroke="#777777" points="528.5,-1608 468.5,-1608 468.5,-1584 528.5,-1584 528.5,-1608"/>
<text text-anchor="middle" x="498.5" y="-1593.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">chess_init</text>
</g>
<!-- proc~state_init&#45;&gt;chess_init -->
<g id="proc~~siesta_forces~~CallsGraph_edge89" class="edge"><title>proc~state_init&#45;&gt;chess_init</title>
<path fill="none" stroke="#000000" d="M355.713,-1545.75C374.511,-1552.59 400.27,-1561.92 423,-1570 434.581,-1574.12 447.195,-1578.54 458.696,-1582.55"/>
<polygon fill="#000000" stroke="#000000" points="457.867,-1585.97 468.462,-1585.95 460.169,-1579.36 457.867,-1585.97"/>
</g>
<!-- iotdxv -->
<g id="proc~~siesta_forces~~CallsGraph_node91" class="node"><title>iotdxv</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-1528 471.5,-1528 471.5,-1504 525.5,-1504 525.5,-1528"/>
<text text-anchor="middle" x="498.5" y="-1513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iotdxv</text>
</g>
<!-- proc~state_init&#45;&gt;iotdxv -->
<g id="proc~~siesta_forces~~CallsGraph_edge37" class="edge"><title>proc~state_init&#45;&gt;iotdxv</title>
<path fill="none" stroke="#000000" d="M355.699,-1532.83C384.213,-1529.45 429.573,-1524.06 461.29,-1520.3"/>
<polygon fill="#000000" stroke="#000000" points="461.962,-1523.74 471.479,-1519.09 461.136,-1516.79 461.962,-1523.74"/>
</g>
<!-- file_exist -->
<g id="proc~~siesta_forces~~CallsGraph_node92" class="node"><title>file_exist</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-1448 471.5,-1448 471.5,-1424 525.5,-1424 525.5,-1448"/>
<text text-anchor="middle" x="498.5" y="-1433.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">file_exist</text>
</g>
<!-- proc~state_init&#45;&gt;file_exist -->
<g id="proc~~siesta_forces~~CallsGraph_edge43" class="edge"><title>proc~state_init&#45;&gt;file_exist</title>
<path fill="none" stroke="#000000" d="M355.7,-1527.32C366.132,-1523.12 377.777,-1517.37 387,-1510 407.83,-1493.35 401.477,-1477.74 423,-1462 434.255,-1453.77 448.337,-1447.97 461.22,-1443.98"/>
<polygon fill="#000000" stroke="#000000" points="462.549,-1447.24 471.217,-1441.14 460.642,-1440.5 462.549,-1447.24"/>
</g>
<!-- val -->
<g id="proc~~siesta_forces~~CallsGraph_node93" class="node"><title>val</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-3634 471.5,-3634 471.5,-3610 525.5,-3610 525.5,-3634"/>
<text text-anchor="middle" x="498.5" y="-3619.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">val</text>
</g>
<!-- proc~state_init&#45;&gt;val -->
<g id="proc~~siesta_forces~~CallsGraph_edge77" class="edge"><title>proc~state_init&#45;&gt;val</title>
<path fill="none" stroke="#000000" d="M329.526,-1548.09C336.873,-1716.88 418.739,-3595.63 423,-3601 432.141,-3612.52 447.082,-3618.03 461.192,-3620.56"/>
<polygon fill="#000000" stroke="#000000" points="460.846,-3624.04 471.226,-3621.92 461.787,-3617.11 460.846,-3624.04"/>
</g>
<!-- attach -->
<g id="proc~~siesta_forces~~CallsGraph_node95" class="node"><title>attach</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-1406 471.5,-1406 471.5,-1382 525.5,-1382 525.5,-1406"/>
<text text-anchor="middle" x="498.5" y="-1391.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">attach</text>
</g>
<!-- proc~state_init&#45;&gt;attach -->
<g id="proc~~siesta_forces~~CallsGraph_edge50" class="edge"><title>proc~state_init&#45;&gt;attach</title>
<path fill="none" stroke="#000000" d="M355.658,-1529C366.579,-1524.99 378.599,-1518.91 387,-1510 417.969,-1477.14 389.707,-1445.5 423,-1415 433.423,-1405.45 447.858,-1400.2 461.249,-1397.34"/>
<polygon fill="#000000" stroke="#000000" points="461.965,-1400.76 471.201,-1395.57 460.744,-1393.87 461.965,-1400.76"/>
</g>
<!-- sp_to_spglobal -->
<g id="proc~~siesta_forces~~CallsGraph_node96" class="node"><title>sp_to_spglobal</title>
<polygon fill="#777777" stroke="#777777" points="541,-1326 456,-1326 456,-1302 541,-1302 541,-1326"/>
<text text-anchor="middle" x="498.5" y="-1311.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sp_to_spglobal</text>
</g>
<!-- proc~state_init&#45;&gt;sp_to_spglobal -->
<g id="proc~~siesta_forces~~CallsGraph_edge53" class="edge"><title>proc~state_init&#45;&gt;sp_to_spglobal</title>
<path fill="none" stroke="#000000" d="M355.744,-1529.81C366.95,-1525.91 379.169,-1519.7 387,-1510 435.504,-1449.9 371.968,-1397.97 423,-1340 429.249,-1332.9 437.545,-1327.74 446.329,-1323.99"/>
<polygon fill="#000000" stroke="#000000" points="447.799,-1327.18 455.979,-1320.45 445.386,-1320.61 447.799,-1327.18"/>
</g>
<!-- init_val -->
<g id="proc~~siesta_forces~~CallsGraph_node99" class="node"><title>init_val</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-1284 471.5,-1284 471.5,-1260 525.5,-1260 525.5,-1284"/>
<text text-anchor="middle" x="498.5" y="-1269.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_val</text>
</g>
<!-- proc~state_init&#45;&gt;init_val -->
<g id="proc~~siesta_forces~~CallsGraph_edge60" class="edge"><title>proc~state_init&#45;&gt;init_val</title>
<path fill="none" stroke="#000000" d="M355.648,-1530.07C366.976,-1526.21 379.318,-1519.96 387,-1510 446.699,-1432.58 357.789,-1365.84 423,-1293 432.643,-1282.23 447.337,-1276.8 461.135,-1274.13"/>
<polygon fill="#000000" stroke="#000000" points="462.046,-1277.53 471.413,-1272.58 461.003,-1270.61 462.046,-1277.53"/>
</g>
<!-- dict_repopulate_md -->
<g id="proc~~siesta_forces~~CallsGraph_node101" class="node"><title>dict_repopulate_md</title>
<polygon fill="#777777" stroke="#777777" points="552,-1242 445,-1242 445,-1218 552,-1218 552,-1242"/>
<text text-anchor="middle" x="498.5" y="-1227.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dict_repopulate_md</text>
</g>
<!-- proc~state_init&#45;&gt;dict_repopulate_md -->
<g id="proc~~siesta_forces~~CallsGraph_edge63" class="edge"><title>proc~state_init&#45;&gt;dict_repopulate_md</title>
<path fill="none" stroke="#000000" d="M355.77,-1530.16C367.122,-1526.32 379.45,-1520.06 387,-1510 456.753,-1417.04 346.623,-1338.6 423,-1251 426.643,-1246.82 431.046,-1243.45 435.87,-1240.72"/>
<polygon fill="#000000" stroke="#000000" points="437.355,-1243.89 444.934,-1236.49 434.393,-1237.55 437.355,-1243.89"/>
</g>
<!-- kpoint_delete -->
<g id="proc~~siesta_forces~~CallsGraph_node103" class="node"><title>kpoint_delete</title>
<polygon fill="#777777" stroke="#777777" points="536.5,-1200 460.5,-1200 460.5,-1176 536.5,-1176 536.5,-1200"/>
<text text-anchor="middle" x="498.5" y="-1185.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">kpoint_delete</text>
</g>
<!-- proc~state_init&#45;&gt;kpoint_delete -->
<g id="proc~~siesta_forces~~CallsGraph_edge70" class="edge"><title>proc~state_init&#45;&gt;kpoint_delete</title>
<path fill="none" stroke="#000000" d="M355.56,-1530.33C367.013,-1526.51 379.481,-1520.22 387,-1510 466.833,-1401.47 335.429,-1311.39 423,-1209 430.016,-1200.8 439.964,-1195.67 450.314,-1192.51"/>
<polygon fill="#000000" stroke="#000000" points="451.416,-1195.84 460.277,-1190.03 449.728,-1189.04 451.416,-1195.84"/>
</g>
<!-- get_chess_parameter -->
<g id="proc~~siesta_forces~~CallsGraph_node104" class="node"><title>get_chess_parameter</title>
<polygon fill="#777777" stroke="#777777" points="557,-1158 440,-1158 440,-1134 557,-1134 557,-1158"/>
<text text-anchor="middle" x="498.5" y="-1143.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_chess_parameter</text>
</g>
<!-- proc~state_init&#45;&gt;get_chess_parameter -->
<g id="proc~~siesta_forces~~CallsGraph_edge72" class="edge"><title>proc~state_init&#45;&gt;get_chess_parameter</title>
<path fill="none" stroke="#000000" d="M355.627,-1530.38C367.094,-1526.57 379.555,-1520.28 387,-1510 476.93,-1385.87 324.217,-1284.21 423,-1167 425.367,-1164.19 428.077,-1161.74 431.031,-1159.61"/>
<polygon fill="#000000" stroke="#000000" points="433.061,-1162.48 439.916,-1154.4 429.519,-1156.44 433.061,-1162.48"/>
</g>
<!-- ts_tri_analyze -->
<g id="proc~~siesta_forces~~CallsGraph_node106" class="node"><title>ts_tri_analyze</title>
<polygon fill="#777777" stroke="#777777" points="538,-1116 459,-1116 459,-1092 538,-1092 538,-1116"/>
<text text-anchor="middle" x="498.5" y="-1101.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ts_tri_analyze</text>
</g>
<!-- proc~state_init&#45;&gt;ts_tri_analyze -->
<g id="proc~~siesta_forces~~CallsGraph_edge48" class="edge"><title>proc~state_init&#45;&gt;ts_tri_analyze</title>
<path fill="none" stroke="#000000" d="M355.68,-1530.42C367.159,-1526.61 379.613,-1520.32 387,-1510 437.019,-1440.13 367.996,-1191.02 423,-1125 429.714,-1116.94 439.26,-1111.84 449.286,-1108.65"/>
<polygon fill="#000000" stroke="#000000" points="450.168,-1112.04 458.97,-1106.14 448.411,-1105.26 450.168,-1112.04"/>
</g>
<!-- ucell -->
<g id="proc~~siesta_forces~~CallsGraph_node108" class="node"><title>ucell</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-1074 471.5,-1074 471.5,-1050 525.5,-1050 525.5,-1074"/>
<text text-anchor="middle" x="498.5" y="-1059.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ucell</text>
</g>
<!-- proc~state_init&#45;&gt;ucell -->
<g id="proc~~siesta_forces~~CallsGraph_edge56" class="edge"><title>proc~state_init&#45;&gt;ucell</title>
<path fill="none" stroke="#000000" d="M355.723,-1530.45C367.211,-1526.65 379.66,-1520.35 387,-1510 442.077,-1432.32 362.38,-1156.44 423,-1083 432.362,-1071.66 447.334,-1066.18 461.409,-1063.62"/>
<polygon fill="#000000" stroke="#000000" points="461.984,-1067.07 471.407,-1062.23 461.02,-1060.14 461.984,-1067.07"/>
</g>
<!-- nscold -->
<g id="proc~~siesta_forces~~CallsGraph_node110" class="node"><title>nscold</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-1032 471.5,-1032 471.5,-1008 525.5,-1008 525.5,-1032"/>
<text text-anchor="middle" x="498.5" y="-1017.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nscold</text>
</g>
<!-- proc~state_init&#45;&gt;nscold -->
<g id="proc~~siesta_forces~~CallsGraph_edge90" class="edge"><title>proc~state_init&#45;&gt;nscold</title>
<path fill="none" stroke="#000000" d="M355.758,-1530.47C367.253,-1526.68 379.699,-1520.38 387,-1510 447.137,-1424.5 356.76,-1121.86 423,-1041 432.319,-1029.62 447.286,-1024.14 461.368,-1021.58"/>
<polygon fill="#000000" stroke="#000000" points="461.946,-1025.03 471.372,-1020.2 460.987,-1018.1 461.946,-1025.03"/>
</g>
<!-- delete -->
<g id="proc~~siesta_forces~~CallsGraph_node111" class="node"><title>delete</title>
<polygon fill="#777777" stroke="#777777" points="685,-748 631,-748 631,-724 685,-724 685,-748"/>
<text text-anchor="middle" x="658" y="-733.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">delete</text>
</g>
<!-- proc~state_init&#45;&gt;delete -->
<g id="proc~~siesta_forces~~CallsGraph_edge93" class="edge"><title>proc~state_init&#45;&gt;delete</title>
<path fill="none" stroke="#000000" d="M355.526,-1529.63C366.691,-1525.69 378.937,-1519.51 387,-1510 427.71,-1461.98 378.252,-1417.28 423,-1373 472.189,-1324.32 527.8,-1386.52 574,-1335 652.286,-1247.69 657.146,-856.64 657.114,-758.432"/>
<polygon fill="#000000" stroke="#000000" points="660.614,-758.408 657.092,-748.416 653.614,-758.424 660.614,-758.408"/>
</g>
<!-- escf -->
<g id="proc~~siesta_forces~~CallsGraph_node114" class="node"><title>escf</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-3436 471.5,-3436 471.5,-3412 525.5,-3412 525.5,-3436"/>
<text text-anchor="middle" x="498.5" y="-3421.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">escf</text>
</g>
<!-- proc~state_init&#45;&gt;escf -->
<g id="proc~~siesta_forces~~CallsGraph_edge31" class="edge"><title>proc~state_init&#45;&gt;escf</title>
<path fill="none" stroke="#000000" d="M329.519,-1548.28C336.306,-1708.55 407.587,-3383.67 423,-3403 432.169,-3414.5 447.113,-3420 461.22,-3422.54"/>
<polygon fill="#000000" stroke="#000000" points="460.868,-3426.02 471.249,-3423.9 461.812,-3419.09 460.868,-3426.02"/>
</g>
<!-- time_io -->
<g id="proc~~siesta_forces~~CallsGraph_node118" class="node"><title>time_io</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-990 471.5,-990 471.5,-966 525.5,-966 525.5,-990"/>
<text text-anchor="middle" x="498.5" y="-975.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">time_io</text>
</g>
<!-- proc~state_init&#45;&gt;time_io -->
<g id="proc~~siesta_forces~~CallsGraph_edge39" class="edge"><title>proc~state_init&#45;&gt;time_io</title>
<path fill="none" stroke="#000000" d="M355.788,-1530.49C367.289,-1526.71 379.732,-1520.4 387,-1510 452.2,-1416.68 351.138,-1087.29 423,-999 432.284,-987.594 447.245,-982.103 461.332,-979.553"/>
<polygon fill="#000000" stroke="#000000" points="461.914,-983.006 471.343,-978.174 460.958,-976.071 461.914,-983.006"/>
</g>
<!-- proc~check_cohp -->
<g id="proc~~siesta_forces~~CallsGraph_node119" class="node"><title>proc~check_cohp</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node119"><a xlink:href=".././proc/check_cohp.html" xlink:title="check_cohp">
<polygon fill="#d9534f" stroke="#d9534f" points="827,-2104 757,-2104 757,-2080 827,-2080 827,-2104"/>
<text text-anchor="middle" x="792" y="-2089.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_cohp</text>
</a>
</g>
</g>
<!-- proc~state_init&#45;&gt;proc~check_cohp -->
<g id="proc~~siesta_forces~~CallsGraph_edge42" class="edge"><title>proc~state_init&#45;&gt;proc~check_cohp</title>
<path fill="none" stroke="#000000" d="M355.865,-1537.04C412.243,-1539.74 540.463,-1548.67 574,-1575 740.722,-1705.9 780.821,-1988.18 789.081,-2069.6"/>
<polygon fill="#000000" stroke="#000000" points="785.612,-2070.09 790.045,-2079.72 792.581,-2069.43 785.612,-2070.09"/>
</g>
<!-- listhptr -->
<g id="proc~~siesta_forces~~CallsGraph_node121" class="node"><title>listhptr</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-948 471.5,-948 471.5,-924 525.5,-924 525.5,-948"/>
<text text-anchor="middle" x="498.5" y="-933.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">listhptr</text>
</g>
<!-- proc~state_init&#45;&gt;listhptr -->
<g id="proc~~siesta_forces~~CallsGraph_edge44" class="edge"><title>proc~state_init&#45;&gt;listhptr</title>
<path fill="none" stroke="#000000" d="M355.513,-1530.61C367.103,-1526.84 379.697,-1520.51 387,-1510 457.264,-1408.86 345.514,-1052.72 423,-957 432.253,-945.57 447.21,-940.074 461.303,-937.529"/>
<polygon fill="#000000" stroke="#000000" points="461.887,-940.981 471.318,-936.153 460.934,-934.046 461.887,-940.981"/>
</g>
<!-- xij_offset -->
<g id="proc~~siesta_forces~~CallsGraph_node122" class="node"><title>xij_offset</title>
<polygon fill="#777777" stroke="#777777" points="526,-906 471,-906 471,-882 526,-882 526,-906"/>
<text text-anchor="middle" x="498.5" y="-891.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xij_offset</text>
</g>
<!-- proc~state_init&#45;&gt;xij_offset -->
<g id="proc~~siesta_forces~~CallsGraph_edge80" class="edge"><title>proc~state_init&#45;&gt;xij_offset</title>
<path fill="none" stroke="#000000" d="M355.535,-1530.62C367.129,-1526.85 379.721,-1520.53 387,-1510 462.33,-1401.04 339.889,-1018.15 423,-915 432.159,-903.633 446.96,-898.131 460.966,-895.564"/>
<polygon fill="#000000" stroke="#000000" points="461.512,-899.022 470.931,-894.172 460.543,-892.089 461.512,-899.022"/>
</g>
<!-- setup_kpoint_scf -->
<g id="proc~~siesta_forces~~CallsGraph_node123" class="node"><title>setup_kpoint_scf</title>
<polygon fill="#777777" stroke="#777777" points="545,-864 452,-864 452,-840 545,-840 545,-864"/>
<text text-anchor="middle" x="498.5" y="-849.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_kpoint_scf</text>
</g>
<!-- proc~state_init&#45;&gt;setup_kpoint_scf -->
<g id="proc~~siesta_forces~~CallsGraph_edge46" class="edge"><title>proc~state_init&#45;&gt;setup_kpoint_scf</title>
<path fill="none" stroke="#000000" d="M355.554,-1530.64C367.152,-1526.87 379.742,-1520.54 387,-1510 467.397,-1393.22 334.263,-983.579 423,-873 428.027,-866.736 434.767,-862.252 442.146,-859.059"/>
<polygon fill="#000000" stroke="#000000" points="443.49,-862.296 451.755,-855.667 441.16,-855.696 443.49,-862.296"/>
</g>
<!-- ts_sparse_init -->
<g id="proc~~siesta_forces~~CallsGraph_node126" class="node"><title>ts_sparse_init</title>
<polygon fill="#777777" stroke="#777777" points="538,-822 459,-822 459,-798 538,-798 538,-822"/>
<text text-anchor="middle" x="498.5" y="-807.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ts_sparse_init</text>
</g>
<!-- proc~state_init&#45;&gt;ts_sparse_init -->
<g id="proc~~siesta_forces~~CallsGraph_edge54" class="edge"><title>proc~state_init&#45;&gt;ts_sparse_init</title>
<path fill="none" stroke="#000000" d="M355.57,-1530.65C367.172,-1526.88 379.76,-1520.56 387,-1510 472.464,-1385.39 328.636,-949.012 423,-831 429.551,-822.808 439.032,-817.659 449.049,-814.459"/>
<polygon fill="#000000" stroke="#000000" points="449.934,-817.846 458.738,-811.953 448.181,-811.069 449.934,-817.846"/>
</g>
<!-- normalize_dm -->
<g id="proc~~siesta_forces~~CallsGraph_node127" class="node"><title>normalize_dm</title>
<polygon fill="#777777" stroke="#777777" points="538.5,-3394 458.5,-3394 458.5,-3370 538.5,-3370 538.5,-3394"/>
<text text-anchor="middle" x="498.5" y="-3379.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">normalize_dm</text>
</g>
<!-- proc~state_init&#45;&gt;normalize_dm -->
<g id="proc~~siesta_forces~~CallsGraph_edge71" class="edge"><title>proc~state_init&#45;&gt;normalize_dm</title>
<path fill="none" stroke="#000000" d="M329.522,-1548.01C336.338,-1704.67 407.922,-3342.11 423,-3361 429.414,-3369.03 438.647,-3374.14 448.442,-3377.35"/>
<polygon fill="#000000" stroke="#000000" points="447.778,-3380.8 458.341,-3379.97 449.569,-3374.03 447.778,-3380.8"/>
</g>
<!-- proc~die -->
<g id="proc~~siesta_forces~~CallsGraph_node128" class="node"><title>proc~die</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node128"><a xlink:href=".././proc/die.html" xlink:title="die">
<polygon fill="#d9534f" stroke="#d9534f" points="948,-3344 894,-3344 894,-3320 948,-3320 948,-3344"/>
<text text-anchor="middle" x="921" y="-3329.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">die</text>
</a>
</g>
</g>
<!-- proc~state_init&#45;&gt;proc~die -->
<g id="proc~~siesta_forces~~CallsGraph_edge57" class="edge"><title>proc~state_init&#45;&gt;proc~die</title>
<path fill="none" stroke="#000000" d="M339.566,-1548.16C355.733,-1565.98 388.394,-1599.03 423,-1617 484.419,-1648.89 526.131,-1605.02 574,-1655 589.325,-1671 876.386,-3112.64 915.581,-3309.76"/>
<polygon fill="#000000" stroke="#000000" points="912.152,-3310.47 917.535,-3319.59 919.018,-3309.1 912.152,-3310.47"/>
</g>
<!-- globalize_sum -->
<g id="proc~~siesta_forces~~CallsGraph_node131" class="node"><title>globalize_sum</title>
<polygon fill="#777777" stroke="#777777" points="539,-3352 458,-3352 458,-3328 539,-3328 539,-3352"/>
<text text-anchor="middle" x="498.5" y="-3337.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">globalize_sum</text>
</g>
<!-- proc~state_init&#45;&gt;globalize_sum -->
<g id="proc~~siesta_forces~~CallsGraph_edge61" class="edge"><title>proc~state_init&#45;&gt;globalize_sum</title>
<path fill="none" stroke="#000000" d="M329.519,-1548.25C336.019,-1701.41 401.807,-3240.03 423,-3281 432.062,-3298.52 448.905,-3312.54 464.287,-3322.51"/>
<polygon fill="#000000" stroke="#000000" points="462.748,-3325.67 473.104,-3327.91 466.404,-3319.7 462.748,-3325.67"/>
</g>
<!-- newdspdata2d -->
<g id="proc~~siesta_forces~~CallsGraph_node133" class="node"><title>newdspdata2d</title>
<polygon fill="#777777" stroke="#777777" points="539.5,-780 457.5,-780 457.5,-756 539.5,-756 539.5,-780"/>
<text text-anchor="middle" x="498.5" y="-765.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">newdspdata2d</text>
</g>
<!-- proc~state_init&#45;&gt;newdspdata2d -->
<g id="proc~~siesta_forces~~CallsGraph_edge65" class="edge"><title>proc~state_init&#45;&gt;newdspdata2d</title>
<path fill="none" stroke="#000000" d="M355.585,-1530.66C367.19,-1526.9 379.776,-1520.57 387,-1510 477.532,-1377.56 323.008,-914.446 423,-789 429.154,-781.279 437.913,-776.26 447.274,-773.028"/>
<polygon fill="#000000" stroke="#000000" points="448.472,-776.328 457.164,-770.269 446.591,-769.585 448.472,-776.328"/>
</g>
<!-- proc~message -->
<g id="proc~~siesta_forces~~CallsGraph_node134" class="node"><title>proc~message</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node134"><a xlink:href=".././proc/message.html" xlink:title="message">
<polygon fill="#d9534f" stroke="#d9534f" points="949,-3112 893,-3112 893,-3088 949,-3088 949,-3112"/>
<text text-anchor="middle" x="921" y="-3097.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">message</text>
</a>
</g>
</g>
<!-- proc~state_init&#45;&gt;proc~message -->
<g id="proc~~siesta_forces~~CallsGraph_edge67" class="edge"><title>proc~state_init&#45;&gt;proc~message</title>
<path fill="none" stroke="#000000" d="M353.726,-1523.84C376.652,-1512.82 409.231,-1497.87 423,-1495 488.697,-1481.3 510.948,-1472.01 574,-1495 646.016,-1521.25 664.117,-1541.8 706,-1606 823.655,-1786.34 803.43,-1859.16 842,-2071 914.605,-2469.78 919.8,-2967.39 920.026,-3077.69"/>
<polygon fill="#000000" stroke="#000000" points="916.526,-3077.92 920.034,-3087.92 923.526,-3077.92 916.526,-3077.92"/>
</g>
<!-- madelung -->
<g id="proc~~siesta_forces~~CallsGraph_node135" class="node"><title>madelung</title>
<polygon fill="#777777" stroke="#777777" points="528.5,-738 468.5,-738 468.5,-714 528.5,-714 528.5,-738"/>
<text text-anchor="middle" x="498.5" y="-723.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">madelung</text>
</g>
<!-- proc~state_init&#45;&gt;madelung -->
<g id="proc~~siesta_forces~~CallsGraph_edge69" class="edge"><title>proc~state_init&#45;&gt;madelung</title>
<path fill="none" stroke="#000000" d="M355.598,-1530.67C367.206,-1526.91 379.791,-1520.58 387,-1510 434.801,-1439.87 370.189,-813.44 423,-747 431.529,-736.27 445.088,-730.757 458.316,-728.006"/>
<polygon fill="#000000" stroke="#000000" points="458.961,-731.447 468.277,-726.401 457.848,-724.537 458.961,-731.447"/>
</g>
<!-- numh -->
<g id="proc~~siesta_forces~~CallsGraph_node137" class="node"><title>numh</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-696 471.5,-696 471.5,-672 525.5,-672 525.5,-696"/>
<text text-anchor="middle" x="498.5" y="-681.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">numh</text>
</g>
<!-- proc~state_init&#45;&gt;numh -->
<g id="proc~~siesta_forces~~CallsGraph_edge73" class="edge"><title>proc~state_init&#45;&gt;numh</title>
<path fill="none" stroke="#000000" d="M355.61,-1530.68C367.22,-1526.92 379.804,-1520.59 387,-1510 437.335,-1435.95 367.375,-775.158 423,-705 432.137,-693.476 447.076,-687.967 461.188,-685.437"/>
<polygon fill="#000000" stroke="#000000" points="461.783,-688.888 471.222,-684.077 460.843,-681.952 461.783,-688.888"/>
</g>
<!-- write_zmatrix -->
<g id="proc~~siesta_forces~~CallsGraph_node139" class="node"><title>write_zmatrix</title>
<polygon fill="#777777" stroke="#777777" points="536.5,-654 460.5,-654 460.5,-630 536.5,-630 536.5,-654"/>
<text text-anchor="middle" x="498.5" y="-639.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_zmatrix</text>
</g>
<!-- proc~state_init&#45;&gt;write_zmatrix -->
<g id="proc~~siesta_forces~~CallsGraph_edge85" class="edge"><title>proc~state_init&#45;&gt;write_zmatrix</title>
<path fill="none" stroke="#000000" d="M355.62,-1530.68C367.233,-1526.93 379.815,-1520.59 387,-1510 439.87,-1432.04 364.56,-736.876 423,-663 429.83,-654.366 439.918,-649.108 450.479,-645.948"/>
<polygon fill="#000000" stroke="#000000" points="451.328,-649.344 460.231,-643.6 449.69,-642.538 451.328,-649.344"/>
</g>
<!-- ts_write_tshs -->
<g id="proc~~siesta_forces~~CallsGraph_node140" class="node"><title>ts_write_tshs</title>
<polygon fill="#777777" stroke="#777777" points="536,-612 461,-612 461,-588 536,-588 536,-612"/>
<text text-anchor="middle" x="498.5" y="-597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ts_write_tshs</text>
</g>
<!-- proc~state_init&#45;&gt;ts_write_tshs -->
<g id="proc~~siesta_forces~~CallsGraph_edge64" class="edge"><title>proc~state_init&#45;&gt;ts_write_tshs</title>
<path fill="none" stroke="#000000" d="M355.63,-1530.69C367.245,-1526.93 379.826,-1520.6 387,-1510 442.405,-1428.13 361.745,-698.594 423,-621 429.949,-612.198 440.284,-606.903 451.06,-603.764"/>
<polygon fill="#000000" stroke="#000000" points="452.05,-607.127 460.995,-601.448 450.461,-600.309 452.05,-607.127"/>
</g>
<!-- fname_tshs -->
<g id="proc~~siesta_forces~~CallsGraph_node141" class="node"><title>fname_tshs</title>
<polygon fill="#777777" stroke="#777777" points="532.5,-570 464.5,-570 464.5,-546 532.5,-546 532.5,-570"/>
<text text-anchor="middle" x="498.5" y="-555.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fname_tshs</text>
</g>
<!-- proc~state_init&#45;&gt;fname_tshs -->
<g id="proc~~siesta_forces~~CallsGraph_edge68" class="edge"><title>proc~state_init&#45;&gt;fname_tshs</title>
<path fill="none" stroke="#000000" d="M355.638,-1530.69C367.255,-1526.94 379.836,-1520.61 387,-1510 444.94,-1424.21 358.93,-660.313 423,-579 430.667,-569.269 442.473,-563.824 454.443,-560.839"/>
<polygon fill="#000000" stroke="#000000" points="455.313,-564.235 464.449,-558.87 453.961,-557.367 455.313,-564.235"/>
</g>
<!-- proc~mixers_scf_history_init&#45;&gt;proc~mixers_history_init -->
<g id="proc~~siesta_forces~~CallsGraph_edge94" class="edge"><title>proc~mixers_scf_history_init&#45;&gt;proc~mixers_history_init</title>
<path fill="none" stroke="#000000" d="M223.109,-1963.97C226.869,-1961.51 230.259,-1958.56 233,-1955 292.883,-1877.29 209.512,-1593.01 269,-1515 302.847,-1470.61 354.406,-1517.31 387,-1472 477.668,-1345.95 327.688,-197.579 423,-75 427.06,-69.7786 432.313,-65.7887 438.149,-62.7498"/>
<polygon fill="#000000" stroke="#000000" points="439.86,-65.8271 447.714,-58.7168 437.14,-59.377 439.86,-65.8271"/>
</g>
<!-- proc~compute_max_diff_2d -->
<g id="proc~~siesta_forces~~CallsGraph_node59" class="node"><title>proc~compute_max_diff_2d</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node59"><a xlink:href=".././proc/compute_max_diff_2d.html" xlink:title="compute_max_diff_2d">
<polygon fill="#d9534f" stroke="#d9534f" points="387,-1430 269,-1430 269,-1406 387,-1406 387,-1430"/>
<text text-anchor="middle" x="328" y="-1415.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_max_diff_2d</text>
</a>
</g>
</g>
<!-- interface~compute_max_diff&#45;&gt;proc~compute_max_diff_2d -->
<g id="proc~~siesta_forces~~CallsGraph_edge96" class="edge"><title>interface~compute_max_diff&#45;&gt;proc~compute_max_diff_2d</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M222.698,-1758.04C226.595,-1755.57 230.127,-1752.59 233,-1749 318.243,-1642.39 188.206,-1554.02 269,-1444 271.29,-1440.88 274.041,-1438.13 277.083,-1435.7"/>
<polygon fill="#000000" stroke="#000000" points="279.289,-1438.44 285.701,-1430.01 275.429,-1432.6 279.289,-1438.44"/>
</g>
<!-- proc~compute_max_diff_1d -->
<g id="proc~~siesta_forces~~CallsGraph_node98" class="node"><title>proc~compute_max_diff_1d</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node98"><a xlink:href=".././proc/compute_max_diff_1d.html" xlink:title="compute_max_diff_1d">
<polygon fill="#d9534f" stroke="#d9534f" points="387,-1388 269,-1388 269,-1364 387,-1364 387,-1388"/>
<text text-anchor="middle" x="328" y="-1373.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_max_diff_1d</text>
</a>
</g>
</g>
<!-- interface~compute_max_diff&#45;&gt;proc~compute_max_diff_1d -->
<g id="proc~~siesta_forces~~CallsGraph_edge95" class="edge"><title>interface~compute_max_diff&#45;&gt;proc~compute_max_diff_1d</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M222.756,-1758.09C226.642,-1755.61 230.155,-1752.62 233,-1749 330.251,-1625.42 172.25,-1520.98 269,-1397 269.692,-1396.11 270.424,-1395.26 271.193,-1394.45"/>
<polygon fill="#000000" stroke="#000000" points="273.47,-1397.11 278.972,-1388.06 269.025,-1391.7 273.47,-1397.11"/>
</g>
<!-- mpi_finalize -->
<g id="proc~~siesta_forces~~CallsGraph_node46" class="node"><title>mpi_finalize</title>
<polygon fill="#777777" stroke="#777777" points="692.5,-3344 623.5,-3344 623.5,-3320 692.5,-3320 692.5,-3344"/>
<text text-anchor="middle" x="658" y="-3329.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_finalize</text>
</g>
<!-- proc~bye&#45;&gt;mpi_finalize -->
<g id="proc~~siesta_forces~~CallsGraph_edge98" class="edge"><title>proc~bye&#45;&gt;mpi_finalize</title>
<path fill="none" stroke="#000000" d="M525.634,-3577.48C541.909,-3574.51 561.969,-3568.05 574,-3554 631.62,-3486.74 558.281,-3429.9 610,-3358 612.078,-3355.11 614.58,-3352.51 617.335,-3350.16"/>
<polygon fill="#000000" stroke="#000000" points="619.519,-3352.91 625.621,-3344.24 615.45,-3347.21 619.519,-3352.91"/>
</g>
<!-- pxfflush -->
<g id="proc~~siesta_forces~~CallsGraph_node94" class="node"><title>pxfflush</title>
<polygon fill="#777777" stroke="#777777" points="1060.5,-3152 1006.5,-3152 1006.5,-3128 1060.5,-3128 1060.5,-3152"/>
<text text-anchor="middle" x="1033.5" y="-3137.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pxfflush</text>
</g>
<!-- proc~bye&#45;&gt;pxfflush -->
<g id="proc~~siesta_forces~~CallsGraph_edge97" class="edge"><title>proc~bye&#45;&gt;pxfflush</title>
<path fill="none" stroke="#000000" d="M511.598,-3567.71C528.561,-3549.69 559.013,-3514.28 574,-3478 614.174,-3380.75 539.386,-3322.01 610,-3244 711.744,-3131.6 913.643,-3131.52 996.119,-3136.73"/>
<polygon fill="#000000" stroke="#000000" points="996.038,-3140.23 1006.26,-3137.43 996.525,-3133.25 996.038,-3140.23"/>
</g>
<!-- cmlfinishfile -->
<g id="proc~~siesta_forces~~CallsGraph_node100" class="node"><title>cmlfinishfile</title>
<polygon fill="#777777" stroke="#777777" points="1067,-3227 1000,-3227 1000,-3203 1067,-3203 1067,-3227"/>
<text text-anchor="middle" x="1033.5" y="-3212.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cmlfinishfile</text>
</g>
<!-- proc~bye&#45;&gt;cmlfinishfile -->
<g id="proc~~siesta_forces~~CallsGraph_edge99" class="edge"><title>proc~bye&#45;&gt;cmlfinishfile</title>
<path fill="none" stroke="#000000" d="M511.029,-3567.89C527.578,-3549.81 557.848,-3514.02 574,-3478 605.069,-3408.72 556.61,-3364.99 610,-3311 713.2,-3206.65 904.514,-3205.6 989.681,-3211"/>
<polygon fill="#000000" stroke="#000000" points="989.551,-3214.5 999.77,-3211.7 990.037,-3207.52 989.551,-3214.5"/>
</g>
<!-- proc~state_analysis&#45;&gt;timer -->
<g id="proc~~siesta_forces~~CallsGraph_edge119" class="edge"><title>proc~state_analysis&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M330.053,-2915.02C335.511,-2974.23 362.666,-3233.83 423,-3281 475.872,-3322.33 523.022,-3324.65 574,-3281 652.927,-3213.42 531.073,-3117.58 610,-3050 688.323,-2982.94 762.26,-2984.63 842,-3050 905.093,-3101.72 829.964,-3164.06 878,-3230 903.773,-3265.38 937.216,-3243.38 964,-3278 1002.79,-3328.13 979.19,-3356.13 1000,-3416 1006.33,-3434.2 1015.22,-3454.17 1022.1,-3468.77"/>
<polygon fill="#000000" stroke="#000000" points="1019.01,-3470.42 1026.49,-3477.93 1025.33,-3467.4 1019.01,-3470.42"/>
</g>
<!-- proc~state_analysis&#45;&gt;volcel -->
<g id="proc~~siesta_forces~~CallsGraph_edge102" class="edge"><title>proc~state_analysis&#45;&gt;volcel</title>
<path fill="none" stroke="#000000" d="M353.337,-2915.05C372.082,-2924.04 398.799,-2936.24 423,-2945 435.339,-2949.47 449.105,-2953.58 461.414,-2956.97"/>
<polygon fill="#000000" stroke="#000000" points="460.783,-2960.42 471.348,-2959.62 462.593,-2953.66 460.783,-2960.42"/>
</g>
<!-- moments -->
<g id="proc~~siesta_forces~~CallsGraph_node31" class="node"><title>moments</title>
<polygon fill="#777777" stroke="#777777" points="527,-2936 470,-2936 470,-2912 527,-2912 527,-2936"/>
<text text-anchor="middle" x="498.5" y="-2921.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">moments</text>
</g>
<!-- proc~state_analysis&#45;&gt;moments -->
<g id="proc~~siesta_forces~~CallsGraph_edge103" class="edge"><title>proc~state_analysis&#45;&gt;moments</title>
<path fill="none" stroke="#000000" d="M368.081,-2907.87C395.753,-2911.32 432.656,-2915.92 459.974,-2919.32"/>
<polygon fill="#000000" stroke="#000000" points="459.579,-2922.8 469.935,-2920.56 460.445,-2915.85 459.579,-2922.8"/>
</g>
<!-- cartesianforce_to_zmatforce -->
<g id="proc~~siesta_forces~~CallsGraph_node35" class="node"><title>cartesianforce_to_zmatforce</title>
<polygon fill="#777777" stroke="#777777" points="572.5,-2894 424.5,-2894 424.5,-2870 572.5,-2870 572.5,-2894"/>
<text text-anchor="middle" x="498.5" y="-2879.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cartesianforce_to_zmatforce</text>
</g>
<!-- proc~state_analysis&#45;&gt;cartesianforce_to_zmatforce -->
<g id="proc~~siesta_forces~~CallsGraph_edge106" class="edge"><title>proc~state_analysis&#45;&gt;cartesianforce_to_zmatforce</title>
<path fill="none" stroke="#000000" d="M368.081,-2898.13C381.929,-2896.4 398.088,-2894.39 414.201,-2892.38"/>
<polygon fill="#000000" stroke="#000000" points="414.716,-2895.84 424.206,-2891.13 413.85,-2888.9 414.716,-2895.84"/>
</g>
<!-- print_spin -->
<g id="proc~~siesta_forces~~CallsGraph_node36" class="node"><title>print_spin</title>
<polygon fill="#777777" stroke="#777777" points="528,-2852 469,-2852 469,-2828 528,-2828 528,-2852"/>
<text text-anchor="middle" x="498.5" y="-2837.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_spin</text>
</g>
<!-- proc~state_analysis&#45;&gt;print_spin -->
<g id="proc~~siesta_forces~~CallsGraph_edge107" class="edge"><title>proc~state_analysis&#45;&gt;print_spin</title>
<path fill="none" stroke="#000000" d="M353.337,-2890.95C372.082,-2881.96 398.799,-2869.76 423,-2861 434.531,-2856.82 447.309,-2852.96 458.98,-2849.71"/>
<polygon fill="#000000" stroke="#000000" points="460.155,-2853.02 468.891,-2847.02 458.324,-2846.26 460.155,-2853.02"/>
</g>
<!-- siesta_write_stress_pressure -->
<g id="proc~~siesta_forces~~CallsGraph_node37" class="node"><title>siesta_write_stress_pressure</title>
<polygon fill="#777777" stroke="#777777" points="574,-2810 423,-2810 423,-2786 574,-2786 574,-2810"/>
<text text-anchor="middle" x="498.5" y="-2795.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_write_stress_pressure</text>
</g>
<!-- proc~state_analysis&#45;&gt;siesta_write_stress_pressure -->
<g id="proc~~siesta_forces~~CallsGraph_edge109" class="edge"><title>proc~state_analysis&#45;&gt;siesta_write_stress_pressure</title>
<path fill="none" stroke="#000000" d="M339.269,-2890.81C355.303,-2872.54 388.082,-2838.17 423,-2819 426.479,-2817.09 430.146,-2815.34 433.913,-2813.74"/>
<polygon fill="#000000" stroke="#000000" points="435.36,-2816.94 443.428,-2810.07 432.838,-2810.41 435.36,-2816.94"/>
</g>
<!-- slua_call -->
<g id="proc~~siesta_forces~~CallsGraph_node38" class="node"><title>slua_call</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-2768 471.5,-2768 471.5,-2744 525.5,-2744 525.5,-2768"/>
<text text-anchor="middle" x="498.5" y="-2753.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">slua_call</text>
</g>
<!-- proc~state_analysis&#45;&gt;slua_call -->
<g id="proc~~siesta_forces~~CallsGraph_edge111" class="edge"><title>proc~state_analysis&#45;&gt;slua_call</title>
<path fill="none" stroke="#000000" d="M334.617,-2890.86C346.914,-2865.65 378.696,-2807.46 423,-2777 434.272,-2769.25 448.358,-2764.34 461.239,-2761.24"/>
<polygon fill="#000000" stroke="#000000" points="462.176,-2764.62 471.233,-2759.13 460.725,-2757.78 462.176,-2764.62"/>
</g>
<!-- update_freeeharris -->
<g id="proc~~siesta_forces~~CallsGraph_node41" class="node"><title>update_freeeharris</title>
<polygon fill="#777777" stroke="#777777" points="550,-2726 447,-2726 447,-2702 550,-2702 550,-2726"/>
<text text-anchor="middle" x="498.5" y="-2711.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_freeeharris</text>
</g>
<!-- proc~state_analysis&#45;&gt;update_freeeharris -->
<g id="proc~~siesta_forces~~CallsGraph_edge112" class="edge"><title>proc~state_analysis&#45;&gt;update_freeeharris</title>
<path fill="none" stroke="#000000" d="M332.3,-2890.7C341.286,-2859.63 369.199,-2777.42 423,-2735 427.353,-2731.57 432.237,-2728.7 437.369,-2726.29"/>
<polygon fill="#000000" stroke="#000000" points="438.864,-2729.46 446.811,-2722.46 436.229,-2722.98 438.864,-2729.46"/>
</g>
<!-- update_freee -->
<g id="proc~~siesta_forces~~CallsGraph_node44" class="node"><title>update_freee</title>
<polygon fill="#777777" stroke="#777777" points="536.5,-5834 460.5,-5834 460.5,-5810 536.5,-5810 536.5,-5834"/>
<text text-anchor="middle" x="498.5" y="-5819.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_freee</text>
</g>
<!-- proc~state_analysis&#45;&gt;update_freee -->
<g id="proc~~siesta_forces~~CallsGraph_edge113" class="edge"><title>proc~state_analysis&#45;&gt;update_freee</title>
<path fill="none" stroke="#000000" d="M330.665,-2915.03C338.735,-2973.97 373.934,-3238.23 387,-3456 390.902,-3521.03 383.279,-5749.36 423,-5801 429.775,-5809.81 439.946,-5815.12 450.612,-5818.27"/>
<polygon fill="#000000" stroke="#000000" points="449.926,-5821.7 460.463,-5820.59 451.535,-5814.89 449.926,-5821.7"/>
</g>
<!-- born_charge -->
<g id="proc~~siesta_forces~~CallsGraph_node48" class="node"><title>born_charge</title>
<polygon fill="#777777" stroke="#777777" points="535,-2684 462,-2684 462,-2660 535,-2660 535,-2684"/>
<text text-anchor="middle" x="498.5" y="-2669.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">born_charge</text>
</g>
<!-- proc~state_analysis&#45;&gt;born_charge -->
<g id="proc~~siesta_forces~~CallsGraph_edge114" class="edge"><title>proc~state_analysis&#45;&gt;born_charge</title>
<path fill="none" stroke="#000000" d="M330.779,-2890.92C336.717,-2855.03 359.212,-2748.09 423,-2693 431.17,-2685.94 441.548,-2681.25 451.943,-2678.13"/>
<polygon fill="#000000" stroke="#000000" points="453.026,-2681.46 461.845,-2675.59 451.289,-2674.68 453.026,-2681.46"/>
</g>
<!-- proc~state_analysis&#45;&gt;cmladdproperty -->
<g id="proc~~siesta_forces~~CallsGraph_edge115" class="edge"><title>proc~state_analysis&#45;&gt;cmladdproperty</title>
<path fill="none" stroke="#000000" d="M330.063,-2890.84C335.753,-2828.43 364.562,-2544.72 423,-2483 428.977,-2476.69 436.69,-2472.22 444.88,-2469.08"/>
<polygon fill="#000000" stroke="#000000" points="446.179,-2472.34 454.639,-2465.96 444.048,-2465.67 446.179,-2472.34"/>
</g>
<!-- mulliken -->
<g id="proc~~siesta_forces~~CallsGraph_node51" class="node"><title>mulliken</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-2642 471.5,-2642 471.5,-2618 525.5,-2618 525.5,-2642"/>
<text text-anchor="middle" x="498.5" y="-2627.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mulliken</text>
</g>
<!-- proc~state_analysis&#45;&gt;mulliken -->
<g id="proc~~siesta_forces~~CallsGraph_edge117" class="edge"><title>proc~state_analysis&#45;&gt;mulliken</title>
<path fill="none" stroke="#000000" d="M329.778,-2890.91C333.044,-2850.53 349.152,-2719.01 423,-2651 433.398,-2641.42 447.829,-2636.17 461.223,-2633.31"/>
<polygon fill="#000000" stroke="#000000" points="461.94,-2636.74 471.18,-2631.55 460.723,-2629.84 461.94,-2636.74"/>
</g>
<!-- eggbox -->
<g id="proc~~siesta_forces~~CallsGraph_node52" class="node"><title>eggbox</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-2600 471.5,-2600 471.5,-2576 525.5,-2576 525.5,-2600"/>
<text text-anchor="middle" x="498.5" y="-2585.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">eggbox</text>
</g>
<!-- proc~state_analysis&#45;&gt;eggbox -->
<g id="proc~~siesta_forces~~CallsGraph_edge118" class="edge"><title>proc~state_analysis&#45;&gt;eggbox</title>
<path fill="none" stroke="#000000" d="M329.044,-2890.85C329.89,-2846.29 338.975,-2690.16 423,-2609 433.244,-2599.11 447.775,-2593.8 461.288,-2590.99"/>
<polygon fill="#000000" stroke="#000000" points="462.06,-2594.41 471.334,-2589.29 460.89,-2587.51 462.06,-2594.41"/>
</g>
<!-- cmlendmodule -->
<g id="proc~~siesta_forces~~CallsGraph_node57" class="node"><title>cmlendmodule</title>
<polygon fill="#777777" stroke="#777777" points="539.5,-2558 457.5,-2558 457.5,-2534 539.5,-2534 539.5,-2558"/>
<text text-anchor="middle" x="498.5" y="-2543.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cmlendmodule</text>
</g>
<!-- proc~state_analysis&#45;&gt;cmlendmodule -->
<g id="proc~~siesta_forces~~CallsGraph_edge120" class="edge"><title>proc~state_analysis&#45;&gt;cmlendmodule</title>
<path fill="none" stroke="#000000" d="M328.478,-2890.86C327.095,-2842.49 328.649,-2661.54 423,-2567 429.692,-2560.29 438.349,-2555.69 447.38,-2552.54"/>
<polygon fill="#000000" stroke="#000000" points="448.633,-2555.82 457.252,-2549.66 446.672,-2549.1 448.633,-2555.82"/>
</g>
<!-- proc~state_analysis&#45;&gt;write_debug -->
<g id="proc~~siesta_forces~~CallsGraph_edge121" class="edge"><title>proc~state_analysis&#45;&gt;write_debug</title>
<path fill="none" stroke="#000000" d="M330.206,-2915.46C337.852,-2993.17 380.618,-3409.34 423,-3445 474.349,-3488.21 520.744,-3485.84 574,-3445 622.936,-3407.48 561.064,-3348.52 610,-3311 643.858,-3285.04 674.303,-3282.44 706,-3311 763.264,-3362.6 724.906,-3580.84 742,-3656 785.286,-3846.33 879.429,-4063.97 910.114,-4132.31"/>
<polygon fill="#000000" stroke="#000000" points="907.017,-4133.96 914.322,-4141.63 913.397,-4131.08 907.017,-4133.96"/>
</g>
<!-- fixed -->
<g id="proc~~siesta_forces~~CallsGraph_node60" class="node"><title>fixed</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-2516 471.5,-2516 471.5,-2492 525.5,-2492 525.5,-2516"/>
<text text-anchor="middle" x="498.5" y="-2501.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fixed</text>
</g>
<!-- proc~state_analysis&#45;&gt;fixed -->
<g id="proc~~siesta_forces~~CallsGraph_edge122" class="edge"><title>proc~state_analysis&#45;&gt;fixed</title>
<path fill="none" stroke="#000000" d="M330.379,-2890.9C337.274,-2832.46 369.811,-2579.86 423,-2525 432.988,-2514.7 447.605,-2509.34 461.253,-2506.59"/>
<polygon fill="#000000" stroke="#000000" points="462.089,-2510 471.407,-2504.95 460.978,-2503.09 462.089,-2510"/>
</g>
<!-- kin_stress -->
<g id="proc~~siesta_forces~~CallsGraph_node62" class="node"><title>kin_stress</title>
<polygon fill="#777777" stroke="#777777" points="529,-3272 468,-3272 468,-3248 529,-3248 529,-3272"/>
<text text-anchor="middle" x="498.5" y="-3257.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">kin_stress</text>
</g>
<!-- proc~state_analysis&#45;&gt;kin_stress -->
<g id="proc~~siesta_forces~~CallsGraph_edge104" class="edge"><title>proc~state_analysis&#45;&gt;kin_stress</title>
<path fill="none" stroke="#000000" d="M328.478,-2915.14C327.095,-2963.51 328.649,-3144.46 423,-3239 432.288,-3248.31 445.359,-3253.57 457.965,-3256.51"/>
<polygon fill="#000000" stroke="#000000" points="457.413,-3259.97 467.893,-3258.42 458.73,-3253.1 457.413,-3259.97"/>
</g>
<!-- cmlstartmodule -->
<g id="proc~~siesta_forces~~CallsGraph_node81" class="node"><title>cmlstartmodule</title>
<polygon fill="#777777" stroke="#777777" points="541,-3230 456,-3230 456,-3206 541,-3206 541,-3230"/>
<text text-anchor="middle" x="498.5" y="-3215.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cmlstartmodule</text>
</g>
<!-- proc~state_analysis&#45;&gt;cmlstartmodule -->
<g id="proc~~siesta_forces~~CallsGraph_edge116" class="edge"><title>proc~state_analysis&#45;&gt;cmlstartmodule</title>
<path fill="none" stroke="#000000" d="M329.044,-2915.15C329.89,-2959.71 338.975,-3115.84 423,-3197 429.461,-3203.24 437.627,-3207.65 446.167,-3210.77"/>
<polygon fill="#000000" stroke="#000000" points="445.311,-3214.17 455.898,-3213.76 447.369,-3207.48 445.311,-3214.17"/>
</g>
<!-- amass -->
<g id="proc~~siesta_forces~~CallsGraph_node112" class="node"><title>amass</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-3188 471.5,-3188 471.5,-3164 525.5,-3164 525.5,-3188"/>
<text text-anchor="middle" x="498.5" y="-3173.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">amass</text>
</g>
<!-- proc~state_analysis&#45;&gt;amass -->
<g id="proc~~siesta_forces~~CallsGraph_edge100" class="edge"><title>proc~state_analysis&#45;&gt;amass</title>
<path fill="none" stroke="#000000" d="M329.778,-2915.09C333.044,-2955.47 349.152,-3086.99 423,-3155 433.398,-3164.58 447.829,-3169.83 461.223,-3172.69"/>
<polygon fill="#000000" stroke="#000000" points="460.723,-3176.16 471.18,-3174.45 461.94,-3169.26 460.723,-3176.16"/>
</g>
<!-- va -->
<g id="proc~~siesta_forces~~CallsGraph_node113" class="node"><title>va</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-3146 471.5,-3146 471.5,-3122 525.5,-3122 525.5,-3146"/>
<text text-anchor="middle" x="498.5" y="-3131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">va</text>
</g>
<!-- proc~state_analysis&#45;&gt;va -->
<g id="proc~~siesta_forces~~CallsGraph_edge101" class="edge"><title>proc~state_analysis&#45;&gt;va</title>
<path fill="none" stroke="#000000" d="M330.779,-2915.08C336.717,-2950.97 359.212,-3057.91 423,-3113 433.698,-3122.24 448.182,-3127.43 461.536,-3130.34"/>
<polygon fill="#000000" stroke="#000000" points="460.978,-3133.8 471.445,-3132.15 462.237,-3126.91 460.978,-3133.8"/>
</g>
<!-- siesta_write_forces -->
<g id="proc~~siesta_forces~~CallsGraph_node117" class="node"><title>siesta_write_forces</title>
<polygon fill="#777777" stroke="#777777" points="550.5,-3104 446.5,-3104 446.5,-3080 550.5,-3080 550.5,-3104"/>
<text text-anchor="middle" x="498.5" y="-3089.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_write_forces</text>
</g>
<!-- proc~state_analysis&#45;&gt;siesta_write_forces -->
<g id="proc~~siesta_forces~~CallsGraph_edge105" class="edge"><title>proc~state_analysis&#45;&gt;siesta_write_forces</title>
<path fill="none" stroke="#000000" d="M332.3,-2915.3C341.286,-2946.37 369.199,-3028.58 423,-3071 427.287,-3074.38 432.089,-3077.22 437.136,-3079.6"/>
<polygon fill="#000000" stroke="#000000" points="435.844,-3082.85 446.424,-3083.41 438.5,-3076.37 435.844,-3082.85"/>
</g>
<!-- wallclock -->
<g id="proc~~siesta_forces~~CallsGraph_node124" class="node"><title>wallclock</title>
<polygon fill="#777777" stroke="#777777" points="526,-3062 471,-3062 471,-3038 526,-3038 526,-3062"/>
<text text-anchor="middle" x="498.5" y="-3047.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">wallclock</text>
</g>
<!-- proc~state_analysis&#45;&gt;wallclock -->
<g id="proc~~siesta_forces~~CallsGraph_edge108" class="edge"><title>proc~state_analysis&#45;&gt;wallclock</title>
<path fill="none" stroke="#000000" d="M334.617,-2915.14C346.914,-2940.35 378.696,-2998.54 423,-3029 434.184,-3036.69 448.14,-3041.58 460.939,-3044.68"/>
<polygon fill="#000000" stroke="#000000" points="460.37,-3048.14 470.881,-3046.81 461.833,-3041.3 460.37,-3048.14"/>
</g>
<!-- remove_intramol_pressure -->
<g id="proc~~siesta_forces~~CallsGraph_node125" class="node"><title>remove_intramol_pressure</title>
<polygon fill="#777777" stroke="#777777" points="569,-3020 428,-3020 428,-2996 569,-2996 569,-3020"/>
<text text-anchor="middle" x="498.5" y="-3005.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">remove_intramol_pressure</text>
</g>
<!-- proc~state_analysis&#45;&gt;remove_intramol_pressure -->
<g id="proc~~siesta_forces~~CallsGraph_edge110" class="edge"><title>proc~state_analysis&#45;&gt;remove_intramol_pressure</title>
<path fill="none" stroke="#000000" d="M339.269,-2915.19C355.303,-2933.46 388.082,-2967.83 423,-2987 426.479,-2988.91 430.146,-2990.66 433.913,-2992.26"/>
<polygon fill="#000000" stroke="#000000" points="432.838,-2995.59 443.428,-2995.93 435.36,-2989.06 432.838,-2995.59"/>
</g>
<!-- proc~compute_charge_diff&#45;&gt;fdf_get -->
<g id="proc~~siesta_forces~~CallsGraph_edge123" class="edge"><title>proc~compute_charge_diff&#45;&gt;fdf_get</title>
<path fill="none" stroke="#000000" d="M203.359,-5903.06C222.065,-5910.41 246.76,-5919.76 269,-5927 336.157,-5948.87 415.972,-5969.73 461.286,-5981.11"/>
<polygon fill="#000000" stroke="#000000" points="460.675,-5984.56 471.225,-5983.59 462.371,-5977.77 460.675,-5984.56"/>
</g>
<!-- proc~mixing_scf_converged&#45;&gt;reset -->
<g id="proc~~siesta_forces~~CallsGraph_edge124" class="edge"><title>proc~mixing_scf_converged&#45;&gt;reset</title>
<path fill="none" stroke="#000000" d="M216.06,-1631.94C222.569,-1628.4 228.581,-1623.84 233,-1618 304.158,-1523.9 194.841,-1446.76 269,-1355 274.612,-1348.06 282.721,-1343.41 291.105,-1340.3"/>
<polygon fill="#000000" stroke="#000000" points="292.391,-1343.56 300.94,-1337.3 290.354,-1336.87 292.391,-1343.56"/>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;proc~bye -->
<g id="proc~~siesta_forces~~CallsGraph_edge127" class="edge"><title>proc~setup_hamiltonian&#45;&gt;proc~bye</title>
<path fill="none" stroke="#000000" d="M174.657,-3652.92C178.96,-3615.58 197.679,-3501.82 269,-3456 313.122,-3427.65 343.995,-3425.98 387,-3456 425.049,-3482.56 389.924,-3521.46 423,-3554 433.35,-3564.18 447.899,-3570.39 461.396,-3574.17"/>
<polygon fill="#000000" stroke="#000000" points="460.882,-3577.65 471.426,-3576.61 462.538,-3570.84 460.882,-3577.65"/>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;timer -->
<g id="proc~~siesta_forces~~CallsGraph_edge131" class="edge"><title>proc~setup_hamiltonian&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M222.538,-3674.92C226.318,-3676.88 229.873,-3679.21 233,-3682 264.228,-3709.86 234.21,-3745.75 269,-3769 312.601,-3798.14 343.154,-3797.77 387,-3769 420.617,-3746.94 392.757,-3712.5 423,-3686 475.484,-3640.02 528.038,-3695.5 574,-3643 647.071,-3559.53 526.089,-3468.57 610,-3396 729.369,-3292.77 937.235,-3422.18 1008.06,-3472"/>
<polygon fill="#000000" stroke="#000000" points="1006.2,-3474.97 1016.37,-3477.93 1010.26,-3469.28 1006.2,-3474.97"/>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;re_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge134" class="edge"><title>proc~setup_hamiltonian&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M222.557,-3673.21C226.537,-3675.5 230.125,-3678.38 233,-3682 281.882,-3743.48 258.764,-4310.12 269,-4388 311.701,-4712.88 168.249,-4902.92 423,-5109 570.395,-5228.24 682.373,-5131.28 842,-5029 901.991,-4990.56 920.927,-4981.76 964,-4925 994.469,-4884.85 1015.69,-4828.98 1025.78,-4798.66"/>
<polygon fill="#000000" stroke="#000000" points="1029.14,-4799.66 1028.89,-4789.07 1022.48,-4797.5 1029.14,-4799.66"/>
</g>
<!-- h -->
<g id="proc~~siesta_forces~~CallsGraph_node53" class="node"><title>h</title>
<polygon fill="#777777" stroke="#777777" points="355,-3657 301,-3657 301,-3633 355,-3633 355,-3657"/>
<text text-anchor="middle" x="328" y="-3642.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">h</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;h -->
<g id="proc~~siesta_forces~~CallsGraph_edge129" class="edge"><title>proc~setup_hamiltonian&#45;&gt;h</title>
<path fill="none" stroke="#000000" d="M222.913,-3658.56C245.005,-3655.68 270.572,-3652.35 290.838,-3649.71"/>
<polygon fill="#000000" stroke="#000000" points="291.443,-3653.16 300.906,-3648.4 290.538,-3646.22 291.443,-3653.16"/>
</g>
<!-- proc~dhscf -->
<g id="proc~~siesta_forces~~CallsGraph_node63" class="node"><title>proc~dhscf</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node63"><a xlink:href=".././proc/dhscf.html" xlink:title="dhscf">
<polygon fill="#d9534f" stroke="#d9534f" points="355,-4379 301,-4379 301,-4355 355,-4355 355,-4379"/>
<text text-anchor="middle" x="328" y="-4364.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dhscf</text>
</a>
</g>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;proc~dhscf -->
<g id="proc~~siesta_forces~~CallsGraph_edge132" class="edge"><title>proc~setup_hamiltonian&#45;&gt;proc~dhscf</title>
<path fill="none" stroke="#000000" d="M176.164,-3677.18C194.196,-3759.65 298.371,-4236.07 322.162,-4344.88"/>
<polygon fill="#000000" stroke="#000000" points="318.767,-4345.73 324.323,-4354.76 325.606,-4344.24 318.767,-4345.73"/>
</g>
<!-- write_hsx -->
<g id="proc~~siesta_forces~~CallsGraph_node76" class="node"><title>write_hsx</title>
<polygon fill="#777777" stroke="#777777" points="357,-3615 299,-3615 299,-3591 357,-3591 357,-3615"/>
<text text-anchor="middle" x="328" y="-3600.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_hsx</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;write_hsx -->
<g id="proc~~siesta_forces~~CallsGraph_edge125" class="edge"><title>proc~setup_hamiltonian&#45;&gt;write_hsx</title>
<path fill="none" stroke="#000000" d="M200.494,-3652.91C219.526,-3644.52 245.676,-3633.22 269,-3624 275.491,-3621.43 282.435,-3618.81 289.183,-3616.33"/>
<polygon fill="#000000" stroke="#000000" points="290.647,-3619.52 298.851,-3612.82 288.256,-3612.95 290.647,-3619.52"/>
</g>
<!-- hubbard_term -->
<g id="proc~~siesta_forces~~CallsGraph_node78" class="node"><title>hubbard_term</title>
<polygon fill="#777777" stroke="#777777" points="368,-3573 288,-3573 288,-3549 368,-3549 368,-3573"/>
<text text-anchor="middle" x="328" y="-3558.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hubbard_term</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;hubbard_term -->
<g id="proc~~siesta_forces~~CallsGraph_edge139" class="edge"><title>proc~setup_hamiltonian&#45;&gt;hubbard_term</title>
<path fill="none" stroke="#000000" d="M184.462,-3652.99C201.177,-3635.3 234.724,-3602.15 269,-3582 271.999,-3580.24 275.171,-3578.58 278.423,-3577.04"/>
<polygon fill="#000000" stroke="#000000" points="279.96,-3580.19 287.726,-3572.98 277.161,-3573.77 279.96,-3580.19"/>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;val -->
<g id="proc~~siesta_forces~~CallsGraph_edge128" class="edge"><title>proc~setup_hamiltonian&#45;&gt;val</title>
<path fill="none" stroke="#000000" d="M182.75,-3677.04C198.183,-3696.01 231.242,-3732.14 269,-3746 318.234,-3764.07 343.995,-3776.02 387,-3746 425.049,-3719.44 389.924,-3680.54 423,-3648 433.35,-3637.82 447.899,-3631.61 461.396,-3627.83"/>
<polygon fill="#000000" stroke="#000000" points="462.538,-3631.16 471.426,-3625.39 460.882,-3624.35 462.538,-3631.16"/>
</g>
<!-- hold -->
<g id="proc~~siesta_forces~~CallsGraph_node105" class="node"><title>hold</title>
<polygon fill="#777777" stroke="#777777" points="355,-3531 301,-3531 301,-3507 355,-3507 355,-3531"/>
<text text-anchor="middle" x="328" y="-3516.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hold</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;hold -->
<g id="proc~~siesta_forces~~CallsGraph_edge137" class="edge"><title>proc~setup_hamiltonian&#45;&gt;hold</title>
<path fill="none" stroke="#000000" d="M179.666,-3652.84C192.788,-3628.11 225.839,-3571.66 269,-3540 275.618,-3535.15 283.472,-3531.32 291.228,-3528.33"/>
<polygon fill="#000000" stroke="#000000" points="292.591,-3531.56 300.901,-3524.99 290.306,-3524.95 292.591,-3531.56"/>
</g>
<!-- de_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_node107" class="node"><title>de_alloc</title>
<polygon fill="#777777" stroke="#777777" points="1060.5,-4544 1006.5,-4544 1006.5,-4520 1060.5,-4520 1060.5,-4544"/>
<text text-anchor="middle" x="1033.5" y="-4529.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">de_alloc</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;de_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge133" class="edge"><title>proc~setup_hamiltonian&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M222.78,-3674.66C226.509,-3676.67 229.985,-3679.09 233,-3682 270.315,-3718.02 227.05,-3762.5 269,-3793 311.42,-3823.84 338.548,-3813.07 387,-3793 407.905,-3784.34 404.766,-3770.4 423,-3757 484.035,-3712.15 529.446,-3739.25 574,-3678 629.961,-3601.07 537.294,-3528.35 610,-3467 642.608,-3439.48 670.373,-3443.52 706,-3467 948.723,-3626.95 884.777,-3788.32 964,-4068 1010.89,-4233.53 1027.04,-4441.88 1031.25,-4509.62"/>
<polygon fill="#000000" stroke="#000000" points="1027.78,-4510.16 1031.87,-4519.93 1034.76,-4509.74 1027.78,-4510.16"/>
</g>
<!-- dimag -->
<g id="proc~~siesta_forces~~CallsGraph_node109" class="node"><title>dimag</title>
<polygon fill="#777777" stroke="#777777" points="355,-3489 301,-3489 301,-3465 355,-3465 355,-3489"/>
<text text-anchor="middle" x="328" y="-3474.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dimag</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;dimag -->
<g id="proc~~siesta_forces~~CallsGraph_edge130" class="edge"><title>proc~setup_hamiltonian&#45;&gt;dimag</title>
<path fill="none" stroke="#000000" d="M177.266,-3652.56C187.175,-3621.86 216.86,-3541.86 269,-3498 275.409,-3492.61 283.315,-3488.55 291.205,-3485.52"/>
<polygon fill="#000000" stroke="#000000" points="292.367,-3488.82 300.719,-3482.3 290.125,-3482.19 292.367,-3488.82"/>
</g>
<!-- update_e0 -->
<g id="proc~~siesta_forces~~CallsGraph_node120" class="node"><title>update_e0</title>
<polygon fill="#777777" stroke="#777777" points="360,-3737 296,-3737 296,-3713 360,-3713 360,-3737"/>
<text text-anchor="middle" x="328" y="-3722.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_e0</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;update_e0 -->
<g id="proc~~siesta_forces~~CallsGraph_edge136" class="edge"><title>proc~setup_hamiltonian&#45;&gt;update_e0</title>
<path fill="none" stroke="#000000" d="M204.563,-3677.14C228.255,-3686.4 261.08,-3699.23 286.779,-3709.28"/>
<polygon fill="#000000" stroke="#000000" points="285.657,-3712.6 296.245,-3712.98 288.206,-3706.08 285.657,-3712.6"/>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;proc~die -->
<g id="proc~~siesta_forces~~CallsGraph_edge138" class="edge"><title>proc~setup_hamiltonian&#45;&gt;proc~die</title>
<path fill="none" stroke="#000000" d="M174.02,-3652.92C176.48,-3612.69 190.45,-3482.87 269,-3430 312.508,-3400.72 340.092,-3406.55 387,-3430 410.851,-3441.93 399.149,-3466.07 423,-3478 483.026,-3508.01 521.784,-3520.16 574,-3478 633.075,-3430.3 550.925,-3358.7 610,-3311 689.877,-3246.51 822.322,-3289.51 885.026,-3315.83"/>
<polygon fill="#000000" stroke="#000000" points="883.903,-3319.15 894.472,-3319.89 886.667,-3312.72 883.903,-3319.15"/>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;globalize_sum -->
<g id="proc~~siesta_forces~~CallsGraph_edge126" class="edge"><title>proc~setup_hamiltonian&#45;&gt;globalize_sum</title>
<path fill="none" stroke="#000000" d="M205.979,-3677.06C252.314,-3691.93 337.272,-3710.2 387,-3666 438.009,-3620.66 378.681,-3412.9 423,-3361 429.545,-3353.34 438.649,-3348.36 448.252,-3345.15"/>
<polygon fill="#000000" stroke="#000000" points="449.22,-3348.52 457.944,-3342.51 447.375,-3341.77 449.22,-3348.52"/>
</g>
<!-- dscf -->
<g id="proc~~siesta_forces~~CallsGraph_node136" class="node"><title>dscf</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-5208 471.5,-5208 471.5,-5184 525.5,-5184 525.5,-5208"/>
<text text-anchor="middle" x="498.5" y="-5193.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dscf</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;dscf -->
<g id="proc~~siesta_forces~~CallsGraph_edge135" class="edge"><title>proc~setup_hamiltonian&#45;&gt;dscf</title>
<path fill="none" stroke="#000000" d="M174.506,-3677.43C180.56,-3752.42 212.553,-4152.32 233,-4479 235.401,-4517.37 242.663,-5142 269,-5170 318.007,-5222.1 410.332,-5214.01 461.343,-5204.46"/>
<polygon fill="#000000" stroke="#000000" points="462.145,-5207.87 471.269,-5202.49 460.779,-5201.01 462.145,-5207.87"/>
</g>
<!-- proc~compute_dm&#45;&gt;proc~bye -->
<g id="proc~~siesta_forces~~CallsGraph_edge146" class="edge"><title>proc~compute_dm&#45;&gt;proc~bye</title>
<path fill="none" stroke="#000000" d="M329.742,-5389.95C334.895,-5306.03 365.791,-4800.07 387,-4388 389.25,-4344.29 395.791,-3635.28 423,-3601 432.143,-3589.48 447.083,-3583.97 461.194,-3581.44"/>
<polygon fill="#000000" stroke="#000000" points="461.788,-3584.89 471.227,-3580.08 460.847,-3577.96 461.788,-3584.89"/>
</g>
<!-- proc~compute_dm&#45;&gt;transiesta -->
<g id="proc~~siesta_forces~~CallsGraph_edge148" class="edge"><title>proc~compute_dm&#45;&gt;transiesta</title>
<path fill="none" stroke="#000000" d="M332.304,-5414.27C341.65,-5449.22 368.775,-5552.36 387,-5639 405.953,-5729.1 361.236,-5774.72 423,-5843 432.195,-5853.16 445.89,-5858.56 459.039,-5861.38"/>
<polygon fill="#000000" stroke="#000000" points="458.457,-5864.83 468.904,-5863.07 459.637,-5857.93 458.457,-5864.83"/>
</g>
<!-- proc~compute_dm&#45;&gt;timer -->
<g id="proc~~siesta_forces~~CallsGraph_edge152" class="edge"><title>proc~compute_dm&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M333.155,-5389.91C343.527,-5361.61 373.348,-5290.76 423,-5255 479.154,-5214.55 516.448,-5255.43 574,-5217 815.434,-5055.78 864.902,-4965.88 964,-4693 1005.8,-4577.9 1028.44,-3667.02 1032,-3512.3"/>
<polygon fill="#000000" stroke="#000000" points="1035.5,-3512.2 1032.23,-3502.13 1028.51,-3512.05 1035.5,-3512.2"/>
</g>
<!-- zminim -->
<g id="proc~~siesta_forces~~CallsGraph_node50" class="node"><title>zminim</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-5456 471.5,-5456 471.5,-5432 525.5,-5432 525.5,-5456"/>
<text text-anchor="middle" x="498.5" y="-5441.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">zminim</text>
</g>
<!-- proc~compute_dm&#45;&gt;zminim -->
<g id="proc~~siesta_forces~~CallsGraph_edge142" class="edge"><title>proc~compute_dm&#45;&gt;zminim</title>
<path fill="none" stroke="#000000" d="M365.562,-5411.11C394.01,-5418.2 433.273,-5427.99 461.561,-5435.04"/>
<polygon fill="#000000" stroke="#000000" points="460.896,-5438.48 471.446,-5437.51 462.59,-5431.69 460.896,-5438.48"/>
</g>
<!-- write_orb_indx -->
<g id="proc~~siesta_forces~~CallsGraph_node64" class="node"><title>write_orb_indx</title>
<polygon fill="#777777" stroke="#777777" points="539.5,-5414 457.5,-5414 457.5,-5390 539.5,-5390 539.5,-5414"/>
<text text-anchor="middle" x="498.5" y="-5399.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_orb_indx</text>
</g>
<!-- proc~compute_dm&#45;&gt;write_orb_indx -->
<g id="proc~~siesta_forces~~CallsGraph_edge155" class="edge"><title>proc~compute_dm&#45;&gt;write_orb_indx</title>
<path fill="none" stroke="#000000" d="M365.562,-5402C389.488,-5402 421.064,-5402 447.327,-5402"/>
<polygon fill="#000000" stroke="#000000" points="447.474,-5405.5 457.474,-5402 447.474,-5398.5 447.474,-5405.5"/>
</g>
<!-- eold -->
<g id="proc~~siesta_forces~~CallsGraph_node67" class="node"><title>eold</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-5372 471.5,-5372 471.5,-5348 525.5,-5348 525.5,-5372"/>
<text text-anchor="middle" x="498.5" y="-5357.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">eold</text>
</g>
<!-- proc~compute_dm&#45;&gt;eold -->
<g id="proc~~siesta_forces~~CallsGraph_edge144" class="edge"><title>proc~compute_dm&#45;&gt;eold</title>
<path fill="none" stroke="#000000" d="M365.562,-5392.89C394.01,-5385.8 433.273,-5376.01 461.561,-5368.96"/>
<polygon fill="#000000" stroke="#000000" points="462.59,-5372.31 471.446,-5366.49 460.896,-5365.52 462.59,-5372.31"/>
</g>
<!-- write_dmh_netcdf -->
<g id="proc~~siesta_forces~~CallsGraph_node75" class="node"><title>write_dmh_netcdf</title>
<polygon fill="#777777" stroke="#777777" points="547,-5330 450,-5330 450,-5306 547,-5306 547,-5330"/>
<text text-anchor="middle" x="498.5" y="-5315.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_dmh_netcdf</text>
</g>
<!-- proc~compute_dm&#45;&gt;write_dmh_netcdf -->
<g id="proc~~siesta_forces~~CallsGraph_edge151" class="edge"><title>proc~compute_dm&#45;&gt;write_dmh_netcdf</title>
<path fill="none" stroke="#000000" d="M343.746,-5389.94C361.547,-5375.92 392.857,-5352.92 423,-5339 428.393,-5336.51 434.144,-5334.25 439.97,-5332.22"/>
<polygon fill="#000000" stroke="#000000" points="441.371,-5335.45 449.794,-5329.02 439.202,-5328.79 441.371,-5335.45"/>
</g>
<!-- dminim -->
<g id="proc~~siesta_forces~~CallsGraph_node80" class="node"><title>dminim</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-5288 471.5,-5288 471.5,-5264 525.5,-5264 525.5,-5288"/>
<text text-anchor="middle" x="498.5" y="-5273.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dminim</text>
</g>
<!-- proc~compute_dm&#45;&gt;dminim -->
<g id="proc~~siesta_forces~~CallsGraph_edge158" class="edge"><title>proc~compute_dm&#45;&gt;dminim</title>
<path fill="none" stroke="#000000" d="M336.434,-5389.91C350.539,-5368.01 383.349,-5321.73 423,-5297 434.516,-5289.82 448.541,-5285.03 461.304,-5281.87"/>
<polygon fill="#000000" stroke="#000000" points="462.195,-5285.26 471.196,-5279.67 460.674,-5278.43 462.195,-5285.26"/>
</g>
<!-- ordern -->
<g id="proc~~siesta_forces~~CallsGraph_node85" class="node"><title>ordern</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-5792 471.5,-5792 471.5,-5768 525.5,-5768 525.5,-5792"/>
<text text-anchor="middle" x="498.5" y="-5777.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ordern</text>
</g>
<!-- proc~compute_dm&#45;&gt;ordern -->
<g id="proc~~siesta_forces~~CallsGraph_edge140" class="edge"><title>proc~compute_dm&#45;&gt;ordern</title>
<path fill="none" stroke="#000000" d="M331.998,-5414.05C347.342,-5475.62 416.612,-5752.5 423,-5759 433.058,-5769.23 447.688,-5774.58 461.325,-5777.34"/>
<polygon fill="#000000" stroke="#000000" points="461.036,-5780.84 471.467,-5778.99 462.156,-5773.93 461.036,-5780.84"/>
</g>
<!-- diagon -->
<g id="proc~~siesta_forces~~CallsGraph_node89" class="node"><title>diagon</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-5750 471.5,-5750 471.5,-5726 525.5,-5726 525.5,-5750"/>
<text text-anchor="middle" x="498.5" y="-5735.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">diagon</text>
</g>
<!-- proc~compute_dm&#45;&gt;diagon -->
<g id="proc~~siesta_forces~~CallsGraph_edge141" class="edge"><title>proc~compute_dm&#45;&gt;diagon</title>
<path fill="none" stroke="#000000" d="M331.883,-5414.11C345.093,-5469.22 400.179,-5694.52 423,-5717 433.147,-5726.99 447.662,-5732.31 461.188,-5735.11"/>
<polygon fill="#000000" stroke="#000000" points="460.809,-5738.6 471.25,-5736.8 461.967,-5731.69 460.809,-5738.6"/>
</g>
<!-- proc~compute_dm&#45;&gt;val -->
<g id="proc~~siesta_forces~~CallsGraph_edge145" class="edge"><title>proc~compute_dm&#45;&gt;val</title>
<path fill="none" stroke="#000000" d="M329.69,-5389.95C334.496,-5306.01 363.468,-4799.94 387,-4388 395.01,-4247.78 384.101,-3891.96 423,-3757 435.612,-3713.24 464.358,-3668.03 482.228,-3642.62"/>
<polygon fill="#000000" stroke="#000000" points="485.288,-3644.35 488.269,-3634.19 479.598,-3640.28 485.288,-3644.35"/>
</g>
<!-- dold -->
<g id="proc~~siesta_forces~~CallsGraph_node97" class="node"><title>dold</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-5708 471.5,-5708 471.5,-5684 525.5,-5684 525.5,-5708"/>
<text text-anchor="middle" x="498.5" y="-5693.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dold</text>
</g>
<!-- proc~compute_dm&#45;&gt;dold -->
<g id="proc~~siesta_forces~~CallsGraph_edge153" class="edge"><title>proc~compute_dm&#45;&gt;dold</title>
<path fill="none" stroke="#000000" d="M329.389,-5414.17C331.425,-5456.75 344.111,-5600.47 423,-5675 433.353,-5684.78 447.903,-5690.06 461.4,-5692.89"/>
<polygon fill="#000000" stroke="#000000" points="460.981,-5696.37 471.429,-5694.61 462.165,-5689.47 460.981,-5696.37"/>
</g>
<!-- pexsi_solver -->
<g id="proc~~siesta_forces~~CallsGraph_node102" class="node"><title>pexsi_solver</title>
<polygon fill="#777777" stroke="#777777" points="534.5,-5666 462.5,-5666 462.5,-5642 534.5,-5642 534.5,-5666"/>
<text text-anchor="middle" x="498.5" y="-5651.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pexsi_solver</text>
</g>
<!-- proc~compute_dm&#45;&gt;pexsi_solver -->
<g id="proc~~siesta_forces~~CallsGraph_edge143" class="edge"><title>proc~compute_dm&#45;&gt;pexsi_solver</title>
<path fill="none" stroke="#000000" d="M330.246,-5414.16C334.83,-5452.43 354.249,-5571.53 423,-5633 431.283,-5640.41 441.988,-5645.22 452.686,-5648.34"/>
<polygon fill="#000000" stroke="#000000" points="451.89,-5651.75 462.439,-5650.76 453.575,-5644.96 451.89,-5651.75"/>
</g>
<!-- proc~compute_dm&#45;&gt;escf -->
<g id="proc~~siesta_forces~~CallsGraph_edge147" class="edge"><title>proc~compute_dm&#45;&gt;escf</title>
<path fill="none" stroke="#000000" d="M329.752,-5389.95C334.977,-5306.04 366.268,-4800.09 387,-4388 396.265,-4203.84 373.135,-3736.53 423,-3559 435.314,-3515.16 464.158,-3469.97 482.127,-3444.59"/>
<polygon fill="#000000" stroke="#000000" points="485.189,-3446.33 488.204,-3436.17 479.513,-3442.23 485.189,-3446.33"/>
</g>
<!-- chess_wrapper -->
<g id="proc~~siesta_forces~~CallsGraph_node115" class="node"><title>chess_wrapper</title>
<polygon fill="#777777" stroke="#777777" points="541,-5624 456,-5624 456,-5600 541,-5600 541,-5624"/>
<text text-anchor="middle" x="498.5" y="-5609.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">chess_wrapper</text>
</g>
<!-- proc~compute_dm&#45;&gt;chess_wrapper -->
<g id="proc~~siesta_forces~~CallsGraph_edge149" class="edge"><title>proc~compute_dm&#45;&gt;chess_wrapper</title>
<path fill="none" stroke="#000000" d="M331.485,-5414.31C338.936,-5447.99 364.309,-5542.36 423,-5591 429.693,-5596.55 437.761,-5600.63 446.08,-5603.64"/>
<polygon fill="#000000" stroke="#000000" points="445.307,-5607.06 455.896,-5606.7 447.39,-5600.38 445.307,-5607.06"/>
</g>
<!-- proc~compute_dm&#45;&gt;normalize_dm -->
<g id="proc~~siesta_forces~~CallsGraph_edge157" class="edge"><title>proc~compute_dm&#45;&gt;normalize_dm</title>
<path fill="none" stroke="#000000" d="M329.783,-5389.95C335.22,-5306.05 367.683,-4800.16 387,-4388 389.564,-4333.3 389.155,-3446.05 423,-3403 429.354,-3394.92 438.563,-3389.79 448.354,-3386.58"/>
<polygon fill="#000000" stroke="#000000" points="449.481,-3389.9 458.254,-3383.96 447.691,-3383.13 449.481,-3389.9"/>
</g>
<!-- compute_ebs_shift -->
<g id="proc~~siesta_forces~~CallsGraph_node129" class="node"><title>compute_ebs_shift</title>
<polygon fill="#777777" stroke="#777777" points="550,-5582 447,-5582 447,-5558 550,-5558 550,-5582"/>
<text text-anchor="middle" x="498.5" y="-5567.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_ebs_shift</text>
</g>
<!-- proc~compute_dm&#45;&gt;compute_ebs_shift -->
<g id="proc~~siesta_forces~~CallsGraph_edge159" class="edge"><title>proc~compute_dm&#45;&gt;compute_ebs_shift</title>
<path fill="none" stroke="#000000" d="M333.381,-5414.42C344.04,-5442.79 374.101,-5512.72 423,-5549 427.384,-5552.25 432.253,-5555 437.343,-5557.33"/>
<polygon fill="#000000" stroke="#000000" points="436.1,-5560.6 446.684,-5561.07 438.701,-5554.1 436.1,-5560.6"/>
</g>
<!-- mpi_bcast -->
<g id="proc~~siesta_forces~~CallsGraph_node132" class="node"><title>mpi_bcast</title>
<polygon fill="#777777" stroke="#777777" points="529,-5540 468,-5540 468,-5516 529,-5516 529,-5540"/>
<text text-anchor="middle" x="498.5" y="-5525.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_bcast</text>
</g>
<!-- proc~compute_dm&#45;&gt;mpi_bcast -->
<g id="proc~~siesta_forces~~CallsGraph_edge150" class="edge"><title>proc~compute_dm&#45;&gt;mpi_bcast</title>
<path fill="none" stroke="#000000" d="M336.434,-5414.09C350.539,-5435.99 383.349,-5482.27 423,-5507 433.6,-5513.61 446.327,-5518.19 458.237,-5521.34"/>
<polygon fill="#000000" stroke="#000000" points="457.446,-5524.75 467.985,-5523.67 459.07,-5517.94 457.446,-5524.75"/>
</g>
<!-- proc~compute_dm&#45;&gt;dscf -->
<g id="proc~~siesta_forces~~CallsGraph_edge156" class="edge"><title>proc~compute_dm&#45;&gt;dscf</title>
<path fill="none" stroke="#000000" d="M331.944,-5389.99C340.403,-5357.95 367.783,-5269.72 423,-5222 433.82,-5212.65 448.204,-5206.6 461.446,-5202.72"/>
<polygon fill="#000000" stroke="#000000" points="462.481,-5206.06 471.271,-5200.15 460.711,-5199.29 462.481,-5206.06"/>
</g>
<!-- write_hs_formatted -->
<g id="proc~~siesta_forces~~CallsGraph_node138" class="node"><title>write_hs_formatted</title>
<polygon fill="#777777" stroke="#777777" points="550.5,-5498 446.5,-5498 446.5,-5474 550.5,-5474 550.5,-5498"/>
<text text-anchor="middle" x="498.5" y="-5483.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_hs_formatted</text>
</g>
<!-- proc~compute_dm&#45;&gt;write_hs_formatted -->
<g id="proc~~siesta_forces~~CallsGraph_edge154" class="edge"><title>proc~compute_dm&#45;&gt;write_hs_formatted</title>
<path fill="none" stroke="#000000" d="M343.746,-5414.06C361.547,-5428.08 392.857,-5451.08 423,-5465 427.419,-5467.04 432.078,-5468.92 436.822,-5470.65"/>
<polygon fill="#000000" stroke="#000000" points="436.034,-5474.08 446.628,-5473.99 438.289,-5467.46 436.034,-5474.08"/>
</g>
<!-- proc~compute_energies&#45;&gt;fdf_get -->
<g id="proc~~siesta_forces~~CallsGraph_edge162" class="edge"><title>proc~compute_energies&#45;&gt;fdf_get</title>
<path fill="none" stroke="#000000" d="M378.644,-6013.98C405.146,-6008.64 437.178,-6002.17 461.307,-5997.3"/>
<polygon fill="#000000" stroke="#000000" points="462.015,-6000.73 471.126,-5995.32 460.631,-5993.87 462.015,-6000.73"/>
</g>
<!-- proc~compute_energies&#45;&gt;update_freee -->
<g id="proc~~siesta_forces~~CallsGraph_edge160" class="edge"><title>proc~compute_energies&#45;&gt;update_freee</title>
<path fill="none" stroke="#000000" d="M337.055,-6011.75C348.793,-5993.63 370.945,-5958.46 387,-5927 405.464,-5890.82 392.472,-5869.79 423,-5843 430.726,-5836.22 440.488,-5831.62 450.378,-5828.49"/>
<polygon fill="#000000" stroke="#000000" points="451.494,-5831.82 460.241,-5825.84 449.675,-5825.06 451.494,-5831.82"/>
</g>
<!-- update_dena -->
<g id="proc~~siesta_forces~~CallsGraph_node116" class="node"><title>update_dena</title>
<polygon fill="#777777" stroke="#777777" points="536.5,-6044 460.5,-6044 460.5,-6020 536.5,-6020 536.5,-6044"/>
<text text-anchor="middle" x="498.5" y="-6029.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_dena</text>
</g>
<!-- proc~compute_energies&#45;&gt;update_dena -->
<g id="proc~~siesta_forces~~CallsGraph_edge161" class="edge"><title>proc~compute_energies&#45;&gt;update_dena</title>
<path fill="none" stroke="#000000" d="M378.644,-6026.36C401.188,-6027.43 427.732,-6028.69 450.011,-6029.75"/>
<polygon fill="#000000" stroke="#000000" points="450.087,-6033.25 460.242,-6030.23 450.419,-6026.26 450.087,-6033.25"/>
</g>
<!-- update_etot -->
<g id="proc~~siesta_forces~~CallsGraph_node130" class="node"><title>update_etot</title>
<polygon fill="#777777" stroke="#777777" points="533.5,-6086 463.5,-6086 463.5,-6062 533.5,-6062 533.5,-6086"/>
<text text-anchor="middle" x="498.5" y="-6071.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_etot</text>
</g>
<!-- proc~compute_energies&#45;&gt;update_etot -->
<g id="proc~~siesta_forces~~CallsGraph_edge163" class="edge"><title>proc~compute_energies&#45;&gt;update_etot</title>
<path fill="none" stroke="#000000" d="M367.353,-6036.06C384.369,-6041.36 404.655,-6047.59 423,-6053 432.86,-6055.91 443.479,-6058.96 453.524,-6061.8"/>
<polygon fill="#000000" stroke="#000000" points="452.754,-6065.22 463.328,-6064.56 454.651,-6058.48 452.754,-6065.22"/>
</g>
<!-- proc~mix_rhog&#45;&gt;fdf_get -->
<g id="proc~~siesta_forces~~CallsGraph_edge166" class="edge"><title>proc~mix_rhog&#45;&gt;fdf_get</title>
<path fill="none" stroke="#000000" d="M356.701,-5915.9C366.695,-5920.11 377.776,-5925.55 387,-5932 405.802,-5945.15 403.285,-5957.26 423,-5969 434.663,-5975.94 448.719,-5980.68 461.465,-5983.86"/>
<polygon fill="#000000" stroke="#000000" points="460.809,-5987.3 471.335,-5986.1 462.356,-5980.48 460.809,-5987.3"/>
</g>
<!-- n_items -->
<g id="proc~~siesta_forces~~CallsGraph_node66" class="node"><title>n_items</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-5960 471.5,-5960 471.5,-5936 525.5,-5936 525.5,-5960"/>
<text text-anchor="middle" x="498.5" y="-5945.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">n_items</text>
</g>
<!-- proc~mix_rhog&#45;&gt;n_items -->
<g id="proc~~siesta_forces~~CallsGraph_edge164" class="edge"><title>proc~mix_rhog&#45;&gt;n_items</title>
<path fill="none" stroke="#000000" d="M356.824,-5912.94C385.378,-5920.05 429.934,-5931.16 461.235,-5938.96"/>
<polygon fill="#000000" stroke="#000000" points="460.749,-5942.45 471.299,-5941.47 462.442,-5935.65 460.749,-5942.45"/>
</g>
<!-- diis -->
<g id="proc~~siesta_forces~~CallsGraph_node74" class="node"><title>diis</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-5918 471.5,-5918 471.5,-5894 525.5,-5894 525.5,-5918"/>
<text text-anchor="middle" x="498.5" y="-5903.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">diis</text>
</g>
<!-- proc~mix_rhog&#45;&gt;diis -->
<g id="proc~~siesta_forces~~CallsGraph_edge165" class="edge"><title>proc~mix_rhog&#45;&gt;diis</title>
<path fill="none" stroke="#000000" d="M356.824,-5906C385.378,-5906 429.934,-5906 461.235,-5906"/>
<polygon fill="#000000" stroke="#000000" points="461.299,-5909.5 471.299,-5906 461.299,-5902.5 461.299,-5909.5"/>
</g>
<!-- proc~compute_max_diff_2d&#45;&gt;die -->
<g id="proc~~siesta_forces~~CallsGraph_edge167" class="edge"><title>proc~compute_max_diff_2d&#45;&gt;die</title>
<path fill="none" stroke="#000000" d="M377.578,-1405.98C381.198,-1403.52 384.431,-1400.56 387,-1397 475.693,-1274.04 329.901,-152.656 423,-33 432.031,-21.3931 446.955,-15.8722 461.084,-13.355"/>
<polygon fill="#000000" stroke="#000000" points="461.689,-16.8053 471.135,-12.0089 460.759,-9.86729 461.689,-16.8053"/>
</g>
<!-- proc~dhscf&#45;&gt;proc~bye -->
<g id="proc~~siesta_forces~~CallsGraph_edge180" class="edge"><title>proc~dhscf&#45;&gt;proc~bye</title>
<path fill="none" stroke="#000000" d="M330.104,-4354.87C338.846,-4259.33 397.209,-3631.06 423,-3601 432.505,-3589.92 447.359,-3584.46 461.31,-3581.85"/>
<polygon fill="#000000" stroke="#000000" points="461.826,-3585.31 471.219,-3580.41 460.82,-3578.38 461.826,-3585.31"/>
</g>
<!-- proc~dhscf&#45;&gt;timer -->
<g id="proc~~siesta_forces~~CallsGraph_edge196" class="edge"><title>proc~dhscf&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M328.497,-4354.97C327.333,-4309.51 330.026,-4147.38 423,-4080 477.34,-4040.62 522.888,-4036.51 574,-4080 650.126,-4144.78 548.222,-4223.42 610,-4302 629.973,-4327.41 846.325,-4408.6 878,-4415 915.464,-4422.58 935.993,-4441.01 964,-4415 1032.22,-4351.65 1033.09,-3647.9 1032.62,-3512.47"/>
<polygon fill="#000000" stroke="#000000" points="1036.11,-3512.09 1032.57,-3502.11 1029.11,-3512.12 1036.11,-3512.09"/>
</g>
<!-- proc~dhscf&#45;&gt;volcel -->
<g id="proc~~siesta_forces~~CallsGraph_edge168" class="edge"><title>proc~dhscf&#45;&gt;volcel</title>
<path fill="none" stroke="#000000" d="M330.353,-4354.76C337.345,-4291.14 369.706,-3991.73 387,-3746 392.927,-3661.78 370.458,-3053.09 423,-2987 432.152,-2975.49 447.094,-2969.98 461.203,-2967.45"/>
<polygon fill="#000000" stroke="#000000" points="461.797,-2970.9 471.235,-2966.09 460.855,-2963.96 461.797,-2970.9"/>
</g>
<!-- proc~dhscf&#45;&gt;re_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge170" class="edge"><title>proc~dhscf&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M329.673,-4379.24C334.74,-4469.19 368.218,-5026.02 423,-5074 517.751,-5156.99 588.75,-5105.01 706,-5059 838.564,-5006.98 863.04,-4969.43 964,-4869 986.181,-4846.93 1006.94,-4817.3 1019.66,-4797.7"/>
<polygon fill="#000000" stroke="#000000" points="1022.65,-4799.52 1025.08,-4789.21 1016.75,-4795.76 1022.65,-4799.52"/>
</g>
<!-- proc~dhscf&#45;&gt;write_debug -->
<g id="proc~~siesta_forces~~CallsGraph_edge201" class="edge"><title>proc~dhscf&#45;&gt;write_debug</title>
<path fill="none" stroke="#000000" d="M329.344,-4354.88C331.583,-4285.74 346.492,-3942.18 423,-3879 474.748,-3836.27 523.986,-3834.25 574,-3879 681.646,-3975.31 502.354,-4105.69 610,-4202 648.406,-4236.36 799.448,-4193.69 875.6,-4169.1"/>
<polygon fill="#000000" stroke="#000000" points="876.967,-4172.33 885.387,-4165.9 874.795,-4165.68 876.967,-4172.33"/>
</g>
<!-- proc~dhscf&#45;&gt;de_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge199" class="edge"><title>proc~dhscf&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M329.76,-4379.15C335.322,-4466.1 370.981,-4991.77 423,-5037 518.001,-5119.6 592.098,-5078.62 706,-5025 853.29,-4955.67 881.179,-4905.15 964,-4765 1005.54,-4694.71 1023.43,-4597.44 1029.68,-4554.23"/>
<polygon fill="#000000" stroke="#000000" points="1033.16,-4554.61 1031.06,-4544.22 1026.23,-4553.65 1033.16,-4554.61"/>
</g>
<!-- proc~dhscf&#45;&gt;proc~die -->
<g id="proc~~siesta_forces~~CallsGraph_edge183" class="edge"><title>proc~dhscf&#45;&gt;proc~die</title>
<path fill="none" stroke="#000000" d="M330.214,-4354.88C338.448,-4273.46 386.877,-3808.07 423,-3757 466.981,-3694.83 529.471,-3737.78 574,-3676 629.112,-3599.53 551.814,-3541.15 610,-3467 679.31,-3378.67 818.099,-3346.97 883.856,-3336.59"/>
<polygon fill="#000000" stroke="#000000" points="884.392,-3340.05 893.76,-3335.1 883.351,-3333.12 884.392,-3340.05"/>
</g>
<!-- elecs -->
<g id="proc~~siesta_forces~~CallsGraph_node142" class="node"><title>elecs</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-4820 471.5,-4820 471.5,-4796 525.5,-4796 525.5,-4820"/>
<text text-anchor="middle" x="498.5" y="-4805.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elecs</text>
</g>
<!-- proc~dhscf&#45;&gt;elecs -->
<g id="proc~~siesta_forces~~CallsGraph_edge174" class="edge"><title>proc~dhscf&#45;&gt;elecs</title>
<path fill="none" stroke="#000000" d="M330.063,-4379.16C335.753,-4441.57 364.562,-4725.28 423,-4787 432.866,-4797.42 447.463,-4802.8 461.128,-4805.53"/>
<polygon fill="#000000" stroke="#000000" points="460.878,-4809.04 471.303,-4807.15 461.974,-4802.12 460.878,-4809.04"/>
</g>
<!-- proc~forhar -->
<g id="proc~~siesta_forces~~CallsGraph_node144" class="node"><title>proc~forhar</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node144"><a xlink:href=".././proc/forhar.html" xlink:title="forhar">
<polygon fill="#d9534f" stroke="#d9534f" points="525.5,-4976 471.5,-4976 471.5,-4952 525.5,-4952 525.5,-4976"/>
<text text-anchor="middle" x="498.5" y="-4961.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">forhar</text>
</a>
</g>
</g>
<!-- proc~dhscf&#45;&gt;proc~forhar -->
<g id="proc~~siesta_forces~~CallsGraph_edge169" class="edge"><title>proc~dhscf&#45;&gt;proc~forhar</title>
<path fill="none" stroke="#000000" d="M329.362,-4379.24C331.807,-4454.03 348.165,-4848.99 423,-4938 432.577,-4949.39 447.441,-4955.8 461.381,-4959.4"/>
<polygon fill="#000000" stroke="#000000" points="460.763,-4962.84 471.279,-4961.55 462.253,-4956 460.763,-4962.84"/>
</g>
<!-- ts_voltage -->
<g id="proc~~siesta_forces~~CallsGraph_node145" class="node"><title>ts_voltage</title>
<polygon fill="#777777" stroke="#777777" points="529,-4778 468,-4778 468,-4754 529,-4754 529,-4778"/>
<text text-anchor="middle" x="498.5" y="-4763.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ts_voltage</text>
</g>
<!-- proc~dhscf&#45;&gt;ts_voltage -->
<g id="proc~~siesta_forces~~CallsGraph_edge171" class="edge"><title>proc~dhscf&#45;&gt;ts_voltage</title>
<path fill="none" stroke="#000000" d="M330.379,-4379.1C337.274,-4437.54 369.811,-4690.14 423,-4745 432.152,-4754.44 445.191,-4759.73 457.809,-4762.67"/>
<polygon fill="#000000" stroke="#000000" points="457.279,-4766.13 467.756,-4764.55 458.581,-4759.25 457.279,-4766.13"/>
</g>
<!-- dfscf -->
<g id="proc~~siesta_forces~~CallsGraph_node146" class="node"><title>dfscf</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-4736 471.5,-4736 471.5,-4712 525.5,-4712 525.5,-4736"/>
<text text-anchor="middle" x="498.5" y="-4721.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dfscf</text>
</g>
<!-- proc~dhscf&#45;&gt;dfscf -->
<g id="proc~~siesta_forces~~CallsGraph_edge191" class="edge"><title>proc~dhscf&#45;&gt;dfscf</title>
<path fill="none" stroke="#000000" d="M328.478,-4379.14C327.095,-4427.51 328.649,-4608.46 423,-4703 433.061,-4713.08 447.56,-4718.41 461.099,-4721.2"/>
<polygon fill="#000000" stroke="#000000" points="460.737,-4724.69 471.175,-4722.88 461.884,-4717.78 460.737,-4724.69"/>
</g>
<!-- ts_hartree_fix -->
<g id="proc~~siesta_forces~~CallsGraph_node147" class="node"><title>ts_hartree_fix</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-4694 459.5,-4694 459.5,-4670 537.5,-4670 537.5,-4694"/>
<text text-anchor="middle" x="498.5" y="-4679.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ts_hartree_fix</text>
</g>
<!-- proc~dhscf&#45;&gt;ts_hartree_fix -->
<g id="proc~~siesta_forces~~CallsGraph_edge173" class="edge"><title>proc~dhscf&#45;&gt;ts_hartree_fix</title>
<path fill="none" stroke="#000000" d="M329.044,-4379.15C329.89,-4423.71 338.975,-4579.84 423,-4661 430.322,-4668.07 439.833,-4672.8 449.598,-4675.95"/>
<polygon fill="#000000" stroke="#000000" points="448.807,-4679.36 459.375,-4678.6 450.64,-4672.6 448.807,-4679.36"/>
</g>
<!-- ddot -->
<g id="proc~~siesta_forces~~CallsGraph_node148" class="node"><title>ddot</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-4652 471.5,-4652 471.5,-4628 525.5,-4628 525.5,-4652"/>
<text text-anchor="middle" x="498.5" y="-4637.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ddot</text>
</g>
<!-- proc~dhscf&#45;&gt;ddot -->
<g id="proc~~siesta_forces~~CallsGraph_edge175" class="edge"><title>proc~dhscf&#45;&gt;ddot</title>
<path fill="none" stroke="#000000" d="M329.778,-4379.09C333.044,-4419.47 349.152,-4550.99 423,-4619 433.398,-4628.58 447.829,-4633.83 461.223,-4636.69"/>
<polygon fill="#000000" stroke="#000000" points="460.723,-4640.16 471.18,-4638.45 461.94,-4633.26 460.723,-4640.16"/>
</g>
<!-- jms_setmeshdistr -->
<g id="proc~~siesta_forces~~CallsGraph_node149" class="node"><title>jms_setmeshdistr</title>
<polygon fill="#777777" stroke="#777777" points="706,-5016 610,-5016 610,-4992 706,-4992 706,-5016"/>
<text text-anchor="middle" x="658" y="-5001.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jms_setmeshdistr</text>
</g>
<!-- proc~dhscf&#45;&gt;jms_setmeshdistr -->
<g id="proc~~siesta_forces~~CallsGraph_edge176" class="edge"><title>proc~dhscf&#45;&gt;jms_setmeshdistr</title>
<path fill="none" stroke="#000000" d="M328.745,-4379.01C327.306,-4459.78 323.496,-4923 423,-5009 476.609,-5055.33 565.755,-5036.23 617.153,-5019.33"/>
<polygon fill="#000000" stroke="#000000" points="618.574,-5022.54 626.907,-5016 616.313,-5015.92 618.574,-5022.54"/>
</g>
<!-- mpitrace_restart -->
<g id="proc~~siesta_forces~~CallsGraph_node150" class="node"><title>mpitrace_restart</title>
<polygon fill="#777777" stroke="#777777" points="544,-4610 453,-4610 453,-4586 544,-4586 544,-4610"/>
<text text-anchor="middle" x="498.5" y="-4595.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpitrace_restart</text>
</g>
<!-- proc~dhscf&#45;&gt;mpitrace_restart -->
<g id="proc~~siesta_forces~~CallsGraph_edge177" class="edge"><title>proc~dhscf&#45;&gt;mpitrace_restart</title>
<path fill="none" stroke="#000000" d="M330.779,-4379.08C336.717,-4414.97 359.212,-4521.91 423,-4577 428.935,-4582.13 436.036,-4586.01 443.463,-4588.94"/>
<polygon fill="#000000" stroke="#000000" points="442.386,-4592.27 452.981,-4592.18 444.64,-4585.65 442.386,-4592.27"/>
</g>
<!-- bsc_cellxc -->
<g id="proc~~siesta_forces~~CallsGraph_node151" class="node"><title>bsc_cellxc</title>
<polygon fill="#777777" stroke="#777777" points="688.5,-4974 627.5,-4974 627.5,-4950 688.5,-4950 688.5,-4974"/>
<text text-anchor="middle" x="658" y="-4959.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bsc_cellxc</text>
</g>
<!-- proc~dhscf&#45;&gt;bsc_cellxc -->
<g id="proc~~siesta_forces~~CallsGraph_edge178" class="edge"><title>proc~dhscf&#45;&gt;bsc_cellxc</title>
<path fill="none" stroke="#000000" d="M328.818,-4379.07C327.902,-4458.25 327.112,-4902.59 423,-4985 473.898,-5028.74 507.501,-4994.04 574,-4985 588.546,-4983.02 604.141,-4979.18 617.842,-4975.19"/>
<polygon fill="#000000" stroke="#000000" points="618.884,-4978.53 627.442,-4972.29 616.857,-4971.83 618.884,-4978.53"/>
</g>
<!-- write_grid_netcdf -->
<g id="proc~~siesta_forces~~CallsGraph_node152" class="node"><title>write_grid_netcdf</title>
<polygon fill="#777777" stroke="#777777" points="545.5,-4568 451.5,-4568 451.5,-4544 545.5,-4544 545.5,-4568"/>
<text text-anchor="middle" x="498.5" y="-4553.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_grid_netcdf</text>
</g>
<!-- proc~dhscf&#45;&gt;write_grid_netcdf -->
<g id="proc~~siesta_forces~~CallsGraph_edge179" class="edge"><title>proc~dhscf&#45;&gt;write_grid_netcdf</title>
<path fill="none" stroke="#000000" d="M332.3,-4379.3C341.286,-4410.37 369.199,-4492.58 423,-4535 428.53,-4539.36 434.918,-4542.82 441.581,-4545.55"/>
<polygon fill="#000000" stroke="#000000" points="440.877,-4549.02 451.472,-4549.07 443.224,-4542.42 440.877,-4549.02"/>
</g>
<!-- proc~setmeshdistr -->
<g id="proc~~siesta_forces~~CallsGraph_node154" class="node"><title>proc~setmeshdistr</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node154"><a xlink:href=".././proc/setmeshdistr.html" xlink:title="setMeshDistr">
<polygon fill="#d9534f" stroke="#d9534f" points="695.5,-4856 620.5,-4856 620.5,-4832 695.5,-4832 695.5,-4856"/>
<text text-anchor="middle" x="658" y="-4841.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setMeshDistr</text>
</a>
</g>
</g>
<!-- proc~dhscf&#45;&gt;proc~setmeshdistr -->
<g id="proc~~siesta_forces~~CallsGraph_edge181" class="edge"><title>proc~dhscf&#45;&gt;proc~setmeshdistr</title>
<path fill="none" stroke="#000000" d="M329.218,-4379.31C330.768,-4451.12 342.557,-4814.91 423,-4882 474.539,-4924.98 508.429,-4896.3 574,-4882 592.85,-4877.89 612.541,-4869.1 628.011,-4861"/>
<polygon fill="#000000" stroke="#000000" points="629.928,-4863.94 637.052,-4856.1 626.592,-4857.79 629.928,-4863.94"/>
</g>
<!-- rhoofdsp -->
<g id="proc~~siesta_forces~~CallsGraph_node158" class="node"><title>rhoofdsp</title>
<polygon fill="#777777" stroke="#777777" points="526,-4526 471,-4526 471,-4502 526,-4502 526,-4526"/>
<text text-anchor="middle" x="498.5" y="-4511.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rhoofdsp</text>
</g>
<!-- proc~dhscf&#45;&gt;rhoofdsp -->
<g id="proc~~siesta_forces~~CallsGraph_edge182" class="edge"><title>proc~dhscf&#45;&gt;rhoofdsp</title>
<path fill="none" stroke="#000000" d="M334.617,-4379.14C346.914,-4404.35 378.696,-4462.54 423,-4493 434.184,-4500.69 448.14,-4505.58 460.939,-4508.68"/>
<polygon fill="#000000" stroke="#000000" points="460.37,-4512.14 470.881,-4510.81 461.833,-4505.3 460.37,-4512.14"/>
</g>
<!-- get_field_from_dipole -->
<g id="proc~~siesta_forces~~CallsGraph_node159" class="node"><title>get_field_from_dipole</title>
<polygon fill="#777777" stroke="#777777" points="556,-4484 441,-4484 441,-4460 556,-4460 556,-4484"/>
<text text-anchor="middle" x="498.5" y="-4469.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_field_from_dipole</text>
</g>
<!-- proc~dhscf&#45;&gt;get_field_from_dipole -->
<g id="proc~~siesta_forces~~CallsGraph_edge184" class="edge"><title>proc~dhscf&#45;&gt;get_field_from_dipole</title>
<path fill="none" stroke="#000000" d="M339.269,-4379.19C355.303,-4397.46 388.082,-4431.83 423,-4451 426.479,-4452.91 430.146,-4454.66 433.913,-4456.26"/>
<polygon fill="#000000" stroke="#000000" points="432.838,-4459.59 443.428,-4459.93 435.36,-4453.06 432.838,-4459.59"/>
</g>
<!-- vmatsp -->
<g id="proc~~siesta_forces~~CallsGraph_node160" class="node"><title>vmatsp</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-4442 471.5,-4442 471.5,-4418 525.5,-4418 525.5,-4442"/>
<text text-anchor="middle" x="498.5" y="-4427.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">vmatsp</text>
</g>
<!-- proc~dhscf&#45;&gt;vmatsp -->
<g id="proc~~siesta_forces~~CallsGraph_edge185" class="edge"><title>proc~dhscf&#45;&gt;vmatsp</title>
<path fill="none" stroke="#000000" d="M353.337,-4379.05C372.082,-4388.04 398.799,-4400.24 423,-4409 435.339,-4413.47 449.105,-4417.58 461.414,-4420.97"/>
<polygon fill="#000000" stroke="#000000" points="460.783,-4424.42 471.348,-4423.62 462.593,-4417.66 460.783,-4424.42"/>
</g>
<!-- add_potential_from_field -->
<g id="proc~~siesta_forces~~CallsGraph_node161" class="node"><title>add_potential_from_field</title>
<polygon fill="#777777" stroke="#777777" points="563.5,-4400 433.5,-4400 433.5,-4376 563.5,-4376 563.5,-4400"/>
<text text-anchor="middle" x="498.5" y="-4385.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">add_potential_from_field</text>
</g>
<!-- proc~dhscf&#45;&gt;add_potential_from_field -->
<g id="proc~~siesta_forces~~CallsGraph_edge186" class="edge"><title>proc~dhscf&#45;&gt;add_potential_from_field</title>
<path fill="none" stroke="#000000" d="M355.328,-4370.28C373.632,-4372.56 399.006,-4375.72 423.258,-4378.75"/>
<polygon fill="#000000" stroke="#000000" points="422.84,-4382.22 433.196,-4379.99 423.706,-4375.28 422.84,-4382.22"/>
</g>
<!-- hartree_add -->
<g id="proc~~siesta_forces~~CallsGraph_node162" class="node"><title>hartree_add</title>
<polygon fill="#777777" stroke="#777777" points="534,-4358 463,-4358 463,-4334 534,-4334 534,-4358"/>
<text text-anchor="middle" x="498.5" y="-4343.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hartree_add</text>
</g>
<!-- proc~dhscf&#45;&gt;hartree_add -->
<g id="proc~~siesta_forces~~CallsGraph_edge187" class="edge"><title>proc~dhscf&#45;&gt;hartree_add</title>
<path fill="none" stroke="#000000" d="M355.328,-4363.72C381.357,-4360.47 421.682,-4355.45 452.747,-4351.58"/>
<polygon fill="#000000" stroke="#000000" points="453.403,-4355.02 462.893,-4350.31 452.537,-4348.08 453.403,-4355.02"/>
</g>
<!-- proc~reord -->
<g id="proc~~siesta_forces~~CallsGraph_node163" class="node"><title>proc~reord</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node163"><a xlink:href=".././proc/reord.html" xlink:title="reord">
<polygon fill="#d9534f" stroke="#d9534f" points="948,-4524 894,-4524 894,-4500 948,-4500 948,-4524"/>
<text text-anchor="middle" x="921" y="-4509.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reord</text>
</a>
</g>
</g>
<!-- proc~dhscf&#45;&gt;proc~reord -->
<g id="proc~~siesta_forces~~CallsGraph_edge188" class="edge"><title>proc~dhscf&#45;&gt;proc~reord</title>
<path fill="none" stroke="#000000" d="M329.092,-4354.97C330.144,-4313.03 339.959,-4172.65 423,-4115 478.127,-4076.73 523.134,-4071.22 574,-4115 655.418,-4185.07 547.195,-4266.85 610,-4354 677.719,-4447.97 817.903,-4489.81 884.011,-4504.89"/>
<polygon fill="#000000" stroke="#000000" points="883.443,-4508.35 893.962,-4507.09 884.951,-4501.52 883.443,-4508.35"/>
</g>
<!-- compute_partial_charges -->
<g id="proc~~siesta_forces~~CallsGraph_node164" class="node"><title>compute_partial_charges</title>
<polygon fill="#777777" stroke="#777777" points="565,-4316 432,-4316 432,-4292 565,-4292 565,-4316"/>
<text text-anchor="middle" x="498.5" y="-4301.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_partial_charges</text>
</g>
<!-- proc~dhscf&#45;&gt;compute_partial_charges -->
<g id="proc~~siesta_forces~~CallsGraph_edge189" class="edge"><title>proc~dhscf&#45;&gt;compute_partial_charges</title>
<path fill="none" stroke="#000000" d="M353.337,-4354.95C372.082,-4345.96 398.799,-4333.76 423,-4325 428.804,-4322.9 434.924,-4320.87 441.06,-4318.97"/>
<polygon fill="#000000" stroke="#000000" points="442.104,-4322.31 450.671,-4316.08 440.087,-4315.61 442.104,-4322.31"/>
</g>
<!-- write_tdrho -->
<g id="proc~~siesta_forces~~CallsGraph_node165" class="node"><title>write_tdrho</title>
<polygon fill="#777777" stroke="#777777" points="531.5,-4274 465.5,-4274 465.5,-4250 531.5,-4250 531.5,-4274"/>
<text text-anchor="middle" x="498.5" y="-4259.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_tdrho</text>
</g>
<!-- proc~dhscf&#45;&gt;write_tdrho -->
<g id="proc~~siesta_forces~~CallsGraph_edge190" class="edge"><title>proc~dhscf&#45;&gt;write_tdrho</title>
<path fill="none" stroke="#000000" d="M339.269,-4354.81C355.303,-4336.54 388.082,-4302.17 423,-4283 433.011,-4277.5 444.586,-4273.34 455.582,-4270.24"/>
<polygon fill="#000000" stroke="#000000" points="456.659,-4273.57 465.458,-4267.67 454.899,-4266.8 456.659,-4273.57"/>
</g>
<!-- mpi_barrier -->
<g id="proc~~siesta_forces~~CallsGraph_node166" class="node"><title>mpi_barrier</title>
<polygon fill="#777777" stroke="#777777" points="954.5,-4406 887.5,-4406 887.5,-4382 954.5,-4382 954.5,-4406"/>
<text text-anchor="middle" x="921" y="-4391.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_barrier</text>
</g>
<!-- proc~dhscf&#45;&gt;mpi_barrier -->
<g id="proc~~siesta_forces~~CallsGraph_edge172" class="edge"><title>proc~dhscf&#45;&gt;mpi_barrier</title>
<path fill="none" stroke="#000000" d="M330.135,-4354.84C335.884,-4296.14 363.881,-4042.98 423,-3997 475.976,-3955.8 523.539,-3952.76 574,-3997 666.022,-4077.68 528.156,-4179.01 610,-4270 680.936,-4348.86 751.543,-4270.6 842,-4326 862.966,-4338.84 859.327,-4352.01 878,-4368 881.464,-4370.97 885.302,-4373.82 889.209,-4376.49"/>
<polygon fill="#000000" stroke="#000000" points="887.447,-4379.52 897.752,-4381.98 891.232,-4373.63 887.447,-4379.52"/>
</g>
<!-- partialcoreonmesh -->
<g id="proc~~siesta_forces~~CallsGraph_node167" class="node"><title>partialcoreonmesh</title>
<polygon fill="#777777" stroke="#777777" points="549,-4232 448,-4232 448,-4208 549,-4208 549,-4232"/>
<text text-anchor="middle" x="498.5" y="-4217.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">partialcoreonmesh</text>
</g>
<!-- proc~dhscf&#45;&gt;partialcoreonmesh -->
<g id="proc~~siesta_forces~~CallsGraph_edge192" class="edge"><title>proc~dhscf&#45;&gt;partialcoreonmesh</title>
<path fill="none" stroke="#000000" d="M334.617,-4354.86C346.914,-4329.65 378.696,-4271.46 423,-4241 427.637,-4237.81 432.75,-4235.11 438.06,-4232.81"/>
<polygon fill="#000000" stroke="#000000" points="439.678,-4235.94 447.77,-4229.1 437.179,-4229.4 439.678,-4235.94"/>
</g>
<!-- mymeshbox -->
<g id="proc~~siesta_forces~~CallsGraph_node168" class="node"><title>mymeshbox</title>
<polygon fill="#777777" stroke="#777777" points="693,-4814 623,-4814 623,-4790 693,-4790 693,-4814"/>
<text text-anchor="middle" x="658" y="-4799.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mymeshbox</text>
</g>
<!-- proc~dhscf&#45;&gt;mymeshbox -->
<g id="proc~~siesta_forces~~CallsGraph_edge193" class="edge"><title>proc~dhscf&#45;&gt;mymeshbox</title>
<path fill="none" stroke="#000000" d="M329.34,-4379.15C331.555,-4448.42 346.352,-4792.68 423,-4856 474.74,-4898.74 511.454,-4880.33 574,-4856 594.229,-4848.13 591.857,-4834.91 610,-4823 612.157,-4821.58 614.425,-4820.22 616.753,-4818.91"/>
<polygon fill="#000000" stroke="#000000" points="618.632,-4821.88 625.909,-4814.18 615.418,-4815.66 618.632,-4821.88"/>
</g>
<!-- neutralatomonmesh -->
<g id="proc~~siesta_forces~~CallsGraph_node169" class="node"><title>neutralatomonmesh</title>
<polygon fill="#777777" stroke="#777777" points="552.5,-4190 444.5,-4190 444.5,-4166 552.5,-4166 552.5,-4190"/>
<text text-anchor="middle" x="498.5" y="-4175.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">neutralatomonmesh</text>
</g>
<!-- proc~dhscf&#45;&gt;neutralatomonmesh -->
<g id="proc~~siesta_forces~~CallsGraph_edge194" class="edge"><title>proc~dhscf&#45;&gt;neutralatomonmesh</title>
<path fill="none" stroke="#000000" d="M332.3,-4354.7C341.286,-4323.63 369.199,-4241.42 423,-4199 426.759,-4196.04 430.915,-4193.49 435.284,-4191.3"/>
<polygon fill="#000000" stroke="#000000" points="436.717,-4194.5 444.493,-4187.3 433.926,-4188.08 436.717,-4194.5"/>
</g>
<!-- interface~distmeshdata -->
<g id="proc~~siesta_forces~~CallsGraph_node170" class="node"><title>interface~distmeshdata</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node170"><a xlink:href=".././interface/distmeshdata.html" xlink:title="distMeshData">
<polygon fill="#a7506f" stroke="#a7506f" points="697,-4744 619,-4744 619,-4720 697,-4720 697,-4744"/>
<text text-anchor="middle" x="658" y="-4729.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">distMeshData</text>
</a>
</g>
</g>
<!-- proc~dhscf&#45;&gt;interface~distmeshdata -->
<g id="proc~~siesta_forces~~CallsGraph_edge195" class="edge"><title>proc~dhscf&#45;&gt;interface~distmeshdata</title>
<path fill="none" stroke="#000000" d="M329.494,-4379.35C332.473,-4446.81 350.423,-4769.7 423,-4829 474.971,-4871.46 513.974,-4859.01 574,-4829 597.851,-4817.07 592.739,-4801.33 610,-4781 618.616,-4770.85 628.776,-4760.12 637.441,-4751.3"/>
<polygon fill="#000000" stroke="#000000" points="640.03,-4753.66 644.595,-4744.1 635.064,-4748.73 640.03,-4753.66"/>
</g>
<!-- mpi_allreduce -->
<g id="proc~~siesta_forces~~CallsGraph_node172" class="node"><title>mpi_allreduce</title>
<polygon fill="#777777" stroke="#777777" points="538,-4148 459,-4148 459,-4124 538,-4124 538,-4148"/>
<text text-anchor="middle" x="498.5" y="-4133.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_allreduce</text>
</g>
<!-- proc~dhscf&#45;&gt;mpi_allreduce -->
<g id="proc~~siesta_forces~~CallsGraph_edge197" class="edge"><title>proc~dhscf&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M330.779,-4354.92C336.717,-4319.03 359.212,-4212.09 423,-4157 430.397,-4150.61 439.605,-4146.16 448.998,-4143.06"/>
<polygon fill="#000000" stroke="#000000" points="450.114,-4146.38 458.784,-4140.29 448.209,-4139.64 450.114,-4146.38"/>
</g>
<!-- vacuum_level -->
<g id="proc~~siesta_forces~~CallsGraph_node173" class="node"><title>vacuum_level</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-4030 459.5,-4030 459.5,-4006 537.5,-4006 537.5,-4030"/>
<text text-anchor="middle" x="498.5" y="-4015.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">vacuum_level</text>
</g>
<!-- proc~dhscf&#45;&gt;vacuum_level -->
<g id="proc~~siesta_forces~~CallsGraph_edge198" class="edge"><title>proc~dhscf&#45;&gt;vacuum_level</title>
<path fill="none" stroke="#000000" d="M328.807,-4354.85C328.734,-4307.98 334.767,-4137 423,-4044 430.288,-4036.32 439.967,-4030.9 449.929,-4027.09"/>
<polygon fill="#000000" stroke="#000000" points="451.117,-4030.38 459.497,-4023.9 448.904,-4023.74 451.117,-4030.38"/>
</g>
<!-- localchargeonmesh -->
<g id="proc~~siesta_forces~~CallsGraph_node174" class="node"><title>localchargeonmesh</title>
<polygon fill="#777777" stroke="#777777" points="551.5,-3912 445.5,-3912 445.5,-3888 551.5,-3888 551.5,-3912"/>
<text text-anchor="middle" x="498.5" y="-3897.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">localchargeonmesh</text>
</g>
<!-- proc~dhscf&#45;&gt;localchargeonmesh -->
<g id="proc~~siesta_forces~~CallsGraph_edge200" class="edge"><title>proc~dhscf&#45;&gt;localchargeonmesh</title>
<path fill="none" stroke="#000000" d="M330.01,-4354.73C335.529,-4290.45 363.987,-3992.94 423,-3926 426.737,-3921.76 431.204,-3918.21 436.068,-3915.24"/>
<polygon fill="#000000" stroke="#000000" points="437.929,-3918.22 445.182,-3910.5 434.696,-3912.01 437.929,-3918.22"/>
</g>
<!-- proc~rhoofd -->
<g id="proc~~siesta_forces~~CallsGraph_node175" class="node"><title>proc~rhoofd</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node175"><a xlink:href=".././proc/rhoofd.html" xlink:title="rhoofd">
<polygon fill="#d9534f" stroke="#d9534f" points="525.5,-3790 471.5,-3790 471.5,-3766 525.5,-3766 525.5,-3790"/>
<text text-anchor="middle" x="498.5" y="-3775.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rhoofd</text>
</a>
</g>
</g>
<!-- proc~dhscf&#45;&gt;proc~rhoofd -->
<g id="proc~~siesta_forces~~CallsGraph_edge202" class="edge"><title>proc~dhscf&#45;&gt;proc~rhoofd</title>
<path fill="none" stroke="#000000" d="M329.298,-4354.76C331.363,-4279.98 345.844,-3885.21 423,-3799 432.641,-3788.23 447.335,-3782.8 461.133,-3780.13"/>
<polygon fill="#000000" stroke="#000000" points="462.044,-3783.53 471.411,-3778.58 461.001,-3776.61 462.044,-3783.53"/>
</g>
<!-- vmat -->
<g id="proc~~siesta_forces~~CallsGraph_node176" class="node"><title>vmat</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-3832 471.5,-3832 471.5,-3808 525.5,-3808 525.5,-3832"/>
<text text-anchor="middle" x="498.5" y="-3817.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">vmat</text>
</g>
<!-- proc~dhscf&#45;&gt;vmat -->
<g id="proc~~siesta_forces~~CallsGraph_edge203" class="edge"><title>proc~dhscf&#45;&gt;vmat</title>
<path fill="none" stroke="#000000" d="M329.565,-4354.92C333.09,-4284.42 354.213,-3926.56 423,-3846 432.664,-3834.68 447.541,-3828.29 461.467,-3824.68"/>
<polygon fill="#000000" stroke="#000000" points="462.334,-3828.07 471.351,-3822.51 460.834,-3821.23 462.334,-3828.07"/>
</g>
<!-- proc~write_rho -->
<g id="proc~~siesta_forces~~CallsGraph_node177" class="node"><title>proc~write_rho</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node177"><a xlink:href=".././proc/write_rho.html" xlink:title="write_rho">
<polygon fill="#d9534f" stroke="#d9534f" points="820.5,-4274 763.5,-4274 763.5,-4250 820.5,-4250 820.5,-4274"/>
<text text-anchor="middle" x="792" y="-4259.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_rho</text>
</a>
</g>
</g>
<!-- proc~dhscf&#45;&gt;proc~write_rho -->
<g id="proc~~siesta_forces~~CallsGraph_edge204" class="edge"><title>proc~dhscf&#45;&gt;proc~write_rho</title>
<path fill="none" stroke="#000000" d="M329.887,-4354.61C334.619,-4292.35 359.127,-4014.69 423,-3964 475.569,-3922.28 523.57,-3919.72 574,-3964 666.958,-4045.62 522.145,-4152.91 610,-4240 647.305,-4276.98 712.296,-4275.26 753.408,-4269.48"/>
<polygon fill="#000000" stroke="#000000" points="753.969,-4272.93 763.314,-4267.94 752.895,-4266.02 753.969,-4272.93"/>
</g>
<!-- proc~mixers_history_init&#45;&gt;delete -->
<g id="proc~~siesta_forces~~CallsGraph_edge207" class="edge"><title>proc~mixers_history_init&#45;&gt;delete</title>
<path fill="none" stroke="#000000" d="M549.09,-59.3203C558.553,-62.527 567.514,-67.4618 574,-75 658.885,-173.661 658.668,-609.739 657.376,-713.696"/>
<polygon fill="#000000" stroke="#000000" points="653.872,-713.903 657.23,-723.951 660.872,-714.002 653.872,-713.903"/>
</g>
<!-- proc~current_itt -->
<g id="proc~~siesta_forces~~CallsGraph_node156" class="node"><title>proc~current_itt</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node156"><a xlink:href=".././proc/current_itt.html" xlink:title="current_itt">
<polygon fill="#d94e8f" stroke="#d94e8f" points="688.5,-45 627.5,-45 627.5,-21 688.5,-21 688.5,-45"/>
<text text-anchor="middle" x="658" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">current_itt</text>
</a>
</g>
</g>
<!-- proc~mixers_history_init&#45;&gt;proc~current_itt -->
<g id="proc~~siesta_forces~~CallsGraph_edge206" class="edge"><title>proc~mixers_history_init&#45;&gt;proc~current_itt</title>
<path fill="none" stroke="#000000" d="M549.334,-47.3555C571.229,-44.4361 596.588,-41.0549 617.193,-38.3076"/>
<polygon fill="#000000" stroke="#000000" points="617.741,-41.7656 627.19,-36.9746 616.815,-34.8271 617.741,-41.7656"/>
</g>
<!-- new -->
<g id="proc~~siesta_forces~~CallsGraph_node157" class="node"><title>new</title>
<polygon fill="#777777" stroke="#777777" points="685,-87 631,-87 631,-63 685,-63 685,-87"/>
<text text-anchor="middle" x="658" y="-72.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">new</text>
</g>
<!-- proc~mixers_history_init&#45;&gt;new -->
<g id="proc~~siesta_forces~~CallsGraph_edge205" class="edge"><title>proc~mixers_history_init&#45;&gt;new</title>
<path fill="none" stroke="#000000" d="M549.334,-60.6445C572.463,-63.7284 599.457,-67.3275 620.629,-70.1505"/>
<polygon fill="#000000" stroke="#000000" points="620.44,-73.6563 630.815,-71.5087 621.366,-66.7177 620.44,-73.6563"/>
</g>
<!-- proc~compute_max_diff_1d&#45;&gt;die -->
<g id="proc~~siesta_forces~~CallsGraph_edge208" class="edge"><title>proc~compute_max_diff_1d&#45;&gt;die</title>
<path fill="none" stroke="#000000" d="M377.575,-1363.98C381.195,-1361.52 384.43,-1358.56 387,-1355 473.014,-1235.86 332.717,-148.937 423,-33 432.036,-21.3969 446.961,-15.8765 461.089,-13.3587"/>
<polygon fill="#000000" stroke="#000000" points="461.693,-16.8091 471.139,-12.012 460.763,-9.87113 461.693,-16.8091"/>
</g>
<!-- proc~check_cohp&#45;&gt;proc~message -->
<g id="proc~~siesta_forces~~CallsGraph_edge209" class="edge"><title>proc~check_cohp&#45;&gt;proc~message</title>
<path fill="none" stroke="#000000" d="M794.515,-2104.02C807.485,-2206.97 899.798,-2939.66 917.181,-3077.63"/>
<polygon fill="#000000" stroke="#000000" points="913.744,-3078.34 918.466,-3087.83 920.689,-3077.47 913.744,-3078.34"/>
</g>
<!-- proc~die&#45;&gt;pxfflush -->
<g id="proc~~siesta_forces~~CallsGraph_edge215" class="edge"><title>proc~die&#45;&gt;pxfflush</title>
<path fill="none" stroke="#000000" d="M928.775,-3319.75C942.175,-3295.59 973.097,-3240.12 1000,-3194 1006.35,-3183.11 1013.57,-3171.09 1019.58,-3161.16"/>
<polygon fill="#000000" stroke="#000000" points="1022.71,-3162.75 1024.92,-3152.38 1016.73,-3159.11 1022.71,-3162.75"/>
</g>
<!-- proc~die&#45;&gt;cmlfinishfile -->
<g id="proc~~siesta_forces~~CallsGraph_edge211" class="edge"><title>proc~die&#45;&gt;cmlfinishfile</title>
<path fill="none" stroke="#000000" d="M932.999,-3319.93C948.003,-3303.52 975.792,-3273.31 1000,-3248 1004.27,-3243.53 1008.91,-3238.77 1013.31,-3234.3"/>
<polygon fill="#000000" stroke="#000000" points="1015.84,-3236.72 1020.38,-3227.14 1010.86,-3231.8 1015.84,-3236.72"/>
</g>
<!-- mpi_abort -->
<g id="proc~~siesta_forces~~CallsGraph_node143" class="node"><title>mpi_abort</title>
<polygon fill="#777777" stroke="#777777" points="1064,-3407 1003,-3407 1003,-3383 1064,-3383 1064,-3407"/>
<text text-anchor="middle" x="1033.5" y="-3392.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_abort</text>
</g>
<!-- proc~die&#45;&gt;mpi_abort -->
<g id="proc~~siesta_forces~~CallsGraph_edge214" class="edge"><title>proc~die&#45;&gt;mpi_abort</title>
<path fill="none" stroke="#000000" d="M943.306,-3344.15C960.121,-3353.73 983.785,-3367.23 1002.51,-3377.9"/>
<polygon fill="#000000" stroke="#000000" points="1000.84,-3380.98 1011.26,-3382.89 1004.31,-3374.9 1000.84,-3380.98"/>
</g>
<!-- io_close -->
<g id="proc~~siesta_forces~~CallsGraph_node153" class="node"><title>io_close</title>
<polygon fill="#777777" stroke="#777777" points="1060.5,-3323 1006.5,-3323 1006.5,-3299 1060.5,-3299 1060.5,-3323"/>
<text text-anchor="middle" x="1033.5" y="-3308.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">io_close</text>
</g>
<!-- proc~die&#45;&gt;io_close -->
<g id="proc~~siesta_forces~~CallsGraph_edge210" class="edge"><title>proc~die&#45;&gt;io_close</title>
<path fill="none" stroke="#000000" d="M948.187,-3327.02C962.532,-3324.3 980.53,-3320.88 996.211,-3317.9"/>
<polygon fill="#000000" stroke="#000000" points="996.947,-3321.32 1006.12,-3316.01 995.64,-3314.44 996.947,-3321.32"/>
</g>
<!-- io_assign -->
<g id="proc~~siesta_forces~~CallsGraph_node155" class="node"><title>io_assign</title>
<polygon fill="#777777" stroke="#777777" points="1062.5,-3281 1004.5,-3281 1004.5,-3257 1062.5,-3257 1062.5,-3281"/>
<text text-anchor="middle" x="1033.5" y="-3266.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">io_assign</text>
</g>
<!-- proc~die&#45;&gt;io_assign -->
<g id="proc~~siesta_forces~~CallsGraph_edge212" class="edge"><title>proc~die&#45;&gt;io_assign</title>
<path fill="none" stroke="#000000" d="M943.306,-3319.85C960.121,-3310.27 983.785,-3296.77 1002.51,-3286.1"/>
<polygon fill="#000000" stroke="#000000" points="1004.31,-3289.1 1011.26,-3281.11 1000.84,-3283.02 1004.31,-3289.1"/>
</g>
<!-- pxfabort -->
<g id="proc~~siesta_forces~~CallsGraph_node171" class="node"><title>pxfabort</title>
<polygon fill="#777777" stroke="#777777" points="1060.5,-3365 1006.5,-3365 1006.5,-3341 1060.5,-3341 1060.5,-3365"/>
<text text-anchor="middle" x="1033.5" y="-3350.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pxfabort</text>
</g>
<!-- proc~die&#45;&gt;pxfabort -->
<g id="proc~~siesta_forces~~CallsGraph_edge213" class="edge"><title>proc~die&#45;&gt;pxfabort</title>
<path fill="none" stroke="#000000" d="M948.187,-3336.98C962.532,-3339.7 980.53,-3343.12 996.211,-3346.1"/>
<polygon fill="#000000" stroke="#000000" points="995.64,-3349.56 1006.12,-3347.99 996.947,-3342.68 995.64,-3349.56"/>
</g>
<!-- proc~message&#45;&gt;pxfflush -->
<g id="proc~~siesta_forces~~CallsGraph_edge217" class="edge"><title>proc~message&#45;&gt;pxfflush</title>
<path fill="none" stroke="#000000" d="M949.031,-3109.79C963.288,-3114.95 980.97,-3121.35 996.385,-3126.93"/>
<polygon fill="#000000" stroke="#000000" points="995.535,-3130.34 1006.13,-3130.45 997.917,-3123.76 995.535,-3130.34"/>
</g>
<!-- proc~message&#45;&gt;io_close -->
<g id="proc~~siesta_forces~~CallsGraph_edge218" class="edge"><title>proc~message&#45;&gt;io_close</title>
<path fill="none" stroke="#000000" d="M927.052,-3112.24C934.949,-3131.39 950.693,-3169.58 964,-3202 980.045,-3241.09 973.013,-3257.48 1000,-3290 1000.6,-3290.72 1001.23,-3291.43 1001.89,-3292.12"/>
<polygon fill="#000000" stroke="#000000" points="999.852,-3294.99 1009.71,-3298.86 1004.42,-3289.68 999.852,-3294.99"/>
</g>
<!-- proc~message&#45;&gt;io_assign -->
<g id="proc~~siesta_forces~~CallsGraph_edge216" class="edge"><title>proc~message&#45;&gt;io_assign</title>
<path fill="none" stroke="#000000" d="M927.71,-3112.28C939.451,-3136.94 967.911,-3193.72 1000,-3236 1003.52,-3240.64 1007.66,-3245.3 1011.78,-3249.6"/>
<polygon fill="#000000" stroke="#000000" points="1009.48,-3252.26 1019.03,-3256.85 1014.43,-3247.31 1009.48,-3252.26"/>
</g>
<!-- proc~forhar&#45;&gt;re_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge221" class="edge"><title>proc~forhar&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M525.812,-4958.35C548.18,-4953.59 581.16,-4946.67 610,-4941 712.895,-4920.76 744.404,-4936.37 842,-4898 907.886,-4872.1 975.667,-4822.48 1009.85,-4795.53"/>
<polygon fill="#000000" stroke="#000000" points="1012.15,-4798.17 1017.79,-4789.19 1007.79,-4792.69 1012.15,-4798.17"/>
</g>
<!-- proc~forhar&#45;&gt;de_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge223" class="edge"><title>proc~forhar&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M525.619,-4953.36C614.078,-4916.86 900.389,-4794.9 964,-4720 1006.37,-4670.12 1023.47,-4591.83 1029.56,-4553.97"/>
<polygon fill="#000000" stroke="#000000" points="1033.03,-4554.41 1031.05,-4544 1026.11,-4553.37 1033.03,-4554.41"/>
</g>
<!-- proc~forhar&#45;&gt;jms_setmeshdistr -->
<g id="proc~~siesta_forces~~CallsGraph_edge224" class="edge"><title>proc~forhar&#45;&gt;jms_setmeshdistr</title>
<path fill="none" stroke="#000000" d="M525.508,-4970.61C545.717,-4975.74 574.502,-4983.05 599.99,-4989.52"/>
<polygon fill="#000000" stroke="#000000" points="599.384,-4992.98 609.938,-4992.05 601.107,-4986.19 599.384,-4992.98"/>
</g>
<!-- proc~forhar&#45;&gt;bsc_cellxc -->
<g id="proc~~siesta_forces~~CallsGraph_edge225" class="edge"><title>proc~forhar&#45;&gt;bsc_cellxc</title>
<path fill="none" stroke="#000000" d="M525.508,-4963.67C550.487,-4963.35 588.568,-4962.87 617.331,-4962.5"/>
<polygon fill="#000000" stroke="#000000" points="617.51,-4966 627.465,-4962.38 617.421,-4959 617.51,-4966"/>
</g>
<!-- proc~forhar&#45;&gt;proc~setmeshdistr -->
<g id="proc~~siesta_forces~~CallsGraph_edge220" class="edge"><title>proc~forhar&#45;&gt;proc~setmeshdistr</title>
<path fill="none" stroke="#000000" d="M525.705,-4959.82C541.199,-4956.23 560.389,-4949.7 574,-4938 599.937,-4915.71 586.043,-4894.4 610,-4870 613.013,-4866.93 616.467,-4864.12 620.103,-4861.58"/>
<polygon fill="#000000" stroke="#000000" points="622.179,-4864.41 628.802,-4856.14 618.467,-4858.48 622.179,-4864.41"/>
</g>
<!-- proc~forhar&#45;&gt;mymeshbox -->
<g id="proc~~siesta_forces~~CallsGraph_edge219" class="edge"><title>proc~forhar&#45;&gt;mymeshbox</title>
<path fill="none" stroke="#000000" d="M517.678,-4951.81C534.081,-4940.07 558.022,-4921.05 574,-4900 596.839,-4869.91 583.059,-4849.48 610,-4823 611.271,-4821.75 612.629,-4820.57 614.052,-4819.45"/>
<polygon fill="#000000" stroke="#000000" points="616.332,-4822.14 622.778,-4813.73 612.496,-4816.29 616.332,-4822.14"/>
</g>
<!-- proc~forhar&#45;&gt;interface~distmeshdata -->
<g id="proc~~siesta_forces~~CallsGraph_edge222" class="edge"><title>proc~forhar&#45;&gt;interface~distmeshdata</title>
<path fill="none" stroke="#000000" d="M509.818,-4951.71C525.111,-4933.12 554.122,-4896.36 574,-4862 593.729,-4827.9 588.036,-4813.7 610,-4781 617.218,-4770.25 626.893,-4759.71 635.589,-4751.17"/>
<polygon fill="#000000" stroke="#000000" points="638.054,-4753.66 642.892,-4744.23 633.232,-4748.58 638.054,-4753.66"/>
</g>
<!-- proc~reord&#45;&gt;timer -->
<g id="proc~~siesta_forces~~CallsGraph_edge228" class="edge"><title>proc~reord&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M948.364,-4500.92C954.48,-4497.09 960.28,-4492.17 964,-4486 1015.9,-4399.92 1029.99,-3651.99 1032.17,-3512.39"/>
<polygon fill="#000000" stroke="#000000" points="1035.68,-3512.14 1032.33,-3502.09 1028.68,-3512.03 1035.68,-3512.14"/>
</g>
<!-- proc~reord&#45;&gt;re_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge226" class="edge"><title>proc~reord&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M932.515,-4524.41C941.815,-4535.89 955.234,-4553.74 964,-4571 996.148,-4634.31 1018.08,-4716.01 1027.42,-4754.74"/>
<polygon fill="#000000" stroke="#000000" points="1024.11,-4755.96 1029.81,-4764.89 1030.92,-4754.36 1024.11,-4755.96"/>
</g>
<!-- proc~reord&#45;&gt;de_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge227" class="edge"><title>proc~reord&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M948.187,-4516.74C962.532,-4519.34 980.53,-4522.59 996.211,-4525.43"/>
<polygon fill="#000000" stroke="#000000" points="995.655,-4528.89 1006.12,-4527.22 996.901,-4522 995.655,-4528.89"/>
</g>
<!-- proc~distmeshdata_rea -->
<g id="proc~~siesta_forces~~CallsGraph_node181" class="node"><title>proc~distmeshdata_rea</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node181"><a xlink:href=".././proc/distmeshdata_rea.html" xlink:title="distMeshData_rea">
<polygon fill="#d9534f" stroke="#d9534f" points="842,-4544 742,-4544 742,-4520 842,-4520 842,-4544"/>
<text text-anchor="middle" x="792" y="-4529.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">distMeshData_rea</text>
</a>
</g>
</g>
<!-- interface~distmeshdata&#45;&gt;proc~distmeshdata_rea -->
<g id="proc~~siesta_forces~~CallsGraph_edge229" class="edge"><title>interface~distmeshdata&#45;&gt;proc~distmeshdata_rea</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M667.058,-4719.79C689.019,-4686.52 750.098,-4593.97 777.451,-4552.53"/>
<polygon fill="#000000" stroke="#000000" points="780.46,-4554.32 783.047,-4544.05 774.617,-4550.47 780.46,-4554.32"/>
</g>
<!-- proc~distmeshdata_int -->
<g id="proc~~siesta_forces~~CallsGraph_node191" class="node"><title>proc~distmeshdata_int</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node191"><a xlink:href=".././proc/distmeshdata_int.html" xlink:title="distMeshData_int">
<polygon fill="#d9534f" stroke="#d9534f" points="839.5,-4724 744.5,-4724 744.5,-4700 839.5,-4700 839.5,-4724"/>
<text text-anchor="middle" x="792" y="-4709.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">distMeshData_int</text>
</a>
</g>
</g>
<!-- interface~distmeshdata&#45;&gt;proc~distmeshdata_int -->
<g id="proc~~siesta_forces~~CallsGraph_edge230" class="edge"><title>interface~distmeshdata&#45;&gt;proc~distmeshdata_int</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M697.18,-4726.22C708.836,-4724.45 721.908,-4722.47 734.508,-4720.56"/>
<polygon fill="#000000" stroke="#000000" points="735.113,-4724.01 744.476,-4719.05 734.065,-4717.09 735.113,-4724.01"/>
</g>
<!-- proc~rhoofd&#45;&gt;timer -->
<g id="proc~~siesta_forces~~CallsGraph_edge238" class="edge"><title>proc~rhoofd&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M525.782,-3778.41C542.117,-3780.14 562.189,-3785.23 574,-3799 659.704,-3898.92 511.42,-4005.75 610,-4093 641.951,-4121.28 669.345,-4114.84 706,-4093 933.028,-3957.75 1011.83,-3603.68 1028.76,-3511.96"/>
<polygon fill="#000000" stroke="#000000" points="1032.21,-3512.56 1030.53,-3502.1 1025.32,-3511.33 1032.21,-3512.56"/>
</g>
<!-- proc~rhoofd&#45;&gt;re_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge235" class="edge"><title>proc~rhoofd&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M525.501,-3778.3C541.936,-3779.97 562.226,-3785.02 574,-3799 623.659,-3857.96 552.736,-4092.4 610,-4144 668.469,-4196.69 906.02,-4079.78 964,-4133 998.505,-4164.67 994.635,-4506.47 1000,-4553 1008.56,-4627.22 1022.33,-4714.75 1028.85,-4754.88"/>
<polygon fill="#000000" stroke="#000000" points="1025.42,-4755.59 1030.49,-4764.89 1032.33,-4754.46 1025.42,-4755.59"/>
</g>
<!-- proc~rhoofd&#45;&gt;de_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge243" class="edge"><title>proc~rhoofd&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M525.822,-3778.38C542.175,-3780.09 562.25,-3785.18 574,-3799 619.92,-3853.02 557.115,-4068.78 610,-4116 727.48,-4220.89 844.232,-3997.73 964,-4100 1026.87,-4153.69 1032.35,-4428.61 1032.58,-4509.55"/>
<polygon fill="#000000" stroke="#000000" points="1029.08,-4509.65 1032.58,-4519.64 1036.08,-4509.64 1029.08,-4509.65"/>
</g>
<!-- proc~rhoofd&#45;&gt;proc~die -->
<g id="proc~~siesta_forces~~CallsGraph_edge246" class="edge"><title>proc~rhoofd&#45;&gt;proc~die</title>
<path fill="none" stroke="#000000" d="M525.671,-3775.51C541.961,-3772.55 562.023,-3766.09 574,-3752 633.906,-3681.51 549.42,-3616.91 610,-3547 645.528,-3506 800.09,-3505.45 842,-3471 880.053,-3439.72 902.9,-3384.73 913.289,-3354.13"/>
<polygon fill="#000000" stroke="#000000" points="916.688,-3355 916.448,-3344.4 910.03,-3352.83 916.688,-3355"/>
</g>
<!-- phi -->
<g id="proc~~siesta_forces~~CallsGraph_node178" class="node"><title>phi</title>
<polygon fill="#777777" stroke="#777777" points="685,-4084 631,-4084 631,-4060 685,-4060 685,-4084"/>
<text text-anchor="middle" x="658" y="-4069.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">phi</text>
</g>
<!-- proc~rhoofd&#45;&gt;phi -->
<g id="proc~~siesta_forces~~CallsGraph_edge231" class="edge"><title>proc~rhoofd&#45;&gt;phi</title>
<path fill="none" stroke="#000000" d="M525.69,-3778.49C541.987,-3780.26 562.052,-3785.35 574,-3799 648.513,-3884.13 541.869,-3960.68 610,-4051 613.148,-4055.17 617.312,-4058.54 621.863,-4061.24"/>
<polygon fill="#000000" stroke="#000000" points="620.405,-4064.42 630.926,-4065.67 623.479,-4058.14 620.405,-4064.42"/>
</g>
<!-- indxuo -->
<g id="proc~~siesta_forces~~CallsGraph_node179" class="node"><title>indxuo</title>
<polygon fill="#777777" stroke="#777777" points="685,-4042 631,-4042 631,-4018 685,-4018 685,-4042"/>
<text text-anchor="middle" x="658" y="-4027.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">indxuo</text>
</g>
<!-- proc~rhoofd&#45;&gt;indxuo -->
<g id="proc~~siesta_forces~~CallsGraph_edge232" class="edge"><title>proc~rhoofd&#45;&gt;indxuo</title>
<path fill="none" stroke="#000000" d="M525.563,-3778.6C541.809,-3780.41 561.863,-3785.52 574,-3799 637.354,-3869.38 551.927,-3934.2 610,-4009 613.059,-4012.94 617.018,-4016.16 621.34,-4018.79"/>
<polygon fill="#000000" stroke="#000000" points="620.036,-4022.05 630.546,-4023.39 623.165,-4015.79 620.036,-4022.05"/>
</g>
<!-- listsc -->
<g id="proc~~siesta_forces~~CallsGraph_node180" class="node"><title>listsc</title>
<polygon fill="#777777" stroke="#777777" points="685,-4000 631,-4000 631,-3976 685,-3976 685,-4000"/>
<text text-anchor="middle" x="658" y="-3985.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">listsc</text>
</g>
<!-- proc~rhoofd&#45;&gt;listsc -->
<g id="proc~~siesta_forces~~CallsGraph_edge233" class="edge"><title>proc~rhoofd&#45;&gt;listsc</title>
<path fill="none" stroke="#000000" d="M525.738,-3778.82C541.844,-3780.73 561.679,-3785.87 574,-3799 626.25,-3854.69 561.934,-3907.66 610,-3967 613.14,-3970.88 617.144,-3974.06 621.488,-3976.67"/>
<polygon fill="#000000" stroke="#000000" points="620.197,-3979.94 630.71,-3981.26 623.315,-3973.67 620.197,-3979.94"/>
</g>
<!-- endpht -->
<g id="proc~~siesta_forces~~CallsGraph_node182" class="node"><title>endpht</title>
<polygon fill="#777777" stroke="#777777" points="685,-3958 631,-3958 631,-3934 685,-3934 685,-3958"/>
<text text-anchor="middle" x="658" y="-3943.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">endpht</text>
</g>
<!-- proc~rhoofd&#45;&gt;endpht -->
<g id="proc~~siesta_forces~~CallsGraph_edge234" class="edge"><title>proc~rhoofd&#45;&gt;endpht</title>
<path fill="none" stroke="#000000" d="M525.801,-3779.15C541.726,-3781.21 561.34,-3786.38 574,-3799 615.256,-3840.11 571.84,-3881 610,-3925 613.268,-3928.77 617.345,-3931.89 621.723,-3934.47"/>
<polygon fill="#000000" stroke="#000000" points="620.454,-3937.75 630.97,-3939.04 623.554,-3931.47 620.454,-3937.75"/>
</g>
<!-- listp2 -->
<g id="proc~~siesta_forces~~CallsGraph_node184" class="node"><title>listp2</title>
<polygon fill="#777777" stroke="#777777" points="685,-3916 631,-3916 631,-3892 685,-3892 685,-3916"/>
<text text-anchor="middle" x="658" y="-3901.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">listp2</text>
</g>
<!-- proc~rhoofd&#45;&gt;listp2 -->
<g id="proc~~siesta_forces~~CallsGraph_edge236" class="edge"><title>proc~rhoofd&#45;&gt;listp2</title>
<path fill="none" stroke="#000000" d="M525.621,-3779.77C541.278,-3782.08 560.668,-3787.3 574,-3799 604.528,-3825.79 581.5,-3854.06 610,-3883 613.426,-3886.48 617.529,-3889.43 621.865,-3891.92"/>
<polygon fill="#000000" stroke="#000000" points="620.434,-3895.11 630.951,-3896.4 623.531,-3888.84 620.434,-3895.11"/>
</g>
<!-- needdscfl -->
<g id="proc~~siesta_forces~~CallsGraph_node185" class="node"><title>needdscfl</title>
<polygon fill="#777777" stroke="#777777" points="687,-3874 629,-3874 629,-3850 687,-3850 687,-3874"/>
<text text-anchor="middle" x="658" y="-3859.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">needdscfl</text>
</g>
<!-- proc~rhoofd&#45;&gt;needdscfl -->
<g id="proc~~siesta_forces~~CallsGraph_edge237" class="edge"><title>proc~rhoofd&#45;&gt;needdscfl</title>
<path fill="none" stroke="#000000" d="M525.527,-3781.49C540.588,-3784.41 559.391,-3789.67 574,-3799 594.719,-3812.24 590.298,-3826.29 610,-3841 612.968,-3843.22 616.206,-3845.26 619.55,-3847.14"/>
<polygon fill="#000000" stroke="#000000" points="618.033,-3850.3 628.533,-3851.71 621.206,-3844.06 618.033,-3850.3"/>
</g>
<!-- listdlptr -->
<g id="proc~~siesta_forces~~CallsGraph_node186" class="node"><title>listdlptr</title>
<polygon fill="#777777" stroke="#777777" points="685,-3832 631,-3832 631,-3808 685,-3808 685,-3832"/>
<text text-anchor="middle" x="658" y="-3817.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">listdlptr</text>
</g>
<!-- proc~rhoofd&#45;&gt;listdlptr -->
<g id="proc~~siesta_forces~~CallsGraph_edge239" class="edge"><title>proc~rhoofd&#45;&gt;listdlptr</title>
<path fill="none" stroke="#000000" d="M525.508,-3784.94C551.612,-3791.9 592.027,-3802.67 621.161,-3810.44"/>
<polygon fill="#000000" stroke="#000000" points="620.389,-3813.86 630.953,-3813.05 622.193,-3807.1 620.389,-3813.86"/>
</g>
<!-- matrixotom -->
<g id="proc~~siesta_forces~~CallsGraph_node187" class="node"><title>matrixotom</title>
<polygon fill="#777777" stroke="#777777" points="691,-3790 625,-3790 625,-3766 691,-3766 691,-3790"/>
<text text-anchor="middle" x="658" y="-3775.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">matrixotom</text>
</g>
<!-- proc~rhoofd&#45;&gt;matrixotom -->
<g id="proc~~siesta_forces~~CallsGraph_edge240" class="edge"><title>proc~rhoofd&#45;&gt;matrixotom</title>
<path fill="none" stroke="#000000" d="M525.508,-3778C549.786,-3778 586.443,-3778 614.89,-3778"/>
<polygon fill="#000000" stroke="#000000" points="614.961,-3781.5 624.961,-3778 614.961,-3774.5 614.961,-3781.5"/>
</g>
<!-- lstpht -->
<g id="proc~~siesta_forces~~CallsGraph_node188" class="node"><title>lstpht</title>
<polygon fill="#777777" stroke="#777777" points="685,-3748 631,-3748 631,-3724 685,-3724 685,-3748"/>
<text text-anchor="middle" x="658" y="-3733.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lstpht</text>
</g>
<!-- proc~rhoofd&#45;&gt;lstpht -->
<g id="proc~~siesta_forces~~CallsGraph_edge241" class="edge"><title>proc~rhoofd&#45;&gt;lstpht</title>
<path fill="none" stroke="#000000" d="M525.508,-3771.06C551.612,-3764.1 592.027,-3753.33 621.161,-3745.56"/>
<polygon fill="#000000" stroke="#000000" points="622.193,-3748.9 630.953,-3742.95 620.389,-3742.14 622.193,-3748.9"/>
</g>
<!-- globaltolocalorb -->
<g id="proc~~siesta_forces~~CallsGraph_node189" class="node"><title>globaltolocalorb</title>
<polygon fill="#777777" stroke="#777777" points="702,-3706 614,-3706 614,-3682 702,-3682 702,-3706"/>
<text text-anchor="middle" x="658" y="-3691.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">globaltolocalorb</text>
</g>
<!-- proc~rhoofd&#45;&gt;globaltolocalorb -->
<g id="proc~~siesta_forces~~CallsGraph_edge242" class="edge"><title>proc~rhoofd&#45;&gt;globaltolocalorb</title>
<path fill="none" stroke="#000000" d="M525.66,-3772.07C540.588,-3767.92 559.213,-3761.42 574,-3752 593.348,-3739.67 591.189,-3728.14 610,-3715 611.905,-3713.67 613.908,-3712.39 615.969,-3711.17"/>
<polygon fill="#000000" stroke="#000000" points="618.098,-3714 625.257,-3706.19 614.79,-3707.83 618.098,-3714"/>
</g>
<!-- numdl -->
<g id="proc~~siesta_forces~~CallsGraph_node190" class="node"><title>numdl</title>
<polygon fill="#777777" stroke="#777777" points="685,-3664 631,-3664 631,-3640 685,-3640 685,-3664"/>
<text text-anchor="middle" x="658" y="-3649.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">numdl</text>
</g>
<!-- proc~rhoofd&#45;&gt;numdl -->
<g id="proc~~siesta_forces~~CallsGraph_edge244" class="edge"><title>proc~rhoofd&#45;&gt;numdl</title>
<path fill="none" stroke="#000000" d="M525.601,-3774.19C541.251,-3770.72 560.64,-3764.19 574,-3752 602.507,-3726 582.616,-3700.18 610,-3673 613.3,-3669.72 617.201,-3666.91 621.321,-3664.51"/>
<polygon fill="#000000" stroke="#000000" points="623.171,-3667.5 630.543,-3659.89 620.035,-3661.24 623.171,-3667.5"/>
</g>
<!-- proc~rcut -->
<g id="proc~~siesta_forces~~CallsGraph_node193" class="node"><title>proc~rcut</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node193"><a xlink:href=".././proc/rcut.html" xlink:title="rcut">
<polygon fill="#d94e8f" stroke="#d94e8f" points="685,-3500 631,-3500 631,-3476 685,-3476 685,-3500"/>
<text text-anchor="middle" x="658" y="-3485.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rcut</text>
</a>
</g>
</g>
<!-- proc~rhoofd&#45;&gt;proc~rcut -->
<g id="proc~~siesta_forces~~CallsGraph_edge245" class="edge"><title>proc~rhoofd&#45;&gt;proc~rcut</title>
<path fill="none" stroke="#000000" d="M525.783,-3775.6C542.119,-3772.68 562.191,-3766.23 574,-3752 642.309,-3669.67 548.906,-3601.82 610,-3514 613.195,-3509.41 617.474,-3505.54 622.154,-3502.31"/>
<polygon fill="#000000" stroke="#000000" points="624.034,-3505.26 630.862,-3497.16 620.472,-3499.24 624.034,-3505.26"/>
</g>
<!-- dscfl -->
<g id="proc~~siesta_forces~~CallsGraph_node194" class="node"><title>dscfl</title>
<polygon fill="#777777" stroke="#777777" points="685,-3622 631,-3622 631,-3598 685,-3598 685,-3622"/>
<text text-anchor="middle" x="658" y="-3607.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dscfl</text>
</g>
<!-- proc~rhoofd&#45;&gt;dscfl -->
<g id="proc~~siesta_forces~~CallsGraph_edge247" class="edge"><title>proc~rhoofd&#45;&gt;dscfl</title>
<path fill="none" stroke="#000000" d="M525.856,-3774.89C541.803,-3771.68 561.42,-3765.18 574,-3752 612.739,-3711.41 573.008,-3673.19 610,-3631 613.219,-3627.33 617.204,-3624.27 621.481,-3621.73"/>
<polygon fill="#000000" stroke="#000000" points="623.145,-3624.81 630.522,-3617.2 620.013,-3618.55 623.145,-3624.81"/>
</g>
<!-- listdl -->
<g id="proc~~siesta_forces~~CallsGraph_node195" class="node"><title>listdl</title>
<polygon fill="#777777" stroke="#777777" points="685,-3580 631,-3580 631,-3556 685,-3556 685,-3580"/>
<text text-anchor="middle" x="658" y="-3565.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">listdl</text>
</g>
<!-- proc~rhoofd&#45;&gt;listdl -->
<g id="proc~~siesta_forces~~CallsGraph_edge248" class="edge"><title>proc~rhoofd&#45;&gt;listdl</title>
<path fill="none" stroke="#000000" d="M525.828,-3775.27C541.97,-3772.21 561.811,-3765.73 574,-3752 623.264,-3696.53 563.12,-3646.5 610,-3589 613.152,-3585.13 617.163,-3581.96 621.51,-3579.35"/>
<polygon fill="#000000" stroke="#000000" points="623.338,-3582.35 630.734,-3574.76 620.222,-3576.08 623.338,-3582.35"/>
</g>
<!-- proc~write_rho&#45;&gt;write_debug -->
<g id="proc~~siesta_forces~~CallsGraph_edge254" class="edge"><title>proc~write_rho&#45;&gt;write_debug</title>
<path fill="none" stroke="#000000" d="M820.552,-4250.52C828.023,-4246.6 835.763,-4241.74 842,-4236 863.777,-4215.97 856.901,-4200.74 878,-4180 881.027,-4177.02 884.454,-4174.23 888.013,-4171.65"/>
<polygon fill="#000000" stroke="#000000" points="890.036,-4174.51 896.43,-4166.06 886.163,-4168.68 890.036,-4174.51"/>
</g>
<!-- proc~write_rho&#45;&gt;de_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge253" class="edge"><title>proc~write_rho&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M820.508,-4273.95C827.898,-4277.85 835.605,-4282.59 842,-4288 862.082,-4305 857.32,-4318.73 878,-4335 910.841,-4360.84 934.589,-4343.32 964,-4373 1002.58,-4411.94 1020.96,-4476.1 1028.34,-4509.78"/>
<polygon fill="#000000" stroke="#000000" points="1024.99,-4510.86 1030.43,-4519.95 1031.84,-4509.45 1024.99,-4510.86"/>
</g>
<!-- proc~write_rho&#45;&gt;io_close -->
<g id="proc~~siesta_forces~~CallsGraph_edge249" class="edge"><title>proc~write_rho&#45;&gt;io_close</title>
<path fill="none" stroke="#000000" d="M820.771,-4257.19C864.552,-4248.99 946.456,-4230.93 964,-4208 1023.19,-4130.63 951.672,-3416.58 1000,-3332 1000.24,-3331.58 1000.5,-3331.16 1000.76,-3330.75"/>
<polygon fill="#000000" stroke="#000000" points="1003.53,-3332.91 1007.72,-3323.18 998.374,-3328.18 1003.53,-3332.91"/>
</g>
<!-- proc~write_rho&#45;&gt;io_assign -->
<g id="proc~~siesta_forces~~CallsGraph_edge250" class="edge"><title>proc~write_rho&#45;&gt;io_assign</title>
<path fill="none" stroke="#000000" d="M817.651,-4249.98C825.592,-4245.83 834.32,-4240.97 842,-4236 859.016,-4224.99 860.347,-4217.96 878,-4208 913.655,-4187.88 940.128,-4208.26 964,-4175 1021.38,-4095.05 951.194,-3375.46 1000,-3290 1000.24,-3289.58 1000.5,-3289.16 1000.76,-3288.75"/>
<polygon fill="#000000" stroke="#000000" points="1003.53,-3290.91 1007.72,-3281.18 998.373,-3286.18 1003.53,-3290.91"/>
</g>
<!-- proc~write_rho&#45;&gt;mpi_barrier -->
<g id="proc~~siesta_forces~~CallsGraph_edge252" class="edge"><title>proc~write_rho&#45;&gt;mpi_barrier</title>
<path fill="none" stroke="#000000" d="M820.614,-4272.64C828.258,-4276.58 836.074,-4281.68 842,-4288 868.66,-4316.45 852.3,-4338.68 878,-4368 880.522,-4370.88 883.442,-4373.54 886.543,-4375.98"/>
<polygon fill="#000000" stroke="#000000" points="884.824,-4379.05 895.029,-4381.9 888.827,-4373.31 884.824,-4379.05"/>
</g>
<!-- mpi_wait -->
<g id="proc~~siesta_forces~~CallsGraph_node183" class="node"><title>mpi_wait</title>
<polygon fill="#777777" stroke="#777777" points="948.5,-4284 893.5,-4284 893.5,-4260 948.5,-4260 948.5,-4284"/>
<text text-anchor="middle" x="921" y="-4269.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_wait</text>
</g>
<!-- proc~write_rho&#45;&gt;mpi_wait -->
<g id="proc~~siesta_forces~~CallsGraph_edge251" class="edge"><title>proc~write_rho&#45;&gt;mpi_wait</title>
<path fill="none" stroke="#000000" d="M820.557,-4264.17C838.946,-4265.62 863.33,-4267.54 883.35,-4269.11"/>
<polygon fill="#000000" stroke="#000000" points="883.123,-4272.61 893.367,-4269.9 883.673,-4265.63 883.123,-4272.61"/>
</g>
<!-- mpi_irecv -->
<g id="proc~~siesta_forces~~CallsGraph_node192" class="node"><title>mpi_irecv</title>
<polygon fill="#777777" stroke="#777777" points="950,-4326 892,-4326 892,-4302 950,-4302 950,-4326"/>
<text text-anchor="middle" x="921" y="-4311.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_irecv</text>
</g>
<!-- proc~write_rho&#45;&gt;mpi_irecv -->
<g id="proc~~siesta_forces~~CallsGraph_edge255" class="edge"><title>proc~write_rho&#45;&gt;mpi_irecv</title>
<path fill="none" stroke="#000000" d="M820.557,-4273.28C838.613,-4280.68 862.45,-4290.44 882.259,-4298.55"/>
<polygon fill="#000000" stroke="#000000" points="881.037,-4301.83 891.617,-4302.38 883.689,-4295.35 881.037,-4301.83"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;timer -->
<g id="proc~~siesta_forces~~CallsGraph_edge260" class="edge"><title>proc~distmeshdata_rea&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M818.035,-4519.9C865.256,-4497.05 962.88,-4449.66 964,-4448 1017.91,-4367.96 1030.33,-3649.32 1032.22,-3512.46"/>
<polygon fill="#000000" stroke="#000000" points="1035.72,-3512.37 1032.35,-3502.32 1028.72,-3512.27 1035.72,-3512.37"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;re_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge259" class="edge"><title>proc~distmeshdata_rea&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M803.208,-4544.08C818.188,-4561.21 847.654,-4592.74 878,-4613 912.753,-4636.2 933.267,-4622.69 964,-4651 995.826,-4680.32 1016.01,-4727.9 1025.69,-4755.44"/>
<polygon fill="#000000" stroke="#000000" points="1022.38,-4756.57 1028.89,-4764.93 1029.01,-4754.34 1022.38,-4756.57"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;write_debug -->
<g id="proc~~siesta_forces~~CallsGraph_edge263" class="edge"><title>proc~distmeshdata_rea&#45;&gt;write_debug</title>
<path fill="none" stroke="#000000" d="M796.155,-4519.79C806.451,-4480.37 840.567,-4353.17 878,-4251 887.73,-4224.44 900.969,-4194.7 909.964,-4175.24"/>
<polygon fill="#000000" stroke="#000000" points="913.186,-4176.61 914.24,-4166.07 906.841,-4173.65 913.186,-4176.61"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;de_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge262" class="edge"><title>proc~distmeshdata_rea&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M842.44,-4532.68C854.102,-4532.81 866.489,-4532.93 878,-4533 916.222,-4533.22 925.779,-4533.28 964,-4533 974.526,-4532.92 985.96,-4532.78 996.417,-4532.63"/>
<polygon fill="#000000" stroke="#000000" points="996.535,-4536.12 1006.48,-4532.47 996.426,-4529.12 996.535,-4536.12"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;proc~die -->
<g id="proc~~siesta_forces~~CallsGraph_edge264" class="edge"><title>proc~distmeshdata_rea&#45;&gt;proc~die</title>
<path fill="none" stroke="#000000" d="M795.884,-4519.9C804.333,-4484.01 829.236,-4374.86 842,-4283 893.311,-3913.73 914.687,-3458.76 919.105,-3354.15"/>
<polygon fill="#000000" stroke="#000000" points="922.603,-3354.27 919.521,-3344.13 915.609,-3353.97 922.603,-3354.27"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;proc~reord -->
<g id="proc~~siesta_forces~~CallsGraph_edge258" class="edge"><title>proc~distmeshdata_rea&#45;&gt;proc~reord</title>
<path fill="none" stroke="#000000" d="M842.102,-4524.27C855.981,-4522.08 870.829,-4519.74 883.8,-4517.7"/>
<polygon fill="#000000" stroke="#000000" points="884.412,-4521.15 893.746,-4516.13 883.323,-4514.23 884.412,-4521.15"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;mpi_barrier -->
<g id="proc~~siesta_forces~~CallsGraph_edge261" class="edge"><title>proc~distmeshdata_rea&#45;&gt;mpi_barrier</title>
<path fill="none" stroke="#000000" d="M804.27,-4519.75C826.355,-4495.76 875.484,-4442.37 902.075,-4413.48"/>
<polygon fill="#000000" stroke="#000000" points="904.74,-4415.75 908.936,-4406.02 899.589,-4411.01 904.74,-4415.75"/>
</g>
<!-- mpitrace_event -->
<g id="proc~~siesta_forces~~CallsGraph_node196" class="node"><title>mpitrace_event</title>
<polygon fill="#777777" stroke="#777777" points="964,-4604 878,-4604 878,-4580 964,-4580 964,-4604"/>
<text text-anchor="middle" x="921" y="-4589.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpitrace_event</text>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;mpitrace_event -->
<g id="proc~~siesta_forces~~CallsGraph_edge256" class="edge"><title>proc~distmeshdata_rea&#45;&gt;mpitrace_event</title>
<path fill="none" stroke="#000000" d="M818.7,-4544.14C837.808,-4553.17 864.095,-4565.59 885.102,-4575.51"/>
<polygon fill="#000000" stroke="#000000" points="883.801,-4578.77 894.338,-4579.88 886.791,-4572.44 883.801,-4578.77"/>
</g>
<!-- proc~boxintersection -->
<g id="proc~~siesta_forces~~CallsGraph_node197" class="node"><title>proc~boxintersection</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node197"><a xlink:href=".././proc/boxintersection.html" xlink:title="boxIntersection">
<polygon fill="#d9534f" stroke="#d9534f" points="963.5,-4684 878.5,-4684 878.5,-4660 963.5,-4660 963.5,-4684"/>
<text text-anchor="middle" x="921" y="-4669.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">boxIntersection</text>
</a>
</g>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;proc~boxintersection -->
<g id="proc~~siesta_forces~~CallsGraph_edge257" class="edge"><title>proc~distmeshdata_rea&#45;&gt;proc~boxintersection</title>
<path fill="none" stroke="#000000" d="M799.936,-4544.15C813.037,-4566.36 843.249,-4614.13 878,-4646 881.2,-4648.93 884.776,-4651.73 888.456,-4654.31"/>
<polygon fill="#000000" stroke="#000000" points="886.812,-4657.42 897.098,-4659.96 890.642,-4651.56 886.812,-4657.42"/>
</g>
<!-- proc~distmeshdata_int&#45;&gt;re_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge265" class="edge"><title>proc~distmeshdata_int&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M837.487,-4724.07C883.352,-4736.52 953.988,-4755.69 996.476,-4767.22"/>
<polygon fill="#000000" stroke="#000000" points="995.814,-4770.67 1006.38,-4769.91 997.648,-4763.91 995.814,-4770.67"/>
</g>
<!-- proc~distmeshdata_int&#45;&gt;de_alloc -->
<g id="proc~~siesta_forces~~CallsGraph_edge267" class="edge"><title>proc~distmeshdata_int&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M839.685,-4718.8C876.919,-4721.61 928.53,-4719.39 964,-4693 1009.08,-4659.46 1024.78,-4590.33 1030.02,-4554.55"/>
<polygon fill="#000000" stroke="#000000" points="1033.55,-4554.57 1031.38,-4544.2 1026.61,-4553.66 1033.55,-4554.57"/>
</g>
<!-- proc~distmeshdata_int&#45;&gt;proc~die -->
<g id="proc~~siesta_forces~~CallsGraph_edge268" class="edge"><title>proc~distmeshdata_int&#45;&gt;proc~die</title>
<path fill="none" stroke="#000000" d="M797.817,-4699.88C808.013,-4673.61 831.684,-4609.25 842,-4553 864.427,-4430.7 911.078,-3510.73 918.882,-3354.51"/>
<polygon fill="#000000" stroke="#000000" points="922.391,-3354.41 919.393,-3344.24 915.4,-3354.06 922.391,-3354.41"/>
</g>
<!-- proc~distmeshdata_int&#45;&gt;proc~boxintersection -->
<g id="proc~~siesta_forces~~CallsGraph_edge266" class="edge"><title>proc~distmeshdata_int&#45;&gt;proc~boxintersection</title>
<path fill="none" stroke="#000000" d="M831.104,-4700C843.921,-4695.96 858.391,-4691.4 871.876,-4687.16"/>
<polygon fill="#000000" stroke="#000000" points="872.997,-4690.47 881.484,-4684.13 870.894,-4683.8 872.997,-4690.47"/>
</g>
<!-- proc~chk -->
<g id="proc~~siesta_forces~~CallsGraph_node198" class="node"><title>proc~chk</title>
<g id="a_proc~~siesta_forces~~CallsGraph_node198"><a xlink:href=".././proc/chk.html" xlink:title="chk">
<polygon fill="#d9534f" stroke="#d9534f" points="819,-3462 765,-3462 765,-3438 819,-3438 819,-3462"/>
<text text-anchor="middle" x="792" y="-3447.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">chk</text>
</a>
</g>
</g>
<!-- proc~rcut&#45;&gt;proc~chk -->
<g id="proc~~siesta_forces~~CallsGraph_edge269" class="edge"><title>proc~rcut&#45;&gt;proc~chk</title>
<path fill="none" stroke="#000000" d="M685.079,-3480.49C705.147,-3474.72 733.102,-3466.67 755.255,-3460.29"/>
<polygon fill="#000000" stroke="#000000" points="756.334,-3463.62 764.975,-3457.49 754.397,-3456.9 756.334,-3463.62"/>
</g>
<!-- proc~chk&#45;&gt;proc~die -->
<g id="proc~~siesta_forces~~CallsGraph_edge270" class="edge"><title>proc~chk&#45;&gt;proc~die</title>
<path fill="none" stroke="#000000" d="M819.066,-3438.5C826.828,-3434.48 835.098,-3429.56 842,-3424 868.029,-3403.05 891.913,-3372.47 906.214,-3352.41"/>
<polygon fill="#000000" stroke="#000000" points="909.228,-3354.21 912.084,-3344.01 903.489,-3350.2 909.228,-3354.21"/>
</g>
</g>
</svg>
</div><script>var panprocsiesta_forcesCallsGraph = svgPanZoom('#procsiesta_forcesCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,-0 209.5,-0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.5,-24 454.5,-24 454.5,-0 551.5,-0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/siesta_forces.html#src">siesta_forces</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>  <span class="k">subroutine </span><span class="n">siesta_forces</span><span class="p">(</span><span class="n">istep</span><span class="p">)</span>
  <span class="c">!! This subroutine represents central SIESTA operation logic.</span>

<span class="cp">#ifdef MPI</span>
    <span class="k">use </span><span class="n">mpi_siesta</span>
<span class="cp">#endif</span>
    <span class="k">use </span><span class="n">units</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">eV</span><span class="p">,</span> <span class="n">Ang</span>
    <span class="k">use </span><span class="nb">precision</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">dp</span>
    <span class="k">use </span><span class="n">sys</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">bye</span>

    <span class="k">use </span><span class="n">files</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">slabel</span>
    <span class="k">use </span><span class="n">siesta_cml</span>
<span class="cp">#ifdef SIESTA__FLOOK</span>
    <span class="k">use </span><span class="n">flook_siesta</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">slua_call</span>
    <span class="k">use </span><span class="n">flook_siesta</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">LUA_INIT_MD</span><span class="p">,</span> <span class="n">LUA_SCF_LOOP</span>
    <span class="k">use </span><span class="n">siesta_dicts</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">dict_variable_add</span>
    <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">ts_scf_mixs</span>
    <span class="k">use </span><span class="n">variable</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">cunpack</span>
<span class="cp">#ifndef NCDF_4</span>
    <span class="k">use </span><span class="n">dictionary</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="k">assign</span>
<span class="cp">#endif</span>
    <span class="k">use </span><span class="n">m_mixing</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">mixers_history_init</span>
<span class="cp">#endif</span>
    <span class="k">use </span><span class="n">m_state_init</span>
    <span class="k">use </span><span class="n">m_setup_hamiltonian</span>
    <span class="k">use </span><span class="n">m_setup_H0</span>
    <span class="k">use </span><span class="n">m_compute_dm</span>
    <span class="k">use </span><span class="n">m_compute_max_diff</span>
    <span class="k">use </span><span class="n">m_scfconvergence_test</span>
    <span class="k">use </span><span class="n">m_post_scf_work</span>
    <span class="k">use </span><span class="n">m_mixer</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">mixer</span>
    <span class="k">use </span><span class="n">m_mixing_scf</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">mixing_scf_converged</span>
    <span class="k">use </span><span class="n">m_mixing_scf</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">mixers_scf_history_init</span>
    <span class="k">use </span><span class="n">m_mixing_scf</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">scf_mixs</span><span class="p">,</span> <span class="n">scf_mix</span>

    <span class="k">use </span><span class="n">m_rhog</span><span class="p">,</span>                <span class="n">only</span><span class="p">:</span> <span class="n">mix_rhog</span><span class="p">,</span> <span class="n">compute_charge_diff</span>
    <span class="k">use </span><span class="n">siesta_options</span>
    <span class="k">use </span><span class="n">parallel</span><span class="p">,</span>     <span class="n">only</span> <span class="p">:</span> <span class="n">IOnode</span><span class="p">,</span> <span class="n">SIESTA_worker</span>
    <span class="k">use </span><span class="n">m_state_analysis</span>
    <span class="k">use </span><span class="n">m_steps</span>
    <span class="k">use </span><span class="n">m_spin</span><span class="p">,</span>                <span class="n">only</span><span class="p">:</span> <span class="n">spin</span>
    <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">DM_2D</span><span class="p">,</span> <span class="n">S_1D</span>
    <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">H</span><span class="p">,</span> <span class="n">Hold</span><span class="p">,</span> <span class="n">Dold</span><span class="p">,</span> <span class="n">Dscf</span><span class="p">,</span> <span class="n">Eold</span><span class="p">,</span> <span class="n">Escf</span><span class="p">,</span> <span class="n">maxnh</span>
    <span class="k">use </span><span class="n">m_convergence</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">converger_t</span>
    <span class="k">use </span><span class="n">m_convergence</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">reset</span><span class="p">,</span> <span class="n">set_tolerance</span>
    <span class="k">use </span><span class="n">siesta_geom</span><span class="p">,</span>   <span class="n">only</span><span class="p">:</span> <span class="n">na_u</span>           <span class="c">! Number of atoms in unit cell</span>
    <span class="k">use </span><span class="n">m_energies</span><span class="p">,</span>    <span class="n">only</span><span class="p">:</span> <span class="n">Etot</span>           <span class="c">! Total energy</span>
    <span class="k">use </span><span class="n">m_forces</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">fa</span><span class="p">,</span> <span class="n">cfa</span>        <span class="c">! Forces and constrained forces</span>
    <span class="k">use </span><span class="n">m_stress</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">cstress</span>        <span class="c">! Constrained stress tensor</span>
    <span class="k">use </span><span class="n">siesta_master</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">forcesToMaster</span> <span class="c">! Send forces to master prog</span>
    <span class="k">use </span><span class="n">siesta_master</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">siesta_server</span>  <span class="c">! Is siesta a server?</span>
    <span class="k">use </span><span class="n">m_save_density_matrix</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">save_density_matrix</span>
    <span class="k">use </span><span class="n">m_iodm_old</span><span class="p">,</span>    <span class="n">only</span><span class="p">:</span> <span class="n">write_spmatrix</span>

    <span class="k">use </span><span class="n">atomlist</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span> <span class="n">Qtot</span>
    <span class="k">use </span><span class="n">m_dm_charge</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">dm_charge</span>

    <span class="k">use </span><span class="n">m_pexsi_solver</span><span class="p">,</span>        <span class="n">only</span><span class="p">:</span> <span class="n">prevDmax</span>
    <span class="k">use </span><span class="n">write_subs</span><span class="p">,</span>            <span class="n">only</span><span class="p">:</span> <span class="n">siesta_write_forces</span>
    <span class="k">use </span><span class="n">write_subs</span><span class="p">,</span>            <span class="n">only</span><span class="p">:</span> <span class="n">siesta_write_stress_pressure</span>

<span class="cp">#ifdef NCDF_4</span>
    <span class="k">use </span><span class="n">dictionary</span>
    <span class="k">use </span><span class="n">m_ncdf_siesta</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">cdf_init_file</span><span class="p">,</span> <span class="n">cdf_save_settings</span>
    <span class="k">use </span><span class="n">m_ncdf_siesta</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">cdf_save_state</span><span class="p">,</span> <span class="n">cdf_save_basis</span>
<span class="cp">#endif</span>
    <span class="k">use </span><span class="n">m_compute_energies</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">compute_energies</span>

    <span class="k">use </span><span class="n">m_mpi_utils</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">broadcast</span><span class="p">,</span> <span class="n">barrier</span>
    <span class="k">use </span><span class="n">fdf</span>
<span class="cp">#ifdef SIESTA__PEXSI</span>
    <span class="k">use </span><span class="n">m_pexsi</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">pexsi_finalize_scfloop</span>
<span class="cp">#endif</span>
    <span class="k">use </span><span class="n">m_check_walltime</span>

    <span class="k">use </span><span class="n">m_energies</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">DE_NEGF</span>
    <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">N_Elec</span>
    <span class="k">use </span><span class="n">m_ts_method</span>
    <span class="k">use </span><span class="n">m_ts_global_vars</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">TSmode</span><span class="p">,</span> <span class="n">TSinit</span><span class="p">,</span> <span class="n">TSrun</span>
    <span class="k">use </span><span class="n">siesta_geom</span><span class="p">,</span>           <span class="n">only</span><span class="p">:</span> <span class="n">nsc</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">ucell</span><span class="p">,</span> <span class="n">isc_off</span>
    <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span>       <span class="n">only</span><span class="p">:</span> <span class="n">sparse_pattern</span><span class="p">,</span> <span class="n">block_dist</span>
    <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span>       <span class="n">only</span><span class="p">:</span> <span class="n">S</span>
    <span class="k">use </span><span class="n">m_ts_charge</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">ts_get_charges</span>
    <span class="k">use </span><span class="n">m_ts_charge</span><span class="p">,</span>           <span class="n">only</span><span class="p">:</span> <span class="n">TS_RHOCORR_METHOD</span>
    <span class="k">use </span><span class="n">m_ts_charge</span><span class="p">,</span>           <span class="n">only</span><span class="p">:</span> <span class="n">TS_RHOCORR_FERMI</span>
    <span class="k">use </span><span class="n">m_ts_charge</span><span class="p">,</span>           <span class="n">only</span><span class="p">:</span> <span class="n">TS_RHOCORR_FERMI_TOLERANCE</span>
    <span class="k">use </span><span class="n">m_transiesta</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">transiesta</span>
    <span class="k">use </span><span class="n">kpoint_scf_m</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">gamma_scf</span>
    <span class="k">use </span><span class="n">m_energies</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">Ef</span>

    <span class="k">use </span><span class="n">m_initwf</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">initwf</span>

    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">istep</span>

    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iscf</span>
    <span class="kt">logical</span> <span class="kd">::</span> <span class="n">first_scf</span><span class="p">,</span> <span class="n">SCFconverged</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dDmax</span> <span class="c">! Max. change in DM elements</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dHmax</span> <span class="c">! Max. change in H elements</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dEmax</span> <span class="c">! Max. change in EDM elements</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">drhog</span> <span class="c">! Max. change in rho(G) (experimental)</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">G2max</span> <span class="c">! actually used meshcutoff</span>
    <span class="k">type</span><span class="p">(</span><span class="n">converger_t</span><span class="p">)</span> <span class="kd">::</span>  <span class="n">conv_harris</span><span class="p">,</span> <span class="n">conv_freeE</span>

    <span class="c">! For initwf</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">istpp</span>

<span class="cp">#ifdef SIESTA__FLOOK</span>
    <span class="c">! len=24 from m_mixing.F90</span>
    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">next_mixer</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nnext_mixer</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">imix</span>
<span class="cp">#endif</span>

    <span class="kt">logical</span>               <span class="kd">::</span> <span class="n">time_is_up</span>
    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">tmp_str</span>

    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Qcur</span>
<span class="cp">#ifdef NCDF_4</span>
    <span class="k">type</span><span class="p">(</span><span class="n">dict</span><span class="p">)</span> <span class="kd">::</span> <span class="n">d_sav</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef MPI</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">MPIerror</span>
<span class="cp">#endif</span>

    <span class="k">external</span> <span class="kd">::</span> <span class="n">die</span><span class="p">,</span> <span class="n">message</span>

<span class="cp">#ifdef DEBUG</span>
    <span class="k">call </span><span class="n">write_debug</span><span class="p">(</span> <span class="s1">&#39;    PRE siesta_forces&#39;</span> <span class="p">)</span>
<span class="cp">#endif</span>

<span class="cp">#ifdef SIESTA__PEXSI</span>
    <span class="c">! Broadcast relevant things for program logic</span>
    <span class="c">! These were set in read_options, called only by &quot;SIESTA_workers&quot;.</span>
    <span class="k">call </span><span class="n">broadcast</span><span class="p">(</span><span class="n">nscf</span><span class="p">,</span> <span class="n">comm</span><span class="o">=</span><span class="n">true_MPI_Comm_World</span><span class="p">)</span>
<span class="cp">#endif</span>

    <span class="c">!  Initialization tasks for a given geometry:</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">SIESTA_worker</span> <span class="p">)</span>  <span class="k">then</span>
<span class="k">       call </span><span class="n">state_init</span><span class="p">(</span> <span class="n">istep</span> <span class="p">)</span>
    <span class="k">end if</span>

<span class="cp">#ifdef SIESTA__PEXSI</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ionode</span><span class="p">)</span> <span class="k">call </span><span class="n">memory_snapshot</span><span class="p">(</span><span class="s2">&quot;after state_init&quot;</span><span class="p">)</span>
<span class="cp">#endif</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">fdf_get</span><span class="p">(</span><span class="s2">&quot;Sonly&quot;</span><span class="p">,.</span><span class="n">false</span><span class="p">.)</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">       if</span> <span class="p">(</span> <span class="n">SIESTA_worker</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">          call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="mi">2</span> <span class="p">)</span>
          <span class="k">call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="mi">3</span> <span class="p">)</span>
       <span class="k">end if</span>
<span class="k">       call </span><span class="n">bye</span><span class="p">(</span><span class="s2">&quot;S only&quot;</span><span class="p">)</span>
    <span class="k">end if</span>

<span class="k">    </span><span class="n">Qcur</span> <span class="o">=</span> <span class="n">Qtot</span>
    
<span class="cp">#ifdef SIESTA__FLOOK</span>
    <span class="c">! Add the iscf constant to the list of variables</span>
    <span class="c">! that are available only in this part of the routine.</span>
    <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.iteration&#39;</span><span class="p">,</span><span class="n">iscf</span><span class="p">)</span>
    <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.converged&#39;</span><span class="p">,</span><span class="n">SCFconverged</span><span class="p">)</span>
    <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.charge&#39;</span><span class="p">,</span><span class="n">Qcur</span><span class="p">)</span>
    <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.dD&#39;</span><span class="p">,</span><span class="n">dDmax</span><span class="p">)</span>
    <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.dH&#39;</span><span class="p">,</span><span class="n">dHmax</span><span class="p">)</span>
    <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.dE&#39;</span><span class="p">,</span><span class="n">dEmax</span><span class="p">)</span>
    <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.drhoG&#39;</span><span class="p">,</span><span class="n">drhog</span><span class="p">)</span>
    <span class="c">! We have to set the meshcutoff here</span>
    <span class="c">! because the asked and required ones are not</span>
    <span class="c">! necessarily the same</span>
    <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;Mesh.Cutoff.Minimum&#39;</span><span class="p">,</span><span class="n">G2cut</span><span class="p">)</span>
    <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;Mesh.Cutoff.Used&#39;</span><span class="p">,</span><span class="n">G2max</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">mix_charge</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">      call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Weight&#39;</span><span class="p">,</span> <span class="n">wmix</span><span class="p">)</span>
    <span class="k">else</span>
<span class="k">      call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Weight&#39;</span><span class="p">,</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">w</span><span class="p">)</span>
      <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Restart&#39;</span><span class="p">,</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">restart</span><span class="p">)</span>
      <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Iterations&#39;</span><span class="p">,</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">n_itt</span><span class="p">)</span>
      
      <span class="c">! Just to populate the table in the dictionary</span>
      <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Switch&#39;</span><span class="p">,</span><span class="n">next_mixer</span><span class="p">)</span>
    <span class="k">end if</span>

    <span class="c">! Initialize to no switch</span>
    <span class="n">next_mixer</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
<span class="cp">#endif</span>

    <span class="c">!  This call computes the **non-scf** part of \( H \) and initializes the</span>
    <span class="c">!  real-space grid structures:</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">SIESTA_worker</span> <span class="p">)</span> <span class="k">call </span><span class="n">setup_H0</span><span class="p">(</span><span class="n">G2max</span><span class="p">)</span>
    <span class="c">!!@todo</span>
    <span class="c">!* It might be better to split the two,</span>
    <span class="c">!  putting the grid initialization into **state_init (link!)** and moving the</span>
    <span class="c">!  calculation of \( H_0 \) to the body of the loop, done `if first_scf=.true.`</span>
    <span class="c">!  This would suit _analysis_ runs in which **nscf = 0**</span>
    <span class="c">!!@endtodo</span>

<span class="cp">#ifdef SIESTA__PEXSI</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ionode</span><span class="p">)</span> <span class="k">call </span><span class="n">memory_snapshot</span><span class="p">(</span><span class="s2">&quot;after setup_H0&quot;</span><span class="p">)</span>
<span class="cp">#endif</span>

<span class="cp">#ifdef SIESTA__FLOOK</span>
    <span class="c">! Communicate with lua, just before entering the SCF loop</span>
    <span class="c">! This is mainly to be able to communicate</span>
    <span class="c">! mesh-related quantities (g2max)</span>
    <span class="k">call </span><span class="n">slua_call</span><span class="p">(</span><span class="n">LUA</span><span class="p">,</span> <span class="n">LUA_INIT_MD</span><span class="p">)</span>
<span class="cp">#endif</span>

<span class="cp">#ifdef NCDF_4</span>
    <span class="c">! Initialize the NC file</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">write_cdf</span> <span class="p">)</span> <span class="k">then</span>

       <span class="c">! Initialize the file...</span>
       <span class="k">call </span><span class="n">cdf_init_file</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.nc&#39;</span><span class="p">,</span><span class="n">is_MD</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.)</span>
<span class="cp">#ifdef MPI</span>
       <span class="k">call </span><span class="n">MPI_Barrier</span><span class="p">(</span><span class="n">MPI_Comm_World</span><span class="p">,</span><span class="n">MPIerror</span><span class="p">)</span>
<span class="cp">#endif</span>

       <span class="c">! Save the settings</span>
       <span class="k">call </span><span class="n">cdf_save_settings</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.nc&#39;</span><span class="p">)</span>
<span class="cp">#ifdef MPI</span>
       <span class="k">call </span><span class="n">MPI_Barrier</span><span class="p">(</span><span class="n">MPI_Comm_World</span><span class="p">,</span><span class="n">MPIerror</span><span class="p">)</span>
<span class="cp">#endif</span>
       
       <span class="n">d_sav</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;sp&#39;</span><span class="p">.</span><span class="n">kv</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">.</span><span class="n">kv</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">d_sav</span> <span class="o">=</span> <span class="n">d_sav</span><span class="o">//</span><span class="p">(</span><span class="s1">&#39;nsc&#39;</span><span class="p">.</span><span class="n">kv</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="p">(</span><span class="s1">&#39;xij&#39;</span><span class="p">.</span><span class="n">kv</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">d_sav</span> <span class="o">=</span> <span class="n">d_sav</span><span class="o">//</span><span class="p">(</span><span class="s1">&#39;xa&#39;</span><span class="p">.</span><span class="n">kv</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="p">(</span><span class="s1">&#39;cell&#39;</span><span class="p">.</span><span class="n">kv</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">d_sav</span> <span class="o">=</span> <span class="n">d_sav</span><span class="o">//</span><span class="p">(</span><span class="s1">&#39;isc_off&#39;</span><span class="p">.</span><span class="n">kv</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span>
       <span class="k">call </span><span class="n">cdf_save_state</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.nc&#39;</span><span class="p">,</span><span class="n">d_sav</span><span class="p">)</span>
       <span class="k">call </span><span class="n">delete</span><span class="p">(</span><span class="n">d_sav</span><span class="p">)</span>

       <span class="c">! Save the basis set</span>
       <span class="k">call </span><span class="n">cdf_save_basis</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">slabel</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.nc&#39;</span><span class="p">)</span>

    <span class="k">end if</span>
<span class="cp">#endif</span>

    <span class="c">!* The dHmax variable only has meaning for Hamiltonian</span>
    <span class="c">!  mixing, or when requiring the Hamiltonian to be converged.</span>
    <span class="n">dDmax</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1._dp</span>
    <span class="n">dHmax</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1._dp</span>
    <span class="n">dEmax</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1._dp</span>
    <span class="n">drhog</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1._dp</span>

    <span class="c">! Setup convergence criteria:</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">SIESTA_worker</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">       if</span> <span class="p">(</span> <span class="n">converge_Eharr</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">          call </span><span class="n">reset</span><span class="p">(</span><span class="n">conv_harris</span><span class="p">)</span>
          <span class="k">call </span><span class="n">set_tolerance</span><span class="p">(</span><span class="n">conv_harris</span><span class="p">,</span><span class="n">tolerance_Eharr</span><span class="p">)</span>
       <span class="k">end if</span>
<span class="k">       if</span> <span class="p">(</span> <span class="n">converge_FreeE</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">          call </span><span class="n">reset</span><span class="p">(</span><span class="n">conv_FreeE</span><span class="p">)</span>
          <span class="k">call </span><span class="n">set_tolerance</span><span class="p">(</span><span class="n">conv_FreeE</span><span class="p">,</span><span class="n">tolerance_FreeE</span><span class="p">)</span>
       <span class="k">end if</span>
<span class="k">    end if</span>

    <span class="c">!!# SCF loop</span>
    <span class="c">!* The current structure of the loop tries to reproduce the</span>
    <span class="c">!  historical Siesta usage. It should be made more clear.</span>

    <span class="c">!* Two changes:</span>
    <span class="c">!</span>
    <span class="c">!  1. The number of scf iterations performed is exactly</span>
    <span class="c">!     equal to the number specified (i.e., the &quot;forces&quot;</span>
    <span class="c">!     phase is not counted as a final scf step)</span>
    <span class="c">!  2. At the change to a TranSiesta GF run the variable &quot;first_scf&quot;</span>
    <span class="c">!     is implicitly reset to &quot;true&quot;.</span>
    <span class="c">!</span>

    <span class="c">!!## Start of SCF cycle</span>
    <span class="c">!</span>
    <span class="c">!* Conditions of exit:</span>
    <span class="c">!</span>
    <span class="c">!  * At the top, to catch a non-positive nscf and # of iterations</span>
    <span class="c">!  * At the bottom, based on convergence</span>
    <span class="c">!</span>
    <span class="n">iscf</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">do while</span> <span class="p">(</span> <span class="n">iscf</span> <span class="o">&lt;</span> <span class="n">nscf</span> <span class="p">)</span>

       <span class="n">iscf</span> <span class="o">=</span> <span class="n">iscf</span> <span class="o">+</span> <span class="mi">1</span>

       <span class="c">!* Note implications for TranSiesta when mixing \(H\).</span>
       <span class="c">!  Now \(H\) will be recomputed instead of simply being</span>
       <span class="c">!  inherited, however, this is required as if</span>
       <span class="c">!  we have bias calculations as the electric</span>
       <span class="c">!  field across the junction needs to be present.</span>

       <span class="n">first_scf</span> <span class="o">=</span> <span class="p">(</span><span class="n">iscf</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>

       <span class="k">if</span> <span class="p">(</span> <span class="n">SIESTA_worker</span> <span class="p">)</span> <span class="k">then</span>

          <span class="c">! Check whether we are short of time to continue</span>
          <span class="k">call </span><span class="n">check_walltime</span><span class="p">(</span><span class="n">time_is_up</span><span class="p">)</span>
          <span class="k">if</span> <span class="p">(</span> <span class="n">time_is_up</span> <span class="p">)</span> <span class="k">then</span>
             <span class="c">! Save DM/H if we were not saving it...</span>
             <span class="c">!   Do any other bookeeping not done by &quot;die&quot;</span>
             <span class="k">call </span><span class="n">timer</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
             <span class="k">call </span><span class="n">timer</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
             <span class="k">call </span><span class="n">message</span><span class="p">(</span><span class="s1">&#39;WARNING&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
                  <span class="s1">&#39;SCF_NOT_CONV: SCF did not converge&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
                  <span class="s1">&#39; before wall time exhaustion&#39;</span><span class="p">)</span>
             <span class="k">write</span><span class="p">(</span><span class="n">tmp_str</span><span class="p">,</span><span class="s2">&quot;(2(i5,tr1),f12.6)&quot;</span><span class="p">)</span> <span class="n">istep</span><span class="p">,</span> <span class="n">iscf</span><span class="p">,</span> <span class="n">prevDmax</span>
             <span class="k">call </span><span class="n">message</span><span class="p">(</span><span class="s1">&#39; (info)&#39;</span><span class="p">,</span><span class="s2">&quot;Geom step, scf iteration, dmax:&quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">tmp_str</span><span class="p">))</span>
             
             <span class="k">call </span><span class="n">barrier</span><span class="p">()</span> <span class="c">! A non-root node might get first to the &#39;die&#39; call</span>
             <span class="k">call </span><span class="n">die</span><span class="p">(</span><span class="s2">&quot;OUT_OF_TIME: Time is up.&quot;</span><span class="p">)</span>

          <span class="k">end if</span>

<span class="k">          call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;IterSCF&#39;</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">cml_p</span><span class="p">)</span> <span class="p">&amp;</span>
               <span class="k">call </span><span class="n">cmlStartStep</span><span class="p">(</span> <span class="n">xf</span><span class="o">=</span><span class="n">mainXML</span><span class="p">,</span> <span class="k">type</span><span class="o">=</span><span class="s1">&#39;SCF&#39;</span><span class="p">,</span> <span class="nb">index</span><span class="o">=</span><span class="n">iscf</span> <span class="p">)</span>

          <span class="k">if</span> <span class="p">(</span> <span class="n">mixH</span> <span class="p">)</span> <span class="k">then</span>

<span class="k">             if</span> <span class="p">(</span> <span class="n">first_scf</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">                if</span> <span class="p">(</span><span class="n">fdf_get</span><span class="p">(</span><span class="s2">&quot;Read-H-from-file&quot;</span><span class="p">,.</span><span class="n">false</span><span class="p">.))</span> <span class="k">then</span>
<span class="k">                   call </span><span class="n">get_H_from_file</span><span class="p">()</span>
                <span class="k">else</span>
<span class="k">                   call </span><span class="n">setup_hamiltonian</span><span class="p">(</span> <span class="n">iscf</span> <span class="p">)</span>
                <span class="k">end if</span>
<span class="k">             end if</span>

<span class="k">             call </span><span class="n">compute_DM</span><span class="p">(</span> <span class="n">iscf</span> <span class="p">)</span>

             <span class="c">! Maybe set Dold to zero if reading charge or H...</span>
             <span class="k">call </span><span class="n">compute_max_diff</span><span class="p">(</span><span class="n">Dold</span><span class="p">,</span> <span class="n">Dscf</span><span class="p">,</span> <span class="n">dDmax</span><span class="p">)</span>
             <span class="k">if</span> <span class="p">(</span> <span class="n">converge_EDM</span> <span class="p">)</span> <span class="p">&amp;</span>
                  <span class="k">call </span><span class="n">compute_max_diff</span><span class="p">(</span><span class="n">Eold</span><span class="p">,</span> <span class="n">Escf</span><span class="p">,</span> <span class="n">dEmax</span><span class="p">)</span>
             <span class="k">call </span><span class="n">setup_hamiltonian</span><span class="p">(</span> <span class="n">iscf</span> <span class="p">)</span>
             <span class="k">call </span><span class="n">compute_max_diff</span><span class="p">(</span><span class="n">Hold</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">dHmax</span><span class="p">)</span>

          <span class="k">else</span>

<span class="k">             call </span><span class="n">setup_hamiltonian</span><span class="p">(</span> <span class="n">iscf</span> <span class="p">)</span>
             <span class="k">call </span><span class="n">compute_max_diff</span><span class="p">(</span><span class="n">Hold</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">dHmax</span><span class="p">)</span>

             <span class="k">call </span><span class="n">compute_DM</span><span class="p">(</span> <span class="n">iscf</span> <span class="p">)</span>

             <span class="k">call </span><span class="n">compute_max_diff</span><span class="p">(</span><span class="n">Dold</span><span class="p">,</span> <span class="n">Dscf</span><span class="p">,</span> <span class="n">dDmax</span><span class="p">)</span>
             <span class="k">if</span> <span class="p">(</span> <span class="n">converge_EDM</span> <span class="p">)</span> <span class="p">&amp;</span>
                  <span class="k">call </span><span class="n">compute_max_diff</span><span class="p">(</span><span class="n">Eold</span><span class="p">,</span> <span class="n">Escf</span><span class="p">,</span> <span class="n">dEmax</span><span class="p">)</span>

          <span class="k">end if</span>

          <span class="c">! This iteration has completed calculating the new DM</span>

          <span class="k">call </span><span class="n">compute_energies</span><span class="p">(</span> <span class="n">iscf</span> <span class="p">)</span>
          <span class="k">if</span> <span class="p">(</span> <span class="n">mix_charge</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">             call </span><span class="n">compute_charge_diff</span><span class="p">(</span> <span class="n">drhog</span> <span class="p">)</span>
          <span class="k">end if</span>

          <span class="c">! Note: For DM and H convergence checks. At this point:</span>
          <span class="c">! If mixing the DM:</span>
          <span class="c">!        Dscf=DM_out, Dold=DM_in(mixed), H=H_in, Hold=H_in(prev step)</span>
          <span class="c">!        dDmax=maxdiff(DM_out,DM_in)</span>
          <span class="c">!        dHmax=maxdiff(H_in - H_in(prev step))</span>
          <span class="c">! If mixing the Hamiltonian:</span>
          <span class="c">!        Dscf=DM_out, Dold=DM_in, H=H_(DM_out), Hold=H_in(mixed)</span>
          <span class="c">!        dDmax=maxdiff(DM_out,DM_in)</span>
          <span class="c">!        dHmax=maxdiff(H(DM_out),H_in)</span>
          <span class="k">call </span><span class="n">scfconvergence_test</span><span class="p">(</span> <span class="n">first_scf</span><span class="p">,</span> <span class="n">iscf</span><span class="p">,</span> <span class="p">&amp;</span>
               <span class="n">dDmax</span><span class="p">,</span> <span class="n">dHmax</span><span class="p">,</span> <span class="n">dEmax</span><span class="p">,</span> <span class="p">&amp;</span>
               <span class="n">conv_harris</span><span class="p">,</span> <span class="n">conv_freeE</span><span class="p">,</span> <span class="p">&amp;</span>
               <span class="n">SCFconverged</span> <span class="p">)</span>

          <span class="c">! ** Check this heuristic</span>
          <span class="k">if</span> <span class="p">(</span> <span class="n">mixH</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">             </span><span class="n">prevDmax</span> <span class="o">=</span> <span class="n">dHmax</span>
          <span class="k">else</span>
<span class="k">             </span><span class="n">prevDmax</span> <span class="o">=</span> <span class="n">dDmax</span>
          <span class="k">end if</span>

          <span class="c">! Calculate current charge based on the density matrix</span>
          <span class="k">call </span><span class="n">dm_charge</span><span class="p">(</span><span class="n">spin</span><span class="p">,</span> <span class="n">DM_2D</span><span class="p">,</span> <span class="n">S_1D</span><span class="p">,</span> <span class="n">Qcur</span><span class="p">)</span>


          <span class="c">! Check whether we should step to the next mixer</span>
          <span class="k">call </span><span class="n">mixing_scf_converged</span><span class="p">(</span> <span class="n">SCFconverged</span> <span class="p">)</span>

          <span class="k">if</span> <span class="p">(</span> <span class="n">SCFconverged</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">iscf</span> <span class="o">&lt;</span> <span class="n">min_nscf</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">             </span><span class="n">SCFconverged</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
             <span class="k">if</span> <span class="p">(</span> <span class="n">IONode</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">                write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s2">&quot;(a,i0)&quot;</span><span class="p">)</span> <span class="p">&amp;</span>
                     <span class="s2">&quot;SCF cycle continued for minimum number of iterations: &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">min_nscf</span>
             <span class="k">end if</span>
<span class="k">          end if</span>

          <span class="c">! In case the user has requested a Fermi-level correction</span>
          <span class="c">! Then we start by correcting the fermi-level</span>
          <span class="k">if</span> <span class="p">(</span> <span class="n">TSrun</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">SCFconverged</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
               <span class="n">TS_RHOCORR_METHOD</span> <span class="o">==</span> <span class="n">TS_RHOCORR_FERMI</span> <span class="p">)</span> <span class="k">then</span>

<span class="k">             if</span> <span class="p">(</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Qcur</span> <span class="o">-</span> <span class="n">Qtot</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">TS_RHOCORR_FERMI_TOLERANCE</span> <span class="p">)</span> <span class="k">then</span>

                <span class="c">! Call transiesta with fermi-correct</span>
                <span class="k">call </span><span class="n">transiesta</span><span class="p">(</span><span class="n">iscf</span><span class="p">,</span><span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">block_dist</span><span class="p">,</span> <span class="n">sparse_pattern</span><span class="p">,</span> <span class="n">Gamma_Scf</span><span class="p">,</span> <span class="n">ucell</span><span class="p">,</span> <span class="n">nsc</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">isc_off</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">Dscf</span><span class="p">,</span> <span class="n">Escf</span><span class="p">,</span> <span class="n">Ef</span><span class="p">,</span> <span class="n">Qtot</span><span class="p">,</span> <span class="p">.</span><span class="n">true</span><span class="p">.,</span> <span class="n">DE_NEGF</span><span class="p">)</span>

                <span class="c">! We will not have not converged as we have just</span>
                <span class="c">! changed the Fermi-level</span>
                <span class="n">SCFconverged</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>

             <span class="k">end if</span>

<span class="k">          end if</span>

<span class="k">          if</span> <span class="p">(</span> <span class="n">monitor_forces_in_scf</span> <span class="p">)</span> <span class="k">call </span><span class="n">compute_forces</span><span class="p">()</span>

          <span class="c">! Mix_after_convergence preserves the old behavior of</span>
          <span class="c">! the program.</span>
          <span class="k">if</span> <span class="p">(</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SCFconverged</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">mix_after_convergence</span><span class="p">)</span> <span class="k">then</span>

             <span class="c">! Mix for next step</span>
             <span class="k">if</span> <span class="p">(</span> <span class="n">mix_charge</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">                call </span><span class="n">mix_rhog</span><span class="p">(</span> <span class="n">iscf</span> <span class="p">)</span>
             <span class="k">else</span>
<span class="k">                call </span><span class="n">mixer</span><span class="p">(</span> <span class="n">iscf</span> <span class="p">)</span>
             <span class="k">end if</span>

             <span class="c">! Save for possible restarts</span>
             <span class="k">if</span> <span class="p">(</span> <span class="n">mixH</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">                call </span><span class="n">write_spmatrix</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="k">file</span><span class="o">=</span><span class="s2">&quot;H_MIXED&quot;</span><span class="p">,</span><span class="n">when</span><span class="o">=</span><span class="n">writeH</span><span class="p">)</span>
                <span class="k">call </span><span class="n">save_density_matrix</span><span class="p">(</span><span class="k">file</span><span class="o">=</span><span class="s2">&quot;DM_OUT&quot;</span><span class="p">,</span><span class="n">when</span><span class="o">=</span><span class="n">writeDM</span><span class="p">)</span>
             <span class="k">else</span>
<span class="k">                call </span><span class="n">save_density_matrix</span><span class="p">(</span><span class="k">file</span><span class="o">=</span><span class="s2">&quot;DM_MIXED&quot;</span><span class="p">,</span><span class="n">when</span><span class="o">=</span><span class="n">writeDM</span><span class="p">)</span>
                <span class="k">call </span><span class="n">write_spmatrix</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="k">file</span><span class="o">=</span><span class="s2">&quot;H_DMGEN&quot;</span><span class="p">,</span><span class="n">when</span><span class="o">=</span><span class="n">writeH</span><span class="p">)</span>
             <span class="k">end if</span>
<span class="k">          end if</span>

<span class="k">          call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;IterSCF&#39;</span><span class="p">,</span> <span class="mi">2</span> <span class="p">)</span>
          <span class="k">call </span><span class="n">print_timings</span><span class="p">(</span> <span class="n">first_scf</span><span class="p">,</span> <span class="n">istep</span> <span class="o">==</span> <span class="n">inicoor</span> <span class="p">)</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">cml_p</span><span class="p">)</span> <span class="k">call </span><span class="n">cmlEndStep</span><span class="p">(</span><span class="n">mainXML</span><span class="p">)</span>

<span class="cp">#ifdef SIESTA__FLOOK</span>
          <span class="c">! Communicate with lua</span>
          <span class="k">call </span><span class="n">slua_call</span><span class="p">(</span><span class="n">LUA</span><span class="p">,</span> <span class="n">LUA_SCF_LOOP</span><span class="p">)</span>

          <span class="c">! Retrieve an easy character string</span>
          <span class="n">nnext_mixer</span> <span class="o">=</span> <span class="n">cunpack</span><span class="p">(</span><span class="n">next_mixer</span><span class="p">)</span>
          <span class="k">if</span> <span class="p">(</span> <span class="nb">len_trim</span><span class="p">(</span><span class="n">nnext_mixer</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">mix_charge</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">             if</span> <span class="p">(</span> <span class="n">TSrun</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">                do </span><span class="n">imix</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">ts_scf_mixs</span><span class="p">)</span>
                   <span class="k">if</span> <span class="p">(</span> <span class="n">ts_scf_mixs</span><span class="p">(</span><span class="n">imix</span><span class="p">)%</span><span class="n">name</span> <span class="o">==</span> <span class="n">nnext_mixer</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">                      call </span><span class="n">mixers_history_init</span><span class="p">(</span><span class="n">ts_scf_mixs</span><span class="p">)</span>
                      <span class="n">scf_mix</span> <span class="o">=&gt;</span> <span class="n">ts_scf_mixs</span><span class="p">(</span><span class="n">imix</span><span class="p">)</span>
                      <span class="k">exit</span>
<span class="k">                   end if</span>
<span class="k">                end do</span>
<span class="k">             else</span>
<span class="k">                do </span><span class="n">imix</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">scf_mixs</span><span class="p">)</span>
                   <span class="k">if</span> <span class="p">(</span> <span class="n">scf_mixs</span><span class="p">(</span><span class="n">imix</span><span class="p">)%</span><span class="n">name</span> <span class="o">==</span> <span class="n">nnext_mixer</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">                      call </span><span class="n">mixers_history_init</span><span class="p">(</span><span class="n">scf_mixs</span><span class="p">)</span>
                      <span class="n">scf_mix</span> <span class="o">=&gt;</span> <span class="n">scf_mixs</span><span class="p">(</span><span class="n">imix</span><span class="p">)</span>
                      <span class="k">exit</span>
<span class="k">                   end if</span>
<span class="k">                end do</span>
<span class="k">             end if</span>

             <span class="c">! Check that we indeed have changed the mixer</span>
             <span class="k">if</span> <span class="p">(</span> <span class="n">IONode</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">scf_mix</span><span class="p">%</span><span class="n">name</span> <span class="o">/=</span> <span class="n">nnext_mixer</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">                write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(2a)&#39;</span><span class="p">)</span> <span class="s1">&#39;siesta-lua: WARNING: trying to change &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="s1">&#39;to a non-existing mixer! Not changing anything!&#39;</span>

             <span class="k">else if</span> <span class="p">(</span> <span class="n">IONode</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">                write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(2a)&#39;</span><span class="p">)</span> <span class="s1">&#39;siesta-lua: Switching mixer method to: &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="nb">trim</span><span class="p">(</span><span class="n">nnext_mixer</span><span class="p">)</span>

             <span class="k">end if</span>
             <span class="c">! Reset for next loop</span>
             <span class="n">next_mixer</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>

             <span class="c">! Update the references</span>
             <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Weight&#39;</span><span class="p">,</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">w</span><span class="p">)</span>
             <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Restart&#39;</span><span class="p">,</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">restart</span><span class="p">)</span>
             <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Iterations&#39;</span><span class="p">,</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">n_itt</span><span class="p">)</span>

          <span class="k">end if</span>
<span class="cp">#endif</span>

          <span class="c">! ... except that we might continue for TranSiesta</span>
          <span class="k">if</span> <span class="p">(</span> <span class="n">SCFconverged</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">             call </span><span class="n">transiesta_switch</span><span class="p">()</span>
             <span class="c">! might reset SCFconverged and iscf</span>
          <span class="k">end if</span>

<span class="k">       else</span>

          <span class="c">! non-siesta worker</span>
          <span class="k">call </span><span class="n">compute_DM</span><span class="p">(</span> <span class="n">iscf</span> <span class="p">)</span>

       <span class="k">end if</span>

<span class="cp">#ifdef SIESTA__PEXSI</span>
       <span class="k">call </span><span class="n">broadcast</span><span class="p">(</span><span class="n">iscf</span><span class="p">,</span> <span class="n">comm</span><span class="o">=</span><span class="n">true_MPI_Comm_World</span><span class="p">)</span>
       <span class="k">call </span><span class="n">broadcast</span><span class="p">(</span><span class="n">SCFconverged</span><span class="p">,</span> <span class="n">comm</span><span class="o">=</span><span class="n">true_MPI_Comm_World</span><span class="p">)</span>
<span class="cp">#endif</span>

       <span class="c">!  Exit if converged:</span>
       <span class="k">if</span> <span class="p">(</span> <span class="n">SCFconverged</span> <span class="p">)</span> <span class="k">exit</span>

<span class="k">    end do</span>
    <span class="c">!! **end of SCF cycle**</span>

<span class="cp">#ifdef SIESTA__PEXSI</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">isolve</span> <span class="o">==</span> <span class="n">SOLVE_PEXSI</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">       call </span><span class="n">pexsi_finalize_scfloop</span><span class="p">()</span>
    <span class="k">end if</span>
<span class="cp">#endif</span>

    <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SIESTA_worker</span> <span class="p">)</span> <span class="k">return</span>

<span class="k">    call </span><span class="n">end_of_cycle_save_operations</span><span class="p">()</span>

    <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SCFconverged</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">       if</span> <span class="p">(</span> <span class="n">SCFMustConverge</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">          call </span><span class="n">message</span><span class="p">(</span><span class="s1">&#39;FATAL&#39;</span><span class="p">,</span><span class="s1">&#39;SCF_NOT_CONV: SCF did not converge&#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
               <span class="s1">&#39; in maximum number of steps (required).&#39;</span><span class="p">)</span>
          <span class="k">write</span><span class="p">(</span><span class="n">tmp_str</span><span class="p">,</span><span class="s2">&quot;(2(i5,tr1),f12.6)&quot;</span><span class="p">)</span> <span class="n">istep</span><span class="p">,</span> <span class="n">iscf</span><span class="p">,</span> <span class="n">prevDmax</span>
          <span class="k">call </span><span class="n">message</span><span class="p">(</span><span class="s1">&#39; (info)&#39;</span><span class="p">,</span><span class="s2">&quot;Geom step, scf iteration, dmax:&quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">tmp_str</span><span class="p">))</span>
          <span class="k">call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="mi">2</span> <span class="p">)</span> <span class="c">! New call to close the tree</span>
          <span class="k">call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="mi">3</span> <span class="p">)</span>
          <span class="k">call </span><span class="n">barrier</span><span class="p">()</span>
          <span class="k">call </span><span class="n">die</span><span class="p">(</span><span class="s1">&#39;ABNORMAL_TERMINATION&#39;</span><span class="p">)</span>
       <span class="k">else if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">harrisfun</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">          call </span><span class="n">message</span><span class="p">(</span><span class="s1">&#39;WARNING&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
               <span class="s1">&#39;SCF_NOT_CONV: SCF did not converge  in maximum number of steps.&#39;</span><span class="p">)</span>
          <span class="k">write</span><span class="p">(</span><span class="n">tmp_str</span><span class="p">,</span><span class="s2">&quot;(2(i5,tr1),f12.6)&quot;</span><span class="p">)</span> <span class="n">istep</span><span class="p">,</span> <span class="n">iscf</span><span class="p">,</span> <span class="n">prevDmax</span>
          <span class="k">call </span><span class="n">message</span><span class="p">(</span><span class="s1">&#39; (info)&#39;</span><span class="p">,</span><span class="s2">&quot;Geom step, scf iteration, dmax:&quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">tmp_str</span><span class="p">))</span>
       <span class="k">end if</span>
<span class="k">    end if</span>

    <span class="c">! To write the initial wavefunctions to be used in a</span>
    <span class="c">! consequent TDDFT run.</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">writetdwf</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">       </span><span class="n">istpp</span> <span class="o">=</span> <span class="mi">0</span>
       <span class="k">call </span><span class="n">initwf</span><span class="p">(</span><span class="n">istpp</span><span class="p">,</span><span class="n">totime</span><span class="p">)</span>
    <span class="k">end if</span>
<span class="k">    </span>
<span class="k">    if</span> <span class="p">(</span> <span class="n">TSmode</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">TSinit</span><span class="p">.</span><span class="nb">and</span><span class="p">.(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SCFConverged</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
       <span class="c">! Signal that the DM hasn&#39;t converged, so we cannot</span>
       <span class="c">! continue to the transiesta routines</span>
       <span class="k">call </span><span class="n">die</span><span class="p">(</span><span class="s1">&#39;ABNORMAL_TERMINATION&#39;</span><span class="p">)</span>
    <span class="k">end if</span>
    
    <span class="c">! Clean-up here to limit memory usage</span>
    <span class="k">call </span><span class="n">mixers_scf_history_init</span><span class="p">(</span> <span class="p">)</span>
    
    <span class="c">! End of standard SCF loop.</span>
    <span class="c">! Do one more pass to compute forces and stresses</span>
    
    <span class="c">! Note that this call will no longer overwrite H while computing the</span>
    <span class="c">! final energies, forces and stresses...</span>
    
    <span class="k">if</span> <span class="p">(</span> <span class="n">fdf_get</span><span class="p">(</span><span class="s2">&quot;compute-forces&quot;</span><span class="p">,.</span><span class="n">true</span><span class="p">.)</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">       call </span><span class="n">post_scf_work</span><span class="p">(</span> <span class="n">istep</span><span class="p">,</span> <span class="n">iscf</span> <span class="p">,</span> <span class="n">SCFconverged</span> <span class="p">)</span>
<span class="cp">#ifdef SIESTA__PEXSI</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">ionode</span><span class="p">)</span> <span class="k">call </span><span class="n">memory_snapshot</span><span class="p">(</span><span class="s2">&quot;after post_scf_work&quot;</span><span class="p">)</span>
<span class="cp">#endif</span>
    <span class="k">end if</span>
    
    <span class="c">! ... so H at this point is the latest generator of the DM, except</span>
    <span class="c">! if mixing H beyond self-consistency or terminating the scf loop</span>
    <span class="c">! without convergence while mixing H</span>
    
    <span class="k">call </span><span class="n">state_analysis</span><span class="p">(</span> <span class="n">istep</span> <span class="p">)</span>
<span class="cp">#ifdef SIESTA__PEXSI</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ionode</span><span class="p">)</span> <span class="k">call </span><span class="n">memory_snapshot</span><span class="p">(</span><span class="s2">&quot;after state_analysis&quot;</span><span class="p">)</span>
<span class="cp">#endif</span>

    <span class="c">! If siesta is running as a subroutine, send forces to master program</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">siesta_server</span><span class="p">)</span> <span class="p">&amp;</span>
         <span class="k">call </span><span class="n">forcesToMaster</span><span class="p">(</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">Etot</span><span class="p">,</span> <span class="n">cfa</span><span class="p">,</span> <span class="n">cstress</span> <span class="p">)</span>

<span class="cp">#ifdef DEBUG</span>
    <span class="k">call </span><span class="n">write_debug</span><span class="p">(</span> <span class="s1">&#39;    POS siesta_forces&#39;</span> <span class="p">)</span>
<span class="cp">#endif</span>
    
  <span class="k">contains</span>

    <span class="c">! Read the Hamiltonian from a file</span>
    <span class="k">subroutine </span><span class="n">get_H_from_file</span><span class="p">()</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">listhptr</span>
      <span class="k">use </span><span class="n">atomlist</span><span class="p">,</span>        <span class="n">only</span><span class="p">:</span> <span class="n">no_l</span>
      <span class="k">use </span><span class="n">m_spin</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">spin</span>
      <span class="k">use </span><span class="n">m_iodm_old</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">read_spmatrix</span>

      <span class="kt">logical</span> <span class="kd">::</span> <span class="n">found</span>

      <span class="k">call </span><span class="n">read_spmatrix</span><span class="p">(</span><span class="n">maxnh</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="p">&amp;</span>
           <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">userfile</span><span class="o">=</span><span class="s2">&quot;H_IN&quot;</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">found</span><span class="p">)</span> <span class="k">call </span><span class="n">die</span><span class="p">(</span><span class="s2">&quot;Could not find H_IN&quot;</span><span class="p">)</span>

    <span class="k">end subroutine </span><span class="n">get_H_from_file</span>

    <span class="c">! Computes forces and stresses with the current DM_out</span>
    <span class="k">subroutine </span><span class="n">compute_forces</span><span class="p">()</span>

      <span class="k">use </span><span class="n">siesta_options</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">recompute_H_after_scf</span>
      <span class="k">use </span><span class="n">m_final_H_f_stress</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">final_H_f_stress</span>
      <span class="k">use </span><span class="n">write_subs</span>

      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">fa_old</span><span class="p">(:,:),</span> <span class="n">Hsave</span><span class="p">(:,:)</span>

      <span class="k">allocate</span><span class="p">(</span><span class="n">fa_old</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">fa</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">fa</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)))</span>
      <span class="n">fa_old</span><span class="p">(:,:)</span> <span class="o">=</span> <span class="n">fa</span><span class="p">(:,:)</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">recompute_H_after_scf</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">         allocate</span><span class="p">(</span><span class="n">Hsave</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)))</span>
         <span class="n">Hsave</span><span class="p">(:,:)</span> <span class="o">=</span> <span class="n">H</span><span class="p">(:,:)</span>
      <span class="k">end if</span>
<span class="k">      call </span><span class="n">final_H_f_stress</span><span class="p">(</span> <span class="n">istep</span> <span class="p">,</span> <span class="n">iscf</span> <span class="p">,</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">recompute_H_after_scf</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">         </span><span class="n">H</span><span class="p">(:,:)</span> <span class="o">=</span> <span class="n">Hsave</span><span class="p">(:,:)</span>
         <span class="k">deallocate</span><span class="p">(</span><span class="n">Hsave</span><span class="p">)</span>
      <span class="k">end if</span>
<span class="k">      if</span> <span class="p">(</span><span class="n">ionode</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         print</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;Max diff in force (eV/Ang): &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
              <span class="nb">maxval</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">fa</span><span class="o">-</span><span class="n">fa_old</span><span class="p">))</span><span class="o">*</span><span class="n">Ang</span><span class="o">/</span><span class="n">eV</span>
         <span class="k">call </span><span class="n">siesta_write_forces</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
         <span class="k">call </span><span class="n">siesta_write_stress_pressure</span><span class="p">()</span>
      <span class="n">endif</span>
      <span class="k">deallocate</span><span class="p">(</span><span class="n">fa_old</span><span class="p">)</span>

    <span class="k">end subroutine </span><span class="n">compute_forces</span>

    <span class="c">! Print out timings of the first SCF loop only</span>
    <span class="k">subroutine </span><span class="n">print_timings</span><span class="p">(</span><span class="n">first_scf</span><span class="p">,</span> <span class="n">first_md</span><span class="p">)</span>
      <span class="k">use </span><span class="n">timer_options</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">use_tree_timer</span>
      <span class="k">use </span><span class="n">m_ts_global_vars</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">TSrun</span>
      <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">first_scf</span><span class="p">,</span> <span class="n">first_md</span>
      <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="kd">::</span> <span class="n">routine</span>

      <span class="c">! If this is not the first iteration,</span>
      <span class="c">! we immediately return.</span>
      <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">first_scf</span> <span class="p">)</span> <span class="k">return</span>
<span class="k">      if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">first_md</span> <span class="p">)</span> <span class="k">return</span>

<span class="k">      </span><span class="n">routine</span> <span class="o">=</span> <span class="s1">&#39;IterSCF&#39;</span>

      <span class="k">if</span> <span class="p">(</span> <span class="n">TSrun</span> <span class="p">)</span> <span class="k">then</span>
         <span class="c">! with Green function generation</span>
         <span class="c">! The tree-timer requires direct</span>
         <span class="c">! children of the routine to be</span>
         <span class="c">! queried.</span>
         <span class="c">! This is not obeyed in the TS case... :(</span>
         <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">use_tree_timer</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            </span><span class="n">routine</span> <span class="o">=</span> <span class="s1">&#39;TS&#39;</span>
         <span class="k">end if</span>
<span class="k">      </span><span class="n">endif</span>
      <span class="k">call </span><span class="n">timer</span><span class="p">(</span> <span class="n">routine</span><span class="p">,</span> <span class="mi">3</span> <span class="p">)</span>

    <span class="k">end subroutine </span><span class="n">print_timings</span>

    <span class="c">! Depending on various conditions, save the DMin</span>
    <span class="c">! or the DMout, and possibly keep a copy of H</span>

    <span class="c">! NOTE: Only if the scf cycle converged before exit it</span>
    <span class="c">! is guaranteed that the DM is &quot;pure out&quot; and that</span>
    <span class="c">! we can recover the right H if mixing H.</span>
    <span class="c">!</span>
    <span class="k">subroutine </span><span class="n">end_of_cycle_save_operations</span><span class="p">()</span>

      <span class="kt">logical</span> <span class="kd">::</span> <span class="n">DM_write</span><span class="p">,</span> <span class="n">H_write</span>

      <span class="c">! Depending on the option we should overwrite the</span>
      <span class="c">! Hamiltonian</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">mixH</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">mix_after_convergence</span> <span class="p">)</span> <span class="k">then</span>
         <span class="c">! Make sure that we keep the H actually used</span>
         <span class="c">! to generate the last DM, if needed.</span>
         <span class="n">H</span> <span class="o">=</span> <span class="n">Hold</span>
      <span class="k">end if</span>

<span class="k">      </span><span class="n">DM_write</span> <span class="o">=</span> <span class="n">write_DM_at_end_of_cycle</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
           <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">writeDM</span>
      <span class="n">H_write</span> <span class="o">=</span> <span class="n">write_H_at_end_of_cycle</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
           <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">writeH</span>

      <span class="k">if</span> <span class="p">(</span> <span class="n">mix_after_convergence</span> <span class="p">)</span> <span class="k">then</span>
         <span class="c">! If we have been saving them, there is no point in doing</span>
         <span class="c">! it one more time</span>
         <span class="k">if</span> <span class="p">(</span> <span class="n">mixH</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            call </span><span class="n">save_density_matrix</span><span class="p">(</span><span class="k">file</span><span class="o">=</span><span class="s2">&quot;DM_OUT&quot;</span><span class="p">,</span> <span class="n">when</span><span class="o">=</span><span class="n">DM_write</span><span class="p">)</span>
            <span class="k">call </span><span class="n">write_spmatrix</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="k">file</span><span class="o">=</span><span class="s2">&quot;H_MIXED&quot;</span><span class="p">,</span> <span class="n">when</span><span class="o">=</span><span class="n">H_write</span><span class="p">)</span>
         <span class="k">else</span>
<span class="k">            call </span><span class="n">save_density_matrix</span><span class="p">(</span><span class="k">file</span><span class="o">=</span><span class="s2">&quot;DM_MIXED&quot;</span><span class="p">,</span> <span class="n">when</span><span class="o">=</span><span class="n">DM_write</span><span class="p">)</span>
            <span class="k">call </span><span class="n">write_spmatrix</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="k">file</span><span class="o">=</span><span class="s2">&quot;H_DMGEN&quot;</span><span class="p">,</span> <span class="n">when</span><span class="o">=</span><span class="n">H_write</span><span class="p">)</span>
         <span class="k">end if</span>
<span class="k">      else</span>
<span class="k">         call </span><span class="n">save_density_matrix</span><span class="p">(</span><span class="k">file</span><span class="o">=</span><span class="s2">&quot;DM_OUT&quot;</span><span class="p">,</span> <span class="n">when</span><span class="o">=</span><span class="n">DM_write</span><span class="p">)</span>
         <span class="k">call </span><span class="n">write_spmatrix</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="k">file</span><span class="o">=</span><span class="s2">&quot;H_DMGEN&quot;</span><span class="p">,</span> <span class="n">when</span><span class="o">=</span><span class="n">H_write</span><span class="p">)</span>
      <span class="k">end if</span>

<span class="k">    end subroutine </span><span class="n">end_of_cycle_save_operations</span>

    <span class="k">subroutine </span><span class="n">transiesta_switch</span><span class="p">()</span>

      <span class="k">use </span><span class="nb">precision</span><span class="p">,</span>             <span class="n">only</span><span class="p">:</span> <span class="n">dp</span>
      <span class="k">use </span><span class="n">parallel</span><span class="p">,</span>              <span class="n">only</span><span class="p">:</span> <span class="n">IONode</span>
      <span class="k">use </span><span class="n">class_dSpData2D</span>
      <span class="k">use </span><span class="n">class_Fstack_dData1D</span>
      <span class="k">use </span><span class="n">densematrix</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">resetDenseMatrix</span>

      <span class="k">use </span><span class="n">siesta_options</span><span class="p">,</span>        <span class="n">only</span><span class="p">:</span> <span class="n">fire_mix</span><span class="p">,</span> <span class="n">broyden_maxit</span>
      <span class="k">use </span><span class="n">siesta_options</span><span class="p">,</span>        <span class="n">only</span><span class="p">:</span> <span class="n">dDtol</span><span class="p">,</span> <span class="n">dHtol</span>

      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">DM_2D</span><span class="p">,</span> <span class="n">EDM_2D</span>
      <span class="k">use </span><span class="n">atomlist</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">lasto</span>
      <span class="k">use </span><span class="n">siesta_geom</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">nsc</span><span class="p">,</span> <span class="n">isc_off</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">ucell</span>
      <span class="k">use </span><span class="n">m_energies</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">Ef</span>
      <span class="k">use </span><span class="n">m_mixing</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">mixers_history_init</span>
      <span class="k">use </span><span class="n">m_mixing_scf</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">scf_mix</span><span class="p">,</span> <span class="n">scf_mixs</span>
      <span class="k">use </span><span class="n">m_rhog</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">resetRhoG</span>

      <span class="k">use </span><span class="n">m_ts_global_vars</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">TSinit</span><span class="p">,</span> <span class="n">TSrun</span>
      <span class="k">use </span><span class="n">m_ts_global_vars</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">ts_print_transiesta</span>
      <span class="k">use </span><span class="n">m_ts_method</span>
      <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">N_Elec</span><span class="p">,</span> <span class="n">Elecs</span>
      <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">DM_bulk</span>
      <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">val_swap</span>
      <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">ts_Dtol</span><span class="p">,</span> <span class="n">ts_Htol</span>
      <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">ts_hist_keep</span>
      <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">ts_siesta_stop</span>
      <span class="k">use </span><span class="n">m_ts_options</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">ts_scf_mixs</span>
      <span class="k">use </span><span class="n">m_ts_electype</span>

      <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iEl</span><span class="p">,</span> <span class="n">na_a</span>
      <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">allowed_a</span><span class="p">(:)</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">DM</span><span class="p">(:,:),</span> <span class="n">EDM</span><span class="p">(:,:)</span>

      <span class="c">! We are done with the initial diagon run</span>
      <span class="c">! Now we start the TRANSIESTA (Green functions) run</span>
      <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">TSmode</span> <span class="p">)</span> <span class="k">return</span>
<span class="k">      if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">TSinit</span> <span class="p">)</span> <span class="k">return</span>

      <span class="c">! whether we are in siesta initialization step</span>
      <span class="n">TSinit</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
      <span class="c">! whether transiesta is running</span>
      <span class="n">TSrun</span>  <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>

      <span class="c">! If transiesta should stop immediately</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">ts_siesta_stop</span> <span class="p">)</span> <span class="k">then</span>

<span class="k">         if</span> <span class="p">(</span> <span class="n">IONode</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(a)&#39;</span><span class="p">)</span> <span class="s1">&#39;ts: Stopping transiesta (user option)!&#39;</span>
         <span class="k">end if</span>

<span class="k">         return</span>

<span class="k">      end if</span>

      <span class="c">! Reduce memory requirements</span>
      <span class="k">call </span><span class="n">resetDenseMatrix</span><span class="p">()</span>

      <span class="c">! Signal to continue...</span>
      <span class="c">! These two variables are from the top-level</span>
      <span class="c">! routine (siesta_forces)</span>
      <span class="n">SCFconverged</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
      <span class="n">iscf</span> <span class="o">=</span> <span class="mi">0</span>

      <span class="c">! DANGER (when/if going back to the DIAGON run, we should</span>
      <span class="c">! re-instantiate the original mixing value)</span>
      <span class="k">call </span><span class="n">val_swap</span><span class="p">(</span><span class="n">dDtol</span><span class="p">,</span> <span class="n">ts_Dtol</span><span class="p">)</span>
      <span class="k">call </span><span class="n">val_swap</span><span class="p">(</span><span class="n">dHtol</span><span class="p">,</span> <span class="n">ts_Htol</span><span class="p">)</span>

      <span class="c">! Clean up mixing history</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">mix_charge</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">resetRhoG</span><span class="p">(.</span><span class="n">true</span><span class="p">.)</span>
      <span class="k">else</span>
<span class="k">        if</span> <span class="p">(</span> <span class="nb">associated</span><span class="p">(</span><span class="n">ts_scf_mixs</span><span class="p">,</span> <span class="k">target</span><span class="o">=</span><span class="n">scf_mixs</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">          do </span><span class="n">iel</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">stack</span><span class="p">)</span>
            <span class="k">call </span><span class="n">reset</span><span class="p">(</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">stack</span><span class="p">(</span><span class="n">iel</span><span class="p">),</span> <span class="o">-</span><span class="n">ts_hist_keep</span><span class="p">)</span>
            <span class="c">! Reset iteration count as certain</span>
            <span class="c">! mixing schemes require this for consistency</span>
            <span class="n">scf_mix</span><span class="p">%</span><span class="n">cur_itt</span> <span class="o">=</span> <span class="n">n_items</span><span class="p">(</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">stack</span><span class="p">(</span><span class="n">iel</span><span class="p">))</span>
          <span class="k">end do</span>
<span class="k">        else</span>
<span class="k">          call </span><span class="n">mixers_history_init</span><span class="p">(</span><span class="n">scf_mixs</span><span class="p">)</span>
        <span class="k">end if</span>
<span class="k">      end if</span>
      
      <span class="c">! Transfer scf_mixing to the transiesta mixing routine</span>
      <span class="n">scf_mix</span> <span class="o">=&gt;</span> <span class="n">ts_scf_mixs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="cp">#ifdef SIESTA__FLOOK</span>
      <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">mix_charge</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Weight&#39;</span><span class="p">,</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">w</span><span class="p">)</span>
         <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Restart&#39;</span><span class="p">,</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">restart</span><span class="p">)</span>
         <span class="k">call </span><span class="n">dict_variable_add</span><span class="p">(</span><span class="s1">&#39;SCF.Mixer.Iterations&#39;</span><span class="p">,</span><span class="n">scf_mix</span><span class="p">%</span><span class="n">n_itt</span><span class="p">)</span>
      <span class="k">end if</span>
<span class="cp">#endif</span>

      <span class="k">call </span><span class="n">ts_print_transiesta</span><span class="p">()</span>

      <span class="c">! In case of transiesta and DM_bulk.</span>
      <span class="c">! In case we ask for initialization of the DM in bulk</span>
      <span class="c">! we read in the DM files from the electrodes and</span>
      <span class="c">! initialize the bulk to those values</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">DM_bulk</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">then</span>

<span class="k">         if</span> <span class="p">(</span> <span class="n">IONode</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(/,2a)&#39;</span><span class="p">)</span> <span class="s1">&#39;transiesta: &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
                 <span class="s1">&#39;Initializing bulk DM in electrodes.&#39;</span>
         <span class="k">end if</span>

<span class="k">         </span><span class="n">na_a</span> <span class="o">=</span> <span class="mi">0</span>
         <span class="k">do </span><span class="n">iEl</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">na_u</span>
            <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">a_isDev</span><span class="p">(</span><span class="n">iEl</span><span class="p">)</span> <span class="p">)</span> <span class="n">na_a</span> <span class="o">=</span> <span class="n">na_a</span> <span class="o">+</span> <span class="mi">1</span>
         <span class="k">end do</span>
<span class="k">         allocate</span><span class="p">(</span><span class="n">allowed_a</span><span class="p">(</span><span class="n">na_a</span><span class="p">))</span>
         <span class="n">na_a</span> <span class="o">=</span> <span class="mi">0</span>
         <span class="k">do </span><span class="n">iEl</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">na_u</span>
            <span class="c">! We allow the buffer atoms as well (this will even out the</span>
            <span class="c">! potential around the back of the electrode)</span>
            <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">a_isDev</span><span class="p">(</span><span class="n">iEl</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">               </span><span class="n">na_a</span> <span class="o">=</span> <span class="n">na_a</span> <span class="o">+</span> <span class="mi">1</span>
               <span class="n">allowed_a</span><span class="p">(</span><span class="n">na_a</span><span class="p">)</span> <span class="o">=</span> <span class="n">iEl</span>
            <span class="k">end if</span>
<span class="k">         end do</span>

<span class="k">         do </span><span class="n">iEl</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">N_Elec</span>

            <span class="k">if</span> <span class="p">(</span> <span class="n">IONode</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">               write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(/,2a)&#39;</span><span class="p">)</span> <span class="s1">&#39;transiesta: &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
                    <span class="s1">&#39;Reading in electrode TSDE for &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
                    <span class="nb">trim</span><span class="p">(</span><span class="n">Elecs</span><span class="p">(</span><span class="n">iEl</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
            <span class="k">end if</span>

            <span class="c">! Copy over the DM in the lead</span>
            <span class="c">! Notice that the EDM matrix that is copied over</span>
            <span class="c">! will be equivalent at Ef == 0</span>
            <span class="k">call </span><span class="n">copy_DM</span><span class="p">(</span><span class="n">Elecs</span><span class="p">(</span><span class="n">iEl</span><span class="p">),</span><span class="n">na_u</span><span class="p">,</span><span class="n">xa</span><span class="p">,</span><span class="n">lasto</span><span class="p">,</span><span class="n">nsc</span><span class="p">,</span><span class="n">isc_off</span><span class="p">,</span> <span class="p">&amp;</span>
                 <span class="n">ucell</span><span class="p">,</span> <span class="n">DM_2D</span><span class="p">,</span> <span class="n">EDM_2D</span><span class="p">,</span> <span class="n">na_a</span><span class="p">,</span> <span class="n">allowed_a</span><span class="p">)</span>

         <span class="k">end do</span>

         <span class="c">! Clean-up</span>
         <span class="k">deallocate</span><span class="p">(</span><span class="n">allowed_a</span><span class="p">)</span>

         <span class="k">if</span> <span class="p">(</span> <span class="n">IONode</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="c">! new-line</span>
         <span class="k">end if</span>

         <span class="c">! The electrode EDM is aligned at Ef == 0</span>
         <span class="c">! We need to align the energy matrix</span>
         <span class="n">DM</span>  <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">DM_2D</span><span class="p">)</span>
         <span class="n">EDM</span> <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">EDM_2D</span><span class="p">)</span>
         <span class="n">iEl</span> <span class="o">=</span>  <span class="n">size</span><span class="p">(</span><span class="n">DM</span><span class="p">)</span>
         <span class="k">call </span><span class="n">daxpy</span><span class="p">(</span><span class="n">iEl</span><span class="p">,</span><span class="n">Ef</span><span class="p">,</span><span class="n">DM</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">EDM</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>

      <span class="k">end if</span>

<span class="k">    end subroutine </span><span class="n">transiesta_switch</span>

  <span class="k">end subroutine </span><span class="n">siesta_forces</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2018 <a rel="license" href="http://www.gnu.org/licenses/old-licenses/fdl-1.2.en.html">GNU Free Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> SIESTA was developed by SIESTA Group</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>