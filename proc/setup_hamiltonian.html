<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="A first-principles materials simulation code using Density Functional Theory.">
    
    <meta name="author" content="SIESTA Group" >
    <link rel="icon" href="../favicon.png">

    <title>setup_hamiltonian &ndash; SIESTA</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">SIESTA <small>trunk-700--vdikan-edens-710-ford-681</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>Program Overview</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>setup_hamiltonian
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 2.0% of total for procedures.">167 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/setup_hamiltonian.F"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/setup_hamiltonian.f.html'>setup_hamiltonian.F</a></li>
    
     <li><a href='../module/m_setup_hamiltonian.html'>m_setup_hamiltonian</a></li>
    
  
     <li class="active">setup_hamiltonian</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/setup_hamiltonian.html#src">setup_hamiltonian</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine setup_hamiltonian(iscf)
    
    
   
</h2>
    
  
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
      
      <li class="list-group-item">
  <ul class="list-inline">
    
    <li><a href='../module/siesta_options.html'>siesta_options</a></li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>class_dSpData1D</li>
    
    <li>class_dSpData2D</li>
    
    <li>class_zSpData2D</li>
    
    <li>siesta_geom</li>
    
    <li><a href='../module/atmfuncs.html'>atmfuncs</a></li>
    
    <li>atomlist</li>
    
    <li>metaforce</li>
    
    <li>molecularmechanics</li>
    
    <li>ldau_specs</li>
    
    <li>m_ldau</li>
    
    <li><a href='../module/m_dhscf.html'>m_dhscf</a></li>
    
    <li>m_stress</li>
    
    <li>m_energies</li>
    
    <li><a href='../module/parallel.html'>parallel</a></li>
    
    <li>m_steps</li>
    
    <li>m_ntm</li>
    
    <li>m_spin</li>
    
    <li>m_dipol</li>
    
    <li>alloc</li>
    
    <li>m_gamma</li>
    
    <li>m_hsx</li>
    
    <li><a href='../module/sys.html'>sys</a></li>
    
    <li>m_partial_charges</li>
    
    <li>files</li>
    
    <li><a href='../module/m_rhog.html'>m_rhog</a></li>
    
    <li>m_mpi_utils</li>
    
  </ul>
      </li>
      
      
      
      <li class="list-group-item">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~setup_hamiltonian~~UsesGraph Pages: 1 -->
<svg id="procsetup_hamiltonianUsesGraph" width="634pt" height="1158pt"
 viewBox="0.00 0.00 634.00 1158.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~setup_hamiltonian~~UsesGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 1154)">
<title>proc~~setup_hamiltonian~~UsesGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1154 630,-1154 630,4 -4,4"/>
<!-- proc~setup_hamiltonian -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node1" class="node"><title>proc~setup_hamiltonian</title>
<polygon fill="none" stroke="black" points="626,-591 526,-591 526,-567 626,-567 626,-591"/>
<text text-anchor="middle" x="576" y="-576.6" font-family="Helvetica,sans-Serif" font-size="10.50">setup_hamiltonian</text>
</g>
<!-- m_partial_charges -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node2" class="node"><title>m_partial_charges</title>
<polygon fill="#337ab7" stroke="#337ab7" points="485.5,-1150 384.5,-1150 384.5,-1126 485.5,-1126 485.5,-1150"/>
<text text-anchor="middle" x="435" y="-1135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_partial_charges</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;m_partial_charges -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge1" class="edge"><title>proc~setup_hamiltonian&#45;&gt;m_partial_charges</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M574.673,-591.425C572.533,-663.936 558.383,-1032.14 490,-1117 489.29,-1117.88 488.538,-1118.73 487.749,-1119.53"/>
<polygon fill="#000000" stroke="#000000" points="485.413,-1116.92 479.792,-1125.9 489.787,-1122.39 485.413,-1116.92"/>
</g>
<!-- ldau_specs -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node3" class="node"><title>ldau_specs</title>
<polygon fill="#337ab7" stroke="#337ab7" points="468.5,-1108 401.5,-1108 401.5,-1084 468.5,-1084 468.5,-1108"/>
<text text-anchor="middle" x="435" y="-1093.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ldau_specs</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;ldau_specs -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge2" class="edge"><title>proc~setup_hamiltonian&#45;&gt;ldau_specs</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M574.495,-591.348C571.442,-660.297 553.413,-997.35 490,-1075 486.666,-1079.08 482.433,-1082.37 477.811,-1085.03"/>
<polygon fill="#000000" stroke="#000000" points="476.126,-1081.95 468.573,-1089.38 479.111,-1088.28 476.126,-1081.95"/>
</g>
<!-- module~parallel -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node4" class="node"><title>module~parallel</title>
<g id="a_proc~~setup_hamiltonian~~UsesGraph_node4"><a xlink:href=".././module/parallel.html" xlink:title="parallel">
<polygon fill="#337ab7" stroke="#337ab7" points="462,-1066 408,-1066 408,-1042 462,-1042 462,-1066"/>
<text text-anchor="middle" x="435" y="-1051.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel</text>
</a>
</g>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;module~parallel -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge3" class="edge"><title>proc~setup_hamiltonian&#45;&gt;module~parallel</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M574.293,-591.15C570.286,-656.151 548.493,-962.487 490,-1033 485.187,-1038.8 478.565,-1043.01 471.605,-1046.05"/>
<polygon fill="#000000" stroke="#000000" points="470.246,-1042.82 462.043,-1049.53 472.637,-1049.4 470.246,-1042.82"/>
</g>
<!-- m_energies -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node5" class="node"><title>m_energies</title>
<polygon fill="#337ab7" stroke="#337ab7" points="469.5,-1024 400.5,-1024 400.5,-1000 469.5,-1000 469.5,-1024"/>
<text text-anchor="middle" x="435" y="-1009.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_energies</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;m_energies -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge4" class="edge"><title>proc~setup_hamiltonian&#45;&gt;m_energies</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M573.919,-591.001C568.272,-651.37 540.489,-921.477 490,-986 486.796,-990.095 482.785,-993.581 478.405,-996.542"/>
<polygon fill="#000000" stroke="#000000" points="476.548,-993.572 469.641,-1001.61 480.05,-999.633 476.548,-993.572"/>
</g>
<!-- module~sys -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node6" class="node"><title>module~sys</title>
<g id="a_proc~~setup_hamiltonian~~UsesGraph_node6"><a xlink:href=".././module/sys.html" xlink:title="sys">
<polygon fill="#337ab7" stroke="#337ab7" points="297.5,-1105 243.5,-1105 243.5,-1081 297.5,-1081 297.5,-1105"/>
<text text-anchor="middle" x="270.5" y="-1090.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sys</text>
</a>
</g>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;module~sys -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge5" class="edge"><title>proc~setup_hamiltonian&#45;&gt;module~sys</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M573.802,-591.281C567.893,-649.488 540.112,-897.097 490,-953 455.475,-991.515 418.106,-956.024 380,-991 350.977,-1017.64 373.689,-1046.1 344,-1072 333.87,-1080.84 320.218,-1085.96 307.492,-1088.93"/>
<polygon fill="#000000" stroke="#000000" points="306.707,-1085.52 297.57,-1090.88 308.058,-1092.39 306.707,-1085.52"/>
</g>
<!-- m_ldau -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node7" class="node"><title>m_ldau</title>
<polygon fill="#337ab7" stroke="#337ab7" points="462,-780 408,-780 408,-756 462,-756 462,-780"/>
<text text-anchor="middle" x="435" y="-765.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ldau</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;m_ldau -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge6" class="edge"><title>proc~setup_hamiltonian&#45;&gt;m_ldau</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M572.017,-591.434C564.042,-622.119 539.393,-702.202 490,-747 484.744,-751.767 478.283,-755.502 471.682,-758.411"/>
<polygon fill="#000000" stroke="#000000" points="470.12,-755.261 462.033,-762.106 472.624,-761.798 470.12,-755.261"/>
</g>
<!-- m_steps -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node8" class="node"><title>m_steps</title>
<polygon fill="#337ab7" stroke="#337ab7" points="462,-738 408,-738 408,-714 462,-714 462,-738"/>
<text text-anchor="middle" x="435" y="-723.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_steps</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;m_steps -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge7" class="edge"><title>proc~setup_hamiltonian&#45;&gt;m_steps</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M569.84,-591.2C558.766,-616.009 530.406,-672.717 490,-705 484.562,-709.345 478.117,-712.876 471.608,-715.714"/>
<polygon fill="#000000" stroke="#000000" points="470.191,-712.51 462.136,-719.393 472.725,-719.036 470.191,-712.51"/>
</g>
<!-- class_dSpData2D -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node9" class="node"><title>class_dSpData2D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="483.5,-696 386.5,-696 386.5,-672 483.5,-672 483.5,-696"/>
<text text-anchor="middle" x="435" y="-681.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_dSpData2D</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;class_dSpData2D -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge8" class="edge"><title>proc~setup_hamiltonian&#45;&gt;class_dSpData2D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M565.501,-591.145C550.954,-609.039 521.51,-642.572 490,-663 487.547,-664.59 484.955,-666.09 482.287,-667.5"/>
<polygon fill="#000000" stroke="#000000" points="480.521,-664.465 473.016,-671.944 483.547,-670.777 480.521,-664.465"/>
</g>
<!-- siesta_geom -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node10" class="node"><title>siesta_geom</title>
<polygon fill="#337ab7" stroke="#337ab7" points="471.5,-654 398.5,-654 398.5,-630 471.5,-630 471.5,-654"/>
<text text-anchor="middle" x="435" y="-639.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_geom</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;siesta_geom -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge9" class="edge"><title>proc~setup_hamiltonian&#45;&gt;siesta_geom</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M551.811,-591.148C534.868,-599.853 511.24,-611.644 490,-621 486.116,-622.711 482.046,-624.428 477.957,-626.103"/>
<polygon fill="#000000" stroke="#000000" points="476.436,-622.942 468.457,-629.912 479.041,-629.439 476.436,-622.942"/>
</g>
<!-- m_stress -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node11" class="node"><title>m_stress</title>
<polygon fill="#337ab7" stroke="#337ab7" points="463,-612 407,-612 407,-588 463,-588 463,-612"/>
<text text-anchor="middle" x="435" y="-597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_stress</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;m_stress -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge10" class="edge"><title>proc~setup_hamiltonian&#45;&gt;m_stress</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M525.994,-586.404C508.682,-589.019 489.507,-591.916 473.321,-594.362"/>
<polygon fill="#000000" stroke="#000000" points="472.53,-590.941 463.165,-595.896 473.576,-597.863 472.53,-590.941"/>
</g>
<!-- m_ntm -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node12" class="node"><title>m_ntm</title>
<polygon fill="#337ab7" stroke="#337ab7" points="462,-570 408,-570 408,-546 462,-546 462,-570"/>
<text text-anchor="middle" x="435" y="-555.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ntm</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;m_ntm -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge11" class="edge"><title>proc~setup_hamiltonian&#45;&gt;m_ntm</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M525.994,-571.596C508.426,-568.942 488.939,-565.998 472.604,-563.53"/>
<polygon fill="#000000" stroke="#000000" points="472.787,-560.018 462.376,-561.985 471.741,-566.94 472.787,-560.018"/>
</g>
<!-- m_mpi_utils -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node13" class="node"><title>m_mpi_utils</title>
<polygon fill="#337ab7" stroke="#337ab7" points="470,-528 400,-528 400,-504 470,-504 470,-528"/>
<text text-anchor="middle" x="435" y="-513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_mpi_utils</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;m_mpi_utils -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge12" class="edge"><title>proc~setup_hamiltonian&#45;&gt;m_mpi_utils</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M551.811,-566.852C534.868,-558.147 511.24,-546.356 490,-537 486.116,-535.289 482.046,-533.572 477.957,-531.897"/>
<polygon fill="#000000" stroke="#000000" points="479.041,-528.561 468.457,-528.088 476.436,-535.058 479.041,-528.561"/>
</g>
<!-- molecularmechanics -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node14" class="node"><title>molecularmechanics</title>
<polygon fill="#337ab7" stroke="#337ab7" points="490,-486 380,-486 380,-462 490,-462 490,-486"/>
<text text-anchor="middle" x="435" y="-471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">molecularmechanics</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;molecularmechanics -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge27" class="edge"><title>proc~setup_hamiltonian&#45;&gt;molecularmechanics</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M565.501,-566.855C550.954,-548.961 521.51,-515.428 490,-495 487.547,-493.41 484.955,-491.91 482.287,-490.5"/>
<polygon fill="#000000" stroke="#000000" points="483.547,-487.223 473.016,-486.056 480.521,-493.535 483.547,-487.223"/>
</g>
<!-- files -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node15" class="node"><title>files</title>
<polygon fill="#337ab7" stroke="#337ab7" points="462,-444 408,-444 408,-420 462,-420 462,-444"/>
<text text-anchor="middle" x="435" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">files</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;files -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge14" class="edge"><title>proc~setup_hamiltonian&#45;&gt;files</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M569.84,-566.8C558.766,-541.991 530.406,-485.283 490,-453 484.562,-448.655 478.117,-445.124 471.608,-442.286"/>
<polygon fill="#000000" stroke="#000000" points="472.725,-438.964 462.136,-438.607 470.191,-445.49 472.725,-438.964"/>
</g>
<!-- m_hsx -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node16" class="node"><title>m_hsx</title>
<polygon fill="#337ab7" stroke="#337ab7" points="462,-402 408,-402 408,-378 462,-378 462,-402"/>
<text text-anchor="middle" x="435" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_hsx</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;m_hsx -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge15" class="edge"><title>proc~setup_hamiltonian&#45;&gt;m_hsx</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M572.017,-566.566C564.042,-535.881 539.393,-455.798 490,-411 484.744,-406.233 478.283,-402.498 471.682,-399.589"/>
<polygon fill="#000000" stroke="#000000" points="472.624,-396.202 462.033,-395.894 470.12,-402.739 472.624,-396.202"/>
</g>
<!-- module~siesta_options -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node17" class="node"><title>module~siesta_options</title>
<g id="a_proc~~setup_hamiltonian~~UsesGraph_node17"><a xlink:href=".././module/siesta_options.html" xlink:title="siesta_options">
<polygon fill="#337ab7" stroke="#337ab7" points="475.5,-360 394.5,-360 394.5,-336 475.5,-336 475.5,-360"/>
<text text-anchor="middle" x="435" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_options</text>
</a>
</g>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;module~siesta_options -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge16" class="edge"><title>proc~setup_hamiltonian&#45;&gt;module~siesta_options</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M573.485,-566.967C568.423,-531.653 548.944,-427.141 490,-369 488.342,-367.364 486.542,-365.853 484.639,-364.456"/>
<polygon fill="#000000" stroke="#000000" points="486.121,-361.26 475.761,-359.041 482.476,-367.237 486.121,-361.26"/>
</g>
<!-- module~m_dhscf -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node18" class="node"><title>module~m_dhscf</title>
<g id="a_proc~~setup_hamiltonian~~UsesGraph_node18"><a xlink:href=".././module/m_dhscf.html" xlink:title="m_dhscf">
<polygon fill="#337ab7" stroke="#337ab7" points="462,-902 408,-902 408,-878 462,-878 462,-902"/>
<text text-anchor="middle" x="435" y="-887.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_dhscf</text>
</a>
</g>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;module~m_dhscf -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge17" class="edge"><title>proc~setup_hamiltonian&#45;&gt;module~m_dhscf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M574.733,-591.186C573.173,-633.913 562.522,-778.933 490,-864 485.034,-869.825 478.463,-874.449 471.62,-878.081"/>
<polygon fill="#000000" stroke="#000000" points="469.837,-875.051 462.244,-882.44 472.788,-881.398 469.837,-875.051"/>
</g>
<!-- m_spin -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node19" class="node"><title>m_spin</title>
<polygon fill="#337ab7" stroke="#337ab7" points="297.5,-823 243.5,-823 243.5,-799 297.5,-799 297.5,-823"/>
<text text-anchor="middle" x="270.5" y="-808.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_spin</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;m_spin -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge18" class="edge"><title>proc~setup_hamiltonian&#45;&gt;m_spin</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M575.356,-591.274C575.828,-633.42 571.01,-772.831 490,-831 461.658,-851.351 361.989,-832.334 307.59,-819.871"/>
<polygon fill="#000000" stroke="#000000" points="308.201,-816.42 297.667,-817.555 306.61,-823.237 308.201,-816.42"/>
</g>
<!-- m_gamma -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node20" class="node"><title>m_gamma</title>
<polygon fill="#337ab7" stroke="#337ab7" points="467,-318 403,-318 403,-294 467,-294 467,-318"/>
<text text-anchor="middle" x="435" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_gamma</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;m_gamma -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge19" class="edge"><title>proc~setup_hamiltonian&#45;&gt;m_gamma</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M574.417,-566.925C571.857,-527.136 558.417,-398.608 490,-327 486.135,-322.954 481.4,-319.675 476.355,-317.021"/>
<polygon fill="#000000" stroke="#000000" points="477.622,-313.754 467.063,-312.887 474.776,-320.149 477.622,-313.754"/>
</g>
<!-- class_dSpData1D -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node21" class="node"><title>class_dSpData1D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="483.5,-276 386.5,-276 386.5,-252 483.5,-252 483.5,-276"/>
<text text-anchor="middle" x="435" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_dSpData1D</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;class_dSpData1D -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge20" class="edge"><title>proc~setup_hamiltonian&#45;&gt;class_dSpData1D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M575.102,-566.838C574.811,-522.872 567.98,-370.287 490,-285 488.982,-283.886 487.898,-282.831 486.759,-281.832"/>
<polygon fill="#000000" stroke="#000000" points="488.742,-278.947 478.564,-276.005 484.686,-284.652 488.742,-278.947"/>
</g>
<!-- alloc -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node22" class="node"><title>alloc</title>
<polygon fill="#337ab7" stroke="#337ab7" points="462,-234 408,-234 408,-210 462,-210 462,-234"/>
<text text-anchor="middle" x="435" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">alloc</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;alloc -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge21" class="edge"><title>proc~setup_hamiltonian&#45;&gt;alloc</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M573.44,-566.929C566.236,-512.874 534.631,-293.494 490,-243 485.054,-237.404 478.434,-233.287 471.528,-230.263"/>
<polygon fill="#000000" stroke="#000000" points="472.656,-226.949 462.063,-226.779 470.238,-233.518 472.656,-226.949"/>
</g>
<!-- module~atmfuncs -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node23" class="node"><title>module~atmfuncs</title>
<g id="a_proc~~setup_hamiltonian~~UsesGraph_node23"><a xlink:href=".././module/atmfuncs.html" xlink:title="atmfuncs">
<polygon fill="#337ab7" stroke="#337ab7" points="463,-944 407,-944 407,-920 463,-920 463,-944"/>
<text text-anchor="middle" x="435" y="-929.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">atmfuncs</text>
</a>
</g>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;module~atmfuncs -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge22" class="edge"><title>proc~setup_hamiltonian&#45;&gt;module~atmfuncs</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M575.581,-591.039C577.195,-638.261 576.828,-813.048 490,-911 485.338,-916.26 479.197,-920.213 472.733,-923.18"/>
<polygon fill="#000000" stroke="#000000" points="471.242,-920.004 463.166,-926.861 473.755,-926.537 471.242,-920.004"/>
</g>
<!-- metaforce -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node24" class="node"><title>metaforce</title>
<polygon fill="#337ab7" stroke="#337ab7" points="465.5,-192 404.5,-192 404.5,-168 465.5,-168 465.5,-192"/>
<text text-anchor="middle" x="435" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">metaforce</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;metaforce -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge23" class="edge"><title>proc~setup_hamiltonian&#45;&gt;metaforce</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M573.774,-566.63C567.74,-507.993 539.466,-258.487 490,-201 485.965,-196.311 480.752,-192.663 475.16,-189.826"/>
<polygon fill="#000000" stroke="#000000" points="476.108,-186.428 465.533,-185.778 473.394,-192.88 476.108,-186.428"/>
</g>
<!-- sparse_matrices -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node25" class="node"><title>sparse_matrices</title>
<polygon fill="#337ab7" stroke="#337ab7" points="480.5,-150 389.5,-150 389.5,-126 480.5,-126 480.5,-150"/>
<text text-anchor="middle" x="435" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sparse_matrices</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;sparse_matrices -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge24" class="edge"><title>proc~setup_hamiltonian&#45;&gt;sparse_matrices</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M574.101,-566.95C569.263,-505.104 544.503,-223.735 490,-159 489.162,-158.004 488.27,-157.056 487.333,-156.152"/>
<polygon fill="#000000" stroke="#000000" points="489.448,-153.363 479.38,-150.064 485.193,-158.922 489.448,-153.363"/>
</g>
<!-- atomlist -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node26" class="node"><title>atomlist</title>
<polygon fill="#337ab7" stroke="#337ab7" points="462,-108 408,-108 408,-84 462,-84 462,-108"/>
<text text-anchor="middle" x="435" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">atomlist</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;atomlist -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge25" class="edge"><title>proc~setup_hamiltonian&#45;&gt;atomlist</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M574.324,-566.638C570.476,-500.501 549.377,-188.807 490,-117 485.196,-111.191 478.578,-106.983 471.619,-103.937"/>
<polygon fill="#000000" stroke="#000000" points="472.65,-100.588 462.056,-100.462 470.26,-107.167 472.65,-100.588"/>
</g>
<!-- module~m_rhog -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node27" class="node"><title>module~m_rhog</title>
<g id="a_proc~~setup_hamiltonian~~UsesGraph_node27"><a xlink:href=".././module/m_rhog.html" xlink:title="m_rhog">
<polygon fill="#337ab7" stroke="#337ab7" points="462,-822 408,-822 408,-798 462,-798 462,-822"/>
<text text-anchor="middle" x="435" y="-807.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_rhog</text>
</a>
</g>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;module~m_rhog -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge26" class="edge"><title>proc~setup_hamiltonian&#45;&gt;module~m_rhog</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M573.485,-591.033C568.423,-626.347 548.944,-730.859 490,-789 484.9,-794.031 478.458,-797.888 471.816,-800.835"/>
<polygon fill="#000000" stroke="#000000" points="470.181,-797.711 462.074,-804.532 472.665,-804.256 470.181,-797.711"/>
</g>
<!-- m_dipol -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node28" class="node"><title>m_dipol</title>
<polygon fill="#337ab7" stroke="#337ab7" points="462,-66 408,-66 408,-42 462,-42 462,-66"/>
<text text-anchor="middle" x="435" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_dipol</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;m_dipol -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge13" class="edge"><title>proc~setup_hamiltonian&#45;&gt;m_dipol</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M574.542,-566.908C571.701,-497.896 554.442,-154.124 490,-75 485.24,-69.1553 478.639,-64.9329 471.684,-61.8839"/>
<polygon fill="#000000" stroke="#000000" points="472.713,-58.534 462.118,-58.4113 470.324,-65.1138 472.713,-58.534"/>
</g>
<!-- class_zSpData2D -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node29" class="node"><title>class_zSpData2D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="483.5,-24 386.5,-24 386.5,-0 483.5,-0 483.5,-24"/>
<text text-anchor="middle" x="435" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_zSpData2D</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;class_zSpData2D -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge28" class="edge"><title>proc~setup_hamiltonian&#45;&gt;class_zSpData2D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M574.713,-566.866C572.769,-494.432 559.428,-119.354 490,-33 489.291,-32.1181 488.54,-31.2731 487.752,-30.4635"/>
<polygon fill="#000000" stroke="#000000" points="489.793,-27.6139 479.801,-24.0919 485.416,-33.0765 489.793,-27.6139"/>
</g>
<!-- module~precision -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node30" class="node"><title>module~precision</title>
<g id="a_proc~~setup_hamiltonian~~UsesGraph_node30"><a xlink:href=".././module/precision.html" xlink:title="precision">
<polygon fill="#337ab7" stroke="#337ab7" points="63,-945 8,-945 8,-921 63,-921 63,-945"/>
<text text-anchor="middle" x="35.5" y="-930.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">precision</text>
</a>
</g>
</g>
<!-- module~m_dhscf&#45;&gt;module~precision -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge29" class="edge"><title>module~m_dhscf&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M407.706,-894.615C355.775,-903.525 236.295,-923.008 135,-932"/>
</g>
<!-- m_dfscf -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node35" class="node"><title>m_dfscf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="297.5,-865 243.5,-865 243.5,-841 297.5,-841 297.5,-865"/>
<text text-anchor="middle" x="270.5" y="-850.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_dfscf</text>
</g>
<!-- module~m_dhscf&#45;&gt;m_dfscf -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge30" class="edge"><title>module~m_dhscf&#45;&gt;m_dfscf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M407.892,-884.055C380.647,-877.852 337.741,-868.083 307.335,-861.159"/>
<polygon fill="#000000" stroke="#000000" points="308.071,-857.737 297.544,-858.93 306.517,-864.563 308.071,-857.737"/>
</g>
<!-- module~atmfuncs&#45;&gt;module~sys -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge35" class="edge"><title>module~atmfuncs&#45;&gt;module~sys</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M406.99,-939.964C397.327,-943.997 387.086,-949.822 380,-958 345.206,-998.156 382.018,-1034.88 344,-1072 334.308,-1081.46 320.623,-1086.71 307.749,-1089.6"/>
<polygon fill="#000000" stroke="#000000" points="306.893,-1086.2 297.69,-1091.45 308.158,-1093.08 306.893,-1086.2"/>
</g>
<!-- module~atmfuncs&#45;&gt;module~precision -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge32" class="edge"><title>module~atmfuncs&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M406.832,-937.315C397.797,-939.9 388.007,-943.646 380,-949 359.281,-962.854 366.583,-981.454 344,-992 284.803,-1019.64 257.563,-1016.51 197,-992 161.454,-977.616 173.225,-928.95 135,-932"/>
</g>
<!-- spher_harm -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node31" class="node"><title>spher_harm</title>
<polygon fill="#337ab7" stroke="#337ab7" points="305.5,-1063 235.5,-1063 235.5,-1039 305.5,-1039 305.5,-1063"/>
<text text-anchor="middle" x="270.5" y="-1048.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">spher_harm</text>
</g>
<!-- module~atmfuncs&#45;&gt;spher_harm -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge33" class="edge"><title>module~atmfuncs&#45;&gt;spher_harm</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M406.935,-941.063C397.601,-945.156 387.594,-950.735 380,-958 355.573,-981.367 369.613,-1002.94 344,-1025 335.785,-1032.08 325.5,-1037.28 315.281,-1041.08"/>
<polygon fill="#000000" stroke="#000000" points="313.954,-1037.84 305.574,-1044.32 316.167,-1044.48 313.954,-1037.84"/>
</g>
<!-- module~atm_types -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node36" class="node"><title>module~atm_types</title>
<g id="a_proc~~setup_hamiltonian~~UsesGraph_node36"><a xlink:href=".././module/atm_types.html" xlink:title="atm_types">
<polygon fill="#337ab7" stroke="#337ab7" points="301.5,-983 239.5,-983 239.5,-959 301.5,-959 301.5,-983"/>
<text text-anchor="middle" x="270.5" y="-968.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">atm_types</text>
</a>
</g>
</g>
<!-- module~atmfuncs&#45;&gt;module~atm_types -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge31" class="edge"><title>module~atmfuncs&#45;&gt;module~atm_types</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M406.801,-938.528C380.776,-944.774 341.212,-954.269 311.578,-961.381"/>
<polygon fill="#000000" stroke="#000000" points="310.456,-958.051 301.549,-963.788 312.09,-964.858 310.456,-958.051"/>
</g>
<!-- module~radial -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node37" class="node"><title>module~radial</title>
<g id="a_proc~~setup_hamiltonian~~UsesGraph_node37"><a xlink:href=".././module/radial.html" xlink:title="radial">
<polygon fill="#337ab7" stroke="#337ab7" points="161,-904 107,-904 107,-880 161,-880 161,-904"/>
<text text-anchor="middle" x="134" y="-889.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">radial</text>
</a>
</g>
</g>
<!-- module~atmfuncs&#45;&gt;module~radial -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge34" class="edge"><title>module~atmfuncs&#45;&gt;module~radial</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M406.938,-928.38C352.989,-921.162 232.024,-904.98 171.272,-896.852"/>
<polygon fill="#000000" stroke="#000000" points="171.733,-893.383 161.357,-895.526 170.805,-900.321 171.733,-893.383"/>
</g>
<!-- module~m_rhog&#45;&gt;m_spin -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge38" class="edge"><title>module~m_rhog&#45;&gt;m_spin</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M407.892,-810.161C380.766,-810.328 338.114,-810.59 307.733,-810.777"/>
<polygon fill="#000000" stroke="#000000" points="307.522,-807.278 297.544,-810.84 307.565,-814.278 307.522,-807.278"/>
</g>
<!-- module~m_rhog&#45;&gt;module~precision -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge36" class="edge"><title>module~m_rhog&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M407.868,-802.604C390.04,-797.952 365.797,-792.393 344,-790 279.057,-782.871 249.285,-750.824 197,-790 141.889,-831.293 203.701,-927.264 135,-932"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M133,-932C113.288,-933.198 91.2715,-933.505 73.2505,-933.487"/>
<polygon fill="#000000" stroke="#000000" points="73.1645,-929.987 63.1494,-933.444 73.1342,-936.987 73.1645,-929.987"/>
</g>
<!-- class_Pair_dData1D -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node32" class="node"><title>class_Pair_dData1D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="325,-659 216,-659 216,-635 325,-635 325,-659"/>
<text text-anchor="middle" x="270.5" y="-644.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_Pair_dData1D</text>
</g>
<!-- module~m_rhog&#45;&gt;class_Pair_dData1D -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge37" class="edge"><title>module~m_rhog&#45;&gt;class_Pair_dData1D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M407.827,-804.983C397.924,-801.882 387.293,-796.915 380,-789 341.98,-747.739 383.817,-707.53 344,-668 341.101,-665.122 337.833,-662.634 334.329,-660.483"/>
<polygon fill="#000000" stroke="#000000" points="335.703,-657.254 325.209,-655.801 332.507,-663.481 335.703,-657.254"/>
</g>
<!-- class_dData1D -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node33" class="node"><title>class_dData1D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="313,-743 228,-743 228,-719 313,-719 313,-743"/>
<text text-anchor="middle" x="270.5" y="-728.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_dData1D</text>
</g>
<!-- module~m_rhog&#45;&gt;class_dData1D -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge40" class="edge"><title>module~m_rhog&#45;&gt;class_dData1D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M407.842,-801.955C398.699,-798.599 388.582,-794.247 380,-789 361.736,-777.833 362.411,-767.923 344,-757 337.289,-753.018 329.87,-749.5 322.414,-746.442"/>
<polygon fill="#000000" stroke="#000000" points="323.591,-743.145 313.002,-742.814 321.074,-749.677 323.591,-743.145"/>
</g>
<!-- class_Fstack_Pair_dData1D -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node34" class="node"><title>class_Fstack_Pair_dData1D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="344,-701 197,-701 197,-677 344,-677 344,-701"/>
<text text-anchor="middle" x="270.5" y="-686.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_Fstack_Pair_dData1D</text>
</g>
<!-- module~m_rhog&#45;&gt;class_Fstack_Pair_dData1D -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge39" class="edge"><title>module~m_rhog&#45;&gt;class_Fstack_Pair_dData1D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M407.814,-804.271C398.141,-801.09 387.677,-796.254 380,-789 351.954,-762.501 373.196,-735.226 344,-710 342.475,-708.683 340.873,-707.448 339.206,-706.291"/>
<polygon fill="#000000" stroke="#000000" points="340.809,-703.173 330.414,-701.124 337.262,-709.208 340.809,-703.173"/>
</g>
<!-- module~atm_types&#45;&gt;module~precision -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge41" class="edge"><title>module~atm_types&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M239.372,-959.551C206.308,-947.474 155.237,-930.386 135,-932"/>
</g>
<!-- module~atm_types&#45;&gt;module~radial -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge42" class="edge"><title>module~atm_types&#45;&gt;module~radial</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M239.496,-962.938C226.004,-958.644 210.185,-952.651 197,-945 181.277,-935.876 165.732,-922.575 154.14,-911.58"/>
<polygon fill="#000000" stroke="#000000" points="156.397,-908.892 146.793,-904.417 151.51,-913.904 156.397,-908.892"/>
</g>
<!-- module~radial&#45;&gt;module~precision -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge44" class="edge"><title>module~radial&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M106.886,-903.095C96.3326,-907.579 83.9758,-912.829 72.5863,-917.668"/>
<polygon fill="#000000" stroke="#000000" points="71.1426,-914.479 63.3075,-921.61 73.8799,-920.921 71.1426,-914.479"/>
</g>
<!-- xml -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node38" class="node"><title>xml</title>
<polygon fill="#337ab7" stroke="#337ab7" points="62.5,-903 8.5,-903 8.5,-879 62.5,-879 62.5,-903"/>
<text text-anchor="middle" x="35.5" y="-888.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xml</text>
</g>
<!-- module~radial&#45;&gt;xml -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge43" class="edge"><title>module~radial&#45;&gt;xml</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M106.886,-891.729C96.3727,-891.62 84.0697,-891.493 72.7163,-891.375"/>
<polygon fill="#000000" stroke="#000000" points="72.6709,-887.875 62.6352,-891.271 72.5983,-894.874 72.6709,-887.875"/>
</g>
<!-- interpolation -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node39" class="node"><title>interpolation</title>
<polygon fill="#337ab7" stroke="#337ab7" points="71,-861 0,-861 0,-837 71,-837 71,-861"/>
<text text-anchor="middle" x="35.5" y="-846.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpolation</text>
</g>
<!-- module~radial&#45;&gt;interpolation -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge45" class="edge"><title>module~radial&#45;&gt;interpolation</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M106.886,-880.364C96.4198,-875.7 84.1799,-870.246 72.8689,-865.206"/>
<polygon fill="#000000" stroke="#000000" points="74.2043,-861.969 63.6455,-861.096 71.3551,-868.363 74.2043,-861.969"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="490pt" height="32pt"
 viewBox="0.00 0.00 489.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 485.5,-28 485.5,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node"><title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node"><title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="139.5,-24 72.5,-24 72.5,-0 139.5,-0 139.5,-24"/>
<text text-anchor="middle" x="106" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="222,-24 158,-24 158,-0 222,-0 222,-24"/>
<text text-anchor="middle" x="190" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="294,-24 240,-24 240,-0 294,-0 294,-24"/>
<text text-anchor="middle" x="267" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="366,-24 312,-24 312,-0 366,-0 366,-24"/>
<text text-anchor="middle" x="339" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="481.5,-24 384.5,-24 384.5,-0 481.5,-0 481.5,-24"/>
<text text-anchor="middle" x="433" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses.
    </p>
    </div></div></div></div>
      </li>
      
      </ul>
    </div>
    


    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iscf%7E2"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>iscf</strong></td><td></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~setup_hamiltonian~~CallsGraph Pages: 1 -->
<svg id="procsetup_hamiltonianCallsGraph" width="641pt" height="1414pt"
 viewBox="0.00 0.00 641.00 1413.52" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~setup_hamiltonian~~CallsGraph" class="graph" transform="scale(0.722661 0.722661) rotate(0) translate(4 1952)">
<title>proc~~setup_hamiltonian~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1952 883,-1952 883,4 -4,4"/>
<!-- proc~setup_hamiltonian -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node1" class="node"><title>proc~setup_hamiltonian</title>
<polygon fill="none" stroke="black" points="100,-880 0,-880 0,-856 100,-856 100,-880"/>
<text text-anchor="middle" x="50" y="-865.6" font-family="Helvetica,sans-Serif" font-size="10.50">setup_hamiltonian</text>
</g>
<!-- proc~dhscf -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node2" class="node"><title>proc~dhscf</title>
<g id="a_proc~~setup_hamiltonian~~CallsGraph_node2"><a xlink:href=".././proc/dhscf.html" xlink:title="dhscf">
<polygon fill="#d9534f" stroke="#d9534f" points="203.5,-880 149.5,-880 149.5,-856 203.5,-856 203.5,-880"/>
<text text-anchor="middle" x="176.5" y="-865.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dhscf</text>
</a>
</g>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;proc~dhscf -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge8" class="edge"><title>proc~setup_hamiltonian&#45;&gt;proc~dhscf</title>
<path fill="none" stroke="#000000" d="M100.206,-868C113.138,-868 126.856,-868 138.991,-868"/>
<polygon fill="#000000" stroke="#000000" points="139.187,-871.5 149.187,-868 139.187,-864.5 139.187,-871.5"/>
</g>
<!-- globalize_sum -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node3" class="node"><title>globalize_sum</title>
<polygon fill="#777777" stroke="#777777" points="217,-1872 136,-1872 136,-1848 217,-1848 217,-1872"/>
<text text-anchor="middle" x="176.5" y="-1857.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">globalize_sum</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;globalize_sum -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge2" class="edge"><title>proc~setup_hamiltonian&#45;&gt;globalize_sum</title>
<path fill="none" stroke="#000000" d="M51.4279,-880.046C55.2504,-985.373 84.5977,-1747.9 136,-1834 137.539,-1836.58 139.444,-1838.95 141.579,-1841.12"/>
<polygon fill="#000000" stroke="#000000" points="139.605,-1844.03 149.527,-1847.75 144.086,-1838.65 139.605,-1844.03"/>
</g>
<!-- proc~bye -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node4" class="node"><title>proc~bye</title>
<g id="a_proc~~setup_hamiltonian~~CallsGraph_node4"><a xlink:href=".././proc/bye.html" xlink:title="bye">
<polygon fill="#d9534f" stroke="#d9534f" points="346.5,-1912 292.5,-1912 292.5,-1888 346.5,-1888 346.5,-1912"/>
<text text-anchor="middle" x="319.5" y="-1897.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bye</text>
</a>
</g>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;proc~bye -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge3" class="edge"><title>proc~setup_hamiltonian&#45;&gt;proc~bye</title>
<path fill="none" stroke="#000000" d="M51.1014,-880.154C52.1319,-989.78 62.2627,-1805.77 136,-1881 173.618,-1919.38 240.911,-1915.43 282.431,-1908.27"/>
<polygon fill="#000000" stroke="#000000" points="283.213,-1911.68 292.398,-1906.4 281.925,-1904.8 283.213,-1911.68"/>
</g>
<!-- val -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node5" class="node"><title>val</title>
<polygon fill="#777777" stroke="#777777" points="203.5,-1792 149.5,-1792 149.5,-1768 203.5,-1768 203.5,-1792"/>
<text text-anchor="middle" x="176.5" y="-1777.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">val</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;val -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge4" class="edge"><title>proc~setup_hamiltonian&#45;&gt;val</title>
<path fill="none" stroke="#000000" d="M51.465,-880.085C55.4374,-981.034 84.7735,-1682.27 136,-1759 137.434,-1761.15 139.161,-1763.09 141.083,-1764.85"/>
<polygon fill="#000000" stroke="#000000" points="139.081,-1767.72 149.238,-1770.73 143.177,-1762.04 139.081,-1767.72"/>
</g>
<!-- h -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node6" class="node"><title>h</title>
<polygon fill="#777777" stroke="#777777" points="203.5,-1750 149.5,-1750 149.5,-1726 203.5,-1726 203.5,-1750"/>
<text text-anchor="middle" x="176.5" y="-1735.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">h</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;h -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge5" class="edge"><title>proc~setup_hamiltonian&#45;&gt;h</title>
<path fill="none" stroke="#000000" d="M50.8235,-880.22C49.6895,-972.751 46.078,-1563.51 136,-1712 137.595,-1714.63 139.57,-1717.05 141.78,-1719.27"/>
<polygon fill="#000000" stroke="#000000" points="140.034,-1722.36 149.986,-1726 144.474,-1716.95 140.034,-1722.36"/>
</g>
<!-- timer -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node7" class="node"><title>timer</title>
<polygon fill="#777777" stroke="#777777" points="872.5,-1441 818.5,-1441 818.5,-1417 872.5,-1417 872.5,-1441"/>
<text text-anchor="middle" x="845.5" y="-1426.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">timer</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;timer -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge7" class="edge"><title>proc~setup_hamiltonian&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M52.251,-880.186C61.9646,-972.391 128.296,-1559.81 253,-1676 423.972,-1835.29 593.348,-1875.76 776,-1730 819.963,-1694.92 837.884,-1515.02 842.913,-1451.36"/>
<polygon fill="#000000" stroke="#000000" points="846.416,-1451.44 843.682,-1441.2 839.436,-1450.91 846.416,-1451.44"/>
</g>
<!-- write_hsx -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node8" class="node"><title>write_hsx</title>
<polygon fill="#777777" stroke="#777777" points="205.5,-922 147.5,-922 147.5,-898 205.5,-898 205.5,-922"/>
<text text-anchor="middle" x="176.5" y="-907.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_hsx</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;write_hsx -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge1" class="edge"><title>proc~setup_hamiltonian&#45;&gt;write_hsx</title>
<path fill="none" stroke="#000000" d="M86.6767,-880.036C102.624,-885.415 121.435,-891.761 137.632,-897.225"/>
<polygon fill="#000000" stroke="#000000" points="136.735,-900.616 147.329,-900.497 138.973,-893.984 136.735,-900.616"/>
</g>
<!-- de_alloc -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node9" class="node"><title>de_alloc</title>
<polygon fill="#777777" stroke="#777777" points="872.5,-828 818.5,-828 818.5,-804 872.5,-804 872.5,-828"/>
<text text-anchor="middle" x="845.5" y="-813.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">de_alloc</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;de_alloc -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge9" class="edge"><title>proc~setup_hamiltonian&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M92.3903,-855.899C138.982,-841.879 209.237,-819.379 217,-809 260.523,-750.81 200.222,-205.948 253,-156 458.729,38.6997 758.838,-583.621 776,-615 809.167,-675.645 830.495,-755.274 839.535,-793.55"/>
<polygon fill="#000000" stroke="#000000" points="836.198,-794.658 841.852,-803.618 843.02,-793.088 836.198,-794.658"/>
</g>
<!-- re_alloc -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node10" class="node"><title>re_alloc</title>
<polygon fill="#777777" stroke="#777777" points="872.5,-556 818.5,-556 818.5,-532 872.5,-532 872.5,-556"/>
<text text-anchor="middle" x="845.5" y="-541.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">re_alloc</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;re_alloc -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge10" class="edge"><title>proc~setup_hamiltonian&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M52.2154,-855.832C62.6776,-754.324 141.462,-52 318.5,-52 318.5,-52 318.5,-52 605,-52 693.267,-52 725.771,-80.4184 776,-153 818.151,-213.91 837.813,-448.224 843.033,-521.777"/>
<polygon fill="#000000" stroke="#000000" points="839.544,-522.053 843.724,-531.788 846.527,-521.571 839.544,-522.053"/>
</g>
<!-- dimag -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node11" class="node"><title>dimag</title>
<polygon fill="#777777" stroke="#777777" points="203.5,-800 149.5,-800 149.5,-776 203.5,-776 203.5,-800"/>
<text text-anchor="middle" x="176.5" y="-785.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dimag</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;dimag -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge6" class="edge"><title>proc~setup_hamiltonian&#45;&gt;dimag</title>
<path fill="none" stroke="#000000" d="M69.9089,-855.85C90.7791,-842.439 124.552,-820.737 148.271,-805.497"/>
<polygon fill="#000000" stroke="#000000" points="150.3,-808.353 156.821,-800.002 146.516,-802.464 150.3,-808.353"/>
</g>
<!-- dscf -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node12" class="node"><title>dscf</title>
<polygon fill="#777777" stroke="#777777" points="203.5,-758 149.5,-758 149.5,-734 203.5,-734 203.5,-758"/>
<text text-anchor="middle" x="176.5" y="-743.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dscf</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;dscf -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge11" class="edge"><title>proc~setup_hamiltonian&#45;&gt;dscf</title>
<path fill="none" stroke="#000000" d="M58.9332,-855.816C72.6804,-835.417 102.674,-793.945 136,-767 137.37,-765.892 138.808,-764.816 140.29,-763.774"/>
<polygon fill="#000000" stroke="#000000" points="142.522,-766.504 149.11,-758.206 138.785,-760.585 142.522,-766.504"/>
</g>
<!-- update_e0 -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node13" class="node"><title>update_e0</title>
<polygon fill="#777777" stroke="#777777" points="208.5,-716 144.5,-716 144.5,-692 208.5,-692 208.5,-716"/>
<text text-anchor="middle" x="176.5" y="-701.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_e0</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;update_e0 -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge12" class="edge"><title>proc~setup_hamiltonian&#45;&gt;update_e0</title>
<path fill="none" stroke="#000000" d="M55.5788,-855.787C66.1142,-829.071 94.4035,-764.66 136,-725 137.089,-723.962 138.24,-722.96 139.436,-721.996"/>
<polygon fill="#000000" stroke="#000000" points="141.607,-724.75 147.833,-716.177 137.62,-718.996 141.607,-724.75"/>
</g>
<!-- hold -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node14" class="node"><title>hold</title>
<polygon fill="#777777" stroke="#777777" points="203.5,-674 149.5,-674 149.5,-650 203.5,-650 203.5,-674"/>
<text text-anchor="middle" x="176.5" y="-659.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hold</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;hold -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge13" class="edge"><title>proc~setup_hamiltonian&#45;&gt;hold</title>
<path fill="none" stroke="#000000" d="M53.7419,-855.646C61.4399,-823.478 86.0269,-735.956 136,-683 137.399,-681.517 138.927,-680.118 140.542,-678.8"/>
<polygon fill="#000000" stroke="#000000" points="142.892,-681.432 149.154,-672.886 138.929,-675.662 142.892,-681.432"/>
</g>
<!-- proc~die -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node15" class="node"><title>proc~die</title>
<g id="a_proc~~setup_hamiltonian~~CallsGraph_node15"><a xlink:href=".././proc/die.html" xlink:title="die">
<polygon fill="#d9534f" stroke="#d9534f" points="760,-1839 706,-1839 706,-1815 760,-1815 760,-1839"/>
<text text-anchor="middle" x="733" y="-1824.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">die</text>
</a>
</g>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;proc~die -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge14" class="edge"><title>proc~setup_hamiltonian&#45;&gt;proc~die</title>
<path fill="none" stroke="#000000" d="M51.1629,-880.198C52.685,-985.197 65.9708,-1734.2 136,-1801 176.462,-1839.59 572.786,-1831.58 695.783,-1828.12"/>
<polygon fill="#000000" stroke="#000000" points="695.931,-1831.62 705.826,-1827.83 695.729,-1824.62 695.931,-1831.62"/>
</g>
<!-- hubbard_term -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node16" class="node"><title>hubbard_term</title>
<polygon fill="#777777" stroke="#777777" points="216.5,-24 136.5,-24 136.5,-0 216.5,-0 216.5,-24"/>
<text text-anchor="middle" x="176.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hubbard_term</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;hubbard_term -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge15" class="edge"><title>proc~setup_hamiltonian&#45;&gt;hubbard_term</title>
<path fill="none" stroke="#000000" d="M50.8489,-855.982C49.9036,-764.979 47.4317,-183.975 136,-38 137.597,-35.3679 139.574,-32.949 141.785,-30.7373"/>
<polygon fill="#000000" stroke="#000000" points="144.479,-33.0546 149.992,-24.0076 140.04,-27.6416 144.479,-33.0546"/>
</g>
<!-- proc~dhscf&#45;&gt;proc~bye -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge28" class="edge"><title>proc~dhscf&#45;&gt;proc~bye</title>
<path fill="none" stroke="#000000" d="M203.547,-876.907C208.839,-879.925 213.769,-883.876 217,-889 266.534,-967.55 234.58,-1632.98 253,-1724 264.722,-1781.92 292.679,-1846.05 308.006,-1878.56"/>
<polygon fill="#000000" stroke="#000000" points="304.854,-1880.08 312.325,-1887.59 311.169,-1877.06 304.854,-1880.08"/>
</g>
<!-- proc~dhscf&#45;&gt;timer -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge44" class="edge"><title>proc~dhscf&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M203.523,-876.923C208.816,-879.939 213.752,-883.886 217,-889 260.301,-957.177 194.493,-1559.32 253,-1615 299.277,-1659.04 672.177,-1602.54 776,-1532 805.687,-1511.83 825.806,-1474.1 836.198,-1450.33"/>
<polygon fill="#000000" stroke="#000000" points="839.433,-1451.67 840.056,-1441.09 832.973,-1448.97 839.433,-1451.67"/>
</g>
<!-- proc~dhscf&#45;&gt;de_alloc -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge47" class="edge"><title>proc~dhscf&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M203.856,-877.721C208.87,-880.654 213.603,-884.364 217,-889 269.09,-960.09 185.261,-1027.62 253,-1084 298.434,-1121.81 341.407,-1122.8 386,-1084 473.341,-1008 343.985,-911.546 422,-826 521.649,-716.73 726.288,-773.325 808.822,-802.338"/>
<polygon fill="#000000" stroke="#000000" points="807.672,-805.644 818.266,-805.727 810.036,-799.055 807.672,-805.644"/>
</g>
<!-- proc~dhscf&#45;&gt;re_alloc -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge18" class="edge"><title>proc~dhscf&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M203.614,-855.828C208.904,-852.139 213.815,-847.556 217,-842 254.961,-775.783 201.131,-211.995 253,-156 318.783,-84.9829 372.197,-128 469,-128 469,-128 469,-128 605,-128 788.625,-128 833.581,-436.182 842.542,-522.035"/>
<polygon fill="#000000" stroke="#000000" points="839.06,-522.389 843.522,-531.999 846.026,-521.704 839.06,-522.389"/>
</g>
<!-- proc~dhscf&#45;&gt;proc~die -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge31" class="edge"><title>proc~dhscf&#45;&gt;proc~die</title>
<path fill="none" stroke="#000000" d="M203.537,-876.914C208.83,-879.931 213.762,-883.88 217,-889 263.789,-962.982 200.068,-1606.28 253,-1676 308.188,-1748.69 593.424,-1803.47 695.565,-1821.02"/>
<polygon fill="#000000" stroke="#000000" points="695.258,-1824.52 705.703,-1822.75 696.43,-1817.62 695.258,-1824.52"/>
</g>
<!-- elecs -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node17" class="node"><title>elecs</title>
<polygon fill="#777777" stroke="#777777" points="346.5,-760 292.5,-760 292.5,-736 346.5,-736 346.5,-760"/>
<text text-anchor="middle" x="319.5" y="-745.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elecs</text>
</g>
<!-- proc~dhscf&#45;&gt;elecs -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge22" class="edge"><title>proc~dhscf&#45;&gt;elecs</title>
<path fill="none" stroke="#000000" d="M200.339,-855.743C206.235,-851.873 212.251,-847.225 217,-842 240.002,-816.696 227.538,-796.827 253,-774 261.353,-766.511 272.126,-761.052 282.513,-757.128"/>
<polygon fill="#000000" stroke="#000000" points="283.917,-760.348 292.262,-753.821 281.668,-753.719 283.917,-760.348"/>
</g>
<!-- proc~forhar -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node19" class="node"><title>proc~forhar</title>
<g id="a_proc~~setup_hamiltonian~~CallsGraph_node19"><a xlink:href=".././proc/forhar.html" xlink:title="forhar">
<polygon fill="#d9534f" stroke="#d9534f" points="346.5,-840 292.5,-840 292.5,-816 346.5,-816 346.5,-840"/>
<text text-anchor="middle" x="319.5" y="-825.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">forhar</text>
</a>
</g>
</g>
<!-- proc~dhscf&#45;&gt;proc~forhar -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge17" class="edge"><title>proc~dhscf&#45;&gt;proc~forhar</title>
<path fill="none" stroke="#000000" d="M203.691,-860.57C225.95,-854.255 258.119,-845.129 282.746,-838.143"/>
<polygon fill="#000000" stroke="#000000" points="283.785,-841.487 292.45,-835.39 281.874,-834.752 283.785,-841.487"/>
</g>
<!-- ts_voltage -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node20" class="node"><title>ts_voltage</title>
<polygon fill="#777777" stroke="#777777" points="350,-718 289,-718 289,-694 350,-694 350,-718"/>
<text text-anchor="middle" x="319.5" y="-703.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ts_voltage</text>
</g>
<!-- proc~dhscf&#45;&gt;ts_voltage -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge19" class="edge"><title>proc~dhscf&#45;&gt;ts_voltage</title>
<path fill="none" stroke="#000000" d="M201.821,-855.744C207.438,-851.975 212.947,-847.376 217,-842 249.242,-799.236 215.26,-765 253,-727 260.057,-719.894 269.521,-715.19 279.056,-712.077"/>
<polygon fill="#000000" stroke="#000000" points="280.201,-715.392 288.921,-709.375 278.351,-708.641 280.201,-715.392"/>
</g>
<!-- dfscf -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node21" class="node"><title>dfscf</title>
<polygon fill="#777777" stroke="#777777" points="346.5,-676 292.5,-676 292.5,-652 346.5,-652 346.5,-676"/>
<text text-anchor="middle" x="319.5" y="-661.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dfscf</text>
</g>
<!-- proc~dhscf&#45;&gt;dfscf -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge39" class="edge"><title>proc~dhscf&#45;&gt;dfscf</title>
<path fill="none" stroke="#000000" d="M202.116,-855.957C207.727,-852.184 213.16,-847.529 217,-842 257.836,-783.201 204.572,-737.722 253,-685 260.669,-676.651 271.659,-671.606 282.45,-668.563"/>
<polygon fill="#000000" stroke="#000000" points="283.258,-671.969 292.205,-666.294 281.672,-665.151 283.258,-671.969"/>
</g>
<!-- ts_hartree_fix -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node22" class="node"><title>ts_hartree_fix</title>
<polygon fill="#777777" stroke="#777777" points="358.5,-634 280.5,-634 280.5,-610 358.5,-610 358.5,-634"/>
<text text-anchor="middle" x="319.5" y="-619.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ts_hartree_fix</text>
</g>
<!-- proc~dhscf&#45;&gt;ts_hartree_fix -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge21" class="edge"><title>proc~dhscf&#45;&gt;ts_hartree_fix</title>
<path fill="none" stroke="#000000" d="M202.705,-855.801C208.165,-852.074 213.38,-847.48 217,-842 266.543,-767.007 193.751,-710.587 253,-643 257.817,-637.506 264.073,-633.438 270.805,-630.429"/>
<polygon fill="#000000" stroke="#000000" points="272.031,-633.707 280.19,-626.947 269.597,-627.144 272.031,-633.707"/>
</g>
<!-- volcel -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node23" class="node"><title>volcel</title>
<polygon fill="#777777" stroke="#777777" points="346.5,-592 292.5,-592 292.5,-568 346.5,-568 346.5,-592"/>
<text text-anchor="middle" x="319.5" y="-577.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">volcel</text>
</g>
<!-- proc~dhscf&#45;&gt;volcel -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge16" class="edge"><title>proc~dhscf&#45;&gt;volcel</title>
<path fill="none" stroke="#000000" d="M202.825,-855.879C208.281,-852.15 213.464,-847.535 217,-842 275.302,-750.733 182.867,-683.524 253,-601 260.401,-592.292 271.422,-587.159 282.323,-584.147"/>
<polygon fill="#000000" stroke="#000000" points="283.201,-587.537 292.193,-581.934 281.669,-580.706 283.201,-587.537"/>
</g>
<!-- ddot -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node24" class="node"><title>ddot</title>
<polygon fill="#777777" stroke="#777777" points="346.5,-550 292.5,-550 292.5,-526 346.5,-526 346.5,-550"/>
<text text-anchor="middle" x="319.5" y="-535.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ddot</text>
</g>
<!-- proc~dhscf&#45;&gt;ddot -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge23" class="edge"><title>proc~dhscf&#45;&gt;ddot</title>
<path fill="none" stroke="#000000" d="M202.911,-855.933C208.364,-852.202 213.525,-847.573 217,-842 284.091,-734.414 171.947,-656.501 253,-559 260.364,-550.141 271.479,-544.977 282.473,-541.981"/>
<polygon fill="#000000" stroke="#000000" points="283.408,-545.359 292.424,-539.795 281.906,-538.522 283.408,-545.359"/>
</g>
<!-- jms_setmeshdistr -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node25" class="node"><title>jms_setmeshdistr</title>
<polygon fill="#777777" stroke="#777777" points="518,-552 422,-552 422,-528 518,-528 518,-552"/>
<text text-anchor="middle" x="470" y="-537.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jms_setmeshdistr</text>
</g>
<!-- proc~dhscf&#45;&gt;jms_setmeshdistr -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge24" class="edge"><title>proc~dhscf&#45;&gt;jms_setmeshdistr</title>
<path fill="none" stroke="#000000" d="M197.706,-855.748C204.06,-851.622 210.983,-846.833 217,-842 234.398,-828.025 233.688,-818.181 253,-807 306.203,-776.197 344.82,-814.646 386,-769 447.378,-700.965 368.722,-640.548 422,-566 424.069,-563.105 426.565,-560.496 429.315,-558.151"/>
<polygon fill="#000000" stroke="#000000" points="431.5,-560.892 437.595,-552.226 427.426,-555.199 431.5,-560.892"/>
</g>
<!-- mpitrace_restart -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node26" class="node"><title>mpitrace_restart</title>
<polygon fill="#777777" stroke="#777777" points="365,-470 274,-470 274,-446 365,-446 365,-470"/>
<text text-anchor="middle" x="319.5" y="-455.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpitrace_restart</text>
</g>
<!-- proc~dhscf&#45;&gt;mpitrace_restart -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge25" class="edge"><title>proc~dhscf&#45;&gt;mpitrace_restart</title>
<path fill="none" stroke="#000000" d="M203.015,-855.997C208.465,-852.264 213.598,-847.618 217,-842 299.826,-705.207 156.659,-611.635 253,-484 256.234,-479.716 260.283,-476.136 264.774,-473.146"/>
<polygon fill="#000000" stroke="#000000" points="266.819,-476.013 273.854,-468.09 263.414,-469.897 266.819,-476.013"/>
</g>
<!-- bsc_cellxc -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node27" class="node"><title>bsc_cellxc</title>
<polygon fill="#777777" stroke="#777777" points="500.5,-510 439.5,-510 439.5,-486 500.5,-486 500.5,-510"/>
<text text-anchor="middle" x="470" y="-495.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bsc_cellxc</text>
</g>
<!-- proc~dhscf&#45;&gt;bsc_cellxc -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge26" class="edge"><title>proc~dhscf&#45;&gt;bsc_cellxc</title>
<path fill="none" stroke="#000000" d="M202.975,-855.972C208.426,-852.241 213.57,-847.601 217,-842 254.949,-780.033 201.042,-567.798 253,-517 299.365,-471.67 381.125,-478.738 429.658,-488.215"/>
<polygon fill="#000000" stroke="#000000" points="428.983,-491.649 439.486,-490.256 430.406,-484.796 428.983,-491.649"/>
</g>
<!-- write_grid_netcdf -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node28" class="node"><title>write_grid_netcdf</title>
<polygon fill="#777777" stroke="#777777" points="366.5,-428 272.5,-428 272.5,-404 366.5,-404 366.5,-428"/>
<text text-anchor="middle" x="319.5" y="-413.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_grid_netcdf</text>
</g>
<!-- proc~dhscf&#45;&gt;write_grid_netcdf -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge27" class="edge"><title>proc~dhscf&#45;&gt;write_grid_netcdf</title>
<path fill="none" stroke="#000000" d="M203.469,-855.743C208.765,-852.058 213.715,-847.497 217,-842 263.351,-764.44 196.566,-507.563 253,-437 255.889,-433.388 259.403,-430.388 263.288,-427.897"/>
<polygon fill="#000000" stroke="#000000" points="265.025,-430.939 272.283,-423.22 261.796,-424.728 265.025,-430.939"/>
</g>
<!-- proc~setmeshdistr -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node30" class="node"><title>proc~setmeshdistr</title>
<g id="a_proc~~setup_hamiltonian~~CallsGraph_node30"><a xlink:href=".././proc/setmeshdistr.html" xlink:title="setMeshDistr">
<polygon fill="#d9534f" stroke="#d9534f" points="507.5,-324 432.5,-324 432.5,-300 507.5,-300 507.5,-324"/>
<text text-anchor="middle" x="470" y="-309.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setMeshDistr</text>
</a>
</g>
</g>
<!-- proc~dhscf&#45;&gt;proc~setmeshdistr -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge29" class="edge"><title>proc~dhscf&#45;&gt;proc~setmeshdistr</title>
<path fill="none" stroke="#000000" d="M203.605,-855.823C208.895,-852.134 213.809,-847.552 217,-842 253.434,-778.616 199.908,-235.262 253,-185 295.926,-144.362 334.011,-156.87 386,-185 427.238,-207.313 451.258,-260.002 462.066,-290.034"/>
<polygon fill="#000000" stroke="#000000" points="458.798,-291.295 465.344,-299.625 465.422,-289.031 458.798,-291.295"/>
</g>
<!-- rhoofdsp -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node33" class="node"><title>rhoofdsp</title>
<polygon fill="#777777" stroke="#777777" points="347,-386 292,-386 292,-362 347,-362 347,-386"/>
<text text-anchor="middle" x="319.5" y="-371.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rhoofdsp</text>
</g>
<!-- proc~dhscf&#45;&gt;rhoofdsp -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge30" class="edge"><title>proc~dhscf&#45;&gt;rhoofdsp</title>
<path fill="none" stroke="#000000" d="M203.502,-855.763C208.797,-852.077 213.738,-847.511 217,-842 267.766,-756.245 191.08,-473.084 253,-395 260.101,-386.045 271.047,-380.851 281.97,-377.857"/>
<polygon fill="#000000" stroke="#000000" points="282.868,-381.243 291.885,-375.681 281.367,-374.406 282.868,-381.243"/>
</g>
<!-- get_field_from_dipole -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node34" class="node"><title>get_field_from_dipole</title>
<polygon fill="#777777" stroke="#777777" points="377,-344 262,-344 262,-320 377,-320 377,-344"/>
<text text-anchor="middle" x="319.5" y="-329.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_field_from_dipole</text>
</g>
<!-- proc~dhscf&#45;&gt;get_field_from_dipole -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge32" class="edge"><title>proc~dhscf&#45;&gt;get_field_from_dipole</title>
<path fill="none" stroke="#000000" d="M203.53,-855.779C208.823,-852.092 213.757,-847.522 217,-842 272.184,-748.047 185.592,-438.608 253,-353 253.598,-352.241 254.224,-351.508 254.874,-350.802"/>
<polygon fill="#000000" stroke="#000000" points="257.325,-353.314 262.71,-344.189 252.811,-347.964 257.325,-353.314"/>
</g>
<!-- vmatsp -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node35" class="node"><title>vmatsp</title>
<polygon fill="#777777" stroke="#777777" points="346.5,-302 292.5,-302 292.5,-278 346.5,-278 346.5,-302"/>
<text text-anchor="middle" x="319.5" y="-287.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">vmatsp</text>
</g>
<!-- proc~dhscf&#45;&gt;vmatsp -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge33" class="edge"><title>proc~dhscf&#45;&gt;vmatsp</title>
<path fill="none" stroke="#000000" d="M203.553,-855.792C208.845,-852.105 213.773,-847.531 217,-842 276.604,-739.846 180.102,-404.134 253,-311 260.157,-301.856 271.326,-296.629 282.428,-293.662"/>
<polygon fill="#000000" stroke="#000000" points="283.432,-297.027 292.487,-291.526 281.978,-290.18 283.432,-297.027"/>
</g>
<!-- add_potential_from_field -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node36" class="node"><title>add_potential_from_field</title>
<polygon fill="#777777" stroke="#777777" points="384.5,-260 254.5,-260 254.5,-236 384.5,-236 384.5,-260"/>
<text text-anchor="middle" x="319.5" y="-245.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">add_potential_from_field</text>
</g>
<!-- proc~dhscf&#45;&gt;add_potential_from_field -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge34" class="edge"><title>proc~dhscf&#45;&gt;add_potential_from_field</title>
<path fill="none" stroke="#000000" d="M203.573,-855.804C208.864,-852.116 213.786,-847.539 217,-842 281.024,-731.643 174.61,-369.662 253,-269 253.594,-268.237 254.216,-267.502 254.863,-266.793"/>
<polygon fill="#000000" stroke="#000000" points="257.317,-269.301 262.669,-260.157 252.783,-263.967 257.317,-269.301"/>
</g>
<!-- hartree_add -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node37" class="node"><title>hartree_add</title>
<polygon fill="#777777" stroke="#777777" points="355,-218 284,-218 284,-194 355,-194 355,-218"/>
<text text-anchor="middle" x="319.5" y="-203.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hartree_add</text>
</g>
<!-- proc~dhscf&#45;&gt;hartree_add -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge35" class="edge"><title>proc~dhscf&#45;&gt;hartree_add</title>
<path fill="none" stroke="#000000" d="M203.59,-855.814C208.881,-852.126 213.798,-847.546 217,-842 285.446,-723.438 169.118,-335.192 253,-227 258.312,-220.149 265.878,-215.495 273.993,-212.342"/>
<polygon fill="#000000" stroke="#000000" points="275.185,-215.636 283.669,-209.29 273.079,-208.961 275.185,-215.636"/>
</g>
<!-- proc~reord -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node39" class="node"><title>proc~reord</title>
<g id="a_proc~~setup_hamiltonian~~CallsGraph_node39"><a xlink:href=".././proc/reord.html" xlink:title="reord">
<polygon fill="#d9534f" stroke="#d9534f" points="760,-908 706,-908 706,-884 760,-884 760,-908"/>
<text text-anchor="middle" x="733" y="-893.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reord</text>
</a>
</g>
</g>
<!-- proc~dhscf&#45;&gt;proc~reord -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge36" class="edge"><title>proc~dhscf&#45;&gt;proc~reord</title>
<path fill="none" stroke="#000000" d="M203.562,-877.403C208.72,-880.376 213.587,-884.184 217,-889 278.596,-975.931 172.205,-1056.55 253,-1126 297.827,-1164.53 341.652,-1165.08 386,-1126 481.456,-1041.88 326.544,-926.12 422,-842 462.319,-806.469 623.767,-857.447 696.345,-882.95"/>
<polygon fill="#000000" stroke="#000000" points="695.379,-886.321 705.974,-886.367 697.721,-879.724 695.379,-886.321"/>
</g>
<!-- compute_partial_charges -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node40" class="node"><title>compute_partial_charges</title>
<polygon fill="#777777" stroke="#777777" points="386,-1606 253,-1606 253,-1582 386,-1582 386,-1606"/>
<text text-anchor="middle" x="319.5" y="-1591.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_partial_charges</text>
</g>
<!-- proc~dhscf&#45;&gt;compute_partial_charges -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge37" class="edge"><title>proc~dhscf&#45;&gt;compute_partial_charges</title>
<path fill="none" stroke="#000000" d="M203.512,-876.93C208.806,-879.946 213.744,-883.891 217,-889 298.8,-1017.36 160.091,-1452.43 253,-1573 253.59,-1573.77 254.208,-1574.5 254.852,-1575.22"/>
<polygon fill="#000000" stroke="#000000" points="252.757,-1578.03 262.63,-1581.87 257.309,-1572.71 252.757,-1578.03"/>
</g>
<!-- write_tdrho -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node42" class="node"><title>write_tdrho</title>
<polygon fill="#777777" stroke="#777777" points="352.5,-1564 286.5,-1564 286.5,-1540 352.5,-1540 352.5,-1564"/>
<text text-anchor="middle" x="319.5" y="-1549.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_tdrho</text>
</g>
<!-- proc~dhscf&#45;&gt;write_tdrho -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge38" class="edge"><title>proc~dhscf&#45;&gt;write_tdrho</title>
<path fill="none" stroke="#000000" d="M203.906,-877.172C209.046,-880.157 213.819,-884.028 217,-889 293.998,-1009.37 165.586,-1417.97 253,-1531 258.848,-1538.56 267.442,-1543.45 276.495,-1546.59"/>
<polygon fill="#000000" stroke="#000000" points="275.815,-1550.04 286.388,-1549.36 277.704,-1543.3 275.815,-1550.04"/>
</g>
<!-- mpi_barrier -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node43" class="node"><title>mpi_barrier</title>
<polygon fill="#777777" stroke="#777777" points="766.5,-1481 699.5,-1481 699.5,-1457 766.5,-1457 766.5,-1481"/>
<text text-anchor="middle" x="733" y="-1466.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_barrier</text>
</g>
<!-- proc~dhscf&#45;&gt;mpi_barrier -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge20" class="edge"><title>proc~dhscf&#45;&gt;mpi_barrier</title>
<path fill="none" stroke="#000000" d="M203.75,-877.274C208.898,-880.254 213.714,-884.097 217,-889 262.248,-956.525 225.252,-1176.6 253,-1253 258.692,-1268.67 407.26,-1493.21 422,-1501 511.487,-1548.31 635.742,-1509.38 696.155,-1484.99"/>
<polygon fill="#000000" stroke="#000000" points="697.731,-1488.13 705.634,-1481.07 695.055,-1481.66 697.731,-1488.13"/>
</g>
<!-- partialcoreonmesh -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node44" class="node"><title>partialcoreonmesh</title>
<polygon fill="#777777" stroke="#777777" points="370,-1522 269,-1522 269,-1498 370,-1498 370,-1522"/>
<text text-anchor="middle" x="319.5" y="-1507.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">partialcoreonmesh</text>
</g>
<!-- proc~dhscf&#45;&gt;partialcoreonmesh -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge40" class="edge"><title>proc~dhscf&#45;&gt;partialcoreonmesh</title>
<path fill="none" stroke="#000000" d="M203.889,-877.182C209.03,-880.167 213.808,-884.035 217,-889 288.626,-1000.43 175.316,-1376.71 253,-1484 255.249,-1487.11 257.929,-1489.84 260.901,-1492.25"/>
<polygon fill="#000000" stroke="#000000" points="259.094,-1495.25 269.354,-1497.89 262.981,-1489.43 259.094,-1495.25"/>
</g>
<!-- mymeshbox -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node45" class="node"><title>mymeshbox</title>
<polygon fill="#777777" stroke="#777777" points="505,-672 435,-672 435,-648 505,-648 505,-672"/>
<text text-anchor="middle" x="470" y="-657.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mymeshbox</text>
</g>
<!-- proc~dhscf&#45;&gt;mymeshbox -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge41" class="edge"><title>proc~dhscf&#45;&gt;mymeshbox</title>
<path fill="none" stroke="#000000" d="M203.69,-874.43C247.329,-883.444 335.137,-894.088 386,-849 443.142,-798.345 373.934,-740.336 422,-681 423.308,-679.385 424.766,-677.891 426.336,-676.508"/>
<polygon fill="#000000" stroke="#000000" points="428.758,-679.085 434.944,-670.483 424.744,-673.35 428.758,-679.085"/>
</g>
<!-- neutralatomonmesh -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node46" class="node"><title>neutralatomonmesh</title>
<polygon fill="#777777" stroke="#777777" points="373.5,-1244 265.5,-1244 265.5,-1220 373.5,-1220 373.5,-1244"/>
<text text-anchor="middle" x="319.5" y="-1229.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">neutralatomonmesh</text>
</g>
<!-- proc~dhscf&#45;&gt;neutralatomonmesh -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge42" class="edge"><title>proc~dhscf&#45;&gt;neutralatomonmesh</title>
<path fill="none" stroke="#000000" d="M203.703,-877.305C208.854,-880.283 213.683,-884.118 217,-889 297.923,-1008.11 161.789,-1099.57 253,-1211 254.276,-1212.56 255.669,-1214 257.157,-1215.34"/>
<polygon fill="#000000" stroke="#000000" points="255.134,-1218.2 265.297,-1221.19 259.219,-1212.52 255.134,-1218.2"/>
</g>
<!-- interface~distmeshdata -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node47" class="node"><title>interface~distmeshdata</title>
<g id="a_proc~~setup_hamiltonian~~CallsGraph_node47"><a xlink:href=".././interface/distmeshdata.html" xlink:title="distMeshData">
<polygon fill="#a7506f" stroke="#a7506f" points="509,-714 431,-714 431,-690 509,-690 509,-714"/>
<text text-anchor="middle" x="470" y="-699.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">distMeshData</text>
</a>
</g>
</g>
<!-- proc~dhscf&#45;&gt;interface~distmeshdata -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge43" class="edge"><title>proc~dhscf&#45;&gt;interface~distmeshdata</title>
<path fill="none" stroke="#000000" d="M203.748,-877.802C208.768,-880.729 213.532,-884.417 217,-889 262.558,-949.196 194.233,-1007.61 253,-1055 299.015,-1092.11 341.975,-1094.44 386,-1055 440.449,-1006.22 381.474,-788.845 422,-728 423.913,-725.128 426.254,-722.544 428.861,-720.223"/>
<polygon fill="#000000" stroke="#000000" points="431.314,-722.764 437.311,-714.03 427.177,-717.118 431.314,-722.764"/>
</g>
<!-- mpi_allreduce -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node49" class="node"><title>mpi_allreduce</title>
<polygon fill="#777777" stroke="#777777" points="359,-1046 280,-1046 280,-1022 359,-1022 359,-1046"/>
<text text-anchor="middle" x="319.5" y="-1031.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_allreduce</text>
</g>
<!-- proc~dhscf&#45;&gt;mpi_allreduce -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge45" class="edge"><title>proc~dhscf&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M203.511,-877.987C208.546,-880.903 213.376,-884.54 217,-889 253.189,-933.537 212.987,-971.863 253,-1013 257.811,-1017.95 263.787,-1021.73 270.157,-1024.62"/>
<polygon fill="#000000" stroke="#000000" points="269.092,-1027.96 279.682,-1028.26 271.587,-1021.42 269.092,-1027.96"/>
</g>
<!-- vacuum_level -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node50" class="node"><title>vacuum_level</title>
<polygon fill="#777777" stroke="#777777" points="358.5,-1004 280.5,-1004 280.5,-980 358.5,-980 358.5,-1004"/>
<text text-anchor="middle" x="319.5" y="-989.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">vacuum_level</text>
</g>
<!-- proc~dhscf&#45;&gt;vacuum_level -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge46" class="edge"><title>proc~dhscf&#45;&gt;vacuum_level</title>
<path fill="none" stroke="#000000" d="M203.899,-878.836C208.674,-881.638 213.302,-885.014 217,-889 244.07,-918.179 223.439,-944.348 253,-971 258.125,-975.62 264.273,-979.225 270.722,-982.037"/>
<polygon fill="#000000" stroke="#000000" points="269.708,-985.394 280.3,-985.615 272.157,-978.837 269.708,-985.394"/>
</g>
<!-- localchargeonmesh -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node51" class="node"><title>localchargeonmesh</title>
<polygon fill="#777777" stroke="#777777" points="372.5,-962 266.5,-962 266.5,-938 372.5,-938 372.5,-962"/>
<text text-anchor="middle" x="319.5" y="-947.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">localchargeonmesh</text>
</g>
<!-- proc~dhscf&#45;&gt;localchargeonmesh -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge48" class="edge"><title>proc~dhscf&#45;&gt;localchargeonmesh</title>
<path fill="none" stroke="#000000" d="M203.387,-880.081C208.101,-882.742 212.839,-885.748 217,-889 235.846,-903.727 232.917,-916.01 253,-929 255.623,-930.696 258.393,-932.265 261.254,-933.715"/>
<polygon fill="#000000" stroke="#000000" points="260.073,-937.022 270.627,-937.95 262.956,-930.643 260.073,-937.022"/>
</g>
<!-- write_debug -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node52" class="node"><title>write_debug</title>
<polygon fill="#777777" stroke="#777777" points="768.5,-1523 697.5,-1523 697.5,-1499 768.5,-1499 768.5,-1523"/>
<text text-anchor="middle" x="733" y="-1508.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_debug</text>
</g>
<!-- proc~dhscf&#45;&gt;write_debug -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge49" class="edge"><title>proc~dhscf&#45;&gt;write_debug</title>
<path fill="none" stroke="#000000" d="M203.835,-877.217C208.979,-880.2 213.772,-884.058 217,-889 275.258,-978.181 206.49,-1271.17 253,-1367 288.023,-1439.16 328.453,-1433.12 386,-1489 402.461,-1504.98 400.863,-1517.07 422,-1526 510.164,-1563.23 625.212,-1541.58 687.402,-1524.83"/>
<polygon fill="#000000" stroke="#000000" points="688.582,-1528.13 697.283,-1522.09 686.711,-1521.39 688.582,-1528.13"/>
</g>
<!-- proc~rhoofd -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node53" class="node"><title>proc~rhoofd</title>
<g id="a_proc~~setup_hamiltonian~~CallsGraph_node53"><a xlink:href=".././proc/rhoofd.html" xlink:title="rhoofd">
<polygon fill="#d9534f" stroke="#d9534f" points="346.5,-1202 292.5,-1202 292.5,-1178 346.5,-1178 346.5,-1202"/>
<text text-anchor="middle" x="319.5" y="-1187.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rhoofd</text>
</a>
</g>
</g>
<!-- proc~dhscf&#45;&gt;proc~rhoofd -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge50" class="edge"><title>proc~dhscf&#45;&gt;proc~rhoofd</title>
<path fill="none" stroke="#000000" d="M203.636,-877.352C208.79,-880.327 213.637,-884.149 217,-889 287.226,-990.304 177.274,-1066.74 253,-1164 260.325,-1173.41 271.565,-1179.42 282.678,-1183.26"/>
<polygon fill="#000000" stroke="#000000" points="281.727,-1186.63 292.309,-1186.11 283.71,-1179.92 281.727,-1186.63"/>
</g>
<!-- vmat -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node54" class="node"><title>vmat</title>
<polygon fill="#777777" stroke="#777777" points="346.5,-920 292.5,-920 292.5,-896 346.5,-896 346.5,-920"/>
<text text-anchor="middle" x="319.5" y="-905.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">vmat</text>
</g>
<!-- proc~dhscf&#45;&gt;vmat -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge51" class="edge"><title>proc~dhscf&#45;&gt;vmat</title>
<path fill="none" stroke="#000000" d="M203.691,-875.43C225.95,-881.745 258.119,-890.871 282.746,-897.857"/>
<polygon fill="#000000" stroke="#000000" points="281.874,-901.248 292.45,-900.61 283.785,-894.513 281.874,-901.248"/>
</g>
<!-- proc~write_rho -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node55" class="node"><title>proc~write_rho</title>
<g id="a_proc~~setup_hamiltonian~~CallsGraph_node55"><a xlink:href=".././proc/write_rho.html" xlink:title="write_rho">
<polygon fill="#d9534f" stroke="#d9534f" points="632.5,-1678 575.5,-1678 575.5,-1654 632.5,-1654 632.5,-1678"/>
<text text-anchor="middle" x="604" y="-1663.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_rho</text>
</a>
</g>
</g>
<!-- proc~dhscf&#45;&gt;proc~write_rho -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge52" class="edge"><title>proc~dhscf&#45;&gt;proc~write_rho</title>
<path fill="none" stroke="#000000" d="M203.531,-876.918C208.824,-879.934 213.758,-883.883 217,-889 262.188,-960.317 193.419,-1588.18 253,-1648 295.736,-1690.91 483.635,-1677.97 565.103,-1670.09"/>
<polygon fill="#000000" stroke="#000000" points="565.805,-1673.54 575.41,-1669.07 565.113,-1666.57 565.805,-1673.54"/>
</g>
<!-- pxfflush -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node32" class="node"><title>pxfflush</title>
<polygon fill="#777777" stroke="#777777" points="872.5,-1948 818.5,-1948 818.5,-1924 872.5,-1924 872.5,-1948"/>
<text text-anchor="middle" x="845.5" y="-1933.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pxfflush</text>
</g>
<!-- proc~bye&#45;&gt;pxfflush -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge53" class="edge"><title>proc~bye&#45;&gt;pxfflush</title>
<path fill="none" stroke="#000000" d="M346.754,-1903.2C367.227,-1905.61 396.389,-1908.86 422,-1911 564.722,-1922.95 735.037,-1931.2 808.19,-1934.45"/>
<polygon fill="#000000" stroke="#000000" points="808.119,-1937.95 818.264,-1934.89 808.428,-1930.96 808.119,-1937.95"/>
</g>
<!-- cmlfinishfile -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node38" class="node"><title>cmlfinishfile</title>
<polygon fill="#777777" stroke="#777777" points="879,-1903 812,-1903 812,-1879 879,-1879 879,-1903"/>
<text text-anchor="middle" x="845.5" y="-1888.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cmlfinishfile</text>
</g>
<!-- proc~bye&#45;&gt;cmlfinishfile -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge55" class="edge"><title>proc~bye&#45;&gt;cmlfinishfile</title>
<path fill="none" stroke="#000000" d="M346.844,-1899.55C431.516,-1898.09 697.244,-1893.53 801.714,-1891.73"/>
<polygon fill="#000000" stroke="#000000" points="801.955,-1895.23 811.893,-1891.56 801.835,-1888.23 801.955,-1895.23"/>
</g>
<!-- mpi_finalize -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node41" class="node"><title>mpi_finalize</title>
<polygon fill="#777777" stroke="#777777" points="504.5,-1872 435.5,-1872 435.5,-1848 504.5,-1848 504.5,-1872"/>
<text text-anchor="middle" x="470" y="-1857.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_finalize</text>
</g>
<!-- proc~bye&#45;&gt;mpi_finalize -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge54" class="edge"><title>proc~bye&#45;&gt;mpi_finalize</title>
<path fill="none" stroke="#000000" d="M346.707,-1892.94C368.539,-1887.06 400.081,-1878.56 425.663,-1871.67"/>
<polygon fill="#000000" stroke="#000000" points="426.754,-1875 435.499,-1869.02 424.933,-1868.25 426.754,-1875"/>
</g>
<!-- mpi_abort -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node18" class="node"><title>mpi_abort</title>
<polygon fill="#777777" stroke="#777777" points="876,-1856 815,-1856 815,-1832 876,-1832 876,-1856"/>
<text text-anchor="middle" x="845.5" y="-1841.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_abort</text>
</g>
<!-- proc~die&#45;&gt;mpi_abort -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge60" class="edge"><title>proc~die&#45;&gt;mpi_abort</title>
<path fill="none" stroke="#000000" d="M760.187,-1831.03C773.565,-1833.09 790.122,-1835.63 805.012,-1837.92"/>
<polygon fill="#000000" stroke="#000000" points="804.579,-1841.4 814.995,-1839.46 805.643,-1834.48 804.579,-1841.4"/>
</g>
<!-- io_close -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node29" class="node"><title>io_close</title>
<polygon fill="#777777" stroke="#777777" points="872.5,-1700 818.5,-1700 818.5,-1676 872.5,-1676 872.5,-1700"/>
<text text-anchor="middle" x="845.5" y="-1685.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">io_close</text>
</g>
<!-- proc~die&#45;&gt;io_close -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge56" class="edge"><title>proc~die&#45;&gt;io_close</title>
<path fill="none" stroke="#000000" d="M758.823,-1814.76C764.951,-1810.95 771.142,-1806.32 776,-1801 800.126,-1774.58 792.785,-1759.18 812,-1729 816.596,-1721.78 822.212,-1714.32 827.473,-1707.78"/>
<polygon fill="#000000" stroke="#000000" points="830.175,-1710 833.846,-1700.06 824.778,-1705.54 830.175,-1710"/>
</g>
<!-- io_assign -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node31" class="node"><title>io_assign</title>
<polygon fill="#777777" stroke="#777777" points="874.5,-1762 816.5,-1762 816.5,-1738 874.5,-1738 874.5,-1762"/>
<text text-anchor="middle" x="845.5" y="-1747.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">io_assign</text>
</g>
<!-- proc~die&#45;&gt;io_assign -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge58" class="edge"><title>proc~die&#45;&gt;io_assign</title>
<path fill="none" stroke="#000000" d="M754.306,-1814.91C761.266,-1810.64 769.05,-1805.73 776,-1801 791.287,-1790.61 807.933,-1778.24 820.988,-1768.28"/>
<polygon fill="#000000" stroke="#000000" points="823.195,-1771 828.997,-1762.14 818.933,-1765.45 823.195,-1771"/>
</g>
<!-- proc~die&#45;&gt;pxfflush -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge61" class="edge"><title>proc~die&#45;&gt;pxfflush</title>
<path fill="none" stroke="#000000" d="M743.927,-1839.23C758.133,-1856.38 785.486,-1888.17 812,-1912 814.152,-1913.93 816.454,-1915.87 818.802,-1917.75"/>
<polygon fill="#000000" stroke="#000000" points="816.745,-1920.59 826.812,-1923.89 821.003,-1915.03 816.745,-1920.59"/>
</g>
<!-- proc~die&#45;&gt;cmlfinishfile -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge57" class="edge"><title>proc~die&#45;&gt;cmlfinishfile</title>
<path fill="none" stroke="#000000" d="M754.784,-1839.04C771.654,-1848.81 795.662,-1862.71 814.598,-1873.68"/>
<polygon fill="#000000" stroke="#000000" points="813.026,-1876.82 823.433,-1878.8 816.534,-1870.76 813.026,-1876.82"/>
</g>
<!-- pxfabort -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node48" class="node"><title>pxfabort</title>
<polygon fill="#777777" stroke="#777777" points="872.5,-1814 818.5,-1814 818.5,-1790 872.5,-1790 872.5,-1814"/>
<text text-anchor="middle" x="845.5" y="-1799.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pxfabort</text>
</g>
<!-- proc~die&#45;&gt;pxfabort -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge59" class="edge"><title>proc~die&#45;&gt;pxfabort</title>
<path fill="none" stroke="#000000" d="M760.187,-1821.08C774.532,-1817.83 792.53,-1813.76 808.211,-1810.21"/>
<polygon fill="#000000" stroke="#000000" points="809.137,-1813.59 818.118,-1807.97 807.592,-1806.76 809.137,-1813.59"/>
</g>
<!-- proc~forhar&#45;&gt;de_alloc -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge66" class="edge"><title>proc~forhar&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M346.614,-823.692C360.239,-820.118 376.088,-813.646 386,-802 434.086,-745.503 364.159,-685.46 422,-639 476.565,-595.171 654.308,-573.283 776,-660 820.342,-691.598 836.333,-758.413 841.818,-793.461"/>
<polygon fill="#000000" stroke="#000000" points="838.391,-794.226 843.252,-803.64 845.322,-793.249 838.391,-794.226"/>
</g>
<!-- proc~forhar&#45;&gt;re_alloc -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge64" class="edge"><title>proc~forhar&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M346.796,-823.843C360.475,-820.315 376.318,-813.839 386,-802 443.177,-732.086 362.651,-670.08 422,-602 442.261,-578.758 659.336,-533.233 690,-530 728.012,-525.992 737.972,-526.154 776,-530 786.597,-531.072 797.978,-533.054 808.36,-535.196"/>
<polygon fill="#000000" stroke="#000000" points="807.828,-538.662 818.343,-537.364 809.313,-531.821 807.828,-538.662"/>
</g>
<!-- proc~forhar&#45;&gt;jms_setmeshdistr -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge67" class="edge"><title>proc~forhar&#45;&gt;jms_setmeshdistr</title>
<path fill="none" stroke="#000000" d="M346.592,-824.027C360.384,-820.549 376.401,-814.063 386,-802 452.067,-718.977 361.353,-653.061 422,-566 424.034,-563.08 426.505,-560.454 429.239,-558.097"/>
<polygon fill="#000000" stroke="#000000" points="431.423,-560.838 437.492,-552.153 427.332,-555.157 431.423,-560.838"/>
</g>
<!-- proc~forhar&#45;&gt;bsc_cellxc -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge68" class="edge"><title>proc~forhar&#45;&gt;bsc_cellxc</title>
<path fill="none" stroke="#000000" d="M340.25,-815.815C355.382,-805.355 375.406,-788.848 386,-769 438.86,-669.967 354.349,-608.583 422,-519 424.415,-515.802 427.427,-513.08 430.751,-510.765"/>
<polygon fill="#000000" stroke="#000000" points="432.521,-513.785 439.498,-505.811 429.072,-507.693 432.521,-513.785"/>
</g>
<!-- proc~forhar&#45;&gt;proc~setmeshdistr -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge63" class="edge"><title>proc~forhar&#45;&gt;proc~setmeshdistr</title>
<path fill="none" stroke="#000000" d="M340.36,-815.873C355.554,-805.446 375.609,-788.954 386,-769 446.396,-653.023 396.011,-605.152 422,-477 432.538,-425.036 451.146,-365.558 461.506,-334.142"/>
<polygon fill="#000000" stroke="#000000" points="464.959,-334.851 464.8,-324.258 458.318,-332.638 464.959,-334.851"/>
</g>
<!-- proc~forhar&#45;&gt;mymeshbox -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge62" class="edge"><title>proc~forhar&#45;&gt;mymeshbox</title>
<path fill="none" stroke="#000000" d="M346.616,-823.318C360.071,-819.642 375.759,-813.193 386,-802 423.876,-760.606 385.008,-723.186 422,-681 423.326,-679.488 424.782,-678.08 426.334,-676.768"/>
<polygon fill="#000000" stroke="#000000" points="428.489,-679.535 434.752,-670.99 424.527,-673.764 428.489,-679.535"/>
</g>
<!-- proc~forhar&#45;&gt;interface~distmeshdata -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge65" class="edge"><title>proc~forhar&#45;&gt;interface~distmeshdata</title>
<path fill="none" stroke="#000000" d="M346.557,-822.431C359.669,-818.533 375.058,-812.152 386,-802 412.812,-777.125 396.826,-754.532 422,-728 424.96,-724.88 428.38,-722.04 431.997,-719.481"/>
<polygon fill="#000000" stroke="#000000" points="434.074,-722.309 440.672,-714.018 430.345,-716.385 434.074,-722.309"/>
</g>
<!-- proc~reord&#45;&gt;timer -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge71" class="edge"><title>proc~reord&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M760.093,-907.254C766.211,-911.079 772.08,-915.956 776,-922 829.133,-1003.92 841.527,-1319.09 843.967,-1406.44"/>
<polygon fill="#000000" stroke="#000000" points="840.471,-1406.67 844.233,-1416.58 847.469,-1406.49 840.471,-1406.67"/>
</g>
<!-- proc~reord&#45;&gt;de_alloc -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge70" class="edge"><title>proc~reord&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M754.808,-883.761C761.664,-879.56 769.257,-874.723 776,-870 791.873,-858.884 808.994,-845.387 822.148,-834.669"/>
<polygon fill="#000000" stroke="#000000" points="824.663,-837.132 830.167,-828.079 820.219,-831.724 824.663,-837.132"/>
</g>
<!-- proc~reord&#45;&gt;re_alloc -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge69" class="edge"><title>proc~reord&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M744.894,-883.769C754.451,-872.413 768.031,-854.647 776,-837 818.973,-741.835 836.6,-616.655 842.263,-566.347"/>
<polygon fill="#000000" stroke="#000000" points="845.758,-566.579 843.349,-556.262 838.799,-565.83 845.758,-566.579"/>
</g>
<!-- proc~distmeshdata_rea -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node59" class="node"><title>proc~distmeshdata_rea</title>
<g id="a_proc~~setup_hamiltonian~~CallsGraph_node59"><a xlink:href=".././proc/distmeshdata_rea.html" xlink:title="distMeshData_rea">
<polygon fill="#d9534f" stroke="#d9534f" points="654,-828 554,-828 554,-804 654,-804 654,-828"/>
<text text-anchor="middle" x="604" y="-813.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">distMeshData_rea</text>
</a>
</g>
</g>
<!-- interface~distmeshdata&#45;&gt;proc~distmeshdata_rea -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge72" class="edge"><title>interface~distmeshdata&#45;&gt;proc~distmeshdata_rea</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M485.126,-714.2C508.151,-734.085 553.928,-773.62 581.164,-797.142"/>
<polygon fill="#000000" stroke="#000000" points="579.119,-800 588.975,-803.888 583.695,-794.703 579.119,-800"/>
</g>
<!-- proc~distmeshdata_int -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node69" class="node"><title>proc~distmeshdata_int</title>
<g id="a_proc~~setup_hamiltonian~~CallsGraph_node69"><a xlink:href=".././proc/distmeshdata_int.html" xlink:title="distMeshData_int">
<polygon fill="#d9534f" stroke="#d9534f" points="651.5,-710 556.5,-710 556.5,-686 651.5,-686 651.5,-710"/>
<text text-anchor="middle" x="604" y="-695.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">distMeshData_int</text>
</a>
</g>
</g>
<!-- interface~distmeshdata&#45;&gt;proc~distmeshdata_int -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge73" class="edge"><title>interface~distmeshdata&#45;&gt;proc~distmeshdata_int</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M509.18,-700.843C520.72,-700.493 533.649,-700.102 546.134,-699.723"/>
<polygon fill="#000000" stroke="#000000" points="546.587,-703.211 556.476,-699.41 546.375,-696.214 546.587,-703.211"/>
</g>
<!-- proc~rhoofd&#45;&gt;timer -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge81" class="edge"><title>proc~rhoofd&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M346.712,-1192.02C360.366,-1194.46 376.212,-1199.73 386,-1211 448.095,-1282.49 350.186,-1359.28 422,-1421 479.131,-1470.1 716.502,-1445.57 808.161,-1433.95"/>
<polygon fill="#000000" stroke="#000000" points="808.874,-1437.38 818.343,-1432.63 807.977,-1430.44 808.874,-1437.38"/>
</g>
<!-- proc~rhoofd&#45;&gt;de_alloc -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge86" class="edge"><title>proc~rhoofd&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M346.55,-1182.56C360.508,-1177.2 376.701,-1168.48 386,-1155 457.254,-1051.73 327.793,-957.87 422,-875 454.036,-846.819 475.639,-869.903 518,-875 633.344,-888.879 673.353,-971.411 776,-917 807.449,-900.329 827.122,-862.042 836.931,-837.689"/>
<polygon fill="#000000" stroke="#000000" points="840.253,-838.8 840.536,-828.209 833.71,-836.312 840.253,-838.8"/>
</g>
<!-- proc~rhoofd&#45;&gt;re_alloc -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge78" class="edge"><title>proc~rhoofd&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M330.318,-1177.8C344.967,-1158.91 372.288,-1120.91 386,-1084 421.423,-988.657 382.951,-951.916 422,-858 426.778,-846.508 545.024,-685.621 554,-677 606.455,-626.623 623.82,-616.157 690,-586 728.801,-568.319 776.576,-556.747 808.639,-550.312"/>
<polygon fill="#000000" stroke="#000000" points="809.317,-553.745 818.465,-548.401 807.981,-546.874 809.317,-553.745"/>
</g>
<!-- proc~rhoofd&#45;&gt;proc~die -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge89" class="edge"><title>proc~rhoofd&#45;&gt;proc~die</title>
<path fill="none" stroke="#000000" d="M346.59,-1191.78C360.382,-1194.15 376.399,-1199.41 386,-1211 427.437,-1261 401.317,-1439.44 422,-1501 459.294,-1611.99 470.318,-1647.1 554,-1729 595.542,-1769.66 657.351,-1798.58 696.126,-1814.02"/>
<polygon fill="#000000" stroke="#000000" points="695.349,-1817.48 705.938,-1817.84 697.887,-1810.95 695.349,-1817.48"/>
</g>
<!-- phi -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node56" class="node"><title>phi</title>
<polygon fill="#777777" stroke="#777777" points="497,-1286 443,-1286 443,-1262 497,-1262 497,-1286"/>
<text text-anchor="middle" x="470" y="-1271.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">phi</text>
</g>
<!-- proc~rhoofd&#45;&gt;phi -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge74" class="edge"><title>proc~rhoofd&#45;&gt;phi</title>
<path fill="none" stroke="#000000" d="M346.527,-1194.85C359.176,-1198.05 374.162,-1203.14 386,-1211 406.481,-1224.6 402.298,-1238.29 422,-1253 425.644,-1255.72 429.695,-1258.19 433.849,-1260.4"/>
<polygon fill="#000000" stroke="#000000" points="432.46,-1263.61 442.986,-1264.82 435.508,-1257.31 432.46,-1263.61"/>
</g>
<!-- indxuo -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node57" class="node"><title>indxuo</title>
<polygon fill="#777777" stroke="#777777" points="497,-1244 443,-1244 443,-1220 497,-1220 497,-1244"/>
<text text-anchor="middle" x="470" y="-1229.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">indxuo</text>
</g>
<!-- proc~rhoofd&#45;&gt;indxuo -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge75" class="edge"><title>proc~rhoofd&#45;&gt;indxuo</title>
<path fill="none" stroke="#000000" d="M346.707,-1197.41C370.629,-1204.18 406.21,-1214.24 432.833,-1221.77"/>
<polygon fill="#000000" stroke="#000000" points="431.98,-1225.17 442.555,-1224.52 433.886,-1218.43 431.98,-1225.17"/>
</g>
<!-- listsc -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node58" class="node"><title>listsc</title>
<polygon fill="#777777" stroke="#777777" points="497,-1202 443,-1202 443,-1178 497,-1178 497,-1202"/>
<text text-anchor="middle" x="470" y="-1187.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">listsc</text>
</g>
<!-- proc~rhoofd&#45;&gt;listsc -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge76" class="edge"><title>proc~rhoofd&#45;&gt;listsc</title>
<path fill="none" stroke="#000000" d="M346.707,-1190C370.523,-1190 405.896,-1190 432.481,-1190"/>
<polygon fill="#000000" stroke="#000000" points="432.556,-1193.5 442.555,-1190 432.555,-1186.5 432.556,-1193.5"/>
</g>
<!-- endpht -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node60" class="node"><title>endpht</title>
<polygon fill="#777777" stroke="#777777" points="497,-1160 443,-1160 443,-1136 497,-1136 497,-1160"/>
<text text-anchor="middle" x="470" y="-1145.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">endpht</text>
</g>
<!-- proc~rhoofd&#45;&gt;endpht -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge77" class="edge"><title>proc~rhoofd&#45;&gt;endpht</title>
<path fill="none" stroke="#000000" d="M346.707,-1182.59C370.629,-1175.82 406.21,-1165.76 432.833,-1158.23"/>
<polygon fill="#000000" stroke="#000000" points="433.886,-1161.57 442.555,-1155.48 431.98,-1154.83 433.886,-1161.57"/>
</g>
<!-- listp2 -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node62" class="node"><title>listp2</title>
<polygon fill="#777777" stroke="#777777" points="497,-1118 443,-1118 443,-1094 497,-1094 497,-1118"/>
<text text-anchor="middle" x="470" y="-1103.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">listp2</text>
</g>
<!-- proc~rhoofd&#45;&gt;listp2 -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge79" class="edge"><title>proc~rhoofd&#45;&gt;listp2</title>
<path fill="none" stroke="#000000" d="M346.612,-1182.47C359.137,-1178.16 373.992,-1172.01 386,-1164 405.084,-1151.26 403.189,-1140.14 422,-1127 425.545,-1124.52 429.428,-1122.23 433.395,-1120.15"/>
<polygon fill="#000000" stroke="#000000" points="435.203,-1123.16 442.685,-1115.66 432.158,-1116.86 435.203,-1123.16"/>
</g>
<!-- needdscfl -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node63" class="node"><title>needdscfl</title>
<polygon fill="#777777" stroke="#777777" points="499,-1076 441,-1076 441,-1052 499,-1052 499,-1076"/>
<text text-anchor="middle" x="470" y="-1061.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">needdscfl</text>
</g>
<!-- proc~rhoofd&#45;&gt;needdscfl -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge80" class="edge"><title>proc~rhoofd&#45;&gt;needdscfl</title>
<path fill="none" stroke="#000000" d="M346.663,-1184.54C359.804,-1180.68 375.186,-1174.29 386,-1164 413.953,-1137.4 394.616,-1112.18 422,-1085 424.844,-1082.18 428.134,-1079.7 431.627,-1077.53"/>
<polygon fill="#000000" stroke="#000000" points="433.403,-1080.55 440.586,-1072.76 430.114,-1074.37 433.403,-1080.55"/>
</g>
<!-- listdlptr -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node64" class="node"><title>listdlptr</title>
<polygon fill="#777777" stroke="#777777" points="497,-1034 443,-1034 443,-1010 497,-1010 497,-1034"/>
<text text-anchor="middle" x="470" y="-1019.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">listdlptr</text>
</g>
<!-- proc~rhoofd&#45;&gt;listdlptr -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge82" class="edge"><title>proc~rhoofd&#45;&gt;listdlptr</title>
<path fill="none" stroke="#000000" d="M346.616,-1185.32C360.071,-1181.64 375.759,-1175.19 386,-1164 423.876,-1122.61 385.008,-1085.19 422,-1043 425.219,-1039.33 429.204,-1036.27 433.481,-1033.73"/>
<polygon fill="#000000" stroke="#000000" points="435.145,-1036.81 442.522,-1029.2 432.013,-1030.55 435.145,-1036.81"/>
</g>
<!-- matrixotom -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node65" class="node"><title>matrixotom</title>
<polygon fill="#777777" stroke="#777777" points="503,-992 437,-992 437,-968 503,-968 503,-992"/>
<text text-anchor="middle" x="470" y="-977.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">matrixotom</text>
</g>
<!-- proc~rhoofd&#45;&gt;matrixotom -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge83" class="edge"><title>proc~rhoofd&#45;&gt;matrixotom</title>
<path fill="none" stroke="#000000" d="M346.614,-1185.69C360.239,-1182.12 376.088,-1175.65 386,-1164 434.086,-1107.5 375.12,-1058.5 422,-1001 423.853,-998.727 426.003,-996.692 428.344,-994.871"/>
<polygon fill="#000000" stroke="#000000" points="430.302,-997.774 436.881,-989.469 426.559,-991.858 430.302,-997.774"/>
</g>
<!-- lstpht -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node66" class="node"><title>lstpht</title>
<polygon fill="#777777" stroke="#777777" points="497,-950 443,-950 443,-926 497,-926 497,-950"/>
<text text-anchor="middle" x="470" y="-935.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lstpht</text>
</g>
<!-- proc~rhoofd&#45;&gt;lstpht -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge84" class="edge"><title>proc~rhoofd&#45;&gt;lstpht</title>
<path fill="none" stroke="#000000" d="M346.815,-1185.86C360.501,-1182.34 376.344,-1175.86 386,-1164 444.41,-1092.27 365.121,-1031.95 422,-959 425.067,-955.066 429.031,-951.85 433.354,-949.224"/>
<polygon fill="#000000" stroke="#000000" points="435.18,-952.225 442.562,-944.626 432.052,-945.962 435.18,-952.225"/>
</g>
<!-- globaltolocalorb -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node67" class="node"><title>globaltolocalorb</title>
<polygon fill="#777777" stroke="#777777" points="514,-908 426,-908 426,-884 514,-884 514,-908"/>
<text text-anchor="middle" x="470" y="-893.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">globaltolocalorb</text>
</g>
<!-- proc~rhoofd&#45;&gt;globaltolocalorb -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge85" class="edge"><title>proc~rhoofd&#45;&gt;globaltolocalorb</title>
<path fill="none" stroke="#000000" d="M346.623,-1186.05C360.425,-1182.58 376.441,-1176.09 386,-1164 454.789,-1076.96 355.068,-1005.47 422,-917 422.566,-916.252 423.165,-915.529 423.793,-914.832"/>
<polygon fill="#000000" stroke="#000000" points="426.128,-917.44 431.463,-908.287 421.584,-912.116 426.128,-917.44"/>
</g>
<!-- numdl -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node68" class="node"><title>numdl</title>
<polygon fill="#777777" stroke="#777777" points="497,-1412 443,-1412 443,-1388 497,-1388 497,-1412"/>
<text text-anchor="middle" x="470" y="-1397.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">numdl</text>
</g>
<!-- proc~rhoofd&#45;&gt;numdl -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge87" class="edge"><title>proc~rhoofd&#45;&gt;numdl</title>
<path fill="none" stroke="#000000" d="M346.531,-1192.18C360.13,-1194.67 375.981,-1199.93 386,-1211 437.253,-1267.61 373.934,-1319.66 422,-1379 425.14,-1382.88 429.144,-1386.06 433.488,-1388.67"/>
<polygon fill="#000000" stroke="#000000" points="432.197,-1391.94 442.71,-1393.26 435.315,-1385.67 432.197,-1391.94"/>
</g>
<!-- proc~rcut -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node71" class="node"><title>proc~rcut</title>
<g id="a_proc~~setup_hamiltonian~~CallsGraph_node71"><a xlink:href=".././proc/rcut.html" xlink:title="rcut">
<polygon fill="#d94e8f" stroke="#d94e8f" points="497,-1492 443,-1492 443,-1468 497,-1468 497,-1492"/>
<text text-anchor="middle" x="470" y="-1477.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rcut</text>
</a>
</g>
</g>
<!-- proc~rhoofd&#45;&gt;proc~rcut -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge88" class="edge"><title>proc~rhoofd&#45;&gt;proc~rcut</title>
<path fill="none" stroke="#000000" d="M346.813,-1191.93C360.497,-1194.35 376.34,-1199.62 386,-1211 456.652,-1294.24 359.787,-1364.28 422,-1454 425.188,-1458.6 429.464,-1462.47 434.142,-1465.7"/>
<polygon fill="#000000" stroke="#000000" points="432.459,-1468.77 442.849,-1470.85 436.021,-1462.75 432.459,-1468.77"/>
</g>
<!-- dscfl -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node72" class="node"><title>dscfl</title>
<polygon fill="#777777" stroke="#777777" points="497,-1370 443,-1370 443,-1346 497,-1346 497,-1370"/>
<text text-anchor="middle" x="470" y="-1355.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dscfl</text>
</g>
<!-- proc~rhoofd&#45;&gt;dscfl -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge90" class="edge"><title>proc~rhoofd&#45;&gt;dscfl</title>
<path fill="none" stroke="#000000" d="M346.568,-1192.51C360.009,-1195.1 375.698,-1200.36 386,-1211 426.519,-1252.84 383.84,-1293 422,-1337 425.268,-1340.77 429.345,-1343.89 433.723,-1346.47"/>
<polygon fill="#000000" stroke="#000000" points="432.454,-1349.75 442.97,-1351.04 435.554,-1343.47 432.454,-1349.75"/>
</g>
<!-- listdl -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node73" class="node"><title>listdl</title>
<polygon fill="#777777" stroke="#777777" points="497,-1328 443,-1328 443,-1304 497,-1304 497,-1328"/>
<text text-anchor="middle" x="470" y="-1313.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">listdl</text>
</g>
<!-- proc~rhoofd&#45;&gt;listdl -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge91" class="edge"><title>proc~rhoofd&#45;&gt;listdl</title>
<path fill="none" stroke="#000000" d="M346.692,-1193.18C359.842,-1195.97 375.223,-1201.2 386,-1211 416.047,-1238.33 393.5,-1266.06 422,-1295 425.426,-1298.48 429.529,-1301.43 433.865,-1303.92"/>
<polygon fill="#000000" stroke="#000000" points="432.434,-1307.11 442.951,-1308.4 435.531,-1300.84 432.434,-1307.11"/>
</g>
<!-- proc~write_rho&#45;&gt;de_alloc -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge96" class="edge"><title>proc~write_rho&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M621.853,-1653.97C663.156,-1624.31 766.743,-1548.92 776,-1532 843.675,-1408.34 845.26,-945.897 844.691,-838.417"/>
<polygon fill="#000000" stroke="#000000" points="848.189,-838.092 844.623,-828.115 841.189,-838.138 848.189,-838.092"/>
</g>
<!-- proc~write_rho&#45;&gt;io_close -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge92" class="edge"><title>proc~write_rho&#45;&gt;io_close</title>
<path fill="none" stroke="#000000" d="M632.942,-1668.57C676.397,-1672.56 760.159,-1680.25 808.223,-1684.67"/>
<polygon fill="#000000" stroke="#000000" points="807.918,-1688.15 818.197,-1685.58 808.559,-1681.18 807.918,-1688.15"/>
</g>
<!-- proc~write_rho&#45;&gt;io_assign -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge93" class="edge"><title>proc~write_rho&#45;&gt;io_assign</title>
<path fill="none" stroke="#000000" d="M632.676,-1675.2C639.987,-1678.32 647.613,-1682.25 654,-1687 674.002,-1701.87 668.142,-1718.02 690,-1730 725.957,-1749.7 773.506,-1753.08 806.309,-1752.56"/>
<polygon fill="#000000" stroke="#000000" points="806.513,-1756.06 816.408,-1752.28 806.312,-1749.06 806.513,-1756.06"/>
</g>
<!-- proc~write_rho&#45;&gt;mpi_barrier -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge95" class="edge"><title>proc~write_rho&#45;&gt;mpi_barrier</title>
<path fill="none" stroke="#000000" d="M610.781,-1653.97C629.79,-1614.4 689.2,-1490.81 690,-1490 690.934,-1489.05 691.919,-1488.14 692.946,-1487.27"/>
<polygon fill="#000000" stroke="#000000" points="695.332,-1489.86 701.45,-1481.21 691.273,-1484.16 695.332,-1489.86"/>
</g>
<!-- proc~write_rho&#45;&gt;write_debug -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge97" class="edge"><title>proc~write_rho&#45;&gt;write_debug</title>
<path fill="none" stroke="#000000" d="M615.33,-1653.65C625.662,-1641.05 641.737,-1620.73 654,-1602 672.087,-1574.37 667.222,-1560.91 690,-1537 692.782,-1534.08 695.959,-1531.35 699.293,-1528.85"/>
<polygon fill="#000000" stroke="#000000" points="701.455,-1531.62 707.765,-1523.1 697.525,-1525.82 701.455,-1531.62"/>
</g>
<!-- mpi_wait -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node61" class="node"><title>mpi_wait</title>
<polygon fill="#777777" stroke="#777777" points="760.5,-1721 705.5,-1721 705.5,-1697 760.5,-1697 760.5,-1721"/>
<text text-anchor="middle" x="733" y="-1706.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_wait</text>
</g>
<!-- proc~write_rho&#45;&gt;mpi_wait -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge94" class="edge"><title>proc~write_rho&#45;&gt;mpi_wait</title>
<path fill="none" stroke="#000000" d="M632.557,-1675.33C651.03,-1681.58 675.554,-1689.89 695.626,-1696.68"/>
<polygon fill="#000000" stroke="#000000" points="694.773,-1700.09 705.367,-1699.98 697.018,-1693.46 694.773,-1700.09"/>
</g>
<!-- mpi_irecv -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node70" class="node"><title>mpi_irecv</title>
<polygon fill="#777777" stroke="#777777" points="762,-1641 704,-1641 704,-1617 762,-1617 762,-1641"/>
<text text-anchor="middle" x="733" y="-1626.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_irecv</text>
</g>
<!-- proc~write_rho&#45;&gt;mpi_irecv -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge98" class="edge"><title>proc~write_rho&#45;&gt;mpi_irecv</title>
<path fill="none" stroke="#000000" d="M632.557,-1657.97C650.531,-1652.74 674.233,-1645.83 693.989,-1640.07"/>
<polygon fill="#000000" stroke="#000000" points="694.995,-1643.43 703.617,-1637.27 693.037,-1636.71 694.995,-1643.43"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;timer -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge103" class="edge"><title>proc~distmeshdata_rea&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M609.784,-828.245C639.395,-904.033 797.671,-1309.14 836.093,-1407.48"/>
<polygon fill="#000000" stroke="#000000" points="832.904,-1408.94 839.803,-1416.98 839.424,-1406.39 832.904,-1408.94"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;de_alloc -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge105" class="edge"><title>proc~distmeshdata_rea&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M645.269,-828.067C659.29,-831.701 675.212,-835.2 690,-837 727.942,-841.618 738.2,-842.664 776,-837 786.814,-835.38 798.278,-832.396 808.671,-829.176"/>
<polygon fill="#000000" stroke="#000000" points="809.828,-832.481 818.251,-826.054 807.658,-825.825 809.828,-832.481"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;re_alloc -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge102" class="edge"><title>proc~distmeshdata_rea&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M640.829,-803.946C679.111,-789.386 739.234,-761.434 776,-719 815.692,-673.189 833.85,-601.705 840.825,-565.936"/>
<polygon fill="#000000" stroke="#000000" points="844.276,-566.518 842.642,-556.05 837.392,-565.253 844.276,-566.518"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;proc~die -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge107" class="edge"><title>proc~distmeshdata_rea&#45;&gt;proc~die</title>
<path fill="none" stroke="#000000" d="M604.705,-828.097C603.036,-908.22 597.891,-1370.28 690,-1730 696.978,-1757.25 710.657,-1786.64 720.511,-1805.84"/>
<polygon fill="#000000" stroke="#000000" points="717.513,-1807.66 725.259,-1814.89 723.71,-1804.41 717.513,-1807.66"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;proc~reord -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge101" class="edge"><title>proc~distmeshdata_rea&#45;&gt;proc~reord</title>
<path fill="none" stroke="#000000" d="M629.651,-828.017C637.592,-832.167 646.32,-837.029 654,-842 671.016,-853.014 673.359,-858.427 690,-870 694.097,-872.849 698.501,-875.746 702.861,-878.522"/>
<polygon fill="#000000" stroke="#000000" points="701.3,-881.674 711.637,-883.997 705.005,-875.735 701.3,-881.674"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;mpi_barrier -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge104" class="edge"><title>proc~distmeshdata_rea&#45;&gt;mpi_barrier</title>
<path fill="none" stroke="#000000" d="M607.368,-828.175C622.668,-906.844 707.563,-1343.35 727.711,-1446.94"/>
<polygon fill="#000000" stroke="#000000" points="724.304,-1447.76 729.648,-1456.91 731.175,-1446.42 724.304,-1447.76"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;write_debug -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge106" class="edge"><title>proc~distmeshdata_rea&#45;&gt;write_debug</title>
<path fill="none" stroke="#000000" d="M605.01,-828.1C605.294,-909.519 610.409,-1377.64 690,-1490 690.459,-1490.65 690.945,-1491.28 691.453,-1491.89"/>
<polygon fill="#000000" stroke="#000000" points="689.391,-1494.74 699.163,-1498.84 694.078,-1489.54 689.391,-1494.74"/>
</g>
<!-- mpitrace_event -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node74" class="node"><title>mpitrace_event</title>
<polygon fill="#777777" stroke="#777777" points="776,-828 690,-828 690,-804 776,-804 776,-828"/>
<text text-anchor="middle" x="733" y="-813.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpitrace_event</text>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;mpitrace_event -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge99" class="edge"><title>proc~distmeshdata_rea&#45;&gt;mpitrace_event</title>
<path fill="none" stroke="#000000" d="M654.102,-816C662.438,-816 671.125,-816 679.544,-816"/>
<polygon fill="#000000" stroke="#000000" points="679.639,-819.5 689.639,-816 679.639,-812.5 679.639,-819.5"/>
</g>
<!-- proc~boxintersection -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node75" class="node"><title>proc~boxintersection</title>
<g id="a_proc~~setup_hamiltonian~~CallsGraph_node75"><a xlink:href=".././proc/boxintersection.html" xlink:title="boxIntersection">
<polygon fill="#d9534f" stroke="#d9534f" points="775.5,-710 690.5,-710 690.5,-686 775.5,-686 775.5,-710"/>
<text text-anchor="middle" x="733" y="-695.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">boxIntersection</text>
</a>
</g>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;proc~boxintersection -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge100" class="edge"><title>proc~distmeshdata_rea&#45;&gt;proc~boxintersection</title>
<path fill="none" stroke="#000000" d="M614.547,-803.695C629.386,-785.057 659.466,-749.181 690,-724 693.519,-721.098 697.389,-718.279 701.311,-715.635"/>
<polygon fill="#000000" stroke="#000000" points="703.332,-718.498 709.868,-710.159 699.559,-712.601 703.332,-718.498"/>
</g>
<!-- proc~distmeshdata_int&#45;&gt;de_alloc -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge110" class="edge"><title>proc~distmeshdata_int&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M629.471,-685.898C664.682,-670.376 730.411,-648.642 776,-677 817.279,-702.676 834.412,-761.357 840.921,-793.659"/>
<polygon fill="#000000" stroke="#000000" points="837.551,-794.685 842.802,-803.886 844.435,-793.418 837.551,-794.685"/>
</g>
<!-- proc~distmeshdata_int&#45;&gt;re_alloc -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge108" class="edge"><title>proc~distmeshdata_int&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M623.793,-685.916C665.941,-658.815 768.155,-593.09 817.268,-561.51"/>
<polygon fill="#000000" stroke="#000000" points="819.276,-564.38 825.794,-556.028 815.49,-558.493 819.276,-564.38"/>
</g>
<!-- proc~distmeshdata_int&#45;&gt;proc~die -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge111" class="edge"><title>proc~distmeshdata_int&#45;&gt;proc~die</title>
<path fill="none" stroke="#000000" d="M613.337,-710.174C624.956,-727.907 645.543,-762.304 654,-795 706.072,-996.306 643.903,-1527.24 690,-1730 696.236,-1757.43 710.062,-1786.79 720.153,-1805.93"/>
<polygon fill="#000000" stroke="#000000" points="717.193,-1807.81 725.029,-1814.95 723.35,-1804.48 717.193,-1807.81"/>
</g>
<!-- proc~distmeshdata_int&#45;&gt;proc~boxintersection -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge109" class="edge"><title>proc~distmeshdata_int&#45;&gt;proc~boxintersection</title>
<path fill="none" stroke="#000000" d="M651.569,-698C660.927,-698 670.814,-698 680.333,-698"/>
<polygon fill="#000000" stroke="#000000" points="680.476,-701.5 690.476,-698 680.476,-694.5 680.476,-701.5"/>
</g>
<!-- proc~chk -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node76" class="node"><title>proc~chk</title>
<g id="a_proc~~setup_hamiltonian~~CallsGraph_node76"><a xlink:href=".././proc/chk.html" xlink:title="chk">
<polygon fill="#d9534f" stroke="#d9534f" points="631,-1720 577,-1720 577,-1696 631,-1696 631,-1720"/>
<text text-anchor="middle" x="604" y="-1705.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">chk</text>
</a>
</g>
</g>
<!-- proc~rcut&#45;&gt;proc~chk -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge112" class="edge"><title>proc~rcut&#45;&gt;proc~chk</title>
<path fill="none" stroke="#000000" d="M497.431,-1489.55C505.119,-1493.54 512.829,-1498.92 518,-1506 566.383,-1572.23 502.355,-1623.28 554,-1687 557.606,-1691.45 562.331,-1694.97 567.424,-1697.76"/>
<polygon fill="#000000" stroke="#000000" points="566.273,-1701.08 576.826,-1702.02 569.164,-1694.71 566.273,-1701.08"/>
</g>
<!-- proc~chk&#45;&gt;proc~die -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge113" class="edge"><title>proc~chk&#45;&gt;proc~die</title>
<path fill="none" stroke="#000000" d="M618.113,-1720.29C640.282,-1741.06 685.321,-1783.26 711.63,-1807.91"/>
<polygon fill="#000000" stroke="#000000" points="709.457,-1810.67 719.148,-1814.96 714.244,-1805.57 709.457,-1810.67"/>
</g>
</g>
</svg>
</div><script>var panprocsetup_hamiltonianCallsGraph = svgPanZoom('#procsetup_hamiltonianCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,-0 209.5,-0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.5,-24 454.5,-24 454.5,-0 551.5,-0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~setup_hamiltonian~~CalledByGraph Pages: 1 -->
<svg id="procsetup_hamiltonianCalledByGraph" width="220pt" height="32pt"
 viewBox="0.00 0.00 220.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~setup_hamiltonian~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~setup_hamiltonian~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 216,-28 216,4 -4,4"/>
<!-- proc~setup_hamiltonian -->
<g id="proc~~setup_hamiltonian~~CalledByGraph_node1" class="node"><title>proc~setup_hamiltonian</title>
<polygon fill="none" stroke="black" points="212,-24 112,-24 112,-0 212,-0 212,-24"/>
<text text-anchor="middle" x="162" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">setup_hamiltonian</text>
</g>
<!-- proc~siesta_forces -->
<g id="proc~~setup_hamiltonian~~CalledByGraph_node2" class="node"><title>proc~siesta_forces</title>
<g id="a_proc~~setup_hamiltonian~~CalledByGraph_node2"><a xlink:href=".././proc/siesta_forces.html" xlink:title="siesta_forces">
<polygon fill="#d9534f" stroke="#d9534f" points="76,-24 0,-24 0,-0 76,-0 76,-24"/>
<text text-anchor="middle" x="38" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_forces</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;proc~setup_hamiltonian -->
<g id="proc~~setup_hamiltonian~~CalledByGraph_edge1" class="edge"><title>proc~siesta_forces&#45;&gt;proc~setup_hamiltonian</title>
<path fill="none" stroke="#000000" d="M76.2669,-12C84.3255,-12 93.0387,-12 101.706,-12"/>
<polygon fill="#000000" stroke="#000000" points="101.817,-15.5001 111.817,-12 101.817,-8.5001 101.817,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,-0 209.5,-0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.5,-24 454.5,-24 454.5,-0 551.5,-0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/setup_hamiltonian.html#src">setup_hamiltonian</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>      <span class="k">subroutine </span><span class="n">setup_hamiltonian</span><span class="p">(</span> <span class="n">iscf</span> <span class="p">)</span>

      <span class="k">USE </span><span class="n">siesta_options</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">H_kin_1D</span><span class="p">,</span> <span class="n">H_vkb_1D</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">H_ldau_2D</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">H_so_on_2D</span><span class="p">,</span> <span class="n">H_so_off_2D</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">listh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">maxnh</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">H</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">Hold</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">Dscf</span><span class="p">,</span> <span class="n">Escf</span><span class="p">,</span> <span class="n">xijo</span>
      <span class="k">use </span><span class="n">class_dSpData1D</span><span class="p">,</span>  <span class="n">only</span><span class="p">:</span> <span class="n">val</span>
      <span class="k">use </span><span class="n">class_dSpData2D</span><span class="p">,</span>  <span class="n">only</span><span class="p">:</span> <span class="n">val</span>
      <span class="k">use </span><span class="n">class_zSpData2D</span><span class="p">,</span>  <span class="n">only</span><span class="p">:</span> <span class="n">val</span>

      <span class="k">use </span><span class="n">siesta_geom</span>
      <span class="k">use </span><span class="n">atmfuncs</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">uion</span>
      <span class="k">use </span><span class="n">atomlist</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">iaorb</span><span class="p">,</span> <span class="n">iphkb</span><span class="p">,</span> <span class="n">qtot</span><span class="p">,</span> <span class="n">indxuo</span><span class="p">,</span> <span class="n">datm</span><span class="p">,</span> 
     <span class="p">.</span>                    <span class="n">lastkb</span><span class="p">,</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">rmaxv</span><span class="p">,</span> <span class="n">indxua</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span>
     <span class="p">.</span>                    <span class="n">rmaxo</span><span class="p">,</span> <span class="n">no_l</span>
      <span class="k">use </span><span class="n">metaforce</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">lMetaForce</span><span class="p">,</span> <span class="n">meta</span>
      <span class="k">use </span><span class="n">molecularmechanics</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">twobody</span>
      <span class="k">use </span><span class="n">ldau_specs</span><span class="p">,</span>   <span class="n">only</span><span class="p">:</span> <span class="n">switch_ldau</span>     <span class="c">! This variable determines whether</span>
                                              <span class="c">!   the subroutine to compute the</span>
                                              <span class="c">!   Hubbard terms should be called</span>
                                              <span class="c">!   or not</span>
      <span class="k">use </span><span class="n">m_ldau</span><span class="p">,</span>       <span class="n">only</span><span class="p">:</span> <span class="n">hubbard_term</span>    <span class="c">! Subroutine that compute the</span>
                                              <span class="c">!   Hubbard terms</span>
      <span class="k">use </span><span class="n">m_dhscf</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">dhscf</span>
      <span class="k">use </span><span class="n">m_stress</span>
      <span class="k">use </span><span class="n">m_energies</span>
      <span class="k">use </span><span class="n">parallel</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">Node</span>
      <span class="k">use </span><span class="n">m_steps</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">istp</span>
      <span class="k">use </span><span class="n">m_ntm</span>

      <span class="k">use </span><span class="n">m_spin</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">spin</span> 

      <span class="k">use </span><span class="n">m_dipol</span>
      <span class="k">use </span><span class="n">alloc</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">re_alloc</span><span class="p">,</span> <span class="n">de_alloc</span>
      <span class="k">use </span><span class="n">m_gamma</span>
      <span class="k">use </span><span class="n">m_hsx</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">write_hsx</span>
      <span class="k">use </span><span class="n">sys</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">die</span><span class="p">,</span> <span class="n">bye</span>
      <span class="k">use </span><span class="n">m_partial_charges</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">want_partial_charges</span>
      <span class="k">use </span><span class="n">files</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">filesOut_t</span>    <span class="c">! derived type for output file names</span>
      <span class="k">use </span><span class="n">m_rhog</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">rhog_in</span><span class="p">,</span> <span class="n">rhog</span>
<span class="cp">#ifdef MPI</span>
      <span class="k">use </span><span class="n">m_mpi_utils</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">globalize_sum</span>
<span class="cp">#endif</span>

      <span class="k">implicit none</span>
<span class="k">      </span><span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iscf</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">stressl</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span>   <span class="kd">::</span> <span class="n">fal</span><span class="p">(:,:)</span>   <span class="c">! Local-node part of atomic F</span>
<span class="cp">#ifdef MPI</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">buffer1</span>
<span class="cp">#endif</span>
      <span class="kt">integer</span>             <span class="kd">::</span> <span class="n">io</span><span class="p">,</span> <span class="k">is</span><span class="p">,</span> <span class="n">ispin</span>
      <span class="kt">integer</span>             <span class="kd">::</span> <span class="n">ifa</span>     <span class="c">! Calc. forces?      0=&gt;no, 1=&gt;yes</span>
      <span class="kt">integer</span>             <span class="kd">::</span> <span class="n">istr</span>    <span class="c">! Calc. stress?      0=&gt;no, 1=&gt;yes</span>
      <span class="kt">integer</span>             <span class="kd">::</span> <span class="n">ihmat</span>   <span class="c">! Calc. hamiltonian? 0=&gt;no, 1=&gt;yes</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">g2max</span>
      <span class="k">type</span><span class="p">(</span><span class="n">filesOut_t</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">filesOut</span>  <span class="c">! blank output file names</span>
      <span class="kt">logical</span>             <span class="kd">::</span> <span class="n">use_rhog_in</span>

      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span>   <span class="kd">::</span> <span class="n">H_vkb</span><span class="p">(:),</span> <span class="n">H_kin</span><span class="p">(:),</span> <span class="n">H_ldau</span><span class="p">(:,:)</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span>   <span class="kd">::</span> <span class="n">H_so_on</span><span class="p">(:,:)</span>
      <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span><span class="kd">::</span> <span class="n">H_so_off</span><span class="p">(:,:)</span>

      <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="kd">::</span> <span class="n">Dc</span>
      <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ind</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span>

<span class="c">!------------------------------------------------------------------------- BEGIN</span>

      <span class="k">call </span><span class="n">timer</span><span class="p">(</span><span class="s1">&#39;setup_H&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

      <span class="c">! Nullify pointers</span>
      <span class="k">nullify</span><span class="p">(</span><span class="n">fal</span><span class="p">)</span>

<span class="c">!$OMP parallel default(shared), private(ispin,io)</span>

<span class="c">!     Save present H matrix</span>
<span class="c">!$OMP do collapse(2)</span>
      <span class="k">do </span><span class="n">ispin</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">H</span>
         <span class="k">do </span><span class="n">io</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">maxnh</span>
            <span class="n">Hold</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="n">ispin</span><span class="p">)</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="n">ispin</span><span class="p">)</span>
         <span class="k">end do</span>
<span class="k">      end do</span>
<span class="c">!$OMP end do</span>

<span class="c">!$OMP single</span>
      <span class="n">H_kin</span> <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">H_kin_1D</span><span class="p">)</span>
      <span class="n">H_vkb</span> <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">H_vkb_1D</span><span class="p">)</span>
      
      <span class="k">if</span> <span class="p">(</span> <span class="n">spin</span><span class="p">%</span><span class="n">SO_onsite</span> <span class="p">)</span> <span class="k">then</span>
        <span class="c">! Sadly some compilers (g95), does</span>
        <span class="c">! not allow bounds for pointer assignments :(</span>
        <span class="n">H_so_on</span> <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">H_so_on_2D</span><span class="p">)</span>
        
      <span class="k">else if</span> <span class="p">(</span> <span class="n">spin</span><span class="p">%</span><span class="n">SO_offsite</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">        </span><span class="n">H_so_off</span> <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">H_so_off_2D</span><span class="p">)</span>
        
      <span class="k">end if</span>
<span class="c">!$OMP end single ! keep wait</span>

      <span class="c">! Initialize diagonal Hamiltonian</span>
      <span class="k">do </span><span class="n">ispin</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">spinor</span>
<span class="c">!$OMP do</span>
        <span class="k">do </span><span class="n">io</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">maxnh</span>
          <span class="n">H</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="n">ispin</span><span class="p">)</span> <span class="o">=</span> <span class="n">H_kin</span><span class="p">(</span><span class="n">io</span><span class="p">)</span> <span class="o">+</span> <span class="n">H_vkb</span><span class="p">(</span><span class="n">io</span><span class="p">)</span>
        <span class="k">end do</span>
<span class="c">!$OMP end do nowait</span>
      <span class="k">end do</span>

<span class="k">      if</span> <span class="p">(</span> <span class="n">spin</span><span class="p">%</span><span class="n">SO_onsite</span> <span class="p">)</span> <span class="k">then</span>
<span class="c">!$OMP do collapse(2)</span>
        <span class="k">do </span><span class="n">ispin</span> <span class="o">=</span> <span class="mi">3</span> <span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">H</span>
          <span class="k">do </span><span class="n">io</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">maxnh</span>
            <span class="n">H</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="n">ispin</span><span class="p">)</span> <span class="o">=</span> <span class="n">H_so_on</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="n">ispin</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
          <span class="k">end do</span>
<span class="k">        end do</span>
<span class="c">!$OMP end do nowait</span>
         
      <span class="k">else</span>

<span class="c">!$OMP do collapse(2)</span>
        <span class="k">do </span><span class="n">ispin</span> <span class="o">=</span> <span class="mi">3</span> <span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">H</span>
          <span class="k">do </span><span class="n">io</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">maxnh</span>
            <span class="n">H</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="n">ispin</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0._dp</span>
          <span class="k">end do</span>
<span class="k">        end do</span>
<span class="c">!$OMP end do nowait</span>
         
      <span class="k">end if</span>
         
<span class="c">! ..................</span>

<span class="c">! Non-SCF part of total energy .......................................</span>
<span class="c">! Note that these will be &quot;impure&quot; for a mixed Dscf</span>

<span class="c">! If mixing the charge, Dscf is the previous step&#39;s DM_out. Since</span>
<span class="c">! the &quot;scf&quot; components of the energy are computed with the (mixed)</span>
<span class="c">! charge, this introduces an inconsistency. In this case the energies</span>
<span class="c">! coming out of this routine need to be corrected.</span>
<span class="c">! </span>
<span class="c">!$OMP single</span>
      <span class="n">Ekin</span> <span class="o">=</span> <span class="mf">0.0_dp</span>
      <span class="n">Enl</span> <span class="o">=</span> <span class="mf">0.0_dp</span>
      <span class="n">Eso</span> <span class="o">=</span> <span class="mf">0.0_dp</span>
<span class="c">!$OMP end single ! keep wait</span>
      
<span class="c">!$OMP do collapse(2), reduction(+:Ekin,Enl)</span>
      <span class="k">do </span><span class="n">ispin</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">spinor</span>
        <span class="k">do </span><span class="n">io</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">maxnh</span>
          <span class="n">Ekin</span> <span class="o">=</span> <span class="n">Ekin</span> <span class="o">+</span> <span class="n">H_kin</span><span class="p">(</span><span class="n">io</span><span class="p">)</span> <span class="o">*</span> <span class="n">Dscf</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="n">ispin</span><span class="p">)</span>
          <span class="n">Enl</span>  <span class="o">=</span> <span class="n">Enl</span>  <span class="o">+</span> <span class="n">H_vkb</span><span class="p">(</span><span class="n">io</span><span class="p">)</span> <span class="o">*</span> <span class="n">Dscf</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="n">ispin</span><span class="p">)</span>
        <span class="k">end do</span>
<span class="k">      end do</span>
<span class="c">!$OMP end do nowait</span>

<span class="c">!</span>
<span class="c">!  Dc IS NOT the dense matrix, it is just a complex number </span>
<span class="c">! (per each io index) used as an artifact to multiply the </span>
<span class="c">! elements of the H_SO times the corresponding elements of </span>
<span class="c">! DM in a such way that the result gives Re{Tr[H_SO*DM]}.</span>
<span class="c">!</span>

      <span class="k">if</span> <span class="p">(</span> <span class="n">spin</span><span class="p">%</span><span class="n">SO_offsite</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">        do </span><span class="n">io</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">maxnh</span>

<span class="c">!-------- Eso(u,u)</span>
          <span class="n">Dc</span> <span class="o">=</span> <span class="nb">cmplx</span><span class="p">(</span><span class="n">Dscf</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">Dscf</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">dp</span><span class="p">)</span>
          <span class="n">Eso</span> <span class="o">=</span> <span class="n">Eso</span> <span class="o">+</span> <span class="kt">real</span><span class="p">(</span> <span class="n">H_so_off</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Dc</span><span class="p">,</span> <span class="n">dp</span><span class="p">)</span>
<span class="c">!-------- Eso(d,d)</span>
          <span class="n">Dc</span> <span class="o">=</span> <span class="nb">cmplx</span><span class="p">(</span><span class="n">Dscf</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">Dscf</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">dp</span><span class="p">)</span>
          <span class="n">Eso</span> <span class="o">=</span> <span class="n">Eso</span> <span class="o">+</span> <span class="kt">real</span><span class="p">(</span> <span class="n">H_so_off</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">Dc</span><span class="p">,</span> <span class="n">dp</span><span class="p">)</span>
<span class="c">!-------- Eso(u,d)</span>
          <span class="n">Dc</span> <span class="o">=</span> <span class="nb">cmplx</span><span class="p">(</span><span class="n">Dscf</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">Dscf</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">dp</span><span class="p">)</span>
          <span class="n">Eso</span> <span class="o">=</span> <span class="n">Eso</span> <span class="o">+</span> <span class="kt">real</span><span class="p">(</span> <span class="n">H_so_off</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">Dc</span><span class="p">,</span> <span class="n">dp</span><span class="p">)</span>
<span class="c">!-------- Eso(d,u)</span>
          <span class="n">Dc</span> <span class="o">=</span> <span class="nb">cmplx</span><span class="p">(</span><span class="n">Dscf</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span><span class="o">-</span><span class="n">Dscf</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="n">dp</span><span class="p">)</span>
          <span class="n">Eso</span> <span class="o">=</span> <span class="n">Eso</span> <span class="o">+</span> <span class="kt">real</span><span class="p">(</span> <span class="n">H_so_off</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">Dc</span><span class="p">,</span> <span class="n">dp</span><span class="p">)</span>

        <span class="k">end do</span>

<span class="k">      else if</span> <span class="p">(</span> <span class="n">spin</span><span class="p">%</span><span class="n">SO_onsite</span> <span class="p">)</span> <span class="k">then</span>
        
<span class="c">!$OMP do reduction(+:Eso)</span>
         <span class="k">do </span><span class="n">io</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">maxnh</span>
           <span class="n">Eso</span> <span class="o">=</span> <span class="n">Eso</span> <span class="o">+</span> <span class="n">H_so_on</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Dscf</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span> <span class="o">+</span>
     <span class="p">&amp;</span>         <span class="n">H_so_on</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">Dscf</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span><span class="o">+</span> <span class="n">H_so_on</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">Dscf</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
     <span class="p">&amp;</span>         <span class="n">H_so_on</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">Dscf</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">-</span> <span class="n">H_so_on</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">Dscf</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> <span class="o">-</span>
     <span class="p">&amp;</span>         <span class="n">H_so_on</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">Dscf</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
         <span class="k">end do</span>
<span class="c">!$OMP end do nowait</span>

       <span class="k">end if</span>

<span class="c">!$OMP end parallel</span>

<span class="cp">#ifdef MPI</span>
      <span class="c">! Global reduction of Ekin, Enl</span>
      <span class="k">call </span><span class="n">globalize_sum</span><span class="p">(</span><span class="n">Ekin</span><span class="p">,</span><span class="n">buffer1</span><span class="p">)</span>
      <span class="n">Ekin</span> <span class="o">=</span> <span class="n">buffer1</span>
      <span class="k">call </span><span class="n">globalize_sum</span><span class="p">(</span><span class="n">Enl</span><span class="p">,</span><span class="n">buffer1</span><span class="p">)</span>
      <span class="n">Enl</span> <span class="o">=</span> <span class="n">buffer1</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">spin</span><span class="p">%</span><span class="n">SO</span> <span class="p">)</span> <span class="k">then</span>
         <span class="c">! Global reduction of Eso </span>
         <span class="k">call </span><span class="n">globalize_sum</span><span class="p">(</span><span class="n">Eso</span><span class="p">,</span><span class="n">buffer1</span><span class="p">)</span>
         <span class="n">Eso</span> <span class="o">=</span> <span class="n">buffer1</span>
      <span class="k">end if</span>
<span class="cp">#endif</span>

<span class="c">!     Non-SCF part of total energy</span>
      <span class="k">call </span><span class="n">update_E0</span><span class="p">()</span>

<span class="c">! Hubbard term for LDA+U: energy, forces, stress and matrix elements ....</span>
      <span class="k">if</span><span class="p">(</span> <span class="n">switch_ldau</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">        if</span> <span class="p">(</span> <span class="n">spin</span><span class="p">%</span><span class="n">NCol</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">die</span><span class="p">(</span><span class="s1">&#39;LDA+U cannot be used with non-collinear spin.&#39;</span><span class="p">)</span>
        <span class="k">end if</span>
<span class="k">        if</span> <span class="p">(</span> <span class="n">spin</span><span class="p">%</span><span class="n">SO</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">die</span><span class="p">(</span><span class="s1">&#39;LDA+U cannot be used with spin-orbit coupling.&#39;</span><span class="p">)</span>
        <span class="k">end if</span>

<span class="k">        call </span><span class="n">re_alloc</span><span class="p">(</span> <span class="n">fal</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="s1">&#39;fal&#39;</span><span class="p">,</span> <span class="s1">&#39;setup_hamiltonian&#39;</span> <span class="p">)</span>

        <span class="n">H_ldau</span> <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">H_ldau_2D</span><span class="p">)</span>
        <span class="k">call </span><span class="n">hubbard_term</span><span class="p">(</span><span class="n">scell</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">na_s</span><span class="p">,</span> <span class="n">isa</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">indxua</span><span class="p">,</span>
     <span class="p">.</span>                    <span class="n">maxnh</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> 
     <span class="p">.</span>                    <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span>
     <span class="p">.</span>                    <span class="n">spin</span><span class="p">%</span><span class="n">spinor</span><span class="p">,</span> <span class="n">Dscf</span><span class="p">,</span> <span class="n">Eldau</span><span class="p">,</span> <span class="n">DEldau</span><span class="p">,</span> <span class="n">H_ldau</span><span class="p">,</span> 
     <span class="p">.</span>                    <span class="n">fal</span><span class="p">,</span> <span class="n">stressl</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">iscf</span><span class="p">,</span>
     <span class="p">.</span>                    <span class="n">matrix_elements_only</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>

<span class="cp">#ifdef MPI</span>
        <span class="c">! Global reduction of energy terms</span>
        <span class="k">call </span><span class="n">globalize_sum</span><span class="p">(</span><span class="n">Eldau</span><span class="p">,</span><span class="n">buffer1</span><span class="p">)</span>
        <span class="n">Eldau</span> <span class="o">=</span> <span class="n">buffer1</span>
        <span class="c">! DEldau should not be globalized</span>
        <span class="c">! as it is based on globalized occupations</span>
<span class="cp">#endif</span>
        <span class="n">Eldau</span> <span class="o">=</span> <span class="n">Eldau</span> <span class="o">+</span> <span class="n">DEldau</span>

        <span class="k">call </span><span class="n">de_alloc</span><span class="p">(</span> <span class="n">fal</span><span class="p">,</span> <span class="s1">&#39;fal&#39;</span><span class="p">,</span> <span class="s1">&#39;setup_hamiltonian&#39;</span> <span class="p">)</span> 
      <span class="n">endif</span>
<span class="c">! ..................</span>


<span class="c">! Add SCF contribution to energy and matrix elements ..................</span>
      <span class="n">g2max</span> <span class="o">=</span> <span class="n">g2cut</span>

      <span class="k">call </span><span class="n">re_alloc</span><span class="p">(</span> <span class="n">fal</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="s1">&#39;fal&#39;</span><span class="p">,</span> <span class="s1">&#39;setup_hamiltonian&#39;</span> <span class="p">)</span>

      <span class="n">ifa</span>  <span class="o">=</span> <span class="mi">0</span>
      <span class="n">istr</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="n">ihmat</span> <span class="o">=</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="p">((</span><span class="n">hirshpop</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">voropop</span><span class="p">)</span>
     <span class="err">$</span>     <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">partial_charges_at_every_scf_step</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         </span><span class="n">want_partial_charges</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
      <span class="n">endif</span>
      <span class="n">use_rhog_in</span> <span class="o">=</span>  <span class="p">(</span><span class="n">mix_charge</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">iscf</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span>
  
      <span class="k">call </span><span class="n">dhscf</span><span class="p">(</span> <span class="n">spin</span><span class="p">%</span><span class="n">Grid</span><span class="p">,</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">iaorb</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span>
     <span class="p">.</span>            <span class="n">no_u</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">na_s</span><span class="p">,</span> <span class="n">isa</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">indxua</span><span class="p">,</span> 
     <span class="p">.</span>            <span class="n">ntm</span><span class="p">,</span> <span class="n">ifa</span><span class="p">,</span> <span class="n">istr</span><span class="p">,</span> <span class="n">ihmat</span><span class="p">,</span> <span class="n">filesOut</span><span class="p">,</span>
     <span class="p">.</span>            <span class="n">maxnh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">Dscf</span><span class="p">,</span> <span class="n">Datm</span><span class="p">,</span>
     <span class="p">.</span>            <span class="n">maxnh</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">Enaatm</span><span class="p">,</span> <span class="n">Enascf</span><span class="p">,</span> <span class="n">Uatm</span><span class="p">,</span> <span class="n">Uscf</span><span class="p">,</span> <span class="n">DUscf</span><span class="p">,</span> <span class="n">DUext</span><span class="p">,</span>
     <span class="p">.</span>            <span class="n">Exc</span><span class="p">,</span> <span class="n">Dxc</span><span class="p">,</span> <span class="n">dipol</span><span class="p">,</span> <span class="n">stress</span><span class="p">,</span> <span class="n">fal</span><span class="p">,</span> <span class="n">stressl</span><span class="p">,</span>
     <span class="p">.</span>            <span class="n">use_rhog_in</span><span class="p">)</span>

      <span class="k">if</span> <span class="p">(</span> <span class="n">spin</span><span class="p">%</span><span class="n">SO_offsite</span> <span class="p">)</span> <span class="k">then</span>

<span class="c">! H(:, [5, 6]) are not updated in dhscf, see vmat for details.</span>
        
<span class="c">!------- H(u,u)</span>
         <span class="n">H</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">H</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="kt">real</span><span class="p">(</span><span class="n">H_so_off</span><span class="p">(:,</span><span class="mi">1</span><span class="p">),</span> <span class="n">dp</span><span class="p">)</span>
         <span class="n">H</span><span class="p">(:,</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span>         <span class="n">dimag</span><span class="p">(</span><span class="n">H_so_off</span><span class="p">(:,</span><span class="mi">1</span><span class="p">))</span>
<span class="c">!------- H(d,d)</span>
         <span class="n">H</span><span class="p">(:,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">H</span><span class="p">(:,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="kt">real</span><span class="p">(</span><span class="n">H_so_off</span><span class="p">(:,</span><span class="mi">2</span><span class="p">),</span> <span class="n">dp</span><span class="p">)</span>
         <span class="n">H</span><span class="p">(:,</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span>         <span class="n">dimag</span><span class="p">(</span><span class="n">H_so_off</span><span class="p">(:,</span><span class="mi">2</span><span class="p">))</span>
<span class="c">!------- H(u,d)</span>
         <span class="n">H</span><span class="p">(:,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">H</span><span class="p">(:,</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="kt">real</span><span class="p">(</span><span class="n">H_so_off</span><span class="p">(:,</span><span class="mi">3</span><span class="p">),</span> <span class="n">dp</span><span class="p">)</span>
         <span class="n">H</span><span class="p">(:,</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">H</span><span class="p">(:,</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span><span class="n">dimag</span><span class="p">(</span><span class="n">H_so_off</span><span class="p">(:,</span><span class="mi">3</span><span class="p">))</span>
<span class="c">!------- H(d,u)</span>
         <span class="n">H</span><span class="p">(:,</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="n">H</span><span class="p">(:,</span><span class="mi">7</span><span class="p">)</span> <span class="o">+</span> <span class="kt">real</span><span class="p">(</span><span class="n">H_so_off</span><span class="p">(:,</span><span class="mi">4</span><span class="p">),</span> <span class="n">dp</span><span class="p">)</span>
         <span class="n">H</span><span class="p">(:,</span><span class="mi">8</span><span class="p">)</span> <span class="o">=</span> <span class="n">H</span><span class="p">(:,</span><span class="mi">8</span><span class="p">)</span> <span class="o">-</span><span class="n">dimag</span><span class="p">(</span><span class="n">H_so_off</span><span class="p">(:,</span><span class="mi">4</span><span class="p">))</span>

      <span class="n">endif</span>

      <span class="c">! This statement will apply to iscf = 1, for example, when</span>
      <span class="c">! we do not use rhog_in. Rhog here is always the charge used to</span>
      <span class="c">! build H, that is, rhog_in.</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">mix_charge</span><span class="p">)</span> <span class="n">rhog_in</span> <span class="o">=</span> <span class="n">rhog</span>

      <span class="n">want_partial_charges</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
      <span class="k">call </span><span class="n">de_alloc</span><span class="p">(</span> <span class="n">fal</span><span class="p">,</span> <span class="s1">&#39;fal&#39;</span><span class="p">,</span> <span class="s1">&#39;setup_hamiltonian&#39;</span> <span class="p">)</span> 
<span class="c">!  It is wasteful to write over and over H and S, as there are</span>
<span class="c">!  no different files.</span>
<span class="c">! Save Hamiltonian and overlap matrices ............................</span>
<span class="c">! Only in HSX format now.  Use Util/HSX/hsx2hs to generate an HS file</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">savehs</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">write_coop</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">write_hsx</span><span class="p">(</span> <span class="nb">gamma</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span> <span class="n">indxuo</span><span class="p">,</span>
     <span class="p">&amp;</span>        <span class="n">maxnh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">qtot</span><span class="p">,</span>
     <span class="p">&amp;</span>        <span class="n">temp</span><span class="p">,</span> <span class="n">xijo</span><span class="p">)</span>
      <span class="n">endif</span>

      <span class="k">call </span><span class="n">timer</span><span class="p">(</span><span class="s1">&#39;setup_H&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="cp">#ifdef SIESTA__PEXSI</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">node</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">memory_snapshot</span><span class="p">(</span><span class="s2">&quot;after setup_H&quot;</span><span class="p">)</span>
<span class="cp">#endif</span>

      <span class="k">if</span> <span class="p">(</span> <span class="n">h_setup_only</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="mi">2</span> <span class="p">)</span>  <span class="c">! New call to close the tree</span>
         <span class="k">call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="mi">3</span> <span class="p">)</span>
         <span class="k">call </span><span class="n">bye</span><span class="p">(</span><span class="s2">&quot;H-Setup-Only requested&quot;</span><span class="p">)</span>
         <span class="k">STOP</span>
<span class="k">      </span><span class="n">endif</span>

<span class="c">!------------------------------------------------------------------------- END</span>
      <span class="k">END subroutine </span><span class="n">setup_hamiltonian</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2018 <a rel="license" href="http://www.gnu.org/licenses/old-licenses/fdl-1.2.en.html">GNU Free Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> SIESTA was developed by SIESTA Group</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>