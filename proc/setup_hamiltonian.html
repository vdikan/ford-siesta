<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="A first-principles materials simulation code using Density Functional Theory.">
    
    <meta name="author" content="SIESTA Group" >
    <link rel="icon" href="../favicon.png">

    <title>setup_hamiltonian &ndash; SIESTA</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">SIESTA <small>trunk-700--vdikan-edens-708-ford-681</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>Program Overview</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>setup_hamiltonian
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 2.7% of total for procedures.">167 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/setup_hamiltonian.F"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/setup_hamiltonian.f.html'>setup_hamiltonian.F</a></li>
    
     <li><a href='../module/m_setup_hamiltonian.html'>m_setup_hamiltonian</a></li>
    
  
     <li class="active">setup_hamiltonian</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/setup_hamiltonian.html#src">setup_hamiltonian</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine setup_hamiltonian(iscf)
    
    
   
</h2>
    
  
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
      
      <li class="list-group-item">
  <ul class="list-inline">
    
    <li>siesta_options</li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>sparse_matrices</li>
    
    <li>class_dSpData1D</li>
    
    <li>class_dSpData2D</li>
    
    <li>class_zSpData2D</li>
    
    <li>siesta_geom</li>
    
    <li>atmfuncs</li>
    
    <li>atomlist</li>
    
    <li>metaforce</li>
    
    <li>molecularmechanics</li>
    
    <li>ldau_specs</li>
    
    <li>m_ldau</li>
    
    <li><a href='../module/m_dhscf.html'>m_dhscf</a></li>
    
    <li>m_stress</li>
    
    <li>m_energies</li>
    
    <li>parallel</li>
    
    <li>m_steps</li>
    
    <li>m_ntm</li>
    
    <li>m_spin</li>
    
    <li>m_dipol</li>
    
    <li>alloc</li>
    
    <li>m_gamma</li>
    
    <li>m_hsx</li>
    
    <li>sys</li>
    
    <li>m_partial_charges</li>
    
    <li>files</li>
    
    <li>m_rhog</li>
    
    <li>m_mpi_utils</li>
    
  </ul>
      </li>
      
      
      
      <li class="list-group-item">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~setup_hamiltonian~~UsesGraph Pages: 1 -->
<svg id="procsetup_hamiltonianUsesGraph" width="345pt" height="1166pt"
 viewBox="0.00 0.00 345.00 1166.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~setup_hamiltonian~~UsesGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 1162)">
<title>proc~~setup_hamiltonian~~UsesGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1162 341,-1162 341,4 -4,4"/>
<!-- proc~setup_hamiltonian -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node1" class="node"><title>proc~setup_hamiltonian</title>
<polygon fill="none" stroke="black" points="337,-591 237,-591 237,-567 337,-567 337,-591"/>
<text text-anchor="middle" x="287" y="-576.6" font-family="Helvetica,sans-Serif" font-size="10.50">setup_hamiltonian</text>
</g>
<!-- siesta_options -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node2" class="node"><title>siesta_options</title>
<polygon fill="#337ab7" stroke="#337ab7" points="186.5,-1158 105.5,-1158 105.5,-1134 186.5,-1134 186.5,-1158"/>
<text text-anchor="middle" x="146" y="-1143.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_options</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;siesta_options -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge14" class="edge"><title>proc~setup_hamiltonian&#45;&gt;siesta_options</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M285.713,-591.134C283.769,-663.568 270.428,-1038.65 201,-1125 199.318,-1127.09 197.4,-1128.98 195.313,-1130.67"/>
<polygon fill="#000000" stroke="#000000" points="193.063,-1127.96 186.571,-1136.33 196.867,-1133.84 193.063,-1127.96"/>
</g>
<!-- m_rhog -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node3" class="node"><title>m_rhog</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173,-1116 119,-1116 119,-1092 173,-1092 173,-1116"/>
<text text-anchor="middle" x="146" y="-1101.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_rhog</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;m_rhog -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge2" class="edge"><title>proc~setup_hamiltonian&#45;&gt;m_rhog</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M285.542,-591.092C282.701,-660.104 265.442,-1003.88 201,-1083 196.24,-1088.84 189.639,-1093.07 182.684,-1096.12"/>
<polygon fill="#000000" stroke="#000000" points="181.324,-1092.89 173.118,-1099.59 183.713,-1099.47 181.324,-1092.89"/>
</g>
<!-- m_partial_charges -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node4" class="node"><title>m_partial_charges</title>
<polygon fill="#337ab7" stroke="#337ab7" points="196.5,-1074 95.5,-1074 95.5,-1050 196.5,-1050 196.5,-1074"/>
<text text-anchor="middle" x="146" y="-1059.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_partial_charges</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;m_partial_charges -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge3" class="edge"><title>proc~setup_hamiltonian&#45;&gt;m_partial_charges</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M285.324,-591.362C281.476,-657.499 260.377,-969.193 201,-1041 200.171,-1042 199.287,-1042.96 198.357,-1043.87"/>
<polygon fill="#000000" stroke="#000000" points="196.212,-1041.1 190.443,-1049.99 200.495,-1046.64 196.212,-1041.1"/>
</g>
<!-- ldau_specs -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node5" class="node"><title>ldau_specs</title>
<polygon fill="#337ab7" stroke="#337ab7" points="179.5,-1032 112.5,-1032 112.5,-1008 179.5,-1008 179.5,-1032"/>
<text text-anchor="middle" x="146" y="-1017.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ldau_specs</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;ldau_specs -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge4" class="edge"><title>proc~setup_hamiltonian&#45;&gt;ldau_specs</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M285.101,-591.05C280.263,-652.896 255.503,-934.265 201,-999 197.644,-1002.99 193.436,-1006.22 188.857,-1008.84"/>
<polygon fill="#000000" stroke="#000000" points="187.264,-1005.72 179.723,-1013.16 190.259,-1012.05 187.264,-1005.72"/>
</g>
<!-- m_energies -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node6" class="node"><title>m_energies</title>
<polygon fill="#337ab7" stroke="#337ab7" points="180.5,-990 111.5,-990 111.5,-966 180.5,-966 180.5,-990"/>
<text text-anchor="middle" x="146" y="-975.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_energies</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;m_energies -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge5" class="edge"><title>proc~setup_hamiltonian&#45;&gt;m_energies</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M284.774,-591.37C278.74,-650.007 250.466,-899.513 201,-957 197.845,-960.667 193.969,-963.697 189.755,-966.201"/>
<polygon fill="#000000" stroke="#000000" points="188.177,-963.077 180.753,-970.635 191.27,-969.356 188.177,-963.077"/>
</g>
<!-- m_ldau -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node7" class="node"><title>m_ldau</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173,-948 119,-948 119,-924 173,-924 173,-948"/>
<text text-anchor="middle" x="146" y="-933.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ldau</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;m_ldau -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge6" class="edge"><title>proc~setup_hamiltonian&#45;&gt;m_ldau</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M284.44,-591.071C277.236,-645.126 245.631,-864.506 201,-915 196.054,-920.596 189.434,-924.713 182.528,-927.737"/>
<polygon fill="#000000" stroke="#000000" points="181.238,-924.482 173.063,-931.221 183.656,-931.051 181.238,-924.482"/>
</g>
<!-- m_steps -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node8" class="node"><title>m_steps</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173,-906 119,-906 119,-882 173,-882 173,-906"/>
<text text-anchor="middle" x="146" y="-891.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_steps</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;m_steps -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge7" class="edge"><title>proc~setup_hamiltonian&#45;&gt;m_steps</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M286.102,-591.162C285.811,-635.128 278.98,-787.713 201,-873 196.007,-878.461 189.424,-882.518 182.578,-885.526"/>
<polygon fill="#000000" stroke="#000000" points="181.357,-882.246 173.204,-889.012 183.797,-888.807 181.357,-882.246"/>
</g>
<!-- class_dSpData2D -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node9" class="node"><title>class_dSpData2D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="194.5,-864 97.5,-864 97.5,-840 194.5,-840 194.5,-864"/>
<text text-anchor="middle" x="146" y="-849.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_dSpData2D</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;class_dSpData2D -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge8" class="edge"><title>proc~setup_hamiltonian&#45;&gt;class_dSpData2D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M285.417,-591.075C282.857,-630.864 269.417,-759.392 201,-831 199.958,-832.091 198.852,-833.126 197.694,-834.108"/>
<polygon fill="#000000" stroke="#000000" points="195.634,-831.278 189.411,-839.852 199.623,-837.03 195.634,-831.278"/>
</g>
<!-- siesta_geom -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node10" class="node"><title>siesta_geom</title>
<polygon fill="#337ab7" stroke="#337ab7" points="182.5,-822 109.5,-822 109.5,-798 182.5,-798 182.5,-822"/>
<text text-anchor="middle" x="146" y="-807.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_geom</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;siesta_geom -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge9" class="edge"><title>proc~setup_hamiltonian&#45;&gt;siesta_geom</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M284.485,-591.033C279.423,-626.347 259.944,-730.859 201,-789 198.18,-791.781 194.95,-794.204 191.503,-796.312"/>
<polygon fill="#000000" stroke="#000000" points="189.863,-793.22 182.597,-800.931 193.086,-799.434 189.863,-793.22"/>
</g>
<!-- m_stress -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node11" class="node"><title>m_stress</title>
<polygon fill="#337ab7" stroke="#337ab7" points="174,-780 118,-780 118,-756 174,-756 174,-780"/>
<text text-anchor="middle" x="146" y="-765.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_stress</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;m_stress -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge10" class="edge"><title>proc~setup_hamiltonian&#45;&gt;m_stress</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M283.017,-591.434C275.042,-622.119 250.393,-702.202 201,-747 196.061,-751.479 190.06,-755.047 183.878,-757.874"/>
<polygon fill="#000000" stroke="#000000" points="182.147,-754.795 174.14,-761.733 184.726,-761.303 182.147,-754.795"/>
</g>
<!-- m_ntm -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node12" class="node"><title>m_ntm</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173,-738 119,-738 119,-714 173,-714 173,-738"/>
<text text-anchor="middle" x="146" y="-723.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_ntm</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;m_ntm -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge11" class="edge"><title>proc~setup_hamiltonian&#45;&gt;m_ntm</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M280.84,-591.2C269.766,-616.009 241.406,-672.717 201,-705 195.562,-709.345 189.117,-712.876 182.608,-715.714"/>
<polygon fill="#000000" stroke="#000000" points="181.191,-712.51 173.136,-719.393 183.725,-719.036 181.191,-712.51"/>
</g>
<!-- m_mpi_utils -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node13" class="node"><title>m_mpi_utils</title>
<polygon fill="#337ab7" stroke="#337ab7" points="181,-696 111,-696 111,-672 181,-672 181,-696"/>
<text text-anchor="middle" x="146" y="-681.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_mpi_utils</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;m_mpi_utils -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge12" class="edge"><title>proc~setup_hamiltonian&#45;&gt;m_mpi_utils</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M276.501,-591.145C261.954,-609.039 232.51,-642.572 201,-663 197.677,-665.155 194.098,-667.143 190.421,-668.966"/>
<polygon fill="#000000" stroke="#000000" points="188.836,-665.842 181.17,-673.155 191.723,-672.218 188.836,-665.842"/>
</g>
<!-- m_dipol -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node14" class="node"><title>m_dipol</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173,-654 119,-654 119,-630 173,-630 173,-654"/>
<text text-anchor="middle" x="146" y="-639.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_dipol</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;m_dipol -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge27" class="edge"><title>proc~setup_hamiltonian&#45;&gt;m_dipol</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M262.811,-591.148C245.868,-599.853 222.24,-611.644 201,-621 195.08,-623.608 188.726,-626.231 182.53,-628.696"/>
<polygon fill="#000000" stroke="#000000" points="181.049,-625.517 173.009,-632.417 183.597,-632.037 181.049,-625.517"/>
</g>
<!-- files -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node15" class="node"><title>files</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173,-612 119,-612 119,-588 173,-588 173,-612"/>
<text text-anchor="middle" x="146" y="-597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">files</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;files -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge1" class="edge"><title>proc~setup_hamiltonian&#45;&gt;files</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M236.994,-586.404C219.426,-589.058 199.939,-592.002 183.604,-594.47"/>
<polygon fill="#000000" stroke="#000000" points="182.741,-591.06 173.376,-596.015 183.787,-597.982 182.741,-591.06"/>
</g>
<!-- m_hsx -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node16" class="node"><title>m_hsx</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173,-570 119,-570 119,-546 173,-546 173,-570"/>
<text text-anchor="middle" x="146" y="-555.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_hsx</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;m_hsx -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge15" class="edge"><title>proc~setup_hamiltonian&#45;&gt;m_hsx</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M236.994,-571.596C219.426,-568.942 199.939,-565.998 183.604,-563.53"/>
<polygon fill="#000000" stroke="#000000" points="183.787,-560.018 173.376,-561.985 182.741,-566.94 183.787,-560.018"/>
</g>
<!-- sys -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node17" class="node"><title>sys</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173,-528 119,-528 119,-504 173,-504 173,-528"/>
<text text-anchor="middle" x="146" y="-513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sys</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;sys -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge21" class="edge"><title>proc~setup_hamiltonian&#45;&gt;sys</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M262.811,-566.852C245.868,-558.147 222.24,-546.356 201,-537 195.08,-534.392 188.726,-531.769 182.53,-529.304"/>
<polygon fill="#000000" stroke="#000000" points="183.597,-525.963 173.009,-525.583 181.049,-532.483 183.597,-525.963"/>
</g>
<!-- m_spin -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node18" class="node"><title>m_spin</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173,-486 119,-486 119,-462 173,-462 173,-486"/>
<text text-anchor="middle" x="146" y="-471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_spin</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;m_spin -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge17" class="edge"><title>proc~setup_hamiltonian&#45;&gt;m_spin</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M276.501,-566.855C261.954,-548.961 232.51,-515.428 201,-495 195.406,-491.373 189.088,-488.217 182.797,-485.53"/>
<polygon fill="#000000" stroke="#000000" points="183.628,-482.096 173.041,-481.695 181.067,-488.611 183.628,-482.096"/>
</g>
<!-- parallel -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node19" class="node"><title>parallel</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173,-444 119,-444 119,-420 173,-420 173,-444"/>
<text text-anchor="middle" x="146" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;parallel -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge18" class="edge"><title>proc~setup_hamiltonian&#45;&gt;parallel</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M280.84,-566.8C269.766,-541.991 241.406,-485.283 201,-453 195.562,-448.655 189.117,-445.124 182.608,-442.286"/>
<polygon fill="#000000" stroke="#000000" points="183.725,-438.964 173.136,-438.607 181.191,-445.49 183.725,-438.964"/>
</g>
<!-- atmfuncs -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node20" class="node"><title>atmfuncs</title>
<polygon fill="#337ab7" stroke="#337ab7" points="174,-402 118,-402 118,-378 174,-378 174,-402"/>
<text text-anchor="middle" x="146" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">atmfuncs</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;atmfuncs -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge24" class="edge"><title>proc~setup_hamiltonian&#45;&gt;atmfuncs</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M283.017,-566.566C275.042,-535.881 250.393,-455.798 201,-411 196.061,-406.521 190.06,-402.953 183.878,-400.126"/>
<polygon fill="#000000" stroke="#000000" points="184.726,-396.697 174.14,-396.267 182.147,-403.205 184.726,-396.697"/>
</g>
<!-- class_dSpData1D -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node21" class="node"><title>class_dSpData1D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="194.5,-360 97.5,-360 97.5,-336 194.5,-336 194.5,-360"/>
<text text-anchor="middle" x="146" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_dSpData1D</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;class_dSpData1D -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge20" class="edge"><title>proc~setup_hamiltonian&#45;&gt;class_dSpData1D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M284.485,-566.967C279.423,-531.653 259.944,-427.141 201,-369 199.769,-367.786 198.46,-366.64 197.089,-365.559"/>
<polygon fill="#000000" stroke="#000000" points="198.953,-362.596 188.669,-360.049 195.12,-368.453 198.953,-362.596"/>
</g>
<!-- module~m_dhscf -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node22" class="node"><title>module~m_dhscf</title>
<g id="a_proc~~setup_hamiltonian~~UsesGraph_node22"><a xlink:href=".././module/m_dhscf.html" xlink:title="m_dhscf">
<polygon fill="#337ab7" stroke="#337ab7" points="173,-318 119,-318 119,-294 173,-294 173,-318"/>
<text text-anchor="middle" x="146" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_dhscf</text>
</a>
</g>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;module~m_dhscf -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge16" class="edge"><title>proc~setup_hamiltonian&#45;&gt;module~m_dhscf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M285.417,-566.925C282.857,-527.136 269.417,-398.608 201,-327 196.004,-321.771 189.556,-317.823 182.865,-314.849"/>
<polygon fill="#000000" stroke="#000000" points="183.621,-311.394 173.029,-311.152 181.158,-317.946 183.621,-311.394"/>
</g>
<!-- alloc -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node23" class="node"><title>alloc</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173,-276 119,-276 119,-252 173,-252 173,-276"/>
<text text-anchor="middle" x="146" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">alloc</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;alloc -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge22" class="edge"><title>proc~setup_hamiltonian&#45;&gt;alloc</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M286.102,-566.838C285.811,-522.872 278.98,-370.287 201,-285 196.007,-279.539 189.424,-275.482 182.578,-272.474"/>
<polygon fill="#000000" stroke="#000000" points="183.797,-269.193 173.204,-268.988 181.357,-275.754 183.797,-269.193"/>
</g>
<!-- m_gamma -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node24" class="node"><title>m_gamma</title>
<polygon fill="#337ab7" stroke="#337ab7" points="178,-234 114,-234 114,-210 178,-210 178,-234"/>
<text text-anchor="middle" x="146" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_gamma</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;m_gamma -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge23" class="edge"><title>proc~setup_hamiltonian&#45;&gt;m_gamma</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M284.44,-566.929C277.236,-512.874 245.631,-293.494 201,-243 197.253,-238.761 192.545,-235.37 187.48,-232.661"/>
<polygon fill="#000000" stroke="#000000" points="188.666,-229.357 178.107,-228.482 185.816,-235.751 188.666,-229.357"/>
</g>
<!-- metaforce -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node25" class="node"><title>metaforce</title>
<polygon fill="#337ab7" stroke="#337ab7" points="176.5,-192 115.5,-192 115.5,-168 176.5,-168 176.5,-192"/>
<text text-anchor="middle" x="146" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">metaforce</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;metaforce -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge19" class="edge"><title>proc~setup_hamiltonian&#45;&gt;metaforce</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M284.774,-566.63C278.74,-507.993 250.466,-258.487 201,-201 196.965,-196.311 191.752,-192.663 186.16,-189.826"/>
<polygon fill="#000000" stroke="#000000" points="187.108,-186.428 176.533,-185.778 184.394,-192.88 187.108,-186.428"/>
</g>
<!-- sparse_matrices -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node26" class="node"><title>sparse_matrices</title>
<polygon fill="#337ab7" stroke="#337ab7" points="191.5,-150 100.5,-150 100.5,-126 191.5,-126 191.5,-150"/>
<text text-anchor="middle" x="146" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sparse_matrices</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;sparse_matrices -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge25" class="edge"><title>proc~setup_hamiltonian&#45;&gt;sparse_matrices</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M285.101,-566.95C280.263,-505.104 255.503,-223.735 201,-159 200.162,-158.004 199.27,-157.056 198.333,-156.152"/>
<polygon fill="#000000" stroke="#000000" points="200.448,-153.363 190.38,-150.064 196.193,-158.922 200.448,-153.363"/>
</g>
<!-- atomlist -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node27" class="node"><title>atomlist</title>
<polygon fill="#337ab7" stroke="#337ab7" points="173,-108 119,-108 119,-84 173,-84 173,-108"/>
<text text-anchor="middle" x="146" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">atomlist</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;atomlist -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge26" class="edge"><title>proc~setup_hamiltonian&#45;&gt;atomlist</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M285.324,-566.638C281.476,-500.501 260.377,-188.807 201,-117 196.196,-111.191 189.578,-106.983 182.619,-103.937"/>
<polygon fill="#000000" stroke="#000000" points="183.65,-100.588 173.056,-100.462 181.26,-107.167 183.65,-100.588"/>
</g>
<!-- molecularmechanics -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node28" class="node"><title>molecularmechanics</title>
<polygon fill="#337ab7" stroke="#337ab7" points="201,-66 91,-66 91,-42 201,-42 201,-66"/>
<text text-anchor="middle" x="146" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">molecularmechanics</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;molecularmechanics -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge13" class="edge"><title>proc~setup_hamiltonian&#45;&gt;molecularmechanics</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M285.542,-566.908C282.701,-497.896 265.442,-154.124 201,-75 200.285,-74.1226 199.529,-73.2817 198.737,-72.4759"/>
<polygon fill="#000000" stroke="#000000" points="200.761,-69.6135 190.755,-66.1286 196.404,-75.0923 200.761,-69.6135"/>
</g>
<!-- class_zSpData2D -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node29" class="node"><title>class_zSpData2D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="194.5,-24 97.5,-24 97.5,-0 194.5,-0 194.5,-24"/>
<text text-anchor="middle" x="146" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_zSpData2D</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;class_zSpData2D -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge28" class="edge"><title>proc~setup_hamiltonian&#45;&gt;class_zSpData2D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M285.713,-566.866C283.769,-494.432 270.428,-119.354 201,-33 200.291,-32.1181 199.54,-31.2731 198.752,-30.4635"/>
<polygon fill="#000000" stroke="#000000" points="200.793,-27.6139 190.801,-24.0919 196.416,-33.0765 200.793,-27.6139"/>
</g>
<!-- precision -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node30" class="node"><title>precision</title>
<polygon fill="#337ab7" stroke="#337ab7" points="55,-339 0,-339 0,-315 55,-315 55,-339"/>
<text text-anchor="middle" x="27.5" y="-324.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">precision</text>
</g>
<!-- module~m_dhscf&#45;&gt;precision -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge29" class="edge"><title>module~m_dhscf&#45;&gt;precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M118.855,-310.713C103.041,-313.563 82.6347,-317.242 65.2178,-320.381"/>
<polygon fill="#000000" stroke="#000000" points="64.5862,-316.939 55.3657,-322.157 65.828,-323.828 64.5862,-316.939"/>
</g>
<!-- m_dfscf -->
<g id="proc~~setup_hamiltonian~~UsesGraph_node31" class="node"><title>m_dfscf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54.5,-297 0.5,-297 0.5,-273 54.5,-273 54.5,-297"/>
<text text-anchor="middle" x="27.5" y="-282.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">m_dfscf</text>
</g>
<!-- module~m_dhscf&#45;&gt;m_dfscf -->
<g id="proc~~setup_hamiltonian~~UsesGraph_edge30" class="edge"><title>module~m_dhscf&#45;&gt;m_dfscf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M118.855,-301.287C102.816,-298.396 82.0549,-294.654 64.4785,-291.485"/>
<polygon fill="#000000" stroke="#000000" points="65.0199,-288.027 54.5576,-289.697 63.7781,-294.916 65.0199,-288.027"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="490pt" height="32pt"
 viewBox="0.00 0.00 489.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 485.5,-28 485.5,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node"><title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node"><title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="139.5,-24 72.5,-24 72.5,-0 139.5,-0 139.5,-24"/>
<text text-anchor="middle" x="106" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="222,-24 158,-24 158,-0 222,-0 222,-24"/>
<text text-anchor="middle" x="190" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="294,-24 240,-24 240,-0 294,-0 294,-24"/>
<text text-anchor="middle" x="267" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="366,-24 312,-24 312,-0 366,-0 366,-24"/>
<text text-anchor="middle" x="339" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="481.5,-24 384.5,-24 384.5,-0 481.5,-0 481.5,-24"/>
<text text-anchor="middle" x="433" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses.
    </p>
    </div></div></div></div>
      </li>
      
      </ul>
    </div>
    


    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iscf"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>iscf</strong></td><td></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~setup_hamiltonian~~CallsGraph Pages: 1 -->
<svg id="procsetup_hamiltonianCallsGraph" width="641pt" height="1469pt"
 viewBox="0.00 0.00 641.00 1468.60" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~setup_hamiltonian~~CallsGraph" class="graph" transform="scale(0.863881 0.863881) rotate(0) translate(4 1696)">
<title>proc~~setup_hamiltonian~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1696 738,-1696 738,4 -4,4"/>
<!-- proc~setup_hamiltonian -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node1" class="node"><title>proc~setup_hamiltonian</title>
<polygon fill="none" stroke="black" points="100,-848 0,-848 0,-824 100,-824 100,-848"/>
<text text-anchor="middle" x="50" y="-833.6" font-family="Helvetica,sans-Serif" font-size="10.50">setup_hamiltonian</text>
</g>
<!-- proc~dhscf -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node2" class="node"><title>proc~dhscf</title>
<g id="a_proc~~setup_hamiltonian~~CallsGraph_node2"><a xlink:href=".././proc/dhscf.html" xlink:title="dhscf">
<polygon fill="#d9534f" stroke="#d9534f" points="203.5,-848 149.5,-848 149.5,-824 203.5,-824 203.5,-848"/>
<text text-anchor="middle" x="176.5" y="-833.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dhscf</text>
</a>
</g>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;proc~dhscf -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge8" class="edge"><title>proc~setup_hamiltonian&#45;&gt;proc~dhscf</title>
<path fill="none" stroke="#000000" d="M100.206,-836C113.138,-836 126.856,-836 138.991,-836"/>
<polygon fill="#000000" stroke="#000000" points="139.187,-839.5 149.187,-836 139.187,-832.5 139.187,-839.5"/>
</g>
<!-- hold -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node3" class="node"><title>hold</title>
<polygon fill="#777777" stroke="#777777" points="203.5,-1096 149.5,-1096 149.5,-1072 203.5,-1072 203.5,-1096"/>
<text text-anchor="middle" x="176.5" y="-1081.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hold</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;hold -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge14" class="edge"><title>proc~setup_hamiltonian&#45;&gt;hold</title>
<path fill="none" stroke="#000000" d="M52.4909,-848.128C57.5742,-884.801 77.2977,-996.1 136,-1063 137.498,-1064.71 139.17,-1066.3 140.956,-1067.78"/>
<polygon fill="#000000" stroke="#000000" points="139.114,-1070.76 149.332,-1073.56 143.092,-1065 139.114,-1070.76"/>
</g>
<!-- globalize_sum -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node4" class="node"><title>globalize_sum</title>
<polygon fill="#777777" stroke="#777777" points="217,-1054 136,-1054 136,-1030 217,-1030 217,-1054"/>
<text text-anchor="middle" x="176.5" y="-1039.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">globalize_sum</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;globalize_sum -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge3" class="edge"><title>proc~setup_hamiltonian&#45;&gt;globalize_sum</title>
<path fill="none" stroke="#000000" d="M53.7419,-848.354C61.4399,-880.522 86.0269,-968.044 136,-1021 136.9,-1021.95 137.852,-1022.87 138.847,-1023.76"/>
<polygon fill="#000000" stroke="#000000" points="136.997,-1026.74 147.117,-1029.88 141.162,-1021.12 136.997,-1026.74"/>
</g>
<!-- val -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node5" class="node"><title>val</title>
<polygon fill="#777777" stroke="#777777" points="203.5,-1012 149.5,-1012 149.5,-988 203.5,-988 203.5,-1012"/>
<text text-anchor="middle" x="176.5" y="-997.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">val</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;val -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge4" class="edge"><title>proc~setup_hamiltonian&#45;&gt;val</title>
<path fill="none" stroke="#000000" d="M55.5788,-848.213C66.1142,-874.929 94.4035,-939.34 136,-979 137.476,-980.407 139.064,-981.746 140.726,-983.016"/>
<polygon fill="#000000" stroke="#000000" points="139.202,-986.205 149.476,-988.793 143.059,-980.363 139.202,-986.205"/>
</g>
<!-- h -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node6" class="node"><title>h</title>
<polygon fill="#777777" stroke="#777777" points="203.5,-970 149.5,-970 149.5,-946 203.5,-946 203.5,-970"/>
<text text-anchor="middle" x="176.5" y="-955.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">h</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;h -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge5" class="edge"><title>proc~setup_hamiltonian&#45;&gt;h</title>
<path fill="none" stroke="#000000" d="M60.0437,-848.144C74.6782,-867.316 105.048,-905.173 136,-932 139.211,-934.783 142.737,-937.503 146.321,-940.072"/>
<polygon fill="#000000" stroke="#000000" points="144.429,-943.018 154.665,-945.751 148.367,-937.231 144.429,-943.018"/>
</g>
<!-- timer -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node7" class="node"><title>timer</title>
<polygon fill="#777777" stroke="#777777" points="734,-1447 680,-1447 680,-1423 734,-1423 734,-1447"/>
<text text-anchor="middle" x="707" y="-1432.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">timer</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;timer -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge7" class="edge"><title>proc~setup_hamiltonian&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M52.4931,-848.197C64.0055,-940.522 141.197,-1529.39 253,-1663 273.431,-1687.42 286.663,-1692 318.5,-1692 318.5,-1692 318.5,-1692 473,-1692 599.673,-1692 675.479,-1518.51 698.494,-1456.62"/>
<polygon fill="#000000" stroke="#000000" points="701.845,-1457.65 701.958,-1447.05 695.263,-1455.26 701.845,-1457.65"/>
</g>
<!-- write_hsx -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node8" class="node"><title>write_hsx</title>
<polygon fill="#777777" stroke="#777777" points="205.5,-890 147.5,-890 147.5,-866 205.5,-866 205.5,-890"/>
<text text-anchor="middle" x="176.5" y="-875.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_hsx</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;write_hsx -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge1" class="edge"><title>proc~setup_hamiltonian&#45;&gt;write_hsx</title>
<path fill="none" stroke="#000000" d="M86.6767,-848.036C102.624,-853.415 121.435,-859.761 137.632,-865.225"/>
<polygon fill="#000000" stroke="#000000" points="136.735,-868.616 147.329,-868.497 138.973,-861.984 136.735,-868.616"/>
</g>
<!-- de_alloc -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node9" class="node"><title>de_alloc</title>
<polygon fill="#777777" stroke="#777777" points="734,-944 680,-944 680,-920 734,-920 734,-944"/>
<text text-anchor="middle" x="707" y="-929.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">de_alloc</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;de_alloc -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge9" class="edge"><title>proc~setup_hamiltonian&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M51.5613,-823.988C55.3541,-746.06 78.8309,-311.691 136,-194 180.904,-101.557 215.728,-52 318.5,-52 318.5,-52 318.5,-52 473,-52 616.547,-52 597.491,-190.196 644,-326 682.151,-437.4 700.843,-813.526 705.062,-909.54"/>
<polygon fill="#000000" stroke="#000000" points="701.567,-909.753 705.495,-919.593 708.561,-909.452 701.567,-909.753"/>
</g>
<!-- re_alloc -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node10" class="node"><title>re_alloc</title>
<polygon fill="#777777" stroke="#777777" points="734,-1224 680,-1224 680,-1200 734,-1200 734,-1224"/>
<text text-anchor="middle" x="707" y="-1209.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">re_alloc</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;re_alloc -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge10" class="edge"><title>proc~setup_hamiltonian&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M65.4229,-848.089C81.8519,-861.52 109.82,-883.369 136,-899 170.142,-919.384 194.81,-904.003 217,-937 260.027,-1000.98 197.083,-1576.91 253,-1630 401.651,-1771.13 612.852,-1478.91 644,-1433 687.127,-1369.43 700.459,-1276.28 704.414,-1234.15"/>
<polygon fill="#000000" stroke="#000000" points="707.906,-1234.39 705.265,-1224.13 700.931,-1233.8 707.906,-1234.39"/>
</g>
<!-- dimag -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node11" class="node"><title>dimag</title>
<polygon fill="#777777" stroke="#777777" points="203.5,-517 149.5,-517 149.5,-493 203.5,-493 203.5,-517"/>
<text text-anchor="middle" x="176.5" y="-502.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dimag</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;dimag -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge6" class="edge"><title>proc~setup_hamiltonian&#45;&gt;dimag</title>
<path fill="none" stroke="#000000" d="M51.4084,-823.934C53.4512,-780.213 65.5412,-627.59 136,-531 137.984,-528.281 140.345,-525.765 142.913,-523.459"/>
<polygon fill="#000000" stroke="#000000" points="145.284,-526.05 151.06,-517.168 141.006,-520.509 145.284,-526.05"/>
</g>
<!-- dscf -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node12" class="node"><title>dscf</title>
<polygon fill="#777777" stroke="#777777" points="203.5,-475 149.5,-475 149.5,-451 203.5,-451 203.5,-475"/>
<text text-anchor="middle" x="176.5" y="-460.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dscf</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;dscf -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge12" class="edge"><title>proc~setup_hamiltonian&#45;&gt;dscf</title>
<path fill="none" stroke="#000000" d="M50.55,-823.89C49.3814,-775.527 51.0574,-593.55 136,-484 137.431,-482.155 139.07,-480.453 140.849,-478.888"/>
<polygon fill="#000000" stroke="#000000" points="143.206,-481.507 149.333,-472.864 139.153,-475.799 143.206,-481.507"/>
</g>
<!-- update_e0 -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node13" class="node"><title>update_e0</title>
<polygon fill="#777777" stroke="#777777" points="208.5,-433 144.5,-433 144.5,-409 208.5,-409 208.5,-433"/>
<text text-anchor="middle" x="176.5" y="-418.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_e0</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;update_e0 -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge13" class="edge"><title>proc~setup_hamiltonian&#45;&gt;update_e0</title>
<path fill="none" stroke="#000000" d="M52.2637,-823.635C58.5784,-763.851 88.3149,-505.077 136,-442 136.574,-441.241 137.183,-440.507 137.823,-439.796"/>
<polygon fill="#000000" stroke="#000000" points="140.344,-442.245 145.646,-433.072 135.781,-436.936 140.344,-442.245"/>
</g>
<!-- die -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node14" class="node"><title>die</title>
<polygon fill="#777777" stroke="#777777" points="628,-583 574,-583 574,-559 628,-559 628,-583"/>
<text text-anchor="middle" x="601" y="-568.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">die</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;die -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge11" class="edge"><title>proc~setup_hamiltonian&#45;&gt;die</title>
<path fill="none" stroke="#000000" d="M59.933,-823.818C88.7885,-783.718 179.782,-651.234 217,-526 243.496,-436.843 184.461,-171.877 253,-109 359.923,-10.9104 458.338,-163.611 522,-294 565.519,-383.133 588.45,-500.615 596.552,-548.867"/>
<polygon fill="#000000" stroke="#000000" points="593.114,-549.531 598.178,-558.837 600.023,-548.404 593.114,-549.531"/>
</g>
<!-- bye -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node15" class="node"><title>bye</title>
<polygon fill="#777777" stroke="#777777" points="346.5,-142 292.5,-142 292.5,-118 346.5,-118 346.5,-142"/>
<text text-anchor="middle" x="319.5" y="-127.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bye</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;bye -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge2" class="edge"><title>proc~setup_hamiltonian&#45;&gt;bye</title>
<path fill="none" stroke="#000000" d="M52.2142,-823.924C57.6711,-771.988 82.051,-562.889 136,-400 173.813,-285.832 165.065,-238.047 253,-156 261.356,-148.204 272.334,-142.635 282.908,-138.707"/>
<polygon fill="#000000" stroke="#000000" points="284.035,-142.021 292.419,-135.544 281.826,-135.379 284.035,-142.021"/>
</g>
<!-- hubbard_term -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node16" class="node"><title>hubbard_term</title>
<polygon fill="#777777" stroke="#777777" points="216.5,-24 136.5,-24 136.5,-0 216.5,-0 216.5,-24"/>
<text text-anchor="middle" x="176.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hubbard_term</text>
</g>
<!-- proc~setup_hamiltonian&#45;&gt;hubbard_term -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge15" class="edge"><title>proc~setup_hamiltonian&#45;&gt;hubbard_term</title>
<path fill="none" stroke="#000000" d="M50.9037,-823.88C50.394,-734.564 50.7065,-177.936 136,-38 137.602,-35.3711 139.583,-32.9545 141.796,-30.7444"/>
<polygon fill="#000000" stroke="#000000" points="144.49,-33.0619 150.008,-24.0174 140.055,-27.6467 144.49,-33.0619"/>
</g>
<!-- proc~dhscf&#45;&gt;timer -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge45" class="edge"><title>proc~dhscf&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M203.527,-844.92C208.82,-847.937 213.755,-851.885 217,-857 261.102,-926.509 193.394,-1540.22 253,-1597 383.76,-1721.55 616.774,-1520.16 686.048,-1454.55"/>
<polygon fill="#000000" stroke="#000000" points="688.866,-1456.7 693.667,-1447.25 684.024,-1451.64 688.866,-1456.7"/>
</g>
<!-- proc~dhscf&#45;&gt;de_alloc -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge49" class="edge"><title>proc~dhscf&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M179.132,-823.898C184.707,-782.415 203.401,-642.125 217,-526 225.76,-451.196 196.987,-239.348 253,-189 296.962,-149.484 330.054,-169.916 386,-189 688.007,-292.018 706.002,-797.396 706.228,-909.812"/>
<polygon fill="#000000" stroke="#000000" points="702.728,-909.962 706.199,-919.972 709.728,-909.982 702.728,-909.962"/>
</g>
<!-- proc~dhscf&#45;&gt;re_alloc -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge17" class="edge"><title>proc~dhscf&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M203.863,-845.199C209.006,-848.183 213.791,-852.046 217,-857 281.426,-956.447 169.811,-1304.62 253,-1389 283.563,-1420 608.991,-1439.88 644,-1414 701.276,-1371.67 707.336,-1277.36 706.921,-1234.26"/>
<polygon fill="#000000" stroke="#000000" points="710.415,-1233.93 706.687,-1224.01 703.417,-1234.09 710.415,-1233.93"/>
</g>
<!-- proc~dhscf&#45;&gt;die -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge44" class="edge"><title>proc~dhscf&#45;&gt;die</title>
<path fill="none" stroke="#000000" d="M179.311,-823.861C185.06,-785.214 203.323,-661.561 217,-559 225.584,-494.631 204.335,-311.998 253,-269 385.699,-151.755 548.831,-464.14 590.139,-549.899"/>
<polygon fill="#000000" stroke="#000000" points="587.004,-551.456 594.463,-558.979 593.324,-548.446 587.004,-551.456"/>
</g>
<!-- proc~dhscf&#45;&gt;bye -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge28" class="edge"><title>proc~dhscf&#45;&gt;bye</title>
<path fill="none" stroke="#000000" d="M179.461,-823.879C185.654,-785.288 205.089,-661.781 217,-559 227.35,-469.686 199.232,-228.064 253,-156 260.187,-146.368 271.501,-140.3 282.718,-136.478"/>
<polygon fill="#000000" stroke="#000000" points="283.81,-139.806 292.444,-133.666 281.866,-133.082 283.81,-139.806"/>
</g>
<!-- elecs -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node17" class="node"><title>elecs</title>
<polygon fill="#777777" stroke="#777777" points="346.5,-932 292.5,-932 292.5,-908 346.5,-908 346.5,-932"/>
<text text-anchor="middle" x="319.5" y="-917.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elecs</text>
</g>
<!-- proc~dhscf&#45;&gt;elecs -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge21" class="edge"><title>proc~dhscf&#45;&gt;elecs</title>
<path fill="none" stroke="#000000" d="M203.866,-848.236C208.436,-850.847 212.999,-853.795 217,-857 236.188,-872.371 232.519,-885.399 253,-899 261.879,-904.896 272.528,-909.233 282.633,-912.382"/>
<polygon fill="#000000" stroke="#000000" points="281.898,-915.811 292.473,-915.149 283.793,-909.073 281.898,-915.811"/>
</g>
<!-- ts_voltage -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node18" class="node"><title>ts_voltage</title>
<polygon fill="#777777" stroke="#777777" points="350,-890 289,-890 289,-866 350,-866 350,-890"/>
<text text-anchor="middle" x="319.5" y="-875.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ts_voltage</text>
</g>
<!-- proc~dhscf&#45;&gt;ts_voltage -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge18" class="edge"><title>proc~dhscf&#45;&gt;ts_voltage</title>
<path fill="none" stroke="#000000" d="M203.691,-843.801C224.805,-850.091 254.838,-859.037 278.891,-866.201"/>
<polygon fill="#000000" stroke="#000000" points="278.206,-869.65 288.789,-869.15 280.205,-862.941 278.206,-869.65"/>
</g>
<!-- dfscf -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node19" class="node"><title>dfscf</title>
<polygon fill="#777777" stroke="#777777" points="346.5,-848 292.5,-848 292.5,-824 346.5,-824 346.5,-848"/>
<text text-anchor="middle" x="319.5" y="-833.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dfscf</text>
</g>
<!-- proc~dhscf&#45;&gt;dfscf -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge38" class="edge"><title>proc~dhscf&#45;&gt;dfscf</title>
<path fill="none" stroke="#000000" d="M203.691,-836C225.851,-836 257.833,-836 282.417,-836"/>
<polygon fill="#000000" stroke="#000000" points="282.45,-839.5 292.45,-836 282.45,-832.5 282.45,-839.5"/>
</g>
<!-- ts_hartree_fix -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node20" class="node"><title>ts_hartree_fix</title>
<polygon fill="#777777" stroke="#777777" points="358.5,-806 280.5,-806 280.5,-782 358.5,-782 358.5,-806"/>
<text text-anchor="middle" x="319.5" y="-791.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ts_hartree_fix</text>
</g>
<!-- proc~dhscf&#45;&gt;ts_hartree_fix -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge20" class="edge"><title>proc~dhscf&#45;&gt;ts_hartree_fix</title>
<path fill="none" stroke="#000000" d="M203.691,-828.199C222.491,-822.598 248.362,-814.892 270.786,-808.213"/>
<polygon fill="#000000" stroke="#000000" points="271.896,-811.534 280.481,-805.325 269.897,-804.825 271.896,-811.534"/>
</g>
<!-- volcel -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node21" class="node"><title>volcel</title>
<polygon fill="#777777" stroke="#777777" points="346.5,-764 292.5,-764 292.5,-740 346.5,-740 346.5,-764"/>
<text text-anchor="middle" x="319.5" y="-749.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">volcel</text>
</g>
<!-- proc~dhscf&#45;&gt;volcel -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge16" class="edge"><title>proc~dhscf&#45;&gt;volcel</title>
<path fill="none" stroke="#000000" d="M189.222,-823.684C203.208,-809.634 227.87,-786.821 253,-773 262.182,-767.95 272.765,-763.895 282.71,-760.746"/>
<polygon fill="#000000" stroke="#000000" points="283.766,-764.083 292.366,-757.895 281.785,-757.37 283.766,-764.083"/>
</g>
<!-- ddot -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node22" class="node"><title>ddot</title>
<polygon fill="#777777" stroke="#777777" points="346.5,-722 292.5,-722 292.5,-698 346.5,-698 346.5,-722"/>
<text text-anchor="middle" x="319.5" y="-707.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ddot</text>
</g>
<!-- proc~dhscf&#45;&gt;ddot -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge22" class="edge"><title>proc~dhscf&#45;&gt;ddot</title>
<path fill="none" stroke="#000000" d="M183.088,-823.665C193.623,-801.777 218.5,-756.092 253,-731 261.692,-724.678 272.368,-720.206 282.558,-717.064"/>
<polygon fill="#000000" stroke="#000000" points="283.773,-720.361 292.496,-714.347 281.927,-713.608 283.773,-720.361"/>
</g>
<!-- jms_setmeshdistr -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node23" class="node"><title>jms_setmeshdistr</title>
<polygon fill="#777777" stroke="#777777" points="367.5,-680 271.5,-680 271.5,-656 367.5,-656 367.5,-680"/>
<text text-anchor="middle" x="319.5" y="-665.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jms_setmeshdistr</text>
</g>
<!-- proc~dhscf&#45;&gt;jms_setmeshdistr -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge23" class="edge"><title>proc~dhscf&#45;&gt;jms_setmeshdistr</title>
<path fill="none" stroke="#000000" d="M180.367,-823.724C187.557,-795.646 209.016,-726.295 253,-689 255.855,-686.579 258.992,-684.437 262.301,-682.54"/>
<polygon fill="#000000" stroke="#000000" points="263.953,-685.628 271.38,-678.073 260.862,-679.347 263.953,-685.628"/>
</g>
<!-- mpitrace_restart -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node24" class="node"><title>mpitrace_restart</title>
<polygon fill="#777777" stroke="#777777" points="365,-638 274,-638 274,-614 365,-614 365,-638"/>
<text text-anchor="middle" x="319.5" y="-623.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpitrace_restart</text>
</g>
<!-- proc~dhscf&#45;&gt;mpitrace_restart -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge24" class="edge"><title>proc~dhscf&#45;&gt;mpitrace_restart</title>
<path fill="none" stroke="#000000" d="M178.799,-823.845C183.002,-790.566 199.25,-697.123 253,-647 256.383,-643.845 260.242,-641.165 264.355,-638.887"/>
<polygon fill="#000000" stroke="#000000" points="266.111,-641.929 273.679,-634.515 263.139,-635.591 266.111,-641.929"/>
</g>
<!-- bsc_cellxc -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node25" class="node"><title>bsc_cellxc</title>
<polygon fill="#777777" stroke="#777777" points="350,-596 289,-596 289,-572 350,-572 350,-596"/>
<text text-anchor="middle" x="319.5" y="-581.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bsc_cellxc</text>
</g>
<!-- proc~dhscf&#45;&gt;bsc_cellxc -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge25" class="edge"><title>proc~dhscf&#45;&gt;bsc_cellxc</title>
<path fill="none" stroke="#000000" d="M177.792,-823.733C179.372,-785.65 189.424,-668.219 253,-605 260.102,-597.938 269.58,-593.25 279.116,-590.137"/>
<polygon fill="#000000" stroke="#000000" points="280.26,-593.453 288.977,-587.431 278.407,-586.702 280.26,-593.453"/>
</g>
<!-- write_grid_netcdf -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node26" class="node"><title>write_grid_netcdf</title>
<polygon fill="#777777" stroke="#777777" points="366.5,-554 272.5,-554 272.5,-530 366.5,-530 366.5,-554"/>
<text text-anchor="middle" x="319.5" y="-539.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_grid_netcdf</text>
</g>
<!-- proc~dhscf&#45;&gt;write_grid_netcdf -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge26" class="edge"><title>proc~dhscf&#45;&gt;write_grid_netcdf</title>
<path fill="none" stroke="#000000" d="M177.071,-823.992C176.245,-781.95 179.256,-639.788 253,-563 255.978,-559.899 259.413,-557.255 263.119,-555.001"/>
<polygon fill="#000000" stroke="#000000" points="264.829,-558.058 272.168,-550.417 261.665,-551.814 264.829,-558.058"/>
</g>
<!-- proc~setmeshdistr -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node27" class="node"><title>proc~setmeshdistr</title>
<g id="a_proc~~setup_hamiltonian~~CallsGraph_node27"><a xlink:href=".././proc/setmeshdistr.html" xlink:title="setMeshDistr">
<polygon fill="#d9534f" stroke="#d9534f" points="357,-1016 282,-1016 282,-992 357,-992 357,-1016"/>
<text text-anchor="middle" x="319.5" y="-1001.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setMeshDistr</text>
</a>
</g>
</g>
<!-- proc~dhscf&#45;&gt;proc~setmeshdistr -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge27" class="edge"><title>proc~dhscf&#45;&gt;proc~setmeshdistr</title>
<path fill="none" stroke="#000000" d="M203.525,-845.975C208.56,-848.892 213.385,-852.532 217,-857 253.632,-902.278 212.481,-941.165 253,-983 258.255,-988.426 264.911,-992.452 271.956,-995.44"/>
<polygon fill="#000000" stroke="#000000" points="271.114,-998.854 281.708,-998.903 273.457,-992.258 271.114,-998.854"/>
</g>
<!-- partialcoreonmesh -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node28" class="node"><title>partialcoreonmesh</title>
<polygon fill="#777777" stroke="#777777" points="370,-512 269,-512 269,-488 370,-488 370,-512"/>
<text text-anchor="middle" x="319.5" y="-497.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">partialcoreonmesh</text>
</g>
<!-- proc~dhscf&#45;&gt;partialcoreonmesh -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge35" class="edge"><title>proc~dhscf&#45;&gt;partialcoreonmesh</title>
<path fill="none" stroke="#000000" d="M178.814,-823.938C184.716,-771.875 210.356,-566.97 253,-521 255.056,-518.784 257.345,-516.801 259.802,-515.026"/>
<polygon fill="#000000" stroke="#000000" points="261.88,-517.864 268.705,-509.761 258.316,-511.839 261.88,-517.864"/>
</g>
<!-- get_field_from_dipole -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node29" class="node"><title>get_field_from_dipole</title>
<polygon fill="#777777" stroke="#777777" points="377,-470 262,-470 262,-446 377,-446 377,-470"/>
<text text-anchor="middle" x="319.5" y="-455.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_field_from_dipole</text>
</g>
<!-- proc~dhscf&#45;&gt;get_field_from_dipole -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge29" class="edge"><title>proc~dhscf&#45;&gt;get_field_from_dipole</title>
<path fill="none" stroke="#000000" d="M178.452,-823.89C183.11,-767.584 205.236,-531.894 253,-479 253.9,-478.003 254.848,-477.053 255.837,-476.148"/>
<polygon fill="#000000" stroke="#000000" points="258.149,-478.792 264.135,-470.051 254.004,-473.152 258.149,-478.792"/>
</g>
<!-- vmatsp -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node30" class="node"><title>vmatsp</title>
<polygon fill="#777777" stroke="#777777" points="346.5,-428 292.5,-428 292.5,-404 346.5,-404 346.5,-428"/>
<text text-anchor="middle" x="319.5" y="-413.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">vmatsp</text>
</g>
<!-- proc~dhscf&#45;&gt;vmatsp -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge30" class="edge"><title>proc~dhscf&#45;&gt;vmatsp</title>
<path fill="none" stroke="#000000" d="M179.057,-823.805C187.291,-760.079 226.389,-467.111 253,-437 260.568,-428.436 271.632,-423.341 282.52,-420.317"/>
<polygon fill="#000000" stroke="#000000" points="283.387,-423.709 292.364,-418.082 281.837,-416.883 283.387,-423.709"/>
</g>
<!-- rhoofd -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node31" class="node"><title>rhoofd</title>
<polygon fill="#777777" stroke="#777777" points="346.5,-386 292.5,-386 292.5,-362 346.5,-362 346.5,-386"/>
<text text-anchor="middle" x="319.5" y="-371.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rhoofd</text>
</g>
<!-- proc~dhscf&#45;&gt;rhoofd -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge31" class="edge"><title>proc~dhscf&#45;&gt;rhoofd</title>
<path fill="none" stroke="#000000" d="M179.225,-823.799C189.083,-754.396 238.358,-411.862 253,-395 260.493,-386.371 271.538,-381.259 282.432,-378.24"/>
<polygon fill="#000000" stroke="#000000" points="283.303,-381.631 292.287,-376.015 281.762,-374.803 283.303,-381.631"/>
</g>
<!-- hartree_add -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node32" class="node"><title>hartree_add</title>
<polygon fill="#777777" stroke="#777777" points="355,-344 284,-344 284,-320 355,-320 355,-344"/>
<text text-anchor="middle" x="319.5" y="-329.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hartree_add</text>
</g>
<!-- proc~dhscf&#45;&gt;hartree_add -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge32" class="edge"><title>proc~dhscf&#45;&gt;hartree_add</title>
<path fill="none" stroke="#000000" d="M179.223,-823.832C189.731,-749.76 245.016,-362.33 253,-353 258.58,-346.479 266.19,-341.964 274.251,-338.843"/>
<polygon fill="#000000" stroke="#000000" points="275.365,-342.161 283.825,-335.783 273.234,-335.493 275.365,-342.161"/>
</g>
<!-- add_potential_from_field -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node33" class="node"><title>add_potential_from_field</title>
<polygon fill="#777777" stroke="#777777" points="384.5,-302 254.5,-302 254.5,-278 384.5,-278 384.5,-302"/>
<text text-anchor="middle" x="319.5" y="-287.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">add_potential_from_field</text>
</g>
<!-- proc~dhscf&#45;&gt;add_potential_from_field -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge33" class="edge"><title>proc~dhscf&#45;&gt;add_potential_from_field</title>
<path fill="none" stroke="#000000" d="M179.242,-823.811C190.493,-745.085 252.46,-311.639 253,-311 253.752,-310.111 254.541,-309.259 255.364,-308.443"/>
<polygon fill="#000000" stroke="#000000" points="257.857,-310.936 263.578,-302.019 253.544,-305.422 257.857,-310.936"/>
</g>
<!-- proc~reord -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node34" class="node"><title>proc~reord</title>
<g id="a_proc~~setup_hamiltonian~~CallsGraph_node34"><a xlink:href=".././proc/reord.html" xlink:title="reord">
<polygon fill="#d9534f" stroke="#d9534f" points="628,-1224 574,-1224 574,-1200 628,-1200 628,-1224"/>
<text text-anchor="middle" x="601" y="-1209.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reord</text>
</a>
</g>
</g>
<!-- proc~dhscf&#45;&gt;proc~reord -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge34" class="edge"><title>proc~dhscf&#45;&gt;proc~reord</title>
<path fill="none" stroke="#000000" d="M203.72,-845.294C208.87,-848.273 213.694,-852.11 217,-857 259.056,-919.212 198.537,-1141.3 253,-1193 296.762,-1234.54 483.972,-1222.77 563.756,-1215.63"/>
<polygon fill="#000000" stroke="#000000" points="564.193,-1219.11 573.83,-1214.7 563.551,-1212.14 564.193,-1219.11"/>
</g>
<!-- compute_partial_charges -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node35" class="node"><title>compute_partial_charges</title>
<polygon fill="#777777" stroke="#777777" points="386,-222 253,-222 253,-198 386,-198 386,-222"/>
<text text-anchor="middle" x="319.5" y="-207.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_partial_charges</text>
</g>
<!-- proc~dhscf&#45;&gt;compute_partial_charges -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge36" class="edge"><title>proc~dhscf&#45;&gt;compute_partial_charges</title>
<path fill="none" stroke="#000000" d="M179.366,-823.868C185.276,-785.242 203.965,-661.644 217,-559 226.099,-487.353 209.179,-293.409 253,-236 255.436,-232.809 258.323,-230.009 261.507,-227.552"/>
<polygon fill="#000000" stroke="#000000" points="263.426,-230.479 269.94,-222.123 259.637,-224.593 263.426,-230.479"/>
</g>
<!-- write_tdrho -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node36" class="node"><title>write_tdrho</title>
<polygon fill="#777777" stroke="#777777" points="352.5,-1588 286.5,-1588 286.5,-1564 352.5,-1564 352.5,-1588"/>
<text text-anchor="middle" x="319.5" y="-1573.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_tdrho</text>
</g>
<!-- proc~dhscf&#45;&gt;write_tdrho -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge37" class="edge"><title>proc~dhscf&#45;&gt;write_tdrho</title>
<path fill="none" stroke="#000000" d="M203.514,-844.928C208.808,-847.945 213.746,-851.89 217,-857 299.829,-987.074 163.097,-1424.71 253,-1550 258.77,-1558.04 267.435,-1563.6 276.588,-1567.43"/>
<polygon fill="#000000" stroke="#000000" points="275.607,-1570.8 286.202,-1570.84 277.947,-1564.2 275.607,-1570.8"/>
</g>
<!-- mpi_barrier -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node37" class="node"><title>mpi_barrier</title>
<polygon fill="#777777" stroke="#777777" points="634.5,-1325 567.5,-1325 567.5,-1301 634.5,-1301 634.5,-1325"/>
<text text-anchor="middle" x="601" y="-1310.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_barrier</text>
</g>
<!-- proc~dhscf&#45;&gt;mpi_barrier -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge19" class="edge"><title>proc~dhscf&#45;&gt;mpi_barrier</title>
<path fill="none" stroke="#000000" d="M203.847,-845.209C208.991,-848.193 213.78,-852.053 217,-857 277.771,-950.363 171.45,-1281.11 253,-1357 341.978,-1439.8 503.942,-1366.23 570.37,-1330.19"/>
<polygon fill="#000000" stroke="#000000" points="572.398,-1333.07 579.458,-1325.17 569.012,-1326.94 572.398,-1333.07"/>
</g>
<!-- write_rho -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node38" class="node"><title>write_rho</title>
<polygon fill="#777777" stroke="#777777" points="348,-1508 291,-1508 291,-1484 348,-1484 348,-1508"/>
<text text-anchor="middle" x="319.5" y="-1493.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_rho</text>
</g>
<!-- proc~dhscf&#45;&gt;write_rho -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge39" class="edge"><title>proc~dhscf&#45;&gt;write_rho</title>
<path fill="none" stroke="#000000" d="M203.898,-845.177C209.038,-848.162 213.814,-852.031 217,-857 291.255,-972.804 168.725,-1366.27 253,-1475 259.764,-1483.73 270.185,-1488.89 280.74,-1491.92"/>
<polygon fill="#000000" stroke="#000000" points="280.256,-1495.4 290.785,-1494.23 281.821,-1488.58 280.256,-1495.4"/>
</g>
<!-- rhoofdsp -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node39" class="node"><title>rhoofdsp</title>
<polygon fill="#777777" stroke="#777777" points="347,-1466 292,-1466 292,-1442 347,-1442 347,-1466"/>
<text text-anchor="middle" x="319.5" y="-1451.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rhoofdsp</text>
</g>
<!-- proc~dhscf&#45;&gt;rhoofdsp -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge40" class="edge"><title>proc~dhscf&#45;&gt;rhoofdsp</title>
<path fill="none" stroke="#000000" d="M203.88,-845.188C209.022,-848.172 213.802,-852.039 217,-857 285.883,-963.864 178.307,-1325.11 253,-1428 260.005,-1437.65 271.168,-1443.72 282.309,-1447.54"/>
<polygon fill="#000000" stroke="#000000" points="281.409,-1450.92 291.989,-1450.35 283.36,-1444.2 281.409,-1450.92"/>
</g>
<!-- mymeshbox -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node40" class="node"><title>mymeshbox</title>
<polygon fill="#777777" stroke="#777777" points="354.5,-1348 284.5,-1348 284.5,-1324 354.5,-1324 354.5,-1348"/>
<text text-anchor="middle" x="319.5" y="-1333.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mymeshbox</text>
</g>
<!-- proc~dhscf&#45;&gt;mymeshbox -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge41" class="edge"><title>proc~dhscf&#45;&gt;mymeshbox</title>
<path fill="none" stroke="#000000" d="M203.823,-845.225C208.968,-848.207 213.764,-852.064 217,-857 272.974,-942.379 189.643,-1234.95 253,-1315 258.546,-1322.01 266.447,-1326.71 274.852,-1329.86"/>
<polygon fill="#000000" stroke="#000000" points="273.87,-1333.22 284.457,-1332.8 275.916,-1326.53 273.87,-1333.22"/>
</g>
<!-- neutralatomonmesh -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node41" class="node"><title>neutralatomonmesh</title>
<polygon fill="#777777" stroke="#777777" points="373.5,-1306 265.5,-1306 265.5,-1282 373.5,-1282 373.5,-1306"/>
<text text-anchor="middle" x="319.5" y="-1291.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">neutralatomonmesh</text>
</g>
<!-- proc~dhscf&#45;&gt;neutralatomonmesh -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge42" class="edge"><title>proc~dhscf&#45;&gt;neutralatomonmesh</title>
<path fill="none" stroke="#000000" d="M203.794,-845.244C208.94,-848.225 213.744,-852.076 217,-857 268.18,-934.399 195.13,-1200.47 253,-1273 254.257,-1274.58 255.633,-1276.03 257.106,-1277.38"/>
<polygon fill="#000000" stroke="#000000" points="255.048,-1280.22 265.19,-1283.28 259.172,-1274.56 255.048,-1280.22"/>
</g>
<!-- interface~distmeshdata -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node42" class="node"><title>interface~distmeshdata</title>
<g id="a_proc~~setup_hamiltonian~~CallsGraph_node42"><a xlink:href=".././interface/distmeshdata.html" xlink:title="distMeshData">
<polygon fill="#a7506f" stroke="#a7506f" points="358.5,-974 280.5,-974 280.5,-950 358.5,-950 358.5,-974"/>
<text text-anchor="middle" x="319.5" y="-959.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">distMeshData</text>
</a>
</g>
</g>
<!-- proc~dhscf&#45;&gt;interface~distmeshdata -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge43" class="edge"><title>proc~dhscf&#45;&gt;interface~distmeshdata</title>
<path fill="none" stroke="#000000" d="M203.518,-846.572C208.434,-849.422 213.215,-852.884 217,-857 244.493,-886.898 222.953,-913.67 253,-941 258.104,-945.643 264.241,-949.26 270.685,-952.077"/>
<polygon fill="#000000" stroke="#000000" points="269.668,-955.433 280.26,-955.659 272.12,-948.877 269.668,-955.433"/>
</g>
<!-- mpi_allreduce -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node43" class="node"><title>mpi_allreduce</title>
<polygon fill="#777777" stroke="#777777" points="359,-1264 280,-1264 280,-1240 359,-1240 359,-1264"/>
<text text-anchor="middle" x="319.5" y="-1249.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_allreduce</text>
</g>
<!-- proc~dhscf&#45;&gt;mpi_allreduce -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge46" class="edge"><title>proc~dhscf&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M203.755,-845.271C208.903,-848.251 213.717,-852.094 217,-857 308.636,-993.948 153.924,-1094.33 253,-1226 257.552,-1232.05 263.73,-1236.69 270.482,-1240.26"/>
<polygon fill="#000000" stroke="#000000" points="269.387,-1243.6 279.946,-1244.48 272.239,-1237.21 269.387,-1243.6"/>
</g>
<!-- forhar -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node44" class="node"><title>forhar</title>
<polygon fill="#777777" stroke="#777777" points="346.5,-1184 292.5,-1184 292.5,-1160 346.5,-1160 346.5,-1184"/>
<text text-anchor="middle" x="319.5" y="-1169.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">forhar</text>
</g>
<!-- proc~dhscf&#45;&gt;forhar -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge47" class="edge"><title>proc~dhscf&#45;&gt;forhar</title>
<path fill="none" stroke="#000000" d="M203.666,-845.331C208.818,-848.308 213.657,-852.135 217,-857 291.548,-965.501 169.084,-1049.57 253,-1151 260.343,-1159.88 271.454,-1165.04 282.449,-1168.04"/>
<polygon fill="#000000" stroke="#000000" points="281.885,-1171.5 292.403,-1170.22 283.385,-1164.66 281.885,-1171.5"/>
</g>
<!-- vacuum_level -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node45" class="node"><title>vacuum_level</title>
<polygon fill="#777777" stroke="#777777" points="358.5,-1142 280.5,-1142 280.5,-1118 358.5,-1118 358.5,-1142"/>
<text text-anchor="middle" x="319.5" y="-1127.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">vacuum_level</text>
</g>
<!-- proc~dhscf&#45;&gt;vacuum_level -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge48" class="edge"><title>proc~dhscf&#45;&gt;vacuum_level</title>
<path fill="none" stroke="#000000" d="M203.593,-845.381C208.75,-848.355 213.609,-852.169 217,-857 282,-949.601 180.01,-1022.56 253,-1109 257.767,-1114.65 264.056,-1118.79 270.853,-1121.83"/>
<polygon fill="#000000" stroke="#000000" points="269.747,-1125.15 280.341,-1125.32 272.166,-1118.58 269.747,-1125.15"/>
</g>
<!-- localchargeonmesh -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node46" class="node"><title>localchargeonmesh</title>
<polygon fill="#777777" stroke="#777777" points="372.5,-1100 266.5,-1100 266.5,-1076 372.5,-1076 372.5,-1100"/>
<text text-anchor="middle" x="319.5" y="-1085.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">localchargeonmesh</text>
</g>
<!-- proc~dhscf&#45;&gt;localchargeonmesh -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge50" class="edge"><title>proc~dhscf&#45;&gt;localchargeonmesh</title>
<path fill="none" stroke="#000000" d="M203.901,-845.688C208.912,-848.623 213.633,-852.342 217,-857 272.48,-933.74 190.905,-995.506 253,-1067 254.527,-1068.76 256.201,-1070.37 257.992,-1071.85"/>
<polygon fill="#000000" stroke="#000000" points="256.226,-1074.88 266.489,-1077.51 260.107,-1069.05 256.226,-1074.88"/>
</g>
<!-- write_debug -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node47" class="node"><title>write_debug</title>
<polygon fill="#777777" stroke="#777777" points="636.5,-1405 565.5,-1405 565.5,-1381 636.5,-1381 636.5,-1405"/>
<text text-anchor="middle" x="601" y="-1390.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_debug</text>
</g>
<!-- proc~dhscf&#45;&gt;write_debug -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge51" class="edge"><title>proc~dhscf&#45;&gt;write_debug</title>
<path fill="none" stroke="#000000" d="M203.505,-844.934C208.799,-847.95 213.74,-851.894 217,-857 256.528,-918.898 199.673,-1466.5 253,-1517 350.825,-1609.63 522.527,-1465.95 580.357,-1412.06"/>
<polygon fill="#000000" stroke="#000000" points="582.874,-1414.5 587.741,-1405.09 578.068,-1409.41 582.874,-1414.5"/>
</g>
<!-- vmat -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node48" class="node"><title>vmat</title>
<polygon fill="#777777" stroke="#777777" points="346.5,-1058 292.5,-1058 292.5,-1034 346.5,-1034 346.5,-1058"/>
<text text-anchor="middle" x="319.5" y="-1043.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">vmat</text>
</g>
<!-- proc~dhscf&#45;&gt;vmat -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge52" class="edge"><title>proc~dhscf&#45;&gt;vmat</title>
<path fill="none" stroke="#000000" d="M203.756,-845.795C208.776,-848.723 213.537,-852.413 217,-857 263.008,-917.946 201.747,-968.394 253,-1025 260.671,-1033.47 271.76,-1038.54 282.64,-1041.58"/>
<polygon fill="#000000" stroke="#000000" points="281.941,-1045.01 292.469,-1043.82 283.502,-1038.18 281.941,-1045.01"/>
</g>
<!-- meshlim -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node49" class="node"><title>meshlim</title>
<polygon fill="#777777" stroke="#777777" points="499,-1164 445,-1164 445,-1140 499,-1140 499,-1164"/>
<text text-anchor="middle" x="472" y="-1149.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">meshlim</text>
</g>
<!-- proc~setmeshdistr&#45;&gt;meshlim -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge53" class="edge"><title>proc~setmeshdistr&#45;&gt;meshlim</title>
<path fill="none" stroke="#000000" d="M357.056,-1009.33C367.502,-1012.42 378.165,-1017.3 386,-1025 421.482,-1059.88 388.208,-1094.48 422,-1131 425.811,-1135.12 430.565,-1138.46 435.602,-1141.17"/>
<polygon fill="#000000" stroke="#000000" points="434.28,-1144.42 444.83,-1145.39 437.188,-1138.05 434.28,-1144.42"/>
</g>
<!-- proc~reord&#45;&gt;timer -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge56" class="edge"><title>proc~reord&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M626.974,-1224.07C633.245,-1228.09 639.471,-1233.08 644,-1239 684.936,-1292.52 699.214,-1373.71 703.889,-1412.64"/>
<polygon fill="#000000" stroke="#000000" points="700.418,-1413.1 704.988,-1422.66 707.376,-1412.33 700.418,-1413.1"/>
</g>
<!-- proc~reord&#45;&gt;de_alloc -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge55" class="edge"><title>proc~reord&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M612.711,-1199.68C622.144,-1188.27 635.646,-1170.47 644,-1153 676.914,-1084.17 695.274,-994.692 702.44,-953.941"/>
<polygon fill="#000000" stroke="#000000" points="705.902,-954.46 704.131,-944.015 699.001,-953.285 705.902,-954.46"/>
</g>
<!-- proc~reord&#45;&gt;re_alloc -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge54" class="edge"><title>proc~reord&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M628.244,-1212C640.807,-1212 656.054,-1212 669.706,-1212"/>
<polygon fill="#000000" stroke="#000000" points="669.765,-1215.5 679.765,-1212 669.765,-1208.5 669.765,-1215.5"/>
</g>
<!-- proc~distmeshdata_rea -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node50" class="node"><title>proc~distmeshdata_rea</title>
<g id="a_proc~~setup_hamiltonian~~CallsGraph_node50"><a xlink:href=".././proc/distmeshdata_rea.html" xlink:title="distMeshData_rea">
<polygon fill="#d9534f" stroke="#d9534f" points="522,-1122 422,-1122 422,-1098 522,-1098 522,-1122"/>
<text text-anchor="middle" x="472" y="-1107.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">distMeshData_rea</text>
</a>
</g>
</g>
<!-- interface~distmeshdata&#45;&gt;proc~distmeshdata_rea -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge57" class="edge"><title>interface~distmeshdata&#45;&gt;proc~distmeshdata_rea</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M358.621,-969.527C368.182,-972.629 377.988,-976.964 386,-983 423.181,-1011.01 449.323,-1060.28 462.093,-1088.51"/>
<polygon fill="#000000" stroke="#000000" points="458.977,-1090.12 466.189,-1097.88 465.391,-1087.32 458.977,-1090.12"/>
</g>
<!-- proc~distmeshdata_int -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node51" class="node"><title>proc~distmeshdata_int</title>
<g id="a_proc~~setup_hamiltonian~~CallsGraph_node51"><a xlink:href=".././proc/distmeshdata_int.html" xlink:title="distMeshData_int">
<polygon fill="#d9534f" stroke="#d9534f" points="519.5,-974 424.5,-974 424.5,-950 519.5,-950 519.5,-974"/>
<text text-anchor="middle" x="472" y="-959.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">distMeshData_int</text>
</a>
</g>
</g>
<!-- interface~distmeshdata&#45;&gt;proc~distmeshdata_int -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge58" class="edge"><title>interface~distmeshdata&#45;&gt;proc~distmeshdata_int</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M358.867,-962C375.694,-962 395.79,-962 414.292,-962"/>
<polygon fill="#000000" stroke="#000000" points="414.375,-965.5 424.375,-962 414.375,-958.5 414.375,-965.5"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;timer -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge64" class="edge"><title>proc~distmeshdata_rea&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M510.489,-1122.06C514.735,-1124.53 518.71,-1127.49 522,-1131 554.86,-1166.09 528.738,-1194.86 558,-1233 586.214,-1269.78 614.52,-1256.23 644,-1292 674.348,-1328.82 692.305,-1382.77 700.542,-1412.78"/>
<polygon fill="#000000" stroke="#000000" points="697.216,-1413.89 703.142,-1422.67 703.986,-1412.11 697.216,-1413.89"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;de_alloc -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge66" class="edge"><title>proc~distmeshdata_rea&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M497.447,-1097.94C514.378,-1089.66 537.474,-1078.48 558,-1069 595.935,-1051.48 612.411,-1058.35 644,-1031 668.861,-1009.47 687.104,-975.493 697.137,-953.475"/>
<polygon fill="#000000" stroke="#000000" points="700.355,-954.853 701.164,-944.289 693.944,-952.043 700.355,-954.853"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;re_alloc -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge62" class="edge"><title>proc~distmeshdata_rea&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M503.116,-1122.1C509.433,-1124.86 515.997,-1127.9 522,-1131 538.66,-1139.6 541.231,-1144.61 558,-1153 595.115,-1171.57 639.563,-1188.64 669.999,-1199.59"/>
<polygon fill="#000000" stroke="#000000" points="669.158,-1203 679.753,-1203.06 671.505,-1196.41 669.158,-1203"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;die -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge68" class="edge"><title>proc~distmeshdata_rea&#45;&gt;die</title>
<path fill="none" stroke="#000000" d="M478.48,-1097.99C488.441,-1075.74 509.627,-1026.41 522,-983 563.516,-837.344 589.07,-656.319 597.185,-593.617"/>
<polygon fill="#000000" stroke="#000000" points="600.705,-593.684 598.498,-583.321 593.761,-592.799 600.705,-593.684"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;proc~reord -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge61" class="edge"><title>proc~distmeshdata_rea&#45;&gt;proc~reord</title>
<path fill="none" stroke="#000000" d="M508.214,-1122.06C513.123,-1124.58 517.888,-1127.55 522,-1131 544.381,-1149.78 537.082,-1165.6 558,-1186 561.039,-1188.96 564.474,-1191.75 568.036,-1194.33"/>
<polygon fill="#000000" stroke="#000000" points="566.19,-1197.3 576.458,-1199.91 570.059,-1191.47 566.19,-1197.3"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;mpi_barrier -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge65" class="edge"><title>proc~distmeshdata_rea&#45;&gt;mpi_barrier</title>
<path fill="none" stroke="#000000" d="M511.247,-1122.11C515.263,-1124.56 518.975,-1127.5 522,-1131 562.867,-1178.32 528.058,-1212.11 558,-1267 563.282,-1276.68 571.023,-1285.95 578.424,-1293.6"/>
<polygon fill="#000000" stroke="#000000" points="576.024,-1296.15 585.609,-1300.66 580.931,-1291.16 576.024,-1296.15"/>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;write_debug -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge67" class="edge"><title>proc~distmeshdata_rea&#45;&gt;write_debug</title>
<path fill="none" stroke="#000000" d="M512.01,-1122.17C515.79,-1124.61 519.239,-1127.52 522,-1131 578.952,-1202.78 522.564,-1249.5 558,-1334 563.909,-1348.09 573.671,-1362.1 582.297,-1372.93"/>
<polygon fill="#000000" stroke="#000000" points="579.802,-1375.4 588.877,-1380.87 585.193,-1370.93 579.802,-1375.4"/>
</g>
<!-- mpitrace_event -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node52" class="node"><title>mpitrace_event</title>
<polygon fill="#777777" stroke="#777777" points="644,-1144 558,-1144 558,-1120 644,-1120 644,-1144"/>
<text text-anchor="middle" x="601" y="-1129.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpitrace_event</text>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;mpitrace_event -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge59" class="edge"><title>proc~distmeshdata_rea&#45;&gt;mpitrace_event</title>
<path fill="none" stroke="#000000" d="M522.102,-1118.51C530.438,-1119.95 539.125,-1121.45 547.544,-1122.91"/>
<polygon fill="#000000" stroke="#000000" points="547.188,-1126.4 557.639,-1124.66 548.383,-1119.51 547.188,-1126.4"/>
</g>
<!-- nmeshg -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node53" class="node"><title>nmeshg</title>
<polygon fill="#777777" stroke="#777777" points="628,-1102 574,-1102 574,-1078 628,-1078 628,-1102"/>
<text text-anchor="middle" x="601" y="-1087.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nmeshg</text>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;nmeshg -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge60" class="edge"><title>proc~distmeshdata_rea&#45;&gt;nmeshg</title>
<path fill="none" stroke="#000000" d="M522.102,-1102.27C535.981,-1100.08 550.829,-1097.74 563.8,-1095.7"/>
<polygon fill="#000000" stroke="#000000" points="564.412,-1099.15 573.746,-1094.13 563.323,-1092.23 564.412,-1099.15"/>
</g>
<!-- proc~boxintersection -->
<g id="proc~~setup_hamiltonian~~CallsGraph_node54" class="node"><title>proc~boxintersection</title>
<g id="a_proc~~setup_hamiltonian~~CallsGraph_node54"><a xlink:href=".././proc/boxintersection.html" xlink:title="boxIntersection">
<polygon fill="#d9534f" stroke="#d9534f" points="643.5,-1022 558.5,-1022 558.5,-998 643.5,-998 643.5,-1022"/>
<text text-anchor="middle" x="601" y="-1007.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">boxIntersection</text>
</a>
</g>
</g>
<!-- proc~distmeshdata_rea&#45;&gt;proc~boxintersection -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge63" class="edge"><title>proc~distmeshdata_rea&#45;&gt;proc~boxintersection</title>
<path fill="none" stroke="#000000" d="M485.7,-1097.78C501.854,-1082.51 530.913,-1055.97 558,-1036 561.934,-1033.1 566.199,-1030.2 570.452,-1027.45"/>
<polygon fill="#000000" stroke="#000000" points="572.446,-1030.33 579.054,-1022.05 568.724,-1024.4 572.446,-1030.33"/>
</g>
<!-- proc~distmeshdata_int&#45;&gt;de_alloc -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge71" class="edge"><title>proc~distmeshdata_int&#45;&gt;de_alloc</title>
<path fill="none" stroke="#000000" d="M519.591,-956.001C563.816,-950.307 629.37,-941.867 669.799,-936.661"/>
<polygon fill="#000000" stroke="#000000" points="670.284,-940.128 679.755,-935.379 669.39,-933.185 670.284,-940.128"/>
</g>
<!-- proc~distmeshdata_int&#45;&gt;re_alloc -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge72" class="edge"><title>proc~distmeshdata_int&#45;&gt;re_alloc</title>
<path fill="none" stroke="#000000" d="M519.747,-956.606C557.777,-954.914 610.461,-959.099 644,-989 674.249,-1015.97 695.32,-1138.87 702.898,-1189.8"/>
<polygon fill="#000000" stroke="#000000" points="699.446,-1190.38 704.346,-1199.78 706.374,-1189.38 699.446,-1190.38"/>
</g>
<!-- proc~distmeshdata_int&#45;&gt;die -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge69" class="edge"><title>proc~distmeshdata_int&#45;&gt;die</title>
<path fill="none" stroke="#000000" d="M476.94,-949.869C494.9,-894.574 569.152,-665.974 592.759,-593.293"/>
<polygon fill="#000000" stroke="#000000" points="596.22,-593.969 595.98,-583.377 589.562,-591.806 596.22,-593.969"/>
</g>
<!-- proc~distmeshdata_int&#45;&gt;proc~boxintersection -->
<g id="proc~~setup_hamiltonian~~CallsGraph_edge70" class="edge"><title>proc~distmeshdata_int&#45;&gt;proc~boxintersection</title>
<path fill="none" stroke="#000000" d="M505.047,-974.112C521.292,-980.252 541.209,-987.78 558.6,-994.353"/>
<polygon fill="#000000" stroke="#000000" points="557.371,-997.63 567.963,-997.891 559.846,-991.082 557.371,-997.63"/>
</g>
</g>
</svg>
</div><script>var panprocsetup_hamiltonianCallsGraph = svgPanZoom('#procsetup_hamiltonianCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,-0 209.5,-0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.5,-24 454.5,-24 454.5,-0 551.5,-0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~setup_hamiltonian~~CalledByGraph Pages: 1 -->
<svg id="procsetup_hamiltonianCalledByGraph" width="220pt" height="32pt"
 viewBox="0.00 0.00 220.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~setup_hamiltonian~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~setup_hamiltonian~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 216,-28 216,4 -4,4"/>
<!-- proc~setup_hamiltonian -->
<g id="proc~~setup_hamiltonian~~CalledByGraph_node1" class="node"><title>proc~setup_hamiltonian</title>
<polygon fill="none" stroke="black" points="212,-24 112,-24 112,-0 212,-0 212,-24"/>
<text text-anchor="middle" x="162" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">setup_hamiltonian</text>
</g>
<!-- proc~siesta_forces -->
<g id="proc~~setup_hamiltonian~~CalledByGraph_node2" class="node"><title>proc~siesta_forces</title>
<g id="a_proc~~setup_hamiltonian~~CalledByGraph_node2"><a xlink:href=".././proc/siesta_forces.html" xlink:title="siesta_forces">
<polygon fill="#d9534f" stroke="#d9534f" points="76,-24 0,-24 0,-0 76,-0 76,-24"/>
<text text-anchor="middle" x="38" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">siesta_forces</text>
</a>
</g>
</g>
<!-- proc~siesta_forces&#45;&gt;proc~setup_hamiltonian -->
<g id="proc~~setup_hamiltonian~~CalledByGraph_edge1" class="edge"><title>proc~siesta_forces&#45;&gt;proc~setup_hamiltonian</title>
<path fill="none" stroke="#000000" d="M76.2669,-12C84.3255,-12 93.0387,-12 101.706,-12"/>
<polygon fill="#000000" stroke="#000000" points="101.817,-15.5001 111.817,-12 101.817,-8.5001 101.817,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,-0 209.5,-0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.5,-24 454.5,-24 454.5,-0 551.5,-0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/setup_hamiltonian.html#src">setup_hamiltonian</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>      <span class="k">subroutine </span><span class="n">setup_hamiltonian</span><span class="p">(</span> <span class="n">iscf</span> <span class="p">)</span>

      <span class="k">USE </span><span class="n">siesta_options</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">H_kin_1D</span><span class="p">,</span> <span class="n">H_vkb_1D</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">H_ldau_2D</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">H_so_on_2D</span><span class="p">,</span> <span class="n">H_so_off_2D</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">listh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">maxnh</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">H</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">Hold</span>
      <span class="k">use </span><span class="n">sparse_matrices</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">Dscf</span><span class="p">,</span> <span class="n">Escf</span><span class="p">,</span> <span class="n">xijo</span>
      <span class="k">use </span><span class="n">class_dSpData1D</span><span class="p">,</span>  <span class="n">only</span><span class="p">:</span> <span class="n">val</span>
      <span class="k">use </span><span class="n">class_dSpData2D</span><span class="p">,</span>  <span class="n">only</span><span class="p">:</span> <span class="n">val</span>
      <span class="k">use </span><span class="n">class_zSpData2D</span><span class="p">,</span>  <span class="n">only</span><span class="p">:</span> <span class="n">val</span>

      <span class="k">use </span><span class="n">siesta_geom</span>
      <span class="k">use </span><span class="n">atmfuncs</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">uion</span>
      <span class="k">use </span><span class="n">atomlist</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">iaorb</span><span class="p">,</span> <span class="n">iphkb</span><span class="p">,</span> <span class="n">qtot</span><span class="p">,</span> <span class="n">indxuo</span><span class="p">,</span> <span class="n">datm</span><span class="p">,</span> 
     <span class="p">.</span>                    <span class="n">lastkb</span><span class="p">,</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">rmaxv</span><span class="p">,</span> <span class="n">indxua</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span>
     <span class="p">.</span>                    <span class="n">rmaxo</span><span class="p">,</span> <span class="n">no_l</span>
      <span class="k">use </span><span class="n">metaforce</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">lMetaForce</span><span class="p">,</span> <span class="n">meta</span>
      <span class="k">use </span><span class="n">molecularmechanics</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">twobody</span>
      <span class="k">use </span><span class="n">ldau_specs</span><span class="p">,</span>   <span class="n">only</span><span class="p">:</span> <span class="n">switch_ldau</span>     <span class="c">! This variable determines whether</span>
                                              <span class="c">!   the subroutine to compute the</span>
                                              <span class="c">!   Hubbard terms should be called</span>
                                              <span class="c">!   or not</span>
      <span class="k">use </span><span class="n">m_ldau</span><span class="p">,</span>       <span class="n">only</span><span class="p">:</span> <span class="n">hubbard_term</span>    <span class="c">! Subroutine that compute the</span>
                                              <span class="c">!   Hubbard terms</span>
      <span class="k">use </span><span class="n">m_dhscf</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">dhscf</span>
      <span class="k">use </span><span class="n">m_stress</span>
      <span class="k">use </span><span class="n">m_energies</span>
      <span class="k">use </span><span class="n">parallel</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">Node</span>
      <span class="k">use </span><span class="n">m_steps</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">istp</span>
      <span class="k">use </span><span class="n">m_ntm</span>

      <span class="k">use </span><span class="n">m_spin</span><span class="p">,</span>          <span class="n">only</span><span class="p">:</span> <span class="n">spin</span> 

      <span class="k">use </span><span class="n">m_dipol</span>
      <span class="k">use </span><span class="n">alloc</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">re_alloc</span><span class="p">,</span> <span class="n">de_alloc</span>
      <span class="k">use </span><span class="n">m_gamma</span>
      <span class="k">use </span><span class="n">m_hsx</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">write_hsx</span>
      <span class="k">use </span><span class="n">sys</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">die</span><span class="p">,</span> <span class="n">bye</span>
      <span class="k">use </span><span class="n">m_partial_charges</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">want_partial_charges</span>
      <span class="k">use </span><span class="n">files</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">filesOut_t</span>    <span class="c">! derived type for output file names</span>
      <span class="k">use </span><span class="n">m_rhog</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">rhog_in</span><span class="p">,</span> <span class="n">rhog</span>
<span class="cp">#ifdef MPI</span>
      <span class="k">use </span><span class="n">m_mpi_utils</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">globalize_sum</span>
<span class="cp">#endif</span>

      <span class="k">implicit none</span>
<span class="k">      </span><span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iscf</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">stressl</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span>   <span class="kd">::</span> <span class="n">fal</span><span class="p">(:,:)</span>   <span class="c">! Local-node part of atomic F</span>
<span class="cp">#ifdef MPI</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">buffer1</span>
<span class="cp">#endif</span>
      <span class="kt">integer</span>             <span class="kd">::</span> <span class="n">io</span><span class="p">,</span> <span class="k">is</span><span class="p">,</span> <span class="n">ispin</span>
      <span class="kt">integer</span>             <span class="kd">::</span> <span class="n">ifa</span>     <span class="c">! Calc. forces?      0=&gt;no, 1=&gt;yes</span>
      <span class="kt">integer</span>             <span class="kd">::</span> <span class="n">istr</span>    <span class="c">! Calc. stress?      0=&gt;no, 1=&gt;yes</span>
      <span class="kt">integer</span>             <span class="kd">::</span> <span class="n">ihmat</span>   <span class="c">! Calc. hamiltonian? 0=&gt;no, 1=&gt;yes</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">g2max</span>
      <span class="k">type</span><span class="p">(</span><span class="n">filesOut_t</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">filesOut</span>  <span class="c">! blank output file names</span>
      <span class="kt">logical</span>             <span class="kd">::</span> <span class="n">use_rhog_in</span>

      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span>   <span class="kd">::</span> <span class="n">H_vkb</span><span class="p">(:),</span> <span class="n">H_kin</span><span class="p">(:),</span> <span class="n">H_ldau</span><span class="p">(:,:)</span>
      <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span>   <span class="kd">::</span> <span class="n">H_so_on</span><span class="p">(:,:)</span>
      <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span><span class="kd">::</span> <span class="n">H_so_off</span><span class="p">(:,:)</span>

      <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="kd">::</span> <span class="n">Dc</span>
      <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ind</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span>

<span class="c">!------------------------------------------------------------------------- BEGIN</span>

      <span class="k">call </span><span class="n">timer</span><span class="p">(</span><span class="s1">&#39;setup_H&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

      <span class="c">! Nullify pointers</span>
      <span class="k">nullify</span><span class="p">(</span><span class="n">fal</span><span class="p">)</span>

<span class="c">!$OMP parallel default(shared), private(ispin,io)</span>

<span class="c">!     Save present H matrix</span>
<span class="c">!$OMP do collapse(2)</span>
      <span class="k">do </span><span class="n">ispin</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">H</span>
         <span class="k">do </span><span class="n">io</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">maxnh</span>
            <span class="n">Hold</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="n">ispin</span><span class="p">)</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="n">ispin</span><span class="p">)</span>
         <span class="k">end do</span>
<span class="k">      end do</span>
<span class="c">!$OMP end do</span>

<span class="c">!$OMP single</span>
      <span class="n">H_kin</span> <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">H_kin_1D</span><span class="p">)</span>
      <span class="n">H_vkb</span> <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">H_vkb_1D</span><span class="p">)</span>
      
      <span class="k">if</span> <span class="p">(</span> <span class="n">spin</span><span class="p">%</span><span class="n">SO_onsite</span> <span class="p">)</span> <span class="k">then</span>
        <span class="c">! Sadly some compilers (g95), does</span>
        <span class="c">! not allow bounds for pointer assignments :(</span>
        <span class="n">H_so_on</span> <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">H_so_on_2D</span><span class="p">)</span>
        
      <span class="k">else if</span> <span class="p">(</span> <span class="n">spin</span><span class="p">%</span><span class="n">SO_offsite</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">        </span><span class="n">H_so_off</span> <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">H_so_off_2D</span><span class="p">)</span>
        
      <span class="k">end if</span>
<span class="c">!$OMP end single ! keep wait</span>

      <span class="c">! Initialize diagonal Hamiltonian</span>
      <span class="k">do </span><span class="n">ispin</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">spinor</span>
<span class="c">!$OMP do</span>
        <span class="k">do </span><span class="n">io</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">maxnh</span>
          <span class="n">H</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="n">ispin</span><span class="p">)</span> <span class="o">=</span> <span class="n">H_kin</span><span class="p">(</span><span class="n">io</span><span class="p">)</span> <span class="o">+</span> <span class="n">H_vkb</span><span class="p">(</span><span class="n">io</span><span class="p">)</span>
        <span class="k">end do</span>
<span class="c">!$OMP end do nowait</span>
      <span class="k">end do</span>

<span class="k">      if</span> <span class="p">(</span> <span class="n">spin</span><span class="p">%</span><span class="n">SO_onsite</span> <span class="p">)</span> <span class="k">then</span>
<span class="c">!$OMP do collapse(2)</span>
        <span class="k">do </span><span class="n">ispin</span> <span class="o">=</span> <span class="mi">3</span> <span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">H</span>
          <span class="k">do </span><span class="n">io</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">maxnh</span>
            <span class="n">H</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="n">ispin</span><span class="p">)</span> <span class="o">=</span> <span class="n">H_so_on</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="n">ispin</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
          <span class="k">end do</span>
<span class="k">        end do</span>
<span class="c">!$OMP end do nowait</span>
         
      <span class="k">else</span>

<span class="c">!$OMP do collapse(2)</span>
        <span class="k">do </span><span class="n">ispin</span> <span class="o">=</span> <span class="mi">3</span> <span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">H</span>
          <span class="k">do </span><span class="n">io</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">maxnh</span>
            <span class="n">H</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="n">ispin</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0._dp</span>
          <span class="k">end do</span>
<span class="k">        end do</span>
<span class="c">!$OMP end do nowait</span>
         
      <span class="k">end if</span>
         
<span class="c">! ..................</span>

<span class="c">! Non-SCF part of total energy .......................................</span>
<span class="c">! Note that these will be &quot;impure&quot; for a mixed Dscf</span>

<span class="c">! If mixing the charge, Dscf is the previous step&#39;s DM_out. Since</span>
<span class="c">! the &quot;scf&quot; components of the energy are computed with the (mixed)</span>
<span class="c">! charge, this introduces an inconsistency. In this case the energies</span>
<span class="c">! coming out of this routine need to be corrected.</span>
<span class="c">! </span>
<span class="c">!$OMP single</span>
      <span class="n">Ekin</span> <span class="o">=</span> <span class="mf">0.0_dp</span>
      <span class="n">Enl</span> <span class="o">=</span> <span class="mf">0.0_dp</span>
      <span class="n">Eso</span> <span class="o">=</span> <span class="mf">0.0_dp</span>
<span class="c">!$OMP end single ! keep wait</span>
      
<span class="c">!$OMP do collapse(2), reduction(+:Ekin,Enl)</span>
      <span class="k">do </span><span class="n">ispin</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">spinor</span>
        <span class="k">do </span><span class="n">io</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">maxnh</span>
          <span class="n">Ekin</span> <span class="o">=</span> <span class="n">Ekin</span> <span class="o">+</span> <span class="n">H_kin</span><span class="p">(</span><span class="n">io</span><span class="p">)</span> <span class="o">*</span> <span class="n">Dscf</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="n">ispin</span><span class="p">)</span>
          <span class="n">Enl</span>  <span class="o">=</span> <span class="n">Enl</span>  <span class="o">+</span> <span class="n">H_vkb</span><span class="p">(</span><span class="n">io</span><span class="p">)</span> <span class="o">*</span> <span class="n">Dscf</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="n">ispin</span><span class="p">)</span>
        <span class="k">end do</span>
<span class="k">      end do</span>
<span class="c">!$OMP end do nowait</span>

<span class="c">!</span>
<span class="c">!  Dc IS NOT the dense matrix, it is just a complex number </span>
<span class="c">! (per each io index) used as an artifact to multiply the </span>
<span class="c">! elements of the H_SO times the corresponding elements of </span>
<span class="c">! DM in a such way that the result gives Re{Tr[H_SO*DM]}.</span>
<span class="c">!</span>

      <span class="k">if</span> <span class="p">(</span> <span class="n">spin</span><span class="p">%</span><span class="n">SO_offsite</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">        do </span><span class="n">io</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">maxnh</span>

<span class="c">!-------- Eso(u,u)</span>
          <span class="n">Dc</span> <span class="o">=</span> <span class="nb">cmplx</span><span class="p">(</span><span class="n">Dscf</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">Dscf</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">dp</span><span class="p">)</span>
          <span class="n">Eso</span> <span class="o">=</span> <span class="n">Eso</span> <span class="o">+</span> <span class="kt">real</span><span class="p">(</span> <span class="n">H_so_off</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Dc</span><span class="p">,</span> <span class="n">dp</span><span class="p">)</span>
<span class="c">!-------- Eso(d,d)</span>
          <span class="n">Dc</span> <span class="o">=</span> <span class="nb">cmplx</span><span class="p">(</span><span class="n">Dscf</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">Dscf</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">dp</span><span class="p">)</span>
          <span class="n">Eso</span> <span class="o">=</span> <span class="n">Eso</span> <span class="o">+</span> <span class="kt">real</span><span class="p">(</span> <span class="n">H_so_off</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">Dc</span><span class="p">,</span> <span class="n">dp</span><span class="p">)</span>
<span class="c">!-------- Eso(u,d)</span>
          <span class="n">Dc</span> <span class="o">=</span> <span class="nb">cmplx</span><span class="p">(</span><span class="n">Dscf</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">Dscf</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">dp</span><span class="p">)</span>
          <span class="n">Eso</span> <span class="o">=</span> <span class="n">Eso</span> <span class="o">+</span> <span class="kt">real</span><span class="p">(</span> <span class="n">H_so_off</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">Dc</span><span class="p">,</span> <span class="n">dp</span><span class="p">)</span>
<span class="c">!-------- Eso(d,u)</span>
          <span class="n">Dc</span> <span class="o">=</span> <span class="nb">cmplx</span><span class="p">(</span><span class="n">Dscf</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span><span class="o">-</span><span class="n">Dscf</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="n">dp</span><span class="p">)</span>
          <span class="n">Eso</span> <span class="o">=</span> <span class="n">Eso</span> <span class="o">+</span> <span class="kt">real</span><span class="p">(</span> <span class="n">H_so_off</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">Dc</span><span class="p">,</span> <span class="n">dp</span><span class="p">)</span>

        <span class="k">end do</span>

<span class="k">      else if</span> <span class="p">(</span> <span class="n">spin</span><span class="p">%</span><span class="n">SO_onsite</span> <span class="p">)</span> <span class="k">then</span>
        
<span class="c">!$OMP do reduction(+:Eso)</span>
         <span class="k">do </span><span class="n">io</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">maxnh</span>
           <span class="n">Eso</span> <span class="o">=</span> <span class="n">Eso</span> <span class="o">+</span> <span class="n">H_so_on</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Dscf</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span> <span class="o">+</span>
     <span class="p">&amp;</span>         <span class="n">H_so_on</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">Dscf</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span><span class="o">+</span> <span class="n">H_so_on</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">Dscf</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
     <span class="p">&amp;</span>         <span class="n">H_so_on</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">Dscf</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">-</span> <span class="n">H_so_on</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">Dscf</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> <span class="o">-</span>
     <span class="p">&amp;</span>         <span class="n">H_so_on</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">Dscf</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
         <span class="k">end do</span>
<span class="c">!$OMP end do nowait</span>

       <span class="k">end if</span>

<span class="c">!$OMP end parallel</span>

<span class="cp">#ifdef MPI</span>
      <span class="c">! Global reduction of Ekin, Enl</span>
      <span class="k">call </span><span class="n">globalize_sum</span><span class="p">(</span><span class="n">Ekin</span><span class="p">,</span><span class="n">buffer1</span><span class="p">)</span>
      <span class="n">Ekin</span> <span class="o">=</span> <span class="n">buffer1</span>
      <span class="k">call </span><span class="n">globalize_sum</span><span class="p">(</span><span class="n">Enl</span><span class="p">,</span><span class="n">buffer1</span><span class="p">)</span>
      <span class="n">Enl</span> <span class="o">=</span> <span class="n">buffer1</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">spin</span><span class="p">%</span><span class="n">SO</span> <span class="p">)</span> <span class="k">then</span>
         <span class="c">! Global reduction of Eso </span>
         <span class="k">call </span><span class="n">globalize_sum</span><span class="p">(</span><span class="n">Eso</span><span class="p">,</span><span class="n">buffer1</span><span class="p">)</span>
         <span class="n">Eso</span> <span class="o">=</span> <span class="n">buffer1</span>
      <span class="k">end if</span>
<span class="cp">#endif</span>

<span class="c">!     Non-SCF part of total energy</span>
      <span class="k">call </span><span class="n">update_E0</span><span class="p">()</span>

<span class="c">! Hubbard term for LDA+U: energy, forces, stress and matrix elements ....</span>
      <span class="k">if</span><span class="p">(</span> <span class="n">switch_ldau</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">        if</span> <span class="p">(</span> <span class="n">spin</span><span class="p">%</span><span class="n">NCol</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">die</span><span class="p">(</span><span class="s1">&#39;LDA+U cannot be used with non-collinear spin.&#39;</span><span class="p">)</span>
        <span class="k">end if</span>
<span class="k">        if</span> <span class="p">(</span> <span class="n">spin</span><span class="p">%</span><span class="n">SO</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">die</span><span class="p">(</span><span class="s1">&#39;LDA+U cannot be used with spin-orbit coupling.&#39;</span><span class="p">)</span>
        <span class="k">end if</span>

<span class="k">        call </span><span class="n">re_alloc</span><span class="p">(</span> <span class="n">fal</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="s1">&#39;fal&#39;</span><span class="p">,</span> <span class="s1">&#39;setup_hamiltonian&#39;</span> <span class="p">)</span>

        <span class="n">H_ldau</span> <span class="o">=&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">H_ldau_2D</span><span class="p">)</span>
        <span class="k">call </span><span class="n">hubbard_term</span><span class="p">(</span><span class="n">scell</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">na_s</span><span class="p">,</span> <span class="n">isa</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">indxua</span><span class="p">,</span>
     <span class="p">.</span>                    <span class="n">maxnh</span><span class="p">,</span> <span class="n">maxnh</span><span class="p">,</span> <span class="n">lasto</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span> 
     <span class="p">.</span>                    <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span>
     <span class="p">.</span>                    <span class="n">spin</span><span class="p">%</span><span class="n">spinor</span><span class="p">,</span> <span class="n">Dscf</span><span class="p">,</span> <span class="n">Eldau</span><span class="p">,</span> <span class="n">DEldau</span><span class="p">,</span> <span class="n">H_ldau</span><span class="p">,</span> 
     <span class="p">.</span>                    <span class="n">fal</span><span class="p">,</span> <span class="n">stressl</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">iscf</span><span class="p">,</span>
     <span class="p">.</span>                    <span class="n">matrix_elements_only</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>

<span class="cp">#ifdef MPI</span>
        <span class="c">! Global reduction of energy terms</span>
        <span class="k">call </span><span class="n">globalize_sum</span><span class="p">(</span><span class="n">Eldau</span><span class="p">,</span><span class="n">buffer1</span><span class="p">)</span>
        <span class="n">Eldau</span> <span class="o">=</span> <span class="n">buffer1</span>
        <span class="c">! DEldau should not be globalized</span>
        <span class="c">! as it is based on globalized occupations</span>
<span class="cp">#endif</span>
        <span class="n">Eldau</span> <span class="o">=</span> <span class="n">Eldau</span> <span class="o">+</span> <span class="n">DEldau</span>

        <span class="k">call </span><span class="n">de_alloc</span><span class="p">(</span> <span class="n">fal</span><span class="p">,</span> <span class="s1">&#39;fal&#39;</span><span class="p">,</span> <span class="s1">&#39;setup_hamiltonian&#39;</span> <span class="p">)</span> 
      <span class="n">endif</span>
<span class="c">! ..................</span>


<span class="c">! Add SCF contribution to energy and matrix elements ..................</span>
      <span class="n">g2max</span> <span class="o">=</span> <span class="n">g2cut</span>

      <span class="k">call </span><span class="n">re_alloc</span><span class="p">(</span> <span class="n">fal</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="s1">&#39;fal&#39;</span><span class="p">,</span> <span class="s1">&#39;setup_hamiltonian&#39;</span> <span class="p">)</span>

      <span class="n">ifa</span>  <span class="o">=</span> <span class="mi">0</span>
      <span class="n">istr</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="n">ihmat</span> <span class="o">=</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="p">((</span><span class="n">hirshpop</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">voropop</span><span class="p">)</span>
     <span class="err">$</span>     <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">partial_charges_at_every_scf_step</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         </span><span class="n">want_partial_charges</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
      <span class="n">endif</span>
      <span class="n">use_rhog_in</span> <span class="o">=</span>  <span class="p">(</span><span class="n">mix_charge</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">iscf</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span>
  
      <span class="k">call </span><span class="n">dhscf</span><span class="p">(</span> <span class="n">spin</span><span class="p">%</span><span class="n">Grid</span><span class="p">,</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">iaorb</span><span class="p">,</span> <span class="n">iphorb</span><span class="p">,</span> <span class="n">no_l</span><span class="p">,</span>
     <span class="p">.</span>            <span class="n">no_u</span><span class="p">,</span> <span class="n">na_u</span><span class="p">,</span> <span class="n">na_s</span><span class="p">,</span> <span class="n">isa</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">indxua</span><span class="p">,</span> 
     <span class="p">.</span>            <span class="n">ntm</span><span class="p">,</span> <span class="n">ifa</span><span class="p">,</span> <span class="n">istr</span><span class="p">,</span> <span class="n">ihmat</span><span class="p">,</span> <span class="n">filesOut</span><span class="p">,</span>
     <span class="p">.</span>            <span class="n">maxnh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">Dscf</span><span class="p">,</span> <span class="n">Datm</span><span class="p">,</span>
     <span class="p">.</span>            <span class="n">maxnh</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">Enaatm</span><span class="p">,</span> <span class="n">Enascf</span><span class="p">,</span> <span class="n">Uatm</span><span class="p">,</span> <span class="n">Uscf</span><span class="p">,</span> <span class="n">DUscf</span><span class="p">,</span> <span class="n">DUext</span><span class="p">,</span>
     <span class="p">.</span>            <span class="n">Exc</span><span class="p">,</span> <span class="n">Dxc</span><span class="p">,</span> <span class="n">dipol</span><span class="p">,</span> <span class="n">stress</span><span class="p">,</span> <span class="n">fal</span><span class="p">,</span> <span class="n">stressl</span><span class="p">,</span>
     <span class="p">.</span>            <span class="n">use_rhog_in</span><span class="p">)</span>

      <span class="k">if</span> <span class="p">(</span> <span class="n">spin</span><span class="p">%</span><span class="n">SO_offsite</span> <span class="p">)</span> <span class="k">then</span>

<span class="c">! H(:, [5, 6]) are not updated in dhscf, see vmat for details.</span>
        
<span class="c">!------- H(u,u)</span>
         <span class="n">H</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">H</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="kt">real</span><span class="p">(</span><span class="n">H_so_off</span><span class="p">(:,</span><span class="mi">1</span><span class="p">),</span> <span class="n">dp</span><span class="p">)</span>
         <span class="n">H</span><span class="p">(:,</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span>         <span class="n">dimag</span><span class="p">(</span><span class="n">H_so_off</span><span class="p">(:,</span><span class="mi">1</span><span class="p">))</span>
<span class="c">!------- H(d,d)</span>
         <span class="n">H</span><span class="p">(:,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">H</span><span class="p">(:,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="kt">real</span><span class="p">(</span><span class="n">H_so_off</span><span class="p">(:,</span><span class="mi">2</span><span class="p">),</span> <span class="n">dp</span><span class="p">)</span>
         <span class="n">H</span><span class="p">(:,</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span>         <span class="n">dimag</span><span class="p">(</span><span class="n">H_so_off</span><span class="p">(:,</span><span class="mi">2</span><span class="p">))</span>
<span class="c">!------- H(u,d)</span>
         <span class="n">H</span><span class="p">(:,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">H</span><span class="p">(:,</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="kt">real</span><span class="p">(</span><span class="n">H_so_off</span><span class="p">(:,</span><span class="mi">3</span><span class="p">),</span> <span class="n">dp</span><span class="p">)</span>
         <span class="n">H</span><span class="p">(:,</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">H</span><span class="p">(:,</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span><span class="n">dimag</span><span class="p">(</span><span class="n">H_so_off</span><span class="p">(:,</span><span class="mi">3</span><span class="p">))</span>
<span class="c">!------- H(d,u)</span>
         <span class="n">H</span><span class="p">(:,</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="n">H</span><span class="p">(:,</span><span class="mi">7</span><span class="p">)</span> <span class="o">+</span> <span class="kt">real</span><span class="p">(</span><span class="n">H_so_off</span><span class="p">(:,</span><span class="mi">4</span><span class="p">),</span> <span class="n">dp</span><span class="p">)</span>
         <span class="n">H</span><span class="p">(:,</span><span class="mi">8</span><span class="p">)</span> <span class="o">=</span> <span class="n">H</span><span class="p">(:,</span><span class="mi">8</span><span class="p">)</span> <span class="o">-</span><span class="n">dimag</span><span class="p">(</span><span class="n">H_so_off</span><span class="p">(:,</span><span class="mi">4</span><span class="p">))</span>

      <span class="n">endif</span>

      <span class="c">! This statement will apply to iscf = 1, for example, when</span>
      <span class="c">! we do not use rhog_in. Rhog here is always the charge used to</span>
      <span class="c">! build H, that is, rhog_in.</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">mix_charge</span><span class="p">)</span> <span class="n">rhog_in</span> <span class="o">=</span> <span class="n">rhog</span>

      <span class="n">want_partial_charges</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
      <span class="k">call </span><span class="n">de_alloc</span><span class="p">(</span> <span class="n">fal</span><span class="p">,</span> <span class="s1">&#39;fal&#39;</span><span class="p">,</span> <span class="s1">&#39;setup_hamiltonian&#39;</span> <span class="p">)</span> 
<span class="c">!  It is wasteful to write over and over H and S, as there are</span>
<span class="c">!  no different files.</span>
<span class="c">! Save Hamiltonian and overlap matrices ............................</span>
<span class="c">! Only in HSX format now.  Use Util/HSX/hsx2hs to generate an HS file</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">savehs</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">write_coop</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">write_hsx</span><span class="p">(</span> <span class="nb">gamma</span><span class="p">,</span> <span class="n">no_u</span><span class="p">,</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">spin</span><span class="p">%</span><span class="n">H</span><span class="p">,</span> <span class="n">indxuo</span><span class="p">,</span>
     <span class="p">&amp;</span>        <span class="n">maxnh</span><span class="p">,</span> <span class="n">numh</span><span class="p">,</span> <span class="n">listhptr</span><span class="p">,</span> <span class="n">listh</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">qtot</span><span class="p">,</span>
     <span class="p">&amp;</span>        <span class="n">temp</span><span class="p">,</span> <span class="n">xijo</span><span class="p">)</span>
      <span class="n">endif</span>

      <span class="k">call </span><span class="n">timer</span><span class="p">(</span><span class="s1">&#39;setup_H&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="cp">#ifdef SIESTA__PEXSI</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">node</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">memory_snapshot</span><span class="p">(</span><span class="s2">&quot;after setup_H&quot;</span><span class="p">)</span>
<span class="cp">#endif</span>

      <span class="k">if</span> <span class="p">(</span> <span class="n">h_setup_only</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">         call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="mi">2</span> <span class="p">)</span>  <span class="c">! New call to close the tree</span>
         <span class="k">call </span><span class="n">timer</span><span class="p">(</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="mi">3</span> <span class="p">)</span>
         <span class="k">call </span><span class="n">bye</span><span class="p">(</span><span class="s2">&quot;H-Setup-Only requested&quot;</span><span class="p">)</span>
         <span class="k">STOP</span>
<span class="k">      </span><span class="n">endif</span>

<span class="c">!------------------------------------------------------------------------- END</span>
      <span class="k">END subroutine </span><span class="n">setup_hamiltonian</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2018 <a rel="license" href="http://www.gnu.org/licenses/old-licenses/fdl-1.2.en.html">GNU Free Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> SIESTA was developed by SIESTA Group</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>